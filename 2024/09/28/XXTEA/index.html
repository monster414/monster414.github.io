<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
<meta name="referrer" content="no-referrer" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo_icon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo_icon.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo_icon.svg">
  <link rel="mask-icon" href="/images/logo_icon.svg" color="#222">
  <link rel="manifest" href="/images/logo_icon.svg">
  <meta name="msapplication-config" content="/images/logo_icon.svg">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=consolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoloyolo.top","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="上班的被安排了个代打比赛的活 内容主要还是日志跟流量分析 其中一题题目文件如下 ha.pcapng">
<meta property="og:type" content="article">
<meta property="og:title" content="XXTEA">
<meta property="og:url" content="https://yoloyolo.top/2024/09/28/XXTEA/index.html">
<meta property="og:site_name" content="xXxYOLOxXx">
<meta property="og:description" content="上班的被安排了个代打比赛的活 内容主要还是日志跟流量分析 其中一题题目文件如下 ha.pcapng">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-09-28T03:16:15.000Z">
<meta property="article:modified_time" content="2024-09-28T04:14:10.312Z">
<meta property="article:author" content="xXxYOLOxXx">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="XXTEA">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yoloyolo.top/2024/09/28/XXTEA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>XXTEA | xXxYOLOxXx</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="xXxYOLOxXx" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">xXxYOLOxXx</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">xXxYOLOxXx</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="links fa-fw"></i>Links</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yoloyolo.top/2024/09/28/XXTEA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="xXxYOLOxXx">
      <meta itemprop="description" content="Explorer for unknown.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xXxYOLOxXx">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          XXTEA
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-09-28 11:16:15 / Modified: 12:14:10" itemprop="dateCreated datePublished" datetime="2024-09-28T11:16:15+08:00">2024-09-28</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>上班的被安排了个代打比赛的活</p>
<p>内容主要还是日志跟流量分析</p>
<p>其中一题题目文件如下</p>
<p><a href="/images/xxtea/ha.pcapng">ha.pcapng</a></p>
<a id="more"></a>
<p>其中一个小问题是失陷主机上有多少个用户</p>
<p>常理来说应该是要看<code>/etc/passwd</code></p>
<p>但是这个流量包并没有相关信息</p>
<p>流量包最后把enc下载, 也给了en程序的运行结果</p>
<p>感觉应该该是要对这个文件进行逆向了</p>
<p>下载, 拖IDA</p>
<p>看着像UPX</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">LOAD:0000000000005F3C                 dd 1E68h</span><br><span class="line">LOAD:0000000000005F40                 db    0</span><br><span class="line">LOAD:0000000000005F41                 db 5Ah, 0E8h, 1Eh, 3 dup(0), 50h</span><br><span class="line">LOAD:0000000000005F48 aRotExecProtWri db &#39;ROT_EXEC|PROT_WRITE failed.&#39;,0Ah,0</span><br><span class="line">LOAD:0000000000005F65                 db 5Eh, 6Ah, 2</span><br><span class="line">LOAD:0000000000005F68                 dq 7F6A050F58016A5Fh, 0A050F583C6A5Fh</span><br><span class="line">LOAD:0000000000005F78 aInfoThisFileIs db &#39;$Info: This file is packed with the UPX executable packer http:&#x2F;&#x2F;&#39;</span><br><span class="line">LOAD:0000000000005F78                 db &#39;upx.sf.net $&#39;,0Ah,0</span><br><span class="line">LOAD:0000000000005FC7 aIdUpx424Copyri db &#39;$Id: UPX 4.24 Copyright (C) 1996-2024 the UPX Team. All Rights Re&#39;</span><br><span class="line">LOAD:0000000000005FC7                 db &#39;served. $&#39;,0Ah,0</span><br><span class="line">LOAD:0000000000006013                 align 4</span><br></pre></td></tr></table></figure>
<p>要在github上下一个新版本的upx</p>
<p><a target="_blank" rel="noopener" href="https://github.com/upx/upx/releases/tag/v4.2.4">https://github.com/upx/upx/releases/tag/v4.2.4</a></p>
<p>脱壳之后看主函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int v4[6]; &#x2F;&#x2F; [rsp+10h] [rbp-20h] BYREF</span><br><span class="line">  unsigned __int64 v5; &#x2F;&#x2F; [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 &#x3D; __readfsqword(0x28u);</span><br><span class="line">  v4[0] &#x3D; 0x12345678;</span><br><span class="line">  v4[1] &#x3D; 0x9ABCDEF0;</span><br><span class="line">  v4[2] &#x3D; 0xFEDCBA98;</span><br><span class="line">  v4[3] &#x3D; 0x76543210;</span><br><span class="line">  encrypt_file(&quot;&#x2F;etc&#x2F;passwd&quot;, &quot;message.txt.enc&quot;, v4);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>跟进函数encrypt_file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">void __fastcall encrypt_file(const char *a1, const char *a2, __int64 a3)</span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; &#x2F;&#x2F; [rsp+28h] [rbp-28h]</span><br><span class="line">  __int64 n; &#x2F;&#x2F; [rsp+30h] [rbp-20h]</span><br><span class="line">  unsigned __int64 nmemb; &#x2F;&#x2F; [rsp+38h] [rbp-18h]</span><br><span class="line">  void *ptr; &#x2F;&#x2F; [rsp+40h] [rbp-10h]</span><br><span class="line">  FILE *s; &#x2F;&#x2F; [rsp+48h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  stream &#x3D; fopen(a1, &quot;rb&quot;);</span><br><span class="line">  if ( !stream )</span><br><span class="line">  &#123;</span><br><span class="line">    perror(&quot;Failed to open input file&quot;);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  fseek(stream, 0LL, 2);</span><br><span class="line">  n &#x3D; ftell(stream);</span><br><span class="line">  fseek(stream, 0LL, 0);</span><br><span class="line">  nmemb &#x3D; (unsigned __int64)(n + 3) &gt;&gt; 2;</span><br><span class="line">  ptr &#x3D; calloc(nmemb, 4uLL);</span><br><span class="line">  fread(ptr, 1uLL, n, stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  xxtea_encrypt(ptr, (unsigned int)nmemb, a3);</span><br><span class="line">  s &#x3D; fopen(a2, &quot;wb&quot;);</span><br><span class="line">  if ( !s )</span><br><span class="line">  &#123;</span><br><span class="line">    perror(&quot;Failed to open output file&quot;);</span><br><span class="line">    free(ptr);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  fwrite(ptr, 4uLL, nmemb, s);</span><br><span class="line">  fclose(s);</span><br><span class="line">  free(ptr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>稍微理一下流程</p>
<p>主函数里的v4是密钥<br />
读取<code>/etc/passwd</code>作为明文进行加密<br />
加密轮数参数为明文长度除以4</p>
<p>加密结果为输出的<code>message.txt.enc</code><br />
在流量包里面有这个密文</p>
<p>所以是要进行XXTEA解密</p>
<hr />
<p>这里给出一个取巧的方法</p>
<p>由于这个程序给出了函数xxtea_decrypt,</p>
<p>而且函数参数与xxtea_encrypt一致</p>
<p>都是<code>输入</code>, <code>加密轮数参数</code>, <code>密钥</code></p>
<p>虽然说程序中没有调用这个函数, 但是可以在动态调试中把<code>call xxtea_encrypt</code>改为<code>call xxtea_decrypt</code></p>
<p>输入需要读取<code>/etc/passwd</code>, 那就把密文放在<code>/etc/passwd</code>, 这样就解决了输入密文的问题</p>
<p>Call指令的字节码为<code>E8 75 FC FF FF</code></p>
<p>Call参数 = 目标地址 - 当前地址 - 指令长度</p>
<p>0xFFFFFCF5 = (0x12F5 - 0x167B - 0x5）&amp; 0xFFFFFFFF</p>
<p>这里的Call的函数是<code>xxtea_encrypt</code></p>
<p>需要改为<code>xxtea_decrypt</code>, 地址为0x1456</p>
<p>那么Call的参数则为</p>
<p>(0x1456 - 0x167B - 0x5）&amp; 0xFFFFFFFF = 0xFFFFFDD6</p>
<p>则修改过后的Call指令应当为<code>E8 D6 FD FF FF</code></p>
<p>运行即可, 得到的<code>message.txt.enc</code>即为解密之后的<code>/etc/passwd</code>文件</p>
<p>内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:100:103:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:101:104:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:102:105:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">hack:x:1000:1000::&#x2F;home&#x2F;hack:&#x2F;bin&#x2F;sh</span><br><span class="line">admin:x:1001:1001::&#x2F;home&#x2F;admin:&#x2F;bin&#x2F;sh</span><br><span class="line">admin1:x:1002:1002::&#x2F;home&#x2F;admin1:&#x2F;bin&#x2F;sh</span><br><span class="line">admin2:x:1003:1003::&#x2F;home&#x2F;admin2:&#x2F;bin&#x2F;sh</span><br><span class="line">admin3:x:1004:1004::&#x2F;home&#x2F;admin3:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure>
<p>应该是六个用户吧</p>
<hr />
<p>当然，也有不取巧的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def read_int(a, i):</span><br><span class="line">	tmp_list &#x3D; a[4*i:4*i+4]</span><br><span class="line">	num &#x3D; 0</span><br><span class="line">	for I in range(4):</span><br><span class="line">		num &#x3D; num + (tmp_list[I] &lt;&lt; I * 8)</span><br><span class="line">	return num</span><br><span class="line"></span><br><span class="line">def write_int(a, i, num):</span><br><span class="line">	tmp_list &#x3D; []</span><br><span class="line">	hex_num &#x3D; hex(num)[2:]</span><br><span class="line">	if len(hex_num) &lt; 8:</span><br><span class="line">		hex_num &#x3D; (8 - len(hex_num)) * &quot;0&quot; + hex_num</span><br><span class="line">	for I in range(4):</span><br><span class="line">		a[4 * i + I] &#x3D; int(hex_num[6 - 2*I:8 - 2*I], 16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher_bytes &#x3D; binascii.unhexlify(b&quot;868F9499451EC1600F994E17A3656B5E688ADBFA251AEA32331935FBD377C95492D8A870D9C29281BA32032400A7D04E7E7988AA11973B8AD996BB081F2F560B29F1CE80F35E86C74E14D1D1EEE1D2AEFD2513DF6E47162F1CC259FC23A73EE5A5F82C453F7933B997A220F1214EF8B241FC8586C95B87B37A17A12B35EFD45FB0BAE2B3850BA3AD25213BB2C75E82925C4DBA50E60E95118C8F61BA5E34043BA54688423E60857F159AF93C7E5E5D059577A5F758DC791533FB3714B8186DC9E27F78A082F3551BBDE57A72EDBA9051AB91C1C84F9BF95EF3AED2A17DD5DCE0D194A5F6D8F90D2B55C743D6889346AA38F08833943B8BA3F63853D45CA4D78C8F53F31EEFE9C2E24F633897EFCDD8CF0A9A7233FF8D824D5B0B52CD5D821BF420578EC651613AEC0B461A9079803D02910A43F898919C9288C8D941E9D0B9990789A4CE7A2A7FD4DC0F64B819616979BC56BEE51E92D0891792B155F4132265D475E02A372529211CB4DDADB39E22D4E5123458143405C32011A191915A5004E2142C9225E1DB8AAEEF040ECA3BB8E677DC058EE48B77A3D97E73F7494A8CEE9E41D98E690669AF396CD47AF26FFC0CEB704E9182AB4D62A8F474B233EFB317CC8B0EC1132E4394CEBF4EEE357493CEADE4F43CBEB0C2C664B62278E7B28CCEFA633BA5C0457830D3654BB3A9CA25BA33021E0611F9076807328DD3C8AC65F251D9B3AFCF4D47D43D1B0DCF1B5F93BC1DF69402E152EA2F12AC3F056F3EB85BF59D6647E0EDE6653550B3DD559974B1696641795BC0A40DA170EAE78054BC9833A9EA8A48CD27ABBC420F30A80CFBD181275D8434658F650B4D55AF817C0E94FAFE5329F5BF6CF66001689661EEA4318A4390F6D6BFFE52E347C4147D30C67B97FF6C5FE4755A8BC8AE4487DF86E9A282C8A90DBBB91923B4BB1112BBDC1DDE6D8A501B29390EFE5D9C01A130AD046891BBC21679B0EF7DFB83A89F4A944E8C4E87971FBF8902F6E0B4B6CDA714B472EE6C39E19F60A511EAC4AFA1670A936B20DF32A9F83754ADA308565FEC7C2E4F14CD361BE29B5E0C9C3EF81B32F347269AD7270BBFE1866E3DD5987BF5FF6193BF6F6693764AE8A2BA031715207F4F47384101BC8EE51CAAC05DF536C046D268905FF1367185091DCBD94CB8469DA91AF6354471289FE2148F8E50CFA37AE8AEA8517D2832D293DBF74332B187EC74087A8B77E167099065784B412A02ED05BD7C668AFE708DFB83CC48910E343D287D748721E59F7DFBE3F32FF69D624A2B5635544AF9C751B7C3024582F0BB7ADACEAEE07A44F7348F1C5989C75825FFF3F5EA220789D7EAC9F28526557EE333F412A9931E9FF4C073D2ED2C9EC302CF3FBF4A75456AB1C5DBDE2A0BBE61C05CB5F55BC940850151A9D530514B788CFA07D2CB6DBF6BF4FB913B380EA599DA9A18203AA8050AB7AC0149126A323D17D53716DF344DECB2CEDC3FEB9446459134D25B817727AAAC34498B448BDD44C2C8EADAC5B79200AA586C1186D51DCF8020A8D73D7D090857F2D97175D8262A39B4D78571972746858721B99AB833E60387EBEE3C9936ED8BC82C19F71D042F04A97CE4A7052936FC1287D98928DC1CB4BD6CAF1D605E96B3150D2AC14D5C073E2B2E56F08B27FDC4D257B137D8D220DDF10422DA261705828A2DE1FEB230F104030BB92DAE65C00CDD47176CC4A41FC47F0F383447EC3FA40680AE36698CF85D0D9D55059EEE4E769AD7FAA59D70DA828872E754F953C452911501EA69B70961DD22F54E49ED6445E04CB1EF8AAF10D085F242AB4507455866E4B56C20C7977662AAEE092A338BEB16D53FD9FA20658FE8588DAE80EB5F3FE7445536BF2D338264DBE2DC458D5C7565670147224CAC4E9CC81D681C301491615FC96729FE70CFB039F7B2EF28766A5859F05D97A5CF2CA49B041C251C68B3A96FA73D46498C2673737E13446FD8&quot;)</span><br><span class="line"></span><br><span class="line">a2 &#x3D; len(cipher_bytes) &#x2F;&#x2F; 4</span><br><span class="line"></span><br><span class="line">cipher &#x3D; []</span><br><span class="line">for I in cipher_bytes:</span><br><span class="line">	cipher.append(I)</span><br><span class="line">key_bytes &#x3D; binascii.unhexlify(b&quot;78563412F0DEBC9A98BADCFE10325476&quot;)</span><br><span class="line"></span><br><span class="line">key &#x3D; []</span><br><span class="line">for I in key_bytes:</span><br><span class="line">	key.append(I)</span><br><span class="line">plain &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y &#x3D; read_int(cipher, 0)</span><br><span class="line">sum_num &#x3D; (0x9E3779B9 * ((52 &#x2F;&#x2F; a2) + 6)) &amp; 0xffffffff</span><br><span class="line">v15 &#x3D; False</span><br><span class="line"></span><br><span class="line">while not v15:</span><br><span class="line">	e &#x3D; (sum_num &gt;&gt; 2) &amp; 3</span><br><span class="line">	if (a2 !&#x3D; 1):</span><br><span class="line">		i &#x3D; a2 - 1</span><br><span class="line">		while i !&#x3D; 0:</span><br><span class="line">			z_i &#x3D; read_int(cipher, i)</span><br><span class="line">			z &#x3D; read_int(cipher, i - 1)</span><br><span class="line">			y &#x3D; (z_i - (((sum_num ^ y) + (read_int(key, ((i &amp; 3) ^ e)) ^ z)) ^ (((z &lt;&lt; 4) ^ (y &gt;&gt; 3)) + ((y &lt;&lt; 2) ^ (z &gt;&gt; 5))))) &amp; 0xffffffff</span><br><span class="line">			write_int(cipher, i, y)</span><br><span class="line">			i &#x3D; i - 1</span><br><span class="line">	z &#x3D; read_int(cipher, a2 - 1)</span><br><span class="line">	cipher_0 &#x3D; read_int(cipher, 0)</span><br><span class="line">	y &#x3D; (cipher_0 - (((sum_num ^ y) + (read_int(key, (0 &amp; 3) ^ e) ^ z)) ^ (((z &lt;&lt; 4) ^ (y &gt;&gt; 3)) + ((y &lt;&lt; 2) ^ (z &gt;&gt; 5))))) &amp; 0xffffffff</span><br><span class="line">	write_int(cipher, 0, y)</span><br><span class="line">	v15 &#x3D; (sum_num &#x3D;&#x3D; 0x9E3779B9)</span><br><span class="line">	sum_num &#x3D; (sum_num + 0x61C88647) &amp; 0xffffffff</span><br><span class="line"></span><br><span class="line">plain &#x3D; &quot;&quot;</span><br><span class="line">for _ in cipher:</span><br><span class="line">	plain &#x3D; plain + chr(_)</span><br><span class="line">print(plain)</span><br></pre></td></tr></table></figure>
<p>EOF</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>xXxYOLOxXx
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://yoloyolo.top/2024/09/28/XXTEA/" title="XXTEA">https://yoloyolo.top/2024/09/28/XXTEA/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Crypto/" rel="tag"># Crypto</a>
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
              <a href="/tags/XXTEA/" rel="tag"># XXTEA</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/09/22/Deconstructionist/" rel="prev" title="Deconstructionist">
      <i class="fa fa-chevron-left"></i> Deconstructionist
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">xXxYOLOxXx</p>
  <div class="site-description" itemprop="description">Explorer for unknown.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/monster414" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;monster414" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yolo-yolo@qq.com" title="E-Mail → mailto:yolo-yolo@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/id/Purple_Miracle/" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;Purple_Miracle&#x2F;" rel="noopener" target="_blank"><i class=" fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://yoloyolo.top/atom.xml" title="RSS → https:&#x2F;&#x2F;yoloyolo.top&#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xXxYOLOxXx</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
